(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    442128,       9900]
NotebookOptionsPosition[    428826,       9439]
NotebookOutlinePosition[    429448,       9465]
CellTagsIndexPosition[    429367,       9460]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "New in: ",
 Cell["0.7", "HistoryData",
  CellTags->"New",ExpressionUUID->"d7613198-8585-4f56-ab46-a2386bb67b9f"],
 " | Modified in: ",
 Cell[" ", "HistoryData",
  CellTags->"Modified",ExpressionUUID->"af250686-2555-438e-bfd0-47c2ac969c02"],
 " | Obsolete in: ",
 Cell[" ", "HistoryData",
  CellTags->"Obsolete",ExpressionUUID->"9a4e8bf1-a4be-4d22-b1c9-d1f984344745"],
 " | Excised in: ",
 Cell[" ", "HistoryData",
  CellTags->"Excised",ExpressionUUID->"e3397f0b-dc39-464d-bced-df03b205b6fe"]
}], "History",
 CellID->1247902091,ExpressionUUID->"fdc71b54-ac06-4bbc-97ac-9700b4288ae1"],

Cell[CellGroupData[{

Cell["Categorization", "CategorizationSection",
 CellID->1122911449,ExpressionUUID->"e9dddc8d-d210-4bc1-81aa-e0155fbd0f28"],

Cell["Symbol", "Categorization",
 CellLabel->"Entity Type",
 CellID->686433507,ExpressionUUID->"f74d4bf7-b42e-43b0-8923-84387668c780"],

Cell["MaXrd", "Categorization",
 CellChangeTimes->{3.743836663175869*^9},
 CellLabel->"Paclet Name",
 CellID->605800465,ExpressionUUID->"357884a1-475b-4f77-bb40-04f1f75163f9"],

Cell["MaXrd`", "Categorization",
 CellChangeTimes->{3.7438366635029488`*^9},
 CellLabel->"Context",
 CellID->468444828,ExpressionUUID->"853435b8-965f-48a9-8a09-7b828a751ff7"],

Cell["MaXrd/ref/InputCheck", "Categorization",
 CellChangeTimes->{3.743836663862268*^9},
 CellLabel->"URI",ExpressionUUID->"ea8230b8-3985-46a4-ad52-c4eb4cf86943"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Keywords", "KeywordsSection",
 CellID->477174294,ExpressionUUID->"60e8163c-620a-468e-a1e1-75370b55eaaf"],

Cell["XXXX", "Keywords",
 CellID->1164421360,ExpressionUUID->"29b99378-56fa-4d85-a5b8-449d6fe4dd15"]
}, Closed]],

Cell[CellGroupData[{

Cell["Syntax Templates", "TemplatesSection",
 CellID->1872225408,ExpressionUUID->"eddd82dd-3c25-4cdd-a392-bf8ca2f808d2"],

Cell[BoxData[""], "Template",
 CellLabel->"Additional Function Template",
 CellID->1562036412,ExpressionUUID->"d5e032e7-1745-4899-9c1c-4c24a3c98ccc"],

Cell[BoxData[""], "Template",
 CellLabel->"Arguments Pattern",
 CellID->158391909,ExpressionUUID->"aae2125b-a9a0-404c-9dd4-59c485c6ab9c"],

Cell[BoxData[""], "Template",
 CellLabel->"Local Variables",
 CellID->1360575930,ExpressionUUID->"9f599eaa-98d9-4bec-82fd-b903bce3cfd1"],

Cell[BoxData[""], "Template",
 CellLabel->"Color Equal Signs",
 CellID->793782254,ExpressionUUID->"6d648b74-eb73-4649-89f8-b82322861197"]
}, Closed]],

Cell[CellGroupData[{

Cell["Details", "DetailsSection",
 CellID->307771771,ExpressionUUID->"a14dbfd8-6ea5-467c-919b-4061d93639cf"],

Cell["XXXX", "Details",
 CellLabel->"Lead",
 CellID->670882175,ExpressionUUID->"2c22aab7-f8b2-4db3-8d58-a7f10104032c"],

Cell["XXXX", "Details",
 CellLabel->"Developers",
 CellID->350963985,ExpressionUUID->"73898f00-f29f-42b6-9411-63b8853a39c4"],

Cell["XXXX", "Details",
 CellLabel->"Authors",
 CellID->8391405,ExpressionUUID->"3b9ca9b3-6a6e-4025-bf93-fde8b1fc8a00"],

Cell["XXXX", "Details",
 CellLabel->"Feature Name",
 CellID->3610269,ExpressionUUID->"bf9075d1-d1c5-4c0f-b79c-5c5b21b66556"],

Cell["XXXX", "Details",
 CellLabel->"QA",
 CellID->401364205,ExpressionUUID->"6af75976-a00d-4dcc-acab-d3e1df6358d0"],

Cell["XXXX", "Details",
 CellLabel->"DA",
 CellID->350204745,ExpressionUUID->"b5c23224-9017-4a26-a9e5-5e1b475243da"],

Cell["XXXX", "Details",
 CellLabel->"Docs",
 CellID->732958810,ExpressionUUID->"c0b9fcf3-ecb2-4719-832b-98e178ef467e"],

Cell["XXXX", "Details",
 CellLabel->"Features Page Notes",
 CellID->222905350,ExpressionUUID->"b9cc9b4f-d0ef-4ae5-afc2-f1f0c3a21aa6"],

Cell["XXXX", "Details",
 CellLabel->"Comments",
 CellID->240026365,ExpressionUUID->"130363d4-35b8-4193-8170-e591801c3073"]
}, Closed]],

Cell[CellGroupData[{

Cell["InputCheck", "ObjectName",
 CellID->1224892054,ExpressionUUID->"3baa8d83-4af8-44db-8ef6-3d3268c9ff04"],

Cell[TextData[{
 Cell["   ", "ModInfo",ExpressionUUID->"7ce3dbae-1c9b-4673-a51d-00832b21860e"],
 Cell[BoxData[
  RowBox[{
   ButtonBox["InputCheck",
    BaseStyle->"Link",
    ButtonData->"paclet:MaXrd/ref/InputCheck"], "[", 
   RowBox[{
    StyleBox["input", "TI"], ",", 
    SubscriptBox[
     StyleBox["label", "TI"], 
     StyleBox["1", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"], ",", 
    SubscriptBox[
     StyleBox["label", "TI"], 
     StyleBox["n", "TI"]]}], "]"}]], "InlineFormula",ExpressionUUID->
  "fc634fa5-1a01-4dd5-af36-05f5a7bd8ed2"],
 " \[LineSeparator]checks ",
 Cell[BoxData[
  StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
  "8e5eb8b6-5c55-4fbc-a563-55adcc231909"],
 " according to each ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["label", "TI"], 
   StyleBox["i", "TI"]]], "InlineFormula",ExpressionUUID->
  "bb5a1a4d-71d3-4fa1-8a67-98a2f163b73d"],
 "."
}], "Usage",
 CellChangeTimes->{{3.6857039133083143`*^9, 3.685704064159664*^9}, {
  3.6857041231169777`*^9, 3.685704130173358*^9}},
 CellID->982511436,ExpressionUUID->"41256e38-425c-470a-8ab5-cfb59d42c9ac"],

Cell["\<\
This function is used to check input for other functions, and will throw \
error messages and abort the operations if necessary.\
\>", "Notes",
 CellChangeTimes->{{3.7301445969655046`*^9, 3.73014464896076*^9}},
 CellID->1871022088,ExpressionUUID->"001f21fe-2a54-4b11-872c-0fba927120ca"],

Cell["The following labels are recognised by the function:", "Notes",
 CellChangeTimes->{{3.685704074429822*^9, 3.6857040844398003`*^9}},
 CellID->1067943069,ExpressionUUID->"2c78fa21-baba-47fc-ba43-abee8fbf6428"],

Cell[BoxData[GridBox[{
   {Cell["      ", "ModInfo",ExpressionUUID->
     "1ae5979a-0c9e-4a1c-b14f-b672e76fd317"], "\"\<CrystalQ\>\"", Cell[
    TextData[{
     "check if ",
     Cell[BoxData[
      StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
      "53698d10-4c7e-4b1b-b594-4e23724cfe11"],
     " exists in ",
     StyleBox[ButtonBox["$CrystalData",
      BaseStyle->"Link",
      ButtonData->"paclet:MaXrd/ref/$CrystalData"], "InlineCode"]
    }], "TableText",ExpressionUUID->"c12424af-083c-405b-9432-c697d29393b7"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "cf5d1983-c10a-4c74-b581-e567c3cdcfd2"], "\"\<GetCentringVectors\>\"", 
    Cell[TextData[{
     "returns the centring vectors for centring type ",
     StyleBox["\"P\"", "InlineCode"],
     ", ",
     StyleBox["\"F\"", "InlineCode"],
     ", ",
     StyleBox["\"I\"", "InlineCode"],
     ", ",
     StyleBox["\"R\"", "InlineCode"],
     ", ",
     StyleBox["\"A\"", "InlineCode"],
     ", ",
     StyleBox["\"B\"", "InlineCode"],
     ", ",
     StyleBox["\"C\"", "InlineCode"],
     " or ",
     StyleBox["\"H\"", "InlineCode"]
    }], "TableText",ExpressionUUID->"1b2fb15c-4681-48aa-a1ae-dc42a49f3bac"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "b9b75b00-ccf4-47b3-894b-673754afbb14"], 
    "\"\<GetCrystalFormulaUnits\>\"", Cell[TextData[{
     "returns the value if stored with ",
     Cell[BoxData[
      StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
      "e9a581bd-2d18-41db-9a9d-3cf70ebb9547"],
     " (queries user if not)"
    }], "TableText",ExpressionUUID->"f48e6a22-4bc8-4e5a-a144-35520e779a2a"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "e6055be2-a464-4127-9690-486c4341edd9"], "\"\<GetCrystalSpaceGroup\>\"", 
    Cell[TextData[{
     "returns the space group of ",
     Cell[BoxData[
      StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
      "1cff4ab8-2d63-47c1-a6b4-cfe1b90e43a8"],
     " (validity is checked)"
    }], "TableText",ExpressionUUID->"5c9eed34-5c0d-4d55-8d71-e7c5c014eb2a"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "cb00a2d6-3aff-4932-a722-979cd9ab859b"], "\"\<GetCrystalWavelength\>\"", 
    Cell["\<\
extracts the wavelength of crystal; returns error if not available\
\>", "TableText",ExpressionUUID->"f6d22a59-7d90-4740-be64-b0a8b3887c71"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "2b322cb2-cf42-42cb-a618-de6b7f01c770"], "\"\<GetEnergyWavelength\>\"", 
    Cell["returns the input converted to \[ARing]ngstr\[ODoubleDot]ms", 
     "TableText",ExpressionUUID->"9647babb-2637-4663-b504-3721bcd3acf8"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "50ef9d0c-02d0-4510-bb35-0c310e6a4e42"], 
    "\"\<GetPointSpaceGroupCrystal\>\"", Cell[TextData[{
     "returns the ",
     Cell[BoxData[
      StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
      "01ba2af8-7a8a-4382-89e0-b420e56d8b17"],
     " if point- or space gorup, or returns the space group of ",
     Cell[BoxData[
      StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
      "d000a682-a219-46b8-a956-e717007ed893"]
    }], "TableText",ExpressionUUID->"465e73ed-7d5e-418a-9f92-63b5fed10827"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "1b3397a5-b798-4e0a-9315-9254accc6683"], "\"\<InterpretElement\>\"", 
    Cell["\<\
returns the chemical element (or ion) as interpreted from input\
\>", "TableText",ExpressionUUID->"3760ad8a-ee49-4c4d-bc92-268a5951fdca"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "018a9f50-4668-42d4-b1d8-3f6befa7e411"], "\"\<InterpretSpaceGroup\>\"", 
    Cell["interprets and returns space group symbol of input", "TableText",
     ExpressionUUID->"f5aeb43b-6cf7-4c53-9b8e-a8b941781166"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "bab1c40c-7bab-48c6-b658-89e991633c4e"], "\"\<PointGroupQ\>\"", Cell[
    "checks whether input is a point group", "TableText",ExpressionUUID->
     "ae5f57a9-3002-4964-83f9-dd9712161eb9"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "ae936216-b757-4994-abf4-e0fe10af1de2"], "\"\<PointSpaceGroupQ\>\"", 
    Cell[TextData[{
     "checks wheter input is a point group ",
     StyleBox["or",
      FontSlant->"Italic"],
     " a space group"
    }], "TableText",ExpressionUUID->"a41af7fc-321f-4975-b566-f80babcfe746"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "b46e674f-2056-4fad-b9d7-30a847f6741f"], "\"\<Polarisation\>\"", Cell["\<\
returns the polarisation factor based in inputted type label and scattering \
angle\
\>", "TableText",ExpressionUUID->"e8901563-4b8e-4498-9a98-f22a3d53c52e"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "58fc59c7-d230-49bc-9168-1bd55cd83106"], "\"\<ProcessWavelength\>\"", 
    Cell[TextData[{
     "combines \"",
     StyleBox["GetCrystalWavelength\"", "InlineCode"],
     " and \"",
     StyleBox["GetEnergyWavelength\"", "InlineCode"]
    }], "TableText",ExpressionUUID->"4558dd9e-e55a-46b1-9229-0503f181e556"]}
  }]], "2ColumnTableMod",
 TaggingRules->{"Alphabetized" -> True},
 CellChangeTimes->{{3.6857041593039923`*^9, 3.685704385885721*^9}, {
   3.712470119136633*^9, 3.712470142546645*^9}, {3.712470206096217*^9, 
   3.712470208409944*^9}, {3.712470250039815*^9, 3.712470263198851*^9}, {
   3.7129910206978903`*^9, 3.712991022112116*^9}, 3.712991429165224*^9, {
   3.712991492974319*^9, 3.712991521880334*^9}, {3.713604767567864*^9, 
   3.713604809407094*^9}, {3.71361037432854*^9, 3.71361041316577*^9}, {
   3.726899677829771*^9, 3.726899757529422*^9}, {3.72689979189118*^9, 
   3.7268997918938103`*^9}, {3.727604075156392*^9, 3.727604095197422*^9}, {
   3.727604147054541*^9, 3.727604152105096*^9}, {3.7276041868043747`*^9, 
   3.727604243143778*^9}, {3.727604284877911*^9, 3.727604300701682*^9}, {
   3.7276043426864347`*^9, 3.72760436847675*^9}, {3.727604415553624*^9, 
   3.7276045388666162`*^9}, {3.730144747192552*^9, 3.730144788357606*^9}, {
   3.730395585914061*^9, 3.7303956257751303`*^9}, {3.734082943487529*^9, 
   3.73408299298884*^9}, {3.7372783585322533`*^9, 3.73727837669975*^9}, {
   3.737278428579174*^9, 3.737278521718905*^9}, {3.7379758575998173`*^9, 
   3.737975879365003*^9}},
 CellID->222684676,ExpressionUUID->"44972062-e889-4cbd-901b-97a5f4aa7f9f"],

Cell["\<\
The following labels are also recognised by the function, and are useful when \
checking lists of reflections or coordinates:\
\>", "Notes",
 CellChangeTimes->{{3.737278179087699*^9, 3.7372782155037813`*^9}},
 CellID->221498276,ExpressionUUID->"8484f326-b3fa-4348-934d-718b122fc57f"],

Cell[BoxData[GridBox[{
   {Cell["      ", "ModInfo",ExpressionUUID->
     "029e1001-b3e7-4f34-bc62-01fe56ad2698"], "\"\<1hkl\>\"", Cell[TextData[{
     "checks if only one reflection is contained in ",
     Cell[BoxData[
      StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
      "8d74bcf9-27ef-47fc-9a85-597b7d70ca83"]
    }], "TableText",ExpressionUUID->"17301f26-fb94-4e6f-ac09-3b189c2e18d9"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "52dacb9c-7d9b-4798-b537-d7f0c20e13e8"], "\"\<1xyz\>\"", Cell[TextData[{
     "checks if only one coordinate is contained in ",
     Cell[BoxData[
      StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
      "84e3d47e-9dbf-4e87-90aa-33a259c90f9f"]
    }], "TableText",ExpressionUUID->"e0220099-be34-4e83-8407-4e9d3f37a69a"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "4faa099d-7565-4ea4-9b81-1d2472993ec7"], "\"\<Integer\>\"", Cell[
    "checks whether all indices are integers", "TableText",ExpressionUUID->
     "482f8a1a-5a4a-46c0-b265-355c57b7bb24"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "ff800299-feac-48c2-b1f6-3272689faa7e"], "\"\<Mutliple\>\"", Cell[
    TextData[{
     "checks if at least two entries are contained in ",
     Cell[BoxData[
      StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
      "de9616da-5401-49e7-88d9-86a350e926db"]
    }], "TableText",ExpressionUUID->"878c54d0-c91d-41a4-8f64-0248705052d4"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "3bc48d8a-2c29-4e28-bbf4-058cd67d1b21"], "\"\<StringSymbol\>\"", Cell[
    TextData[{
     "checks if the heads of the indices are either ",
     StyleBox["Integer", "InlineCode"],
     ", ",
     StyleBox["String", "InlineCode"],
     " or ",
     StyleBox["Symbol", "InlineCode"]
    }], "TableText",ExpressionUUID->"37e8829d-f66d-4199-8f33-53fae887aa23"]},
   {Cell["      ", "ModInfo",ExpressionUUID->
     "5df26e51-ec11-430c-9483-d8f6f38b7adc"], "\"\<WrapSingle\>\"", Cell[
    TextData[{
     "returns single reflections ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        StyleBox["h", "TI"], ",", 
        StyleBox["k", "TI"], ",", 
        StyleBox["l", "TI"]}], "}"}]], "InlineFormula",ExpressionUUID->
      "7178fe90-8f61-45f6-bb90-f693a233ea65"],
     " as ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["h", "TI"], ",", 
         StyleBox["k", "TI"], ",", 
         StyleBox["l", "TI"]}], "}"}], "}"}]], "InlineFormula",ExpressionUUID->
      "628b9fcd-4271-47de-b9a0-7c84979ba8d3"]
    }], "TableText",ExpressionUUID->"dacc1059-b653-4208-ab4a-1521cd718104"]}
  }]], "2ColumnTableMod",
 TaggingRules->{"Alphabetized" -> True},
 CellChangeTimes->{{3.6857041593039923`*^9, 3.685704385885721*^9}, {
   3.712470119136633*^9, 3.712470142546645*^9}, {3.712470206096217*^9, 
   3.712470208409944*^9}, {3.712470250039815*^9, 3.712470263198851*^9}, {
   3.7129910206978903`*^9, 3.712991022112116*^9}, 3.712991429165224*^9, {
   3.712991492974319*^9, 3.712991521880334*^9}, {3.713604767567864*^9, 
   3.713604809407094*^9}, {3.71361037432854*^9, 3.71361041316577*^9}, {
   3.726899677829771*^9, 3.726899757529422*^9}, {3.72689979189118*^9, 
   3.7268997918938103`*^9}, {3.727604075156392*^9, 3.727604095197422*^9}, {
   3.727604147054541*^9, 3.727604152105096*^9}, {3.7276041868043747`*^9, 
   3.727604243143778*^9}, {3.727604284877911*^9, 3.727604300701682*^9}, {
   3.7276043426864347`*^9, 3.72760436847675*^9}, {3.727604415553624*^9, 
   3.7276045388666162`*^9}, {3.730144747192552*^9, 3.730144788357606*^9}, {
   3.730395585914061*^9, 3.7303956257751303`*^9}, {3.734082943487529*^9, 
   3.73408299298884*^9}, {3.737278228918571*^9, 3.737278299718014*^9}},
 CellID->1183224025,ExpressionUUID->"cdb14cca-8cd5-4f48-a1cf-86ce05380363"],

Cell[TextData[{
 Cell[BoxData[
  ButtonBox["Dimensions",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Dimensions"]], "InlineFormula",ExpressionUUID->
  "6bbf7e0c-1497-4c6c-ba88-15c93ac63fab"],
 ButtonBox[" o",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/Dimensions"],
 "f ",
 Cell[BoxData[
  StyleBox["input", "TI"]], "InlineFormula",ExpressionUUID->
  "478ea02d-6178-4047-9ec7-893834c3210d"],
 " will always be checked if the head is ",
 Cell[BoxData[
  ButtonBox["List",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/List"]], "InlineFormula",ExpressionUUID->
  "ada6f961-ad91-4527-a375-53cd72ebd4cd"],
 "."
}], "Notes",
 CellChangeTimes->{{3.685704420969385*^9, 3.6857044611269083`*^9}, 
   3.712470238961151*^9, {3.71361042369636*^9, 3.713610450789268*^9}},
 CellID->1298381760,ExpressionUUID->"d4a11f0a-aaba-46df-b325-8f93165e101d"],

Cell[TextData[{
 "When using the ",
 Cell[BoxData["\<\"EnergyWavelength\"\>"], "InlineFormula",ExpressionUUID->
  "65795def-59a3-4db4-b0d0-9aaa19f9a202"],
 " label, inputted numbers that are 5 or smaller will be interpreted as \
having \[ARing]ngstr\[ODoubleDot]m as unit; numbers up to 250 are considered \
to be in kiloelectronvolts; larger numbers are considered to be in \
electronvolts."
}], "Notes",
 CellChangeTimes->{{3.726900086358438*^9, 3.7269002155328627`*^9}, {
  3.7269002482495213`*^9, 3.726900284565283*^9}},
 CellID->1980014868,ExpressionUUID->"7251811d-94d2-4407-9797-e6db10c5a23b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tutorials", "TutorialsSection",
 CellID->250839057,ExpressionUUID->"e9f00a5a-edd0-4bfb-9d62-cdb78d58f8cd"],

Cell["XXXX", "Tutorials",
 CellID->341631938,ExpressionUUID->"fce90d1c-f658-4ff5-8eff-cef9e20fc6be"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Demonstrations", "RelatedDemonstrationsSection",
 CellID->1268215905,ExpressionUUID->"7d7e4ddc-ff24-46b0-ab50-8cae9facf2e4"],

Cell["XXXX", "RelatedDemonstrations",
 CellID->1129518860,ExpressionUUID->"5203a146-6140-40a7-9ab3-82202a61da10"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Links", "RelatedLinksSection",
 CellID->1584193535,ExpressionUUID->"1b8f8346-6e94-40dc-8d25-c0eb7572bb7b"],

Cell["XXXX", "RelatedLinks",
 CellID->1038487239,ExpressionUUID->"3e7c68e8-cd5c-4aef-ae06-a19bcff9cad4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["See Also", "SeeAlsoSection",
 CellID->1255426704,ExpressionUUID->"cd66dfec-b844-4e8d-bbc6-50e2b739eee8"],

Cell[TextData[{
 Cell[BoxData[
  ButtonBox["GetAtomicScatteringFactors",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/GetAtomicScatteringFactors"]], 
  "InlineFormula",ExpressionUUID->"2584139c-df46-49ec-b3ab-d95d0a7c326e"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["AttenuationCoefficient",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/AttenuationCoefficient"]], "InlineFormula",
  ExpressionUUID->"dcc8abd8-7840-497b-b4d6-2d3df1be2f4d"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["BraggAngle",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/BraggAngle"]], "InlineFormula",
  ExpressionUUID->"c8685983-7112-49f2-b114-30e5ccd318bd"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["CrystalDensity",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/CrystalDensity"]], "InlineFormula",
  ExpressionUUID->"9e4a70bd-d503-493d-9811-9a756c35c47f"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["GetCrystalMetric",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/GetCrystalMetric"]], "InlineFormula",
  ExpressionUUID->"7af55df9-e2e9-4f4a-bed6-ac6ac0b063fa"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["DarwinWidth",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/DarwinWidth"]], "InlineFormula",
  ExpressionUUID->"6b36c40c-9028-44bf-9d58-bfe1229998f9"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["ExtinctionLength",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/ExtinctionLength"]], "InlineFormula",
  ExpressionUUID->"2c0565fb-64a7-426a-9226-4fb318d24087"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["InterplanarSpacing",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/InterplanarSpacing"]], "InlineFormula",
  ExpressionUUID->"fcbb714f-94d0-4c29-bcd0-20891ac3e71b"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["GetLatticeParameters",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/GetLatticeParameters"]], "InlineFormula",
  ExpressionUUID->"8e812723-8e9a-47f8-a40b-ae54b4a09155"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["SymmetryEquivalentReflections",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/SymmetryEquivalentReflections"]], 
  "InlineFormula",ExpressionUUID->"72085e1e-dd81-4738-ac8d-f867dbb1e177"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["MergeSymmetryEquivalentReflections",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/MergeSymmetryEquivalentReflections"]], 
  "InlineFormula",ExpressionUUID->"181d8249-a6fd-4bc0-bfd6-5af75b48b044"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["$GroupSymbolRedirect",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/$GroupSymbolRedirect"]], "InlineFormula",
  ExpressionUUID->"09894eef-7216-4fd5-b4cd-004747ebe70b"],
 " \[EmptyVerySmallSquare] ",
 Cell[BoxData[
  ButtonBox["$CrystalData",
   BaseStyle->"Link",
   ButtonData->"paclet:MaXrd/ref/$CrystalData"]], "InlineFormula",
  ExpressionUUID->"cd053f37-81d3-4e5e-ba2b-ef94403898e7"]
}], "SeeAlso",
 CellChangeTimes->{{3.730144904861742*^9, 3.73014497690689*^9}, {
  3.737968449383374*^9, 3.737968506274226*^9}, {3.743865461526078*^9, 
  3.743865461526929*^9}, {3.743865861333652*^9, 3.7438658613341*^9}},
 CellID->929782353,ExpressionUUID->"de3c51f2-79e1-44fd-85a3-a08757257073"]
}, Open  ]],

Cell[CellGroupData[{

Cell["More About", "MoreAboutSection",
 CellID->38303248,ExpressionUUID->"3ade4251-f64b-4f1c-b390-ef6e588014a9"],

Cell["XXXX", "MoreAbout",
 CellID->1665078683,ExpressionUUID->"13391473-9a54-4fc0-b37a-9a3a1700f031"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     StyleBox["Examples", "PrimaryExamplesSection"], 
     ButtonBox[
      RowBox[{
       RowBox[{"More", " ", "Examples"}], " ", "\[RightTriangle]"}],
      BaseStyle->"ExtendedExamplesLink",
      ButtonData:>"ExtendedExamples"]}
   }],
  $Line = 0; Null]], "PrimaryExamplesSection",
 CellID->880084151,ExpressionUUID->"4776a377-a5f0-4a8b-a91a-c0f6323166ab"],

Cell["Basic checks of the dimensions of input:", "ExampleText",
 CellChangeTimes->{{3.685704512282283*^9, 3.685704533756753*^9}},
 CellID->1837160032,ExpressionUUID->"0a82a8cc-fb85-4469-a1af-3ea44c4eb58c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.685682187670844*^9, 3.685682193912095*^9}, {
   3.6856941196527147`*^9, 3.6856941217345247`*^9}, 3.685695809212805*^9},
 CellLabel->"In[1]:=",
 CellID->1367903769,ExpressionUUID->"d699e5c1-a445-41a3-8e98-9bb4d0257a6e"],

Cell[BoxData[
 TemplateBox[{
  "InputCheck","dim",
   "\"Reflections (and coordinates) must be on a \
{\\!\\(\\*StyleBox[\\\"h\\\", \\\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"k\\\", \\\
\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"l\\\", \\\"TI\\\"]\\)} (or \
{\\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"y\\\", \\\
\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"z\\\", \\\"TI\\\"]\\)}) form\"",2,1,10,
   26454305481356162274,"Local","MaXrd`InputCheck"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.6857044752066717`*^9, 3.685704583047021*^9, 
  3.712991126810546*^9, 3.713610473428308*^9, 3.717150009868435*^9, 
  3.730144850005862*^9, 3.737975902065364*^9},
 CellLabel->"During evaluation of In[1]:=",
 CellID->1326644799,ExpressionUUID->"18d9f8d8-bb4c-487e-a629-4549e200e98e"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.717150009874456*^9, 3.7301448500297537`*^9, 
  3.737975902088067*^9},
 CellLabel->"Out[1]=",
 CellID->1743913639,ExpressionUUID->"c5fdaa4d-abac-467f-91d9-20d78235d7b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", 
    RowBox[{"{", "2", "}"}], ",", "3"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.685694125373831*^9, 3.685694126091176*^9}, 
   3.685695810015901*^9},
 CellLabel->"In[2]:=",
 CellID->1815249394,ExpressionUUID->"c1ae7082-04fb-4c8d-8f91-833ea8aaae60"],

Cell[BoxData[
 TemplateBox[{
  "InputCheck","dim",
   "\"Reflections (and coordinates) must be on a \
{\\!\\(\\*StyleBox[\\\"h\\\", \\\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"k\\\", \\\
\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"l\\\", \\\"TI\\\"]\\)} (or \
{\\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"y\\\", \\\
\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"z\\\", \\\"TI\\\"]\\)}) form\"",2,2,11,
   26454305481356162274,"Local","MaXrd`InputCheck"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.7171500106784363`*^9, 3.7301448506915417`*^9, 
  3.737975902922668*^9},
 CellLabel->"During evaluation of In[2]:=",
 CellID->165158378,ExpressionUUID->"2de3afa9-67ed-4712-bb33-e5c726129239"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.717150010684304*^9, 3.730144850717598*^9, 
  3.737975902944869*^9},
 CellLabel->"Out[2]=",
 CellID->1267987122,ExpressionUUID->"7ebdf8a8-18db-480d-8e8c-3aca56174367"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "7", ",", "8"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.685694131434422*^9, 3.685694139163189*^9}, 
   3.685695810968719*^9},
 CellLabel->"In[3]:=",
 CellID->461672276,ExpressionUUID->"f476ddf7-29ae-47ac-bba9-4c9401d0bcfa"],

Cell[BoxData[
 TemplateBox[{
  "InputCheck","dim",
   "\"Reflections (and coordinates) must be on a \
{\\!\\(\\*StyleBox[\\\"h\\\", \\\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"k\\\", \\\
\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"l\\\", \\\"TI\\\"]\\)} (or \
{\\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"y\\\", \\\
\"TI\\\"]\\), \\!\\(\\*StyleBox[\\\"z\\\", \\\"TI\\\"]\\)}) form\"",2,3,12,
   26454305481356162274,"Local","MaXrd`InputCheck"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.685704583602427*^9, 3.712991127163795*^9, 
  3.7171500120471373`*^9, 3.7301448515269203`*^9, 3.7379759038275747`*^9},
 CellLabel->"During evaluation of In[3]:=",
 CellID->1842461307,ExpressionUUID->"327d3a70-bb9c-488a-ac32-661396874f34"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7171500120531693`*^9, 3.73014485154694*^9, 
  3.737975903849699*^9},
 CellLabel->"Out[3]=",
 CellID->1680480656,ExpressionUUID->"eca19544-0b8a-4d2f-af44-9363176b4f46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "7afc5bc5-d440-40db-b46a-a58ac6cb32d1"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->467526121,ExpressionUUID->"0e182396-b6d4-4b4e-be5e-786810256602"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
   "\"\<1hkl\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.68569416169731*^9, 3.685694176594686*^9}, 
   3.685695812640456*^9, {3.7129911059487143`*^9, 3.7129911065089817`*^9}},
 CellLabel->"In[1]:=",
 CellID->1466599491,ExpressionUUID->"06f3f384-6d0f-4d06-9976-949245899583"],

Cell[BoxData[
 TemplateBox[{
  "InputCheck","one",
   "\"Only one \\!\\(\\*RowBox[{\\\"\\\\\\\"reflection\\\\\\\"\\\"}]\\) \
expected.\"",2,1,13,26454305481356162274,"Local","MaXrd`InputCheck"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.685704587786343*^9, {3.7129911072195663`*^9, 3.712991121227496*^9}, {
   3.713610475415415*^9, 3.713610477220684*^9}, 3.7171500153103724`*^9, 
   3.730144854732254*^9, 3.737975908049387*^9},
 CellLabel->"During evaluation of In[1]:=",
 CellID->167193413,ExpressionUUID->"ad45f02a-66b2-4929-9c59-de41eea521e0"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7171500153164682`*^9, 3.730144854751865*^9, 
  3.737975908071785*^9},
 CellLabel->"Out[1]=",
 CellID->1111082015,ExpressionUUID->"2a44cf3b-d2be-46de-9c1b-049cd86ab327"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6.0"}], "}"}]}], "}"}], ",", 
   "\"\<Integer\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.6856942050075912`*^9, 3.685694213049779*^9}, 
   3.6856958157276773`*^9, {3.7428785343053837`*^9, 3.742878547591321*^9}},
 CellLabel->"In[2]:=",
 CellID->320344971,ExpressionUUID->"928167ca-584a-48ad-ad2d-cd4c49d9ac0e"],

Cell[BoxData[
 TemplateBox[{
  "InputCheck","integer","\"One or more indices are not integers.\"",2,2,14,
   26454305481356162274,"Local","MaXrd`InputCheck"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.685704588103698*^9, {3.712991114428811*^9, 3.712991121397358*^9}, 
   3.713610477829769*^9, 3.7171500164537067`*^9, 3.730144855221924*^9, 
   3.737975908907868*^9},
 CellLabel->"During evaluation of In[2]:=",
 CellID->1995402594,ExpressionUUID->"1ab9def8-73a8-461f-ba61-f954b60ded48"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.717150016459592*^9, 3.730144855242116*^9, 
  3.737975908929323*^9},
 CellLabel->"Out[2]=",
 CellID->1626765806,ExpressionUUID->"d2e80b9d-0408-4047-8361-163d91b9add7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"2", "/", "3"}], ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.2", ",", "3.4", ",", "5.6"}], "}"}]}], "}"}], ",", 
   "\"\<StringSymbol\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.6856955099608507`*^9, 3.685695512162052*^9}, {
  3.685695818848517*^9, 3.685695845360194*^9}},
 CellLabel->"In[3]:=",
 CellID->296424568,ExpressionUUID->"e47e6529-b345-44e5-9a14-9d0c02d0d549"],

Cell[BoxData[
 TemplateBox[{
  "InputCheck","head",
   "\"Head of indices must be either Integer, String or Symbol.\"",2,3,15,
   26454305481356162274,"Local","MaXrd`InputCheck"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.6857045883736362`*^9, 3.71299112157867*^9, 
  3.713610478447878*^9, 3.717150017634869*^9, 3.730144855772826*^9, 
  3.73797590938745*^9},
 CellLabel->"During evaluation of In[3]:=",
 CellID->2101297538,ExpressionUUID->"f134d6d1-061f-4830-b3ad-8f2adb7f3104"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.717150017640448*^9, 3.7301448557922153`*^9, 
  3.737975909409686*^9},
 CellLabel->"Out[3]=",
 CellID->1139146251,ExpressionUUID->"2a06391d-4362-4e7d-bbc3-bd38f8bc36ad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "8f401afd-976a-4532-b0eb-81aae8123761"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1993136983,ExpressionUUID->"a44c8ca0-8ed4-4e93-bee7-4cf7666b37f8"],

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.685698073225049*^9, 3.685698094268888*^9}},
 CellLabel->"In[1]:=",
 CellID->81829532,ExpressionUUID->"ea7f89c5-66d8-48cb-be36-c83cb0ffdf97"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"input", "=", 
  RowBox[{"InputCheck", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "\"\<WrapSingle\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6856980842589693`*^9, 3.685698103245879*^9}},
 CellLabel->"In[2]:=",
 CellID->919410244,ExpressionUUID->"7c8f1a6e-cfab-4db6-b719-ea915c08d7a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.68570459349868*^9, 3.712991131916993*^9, 
  3.713610484718779*^9, 3.717150034349008*^9, 3.7301448596858883`*^9, 
  3.737975916345201*^9},
 CellLabel->"Out[2]=",
 CellID->336557919,ExpressionUUID->"1fcd9076-7b98-4065-8e8a-3849c67f7c50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"input", "=", 
  RowBox[{"InputCheck", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
    "\"\<WrapSingle\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6856981840459423`*^9, 3.685698208272111*^9}},
 CellLabel->"In[3]:=",
 CellID->1383130743,ExpressionUUID->"11bd0f99-b66f-4789-b2df-e070f9d19f82"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.685704593648739*^9, 3.71299113206889*^9, 
  3.713610485843293*^9, 3.717150035453704*^9, 3.730144860170301*^9, 
  3.737975917008471*^9},
 CellLabel->"Out[3]=",
 CellID->1767990849,ExpressionUUID->"1cc36577-fc7a-4a43-981b-72a513deb3a4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["More Examples", "ExtendedExamplesSection",
 CellTags->"ExtendedExamples",
 CellID->1854448968,ExpressionUUID->"d6f87363-4f4a-495d-87bb-c476bc779742"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "Scope", "ExampleSection",ExpressionUUID->
   "67d83800-f43b-4395-b88b-69b4075e31fa"],
  $Line = 0; Null]], "ExampleSection",
 CellID->1293636265,ExpressionUUID->"acea0833-02cc-4701-aaf3-a3f17f675653"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{"\"\<R\>\"", ",", "\"\<GetCentringVectors\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.734083043040859*^9, 3.734083053579599*^9}},
 CellLabel->"In[1]:=",
 CellID->384054987,ExpressionUUID->"c10b12f9-4871-45c0-8891-d1f2f73cf981"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "3"], ",", 
     FractionBox["1", "3"], ",", 
     FractionBox["1", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "3"], ",", 
     FractionBox["2", "3"], ",", 
     FractionBox["2", "3"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7340830538612213`*^9, {3.734083085461985*^9, 3.734083094806801*^9}, 
   3.737975928182765*^9},
 CellLabel->"Out[1]=",
 CellID->1573138389,ExpressionUUID->"805f9887-d1a1-41a5-b282-388e84abb1bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "1e2a0eed-1030-49d6-ace3-92f52fb562c0"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1117509503,ExpressionUUID->"6d00d4e4-5e8d-4219-b145-61ac051b3cb1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{
   TemplateBox[{"24.5","\"keV\"","kiloelectronvolts","\"Kiloelectronvolts\""},
    
    "Quantity"], ",", "\"\<GetEnergyWavelength\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.73408310792307*^9, 3.7340831587314167`*^9}},
 CellLabel->"In[1]:=",
 CellID->544578231,ExpressionUUID->"e53588fc-e2fb-46a2-bc6c-0b1b70ebeef8"],

Cell[BoxData[
 TemplateBox[{
  "0.5060579591836735`","\"\[CapitalARing]\"","\[ARing]ngstr\[ODoubleDot]ms",
   "\"Angstroms\""},
  "Quantity"]], "Output",
 CellChangeTimes->{{3.7340831378570423`*^9, 3.734083166906454*^9}, 
   3.7379759374358788`*^9},
 CellLabel->"Out[1]=",
 CellID->1638057539,ExpressionUUID->"c268afba-7b59-4a6e-bdba-d722efe77114"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "28aab8c9-f04b-46dd-8213-7fdb7ac5610a"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->92703433,ExpressionUUID->"5b4aa924-618a-4ba2-9ac2-cdfc4ed727ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{"\"\<he\>\"", ",", "\"\<InterpretElement\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.7379759559819717`*^9, 3.737975965739151*^9}},
 CellLabel->"In[1]:=",
 CellID->1138377229,ExpressionUUID->"0063f588-4570-4e7d-bd04-72f6fc6f995b"],

Cell[BoxData["\<\"He\"\>"], "Output",
 CellChangeTimes->{3.737975966055003*^9, 3.737976125768098*^9, 
  3.742878558677602*^9, 3.742878649017148*^9, 3.742879295155436*^9},
 CellLabel->"Out[1]=",
 CellID->201421237,ExpressionUUID->"95a6abc0-9831-47eb-bb05-6dbcde71ee93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<Ca2+\>\"", ",", "\"\<Ca+2\>\"", ",", "\"\<fe+3\>\"", ",", 
     "\"\<FE3+\>\"", ",", "\"\<k+\>\"", ",", "\"\<K-1\>\""}], "}"}], ",", 
   "\"\<InterpretElement\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.7379759673880873`*^9, 3.7379759765390673`*^9}, {
  3.737976050091669*^9, 3.737976080988471*^9}, {3.742878569029066*^9, 
  3.742878570135693*^9}, {3.7428792466829233`*^9, 3.742879259195181*^9}},
 CellLabel->"In[2]:=",
 CellID->1889735775,ExpressionUUID->"15b3a064-a41a-423f-a1b1-a7708d980798"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Ca2+\"\>", ",", "\<\"Ca2+\"\>", ",", "\<\"Fe3+\"\>", 
   ",", "\<\"Fe3+\"\>", ",", "\<\"K1+\"\>", ",", "\<\"K1-\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.737976074977096*^9, 3.7379760813854303`*^9}, 
   3.73797612590658*^9, {3.742878560678401*^9, 3.742878577879129*^9}, 
   3.742878649233953*^9, 3.742879259768222*^9, 3.742879295372608*^9},
 CellLabel->"Out[2]=",
 CellID->852502587,ExpressionUUID->"67d9a3f9-befb-46a3-b969-f385c0612894"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{"\"\<Fx01\>\"", ",", "\"\<InterpretElement\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.7379761015300503`*^9, 3.7379761202320557`*^9}},
 CellLabel->"In[3]:=",
 CellID->2118692029,ExpressionUUID->"97619ab2-dc5c-4729-b7e8-4409d85ec417"],

Cell[BoxData["\<\"F\"\>"], "Output",
 CellChangeTimes->{{3.737976105388864*^9, 3.737976126040214*^9}, 
   3.742878649433844*^9, 3.742879261692822*^9, 3.742879295572098*^9},
 CellLabel->"Out[3]=",
 CellID->86925,ExpressionUUID->"b88bb2e4-49ba-4789-b193-c8d3865cd2b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputCheck", "[", 
  RowBox[{"\"\<Je2+\>\"", ",", "\"\<InterpretElement\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.7379760943860073`*^9, 3.7379760947445*^9}},
 CellLabel->"In[4]:=",
 CellID->334541063,ExpressionUUID->"172704c2-2e80-4016-a0b0-b1a9802c3fb8"],

Cell[BoxData[
 TemplateBox[{
  "InputCheck","ElementError",
   "\"The element \[LeftGuillemet]\\!\\(\\*RowBox[{\\\"\\\\\\\"Je2+\\\\\\\"\\\
\"}]\\)\[RightGuillemet] cannot be interpreted.\"",2,4,2,26483092922271445349,
   "Local","MaXrd`InputCheck"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.737976095363634*^9, 3.737976126168386*^9, 
  3.742878649680561*^9, 3.742879295768867*^9},
 CellLabel->"During evaluation of In[4]:=",
 CellID->1460948475,ExpressionUUID->"b434d3d4-b6d8-41c5-bb97-6b71a588387a"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.737976095370049*^9, 3.737976126193619*^9, 
  3.742878649720689*^9, 3.742879295810626*^9},
 CellLabel->"Out[4]=",
 CellID->1980483174,ExpressionUUID->"996964ab-e112-4a72-852d-1626f9395e8a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 InterpretationBox[Cell[
  "Generalizations & Extensions", "ExampleSection",ExpressionUUID->
   "dd2999a5-ce07-46e5-b7e9-e0eb8e614a9b"],
  $Line = 0; Null]], "ExampleSection",
 CellID->1020263627,ExpressionUUID->"dc89e3eb-0fa8-4aea-be71-c0557c05fecd"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "Options", "ExampleSection",ExpressionUUID->
   "395605df-0302-41b5-aa18-e9d1852d859a"],
  $Line = 0; Null]], "ExampleSection",
 CellID->2061341341,ExpressionUUID->"294ace5b-178b-44eb-948d-0a5b45b96055"],

Cell[BoxData[
 InterpretationBox[Cell[
  "XXXX", "ExampleSubsection",ExpressionUUID->
   "df973ee2-7e39-44f6-a498-5ba3369d677a"],
  $Line = 0; Null]], "ExampleSubsection",
 CellID->1757724783,ExpressionUUID->"0e958035-0e1c-4674-8054-d2569cff9ff6"],

Cell[BoxData[
 InterpretationBox[Cell[
  "XXXX", "ExampleSubsection",ExpressionUUID->
   "6d2331f9-fff2-4283-b26b-cd770255a264"],
  $Line = 0; Null]], "ExampleSubsection",
 CellID->1295379749,ExpressionUUID->"2bedbe77-d0e7-41b5-89aa-cc033f703185"]
}, Closed]],

Cell[BoxData[
 InterpretationBox[Cell[
  "Applications", "ExampleSection",ExpressionUUID->
   "c7aa7264-2c8a-4f1f-827d-6e8c56e25954"],
  $Line = 0; Null]], "ExampleSection",
 CellID->258228157,ExpressionUUID->"8d11c5d5-92af-4b2d-ab64-9a75e73d64d4"],

Cell[BoxData[
 InterpretationBox[Cell[
  "Properties & Relations", "ExampleSection",ExpressionUUID->
   "58fa8cd5-f7b8-4338-877d-9b59ba3764e9"],
  $Line = 0; Null]], "ExampleSection",
 CellID->2123667759,ExpressionUUID->"0a089dea-60a2-4b90-9f38-ed29be39e050"],

Cell[BoxData[
 InterpretationBox[Cell[
  "Possible Issues", "ExampleSection",ExpressionUUID->
   "179cf3a9-93d9-4906-9667-71b61cd8b518"],
  $Line = 0; Null]], "ExampleSection",
 CellID->1305812373,ExpressionUUID->"3cefeac4-125e-4e02-a713-78af05ed4e4b"],

Cell[BoxData[
 InterpretationBox[Cell[
  "Interactive Examples", "ExampleSection",ExpressionUUID->
   "d27a07fc-f47b-42da-9bbf-83cbc16ed394"],
  $Line = 0; Null]], "ExampleSection",
 CellID->1653164318,ExpressionUUID->"859c3c71-7303-4a22-902a-f6507b2d377d"],

Cell[BoxData[
 InterpretationBox[Cell[
  "Neat Examples", "ExampleSection",ExpressionUUID->
   "135e5b89-6d6d-4161-965f-744ab21b5a7f"],
  $Line = 0; Null]], "ExampleSection",
 CellID->589267740,ExpressionUUID->"da3fa7ce-3a1d-4e60-80ea-58ff3f9d1ef3"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[TextData[{
   StyleBox["Mathematica",
    FontSlant->"Italic"],
   " code"
  }], "ExampleSection",ExpressionUUID->"fc5abffe-d72d-4fbb-81ca-8ca607f36c58"],
  $Line = 0; Null]], "ExampleSection",
 CellChangeTimes->{{3.7136105055756683`*^9, 3.713610509942071*^9}},
 CellID->13108794,ExpressionUUID->"d27ab792-63b6-43fc-a7d1-f21dcce82e00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "label"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised check label.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "dim"}], "=", 
   "\"\<Reflections (and coordinates) must be on a {\!\(\*StyleBox[\"h\", \
\"TI\"]\), \!\(\*StyleBox[\"k\", \"TI\"]\), \!\(\*StyleBox[\"l\", \"TI\"]\)} \
(or {\!\(\*StyleBox[\"x\", \"TI\"]\), \!\(\*StyleBox[\"y\", \"TI\"]\), \
\!\(\*StyleBox[\"z\", \"TI\"]\)}) form\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "one"}], "=", 
   "\"\<Only one `1` expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "head"}], "=", 
   "\"\<Head of indices must be either Integer, String or Symbol.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "few"}], "=", 
   "\"\<At least two reflections are required to make comparisons.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyunit"}], "=", 
   "\"\<Input does not have a unit compatible with energy or \
wavelength.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyinput"}], "=", 
   "\"\<Input must be an energy or wavelength compatible Quantity, or a \
number.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "poslambda"}], "=", 
    "\"\<The wavelength/energy must be positive.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystal"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "wavelength"}], "=", 
   "\"\<No wavelength was found for crystal \[LeftGuillemet]`1`\
\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "userinput"}], "=", 
   "\"\<Invalid user input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "polarisation"}], "=", 
    "\"\<Invalid polarisation setting.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PSG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point- \
or space group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a space \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SGnumber"}], "=", 
   "\"\<Valid space group numbers are between 1 and 230.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystalSG"}], "=", 
   "\"\<Crystal entry \[LeftGuillemet]`1`\[RightGuillemet] has invalid space \
group \[LeftGuillemet]`2`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "PSGC"}], "=", 
    "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group, space group or a crystal.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "centringerror"}], "=", 
   "\"\<Invalid space group centring.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementNumber"}], "=", 
   "\"\<Element number `1` is out of range.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementFailed"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a \
chemical element.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "ElementError"}], "=", 
    "\"\<The element \[LeftGuillemet]`1`\[RightGuillemet] cannot be \
interpreted.\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "InputCheck"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "__", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.6856820263060083`*^9, 3.6856820338793163`*^9}, {
   3.685682083417005*^9, 3.685682092894709*^9}, {3.6856840260308533`*^9, 
   3.685684026178547*^9}, {3.685686819102976*^9, 3.6856868408053513`*^9}, {
   3.685687011142066*^9, 3.685687017829006*^9}, {3.685687131249773*^9, 
   3.685687151398356*^9}, {3.685687183159276*^9, 3.6856871838215933`*^9}, {
   3.685687254295497*^9, 3.685687281286789*^9}, {3.685687660039452*^9, 
   3.6856877115995817`*^9}, {3.68568838863011*^9, 3.6856884381337767`*^9}, {
   3.685690949932845*^9, 3.6856909574232817`*^9}, {3.685691048596792*^9, 
   3.685691065258542*^9}, {3.685691555385049*^9, 3.685691595897393*^9}, {
   3.685693407917099*^9, 3.6856934105491962`*^9}, {3.685693449539488*^9, 
   3.685693464972211*^9}, {3.685693732995039*^9, 3.6856937393916893`*^9}, {
   3.685693867613049*^9, 3.685693870503192*^9}, {3.685694016861869*^9, 
   3.685694053583612*^9}, {3.685694415120605*^9, 3.685694415410471*^9}, {
   3.6856953860999413`*^9, 3.685695404607368*^9}, {3.68569555947088*^9, 
   3.685695605133265*^9}, {3.685696124318612*^9, 3.68569613828201*^9}, {
   3.685696178849712*^9, 3.685696180401723*^9}, {3.685696592780033*^9, 
   3.6856965970349083`*^9}, {3.6870711449669037`*^9, 3.687071165830688*^9}, {
   3.6870725649937353`*^9, 3.687072567422408*^9}, {3.711081329746539*^9, 
   3.711081335862384*^9}, {3.711083709642126*^9, 3.71108372803414*^9}, {
   3.712990896317184*^9, 3.712990899230811*^9}, {3.713603056038671*^9, 
   3.7136030717991047`*^9}, 3.713603337329356*^9, {3.7136034598308163`*^9, 
   3.713603470204297*^9}, {3.713604348937676*^9, 3.71360436129599*^9}, {
   3.717147714818186*^9, 3.717147739983534*^9}, {3.7171480835458517`*^9, 
   3.717148091231995*^9}, {3.726560324583314*^9, 3.7265603577752657`*^9}, {
   3.726853588279467*^9, 3.7268536391946774`*^9}, {3.7271789201847763`*^9, 
   3.727178947159677*^9}, {3.7275066313384666`*^9, 3.72750665317505*^9}, {
   3.727513894430643*^9, 3.727513902461985*^9}, {3.727596618528956*^9, 
   3.727596645209611*^9}, {3.727601483861143*^9, 3.7276014841869497`*^9}, {
   3.7276028953923073`*^9, 3.727602914012473*^9}, {3.728109699712471*^9, 
   3.728109743760724*^9}, {3.728765837392223*^9, 3.728765846807078*^9}, {
   3.7340775949863367`*^9, 3.734077598710491*^9}, {3.7372791075805187`*^9, 
   3.73727914741197*^9}, {3.7372792368998547`*^9, 3.737279256825714*^9}, {
   3.737285569781273*^9, 3.737285603410686*^9}, {3.739187854951786*^9, 
   3.73918785517507*^9}, {3.742016334042914*^9, 3.742016337494812*^9}, {
   3.742016368507223*^9, 3.74201638931714*^9}, {3.7567126007785892`*^9, 
   3.756712616867313*^9}, 3.75671264844755*^9, {3.756712756093667*^9, 
   3.756712764043981*^9}, {3.75671279769972*^9, 3.756712815035034*^9}, {
   3.756713298279908*^9, 3.7567132995556707`*^9}},
 CellLabel->"In[418]:=",
 CellID->450030692,ExpressionUUID->"022ad615-eb20-4b2c-a9a5-5ba75a8c105f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", "\[IndentingNewLine]", 
   RowBox[{"input_List", ",", "\[IndentingNewLine]", 
    RowBox[{"labels___", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", ",", 
           "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
           "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], ",", 
         RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"check", ",", "hkl", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"check", "=", 
      RowBox[{"{", "labels", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
         "check", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", 
               ",", "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
               "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], 
             ",", "temp"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"InputCheck", "::", "label"}], ",", "temp"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dimensions", " ", "check", " ", 
       RowBox[{"(", 
        RowBox[{"always", " ", "required"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Single", " ", 
        RowBox[{"reflection", "/", "coordinate"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"input", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
            "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"hkl", "=", 
        RowBox[{"{", "input", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Multiple", " ", 
         RowBox[{"reflections", "/", "coordinates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
             RowBox[{"!", 
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
               "]"}]}]}]}], "]"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{"hkl", "=", "input"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "dim"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", 
       RowBox[{"reflection", "/", "coordinates"}], " ", "check"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1hkl\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<reflection\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1xyz\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<coordinate\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Multiple", " ", "reflections", " ", "check"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Multiple\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "<", "2"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "few"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Integer", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Integer\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "hkl"}], ",", "IntegerQ"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "integer"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "if", " ", "Integer"}], ",", " ", 
       RowBox[{"String", " ", "or", " ", "Symbol"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<StringSymbol\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ContainsAll", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Integer", ",", "String", ",", "Symbol", ",", "Times"}], 
             "}"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Head", "/@", 
             RowBox[{"Flatten", "@", "hkl"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "head"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wrap", " ", "single", " ", "reflections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<WrapSingle\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "input", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Return", "[", "input", "]"}]}], "\[IndentingNewLine]", "\t",
         "]"}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.687070782983131*^9, 3.687070826316058*^9}, {
   3.711080493388452*^9, 3.711080530269607*^9}, {3.7110838434149733`*^9, 
   3.711083844960722*^9}, {3.712990600076755*^9, 3.712990608318782*^9}, {
   3.712990804480831*^9, 3.7129908060016212`*^9}, {3.712990947248521*^9, 
   3.712990947808515*^9}, {3.713510243799721*^9, 3.7135102514986553`*^9}, {
   3.713510288538774*^9, 3.713510293259116*^9}, {3.7135103372502947`*^9, 
   3.713510338184915*^9}, {3.71431192571665*^9, 3.7143119392365303`*^9}, {
   3.7143120972494097`*^9, 3.714312097447524*^9}, {3.7143121915742683`*^9, 
   3.7143122110300217`*^9}, {3.714312273573138*^9, 3.714312308114839*^9}, {
   3.71445784032449*^9, 3.714457847602706*^9}, 3.714458049967931*^9, {
   3.7147109057397537`*^9, 3.714710909787726*^9}, {3.714710945019298*^9, 
   3.714710963965468*^9}, {3.717143871479184*^9, 3.717143873754469*^9}, {
   3.717146708601173*^9, 3.717146713501816*^9}, {3.717147467353772*^9, 
   3.717147472518999*^9}, {3.717147554646175*^9, 3.717147555923188*^9}, {
   3.717147595628448*^9, 3.717147596128397*^9}, 3.7171476872925243`*^9, {
   3.717147790297018*^9, 3.7171478112554407`*^9}, {3.7171480444680862`*^9, 
   3.717148048818454*^9}, {3.7171482182403383`*^9, 3.7171482183828487`*^9}, {
   3.717148818843635*^9, 3.717148834361803*^9}, {3.7171489319542913`*^9, 
   3.717148951600135*^9}, {3.717149178012879*^9, 3.71714919115486*^9}, {
   3.717149260050128*^9, 3.717149280072538*^9}, {3.717149333315688*^9, 
   3.717149397350493*^9}, {3.717149552908246*^9, 3.7171495813302383`*^9}, {
   3.718521630559267*^9, 3.718521641789692*^9}, {3.7185216726962433`*^9, 
   3.7185216733580647`*^9}, {3.718636471385057*^9, 3.7186364749898767`*^9}, {
   3.7186366347963343`*^9, 3.718636636271434*^9}, {3.7259581138852463`*^9, 
   3.725958115603722*^9}, {3.7372783098194*^9, 3.737278316869255*^9}, 
   3.737371806626379*^9, 3.737384013131838*^9, {3.7373840435457*^9, 
   3.7373840851194687`*^9}, {3.737384137351205*^9, 3.73738418240597*^9}, {
   3.7373842155798798`*^9, 3.737384232171645*^9}, {3.737384415256804*^9, 
   3.737384433510865*^9}, {3.75852996982882*^9, 3.758529971762226*^9}, 
   3.7627930936957808`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[444]:=",
 CellID->228435710,ExpressionUUID->"698f818b-6511-4de7-b0ed-d96d2635924f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<CrystalQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "entry", " ", "exists", " ", 
     RowBox[{"in", " ", "'"}], 
     RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MissingQ", "@", 
      RowBox[{"$CrystalData", "[", "input", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "crystal"}], ",", "input"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.7276035463522577`*^9, 
   3.72760354706783*^9}, {3.74556825639723*^9, 3.7455682923534517`*^9}, {
   3.745568690840042*^9, 3.745568699006835*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[445]:=",
 CellID->1765700781,ExpressionUUID->"b8bde526-007e-4c8e-b0d5-ed2a301df9ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"centring_String", ",", "\"\<GetCentringVectors\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "vectors", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"centring", "===", "\"\<P\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<F\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<I\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<R\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<A\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<B\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "0", ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<C\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<H\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "centringerror"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"vectors", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}, {
   3.734077376632456*^9, 3.734077480964463*^9}, {3.734412586131454*^9, 
   3.7344125991220827`*^9}, 3.762793093706504*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[446]:=",
 CellID->56508374,ExpressionUUID->"28046281-85be-42c8-ba88-bb73835b48e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalFormulaUnits\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
       "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
         "\"\<FormulaUnits\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"input", ",", "\"\<FormulaUnits\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "not"}], ",", " ", 
         RowBox[{"query", " ", "user", " ", "manually"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"InputString", "[", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Cannot determine the number of formula units \>\"", "<>", 
           "\[IndentingNewLine]", "\"\<for \[LeftGuillemet]\>\"", "<>", 
           "input", "<>", "\"\<\[RightGuillemet].\>\"", "<>", "\"\<\\n\>\"", "<>",
            "\[IndentingNewLine]", 
           "\"\<Please enter that number or the density below.\>\""}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "output"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "userinput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "output"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.727178717966507*^9, 
   3.727178721188702*^9}, {3.727178758964155*^9, 3.727178761323883*^9}, {
   3.727178860595625*^9, 3.727178901192408*^9}, {3.727178964913246*^9, 
   3.727178966567266*^9}, {3.727601687423465*^9, 3.727601704808043*^9}, {
   3.727601744534422*^9, 3.727601771061698*^9}, {3.727602475651042*^9, 
   3.727602607286476*^9}, {3.7276026482929697`*^9, 3.727602649418606*^9}, {
   3.727602816432906*^9, 3.727602879307555*^9}, {3.7276029234914637`*^9, 
   3.727602926124346*^9}, {3.727603730383863*^9, 3.72760373066368*^9}, {
   3.727603973849247*^9, 3.7276039750255003`*^9}, {3.738049785054161*^9, 
   3.7380497898471613`*^9}, 3.762793093715082*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[447]:=",
 CellID->548469844,ExpressionUUID->"d66388ac-ec62-44e2-8fac-346c092a9018"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalSpaceGroup\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "is", " ", "valid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.727506566988821*^9, 
   3.7275065675308313`*^9}, {3.7276035560711937`*^9, 3.72760355630114*^9}, {
   3.7276036304674597`*^9, 3.727603631524433*^9}, 3.727676784104806*^9, {
   3.7340864321506767`*^9, 3.7340865206369267`*^9}, 3.743865456049979*^9, 
   3.762793093722595*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[448]:=",
 CellID->1132855184,ExpressionUUID->"664f45ac-3baa-444c-a22f-01597526b88f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalWavelength\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InputCheck", "[", 
     RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
      "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
        "\"\<Wavelength\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "@", 
       RowBox[{"$CrystalData", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"input", ",", "\"\<Wavelength\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", " ", "not"}], ",", " ", 
        RowBox[{
         RowBox[{"abort", " ", "OR", " ", 
          RowBox[{"return", " ", "'"}]}], "-", 
         RowBox[{"1", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"abortQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InputCheck", "::", "wavelength"}], ",", "input"}], "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}],
    ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.739125707135515*^9, 3.7391257657796993`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[449]:=",
 CellID->307063186,ExpressionUUID->"0b0850ef-556d-4cb1-a52c-578982ab1dfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Converts", " ", "to", " ", 
    RowBox[{"wavelength", " ", "[", "\[ARing]ngstr\[ODoubleDot]ms", "]"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"InputCheck", "[", 
    RowBox[{"input_", ",", "\"\<GetEnergyWavelength\>\"", ",", 
     RowBox[{"unitsQ_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hcKeV", "=", "12.398420"}], ",", "\[Lambda]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Only", " ", "exception"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"input", "===", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "if", " ", "positive"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"Positive", "@", "input"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "poslambda"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"A", ".", " ", "Number"}], " ", "input"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NumericQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"1.", " ", "Assume", " ", "\[ARing]ngstr\[ODoubleDot]ms"}], 
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"input", " ", "\[LessEqual]", " ", "5.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"N", "@", "input"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"2.", " ", "Assume", " ", "kilo", " ", "electronvolt"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"input", " ", "\[LessEqual]", " ", "250.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", "input"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"3.", " ", "Assume", " ", "electronvolts"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"1000", "*", 
            RowBox[{"hcKeV", "/", "input"}]}]}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Quantity"}], " ", "input"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"QuantityQ", "[", "input", "]"}], " ", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Convert", " ", "wavelength", " ", "or", " ", "energy", " ", "to", 
          " ", "\[ARing]ngstr\[ODoubleDot]ms"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"UnitDimensions", "[", "input", "]"}], "===", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\"\<LengthUnit\>\"", ",", "1"}], "}"}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"\[Lambda]", "=", 
            RowBox[{"UnitConvert", "[", 
             RowBox[{"input", ",", "\"\<Angstroms\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"unitsQ", ",", 
             RowBox[{"Return", "@", "\[Lambda]"}], ",", 
             RowBox[{"Return", "@", 
              RowBox[{"QuantityMagnitude", "@", "\[Lambda]"}]}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"CompatibleUnitQ", "[", 
           RowBox[{"input", ",", "\"\<Joules\>\""}], "]"}], ",", "\t\t", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", 
            RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"UnitConvert", "[", 
              RowBox[{"input", ",", "\"\<Kiloelectronvols\>\""}], "]"}]}]}]}],
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"InputCheck", "::", "energyunit"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"C", ".", " ", "None"}], " ", "of", " ", "the", " ", 
          "above"}], " ", "*)"}], "\[IndentingNewLine]", "True", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "energyinput"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Set", " ", "in", " ", "Quantity", " ", "if", " ", "desired"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"unitsQ", ",", "\[IndentingNewLine]", 
        RowBox[{"Quantity", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Angstroms\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\[Lambda]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.726560443424157*^9, 
   3.726560447064084*^9}, 3.72685205362494*^9, {3.7268524061436033`*^9, 
   3.7268525118996563`*^9}, {3.726853451219391*^9, 3.726853553519404*^9}, {
   3.72685364594137*^9, 3.726853659220982*^9}, {3.726853721494712*^9, 
   3.7268537360194597`*^9}, {3.726853814139167*^9, 3.726853866046702*^9}, {
   3.72685391283145*^9, 3.726854013342908*^9}, {3.72685443464507*^9, 
   3.726854444243165*^9}, {3.726854740941407*^9, 3.726854744623098*^9}, {
   3.726854833074029*^9, 3.726854873935768*^9}, {3.72685491084039*^9, 
   3.726854918136497*^9}, {3.72685498979923*^9, 3.726855068318531*^9}, {
   3.726855109331604*^9, 3.726855122067479*^9}, {3.7268555301237164`*^9, 
   3.726855539752921*^9}, {3.7268559339858027`*^9, 3.726855959866241*^9}, {
   3.7268559904322023`*^9, 3.72685603510135*^9}, {3.72685615357065*^9, 
   3.72685615402689*^9}, {3.726856216650893*^9, 3.726856369277254*^9}, {
   3.7268564800835943`*^9, 3.7268564992580137`*^9}, {3.726856620967496*^9, 
   3.726856621815027*^9}, {3.726856668775392*^9, 3.726856720204636*^9}, {
   3.7268568209881*^9, 3.72685684971353*^9}, {3.72685688102668*^9, 
   3.7268569498483753`*^9}, {3.7268570554316273`*^9, 3.726857141124441*^9}, {
   3.72685733536134*^9, 3.726857445821105*^9}, {3.7268574798936377`*^9, 
   3.726857484116231*^9}, {3.726857520876247*^9, 3.726857597705496*^9}, {
   3.7268576490821247`*^9, 3.726857665286269*^9}, {3.726896856919681*^9, 
   3.726896865360489*^9}, {3.726897043655274*^9, 3.72689706577814*^9}, {
   3.726899351343816*^9, 3.726899381328332*^9}, 3.7268997978240433`*^9, {
   3.7275466850188923`*^9, 3.727546685984756*^9}, {3.727596442016464*^9, 
   3.727596443184536*^9}, {3.7275965437672157`*^9, 3.727596576954631*^9}, 
   3.727596651111322*^9, {3.72760374260155*^9, 3.727603759529471*^9}, {
   3.728109774970121*^9, 3.728109880586781*^9}, 3.73441267980902*^9, {
   3.738049815649427*^9, 3.738049826421247*^9}, {3.7391251770910673`*^9, 
   3.739125211688257*^9}, {3.7391256829934187`*^9, 3.739125689976153*^9}, 
   3.762793093738366*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[450]:=",
 CellID->407763361,ExpressionUUID->"bac0aa6e-0589-484c-bae8-04eccd1764d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], "]"}], ":=", 
  
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"$CrystalDataCombined", ",", "sg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "space", " ", "group", " ", "number", " ", "is",
       " ", "given"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "input", "\[LessEqual]", "230"}], ")"}],
         "&&", 
        RowBox[{"IntegerQ", "@", "input"}]}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
         RowBox[{"input", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
         "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "If", " ", "actual", " ", "input", " ", "is", " ", "a", " ", 
         "point"}], "-", " ", 
        RowBox[{"or", " ", "space", " ", "group"}]}], ",", " ", 
       RowBox[{"return", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}], ",", 
       RowBox[{"Return", "@", "input"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "MaXrd`Private`$TempCrystalData"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"$CrystalData", ",", "MaXrd`Private`$TempCrystalData"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", "$CrystalData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "@", 
        RowBox[{"$CrystalDataCombined", "[", "input", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "PSGC"}], ",", "input"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "exists"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalDataCombined", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.72750620550637*^9, 
   3.727506277082754*^9}, 3.7275065790218277`*^9, 3.72750668943563*^9, {
   3.7275138768842697`*^9, 3.727513877580575*^9}, {3.7276037003393583`*^9, 
   3.7276037005968237`*^9}, {3.727603930848737*^9, 3.727603935750414*^9}, {
   3.734086562493793*^9, 3.734086592174155*^9}, {3.734087081953874*^9, 
   3.734087111656989*^9}, {3.743865456115304*^9, 3.743865456153502*^9}, {
   3.758529973221416*^9, 3.7585299759035673`*^9}, {3.7614238939583063`*^9, 
   3.7614239274759207`*^9}, {3.76142400648403*^9, 3.7614240067298727`*^9}, {
   3.7614240390817547`*^9, 3.7614241404093447`*^9}, {3.7614242479891987`*^9, 
   3.7614242705338163`*^9}, {3.761424370948794*^9, 3.761424372186491*^9}, 
   3.762793093748088*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[451]:=",
 CellID->658490750,ExpressionUUID->"9fd21527-7437-47e2-a356-e84505fb7cb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretElement\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"elementsIn", "=", "input"}], ",", "pertiodicTable", ",", 
      "elementsRead", ",", "elementsReadNeutral", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{"elementsIn", ",", "NumberString"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"elementsIn", "=", 
          RowBox[{"ToExpression", "@", "elementsIn"}]}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{"in", " ", "the", " ", "periodic", " ", "table"}], ")"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "elementsIn", "\[LessEqual]", 
            RowBox[{"Length", "@", "$PeriodicTable"}]}], ")"}], "&&", 
          RowBox[{"IntegerQ", "@", "elementsIn"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Keys", "@", "$PeriodicTable"}], ")"}], 
           "\[LeftDoubleBracket]", "elementsIn", "\[RightDoubleBracket]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "ElementNumber"}], ",", 
            RowBox[{"ToString", "@", "elementsIn"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "single", " ", "string", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Wrap"}], " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", 
       RowBox[{"elementsIn", "=", 
        RowBox[{"{", "elementsIn", "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Process"}], " ", "list", " ", "of", " ", 
       "strings", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "input", " ", "is", 
       " ", "a", " ", "list", " ", "of", " ", "strings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "elementsIn"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"elementsIn", ",", "StringQ"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".2", ".", " ", "Set"}], " ", "of", " ", "valid", " ", 
       "symbols", " ", "from", " ", "the", " ", "periodic", " ", "table"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pertiodicTable", "=", 
      RowBox[{"Keys", "@", "$PeriodicTable"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"C", 
        RowBox[{".3", ".", " ", "Find"}], " ", 
        RowBox[{"(", "possible", ")"}], " ", "matches"}], ",", " ", 
       RowBox[{"and", " ", "establish", " ", "order"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"elementsIn", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StartOfString", "~~", 
          RowBox[{"a", ":", "LetterCharacter"}], "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{"b", ":", "LetterCharacter"}]}], "}"}], "~~", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{
             RowBox[{"n1", ":", 
              RowBox[{"DigitCharacter", "..."}]}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n2", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"ToUpperCase", "[", "a", "]"}], "<>", 
          RowBox[{"ToLowerCase", "[", "b", "]"}], "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n1", "===", "\"\<\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"n2", "===", "\"\<\>\""}], ")"}]}], ",", "\"\<1\>\"", 
            ",", "\"\<\>\""}], "]"}], "<>", "n1", "<>", "n2", "<>", 
          "pm"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "for", " ", "non"}], "-", "elements"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"elementsRead", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsRead", ",", 
               RowBox[{"{", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Separate", " ", "element", " ", "symbol", " ", "and", " ", "charge", 
       " ", 
       RowBox[{"(", 
        RowBox[{"if", " ", "any"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "elementsRead"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"a", ":", 
             RowBox[{"LetterCharacter", ".."}]}], "~~", "b___"}], 
           "\[IndentingNewLine]", "\t", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"b", "===", "\"\<\>\""}], ",", "\"\<&\>\"", ",", "b"}],
               "]"}]}], "}"}]}]}], "]"}], ",", "1"}], "]"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"'", "&"}], "'"}], " ", "should", " ", "be", " ", "deleted", 
       " ", "later"}], " ", "*)"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".4", ".", " ", "Remove"}], " ", "second", " ", "character", 
       " ", "if", " ", "not", " ", "applicable"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{
        RowBox[{"s_String", "/;", "\[IndentingNewLine]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"pertiodicTable", ",", "s"}], "]"}]}]}], "\[RuleDelayed]", 
        
        RowBox[{"StringTake", "[", 
         RowBox[{"s", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", "deuterium"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".5", ".", " ", "Final"}], " ", "validity", " ", "check"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elementsReadNeutral", ",", "pertiodicTable"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsReadNeutral", ",", "\[IndentingNewLine]", 
               RowBox[{"First", "@", "temp"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".6", ".", " ", "Concatenate"}], " ", "elements", " ", "and", 
       " ", "charge"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      "elementsReadNeutral"}], ";", "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"elementsRead", "/.", 
       RowBox[{"\"\<1\>\"", "\[Rule]", "\"\<\>\""}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"StringJoin", "/@", "elementsRead"}], ",", "\"\<&\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "chemical", " ", "element"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<ElementFailed\>\""}], ",", 
       RowBox[{"ToString", "@", "input"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"b", ".", " ", "Return"}], " ", "string", " ", 
       RowBox[{"(", 
        RowBox[{"or", " ", "list", " ", "of", " ", "strings"}], ")"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "elementsRead", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        ",", "elementsRead"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278567175089*^9, 
   3.737278609150566*^9}, {3.737278661861796*^9, 3.7372787061104527`*^9}, {
   3.737278786430764*^9, 3.737278815614232*^9}, {3.737278876614931*^9, 
   3.737278894575992*^9}, {3.737279063214642*^9, 3.737279117617867*^9}, {
   3.737279153995288*^9, 3.737279156957521*^9}, {3.737279209224059*^9, 
   3.7372792281945353`*^9}, {3.737279265333662*^9, 3.7372792662517557`*^9}, {
   3.737279499593874*^9, 3.7372795003597097`*^9}, {3.7372795311927958`*^9, 
   3.737279607430427*^9}, {3.737279901036427*^9, 3.737279905187501*^9}, {
   3.73728056780586*^9, 3.737280595834815*^9}, {3.737280731938634*^9, 
   3.7372807824368553`*^9}, {3.737280821275927*^9, 3.737280850048135*^9}, {
   3.7372808982833033`*^9, 3.7372809507817802`*^9}, {3.737281047830305*^9, 
   3.737281064716365*^9}, {3.7372811554403543`*^9, 3.73728118861235*^9}, {
   3.7372812569776163`*^9, 3.737281316071546*^9}, {3.737281653054924*^9, 
   3.737281698062044*^9}, {3.737284237057*^9, 3.737284327083954*^9}, {
   3.7372843590048733`*^9, 3.737284369739956*^9}, {3.7372844386235523`*^9, 
   3.737284484892178*^9}, {3.7372850819056*^9, 3.737285090806818*^9}, {
   3.73728520111075*^9, 3.737285222748335*^9}, {3.737285270111203*^9, 
   3.73728530587646*^9}, {3.737285533840251*^9, 3.737285559292869*^9}, {
   3.7372856101403227`*^9, 3.737285657390164*^9}, {3.737285700136235*^9, 
   3.737285798718968*^9}, {3.7372858357113028`*^9, 3.737285868194257*^9}, {
   3.737285908459991*^9, 3.737286014905347*^9}, 3.737286052837697*^9, {
   3.7372861540618677`*^9, 3.737286154519107*^9}, {3.737286254980082*^9, 
   3.7372863413456507`*^9}, {3.737286380256139*^9, 3.7372864143825283`*^9}, {
   3.737286458977261*^9, 3.737286576079788*^9}, {3.737286623935347*^9, 
   3.737286632869177*^9}, {3.7372866648183327`*^9, 3.737286723584116*^9}, {
   3.737374746359795*^9, 3.737374832079135*^9}, {3.73737499904206*^9, 
   3.737375023959383*^9}, {3.737378138033321*^9, 3.737378164259573*^9}, {
   3.737378225363977*^9, 3.73737825691322*^9}, 3.7373784605339413`*^9, {
   3.737378502252293*^9, 3.73737864023484*^9}, {3.737378704823086*^9, 
   3.737378712047621*^9}, {3.737378750431796*^9, 3.737378752703669*^9}, {
   3.737378898239748*^9, 3.737378990411519*^9}, {3.73737903566635*^9, 
   3.7373791239583397`*^9}, {3.737379162032648*^9, 3.737379164836317*^9}, {
   3.7373792649735928`*^9, 3.7373793244342623`*^9}, {3.737379375913303*^9, 
   3.73737941501803*^9}, {3.737379491076782*^9, 3.737379495461954*^9}, {
   3.737379605763606*^9, 3.7373796928169928`*^9}, {3.73737986755727*^9, 
   3.7373800849030933`*^9}, {3.7373801268150043`*^9, 
   3.7373801843010073`*^9}, {3.737380294292263*^9, 3.737380294698414*^9}, {
   3.737380414361321*^9, 3.737380698358766*^9}, {3.7373807418017273`*^9, 
   3.73738075376825*^9}, {3.7373807854482927`*^9, 3.737380862411724*^9}, {
   3.737381036834449*^9, 3.737381064693281*^9}, {3.737381100937663*^9, 
   3.7373811217752542`*^9}, 3.737381158470895*^9, 3.737381221032393*^9, {
   3.737381678459423*^9, 3.737381805116645*^9}, {3.737381836958056*^9, 
   3.737381881326532*^9}, {3.737381917168672*^9, 3.7373819592222023`*^9}, {
   3.737382007542437*^9, 3.737382116848222*^9}, {3.7373821591203203`*^9, 
   3.737382355002592*^9}, {3.7379744155182457`*^9, 3.737974415670136*^9}, {
   3.7379754153411427`*^9, 3.737975452667324*^9}, {3.73797549962778*^9, 
   3.7379755241789637`*^9}, 3.737975563770276*^9, {3.737975648095365*^9, 
   3.7379756613659477`*^9}, {3.73921005915567*^9, 3.739210067088846*^9}, {
   3.7392103437571*^9, 3.739210372090125*^9}, {3.7392104083569927`*^9, 
   3.739210408785853*^9}, {3.739210561112054*^9, 3.739210658951914*^9}, {
   3.742878249248098*^9, 3.7428782535467987`*^9}, {3.7428782893930473`*^9, 
   3.742878353943668*^9}, {3.742878774060712*^9, 3.7428787793596373`*^9}, {
   3.742878811736623*^9, 3.742878976915493*^9}, {3.7428790184091597`*^9, 
   3.7428790837272663`*^9}, {3.742879158784565*^9, 3.7428791803486032`*^9}, {
   3.742879211104168*^9, 3.742879211738106*^9}, {3.7585299775360603`*^9, 
   3.75853003338778*^9}, 3.7627930937690287`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[452]:=",
 CellID->1270802259,ExpressionUUID->"51adeaeb-f550-42b1-98ed-b48d7fa3fd40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretSpaceGroup\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sg", "=", "input"}], ",", "o", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{
           RowBox[{"StringTrim", "@", "sg"}], ",", "NumberString"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"sg", "=", 
          RowBox[{"ToExpression", "@", "sg"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{
        "a", " ", "canonical", " ", "space", " ", "group", " ", "number"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "sg", "\[LessEqual]", "230"}], ")"}], 
          "&&", 
          RowBox[{"IntegerQ", "@", "sg"}]}], ",", 
         RowBox[{"Return", "@", 
          RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
           RowBox[{"sg", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "SGnumber"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"abortQ", ",", 
            RowBox[{"Abort", "[", "]"}], ",", 
            RowBox[{"Return", "@", "Null"}]}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "string", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "string"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringQ", "@", "sg"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".2", " ", "Process", " ", "any", " ", "annotations"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"sg", ",", "\"\<origin\>\"", ",", 
         RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"o", "=", 
         RowBox[{"ChoiceDialog", "[", 
          RowBox[{
           RowBox[{
           "\"\<Information on cell origin detected.\>\"", "<>", 
            "\[IndentingNewLine]", "\"\<\\n\>\"", "<>", 
            "\"\<Please confirm the cell origin.\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WindowTitle", "\[Rule]", "\"\<Cell origin\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"sg", ",", 
           RowBox[{
           "Whitespace", "~~", "\"\<(\>\"", "~~", "__", "~~", "\"\<)\>\""}]}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".3", " ", "Tidy", " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "sg", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"B", ".4", 
           RowBox[{".1", ".", " ", "Remove"}], " ", "any", " ", "_enclosing", 
           "_", " ", "quotation", " ", "marks"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Note", ":", " ", 
           RowBox[{
           "Some", " ", "Hall", " ", "symbols", " ", "contain", " ", "double",
             " ", "quotation", " ", "marks"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "main__", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "EndOfString"}], "\[RuleDelayed]", "main"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".2", " ", "Uppercase", " ", "centring", " ", "1"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"first", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<-\>\"", "~~", "_"}], ",", "_"}], "}"}]}], "~~", 
            "rest__", "~~", "EndOfString"}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToUpperCase", "@", "first"}], "~~", 
            RowBox[{"ToLowerCase", "@", "rest"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".3", ".", " ", "Fix"}], " ", "boxes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<overscriptbox\>\"", "\[Rule]", "\"\<OverscriptBox\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<subscriptbox\>\"", "\[Rule]", "\"\<SubscriptBox\>\""}]}], 
           "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".4", " ", "Uppercase", " ", "centring", " ", "2"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<Box[\\(\>\"", "~~", "c_"}], "\[RuleDelayed]", 
           RowBox[{"\"\<Box[\\(\>\"", "<>", 
            RowBox[{"ToUpperCase", "[", "c", "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", ".5", " ", "Screw", " ", "axes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"a", ":", "DigitCharacter"}], "~~", "\"\<(\>\"", "~~", 
            RowBox[{"b", ":", "DigitCharacter"}], "~~", "\"\<)\>\""}], 
           "\[RuleDelayed]", 
           RowBox[{"a", "<>", "b"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".6", ".", " ", "Miscellaneous"}], " ", "replacements"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\"\<;\>\"", "\[Rule]", "\"\< \>\""}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Check"}], " ", "symbol", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "centring", " ", "symbol"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<P\>\"", ",", "\"\<I\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
            ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", 
            "\"\<H\>\"", ",", "\"\<\\!\>\"", ",", "\"\<-\>\""}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringTake", "[", 
           RowBox[{"sg", ",", "1"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", ".2", " ", "Check", " ", "if", " ", "found", " ", 
       RowBox[{"by", " ", "'"}], 
       RowBox[{"$GroupSymbolRedirect", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "sg", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"temp", ",", "\"\<PointGroupNumber\>\""}], "]"}], ",", 
          RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Exception", ":", " ", 
       RowBox[{"Old", " ", "symbol"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "\"\<Fm3m\>\""}], ",", 
       RowBox[{
        RowBox[{"sg", "=", "\"\<Fm-3m\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "C", ".3", " ", "Delete", " ", "whitespace", " ", "and", " ", "check", 
       " ", "again"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"sg", ",", "Whitespace"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "temp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"A", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "space", " ", "group"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<SG\>\""}], ",", "input"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"abortQ", ",", 
       RowBox[{"Abort", "[", "]"}], ",", 
       RowBox[{"Return", "@", "Null"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"B", ".", " ", "Return"}], " ", "non"}], "-", 
       RowBox[{"ambiguous", " ", "output"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SpaceGroupFound\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "o", "]"}], ",", 
       RowBox[{"sg", "=", 
        RowBox[{"sg", "<>", "\"\<:\>\"", "<>", 
         RowBox[{"ToString", "[", "o", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ToStandardSetting", "[", "sg", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278689235427*^9, 
   3.737278724291026*^9}, {3.7373828319134293`*^9, 3.737382905583477*^9}, {
   3.7380503409830427`*^9, 3.7380503462202253`*^9}, {3.738050409199875*^9, 
   3.738050410020376*^9}, {3.738050587280776*^9, 3.738050594380994*^9}, {
   3.738050633314591*^9, 3.738050741885346*^9}, 3.738050787226899*^9, {
   3.738050820907621*^9, 3.738050913718038*^9}, {3.738050967336628*^9, 
   3.738051039601925*^9}, {3.738051123094633*^9, 3.7380511685169477`*^9}, {
   3.7380512915012083`*^9, 3.73805131582058*^9}, 3.73805147687253*^9, {
   3.738291406092393*^9, 3.738291463424559*^9}, {3.739251235484573*^9, 
   3.739251259594013*^9}, {3.7392664653604727`*^9, 3.739266516678097*^9}, 
   3.7392665477450542`*^9, {3.739267739894909*^9, 3.739267740037506*^9}, 
   3.73950412920148*^9, {3.742016464322269*^9, 3.742016465840391*^9}, {
   3.742022822926903*^9, 3.742022908512398*^9}, {3.742022978221959*^9, 
   3.74202298550244*^9}, {3.743865456276009*^9, 3.7438654563219023`*^9}, {
   3.7438669045354652`*^9, 3.7438669207895317`*^9}, {3.758530035604117*^9, 
   3.758530048874316*^9}, 3.762793093794232*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[453]:=",
 CellID->1648697598,ExpressionUUID->"37fb2ec2-4b14-4289-9c10-182869b3a6d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointGroupQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Check", " ", "if", " ", "valid", " ", "space", " ", "group", " ", 
     "string"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"$PointGroups", ",", "input", ",", "Infinity"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "\"\<PG\>\""}], ",", "input"}], "]"}], 
      ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.7136042900817747`*^9}, {
   3.713604322627748*^9, 3.713604324160606*^9}, {3.7136043702641973`*^9, 
   3.713604371101212*^9}, {3.71471126435174*^9, 3.71471126555512*^9}, 
   3.717740897041522*^9, 3.72760353803649*^9, {3.7305444772094812`*^9, 
   3.730544481061934*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[454]:=",
 CellID->679032345,ExpressionUUID->"8611047c-bcd6-4045-9095-a72f5151bb17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointSpaceGroupQ\>\""}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "if", " ", "valid", " ", "point"}], "-", " ", 
    RowBox[{"or", " ", "space", " ", "group", " ", "string"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "PSG"}], ",", "input"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, {
   3.713604296226803*^9, 3.713604299721271*^9}, {3.714710977590053*^9, 
   3.714710979768374*^9}, 3.717740920646922*^9, 3.7276035440759487`*^9, 
   3.743865456393198*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[455]:=",
 CellID->768522257,ExpressionUUID->"87b008d4-57e5-4fbd-8455-ad23b551ad25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"type_String", ",", 
    RowBox[{"scatteringAngle_:", "0"}], ",", "\"\<Polarisation\>\""}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"type", "===", "\"\<sigma\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Sigma]\>\""}]}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", "===", "\"\<pi\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Pi]\>\""}]}], ",", 
    RowBox[{"Abs", "@", 
     RowBox[{"Cos", "[", "scatteringAngle", "]"}]}], ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"InputCheck", "::", "\"\<polarisation\>\""}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[456]:=",
 CellID->1586920341,ExpressionUUID->"b4b13112-3943-4131-b998-b92256e19b37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{
   "crystal_String", ",", "wavelength_", ",", "\"\<ProcessWavelength\>\"", 
    ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[Lambda]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"wavelength", "===", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
         "crystal", ",", "\"\<GetCrystalWavelength\>\"", ",", "abortQ"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", "wavelength"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\[Lambda]", ",", "\"\<GetEnergyWavelength\>\"", ",", "False"}],
       "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.730395241910015*^9, 3.730395331782501*^9}, 
   3.73039551088382*^9, {3.7391249707350397`*^9, 3.739124986130555*^9}, {
   3.73912511330057*^9, 3.739125114641823*^9}, {3.739125407092436*^9, 
   3.7391254219192133`*^9}, {3.7391254965873337`*^9, 3.739125499857193*^9}, {
   3.739125656582911*^9, 3.739125666230063*^9}, 3.762793093803693*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[457]:=",
 CellID->1770759094,ExpressionUUID->"9e0a55be-d515-4ce7-9220-eda38768eb71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "label"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised check label.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "dim"}], "=", 
   "\"\<Reflections (and coordinates) must be on a {\!\(\*
StyleBox[\"h\", \"TI\"]\), \!\(\*
StyleBox[\"k\", \"TI\"]\), \!\(\*
StyleBox[\"l\", \"TI\"]\)} (or {\!\(\*
StyleBox[\"x\", \"TI\"]\), \!\(\*
StyleBox[\"y\", \"TI\"]\), \!\(\*
StyleBox[\"z\", \"TI\"]\)}) form\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "one"}], "=", 
   "\"\<Only one `1` expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "head"}], "=", 
   "\"\<Head of indices must be either Integer, String or Symbol.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "few"}], "=", 
   "\"\<At least two reflections are required to make comparisons.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyunit"}], "=", 
   "\"\<Input does not have a unit compatible with energy or \
wavelength.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyinput"}], "=", 
   "\"\<Input must be an energy or wavelength compatible Quantity, or a \
number.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "poslambda"}], "=", 
    "\"\<The wavelength/energy must be positive.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystal"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "wavelength"}], "=", 
   "\"\<No wavelength was found for crystal \[LeftGuillemet]`1`\
\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "userinput"}], "=", 
   "\"\<Invalid user input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "polarisation"}], "=", 
    "\"\<Invalid polarisation setting.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PSG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point- \
or space group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a space \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SGnumber"}], "=", 
   "\"\<Valid space group numbers are between 1 and 230.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystalSG"}], "=", 
   "\"\<Crystal entry \[LeftGuillemet]`1`\[RightGuillemet] has invalid space \
group \[LeftGuillemet]`2`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "PSGC"}], "=", 
    "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group, space group or a crystal.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "centringerror"}], "=", 
   "\"\<Invalid space group centring.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementNumber"}], "=", 
   "\"\<Element number `1` is out of range.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementFailed"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a \
chemical element.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "ElementError"}], "=", 
    "\"\<The element \[LeftGuillemet]`1`\[RightGuillemet] cannot be \
interpreted.\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "InputCheck"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "__", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.6856820263060083`*^9, 3.6856820338793163`*^9}, {
   3.685682083417005*^9, 3.685682092894709*^9}, {3.6856840260308533`*^9, 
   3.685684026178547*^9}, {3.685686819102976*^9, 3.6856868408053513`*^9}, {
   3.685687011142066*^9, 3.685687017829006*^9}, {3.685687131249773*^9, 
   3.685687151398356*^9}, {3.685687183159276*^9, 3.6856871838215933`*^9}, {
   3.685687254295497*^9, 3.685687281286789*^9}, {3.685687660039452*^9, 
   3.6856877115995817`*^9}, {3.68568838863011*^9, 3.6856884381337767`*^9}, {
   3.685690949932845*^9, 3.6856909574232817`*^9}, {3.685691048596792*^9, 
   3.685691065258542*^9}, {3.685691555385049*^9, 3.685691595897393*^9}, {
   3.685693407917099*^9, 3.6856934105491962`*^9}, {3.685693449539488*^9, 
   3.685693464972211*^9}, {3.685693732995039*^9, 3.6856937393916893`*^9}, {
   3.685693867613049*^9, 3.685693870503192*^9}, {3.685694016861869*^9, 
   3.685694053583612*^9}, {3.685694415120605*^9, 3.685694415410471*^9}, {
   3.6856953860999413`*^9, 3.685695404607368*^9}, {3.68569555947088*^9, 
   3.685695605133265*^9}, {3.685696124318612*^9, 3.68569613828201*^9}, {
   3.685696178849712*^9, 3.685696180401723*^9}, {3.685696592780033*^9, 
   3.6856965970349083`*^9}, {3.6870711449669037`*^9, 3.687071165830688*^9}, {
   3.6870725649937353`*^9, 3.687072567422408*^9}, {3.711081329746539*^9, 
   3.711081335862384*^9}, {3.711083709642126*^9, 3.71108372803414*^9}, {
   3.712990896317184*^9, 3.712990899230811*^9}, {3.713603056038671*^9, 
   3.7136030717991047`*^9}, 3.713603337329356*^9, {3.7136034598308163`*^9, 
   3.713603470204297*^9}, {3.713604348937676*^9, 3.71360436129599*^9}, {
   3.717147714818186*^9, 3.717147739983534*^9}, {3.7171480835458517`*^9, 
   3.717148091231995*^9}, {3.726560324583314*^9, 3.7265603577752657`*^9}, {
   3.726853588279467*^9, 3.7268536391946774`*^9}, {3.7271789201847763`*^9, 
   3.727178947159677*^9}, {3.7275066313384666`*^9, 3.72750665317505*^9}, {
   3.727513894430643*^9, 3.727513902461985*^9}, {3.727596618528956*^9, 
   3.727596645209611*^9}, {3.727601483861143*^9, 3.7276014841869497`*^9}, {
   3.7276028953923073`*^9, 3.727602914012473*^9}, {3.728109699712471*^9, 
   3.728109743760724*^9}, {3.728765837392223*^9, 3.728765846807078*^9}, {
   3.7340775949863367`*^9, 3.734077598710491*^9}, {3.7372791075805187`*^9, 
   3.73727914741197*^9}, {3.7372792368998547`*^9, 3.737279256825714*^9}, {
   3.737285569781273*^9, 3.737285603410686*^9}, {3.739187854951786*^9, 
   3.73918785517507*^9}, {3.742016334042914*^9, 3.742016337494812*^9}, {
   3.742016368507223*^9, 3.74201638931714*^9}, {3.7567126007785892`*^9, 
   3.756712616867313*^9}, 3.75671264844755*^9, {3.756712756093667*^9, 
   3.756712764043981*^9}, {3.75671279769972*^9, 3.756712815035034*^9}, {
   3.756713298279908*^9, 3.7567132995556707`*^9}},
 CellID->395796128,
 $CellContext`ExpressionUUID -> "f6062f54-1222-4d57-ae33-6e13722a2bcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", "\[IndentingNewLine]", 
   RowBox[{"input_List", ",", "\[IndentingNewLine]", 
    RowBox[{"labels___", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", ",", 
           "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
           "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], ",", 
         RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"check", ",", "hkl", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"check", "=", 
      RowBox[{"{", "labels", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
         "check", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", 
               ",", "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
               "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], 
             ",", "temp"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"InputCheck", "::", "label"}], ",", "temp"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dimensions", " ", "check", " ", 
       RowBox[{"(", 
        RowBox[{"always", " ", "required"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Single", " ", 
        RowBox[{"reflection", "/", "coordinate"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"input", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
            "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"hkl", "=", 
        RowBox[{"{", "input", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Multiple", " ", 
         RowBox[{"reflections", "/", "coordinates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
             RowBox[{"!", 
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
               "]"}]}]}]}], "]"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{"hkl", "=", "input"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "dim"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", 
       RowBox[{"reflection", "/", "coordinates"}], " ", "check"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1hkl\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<reflection\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1xyz\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<coordinate\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Multiple", " ", "reflections", " ", "check"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Multiple\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "<", "2"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "few"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Integer", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Integer\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "hkl"}], ",", "IntegerQ"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "integer"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "if", " ", "Integer"}], ",", " ", 
       RowBox[{"String", " ", "or", " ", "Symbol"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<StringSymbol\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ContainsAll", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Integer", ",", "String", ",", "Symbol", ",", "Times"}], 
             "}"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Head", "/@", 
             RowBox[{"Flatten", "@", "hkl"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "head"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wrap", " ", "single", " ", "reflections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<WrapSingle\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "input", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Return", "[", "input", "]"}]}], "\[IndentingNewLine]", "\t",
         "]"}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.687070782983131*^9, 3.687070826316058*^9}, {
   3.711080493388452*^9, 3.711080530269607*^9}, {3.7110838434149733`*^9, 
   3.711083844960722*^9}, {3.712990600076755*^9, 3.712990608318782*^9}, {
   3.712990804480831*^9, 3.7129908060016212`*^9}, {3.712990947248521*^9, 
   3.712990947808515*^9}, {3.713510243799721*^9, 3.7135102514986553`*^9}, {
   3.713510288538774*^9, 3.713510293259116*^9}, {3.7135103372502947`*^9, 
   3.713510338184915*^9}, {3.71431192571665*^9, 3.7143119392365303`*^9}, {
   3.7143120972494097`*^9, 3.714312097447524*^9}, {3.7143121915742683`*^9, 
   3.7143122110300217`*^9}, {3.714312273573138*^9, 3.714312308114839*^9}, {
   3.71445784032449*^9, 3.714457847602706*^9}, 3.714458049967931*^9, {
   3.7147109057397537`*^9, 3.714710909787726*^9}, {3.714710945019298*^9, 
   3.714710963965468*^9}, {3.717143871479184*^9, 3.717143873754469*^9}, {
   3.717146708601173*^9, 3.717146713501816*^9}, {3.717147467353772*^9, 
   3.717147472518999*^9}, {3.717147554646175*^9, 3.717147555923188*^9}, {
   3.717147595628448*^9, 3.717147596128397*^9}, 3.7171476872925243`*^9, {
   3.717147790297018*^9, 3.7171478112554407`*^9}, {3.7171480444680862`*^9, 
   3.717148048818454*^9}, {3.7171482182403383`*^9, 3.7171482183828487`*^9}, {
   3.717148818843635*^9, 3.717148834361803*^9}, {3.7171489319542913`*^9, 
   3.717148951600135*^9}, {3.717149178012879*^9, 3.71714919115486*^9}, {
   3.717149260050128*^9, 3.717149280072538*^9}, {3.717149333315688*^9, 
   3.717149397350493*^9}, {3.717149552908246*^9, 3.7171495813302383`*^9}, {
   3.718521630559267*^9, 3.718521641789692*^9}, {3.7185216726962433`*^9, 
   3.7185216733580647`*^9}, {3.718636471385057*^9, 3.7186364749898767`*^9}, {
   3.7186366347963343`*^9, 3.718636636271434*^9}, {3.7259581138852463`*^9, 
   3.725958115603722*^9}, {3.7372783098194*^9, 3.737278316869255*^9}, 
   3.737371806626379*^9, 3.737384013131838*^9, {3.7373840435457*^9, 
   3.7373840851194687`*^9}, {3.737384137351205*^9, 3.73738418240597*^9}, {
   3.7373842155798798`*^9, 3.737384232171645*^9}, {3.737384415256804*^9, 
   3.737384433510865*^9}, {3.75852996982882*^9, 3.758529971762226*^9}, 
   3.7627930936957808`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1388668537,
 $CellContext`ExpressionUUID -> "582dd116-7bbf-4577-b0db-a95e7cf4dbe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<CrystalQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "entry", " ", "exists", " ", 
     RowBox[{"in", " ", "'"}], 
     RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MissingQ", "@", 
      RowBox[{"$CrystalData", "[", "input", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "crystal"}], ",", "input"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.7276035463522577`*^9, 
   3.72760354706783*^9}, {3.74556825639723*^9, 3.7455682923534517`*^9}, {
   3.745568690840042*^9, 3.745568699006835*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->499825763,
 $CellContext`ExpressionUUID -> "2573f9e8-2af9-42ca-94dd-d3fbf8c90797"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"centring_String", ",", "\"\<GetCentringVectors\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "vectors", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"centring", "===", "\"\<P\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<F\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<I\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<R\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<A\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<B\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "0", ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<C\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<H\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "centringerror"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"vectors", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}, {
   3.734077376632456*^9, 3.734077480964463*^9}, {3.734412586131454*^9, 
   3.7344125991220827`*^9}, 3.762793093706504*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1763055324,
 $CellContext`ExpressionUUID -> "dbcf2741-11e4-4698-a8af-daf49f068290"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalFormulaUnits\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
       "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
         "\"\<FormulaUnits\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"input", ",", "\"\<FormulaUnits\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "not"}], ",", " ", 
         RowBox[{"query", " ", "user", " ", "manually"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"InputString", "[", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Cannot determine the number of formula units \>\"", "<>", 
           "\[IndentingNewLine]", "\"\<for \[LeftGuillemet]\>\"", "<>", 
           "input", "<>", "\"\<\[RightGuillemet].\>\"", "<>", "\"\<\\n\>\"", "<>",
            "\[IndentingNewLine]", 
           "\"\<Please enter that number or the density below.\>\""}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "output"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "userinput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "output"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.727178717966507*^9, 
   3.727178721188702*^9}, {3.727178758964155*^9, 3.727178761323883*^9}, {
   3.727178860595625*^9, 3.727178901192408*^9}, {3.727178964913246*^9, 
   3.727178966567266*^9}, {3.727601687423465*^9, 3.727601704808043*^9}, {
   3.727601744534422*^9, 3.727601771061698*^9}, {3.727602475651042*^9, 
   3.727602607286476*^9}, {3.7276026482929697`*^9, 3.727602649418606*^9}, {
   3.727602816432906*^9, 3.727602879307555*^9}, {3.7276029234914637`*^9, 
   3.727602926124346*^9}, {3.727603730383863*^9, 3.72760373066368*^9}, {
   3.727603973849247*^9, 3.7276039750255003`*^9}, {3.738049785054161*^9, 
   3.7380497898471613`*^9}, 3.762793093715082*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->691469162,
 $CellContext`ExpressionUUID -> "9ccfd331-de3b-4fca-9f9d-02e8c569c92d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalSpaceGroup\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "is", " ", "valid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.727506566988821*^9, 
   3.7275065675308313`*^9}, {3.7276035560711937`*^9, 3.72760355630114*^9}, {
   3.7276036304674597`*^9, 3.727603631524433*^9}, 3.727676784104806*^9, {
   3.7340864321506767`*^9, 3.7340865206369267`*^9}, 3.743865456049979*^9, 
   3.762793093722595*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1488191817,
 $CellContext`ExpressionUUID -> "bf221871-bd0a-4a76-8548-8cb2f84c0102"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalWavelength\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InputCheck", "[", 
     RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
      "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
        "\"\<Wavelength\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "@", 
       RowBox[{"$CrystalData", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"input", ",", "\"\<Wavelength\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", " ", "not"}], ",", " ", 
        RowBox[{
         RowBox[{"abort", " ", "OR", " ", 
          RowBox[{"return", " ", "'"}]}], "-", 
         RowBox[{"1", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"abortQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InputCheck", "::", "wavelength"}], ",", "input"}], "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}],
    ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.739125707135515*^9, 3.7391257657796993`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->297831710,
 $CellContext`ExpressionUUID -> "4076f94c-029e-4e4f-be5f-3bb8a6a0ae57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Converts", " ", "to", " ", 
    RowBox[{"wavelength", " ", "[", "\[ARing]ngstr\[ODoubleDot]ms", "]"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"InputCheck", "[", 
    RowBox[{"input_", ",", "\"\<GetEnergyWavelength\>\"", ",", 
     RowBox[{"unitsQ_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hcKeV", "=", "12.398420"}], ",", "\[Lambda]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Only", " ", "exception"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"input", "===", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "if", " ", "positive"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"Positive", "@", "input"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "poslambda"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"A", ".", " ", "Number"}], " ", "input"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NumericQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"1.", " ", "Assume", " ", "\[ARing]ngstr\[ODoubleDot]ms"}], 
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"input", " ", "\[LessEqual]", " ", "5.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"N", "@", "input"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"2.", " ", "Assume", " ", "kilo", " ", "electronvolt"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"input", " ", "\[LessEqual]", " ", "250.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", "input"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"3.", " ", "Assume", " ", "electronvolts"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"1000", "*", 
            RowBox[{"hcKeV", "/", "input"}]}]}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Quantity"}], " ", "input"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"QuantityQ", "[", "input", "]"}], " ", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Convert", " ", "wavelength", " ", "or", " ", "energy", " ", "to", 
          " ", "\[ARing]ngstr\[ODoubleDot]ms"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"UnitDimensions", "[", "input", "]"}], "===", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\"\<LengthUnit\>\"", ",", "1"}], "}"}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"\[Lambda]", "=", 
            RowBox[{"UnitConvert", "[", 
             RowBox[{"input", ",", "\"\<Angstroms\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"unitsQ", ",", 
             RowBox[{"Return", "@", "\[Lambda]"}], ",", 
             RowBox[{"Return", "@", 
              RowBox[{"QuantityMagnitude", "@", "\[Lambda]"}]}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"CompatibleUnitQ", "[", 
           RowBox[{"input", ",", "\"\<Joules\>\""}], "]"}], ",", "\t\t", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", 
            RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"UnitConvert", "[", 
              RowBox[{"input", ",", "\"\<Kiloelectronvols\>\""}], "]"}]}]}]}],
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"InputCheck", "::", "energyunit"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"C", ".", " ", "None"}], " ", "of", " ", "the", " ", 
          "above"}], " ", "*)"}], "\[IndentingNewLine]", "True", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "energyinput"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Set", " ", "in", " ", "Quantity", " ", "if", " ", "desired"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"unitsQ", ",", "\[IndentingNewLine]", 
        RowBox[{"Quantity", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Angstroms\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\[Lambda]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.726560443424157*^9, 
   3.726560447064084*^9}, 3.72685205362494*^9, {3.7268524061436033`*^9, 
   3.7268525118996563`*^9}, {3.726853451219391*^9, 3.726853553519404*^9}, {
   3.72685364594137*^9, 3.726853659220982*^9}, {3.726853721494712*^9, 
   3.7268537360194597`*^9}, {3.726853814139167*^9, 3.726853866046702*^9}, {
   3.72685391283145*^9, 3.726854013342908*^9}, {3.72685443464507*^9, 
   3.726854444243165*^9}, {3.726854740941407*^9, 3.726854744623098*^9}, {
   3.726854833074029*^9, 3.726854873935768*^9}, {3.72685491084039*^9, 
   3.726854918136497*^9}, {3.72685498979923*^9, 3.726855068318531*^9}, {
   3.726855109331604*^9, 3.726855122067479*^9}, {3.7268555301237164`*^9, 
   3.726855539752921*^9}, {3.7268559339858027`*^9, 3.726855959866241*^9}, {
   3.7268559904322023`*^9, 3.72685603510135*^9}, {3.72685615357065*^9, 
   3.72685615402689*^9}, {3.726856216650893*^9, 3.726856369277254*^9}, {
   3.7268564800835943`*^9, 3.7268564992580137`*^9}, {3.726856620967496*^9, 
   3.726856621815027*^9}, {3.726856668775392*^9, 3.726856720204636*^9}, {
   3.7268568209881*^9, 3.72685684971353*^9}, {3.72685688102668*^9, 
   3.7268569498483753`*^9}, {3.7268570554316273`*^9, 3.726857141124441*^9}, {
   3.72685733536134*^9, 3.726857445821105*^9}, {3.7268574798936377`*^9, 
   3.726857484116231*^9}, {3.726857520876247*^9, 3.726857597705496*^9}, {
   3.7268576490821247`*^9, 3.726857665286269*^9}, {3.726896856919681*^9, 
   3.726896865360489*^9}, {3.726897043655274*^9, 3.72689706577814*^9}, {
   3.726899351343816*^9, 3.726899381328332*^9}, 3.7268997978240433`*^9, {
   3.7275466850188923`*^9, 3.727546685984756*^9}, {3.727596442016464*^9, 
   3.727596443184536*^9}, {3.7275965437672157`*^9, 3.727596576954631*^9}, 
   3.727596651111322*^9, {3.72760374260155*^9, 3.727603759529471*^9}, {
   3.728109774970121*^9, 3.728109880586781*^9}, 3.73441267980902*^9, {
   3.738049815649427*^9, 3.738049826421247*^9}, {3.7391251770910673`*^9, 
   3.739125211688257*^9}, {3.7391256829934187`*^9, 3.739125689976153*^9}, 
   3.762793093738366*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->2020652460,
 $CellContext`ExpressionUUID -> "46300c07-37a8-4c26-9c3c-bfd429ab81d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], "]"}], ":=", 
  
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"$CrystalDataCombined", ",", "sg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "space", " ", "group", " ", "number", " ", "is",
       " ", "given"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "input", "\[LessEqual]", "230"}], ")"}],
         "&&", 
        RowBox[{"IntegerQ", "@", "input"}]}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
         RowBox[{"input", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
         "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "If", " ", "actual", " ", "input", " ", "is", " ", "a", " ", 
         "point"}], "-", " ", 
        RowBox[{"or", " ", "space", " ", "group"}]}], ",", " ", 
       RowBox[{"return", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}], ",", 
       RowBox[{"Return", "@", "input"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "MaXrd`Private`$TempCrystalData"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"$CrystalData", ",", "MaXrd`Private`$TempCrystalData"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", "$CrystalData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "@", 
        RowBox[{"$CrystalDataCombined", "[", "input", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "PSGC"}], ",", "input"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "exists"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalDataCombined", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.72750620550637*^9, 
   3.727506277082754*^9}, 3.7275065790218277`*^9, 3.72750668943563*^9, {
   3.7275138768842697`*^9, 3.727513877580575*^9}, {3.7276037003393583`*^9, 
   3.7276037005968237`*^9}, {3.727603930848737*^9, 3.727603935750414*^9}, {
   3.734086562493793*^9, 3.734086592174155*^9}, {3.734087081953874*^9, 
   3.734087111656989*^9}, {3.743865456115304*^9, 3.743865456153502*^9}, {
   3.758529973221416*^9, 3.7585299759035673`*^9}, {3.7614238939583063`*^9, 
   3.7614239274759207`*^9}, {3.76142400648403*^9, 3.7614240067298727`*^9}, {
   3.7614240390817547`*^9, 3.7614241404093447`*^9}, {3.7614242479891987`*^9, 
   3.7614242705338163`*^9}, {3.761424370948794*^9, 3.761424372186491*^9}, 
   3.762793093748088*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->799501562,
 $CellContext`ExpressionUUID -> "40d1c1ed-62fb-4df8-907d-7b157fdb296f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretElement\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"elementsIn", "=", "input"}], ",", "pertiodicTable", ",", 
      "elementsRead", ",", "elementsReadNeutral", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{"elementsIn", ",", "NumberString"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"elementsIn", "=", 
          RowBox[{"ToExpression", "@", "elementsIn"}]}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{"in", " ", "the", " ", "periodic", " ", "table"}], ")"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "elementsIn", "\[LessEqual]", 
            RowBox[{"Length", "@", "$PeriodicTable"}]}], ")"}], "&&", 
          RowBox[{"IntegerQ", "@", "elementsIn"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Keys", "@", "$PeriodicTable"}], ")"}], 
           "\[LeftDoubleBracket]", "elementsIn", "\[RightDoubleBracket]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "ElementNumber"}], ",", 
            RowBox[{"ToString", "@", "elementsIn"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "single", " ", "string", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Wrap"}], " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", 
       RowBox[{"elementsIn", "=", 
        RowBox[{"{", "elementsIn", "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Process"}], " ", "list", " ", "of", " ", 
       "strings", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "input", " ", "is", 
       " ", "a", " ", "list", " ", "of", " ", "strings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "elementsIn"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"elementsIn", ",", "StringQ"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".2", ".", " ", "Set"}], " ", "of", " ", "valid", " ", 
       "symbols", " ", "from", " ", "the", " ", "periodic", " ", "table"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pertiodicTable", "=", 
      RowBox[{"Keys", "@", "$PeriodicTable"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"C", 
        RowBox[{".3", ".", " ", "Find"}], " ", 
        RowBox[{"(", "possible", ")"}], " ", "matches"}], ",", " ", 
       RowBox[{"and", " ", "establish", " ", "order"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"elementsIn", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StartOfString", "~~", 
          RowBox[{"a", ":", "LetterCharacter"}], "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{"b", ":", "LetterCharacter"}]}], "}"}], "~~", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{
             RowBox[{"n1", ":", 
              RowBox[{"DigitCharacter", "..."}]}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n2", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"ToUpperCase", "[", "a", "]"}], "<>", 
          RowBox[{"ToLowerCase", "[", "b", "]"}], "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n1", "===", "\"\<\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"n2", "===", "\"\<\>\""}], ")"}]}], ",", "\"\<1\>\"", 
            ",", "\"\<\>\""}], "]"}], "<>", "n1", "<>", "n2", "<>", 
          "pm"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "for", " ", "non"}], "-", "elements"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"elementsRead", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsRead", ",", 
               RowBox[{"{", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Separate", " ", "element", " ", "symbol", " ", "and", " ", "charge", 
       " ", 
       RowBox[{"(", 
        RowBox[{"if", " ", "any"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "elementsRead"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"a", ":", 
             RowBox[{"LetterCharacter", ".."}]}], "~~", "b___"}], 
           "\[IndentingNewLine]", "\t", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"b", "===", "\"\<\>\""}], ",", "\"\<&\>\"", ",", "b"}],
               "]"}]}], "}"}]}]}], "]"}], ",", "1"}], "]"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"'", "&"}], "'"}], " ", "should", " ", "be", " ", "deleted", 
       " ", "later"}], " ", "*)"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".4", ".", " ", "Remove"}], " ", "second", " ", "character", 
       " ", "if", " ", "not", " ", "applicable"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{
        RowBox[{"s_String", "/;", "\[IndentingNewLine]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"pertiodicTable", ",", "s"}], "]"}]}]}], "\[RuleDelayed]", 
        
        RowBox[{"StringTake", "[", 
         RowBox[{"s", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", "deuterium"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".5", ".", " ", "Final"}], " ", "validity", " ", "check"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elementsReadNeutral", ",", "pertiodicTable"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsReadNeutral", ",", "\[IndentingNewLine]", 
               RowBox[{"First", "@", "temp"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".6", ".", " ", "Concatenate"}], " ", "elements", " ", "and", 
       " ", "charge"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      "elementsReadNeutral"}], ";", "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"elementsRead", "/.", 
       RowBox[{"\"\<1\>\"", "\[Rule]", "\"\<\>\""}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"StringJoin", "/@", "elementsRead"}], ",", "\"\<&\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "chemical", " ", "element"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<ElementFailed\>\""}], ",", 
       RowBox[{"ToString", "@", "input"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"b", ".", " ", "Return"}], " ", "string", " ", 
       RowBox[{"(", 
        RowBox[{"or", " ", "list", " ", "of", " ", "strings"}], ")"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "elementsRead", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        ",", "elementsRead"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278567175089*^9, 
   3.737278609150566*^9}, {3.737278661861796*^9, 3.7372787061104527`*^9}, {
   3.737278786430764*^9, 3.737278815614232*^9}, {3.737278876614931*^9, 
   3.737278894575992*^9}, {3.737279063214642*^9, 3.737279117617867*^9}, {
   3.737279153995288*^9, 3.737279156957521*^9}, {3.737279209224059*^9, 
   3.7372792281945353`*^9}, {3.737279265333662*^9, 3.7372792662517557`*^9}, {
   3.737279499593874*^9, 3.7372795003597097`*^9}, {3.7372795311927958`*^9, 
   3.737279607430427*^9}, {3.737279901036427*^9, 3.737279905187501*^9}, {
   3.73728056780586*^9, 3.737280595834815*^9}, {3.737280731938634*^9, 
   3.7372807824368553`*^9}, {3.737280821275927*^9, 3.737280850048135*^9}, {
   3.7372808982833033`*^9, 3.7372809507817802`*^9}, {3.737281047830305*^9, 
   3.737281064716365*^9}, {3.7372811554403543`*^9, 3.73728118861235*^9}, {
   3.7372812569776163`*^9, 3.737281316071546*^9}, {3.737281653054924*^9, 
   3.737281698062044*^9}, {3.737284237057*^9, 3.737284327083954*^9}, {
   3.7372843590048733`*^9, 3.737284369739956*^9}, {3.7372844386235523`*^9, 
   3.737284484892178*^9}, {3.7372850819056*^9, 3.737285090806818*^9}, {
   3.73728520111075*^9, 3.737285222748335*^9}, {3.737285270111203*^9, 
   3.73728530587646*^9}, {3.737285533840251*^9, 3.737285559292869*^9}, {
   3.7372856101403227`*^9, 3.737285657390164*^9}, {3.737285700136235*^9, 
   3.737285798718968*^9}, {3.7372858357113028`*^9, 3.737285868194257*^9}, {
   3.737285908459991*^9, 3.737286014905347*^9}, 3.737286052837697*^9, {
   3.7372861540618677`*^9, 3.737286154519107*^9}, {3.737286254980082*^9, 
   3.7372863413456507`*^9}, {3.737286380256139*^9, 3.7372864143825283`*^9}, {
   3.737286458977261*^9, 3.737286576079788*^9}, {3.737286623935347*^9, 
   3.737286632869177*^9}, {3.7372866648183327`*^9, 3.737286723584116*^9}, {
   3.737374746359795*^9, 3.737374832079135*^9}, {3.73737499904206*^9, 
   3.737375023959383*^9}, {3.737378138033321*^9, 3.737378164259573*^9}, {
   3.737378225363977*^9, 3.73737825691322*^9}, 3.7373784605339413`*^9, {
   3.737378502252293*^9, 3.73737864023484*^9}, {3.737378704823086*^9, 
   3.737378712047621*^9}, {3.737378750431796*^9, 3.737378752703669*^9}, {
   3.737378898239748*^9, 3.737378990411519*^9}, {3.73737903566635*^9, 
   3.7373791239583397`*^9}, {3.737379162032648*^9, 3.737379164836317*^9}, {
   3.7373792649735928`*^9, 3.7373793244342623`*^9}, {3.737379375913303*^9, 
   3.73737941501803*^9}, {3.737379491076782*^9, 3.737379495461954*^9}, {
   3.737379605763606*^9, 3.7373796928169928`*^9}, {3.73737986755727*^9, 
   3.7373800849030933`*^9}, {3.7373801268150043`*^9, 
   3.7373801843010073`*^9}, {3.737380294292263*^9, 3.737380294698414*^9}, {
   3.737380414361321*^9, 3.737380698358766*^9}, {3.7373807418017273`*^9, 
   3.73738075376825*^9}, {3.7373807854482927`*^9, 3.737380862411724*^9}, {
   3.737381036834449*^9, 3.737381064693281*^9}, {3.737381100937663*^9, 
   3.7373811217752542`*^9}, 3.737381158470895*^9, 3.737381221032393*^9, {
   3.737381678459423*^9, 3.737381805116645*^9}, {3.737381836958056*^9, 
   3.737381881326532*^9}, {3.737381917168672*^9, 3.7373819592222023`*^9}, {
   3.737382007542437*^9, 3.737382116848222*^9}, {3.7373821591203203`*^9, 
   3.737382355002592*^9}, {3.7379744155182457`*^9, 3.737974415670136*^9}, {
   3.7379754153411427`*^9, 3.737975452667324*^9}, {3.73797549962778*^9, 
   3.7379755241789637`*^9}, 3.737975563770276*^9, {3.737975648095365*^9, 
   3.7379756613659477`*^9}, {3.73921005915567*^9, 3.739210067088846*^9}, {
   3.7392103437571*^9, 3.739210372090125*^9}, {3.7392104083569927`*^9, 
   3.739210408785853*^9}, {3.739210561112054*^9, 3.739210658951914*^9}, {
   3.742878249248098*^9, 3.7428782535467987`*^9}, {3.7428782893930473`*^9, 
   3.742878353943668*^9}, {3.742878774060712*^9, 3.7428787793596373`*^9}, {
   3.742878811736623*^9, 3.742878976915493*^9}, {3.7428790184091597`*^9, 
   3.7428790837272663`*^9}, {3.742879158784565*^9, 3.7428791803486032`*^9}, {
   3.742879211104168*^9, 3.742879211738106*^9}, {3.7585299775360603`*^9, 
   3.75853003338778*^9}, 3.7627930937690287`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->417573255,
 $CellContext`ExpressionUUID -> "980d813f-5ce6-44d1-8dac-360bec13d687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretSpaceGroup\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sg", "=", "input"}], ",", "o", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{
           RowBox[{"StringTrim", "@", "sg"}], ",", "NumberString"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"sg", "=", 
          RowBox[{"ToExpression", "@", "sg"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{
        "a", " ", "canonical", " ", "space", " ", "group", " ", "number"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "sg", "\[LessEqual]", "230"}], ")"}], 
          "&&", 
          RowBox[{"IntegerQ", "@", "sg"}]}], ",", 
         RowBox[{"Return", "@", 
          RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
           RowBox[{"sg", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "SGnumber"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"abortQ", ",", 
            RowBox[{"Abort", "[", "]"}], ",", 
            RowBox[{"Return", "@", "Null"}]}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "string", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "string"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringQ", "@", "sg"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".2", " ", "Process", " ", "any", " ", "annotations"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"sg", ",", "\"\<origin\>\"", ",", 
         RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"o", "=", 
         RowBox[{"ChoiceDialog", "[", 
          RowBox[{
           RowBox[{
           "\"\<Information on cell origin detected.\>\"", "<>", 
            "\[IndentingNewLine]", "\"\<\\n\>\"", "<>", 
            "\"\<Please confirm the cell origin.\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WindowTitle", "\[Rule]", "\"\<Cell origin\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"sg", ",", 
           RowBox[{
           "Whitespace", "~~", "\"\<(\>\"", "~~", "__", "~~", "\"\<)\>\""}]}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".3", " ", "Tidy", " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "sg", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"B", ".4", 
           RowBox[{".1", ".", " ", "Remove"}], " ", "any", " ", "_enclosing", 
           "_", " ", "quotation", " ", "marks"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Note", ":", " ", 
           RowBox[{
           "Some", " ", "Hall", " ", "symbols", " ", "contain", " ", "double",
             " ", "quotation", " ", "marks"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "main__", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "EndOfString"}], "\[RuleDelayed]", "main"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".2", " ", "Uppercase", " ", "centring", " ", "1"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"first", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<-\>\"", "~~", "_"}], ",", "_"}], "}"}]}], "~~", 
            "rest__", "~~", "EndOfString"}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToUpperCase", "@", "first"}], "~~", 
            RowBox[{"ToLowerCase", "@", "rest"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".3", ".", " ", "Fix"}], " ", "boxes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<overscriptbox\>\"", "\[Rule]", "\"\<OverscriptBox\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<subscriptbox\>\"", "\[Rule]", "\"\<SubscriptBox\>\""}]}], 
           "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".4", " ", "Uppercase", " ", "centring", " ", "2"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<Box[\\(\>\"", "~~", "c_"}], "\[RuleDelayed]", 
           RowBox[{"\"\<Box[\\(\>\"", "<>", 
            RowBox[{"ToUpperCase", "[", "c", "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", ".5", " ", "Screw", " ", "axes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"a", ":", "DigitCharacter"}], "~~", "\"\<(\>\"", "~~", 
            RowBox[{"b", ":", "DigitCharacter"}], "~~", "\"\<)\>\""}], 
           "\[RuleDelayed]", 
           RowBox[{"a", "<>", "b"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".6", ".", " ", "Miscellaneous"}], " ", "replacements"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\"\<;\>\"", "\[Rule]", "\"\< \>\""}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Check"}], " ", "symbol", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "centring", " ", "symbol"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<P\>\"", ",", "\"\<I\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
            ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", 
            "\"\<H\>\"", ",", "\"\<\\!\>\"", ",", "\"\<-\>\""}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringTake", "[", 
           RowBox[{"sg", ",", "1"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", ".2", " ", "Check", " ", "if", " ", "found", " ", 
       RowBox[{"by", " ", "'"}], 
       RowBox[{"$GroupSymbolRedirect", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "sg", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"temp", ",", "\"\<PointGroupNumber\>\""}], "]"}], ",", 
          RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Exception", ":", " ", 
       RowBox[{"Old", " ", "symbol"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "\"\<Fm3m\>\""}], ",", 
       RowBox[{
        RowBox[{"sg", "=", "\"\<Fm-3m\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "C", ".3", " ", "Delete", " ", "whitespace", " ", "and", " ", "check", 
       " ", "again"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"sg", ",", "Whitespace"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "temp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"A", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "space", " ", "group"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<SG\>\""}], ",", "input"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"abortQ", ",", 
       RowBox[{"Abort", "[", "]"}], ",", 
       RowBox[{"Return", "@", "Null"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"B", ".", " ", "Return"}], " ", "non"}], "-", 
       RowBox[{"ambiguous", " ", "output"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SpaceGroupFound\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "o", "]"}], ",", 
       RowBox[{"sg", "=", 
        RowBox[{"sg", "<>", "\"\<:\>\"", "<>", 
         RowBox[{"ToString", "[", "o", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ToStandardSetting", "[", "sg", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278689235427*^9, 
   3.737278724291026*^9}, {3.7373828319134293`*^9, 3.737382905583477*^9}, {
   3.7380503409830427`*^9, 3.7380503462202253`*^9}, {3.738050409199875*^9, 
   3.738050410020376*^9}, {3.738050587280776*^9, 3.738050594380994*^9}, {
   3.738050633314591*^9, 3.738050741885346*^9}, 3.738050787226899*^9, {
   3.738050820907621*^9, 3.738050913718038*^9}, {3.738050967336628*^9, 
   3.738051039601925*^9}, {3.738051123094633*^9, 3.7380511685169477`*^9}, {
   3.7380512915012083`*^9, 3.73805131582058*^9}, 3.73805147687253*^9, {
   3.738291406092393*^9, 3.738291463424559*^9}, {3.739251235484573*^9, 
   3.739251259594013*^9}, {3.7392664653604727`*^9, 3.739266516678097*^9}, 
   3.7392665477450542`*^9, {3.739267739894909*^9, 3.739267740037506*^9}, 
   3.73950412920148*^9, {3.742016464322269*^9, 3.742016465840391*^9}, {
   3.742022822926903*^9, 3.742022908512398*^9}, {3.742022978221959*^9, 
   3.74202298550244*^9}, {3.743865456276009*^9, 3.7438654563219023`*^9}, {
   3.7438669045354652`*^9, 3.7438669207895317`*^9}, {3.758530035604117*^9, 
   3.758530048874316*^9}, 3.762793093794232*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->177138389,
 $CellContext`ExpressionUUID -> "87669779-bf6f-49c2-a46e-d094bc03bec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointGroupQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Check", " ", "if", " ", "valid", " ", "space", " ", "group", " ", 
     "string"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"$PointGroups", ",", "input", ",", "Infinity"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "\"\<PG\>\""}], ",", "input"}], "]"}], 
      ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.7136042900817747`*^9}, {
   3.713604322627748*^9, 3.713604324160606*^9}, {3.7136043702641973`*^9, 
   3.713604371101212*^9}, {3.71471126435174*^9, 3.71471126555512*^9}, 
   3.717740897041522*^9, 3.72760353803649*^9, {3.7305444772094812`*^9, 
   3.730544481061934*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->752569181,
 $CellContext`ExpressionUUID -> "254eed9a-9445-40db-b24d-472d2350b88b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointSpaceGroupQ\>\""}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "if", " ", "valid", " ", "point"}], "-", " ", 
    RowBox[{"or", " ", "space", " ", "group", " ", "string"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "PSG"}], ",", "input"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, {
   3.713604296226803*^9, 3.713604299721271*^9}, {3.714710977590053*^9, 
   3.714710979768374*^9}, 3.717740920646922*^9, 3.7276035440759487`*^9, 
   3.743865456393198*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1899027884,
 $CellContext`ExpressionUUID -> "ca8d9a53-8b24-4939-b8f1-e2ca3a470796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"type_String", ",", 
    RowBox[{"scatteringAngle_:", "0"}], ",", "\"\<Polarisation\>\""}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"type", "===", "\"\<sigma\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Sigma]\>\""}]}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", "===", "\"\<pi\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Pi]\>\""}]}], ",", 
    RowBox[{"Abs", "@", 
     RowBox[{"Cos", "[", "scatteringAngle", "]"}]}], ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"InputCheck", "::", "\"\<polarisation\>\""}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1059684674,
 $CellContext`ExpressionUUID -> "21c993c3-a67a-4d03-a7b5-7cd460cbf33b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{
   "crystal_String", ",", "wavelength_", ",", "\"\<ProcessWavelength\>\"", 
    ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[Lambda]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"wavelength", "===", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
         "crystal", ",", "\"\<GetCrystalWavelength\>\"", ",", "abortQ"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", "wavelength"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\[Lambda]", ",", "\"\<GetEnergyWavelength\>\"", ",", "False"}],
       "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.730395241910015*^9, 3.730395331782501*^9}, 
   3.73039551088382*^9, {3.7391249707350397`*^9, 3.739124986130555*^9}, {
   3.73912511330057*^9, 3.739125114641823*^9}, {3.739125407092436*^9, 
   3.7391254219192133`*^9}, {3.7391254965873337`*^9, 3.739125499857193*^9}, {
   3.739125656582911*^9, 3.739125666230063*^9}, 3.762793093803693*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1038431347,
 $CellContext`ExpressionUUID -> "a5b11313-8f8e-4d89-bf43-7d46a4865e93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "label"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised check label.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "dim"}], "=", 
   "\"\<Reflections (and coordinates) must be on a {\!\(\*
StyleBox[\"h\", \"TI\"]\), \!\(\*
StyleBox[\"k\", \"TI\"]\), \!\(\*
StyleBox[\"l\", \"TI\"]\)} (or {\!\(\*
StyleBox[\"x\", \"TI\"]\), \!\(\*
StyleBox[\"y\", \"TI\"]\), \!\(\*
StyleBox[\"z\", \"TI\"]\)}) form\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "one"}], "=", 
   "\"\<Only one `1` expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "head"}], "=", 
   "\"\<Head of indices must be either Integer, String or Symbol.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "few"}], "=", 
   "\"\<At least two reflections are required to make comparisons.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyunit"}], "=", 
   "\"\<Input does not have a unit compatible with energy or \
wavelength.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyinput"}], "=", 
   "\"\<Input must be an energy or wavelength compatible Quantity, or a \
number.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "poslambda"}], "=", 
    "\"\<The wavelength/energy must be positive.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystal"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "wavelength"}], "=", 
   "\"\<No wavelength was found for crystal \[LeftGuillemet]`1`\
\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "userinput"}], "=", 
   "\"\<Invalid user input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "polarisation"}], "=", 
    "\"\<Invalid polarisation setting.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PSG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point- \
or space group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a space \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SGnumber"}], "=", 
   "\"\<Valid space group numbers are between 1 and 230.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystalSG"}], "=", 
   "\"\<Crystal entry \[LeftGuillemet]`1`\[RightGuillemet] has invalid space \
group \[LeftGuillemet]`2`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "PSGC"}], "=", 
    "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group, space group or a crystal.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "centringerror"}], "=", 
   "\"\<Invalid space group centring.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementNumber"}], "=", 
   "\"\<Element number `1` is out of range.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementFailed"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a \
chemical element.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "ElementError"}], "=", 
    "\"\<The element \[LeftGuillemet]`1`\[RightGuillemet] cannot be \
interpreted.\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "InputCheck"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "__", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.6856820263060083`*^9, 3.6856820338793163`*^9}, {
   3.685682083417005*^9, 3.685682092894709*^9}, {3.6856840260308533`*^9, 
   3.685684026178547*^9}, {3.685686819102976*^9, 3.6856868408053513`*^9}, {
   3.685687011142066*^9, 3.685687017829006*^9}, {3.685687131249773*^9, 
   3.685687151398356*^9}, {3.685687183159276*^9, 3.6856871838215933`*^9}, {
   3.685687254295497*^9, 3.685687281286789*^9}, {3.685687660039452*^9, 
   3.6856877115995817`*^9}, {3.68568838863011*^9, 3.6856884381337767`*^9}, {
   3.685690949932845*^9, 3.6856909574232817`*^9}, {3.685691048596792*^9, 
   3.685691065258542*^9}, {3.685691555385049*^9, 3.685691595897393*^9}, {
   3.685693407917099*^9, 3.6856934105491962`*^9}, {3.685693449539488*^9, 
   3.685693464972211*^9}, {3.685693732995039*^9, 3.6856937393916893`*^9}, {
   3.685693867613049*^9, 3.685693870503192*^9}, {3.685694016861869*^9, 
   3.685694053583612*^9}, {3.685694415120605*^9, 3.685694415410471*^9}, {
   3.6856953860999413`*^9, 3.685695404607368*^9}, {3.68569555947088*^9, 
   3.685695605133265*^9}, {3.685696124318612*^9, 3.68569613828201*^9}, {
   3.685696178849712*^9, 3.685696180401723*^9}, {3.685696592780033*^9, 
   3.6856965970349083`*^9}, {3.6870711449669037`*^9, 3.687071165830688*^9}, {
   3.6870725649937353`*^9, 3.687072567422408*^9}, {3.711081329746539*^9, 
   3.711081335862384*^9}, {3.711083709642126*^9, 3.71108372803414*^9}, {
   3.712990896317184*^9, 3.712990899230811*^9}, {3.713603056038671*^9, 
   3.7136030717991047`*^9}, 3.713603337329356*^9, {3.7136034598308163`*^9, 
   3.713603470204297*^9}, {3.713604348937676*^9, 3.71360436129599*^9}, {
   3.717147714818186*^9, 3.717147739983534*^9}, {3.7171480835458517`*^9, 
   3.717148091231995*^9}, {3.726560324583314*^9, 3.7265603577752657`*^9}, {
   3.726853588279467*^9, 3.7268536391946774`*^9}, {3.7271789201847763`*^9, 
   3.727178947159677*^9}, {3.7275066313384666`*^9, 3.72750665317505*^9}, {
   3.727513894430643*^9, 3.727513902461985*^9}, {3.727596618528956*^9, 
   3.727596645209611*^9}, {3.727601483861143*^9, 3.7276014841869497`*^9}, {
   3.7276028953923073`*^9, 3.727602914012473*^9}, {3.728109699712471*^9, 
   3.728109743760724*^9}, {3.728765837392223*^9, 3.728765846807078*^9}, {
   3.7340775949863367`*^9, 3.734077598710491*^9}, {3.7372791075805187`*^9, 
   3.73727914741197*^9}, {3.7372792368998547`*^9, 3.737279256825714*^9}, {
   3.737285569781273*^9, 3.737285603410686*^9}, {3.739187854951786*^9, 
   3.73918785517507*^9}, {3.742016334042914*^9, 3.742016337494812*^9}, {
   3.742016368507223*^9, 3.74201638931714*^9}, {3.7567126007785892`*^9, 
   3.756712616867313*^9}, 3.75671264844755*^9, {3.756712756093667*^9, 
   3.756712764043981*^9}, {3.75671279769972*^9, 3.756712815035034*^9}, {
   3.756713298279908*^9, 3.7567132995556707`*^9}},
 CellID->939340375,
 $CellContext`ExpressionUUID -> "f6062f54-1222-4d57-ae33-6e13722a2bcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", "\[IndentingNewLine]", 
   RowBox[{"input_List", ",", "\[IndentingNewLine]", 
    RowBox[{"labels___", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", ",", 
           "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
           "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], ",", 
         RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"check", ",", "hkl", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"check", "=", 
      RowBox[{"{", "labels", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
         "check", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", 
               ",", "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
               "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], 
             ",", "temp"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"InputCheck", "::", "label"}], ",", "temp"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dimensions", " ", "check", " ", 
       RowBox[{"(", 
        RowBox[{"always", " ", "required"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Single", " ", 
        RowBox[{"reflection", "/", "coordinate"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"input", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
            "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"hkl", "=", 
        RowBox[{"{", "input", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Multiple", " ", 
         RowBox[{"reflections", "/", "coordinates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
             RowBox[{"!", 
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
               "]"}]}]}]}], "]"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{"hkl", "=", "input"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "dim"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", 
       RowBox[{"reflection", "/", "coordinates"}], " ", "check"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1hkl\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<reflection\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1xyz\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<coordinate\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Multiple", " ", "reflections", " ", "check"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Multiple\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "<", "2"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "few"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Integer", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Integer\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "hkl"}], ",", "IntegerQ"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "integer"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "if", " ", "Integer"}], ",", " ", 
       RowBox[{"String", " ", "or", " ", "Symbol"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<StringSymbol\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ContainsAll", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Integer", ",", "String", ",", "Symbol", ",", "Times"}], 
             "}"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Head", "/@", 
             RowBox[{"Flatten", "@", "hkl"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "head"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wrap", " ", "single", " ", "reflections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<WrapSingle\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "input", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Return", "[", "input", "]"}]}], "\[IndentingNewLine]", "\t",
         "]"}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.687070782983131*^9, 3.687070826316058*^9}, {
   3.711080493388452*^9, 3.711080530269607*^9}, {3.7110838434149733`*^9, 
   3.711083844960722*^9}, {3.712990600076755*^9, 3.712990608318782*^9}, {
   3.712990804480831*^9, 3.7129908060016212`*^9}, {3.712990947248521*^9, 
   3.712990947808515*^9}, {3.713510243799721*^9, 3.7135102514986553`*^9}, {
   3.713510288538774*^9, 3.713510293259116*^9}, {3.7135103372502947`*^9, 
   3.713510338184915*^9}, {3.71431192571665*^9, 3.7143119392365303`*^9}, {
   3.7143120972494097`*^9, 3.714312097447524*^9}, {3.7143121915742683`*^9, 
   3.7143122110300217`*^9}, {3.714312273573138*^9, 3.714312308114839*^9}, {
   3.71445784032449*^9, 3.714457847602706*^9}, 3.714458049967931*^9, {
   3.7147109057397537`*^9, 3.714710909787726*^9}, {3.714710945019298*^9, 
   3.714710963965468*^9}, {3.717143871479184*^9, 3.717143873754469*^9}, {
   3.717146708601173*^9, 3.717146713501816*^9}, {3.717147467353772*^9, 
   3.717147472518999*^9}, {3.717147554646175*^9, 3.717147555923188*^9}, {
   3.717147595628448*^9, 3.717147596128397*^9}, 3.7171476872925243`*^9, {
   3.717147790297018*^9, 3.7171478112554407`*^9}, {3.7171480444680862`*^9, 
   3.717148048818454*^9}, {3.7171482182403383`*^9, 3.7171482183828487`*^9}, {
   3.717148818843635*^9, 3.717148834361803*^9}, {3.7171489319542913`*^9, 
   3.717148951600135*^9}, {3.717149178012879*^9, 3.71714919115486*^9}, {
   3.717149260050128*^9, 3.717149280072538*^9}, {3.717149333315688*^9, 
   3.717149397350493*^9}, {3.717149552908246*^9, 3.7171495813302383`*^9}, {
   3.718521630559267*^9, 3.718521641789692*^9}, {3.7185216726962433`*^9, 
   3.7185216733580647`*^9}, {3.718636471385057*^9, 3.7186364749898767`*^9}, {
   3.7186366347963343`*^9, 3.718636636271434*^9}, {3.7259581138852463`*^9, 
   3.725958115603722*^9}, {3.7372783098194*^9, 3.737278316869255*^9}, 
   3.737371806626379*^9, 3.737384013131838*^9, {3.7373840435457*^9, 
   3.7373840851194687`*^9}, {3.737384137351205*^9, 3.73738418240597*^9}, {
   3.7373842155798798`*^9, 3.737384232171645*^9}, {3.737384415256804*^9, 
   3.737384433510865*^9}, {3.75852996982882*^9, 3.758529971762226*^9}, 
   3.7627930936957808`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1341393528,
 $CellContext`ExpressionUUID -> "582dd116-7bbf-4577-b0db-a95e7cf4dbe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<CrystalQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "entry", " ", "exists", " ", 
     RowBox[{"in", " ", "'"}], 
     RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MissingQ", "@", 
      RowBox[{"$CrystalData", "[", "input", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "crystal"}], ",", "input"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.7276035463522577`*^9, 
   3.72760354706783*^9}, {3.74556825639723*^9, 3.7455682923534517`*^9}, {
   3.745568690840042*^9, 3.745568699006835*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->517698890,
 $CellContext`ExpressionUUID -> "2573f9e8-2af9-42ca-94dd-d3fbf8c90797"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"centring_String", ",", "\"\<GetCentringVectors\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "vectors", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"centring", "===", "\"\<P\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<F\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<I\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<R\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<A\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<B\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "0", ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<C\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<H\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "centringerror"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"vectors", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}, {
   3.734077376632456*^9, 3.734077480964463*^9}, {3.734412586131454*^9, 
   3.7344125991220827`*^9}, 3.762793093706504*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1508990233,
 $CellContext`ExpressionUUID -> "dbcf2741-11e4-4698-a8af-daf49f068290"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalFormulaUnits\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
       "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
         "\"\<FormulaUnits\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"input", ",", "\"\<FormulaUnits\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "not"}], ",", " ", 
         RowBox[{"query", " ", "user", " ", "manually"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"InputString", "[", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Cannot determine the number of formula units \>\"", "<>", 
           "\[IndentingNewLine]", "\"\<for \[LeftGuillemet]\>\"", "<>", 
           "input", "<>", "\"\<\[RightGuillemet].\>\"", "<>", "\"\<\\n\>\"", "<>",
            "\[IndentingNewLine]", 
           "\"\<Please enter that number or the density below.\>\""}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "output"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "userinput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "output"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.727178717966507*^9, 
   3.727178721188702*^9}, {3.727178758964155*^9, 3.727178761323883*^9}, {
   3.727178860595625*^9, 3.727178901192408*^9}, {3.727178964913246*^9, 
   3.727178966567266*^9}, {3.727601687423465*^9, 3.727601704808043*^9}, {
   3.727601744534422*^9, 3.727601771061698*^9}, {3.727602475651042*^9, 
   3.727602607286476*^9}, {3.7276026482929697`*^9, 3.727602649418606*^9}, {
   3.727602816432906*^9, 3.727602879307555*^9}, {3.7276029234914637`*^9, 
   3.727602926124346*^9}, {3.727603730383863*^9, 3.72760373066368*^9}, {
   3.727603973849247*^9, 3.7276039750255003`*^9}, {3.738049785054161*^9, 
   3.7380497898471613`*^9}, 3.762793093715082*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1964458608,
 $CellContext`ExpressionUUID -> "9ccfd331-de3b-4fca-9f9d-02e8c569c92d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalSpaceGroup\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "is", " ", "valid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.727506566988821*^9, 
   3.7275065675308313`*^9}, {3.7276035560711937`*^9, 3.72760355630114*^9}, {
   3.7276036304674597`*^9, 3.727603631524433*^9}, 3.727676784104806*^9, {
   3.7340864321506767`*^9, 3.7340865206369267`*^9}, 3.743865456049979*^9, 
   3.762793093722595*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1242235678,
 $CellContext`ExpressionUUID -> "bf221871-bd0a-4a76-8548-8cb2f84c0102"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalWavelength\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InputCheck", "[", 
     RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
      "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
        "\"\<Wavelength\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "@", 
       RowBox[{"$CrystalData", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"input", ",", "\"\<Wavelength\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", " ", "not"}], ",", " ", 
        RowBox[{
         RowBox[{"abort", " ", "OR", " ", 
          RowBox[{"return", " ", "'"}]}], "-", 
         RowBox[{"1", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"abortQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InputCheck", "::", "wavelength"}], ",", "input"}], "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}],
    ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.739125707135515*^9, 3.7391257657796993`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->419024012,
 $CellContext`ExpressionUUID -> "4076f94c-029e-4e4f-be5f-3bb8a6a0ae57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Converts", " ", "to", " ", 
    RowBox[{"wavelength", " ", "[", "\[ARing]ngstr\[ODoubleDot]ms", "]"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"InputCheck", "[", 
    RowBox[{"input_", ",", "\"\<GetEnergyWavelength\>\"", ",", 
     RowBox[{"unitsQ_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hcKeV", "=", "12.398420"}], ",", "\[Lambda]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Only", " ", "exception"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"input", "===", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "if", " ", "positive"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"Positive", "@", "input"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "poslambda"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"A", ".", " ", "Number"}], " ", "input"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NumericQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"1.", " ", "Assume", " ", "\[ARing]ngstr\[ODoubleDot]ms"}], 
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"input", " ", "\[LessEqual]", " ", "5.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"N", "@", "input"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"2.", " ", "Assume", " ", "kilo", " ", "electronvolt"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"input", " ", "\[LessEqual]", " ", "250.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", "input"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"3.", " ", "Assume", " ", "electronvolts"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"1000", "*", 
            RowBox[{"hcKeV", "/", "input"}]}]}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Quantity"}], " ", "input"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"QuantityQ", "[", "input", "]"}], " ", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Convert", " ", "wavelength", " ", "or", " ", "energy", " ", "to", 
          " ", "\[ARing]ngstr\[ODoubleDot]ms"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"UnitDimensions", "[", "input", "]"}], "===", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\"\<LengthUnit\>\"", ",", "1"}], "}"}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"\[Lambda]", "=", 
            RowBox[{"UnitConvert", "[", 
             RowBox[{"input", ",", "\"\<Angstroms\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"unitsQ", ",", 
             RowBox[{"Return", "@", "\[Lambda]"}], ",", 
             RowBox[{"Return", "@", 
              RowBox[{"QuantityMagnitude", "@", "\[Lambda]"}]}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"CompatibleUnitQ", "[", 
           RowBox[{"input", ",", "\"\<Joules\>\""}], "]"}], ",", "\t\t", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", 
            RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"UnitConvert", "[", 
              RowBox[{"input", ",", "\"\<Kiloelectronvols\>\""}], "]"}]}]}]}],
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"InputCheck", "::", "energyunit"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"C", ".", " ", "None"}], " ", "of", " ", "the", " ", 
          "above"}], " ", "*)"}], "\[IndentingNewLine]", "True", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "energyinput"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Set", " ", "in", " ", "Quantity", " ", "if", " ", "desired"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"unitsQ", ",", "\[IndentingNewLine]", 
        RowBox[{"Quantity", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Angstroms\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\[Lambda]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.726560443424157*^9, 
   3.726560447064084*^9}, 3.72685205362494*^9, {3.7268524061436033`*^9, 
   3.7268525118996563`*^9}, {3.726853451219391*^9, 3.726853553519404*^9}, {
   3.72685364594137*^9, 3.726853659220982*^9}, {3.726853721494712*^9, 
   3.7268537360194597`*^9}, {3.726853814139167*^9, 3.726853866046702*^9}, {
   3.72685391283145*^9, 3.726854013342908*^9}, {3.72685443464507*^9, 
   3.726854444243165*^9}, {3.726854740941407*^9, 3.726854744623098*^9}, {
   3.726854833074029*^9, 3.726854873935768*^9}, {3.72685491084039*^9, 
   3.726854918136497*^9}, {3.72685498979923*^9, 3.726855068318531*^9}, {
   3.726855109331604*^9, 3.726855122067479*^9}, {3.7268555301237164`*^9, 
   3.726855539752921*^9}, {3.7268559339858027`*^9, 3.726855959866241*^9}, {
   3.7268559904322023`*^9, 3.72685603510135*^9}, {3.72685615357065*^9, 
   3.72685615402689*^9}, {3.726856216650893*^9, 3.726856369277254*^9}, {
   3.7268564800835943`*^9, 3.7268564992580137`*^9}, {3.726856620967496*^9, 
   3.726856621815027*^9}, {3.726856668775392*^9, 3.726856720204636*^9}, {
   3.7268568209881*^9, 3.72685684971353*^9}, {3.72685688102668*^9, 
   3.7268569498483753`*^9}, {3.7268570554316273`*^9, 3.726857141124441*^9}, {
   3.72685733536134*^9, 3.726857445821105*^9}, {3.7268574798936377`*^9, 
   3.726857484116231*^9}, {3.726857520876247*^9, 3.726857597705496*^9}, {
   3.7268576490821247`*^9, 3.726857665286269*^9}, {3.726896856919681*^9, 
   3.726896865360489*^9}, {3.726897043655274*^9, 3.72689706577814*^9}, {
   3.726899351343816*^9, 3.726899381328332*^9}, 3.7268997978240433`*^9, {
   3.7275466850188923`*^9, 3.727546685984756*^9}, {3.727596442016464*^9, 
   3.727596443184536*^9}, {3.7275965437672157`*^9, 3.727596576954631*^9}, 
   3.727596651111322*^9, {3.72760374260155*^9, 3.727603759529471*^9}, {
   3.728109774970121*^9, 3.728109880586781*^9}, 3.73441267980902*^9, {
   3.738049815649427*^9, 3.738049826421247*^9}, {3.7391251770910673`*^9, 
   3.739125211688257*^9}, {3.7391256829934187`*^9, 3.739125689976153*^9}, 
   3.762793093738366*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->937691171,
 $CellContext`ExpressionUUID -> "46300c07-37a8-4c26-9c3c-bfd429ab81d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], "]"}], ":=", 
  
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"$CrystalDataCombined", ",", "sg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "space", " ", "group", " ", "number", " ", "is",
       " ", "given"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "input", "\[LessEqual]", "230"}], ")"}],
         "&&", 
        RowBox[{"IntegerQ", "@", "input"}]}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
         RowBox[{"input", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
         "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "If", " ", "actual", " ", "input", " ", "is", " ", "a", " ", 
         "point"}], "-", " ", 
        RowBox[{"or", " ", "space", " ", "group"}]}], ",", " ", 
       RowBox[{"return", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}], ",", 
       RowBox[{"Return", "@", "input"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "MaXrd`Private`$TempCrystalData"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"$CrystalData", ",", "MaXrd`Private`$TempCrystalData"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", "$CrystalData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "@", 
        RowBox[{"$CrystalDataCombined", "[", "input", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "PSGC"}], ",", "input"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "exists"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalDataCombined", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.72750620550637*^9, 
   3.727506277082754*^9}, 3.7275065790218277`*^9, 3.72750668943563*^9, {
   3.7275138768842697`*^9, 3.727513877580575*^9}, {3.7276037003393583`*^9, 
   3.7276037005968237`*^9}, {3.727603930848737*^9, 3.727603935750414*^9}, {
   3.734086562493793*^9, 3.734086592174155*^9}, {3.734087081953874*^9, 
   3.734087111656989*^9}, {3.743865456115304*^9, 3.743865456153502*^9}, {
   3.758529973221416*^9, 3.7585299759035673`*^9}, {3.7614238939583063`*^9, 
   3.7614239274759207`*^9}, {3.76142400648403*^9, 3.7614240067298727`*^9}, {
   3.7614240390817547`*^9, 3.7614241404093447`*^9}, {3.7614242479891987`*^9, 
   3.7614242705338163`*^9}, {3.761424370948794*^9, 3.761424372186491*^9}, 
   3.762793093748088*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1540509311,
 $CellContext`ExpressionUUID -> "40d1c1ed-62fb-4df8-907d-7b157fdb296f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretElement\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"elementsIn", "=", "input"}], ",", "pertiodicTable", ",", 
      "elementsRead", ",", "elementsReadNeutral", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{"elementsIn", ",", "NumberString"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"elementsIn", "=", 
          RowBox[{"ToExpression", "@", "elementsIn"}]}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{"in", " ", "the", " ", "periodic", " ", "table"}], ")"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "elementsIn", "\[LessEqual]", 
            RowBox[{"Length", "@", "$PeriodicTable"}]}], ")"}], "&&", 
          RowBox[{"IntegerQ", "@", "elementsIn"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Keys", "@", "$PeriodicTable"}], ")"}], 
           "\[LeftDoubleBracket]", "elementsIn", "\[RightDoubleBracket]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "ElementNumber"}], ",", 
            RowBox[{"ToString", "@", "elementsIn"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "single", " ", "string", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Wrap"}], " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", 
       RowBox[{"elementsIn", "=", 
        RowBox[{"{", "elementsIn", "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Process"}], " ", "list", " ", "of", " ", 
       "strings", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "input", " ", "is", 
       " ", "a", " ", "list", " ", "of", " ", "strings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "elementsIn"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"elementsIn", ",", "StringQ"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".2", ".", " ", "Set"}], " ", "of", " ", "valid", " ", 
       "symbols", " ", "from", " ", "the", " ", "periodic", " ", "table"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pertiodicTable", "=", 
      RowBox[{"Keys", "@", "$PeriodicTable"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"C", 
        RowBox[{".3", ".", " ", "Find"}], " ", 
        RowBox[{"(", "possible", ")"}], " ", "matches"}], ",", " ", 
       RowBox[{"and", " ", "establish", " ", "order"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"elementsIn", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StartOfString", "~~", 
          RowBox[{"a", ":", "LetterCharacter"}], "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{"b", ":", "LetterCharacter"}]}], "}"}], "~~", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{
             RowBox[{"n1", ":", 
              RowBox[{"DigitCharacter", "..."}]}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n2", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"ToUpperCase", "[", "a", "]"}], "<>", 
          RowBox[{"ToLowerCase", "[", "b", "]"}], "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n1", "===", "\"\<\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"n2", "===", "\"\<\>\""}], ")"}]}], ",", "\"\<1\>\"", 
            ",", "\"\<\>\""}], "]"}], "<>", "n1", "<>", "n2", "<>", 
          "pm"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "for", " ", "non"}], "-", "elements"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"elementsRead", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsRead", ",", 
               RowBox[{"{", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Separate", " ", "element", " ", "symbol", " ", "and", " ", "charge", 
       " ", 
       RowBox[{"(", 
        RowBox[{"if", " ", "any"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "elementsRead"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"a", ":", 
             RowBox[{"LetterCharacter", ".."}]}], "~~", "b___"}], 
           "\[IndentingNewLine]", "\t", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"b", "===", "\"\<\>\""}], ",", "\"\<&\>\"", ",", "b"}],
               "]"}]}], "}"}]}]}], "]"}], ",", "1"}], "]"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"'", "&"}], "'"}], " ", "should", " ", "be", " ", "deleted", 
       " ", "later"}], " ", "*)"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".4", ".", " ", "Remove"}], " ", "second", " ", "character", 
       " ", "if", " ", "not", " ", "applicable"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{
        RowBox[{"s_String", "/;", "\[IndentingNewLine]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"pertiodicTable", ",", "s"}], "]"}]}]}], "\[RuleDelayed]", 
        
        RowBox[{"StringTake", "[", 
         RowBox[{"s", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", "deuterium"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".5", ".", " ", "Final"}], " ", "validity", " ", "check"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elementsReadNeutral", ",", "pertiodicTable"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsReadNeutral", ",", "\[IndentingNewLine]", 
               RowBox[{"First", "@", "temp"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".6", ".", " ", "Concatenate"}], " ", "elements", " ", "and", 
       " ", "charge"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      "elementsReadNeutral"}], ";", "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"elementsRead", "/.", 
       RowBox[{"\"\<1\>\"", "\[Rule]", "\"\<\>\""}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"StringJoin", "/@", "elementsRead"}], ",", "\"\<&\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "chemical", " ", "element"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<ElementFailed\>\""}], ",", 
       RowBox[{"ToString", "@", "input"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"b", ".", " ", "Return"}], " ", "string", " ", 
       RowBox[{"(", 
        RowBox[{"or", " ", "list", " ", "of", " ", "strings"}], ")"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "elementsRead", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        ",", "elementsRead"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278567175089*^9, 
   3.737278609150566*^9}, {3.737278661861796*^9, 3.7372787061104527`*^9}, {
   3.737278786430764*^9, 3.737278815614232*^9}, {3.737278876614931*^9, 
   3.737278894575992*^9}, {3.737279063214642*^9, 3.737279117617867*^9}, {
   3.737279153995288*^9, 3.737279156957521*^9}, {3.737279209224059*^9, 
   3.7372792281945353`*^9}, {3.737279265333662*^9, 3.7372792662517557`*^9}, {
   3.737279499593874*^9, 3.7372795003597097`*^9}, {3.7372795311927958`*^9, 
   3.737279607430427*^9}, {3.737279901036427*^9, 3.737279905187501*^9}, {
   3.73728056780586*^9, 3.737280595834815*^9}, {3.737280731938634*^9, 
   3.7372807824368553`*^9}, {3.737280821275927*^9, 3.737280850048135*^9}, {
   3.7372808982833033`*^9, 3.7372809507817802`*^9}, {3.737281047830305*^9, 
   3.737281064716365*^9}, {3.7372811554403543`*^9, 3.73728118861235*^9}, {
   3.7372812569776163`*^9, 3.737281316071546*^9}, {3.737281653054924*^9, 
   3.737281698062044*^9}, {3.737284237057*^9, 3.737284327083954*^9}, {
   3.7372843590048733`*^9, 3.737284369739956*^9}, {3.7372844386235523`*^9, 
   3.737284484892178*^9}, {3.7372850819056*^9, 3.737285090806818*^9}, {
   3.73728520111075*^9, 3.737285222748335*^9}, {3.737285270111203*^9, 
   3.73728530587646*^9}, {3.737285533840251*^9, 3.737285559292869*^9}, {
   3.7372856101403227`*^9, 3.737285657390164*^9}, {3.737285700136235*^9, 
   3.737285798718968*^9}, {3.7372858357113028`*^9, 3.737285868194257*^9}, {
   3.737285908459991*^9, 3.737286014905347*^9}, 3.737286052837697*^9, {
   3.7372861540618677`*^9, 3.737286154519107*^9}, {3.737286254980082*^9, 
   3.7372863413456507`*^9}, {3.737286380256139*^9, 3.7372864143825283`*^9}, {
   3.737286458977261*^9, 3.737286576079788*^9}, {3.737286623935347*^9, 
   3.737286632869177*^9}, {3.7372866648183327`*^9, 3.737286723584116*^9}, {
   3.737374746359795*^9, 3.737374832079135*^9}, {3.73737499904206*^9, 
   3.737375023959383*^9}, {3.737378138033321*^9, 3.737378164259573*^9}, {
   3.737378225363977*^9, 3.73737825691322*^9}, 3.7373784605339413`*^9, {
   3.737378502252293*^9, 3.73737864023484*^9}, {3.737378704823086*^9, 
   3.737378712047621*^9}, {3.737378750431796*^9, 3.737378752703669*^9}, {
   3.737378898239748*^9, 3.737378990411519*^9}, {3.73737903566635*^9, 
   3.7373791239583397`*^9}, {3.737379162032648*^9, 3.737379164836317*^9}, {
   3.7373792649735928`*^9, 3.7373793244342623`*^9}, {3.737379375913303*^9, 
   3.73737941501803*^9}, {3.737379491076782*^9, 3.737379495461954*^9}, {
   3.737379605763606*^9, 3.7373796928169928`*^9}, {3.73737986755727*^9, 
   3.7373800849030933`*^9}, {3.7373801268150043`*^9, 
   3.7373801843010073`*^9}, {3.737380294292263*^9, 3.737380294698414*^9}, {
   3.737380414361321*^9, 3.737380698358766*^9}, {3.7373807418017273`*^9, 
   3.73738075376825*^9}, {3.7373807854482927`*^9, 3.737380862411724*^9}, {
   3.737381036834449*^9, 3.737381064693281*^9}, {3.737381100937663*^9, 
   3.7373811217752542`*^9}, 3.737381158470895*^9, 3.737381221032393*^9, {
   3.737381678459423*^9, 3.737381805116645*^9}, {3.737381836958056*^9, 
   3.737381881326532*^9}, {3.737381917168672*^9, 3.7373819592222023`*^9}, {
   3.737382007542437*^9, 3.737382116848222*^9}, {3.7373821591203203`*^9, 
   3.737382355002592*^9}, {3.7379744155182457`*^9, 3.737974415670136*^9}, {
   3.7379754153411427`*^9, 3.737975452667324*^9}, {3.73797549962778*^9, 
   3.7379755241789637`*^9}, 3.737975563770276*^9, {3.737975648095365*^9, 
   3.7379756613659477`*^9}, {3.73921005915567*^9, 3.739210067088846*^9}, {
   3.7392103437571*^9, 3.739210372090125*^9}, {3.7392104083569927`*^9, 
   3.739210408785853*^9}, {3.739210561112054*^9, 3.739210658951914*^9}, {
   3.742878249248098*^9, 3.7428782535467987`*^9}, {3.7428782893930473`*^9, 
   3.742878353943668*^9}, {3.742878774060712*^9, 3.7428787793596373`*^9}, {
   3.742878811736623*^9, 3.742878976915493*^9}, {3.7428790184091597`*^9, 
   3.7428790837272663`*^9}, {3.742879158784565*^9, 3.7428791803486032`*^9}, {
   3.742879211104168*^9, 3.742879211738106*^9}, {3.7585299775360603`*^9, 
   3.75853003338778*^9}, 3.7627930937690287`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1277141745,
 $CellContext`ExpressionUUID -> "980d813f-5ce6-44d1-8dac-360bec13d687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretSpaceGroup\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sg", "=", "input"}], ",", "o", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{
           RowBox[{"StringTrim", "@", "sg"}], ",", "NumberString"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"sg", "=", 
          RowBox[{"ToExpression", "@", "sg"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{
        "a", " ", "canonical", " ", "space", " ", "group", " ", "number"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "sg", "\[LessEqual]", "230"}], ")"}], 
          "&&", 
          RowBox[{"IntegerQ", "@", "sg"}]}], ",", 
         RowBox[{"Return", "@", 
          RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
           RowBox[{"sg", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "SGnumber"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"abortQ", ",", 
            RowBox[{"Abort", "[", "]"}], ",", 
            RowBox[{"Return", "@", "Null"}]}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "string", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "string"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringQ", "@", "sg"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".2", " ", "Process", " ", "any", " ", "annotations"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"sg", ",", "\"\<origin\>\"", ",", 
         RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"o", "=", 
         RowBox[{"ChoiceDialog", "[", 
          RowBox[{
           RowBox[{
           "\"\<Information on cell origin detected.\>\"", "<>", 
            "\[IndentingNewLine]", "\"\<\\n\>\"", "<>", 
            "\"\<Please confirm the cell origin.\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WindowTitle", "\[Rule]", "\"\<Cell origin\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"sg", ",", 
           RowBox[{
           "Whitespace", "~~", "\"\<(\>\"", "~~", "__", "~~", "\"\<)\>\""}]}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".3", " ", "Tidy", " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "sg", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"B", ".4", 
           RowBox[{".1", ".", " ", "Remove"}], " ", "any", " ", "_enclosing", 
           "_", " ", "quotation", " ", "marks"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Note", ":", " ", 
           RowBox[{
           "Some", " ", "Hall", " ", "symbols", " ", "contain", " ", "double",
             " ", "quotation", " ", "marks"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "main__", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "EndOfString"}], "\[RuleDelayed]", "main"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".2", " ", "Uppercase", " ", "centring", " ", "1"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"first", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<-\>\"", "~~", "_"}], ",", "_"}], "}"}]}], "~~", 
            "rest__", "~~", "EndOfString"}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToUpperCase", "@", "first"}], "~~", 
            RowBox[{"ToLowerCase", "@", "rest"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".3", ".", " ", "Fix"}], " ", "boxes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<overscriptbox\>\"", "\[Rule]", "\"\<OverscriptBox\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<subscriptbox\>\"", "\[Rule]", "\"\<SubscriptBox\>\""}]}], 
           "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".4", " ", "Uppercase", " ", "centring", " ", "2"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<Box[\\(\>\"", "~~", "c_"}], "\[RuleDelayed]", 
           RowBox[{"\"\<Box[\\(\>\"", "<>", 
            RowBox[{"ToUpperCase", "[", "c", "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", ".5", " ", "Screw", " ", "axes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"a", ":", "DigitCharacter"}], "~~", "\"\<(\>\"", "~~", 
            RowBox[{"b", ":", "DigitCharacter"}], "~~", "\"\<)\>\""}], 
           "\[RuleDelayed]", 
           RowBox[{"a", "<>", "b"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".6", ".", " ", "Miscellaneous"}], " ", "replacements"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\"\<;\>\"", "\[Rule]", "\"\< \>\""}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Check"}], " ", "symbol", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "centring", " ", "symbol"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<P\>\"", ",", "\"\<I\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
            ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", 
            "\"\<H\>\"", ",", "\"\<\\!\>\"", ",", "\"\<-\>\""}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringTake", "[", 
           RowBox[{"sg", ",", "1"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", ".2", " ", "Check", " ", "if", " ", "found", " ", 
       RowBox[{"by", " ", "'"}], 
       RowBox[{"$GroupSymbolRedirect", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "sg", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"temp", ",", "\"\<PointGroupNumber\>\""}], "]"}], ",", 
          RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Exception", ":", " ", 
       RowBox[{"Old", " ", "symbol"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "\"\<Fm3m\>\""}], ",", 
       RowBox[{
        RowBox[{"sg", "=", "\"\<Fm-3m\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "C", ".3", " ", "Delete", " ", "whitespace", " ", "and", " ", "check", 
       " ", "again"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"sg", ",", "Whitespace"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "temp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"A", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "space", " ", "group"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<SG\>\""}], ",", "input"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"abortQ", ",", 
       RowBox[{"Abort", "[", "]"}], ",", 
       RowBox[{"Return", "@", "Null"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"B", ".", " ", "Return"}], " ", "non"}], "-", 
       RowBox[{"ambiguous", " ", "output"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SpaceGroupFound\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "o", "]"}], ",", 
       RowBox[{"sg", "=", 
        RowBox[{"sg", "<>", "\"\<:\>\"", "<>", 
         RowBox[{"ToString", "[", "o", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ToStandardSetting", "[", "sg", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278689235427*^9, 
   3.737278724291026*^9}, {3.7373828319134293`*^9, 3.737382905583477*^9}, {
   3.7380503409830427`*^9, 3.7380503462202253`*^9}, {3.738050409199875*^9, 
   3.738050410020376*^9}, {3.738050587280776*^9, 3.738050594380994*^9}, {
   3.738050633314591*^9, 3.738050741885346*^9}, 3.738050787226899*^9, {
   3.738050820907621*^9, 3.738050913718038*^9}, {3.738050967336628*^9, 
   3.738051039601925*^9}, {3.738051123094633*^9, 3.7380511685169477`*^9}, {
   3.7380512915012083`*^9, 3.73805131582058*^9}, 3.73805147687253*^9, {
   3.738291406092393*^9, 3.738291463424559*^9}, {3.739251235484573*^9, 
   3.739251259594013*^9}, {3.7392664653604727`*^9, 3.739266516678097*^9}, 
   3.7392665477450542`*^9, {3.739267739894909*^9, 3.739267740037506*^9}, 
   3.73950412920148*^9, {3.742016464322269*^9, 3.742016465840391*^9}, {
   3.742022822926903*^9, 3.742022908512398*^9}, {3.742022978221959*^9, 
   3.74202298550244*^9}, {3.743865456276009*^9, 3.7438654563219023`*^9}, {
   3.7438669045354652`*^9, 3.7438669207895317`*^9}, {3.758530035604117*^9, 
   3.758530048874316*^9}, 3.762793093794232*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->822256450,
 $CellContext`ExpressionUUID -> "87669779-bf6f-49c2-a46e-d094bc03bec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointGroupQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Check", " ", "if", " ", "valid", " ", "space", " ", "group", " ", 
     "string"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"$PointGroups", ",", "input", ",", "Infinity"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "\"\<PG\>\""}], ",", "input"}], "]"}], 
      ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.7136042900817747`*^9}, {
   3.713604322627748*^9, 3.713604324160606*^9}, {3.7136043702641973`*^9, 
   3.713604371101212*^9}, {3.71471126435174*^9, 3.71471126555512*^9}, 
   3.717740897041522*^9, 3.72760353803649*^9, {3.7305444772094812`*^9, 
   3.730544481061934*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->606886705,
 $CellContext`ExpressionUUID -> "254eed9a-9445-40db-b24d-472d2350b88b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointSpaceGroupQ\>\""}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "if", " ", "valid", " ", "point"}], "-", " ", 
    RowBox[{"or", " ", "space", " ", "group", " ", "string"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "PSG"}], ",", "input"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, {
   3.713604296226803*^9, 3.713604299721271*^9}, {3.714710977590053*^9, 
   3.714710979768374*^9}, 3.717740920646922*^9, 3.7276035440759487`*^9, 
   3.743865456393198*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1545011332,
 $CellContext`ExpressionUUID -> "ca8d9a53-8b24-4939-b8f1-e2ca3a470796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"type_String", ",", 
    RowBox[{"scatteringAngle_:", "0"}], ",", "\"\<Polarisation\>\""}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"type", "===", "\"\<sigma\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Sigma]\>\""}]}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", "===", "\"\<pi\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Pi]\>\""}]}], ",", 
    RowBox[{"Abs", "@", 
     RowBox[{"Cos", "[", "scatteringAngle", "]"}]}], ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"InputCheck", "::", "\"\<polarisation\>\""}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1780681047,
 $CellContext`ExpressionUUID -> "21c993c3-a67a-4d03-a7b5-7cd460cbf33b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{
   "crystal_String", ",", "wavelength_", ",", "\"\<ProcessWavelength\>\"", 
    ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[Lambda]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"wavelength", "===", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
         "crystal", ",", "\"\<GetCrystalWavelength\>\"", ",", "abortQ"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", "wavelength"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\[Lambda]", ",", "\"\<GetEnergyWavelength\>\"", ",", "False"}],
       "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.730395241910015*^9, 3.730395331782501*^9}, 
   3.73039551088382*^9, {3.7391249707350397`*^9, 3.739124986130555*^9}, {
   3.73912511330057*^9, 3.739125114641823*^9}, {3.739125407092436*^9, 
   3.7391254219192133`*^9}, {3.7391254965873337`*^9, 3.739125499857193*^9}, {
   3.739125656582911*^9, 3.739125666230063*^9}, 3.762793093803693*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->574252337,
 $CellContext`ExpressionUUID -> "a5b11313-8f8e-4d89-bf43-7d46a4865e93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "label"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised check label.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "dim"}], "=", 
   "\"\<Reflections (and coordinates) must be on a {\!\(\*
StyleBox[\"h\", \"TI\"]\), \!\(\*
StyleBox[\"k\", \"TI\"]\), \!\(\*
StyleBox[\"l\", \"TI\"]\)} (or {\!\(\*
StyleBox[\"x\", \"TI\"]\), \!\(\*
StyleBox[\"y\", \"TI\"]\), \!\(\*
StyleBox[\"z\", \"TI\"]\)}) form\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "one"}], "=", 
   "\"\<Only one `1` expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "head"}], "=", 
   "\"\<Head of indices must be either Integer, String or Symbol.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "few"}], "=", 
   "\"\<At least two reflections are required to make comparisons.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyunit"}], "=", 
   "\"\<Input does not have a unit compatible with energy or \
wavelength.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyinput"}], "=", 
   "\"\<Input must be an energy or wavelength compatible Quantity, or a \
number.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "poslambda"}], "=", 
    "\"\<The wavelength/energy must be positive.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystal"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "wavelength"}], "=", 
   "\"\<No wavelength was found for crystal \[LeftGuillemet]`1`\
\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "userinput"}], "=", 
   "\"\<Invalid user input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "polarisation"}], "=", 
    "\"\<Invalid polarisation setting.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PSG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point- \
or space group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a space \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SGnumber"}], "=", 
   "\"\<Valid space group numbers are between 1 and 230.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystalSG"}], "=", 
   "\"\<Crystal entry \[LeftGuillemet]`1`\[RightGuillemet] has invalid space \
group \[LeftGuillemet]`2`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "PSGC"}], "=", 
    "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group, space group or a crystal.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "centringerror"}], "=", 
   "\"\<Invalid space group centring.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementNumber"}], "=", 
   "\"\<Element number `1` is out of range.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementFailed"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a \
chemical element.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "ElementError"}], "=", 
    "\"\<The element \[LeftGuillemet]`1`\[RightGuillemet] cannot be \
interpreted.\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "InputCheck"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "__", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.6856820263060083`*^9, 3.6856820338793163`*^9}, {
   3.685682083417005*^9, 3.685682092894709*^9}, {3.6856840260308533`*^9, 
   3.685684026178547*^9}, {3.685686819102976*^9, 3.6856868408053513`*^9}, {
   3.685687011142066*^9, 3.685687017829006*^9}, {3.685687131249773*^9, 
   3.685687151398356*^9}, {3.685687183159276*^9, 3.6856871838215933`*^9}, {
   3.685687254295497*^9, 3.685687281286789*^9}, {3.685687660039452*^9, 
   3.6856877115995817`*^9}, {3.68568838863011*^9, 3.6856884381337767`*^9}, {
   3.685690949932845*^9, 3.6856909574232817`*^9}, {3.685691048596792*^9, 
   3.685691065258542*^9}, {3.685691555385049*^9, 3.685691595897393*^9}, {
   3.685693407917099*^9, 3.6856934105491962`*^9}, {3.685693449539488*^9, 
   3.685693464972211*^9}, {3.685693732995039*^9, 3.6856937393916893`*^9}, {
   3.685693867613049*^9, 3.685693870503192*^9}, {3.685694016861869*^9, 
   3.685694053583612*^9}, {3.685694415120605*^9, 3.685694415410471*^9}, {
   3.6856953860999413`*^9, 3.685695404607368*^9}, {3.68569555947088*^9, 
   3.685695605133265*^9}, {3.685696124318612*^9, 3.68569613828201*^9}, {
   3.685696178849712*^9, 3.685696180401723*^9}, {3.685696592780033*^9, 
   3.6856965970349083`*^9}, {3.6870711449669037`*^9, 3.687071165830688*^9}, {
   3.6870725649937353`*^9, 3.687072567422408*^9}, {3.711081329746539*^9, 
   3.711081335862384*^9}, {3.711083709642126*^9, 3.71108372803414*^9}, {
   3.712990896317184*^9, 3.712990899230811*^9}, {3.713603056038671*^9, 
   3.7136030717991047`*^9}, 3.713603337329356*^9, {3.7136034598308163`*^9, 
   3.713603470204297*^9}, {3.713604348937676*^9, 3.71360436129599*^9}, {
   3.717147714818186*^9, 3.717147739983534*^9}, {3.7171480835458517`*^9, 
   3.717148091231995*^9}, {3.726560324583314*^9, 3.7265603577752657`*^9}, {
   3.726853588279467*^9, 3.7268536391946774`*^9}, {3.7271789201847763`*^9, 
   3.727178947159677*^9}, {3.7275066313384666`*^9, 3.72750665317505*^9}, {
   3.727513894430643*^9, 3.727513902461985*^9}, {3.727596618528956*^9, 
   3.727596645209611*^9}, {3.727601483861143*^9, 3.7276014841869497`*^9}, {
   3.7276028953923073`*^9, 3.727602914012473*^9}, {3.728109699712471*^9, 
   3.728109743760724*^9}, {3.728765837392223*^9, 3.728765846807078*^9}, {
   3.7340775949863367`*^9, 3.734077598710491*^9}, {3.7372791075805187`*^9, 
   3.73727914741197*^9}, {3.7372792368998547`*^9, 3.737279256825714*^9}, {
   3.737285569781273*^9, 3.737285603410686*^9}, {3.739187854951786*^9, 
   3.73918785517507*^9}, {3.742016334042914*^9, 3.742016337494812*^9}, {
   3.742016368507223*^9, 3.74201638931714*^9}, {3.7567126007785892`*^9, 
   3.756712616867313*^9}, 3.75671264844755*^9, {3.756712756093667*^9, 
   3.756712764043981*^9}, {3.75671279769972*^9, 3.756712815035034*^9}, {
   3.756713298279908*^9, 3.7567132995556707`*^9}},
 CellID->66610056,
 $CellContext`ExpressionUUID -> "f6062f54-1222-4d57-ae33-6e13722a2bcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", "\[IndentingNewLine]", 
   RowBox[{"input_List", ",", "\[IndentingNewLine]", 
    RowBox[{"labels___", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", ",", 
           "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
           "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], ",", 
         RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"check", ",", "hkl", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"check", "=", 
      RowBox[{"{", "labels", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
         "check", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", 
               ",", "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
               "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], 
             ",", "temp"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"InputCheck", "::", "label"}], ",", "temp"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dimensions", " ", "check", " ", 
       RowBox[{"(", 
        RowBox[{"always", " ", "required"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Single", " ", 
        RowBox[{"reflection", "/", "coordinate"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"input", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
            "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"hkl", "=", 
        RowBox[{"{", "input", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Multiple", " ", 
         RowBox[{"reflections", "/", "coordinates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
             RowBox[{"!", 
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
               "]"}]}]}]}], "]"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{"hkl", "=", "input"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "dim"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", 
       RowBox[{"reflection", "/", "coordinates"}], " ", "check"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1hkl\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<reflection\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1xyz\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<coordinate\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Multiple", " ", "reflections", " ", "check"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Multiple\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "<", "2"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "few"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Integer", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Integer\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "hkl"}], ",", "IntegerQ"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "integer"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "if", " ", "Integer"}], ",", " ", 
       RowBox[{"String", " ", "or", " ", "Symbol"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<StringSymbol\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ContainsAll", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Integer", ",", "String", ",", "Symbol", ",", "Times"}], 
             "}"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Head", "/@", 
             RowBox[{"Flatten", "@", "hkl"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "head"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wrap", " ", "single", " ", "reflections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<WrapSingle\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "input", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Return", "[", "input", "]"}]}], "\[IndentingNewLine]", "\t",
         "]"}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.687070782983131*^9, 3.687070826316058*^9}, {
   3.711080493388452*^9, 3.711080530269607*^9}, {3.7110838434149733`*^9, 
   3.711083844960722*^9}, {3.712990600076755*^9, 3.712990608318782*^9}, {
   3.712990804480831*^9, 3.7129908060016212`*^9}, {3.712990947248521*^9, 
   3.712990947808515*^9}, {3.713510243799721*^9, 3.7135102514986553`*^9}, {
   3.713510288538774*^9, 3.713510293259116*^9}, {3.7135103372502947`*^9, 
   3.713510338184915*^9}, {3.71431192571665*^9, 3.7143119392365303`*^9}, {
   3.7143120972494097`*^9, 3.714312097447524*^9}, {3.7143121915742683`*^9, 
   3.7143122110300217`*^9}, {3.714312273573138*^9, 3.714312308114839*^9}, {
   3.71445784032449*^9, 3.714457847602706*^9}, 3.714458049967931*^9, {
   3.7147109057397537`*^9, 3.714710909787726*^9}, {3.714710945019298*^9, 
   3.714710963965468*^9}, {3.717143871479184*^9, 3.717143873754469*^9}, {
   3.717146708601173*^9, 3.717146713501816*^9}, {3.717147467353772*^9, 
   3.717147472518999*^9}, {3.717147554646175*^9, 3.717147555923188*^9}, {
   3.717147595628448*^9, 3.717147596128397*^9}, 3.7171476872925243`*^9, {
   3.717147790297018*^9, 3.7171478112554407`*^9}, {3.7171480444680862`*^9, 
   3.717148048818454*^9}, {3.7171482182403383`*^9, 3.7171482183828487`*^9}, {
   3.717148818843635*^9, 3.717148834361803*^9}, {3.7171489319542913`*^9, 
   3.717148951600135*^9}, {3.717149178012879*^9, 3.71714919115486*^9}, {
   3.717149260050128*^9, 3.717149280072538*^9}, {3.717149333315688*^9, 
   3.717149397350493*^9}, {3.717149552908246*^9, 3.7171495813302383`*^9}, {
   3.718521630559267*^9, 3.718521641789692*^9}, {3.7185216726962433`*^9, 
   3.7185216733580647`*^9}, {3.718636471385057*^9, 3.7186364749898767`*^9}, {
   3.7186366347963343`*^9, 3.718636636271434*^9}, {3.7259581138852463`*^9, 
   3.725958115603722*^9}, {3.7372783098194*^9, 3.737278316869255*^9}, 
   3.737371806626379*^9, 3.737384013131838*^9, {3.7373840435457*^9, 
   3.7373840851194687`*^9}, {3.737384137351205*^9, 3.73738418240597*^9}, {
   3.7373842155798798`*^9, 3.737384232171645*^9}, {3.737384415256804*^9, 
   3.737384433510865*^9}, {3.75852996982882*^9, 3.758529971762226*^9}, 
   3.7627930936957808`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->676231105,
 $CellContext`ExpressionUUID -> "582dd116-7bbf-4577-b0db-a95e7cf4dbe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<CrystalQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "entry", " ", "exists", " ", 
     RowBox[{"in", " ", "'"}], 
     RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MissingQ", "@", 
      RowBox[{"$CrystalData", "[", "input", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "crystal"}], ",", "input"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.7276035463522577`*^9, 
   3.72760354706783*^9}, {3.74556825639723*^9, 3.7455682923534517`*^9}, {
   3.745568690840042*^9, 3.745568699006835*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->932721811,
 $CellContext`ExpressionUUID -> "2573f9e8-2af9-42ca-94dd-d3fbf8c90797"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"centring_String", ",", "\"\<GetCentringVectors\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "vectors", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"centring", "===", "\"\<P\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<F\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<I\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<R\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<A\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<B\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "0", ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<C\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<H\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "centringerror"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"vectors", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}, {
   3.734077376632456*^9, 3.734077480964463*^9}, {3.734412586131454*^9, 
   3.7344125991220827`*^9}, 3.762793093706504*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1772338024,
 $CellContext`ExpressionUUID -> "dbcf2741-11e4-4698-a8af-daf49f068290"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalFormulaUnits\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
       "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
         "\"\<FormulaUnits\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"input", ",", "\"\<FormulaUnits\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "not"}], ",", " ", 
         RowBox[{"query", " ", "user", " ", "manually"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"InputString", "[", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Cannot determine the number of formula units \>\"", "<>", 
           "\[IndentingNewLine]", "\"\<for \[LeftGuillemet]\>\"", "<>", 
           "input", "<>", "\"\<\[RightGuillemet].\>\"", "<>", "\"\<\\n\>\"", "<>",
            "\[IndentingNewLine]", 
           "\"\<Please enter that number or the density below.\>\""}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "output"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "userinput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "output"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.727178717966507*^9, 
   3.727178721188702*^9}, {3.727178758964155*^9, 3.727178761323883*^9}, {
   3.727178860595625*^9, 3.727178901192408*^9}, {3.727178964913246*^9, 
   3.727178966567266*^9}, {3.727601687423465*^9, 3.727601704808043*^9}, {
   3.727601744534422*^9, 3.727601771061698*^9}, {3.727602475651042*^9, 
   3.727602607286476*^9}, {3.7276026482929697`*^9, 3.727602649418606*^9}, {
   3.727602816432906*^9, 3.727602879307555*^9}, {3.7276029234914637`*^9, 
   3.727602926124346*^9}, {3.727603730383863*^9, 3.72760373066368*^9}, {
   3.727603973849247*^9, 3.7276039750255003`*^9}, {3.738049785054161*^9, 
   3.7380497898471613`*^9}, 3.762793093715082*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->2086985478,
 $CellContext`ExpressionUUID -> "9ccfd331-de3b-4fca-9f9d-02e8c569c92d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalSpaceGroup\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "is", " ", "valid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.727506566988821*^9, 
   3.7275065675308313`*^9}, {3.7276035560711937`*^9, 3.72760355630114*^9}, {
   3.7276036304674597`*^9, 3.727603631524433*^9}, 3.727676784104806*^9, {
   3.7340864321506767`*^9, 3.7340865206369267`*^9}, 3.743865456049979*^9, 
   3.762793093722595*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1114522295,
 $CellContext`ExpressionUUID -> "bf221871-bd0a-4a76-8548-8cb2f84c0102"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalWavelength\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InputCheck", "[", 
     RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
      "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
        "\"\<Wavelength\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "@", 
       RowBox[{"$CrystalData", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"input", ",", "\"\<Wavelength\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", " ", "not"}], ",", " ", 
        RowBox[{
         RowBox[{"abort", " ", "OR", " ", 
          RowBox[{"return", " ", "'"}]}], "-", 
         RowBox[{"1", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"abortQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InputCheck", "::", "wavelength"}], ",", "input"}], "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}],
    ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.739125707135515*^9, 3.7391257657796993`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1423842931,
 $CellContext`ExpressionUUID -> "4076f94c-029e-4e4f-be5f-3bb8a6a0ae57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Converts", " ", "to", " ", 
    RowBox[{"wavelength", " ", "[", "\[ARing]ngstr\[ODoubleDot]ms", "]"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"InputCheck", "[", 
    RowBox[{"input_", ",", "\"\<GetEnergyWavelength\>\"", ",", 
     RowBox[{"unitsQ_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hcKeV", "=", "12.398420"}], ",", "\[Lambda]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Only", " ", "exception"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"input", "===", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "if", " ", "positive"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"Positive", "@", "input"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "poslambda"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"A", ".", " ", "Number"}], " ", "input"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NumericQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"1.", " ", "Assume", " ", "\[ARing]ngstr\[ODoubleDot]ms"}], 
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"input", " ", "\[LessEqual]", " ", "5.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"N", "@", "input"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"2.", " ", "Assume", " ", "kilo", " ", "electronvolt"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"input", " ", "\[LessEqual]", " ", "250.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", "input"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"3.", " ", "Assume", " ", "electronvolts"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"1000", "*", 
            RowBox[{"hcKeV", "/", "input"}]}]}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Quantity"}], " ", "input"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"QuantityQ", "[", "input", "]"}], " ", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Convert", " ", "wavelength", " ", "or", " ", "energy", " ", "to", 
          " ", "\[ARing]ngstr\[ODoubleDot]ms"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"UnitDimensions", "[", "input", "]"}], "===", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\"\<LengthUnit\>\"", ",", "1"}], "}"}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"\[Lambda]", "=", 
            RowBox[{"UnitConvert", "[", 
             RowBox[{"input", ",", "\"\<Angstroms\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"unitsQ", ",", 
             RowBox[{"Return", "@", "\[Lambda]"}], ",", 
             RowBox[{"Return", "@", 
              RowBox[{"QuantityMagnitude", "@", "\[Lambda]"}]}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"CompatibleUnitQ", "[", 
           RowBox[{"input", ",", "\"\<Joules\>\""}], "]"}], ",", "\t\t", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", 
            RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"UnitConvert", "[", 
              RowBox[{"input", ",", "\"\<Kiloelectronvols\>\""}], "]"}]}]}]}],
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"InputCheck", "::", "energyunit"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"C", ".", " ", "None"}], " ", "of", " ", "the", " ", 
          "above"}], " ", "*)"}], "\[IndentingNewLine]", "True", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "energyinput"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Set", " ", "in", " ", "Quantity", " ", "if", " ", "desired"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"unitsQ", ",", "\[IndentingNewLine]", 
        RowBox[{"Quantity", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Angstroms\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\[Lambda]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.726560443424157*^9, 
   3.726560447064084*^9}, 3.72685205362494*^9, {3.7268524061436033`*^9, 
   3.7268525118996563`*^9}, {3.726853451219391*^9, 3.726853553519404*^9}, {
   3.72685364594137*^9, 3.726853659220982*^9}, {3.726853721494712*^9, 
   3.7268537360194597`*^9}, {3.726853814139167*^9, 3.726853866046702*^9}, {
   3.72685391283145*^9, 3.726854013342908*^9}, {3.72685443464507*^9, 
   3.726854444243165*^9}, {3.726854740941407*^9, 3.726854744623098*^9}, {
   3.726854833074029*^9, 3.726854873935768*^9}, {3.72685491084039*^9, 
   3.726854918136497*^9}, {3.72685498979923*^9, 3.726855068318531*^9}, {
   3.726855109331604*^9, 3.726855122067479*^9}, {3.7268555301237164`*^9, 
   3.726855539752921*^9}, {3.7268559339858027`*^9, 3.726855959866241*^9}, {
   3.7268559904322023`*^9, 3.72685603510135*^9}, {3.72685615357065*^9, 
   3.72685615402689*^9}, {3.726856216650893*^9, 3.726856369277254*^9}, {
   3.7268564800835943`*^9, 3.7268564992580137`*^9}, {3.726856620967496*^9, 
   3.726856621815027*^9}, {3.726856668775392*^9, 3.726856720204636*^9}, {
   3.7268568209881*^9, 3.72685684971353*^9}, {3.72685688102668*^9, 
   3.7268569498483753`*^9}, {3.7268570554316273`*^9, 3.726857141124441*^9}, {
   3.72685733536134*^9, 3.726857445821105*^9}, {3.7268574798936377`*^9, 
   3.726857484116231*^9}, {3.726857520876247*^9, 3.726857597705496*^9}, {
   3.7268576490821247`*^9, 3.726857665286269*^9}, {3.726896856919681*^9, 
   3.726896865360489*^9}, {3.726897043655274*^9, 3.72689706577814*^9}, {
   3.726899351343816*^9, 3.726899381328332*^9}, 3.7268997978240433`*^9, {
   3.7275466850188923`*^9, 3.727546685984756*^9}, {3.727596442016464*^9, 
   3.727596443184536*^9}, {3.7275965437672157`*^9, 3.727596576954631*^9}, 
   3.727596651111322*^9, {3.72760374260155*^9, 3.727603759529471*^9}, {
   3.728109774970121*^9, 3.728109880586781*^9}, 3.73441267980902*^9, {
   3.738049815649427*^9, 3.738049826421247*^9}, {3.7391251770910673`*^9, 
   3.739125211688257*^9}, {3.7391256829934187`*^9, 3.739125689976153*^9}, 
   3.762793093738366*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1117862796,
 $CellContext`ExpressionUUID -> "46300c07-37a8-4c26-9c3c-bfd429ab81d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], "]"}], ":=", 
  
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"$CrystalDataCombined", ",", "sg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "space", " ", "group", " ", "number", " ", "is",
       " ", "given"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "input", "\[LessEqual]", "230"}], ")"}],
         "&&", 
        RowBox[{"IntegerQ", "@", "input"}]}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
         RowBox[{"input", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
         "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "If", " ", "actual", " ", "input", " ", "is", " ", "a", " ", 
         "point"}], "-", " ", 
        RowBox[{"or", " ", "space", " ", "group"}]}], ",", " ", 
       RowBox[{"return", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}], ",", 
       RowBox[{"Return", "@", "input"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "MaXrd`Private`$TempCrystalData"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"$CrystalData", ",", "MaXrd`Private`$TempCrystalData"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", "$CrystalData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "@", 
        RowBox[{"$CrystalDataCombined", "[", "input", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "PSGC"}], ",", "input"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "exists"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalDataCombined", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.72750620550637*^9, 
   3.727506277082754*^9}, 3.7275065790218277`*^9, 3.72750668943563*^9, {
   3.7275138768842697`*^9, 3.727513877580575*^9}, {3.7276037003393583`*^9, 
   3.7276037005968237`*^9}, {3.727603930848737*^9, 3.727603935750414*^9}, {
   3.734086562493793*^9, 3.734086592174155*^9}, {3.734087081953874*^9, 
   3.734087111656989*^9}, {3.743865456115304*^9, 3.743865456153502*^9}, {
   3.758529973221416*^9, 3.7585299759035673`*^9}, {3.7614238939583063`*^9, 
   3.7614239274759207`*^9}, {3.76142400648403*^9, 3.7614240067298727`*^9}, {
   3.7614240390817547`*^9, 3.7614241404093447`*^9}, {3.7614242479891987`*^9, 
   3.7614242705338163`*^9}, {3.761424370948794*^9, 3.761424372186491*^9}, 
   3.762793093748088*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1733068416,
 $CellContext`ExpressionUUID -> "40d1c1ed-62fb-4df8-907d-7b157fdb296f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretElement\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"elementsIn", "=", "input"}], ",", "pertiodicTable", ",", 
      "elementsRead", ",", "elementsReadNeutral", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{"elementsIn", ",", "NumberString"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"elementsIn", "=", 
          RowBox[{"ToExpression", "@", "elementsIn"}]}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{"in", " ", "the", " ", "periodic", " ", "table"}], ")"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "elementsIn", "\[LessEqual]", 
            RowBox[{"Length", "@", "$PeriodicTable"}]}], ")"}], "&&", 
          RowBox[{"IntegerQ", "@", "elementsIn"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Keys", "@", "$PeriodicTable"}], ")"}], 
           "\[LeftDoubleBracket]", "elementsIn", "\[RightDoubleBracket]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "ElementNumber"}], ",", 
            RowBox[{"ToString", "@", "elementsIn"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "single", " ", "string", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Wrap"}], " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", 
       RowBox[{"elementsIn", "=", 
        RowBox[{"{", "elementsIn", "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Process"}], " ", "list", " ", "of", " ", 
       "strings", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "input", " ", "is", 
       " ", "a", " ", "list", " ", "of", " ", "strings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "elementsIn"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"elementsIn", ",", "StringQ"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".2", ".", " ", "Set"}], " ", "of", " ", "valid", " ", 
       "symbols", " ", "from", " ", "the", " ", "periodic", " ", "table"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pertiodicTable", "=", 
      RowBox[{"Keys", "@", "$PeriodicTable"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"C", 
        RowBox[{".3", ".", " ", "Find"}], " ", 
        RowBox[{"(", "possible", ")"}], " ", "matches"}], ",", " ", 
       RowBox[{"and", " ", "establish", " ", "order"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"elementsIn", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StartOfString", "~~", 
          RowBox[{"a", ":", "LetterCharacter"}], "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{"b", ":", "LetterCharacter"}]}], "}"}], "~~", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{
             RowBox[{"n1", ":", 
              RowBox[{"DigitCharacter", "..."}]}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n2", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"ToUpperCase", "[", "a", "]"}], "<>", 
          RowBox[{"ToLowerCase", "[", "b", "]"}], "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n1", "===", "\"\<\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"n2", "===", "\"\<\>\""}], ")"}]}], ",", "\"\<1\>\"", 
            ",", "\"\<\>\""}], "]"}], "<>", "n1", "<>", "n2", "<>", 
          "pm"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "for", " ", "non"}], "-", "elements"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"elementsRead", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsRead", ",", 
               RowBox[{"{", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Separate", " ", "element", " ", "symbol", " ", "and", " ", "charge", 
       " ", 
       RowBox[{"(", 
        RowBox[{"if", " ", "any"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "elementsRead"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"a", ":", 
             RowBox[{"LetterCharacter", ".."}]}], "~~", "b___"}], 
           "\[IndentingNewLine]", "\t", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"b", "===", "\"\<\>\""}], ",", "\"\<&\>\"", ",", "b"}],
               "]"}]}], "}"}]}]}], "]"}], ",", "1"}], "]"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"'", "&"}], "'"}], " ", "should", " ", "be", " ", "deleted", 
       " ", "later"}], " ", "*)"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".4", ".", " ", "Remove"}], " ", "second", " ", "character", 
       " ", "if", " ", "not", " ", "applicable"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{
        RowBox[{"s_String", "/;", "\[IndentingNewLine]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"pertiodicTable", ",", "s"}], "]"}]}]}], "\[RuleDelayed]", 
        
        RowBox[{"StringTake", "[", 
         RowBox[{"s", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", "deuterium"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".5", ".", " ", "Final"}], " ", "validity", " ", "check"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elementsReadNeutral", ",", "pertiodicTable"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsReadNeutral", ",", "\[IndentingNewLine]", 
               RowBox[{"First", "@", "temp"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".6", ".", " ", "Concatenate"}], " ", "elements", " ", "and", 
       " ", "charge"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      "elementsReadNeutral"}], ";", "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"elementsRead", "/.", 
       RowBox[{"\"\<1\>\"", "\[Rule]", "\"\<\>\""}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"StringJoin", "/@", "elementsRead"}], ",", "\"\<&\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "chemical", " ", "element"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<ElementFailed\>\""}], ",", 
       RowBox[{"ToString", "@", "input"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"b", ".", " ", "Return"}], " ", "string", " ", 
       RowBox[{"(", 
        RowBox[{"or", " ", "list", " ", "of", " ", "strings"}], ")"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "elementsRead", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        ",", "elementsRead"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278567175089*^9, 
   3.737278609150566*^9}, {3.737278661861796*^9, 3.7372787061104527`*^9}, {
   3.737278786430764*^9, 3.737278815614232*^9}, {3.737278876614931*^9, 
   3.737278894575992*^9}, {3.737279063214642*^9, 3.737279117617867*^9}, {
   3.737279153995288*^9, 3.737279156957521*^9}, {3.737279209224059*^9, 
   3.7372792281945353`*^9}, {3.737279265333662*^9, 3.7372792662517557`*^9}, {
   3.737279499593874*^9, 3.7372795003597097`*^9}, {3.7372795311927958`*^9, 
   3.737279607430427*^9}, {3.737279901036427*^9, 3.737279905187501*^9}, {
   3.73728056780586*^9, 3.737280595834815*^9}, {3.737280731938634*^9, 
   3.7372807824368553`*^9}, {3.737280821275927*^9, 3.737280850048135*^9}, {
   3.7372808982833033`*^9, 3.7372809507817802`*^9}, {3.737281047830305*^9, 
   3.737281064716365*^9}, {3.7372811554403543`*^9, 3.73728118861235*^9}, {
   3.7372812569776163`*^9, 3.737281316071546*^9}, {3.737281653054924*^9, 
   3.737281698062044*^9}, {3.737284237057*^9, 3.737284327083954*^9}, {
   3.7372843590048733`*^9, 3.737284369739956*^9}, {3.7372844386235523`*^9, 
   3.737284484892178*^9}, {3.7372850819056*^9, 3.737285090806818*^9}, {
   3.73728520111075*^9, 3.737285222748335*^9}, {3.737285270111203*^9, 
   3.73728530587646*^9}, {3.737285533840251*^9, 3.737285559292869*^9}, {
   3.7372856101403227`*^9, 3.737285657390164*^9}, {3.737285700136235*^9, 
   3.737285798718968*^9}, {3.7372858357113028`*^9, 3.737285868194257*^9}, {
   3.737285908459991*^9, 3.737286014905347*^9}, 3.737286052837697*^9, {
   3.7372861540618677`*^9, 3.737286154519107*^9}, {3.737286254980082*^9, 
   3.7372863413456507`*^9}, {3.737286380256139*^9, 3.7372864143825283`*^9}, {
   3.737286458977261*^9, 3.737286576079788*^9}, {3.737286623935347*^9, 
   3.737286632869177*^9}, {3.7372866648183327`*^9, 3.737286723584116*^9}, {
   3.737374746359795*^9, 3.737374832079135*^9}, {3.73737499904206*^9, 
   3.737375023959383*^9}, {3.737378138033321*^9, 3.737378164259573*^9}, {
   3.737378225363977*^9, 3.73737825691322*^9}, 3.7373784605339413`*^9, {
   3.737378502252293*^9, 3.73737864023484*^9}, {3.737378704823086*^9, 
   3.737378712047621*^9}, {3.737378750431796*^9, 3.737378752703669*^9}, {
   3.737378898239748*^9, 3.737378990411519*^9}, {3.73737903566635*^9, 
   3.7373791239583397`*^9}, {3.737379162032648*^9, 3.737379164836317*^9}, {
   3.7373792649735928`*^9, 3.7373793244342623`*^9}, {3.737379375913303*^9, 
   3.73737941501803*^9}, {3.737379491076782*^9, 3.737379495461954*^9}, {
   3.737379605763606*^9, 3.7373796928169928`*^9}, {3.73737986755727*^9, 
   3.7373800849030933`*^9}, {3.7373801268150043`*^9, 
   3.7373801843010073`*^9}, {3.737380294292263*^9, 3.737380294698414*^9}, {
   3.737380414361321*^9, 3.737380698358766*^9}, {3.7373807418017273`*^9, 
   3.73738075376825*^9}, {3.7373807854482927`*^9, 3.737380862411724*^9}, {
   3.737381036834449*^9, 3.737381064693281*^9}, {3.737381100937663*^9, 
   3.7373811217752542`*^9}, 3.737381158470895*^9, 3.737381221032393*^9, {
   3.737381678459423*^9, 3.737381805116645*^9}, {3.737381836958056*^9, 
   3.737381881326532*^9}, {3.737381917168672*^9, 3.7373819592222023`*^9}, {
   3.737382007542437*^9, 3.737382116848222*^9}, {3.7373821591203203`*^9, 
   3.737382355002592*^9}, {3.7379744155182457`*^9, 3.737974415670136*^9}, {
   3.7379754153411427`*^9, 3.737975452667324*^9}, {3.73797549962778*^9, 
   3.7379755241789637`*^9}, 3.737975563770276*^9, {3.737975648095365*^9, 
   3.7379756613659477`*^9}, {3.73921005915567*^9, 3.739210067088846*^9}, {
   3.7392103437571*^9, 3.739210372090125*^9}, {3.7392104083569927`*^9, 
   3.739210408785853*^9}, {3.739210561112054*^9, 3.739210658951914*^9}, {
   3.742878249248098*^9, 3.7428782535467987`*^9}, {3.7428782893930473`*^9, 
   3.742878353943668*^9}, {3.742878774060712*^9, 3.7428787793596373`*^9}, {
   3.742878811736623*^9, 3.742878976915493*^9}, {3.7428790184091597`*^9, 
   3.7428790837272663`*^9}, {3.742879158784565*^9, 3.7428791803486032`*^9}, {
   3.742879211104168*^9, 3.742879211738106*^9}, {3.7585299775360603`*^9, 
   3.75853003338778*^9}, 3.7627930937690287`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1360163451,
 $CellContext`ExpressionUUID -> "980d813f-5ce6-44d1-8dac-360bec13d687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretSpaceGroup\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sg", "=", "input"}], ",", "o", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{
           RowBox[{"StringTrim", "@", "sg"}], ",", "NumberString"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"sg", "=", 
          RowBox[{"ToExpression", "@", "sg"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{
        "a", " ", "canonical", " ", "space", " ", "group", " ", "number"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "sg", "\[LessEqual]", "230"}], ")"}], 
          "&&", 
          RowBox[{"IntegerQ", "@", "sg"}]}], ",", 
         RowBox[{"Return", "@", 
          RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
           RowBox[{"sg", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "SGnumber"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"abortQ", ",", 
            RowBox[{"Abort", "[", "]"}], ",", 
            RowBox[{"Return", "@", "Null"}]}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "string", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "string"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringQ", "@", "sg"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".2", " ", "Process", " ", "any", " ", "annotations"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"sg", ",", "\"\<origin\>\"", ",", 
         RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"o", "=", 
         RowBox[{"ChoiceDialog", "[", 
          RowBox[{
           RowBox[{
           "\"\<Information on cell origin detected.\>\"", "<>", 
            "\[IndentingNewLine]", "\"\<\\n\>\"", "<>", 
            "\"\<Please confirm the cell origin.\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WindowTitle", "\[Rule]", "\"\<Cell origin\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"sg", ",", 
           RowBox[{
           "Whitespace", "~~", "\"\<(\>\"", "~~", "__", "~~", "\"\<)\>\""}]}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".3", " ", "Tidy", " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "sg", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"B", ".4", 
           RowBox[{".1", ".", " ", "Remove"}], " ", "any", " ", "_enclosing", 
           "_", " ", "quotation", " ", "marks"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Note", ":", " ", 
           RowBox[{
           "Some", " ", "Hall", " ", "symbols", " ", "contain", " ", "double",
             " ", "quotation", " ", "marks"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "main__", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "EndOfString"}], "\[RuleDelayed]", "main"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".2", " ", "Uppercase", " ", "centring", " ", "1"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"first", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<-\>\"", "~~", "_"}], ",", "_"}], "}"}]}], "~~", 
            "rest__", "~~", "EndOfString"}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToUpperCase", "@", "first"}], "~~", 
            RowBox[{"ToLowerCase", "@", "rest"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".3", ".", " ", "Fix"}], " ", "boxes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<overscriptbox\>\"", "\[Rule]", "\"\<OverscriptBox\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<subscriptbox\>\"", "\[Rule]", "\"\<SubscriptBox\>\""}]}], 
           "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".4", " ", "Uppercase", " ", "centring", " ", "2"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<Box[\\(\>\"", "~~", "c_"}], "\[RuleDelayed]", 
           RowBox[{"\"\<Box[\\(\>\"", "<>", 
            RowBox[{"ToUpperCase", "[", "c", "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", ".5", " ", "Screw", " ", "axes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"a", ":", "DigitCharacter"}], "~~", "\"\<(\>\"", "~~", 
            RowBox[{"b", ":", "DigitCharacter"}], "~~", "\"\<)\>\""}], 
           "\[RuleDelayed]", 
           RowBox[{"a", "<>", "b"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".6", ".", " ", "Miscellaneous"}], " ", "replacements"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\"\<;\>\"", "\[Rule]", "\"\< \>\""}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Check"}], " ", "symbol", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "centring", " ", "symbol"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<P\>\"", ",", "\"\<I\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
            ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", 
            "\"\<H\>\"", ",", "\"\<\\!\>\"", ",", "\"\<-\>\""}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringTake", "[", 
           RowBox[{"sg", ",", "1"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", ".2", " ", "Check", " ", "if", " ", "found", " ", 
       RowBox[{"by", " ", "'"}], 
       RowBox[{"$GroupSymbolRedirect", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "sg", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"temp", ",", "\"\<PointGroupNumber\>\""}], "]"}], ",", 
          RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Exception", ":", " ", 
       RowBox[{"Old", " ", "symbol"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "\"\<Fm3m\>\""}], ",", 
       RowBox[{
        RowBox[{"sg", "=", "\"\<Fm-3m\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "C", ".3", " ", "Delete", " ", "whitespace", " ", "and", " ", "check", 
       " ", "again"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"sg", ",", "Whitespace"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "temp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"A", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "space", " ", "group"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<SG\>\""}], ",", "input"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"abortQ", ",", 
       RowBox[{"Abort", "[", "]"}], ",", 
       RowBox[{"Return", "@", "Null"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"B", ".", " ", "Return"}], " ", "non"}], "-", 
       RowBox[{"ambiguous", " ", "output"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SpaceGroupFound\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "o", "]"}], ",", 
       RowBox[{"sg", "=", 
        RowBox[{"sg", "<>", "\"\<:\>\"", "<>", 
         RowBox[{"ToString", "[", "o", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ToStandardSetting", "[", "sg", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278689235427*^9, 
   3.737278724291026*^9}, {3.7373828319134293`*^9, 3.737382905583477*^9}, {
   3.7380503409830427`*^9, 3.7380503462202253`*^9}, {3.738050409199875*^9, 
   3.738050410020376*^9}, {3.738050587280776*^9, 3.738050594380994*^9}, {
   3.738050633314591*^9, 3.738050741885346*^9}, 3.738050787226899*^9, {
   3.738050820907621*^9, 3.738050913718038*^9}, {3.738050967336628*^9, 
   3.738051039601925*^9}, {3.738051123094633*^9, 3.7380511685169477`*^9}, {
   3.7380512915012083`*^9, 3.73805131582058*^9}, 3.73805147687253*^9, {
   3.738291406092393*^9, 3.738291463424559*^9}, {3.739251235484573*^9, 
   3.739251259594013*^9}, {3.7392664653604727`*^9, 3.739266516678097*^9}, 
   3.7392665477450542`*^9, {3.739267739894909*^9, 3.739267740037506*^9}, 
   3.73950412920148*^9, {3.742016464322269*^9, 3.742016465840391*^9}, {
   3.742022822926903*^9, 3.742022908512398*^9}, {3.742022978221959*^9, 
   3.74202298550244*^9}, {3.743865456276009*^9, 3.7438654563219023`*^9}, {
   3.7438669045354652`*^9, 3.7438669207895317`*^9}, {3.758530035604117*^9, 
   3.758530048874316*^9}, 3.762793093794232*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->303698642,
 $CellContext`ExpressionUUID -> "87669779-bf6f-49c2-a46e-d094bc03bec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointGroupQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Check", " ", "if", " ", "valid", " ", "space", " ", "group", " ", 
     "string"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"$PointGroups", ",", "input", ",", "Infinity"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "\"\<PG\>\""}], ",", "input"}], "]"}], 
      ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ")"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.7136042900817747`*^9}, {
   3.713604322627748*^9, 3.713604324160606*^9}, {3.7136043702641973`*^9, 
   3.713604371101212*^9}, {3.71471126435174*^9, 3.71471126555512*^9}, 
   3.717740897041522*^9, 3.72760353803649*^9, {3.7305444772094812`*^9, 
   3.730544481061934*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1841930822,
 $CellContext`ExpressionUUID -> "254eed9a-9445-40db-b24d-472d2350b88b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointSpaceGroupQ\>\""}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "if", " ", "valid", " ", "point"}], "-", " ", 
    RowBox[{"or", " ", "space", " ", "group", " ", "string"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "PSG"}], ",", "input"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
   "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, {
   3.713604296226803*^9, 3.713604299721271*^9}, {3.714710977590053*^9, 
   3.714710979768374*^9}, 3.717740920646922*^9, 3.7276035440759487`*^9, 
   3.743865456393198*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->1354553849,
 $CellContext`ExpressionUUID -> "ca8d9a53-8b24-4939-b8f1-e2ca3a470796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"type_String", ",", 
    RowBox[{"scatteringAngle_:", "0"}], ",", "\"\<Polarisation\>\""}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"type", "===", "\"\<sigma\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Sigma]\>\""}]}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", "===", "\"\<pi\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Pi]\>\""}]}], ",", 
    RowBox[{"Abs", "@", 
     RowBox[{"Cos", "[", "scatteringAngle", "]"}]}], ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"InputCheck", "::", "\"\<polarisation\>\""}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->False,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->512398296,
 $CellContext`ExpressionUUID -> "21c993c3-a67a-4d03-a7b5-7cd460cbf33b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{
   "crystal_String", ",", "wavelength_", ",", "\"\<ProcessWavelength\>\"", 
    ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[Lambda]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"wavelength", "===", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
         "crystal", ",", "\"\<GetCrystalWavelength\>\"", ",", "abortQ"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", "wavelength"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\[Lambda]", ",", "\"\<GetEnergyWavelength\>\"", ",", "False"}],
       "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->False,
 CellChangeTimes->{{3.730395241910015*^9, 3.730395331782501*^9}, 
   3.73039551088382*^9, {3.7391249707350397`*^9, 3.739124986130555*^9}, {
   3.73912511330057*^9, 3.739125114641823*^9}, {3.739125407092436*^9, 
   3.7391254219192133`*^9}, {3.7391254965873337`*^9, 3.739125499857193*^9}, {
   3.739125656582911*^9, 3.739125666230063*^9}, 3.762793093803693*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellID->468736402,
 $CellContext`ExpressionUUID -> "a5b11313-8f8e-4d89-bf43-7d46a4865e93"]
}, Closed]]
}, Open  ]]
},
WindowSize->Medium,
WindowMargins->Automatic,
Visible->True,
CellContext->"Global`",
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "FunctionPageStyles.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ExtendedExamples"->{
  Cell[33740, 878, 155, 2, 55, "ExtendedExamplesSection",
   CellTags->"ExtendedExamples",
   CellID->1854448968]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ExtendedExamples", 429228, 9453}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 600, 14, 24, "History",
 CellID->1247902091],
Cell[CellGroupData[{
Cell[1183, 38, 123, 1, 29, "CategorizationSection",
 CellID->1122911449],
Cell[1309, 41, 134, 2, 30, "Categorization",
 CellID->686433507],
Cell[1446, 45, 175, 3, 30, "Categorization",
 CellID->605800465],
Cell[1624, 50, 174, 3, 30, "Categorization",
 CellID->468444828],
Cell[1801, 55, 162, 2, 30, "Categorization"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2000, 62, 110, 1, 29, "KeywordsSection",
 CellID->477174294],
Cell[2113, 65, 100, 1, 70, "Keywords",
 CellID->1164421360]
}, Closed]],
Cell[CellGroupData[{
Cell[2250, 71, 120, 1, 19, "TemplatesSection",
 CellID->1872225408],
Cell[2373, 74, 149, 2, 70, "Template",
 CellID->1562036412],
Cell[2525, 78, 137, 2, 70, "Template",
 CellID->158391909],
Cell[2665, 82, 136, 2, 70, "Template",
 CellID->1360575930],
Cell[2804, 86, 137, 2, 70, "Template",
 CellID->793782254]
}, Closed]],
Cell[CellGroupData[{
Cell[2978, 93, 108, 1, 19, "DetailsSection",
 CellID->307771771],
Cell[3089, 96, 118, 2, 70, "Details",
 CellID->670882175],
Cell[3210, 100, 124, 2, 70, "Details",
 CellID->350963985],
Cell[3337, 104, 119, 2, 70, "Details",
 CellID->8391405],
Cell[3459, 108, 124, 2, 70, "Details",
 CellID->3610269],
Cell[3586, 112, 116, 2, 70, "Details",
 CellID->401364205],
Cell[3705, 116, 116, 2, 70, "Details",
 CellID->350204745],
Cell[3824, 120, 118, 2, 70, "Details",
 CellID->732958810],
Cell[3945, 124, 133, 2, 70, "Details",
 CellID->222905350],
Cell[4081, 128, 122, 2, 70, "Details",
 CellID->240026365]
}, Closed]],
Cell[CellGroupData[{
Cell[4240, 135, 108, 1, 63, "ObjectName",
 CellID->1224892054],
Cell[4351, 138, 1103, 31, 75, "Usage",
 CellID->982511436],
Cell[5457, 171, 296, 5, 41, "Notes",
 CellID->1871022088],
Cell[5756, 178, 213, 2, 25, "Notes",
 CellID->1067943069],
Cell[5972, 182, 6202, 124, 347, "2ColumnTableMod",
 CellID->222684676],
Cell[12177, 308, 293, 5, 41, "Notes",
 CellID->221498276],
Cell[12473, 315, 3791, 74, 70, "2ColumnTableMod",
 CellID->1183224025],
Cell[16267, 391, 846, 23, 70, "Notes",
 CellID->1298381760],
Cell[17116, 416, 600, 11, 70, "Notes",
 CellID->1980014868]
}, Open  ]],
Cell[CellGroupData[{
Cell[17753, 432, 112, 1, 70, "TutorialsSection",
 CellID->250839057],
Cell[17868, 435, 100, 1, 70, "Tutorials",
 CellID->341631938]
}, Open  ]],
Cell[CellGroupData[{
Cell[18005, 441, 138, 1, 70, "RelatedDemonstrationsSection",
 CellID->1268215905],
Cell[18146, 444, 113, 1, 70, "RelatedDemonstrations",
 CellID->1129518860]
}, Open  ]],
Cell[CellGroupData[{
Cell[18296, 450, 120, 1, 70, "RelatedLinksSection",
 CellID->1584193535],
Cell[18419, 453, 104, 1, 70, "RelatedLinks",
 CellID->1038487239]
}, Open  ]],
Cell[CellGroupData[{
Cell[18560, 459, 110, 1, 70, "SeeAlsoSection",
 CellID->1255426704],
Cell[18673, 462, 3338, 82, 70, "SeeAlso",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[22048, 549, 112, 1, 70, "MoreAboutSection",
 CellID->38303248],
Cell[22163, 552, 101, 1, 70, "MoreAbout",
 CellID->1665078683]
}, Open  ]],
Cell[CellGroupData[{
Cell[22301, 558, 411, 11, 70, "PrimaryExamplesSection",
 CellID->880084151],
Cell[22715, 571, 205, 2, 70, "ExampleText",
 CellID->1837160032],
Cell[CellGroupData[{
Cell[22945, 577, 371, 7, 70, "Input",
 CellID->1367903769],
Cell[23319, 586, 797, 14, 70, "Message",
 CellID->1326644799],
Cell[24119, 602, 225, 4, 70, "Output",
 CellID->1743913639]
}, Open  ]],
Cell[CellGroupData[{
Cell[24381, 611, 336, 8, 70, "Input",
 CellID->1815249394],
Cell[24720, 621, 707, 13, 70, "Message",
 CellID->165158378],
Cell[25430, 636, 223, 4, 70, "Output",
 CellID->1267987122]
}, Open  ]],
Cell[CellGroupData[{
Cell[25690, 645, 483, 13, 70, "Input",
 CellID->461672276],
Cell[26176, 660, 754, 13, 70, "Message",
 CellID->1842461307],
Cell[26933, 675, 224, 4, 70, "Output",
 CellID->1680480656]
}, Open  ]],
Cell[CellGroupData[{
Cell[27194, 684, 242, 5, 70, "ExampleDelimiter",
 CellID->467526121],
Cell[CellGroupData[{
Cell[27461, 693, 516, 13, 70, "Input",
 CellID->1466599491],
Cell[27980, 708, 570, 11, 70, "Message",
 CellID->167193413],
Cell[28553, 721, 225, 4, 70, "Output",
 CellID->1111082015]
}, Open  ]],
Cell[CellGroupData[{
Cell[28815, 730, 523, 13, 70, "Input",
 CellID->320344971],
Cell[29341, 745, 509, 10, 70, "Message",
 CellID->1995402594],
Cell[29853, 757, 223, 4, 70, "Output",
 CellID->1626765806]
}, Open  ]],
Cell[CellGroupData[{
Cell[30113, 766, 533, 14, 70, "Input",
 CellID->296424568],
Cell[30649, 782, 499, 10, 70, "Message",
 CellID->2101297538],
Cell[31151, 794, 225, 4, 70, "Output",
 CellID->1139146251]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31425, 804, 243, 5, 17, "ExampleDelimiter",
 CellID->1993136983],
Cell[31671, 811, 283, 6, 25, "Input",
 CellID->81829532],
Cell[CellGroupData[{
Cell[31979, 821, 362, 9, 25, "Input",
 CellID->919410244],
Cell[32344, 832, 364, 8, 23, "Output",
 CellID->336557919]
}, Open  ]],
Cell[CellGroupData[{
Cell[32745, 845, 484, 13, 25, "Input",
 CellID->1383130743],
Cell[33232, 860, 447, 11, 23, "Output",
 CellID->1767990849]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33740, 878, 155, 2, 55, "ExtendedExamplesSection",
 CellTags->"ExtendedExamples",
 CellID->1854448968],
Cell[CellGroupData[{
Cell[33920, 884, 242, 5, 33, "ExampleSection",
 CellID->1293636265],
Cell[CellGroupData[{
Cell[34187, 893, 283, 5, 25, "Input",
 CellID->384054987],
Cell[34473, 900, 622, 19, 41, "Output",
 CellID->1573138389]
}, Open  ]],
Cell[CellGroupData[{
Cell[35132, 924, 243, 5, 17, "ExampleDelimiter",
 CellID->1117509503],
Cell[CellGroupData[{
Cell[35400, 933, 374, 8, 29, "Input",
 CellID->544578231],
Cell[35777, 943, 348, 8, 30, "Output",
 CellID->1638057539]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36174, 957, 241, 5, 17, "ExampleDelimiter",
 CellID->92703433],
Cell[CellGroupData[{
Cell[36440, 966, 285, 5, 25, "Input",
 CellID->1138377229],
Cell[36728, 973, 268, 4, 23, "Output",
 CellID->201421237]
}, Open  ]],
Cell[CellGroupData[{
Cell[37033, 982, 591, 12, 41, "Input",
 CellID->1889735775],
Cell[37627, 996, 491, 9, 23, "Output",
 CellID->852502587]
}, Open  ]],
Cell[CellGroupData[{
Cell[38155, 1010, 289, 5, 25, "Input",
 CellID->2118692029],
Cell[38447, 1017, 266, 4, 23, "Output",
 CellID->86925]
}, Open  ]],
Cell[CellGroupData[{
Cell[38750, 1026, 284, 5, 25, "Input",
 CellID->334541063],
Cell[39037, 1033, 522, 10, 63, "Message",
 CellID->1460948475],
Cell[39562, 1045, 245, 4, 23, "Output",
 CellID->1980483174]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[39846, 1054, 265, 5, 33, "ExampleSection",
 CellID->1020263627],
Cell[CellGroupData[{
Cell[40136, 1063, 244, 5, 21, "ExampleSection",
 CellID->2061341341],
Cell[40383, 1070, 247, 5, 70, "ExampleSubsection",
 CellID->1757724783],
Cell[40633, 1077, 247, 5, 70, "ExampleSubsection",
 CellID->1295379749]
}, Closed]],
Cell[40895, 1085, 248, 5, 21, "ExampleSection",
 CellID->258228157],
Cell[41146, 1092, 259, 5, 21, "ExampleSection",
 CellID->2123667759],
Cell[41408, 1099, 252, 5, 21, "ExampleSection",
 CellID->1305812373],
Cell[41663, 1106, 257, 5, 21, "ExampleSection",
 CellID->1653164318],
Cell[41923, 1113, 249, 5, 21, "ExampleSection",
 CellID->589267740],
Cell[CellGroupData[{
Cell[42197, 1122, 373, 8, 21, "ExampleSection",
 CellID->13108794],
Cell[42573, 1132, 7884, 174, 712, "Input",
 InitializationCell->False,
 CellID->450030692],
Cell[50460, 1308, 15233, 321, 1196, "Input",
 InitializationCell->False,
 CellID->228435710],
Cell[65696, 1631, 1693, 34, 70, "Input",
 InitializationCell->False,
 CellID->1765700781],
Cell[67392, 1667, 5040, 120, 70, "Input",
 InitializationCell->False,
 CellID->56508374],
Cell[72435, 1789, 3655, 74, 70, "Input",
 InitializationCell->False,
 CellID->548469844],
Cell[76093, 1865, 2791, 58, 70, "Input",
 InitializationCell->False,
 CellID->1132855184],
Cell[78887, 1925, 2793, 59, 70, "Input",
 InitializationCell->False,
 CellID->307063186],
Cell[81683, 1986, 8788, 174, 70, "Input",
 InitializationCell->False,
 CellID->407763361],
Cell[90474, 2162, 5239, 112, 70, "Input",
 InitializationCell->False,
 CellID->658490750],
Cell[95716, 2276, 20024, 410, 1264, "Input",
 InitializationCell->False,
 CellID->1270802259],
Cell[115743, 2688, 17378, 374, 1427, "Input",
 InitializationCell->False,
 CellID->1648697598],
Cell[133124, 3064, 1465, 33, 105, "Input",
 InitializationCell->False,
 CellID->679032345],
Cell[134592, 3099, 1189, 29, 105, "Input",
 InitializationCell->False,
 CellID->768522257],
Cell[135784, 3130, 1993, 39, 121, "Input",
 InitializationCell->False,
 CellID->1586920341],
Cell[137780, 3171, 1435, 33, 121, "Input",
 InitializationCell->False,
 CellID->1770759094],
Cell[139218, 3206, 7876, 177, 712, "Input",
 InitializationCell->False,
 CellID->395796128],
Cell[147097, 3385, 15226, 321, 70, "Input",
 InitializationCell->False,
 CellID->1388668537],
Cell[162326, 3708, 1684, 34, 70, "Input",
 InitializationCell->False,
 CellID->499825763],
Cell[164013, 3744, 5034, 120, 70, "Input",
 InitializationCell->False,
 CellID->1763055324],
Cell[169050, 3866, 3647, 74, 70, "Input",
 InitializationCell->False,
 CellID->691469162],
Cell[172700, 3942, 2783, 58, 70, "Input",
 InitializationCell->False,
 CellID->1488191817],
Cell[175486, 4002, 2785, 59, 70, "Input",
 InitializationCell->False,
 CellID->297831710],
Cell[178274, 4063, 8781, 174, 70, "Input",
 InitializationCell->False,
 CellID->2020652460],
Cell[187058, 4239, 5231, 112, 70, "Input",
 InitializationCell->False,
 CellID->799501562],
Cell[192292, 4353, 20015, 410, 1264, "Input",
 InitializationCell->False,
 CellID->417573255],
Cell[212310, 4765, 17369, 374, 1427, "Input",
 InitializationCell->False,
 CellID->177138389],
Cell[229682, 5141, 1457, 33, 105, "Input",
 InitializationCell->False,
 CellID->752569181],
Cell[231142, 5176, 1182, 29, 105, "Input",
 InitializationCell->False,
 CellID->1899027884],
Cell[232327, 5207, 1985, 39, 121, "Input",
 InitializationCell->False,
 CellID->1059684674],
Cell[234315, 5248, 1427, 33, 121, "Input",
 InitializationCell->False,
 CellID->1038431347],
Cell[235745, 5283, 7876, 177, 712, "Input",
 InitializationCell->False,
 CellID->939340375],
Cell[243624, 5462, 15226, 321, 70, "Input",
 InitializationCell->False,
 CellID->1341393528],
Cell[258853, 5785, 1684, 34, 70, "Input",
 InitializationCell->False,
 CellID->517698890],
Cell[260540, 5821, 5034, 120, 70, "Input",
 InitializationCell->False,
 CellID->1508990233],
Cell[265577, 5943, 3648, 74, 70, "Input",
 InitializationCell->False,
 CellID->1964458608],
Cell[269228, 6019, 2783, 58, 70, "Input",
 InitializationCell->False,
 CellID->1242235678],
Cell[272014, 6079, 2785, 59, 70, "Input",
 InitializationCell->False,
 CellID->419024012],
Cell[274802, 6140, 8780, 174, 70, "Input",
 InitializationCell->False,
 CellID->937691171],
Cell[283585, 6316, 5232, 112, 70, "Input",
 InitializationCell->False,
 CellID->1540509311],
Cell[288820, 6430, 20016, 410, 1264, "Input",
 InitializationCell->False,
 CellID->1277141745],
Cell[308839, 6842, 17369, 374, 1427, "Input",
 InitializationCell->False,
 CellID->822256450],
Cell[326211, 7218, 1457, 33, 105, "Input",
 InitializationCell->False,
 CellID->606886705],
Cell[327671, 7253, 1182, 29, 105, "Input",
 InitializationCell->False,
 CellID->1545011332],
Cell[328856, 7284, 1985, 39, 121, "Input",
 InitializationCell->False,
 CellID->1780681047],
Cell[330844, 7325, 1426, 33, 121, "Input",
 InitializationCell->False,
 CellID->574252337],
Cell[332273, 7360, 7875, 177, 712, "Input",
 InitializationCell->False,
 CellID->66610056],
Cell[340151, 7539, 15225, 321, 70, "Input",
 InitializationCell->False,
 CellID->676231105],
Cell[355379, 7862, 1684, 34, 70, "Input",
 InitializationCell->False,
 CellID->932721811],
Cell[357066, 7898, 5034, 120, 70, "Input",
 InitializationCell->False,
 CellID->1772338024],
Cell[362103, 8020, 3648, 74, 70, "Input",
 InitializationCell->False,
 CellID->2086985478],
Cell[365754, 8096, 2783, 58, 70, "Input",
 InitializationCell->False,
 CellID->1114522295],
Cell[368540, 8156, 2786, 59, 70, "Input",
 InitializationCell->False,
 CellID->1423842931],
Cell[371329, 8217, 8781, 174, 70, "Input",
 InitializationCell->False,
 CellID->1117862796],
Cell[380113, 8393, 5232, 112, 70, "Input",
 InitializationCell->False,
 CellID->1733068416],
Cell[385348, 8507, 20016, 410, 1264, "Input",
 InitializationCell->False,
 CellID->1360163451],
Cell[405367, 8919, 17369, 374, 1427, "Input",
 InitializationCell->False,
 CellID->303698642],
Cell[422739, 9295, 1458, 33, 105, "Input",
 InitializationCell->False,
 CellID->1841930822],
Cell[424200, 9330, 1182, 29, 105, "Input",
 InitializationCell->False,
 CellID->1354553849],
Cell[425385, 9361, 1984, 39, 121, "Input",
 InitializationCell->False,
 CellID->512398296],
Cell[427372, 9402, 1426, 33, 121, "Input",
 InitializationCell->False,
 CellID->468736402]
}, Closed]]
}, Open  ]]
}
]
*)

