(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   2257758,      43629]
NotebookOptionsPosition[   2206787,      42764]
NotebookOutlinePosition[   2207271,      42783]
CellTagsIndexPosition[   2207228,      42780]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.828757118826342*^9},ExpressionUUID->"717bc492-8b71-4cb4-912b-\
e06415e6c835"],

Cell[CellGroupData[{

Cell[TextData[{
 "Definitions in the ",
 StyleBox["MaXrd",
  FontSlant->"Italic"],
 " package"
}], "Title",
 CellChangeTimes->{{3.6325088204434223`*^9, 3.632508823522456*^9}, {
   3.655742119951337*^9, 3.655742125247018*^9}, {3.657176107171741*^9, 
   3.657176113595751*^9}, {3.6571965175177727`*^9, 3.657196518139456*^9}, {
   3.667811374858439*^9, 3.667811377601095*^9}, {3.667900351656826*^9, 
   3.667900356531871*^9}, 3.6816319306073236`*^9, {3.717737911452742*^9, 
   3.717737917345298*^9}, 3.717739389878994*^9, {3.743835282827827*^9, 
   3.743835301322831*^9}},ExpressionUUID->"8ae99ef7-4796-40a0-8315-\
c09dd1887448"],

Cell[CellGroupData[{

Cell["Package setup", "Chapter",
 CellChangeTimes->{{3.667809710340659*^9, 3.667809727338533*^9}, {
  3.6678099238942623`*^9, 3.667809924822213*^9}, {3.717738378985339*^9, 
  3.7177383803355417`*^9}, {3.717742309399435*^9, 3.717742310034616*^9}, {
  3.761653795651846*^9, 
  3.761653795796139*^9}},ExpressionUUID->"aac40e3d-1e33-41a0-92be-\
c5785be8619f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "file", " ", "with", " ", "usage", " ", "messages"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Needs", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"CreateUsage", "'"}], " ", "function", " ", "for", " ", 
     "extracting", " ", "formatted", " ", "usage", " ", "text"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<Stians`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Clearing", " ", "symbold", " ", "causing", " ", "issues"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "$CrystalData", ",", "$LaueClasses", ",", "$PeriodicTable", ",", 
      "$PointGroups", ",", "$SpaceGroups", ",", "$TransformationMatrices", 
      ",", "$MaXrdChangelog", ",", "$MaXrdFunctions", ",", "$MaXrdPath", ",", 
      "$GroupSymbolRedirect", ",", "$MaXrdVersion"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"CreateUsage", "[", 
    RowBox[{
     RowBox[{"NotebookFileName", "[", "]"}], ",", 
     RowBox[{"\"\<DefinitionsNotebook\>\"", "\[Rule]", "True"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.660662612972769*^9, 3.660662615331635*^9}, {
   3.6678996421176853`*^9, 3.66789969462072*^9}, {3.667899845913467*^9, 
   3.667899850423938*^9}, {3.667899984372815*^9, 3.6678999940522842`*^9}, {
   3.667900034828264*^9, 3.667900089209947*^9}, {3.667900334078722*^9, 
   3.6679003638145247`*^9}, {3.667903245172576*^9, 3.6679032454925957`*^9}, {
   3.667903509806757*^9, 3.6679035140052967`*^9}, {3.675758442867031*^9, 
   3.675758481993051*^9}, {3.6757585443694277`*^9, 3.6757585456885557`*^9}, {
   3.6757585983182087`*^9, 3.675758704140443*^9}, {3.675758754211491*^9, 
   3.675758772678719*^9}, {3.675759204709443*^9, 3.6757592307473087`*^9}, {
   3.675759379117465*^9, 3.6757594378723717`*^9}, {3.675759500854343*^9, 
   3.675759530220367*^9}, {3.675759709648603*^9, 3.675759710360009*^9}, {
   3.675759767239332*^9, 3.675759808110104*^9}, {3.675760218477907*^9, 
   3.6757602205561533`*^9}, {3.675762009516317*^9, 3.675762010034891*^9}, {
   3.675762172552596*^9, 3.675762176643489*^9}, {3.6757694543401737`*^9, 
   3.675769455794608*^9}, {3.67576953993613*^9, 3.6757695580553617`*^9}, {
   3.6757710214550257`*^9, 3.6757710272949677`*^9}, 3.675771150291032*^9, {
   3.675856100530809*^9, 3.675856100753621*^9}, {3.675856527195032*^9, 
   3.675856540089183*^9}, 3.679727001698728*^9, 3.679727049088442*^9, 
   3.679727711425622*^9, {3.6839690810772543`*^9, 3.683969113087332*^9}, {
   3.7177379328989363`*^9, 3.717737933586039*^9}, {3.717738014422647*^9, 
   3.717738015614521*^9}, {3.7177409978788757`*^9, 3.7177410384803667`*^9}, {
   3.7177413378554688`*^9, 3.717741379077037*^9}, {3.7177414825292664`*^9, 
   3.7177415538374147`*^9}, {3.7177420992113*^9, 3.717742100443009*^9}, 
   3.717742370382308*^9, {3.717743709288949*^9, 3.717743727768016*^9}, {
   3.717743977639468*^9, 3.7177440116306677`*^9}, 3.717744050452475*^9, {
   3.7177440818214197`*^9, 3.717744184730303*^9}, {3.717744236083075*^9, 
   3.717744256948084*^9}, {3.717744312128818*^9, 3.717744331826899*^9}, {
   3.717744425895924*^9, 3.717744448975348*^9}, {3.717744506311816*^9, 
   3.717744540670703*^9}, {3.7177446038680487`*^9, 3.7177446062959003`*^9}, 
   3.71774468810388*^9, {3.717744763574163*^9, 3.717744827259562*^9}, {
   3.717744978946293*^9, 3.717744983144945*^9}, {3.7179286885787992`*^9, 
   3.717928693591135*^9}, 3.7190622887730703`*^9, {3.719070068458487*^9, 
   3.719070068912201*^9}, {3.719087441980075*^9, 3.719087442132564*^9}, {
   3.730012522682797*^9, 3.730012523250532*^9}, {3.730108424097702*^9, 
   3.730108427107399*^9}, {3.730116731369512*^9, 3.730116753664315*^9}, {
   3.7301168078184347`*^9, 3.730116814398196*^9}, {3.730120663483899*^9, 
   3.7301206868656397`*^9}, {3.7307227278396273`*^9, 3.730722728041614*^9}, 
   3.735309531237376*^9, 3.73917234479235*^9, 3.743835305126947*^9, 
   3.743865332915565*^9, {3.743865384964581*^9, 3.743865411582386*^9}, 
   3.743865455251375*^9, 3.7438656510644197`*^9, {3.758528935865739*^9, 
   3.758528937654502*^9}, {3.7627520018639727`*^9, 3.7627520050845127`*^9}, {
   3.762752069364541*^9, 3.762752070252963*^9}, {3.7627521516978607`*^9, 
   3.7627521745728493`*^9}, {3.7627523842838*^9, 3.762752391691227*^9}, {
   3.762752446234836*^9, 3.762752457655525*^9}, {3.7627525460106*^9, 
   3.762752546237638*^9}, {3.762752595286416*^9, 3.762752647377551*^9}, {
   3.762752697787332*^9, 3.762752711529207*^9}, 3.78006331583945*^9, 
   3.7850723494601917`*^9, {3.800088548740131*^9, 3.800088551039072*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[550]:=",ExpressionUUID->"19f648e6-3db9-4a0b-a8e4-df365c8a9759"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Start", " ", "package"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BeginPackage", "[", "\"\<MaXrd`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Import", " ", "usage", " ", "messages", " ", "from", " ", "file"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FailureQ", "@", 
          RowBox[{"FindFile", "[", "#", "]"}]}]}], ",", 
        RowBox[{"Get", "@", 
         RowBox[{"FindFile", "[", "#", "]"}]}]}], "]"}], "&"}], "[", 
     "\"\<MaXrd/Core/Messages.txt\>\"", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7190633903591433`*^9, 3.719063390750228*^9}, {
  3.743835321690852*^9, 3.743835323490286*^9}, {3.761731979020997*^9, 
  3.7617319857542353`*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[498]:=",ExpressionUUID->"f1765770-b59d-4699-a23c-fcf12cb9f26c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.71773858505546*^9, 3.717738589008402*^9}, {
  3.717743878763125*^9, 3.7177438810008383`*^9}, {3.717743962064261*^9, 
  3.717743963517083*^9}},ExpressionUUID->"6d7fc55f-b1c0-4e10-b031-\
7816175be8be"],

Cell[CellGroupData[{

Cell["AttenuationCoefficient", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.6823273339048023`*^9, 3.6823273376015463`*^9}, 3.6823289774394608`*^9, 
   3.683970210830709*^9, 3.6841265886995287`*^9, {3.687070410274006*^9, 
   3.687070414339764*^9}, {3.714279228356523*^9, 
   3.7142792321304007`*^9}},ExpressionUUID->"c41cb460-4373-45c5-bb69-\
a9a10140c89a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[500]:=",ExpressionUUID->"c699d47a-52db-414c-84e1-23f2cab35bf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AttenuationCoefficient", "::", "invalidSource"}], "=", 
   "\"\<The source \[LeftGuillemet]`1`\[RightGuillemet] is invalid.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AttenuationCoefficient", "::", "invcoeff"}], "=", 
   "\"\<The \[LeftGuillemet]`1`\[RightGuillemet] coefficient is not \
recognised.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AttenuationCoefficient", "::", "peOnly"}], "=", 
   "\"\<Only the photoelectric cross section is related to \
\!\(\*StyleBox[FormBox[SuperscriptBox[\"f\", \
\"\[Prime]\[Prime]\",MultilineFunction->None],TraditionalForm], \
\"TI\"]\).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AttenuationCoefficient", "::", "asfLambda"}], "=", 
    "\"\<The wavelength, `1` \[CapitalARing], must be smaller than 2.5 \
\[CapitalARing] when using \!\(TraditionalForm\`\*SuperscriptBox[\(f\), \(\
\[DoublePrime]\)]\).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "AttenuationCoefficient"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Coefficient\>\"", "\[Rule]", "\"\<LinearAttenuation\>\""}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<MassCoefficientMethod\>\"", "\[Rule]", "\"\<DivideByDensity\>\""}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "GetScatteringCrossSections", " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<PhysicalProcess\>\"", "\[Rule]", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Source\>\"", "\[Rule]", "\"\<xraylib\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "AttenuationCoefficient"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7142771011593227`*^9, 3.714277116878936*^9}, 
   3.7142792426781883`*^9, {3.7187206630465183`*^9, 3.718720685173999*^9}, {
   3.725268806700364*^9, 3.725268823148202*^9}, {3.7252688760752687`*^9, 
   3.725268877026887*^9}, {3.725269156893145*^9, 3.725269165035409*^9}, {
   3.725269227570182*^9, 3.725269229209899*^9}, {3.725272373947567*^9, 
   3.7252723989784527`*^9}, {3.725273241918964*^9, 3.725273247278687*^9}, {
   3.725444185323474*^9, 3.7254441948992*^9}, {3.725444226978861*^9, 
   3.725444235801064*^9}, {3.725609418848913*^9, 3.7256094244180517`*^9}, 
   3.725617503769556*^9, {3.727595094743976*^9, 3.7275951525304117`*^9}, {
   3.727596157278677*^9, 3.727596157411038*^9}, {3.7275963376552258`*^9, 
   3.727596371990885*^9}, 3.727597556269699*^9, {3.72759862336992*^9, 
   3.7275986692757177`*^9}, {3.7275987211595488`*^9, 3.72759872414962*^9}, {
   3.727599661240222*^9, 3.7275997536656923`*^9}, {3.727600590765911*^9, 
   3.727600631635717*^9}, 3.72760107018398*^9, {3.7276011005221157`*^9, 
   3.727601101075252*^9}, {3.727605678373506*^9, 3.727605689480281*^9}, {
   3.72760572636793*^9, 3.727605726971096*^9}, {3.727606714090279*^9, 
   3.7276067407994757`*^9}, {3.733805766964224*^9, 3.733805852064715*^9}, {
   3.7338059500071087`*^9, 3.733805954223672*^9}, {3.733806093987896*^9, 
   3.733806159446396*^9}, {3.733807125176491*^9, 3.733807130300021*^9}, {
   3.733807422507615*^9, 3.733807432858644*^9}, {3.733807474026002*^9, 
   3.733807477003118*^9}, {3.735291796312076*^9, 3.735291797423252*^9}, {
   3.7352957155995493`*^9, 3.735295716462904*^9}, {3.735306109963554*^9, 
   3.7353061671057653`*^9}, {3.735306212768219*^9, 3.735306214246963*^9}, {
   3.7353065010127687`*^9, 3.735306503736622*^9}, {3.7373969463413887`*^9, 
   3.737396955499552*^9}, 3.737397728880765*^9, {3.738304012487692*^9, 
   3.738304052969688*^9}, 3.743865880198998*^9, 3.7441722690718527`*^9, {
   3.7567036374295893`*^9, 3.756703653275354*^9}, {3.756704023428278*^9, 
   3.7567040437871237`*^9}, 3.756705010054923*^9, 3.756710357649047*^9},
 CellLabel->
  "In[501]:=",ExpressionUUID->"ca57549c-ac09-4526-958f-ff373aaafc57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[507]:=",ExpressionUUID->"ffc0a3df-ec8f-4f45-ba45-7a1411d47cb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AttenuationCoefficient", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", ",", 
      RowBox[{"unitsQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"coeff", "=", 
       RowBox[{"OptionValue", "[", "\"\<Coefficient\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mcMethod", "=", 
       RowBox[{"OptionValue", "[", "\"\<MassCoefficientMethod\>\"", "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"source", "=", 
       RowBox[{"OptionValue", "[", "\"\<Source\>\"", "]"}]}], ",", 
      RowBox[{"pp", "=", 
       RowBox[{"OptionValue", "[", "\"\<PhysicalProcess\>\"", "]"}]}], ",", 
      "csDir", ",", "asfFile", ",", "\[IndentingNewLine]", "V", ",", 
      "\[Sigma]", ",", "\[CapitalSigma]", ",", "column", ",", "atomdata", ",",
       "r", ",", "siteM", ",", "\[IndentingNewLine]", "fpp", ",", "re", ",", 
      "\[Mu]", ",", "\[Rho]"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checking", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<ProcessWavelength\>\"", ",", "crystal", ",", "lambda"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"csDir", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\t", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<CrossSections\>\"", ",", "source"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"asfFile", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\[IndentingNewLine]", "\t", "\"\<AtomicScatteringFactor\>\"", ",", 
         "\"\<AnomalousCorrections\>\"", ",", 
         RowBox[{"source", "<>", "\"\<.m\>\""}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DirectoryQ", "[", "csDir", "]"}], "\[Nor]", 
        RowBox[{"FileExistsQ", "[", "asfFile", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"AttenuationCoefficient", "::", "invalidSource"}], ",", 
          "source"}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Processing", " ", "cross", " ", "section", " ", "type"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", 
         RowBox[{"Select", " ", "'"}]}], 
        RowBox[{"PhysicalProcess", "'"}], " ", "manually"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"pp", "=!=", "\"\<\>\""}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"column", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<Photoelectric\>\"", ",", "\"\<Photoionisation\>\""}], "}"}],
             ",", "pp"}], "]"}], ",", "2", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<Coherent\>\"", ",", "\"\<Rayleigh\>\"", ",", 
              "\"\<Thompson\>\"", ",", "\[IndentingNewLine]", "\t", 
              "\"\<Classical\>\"", ",", "\"\<Elastic\>\""}], "}"}], ",", 
            "pp"}], "]"}], ",", "3", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<Incoherent\>\"", ",", "\"\<Compton\>\"", ",", 
              "\"\<Inelastic\>\""}], "\[IndentingNewLine]", "\t", "}"}], ",", 
            "pp"}], "]"}], ",", "4", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"pp", "===", "\"\<Total\>\""}], ",", "5", ",", 
          "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"AttenuationCoefficient", "::", "invproc"}], ",", "pp"}],
             "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Select"}], " ", "automatically", " ", 
         "based", " ", "on", " ", "coefficient", " ", "type"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"column", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MemberQ", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<LinearAttenuation\>\"", ",", "\"\<MassAbsorption\>\""}], 
             "}"}], ",", "\[IndentingNewLine]", "\t", "coeff"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", "5", ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Total", " ", "=", " ", 
            RowBox[{"ph", ".", "el", ".", " ", 
             RowBox[{"+", " ", 
              RowBox[{"Ray", ".", " ", 
               RowBox[{"+", " ", 
                RowBox[{"Comp", "."}]}]}]}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"AttenuationCoefficient", "::", "invcoeff"}], ",", 
             "coeff"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Auxiliary", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"V", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"GetCrystalMetric", "@", "crystal"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Calculation", " ", "method"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DirectoryQ", "@", "csDir"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Using"}], " ", "cross", " ", "sections"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\[Sigma]", "=", 
         RowBox[{"Normal", "@", 
          RowBox[{"GetScatteringCrossSections", "[", 
           RowBox[{
           "crystal", ",", "\[Lambda]", ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<PhysicalProcess\>\"", "\[Rule]", "pp"}], ",", 
            RowBox[{"\"\<Source\>\"", "\[Rule]", "source"}], ",", 
            RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Multiplying", " ", "atoms", " ", "with", " ", "corresponding", " ", 
          "cross", " ", "sections"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"atomdata", "=", 
         RowBox[{"Values", "@", 
          RowBox[{"$CrystalData", "\[LeftDoubleBracket]", 
           RowBox[{
           "crystal", ",", "\"\<AtomData\>\"", ",", "All", ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Element\>\"", ",", "\"\<FractionalCoordinates\>\"", ",", 
              "\"\<OccupationFactor\>\""}], "}"}]}], 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        
        RowBox[{
         RowBox[{"atomdata", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{
           RowBox[{"atomdata", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{"\"\<+\>\"", ",", "\"\<-\>\"", ",", "DigitCharacter"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"atomdata", "=", 
         RowBox[{"atomdata", "/.", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\[Sigma]", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Missing", "[", 
               RowBox[{"\"\<KeyAbsent\>\"", ",", "\"\<OccupationFactor\>\""}],
                "]"}], "\[Rule]", "1"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"r", "=", 
         RowBox[{"atomdata", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"siteM", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{
            "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"crystal", ",", 
              RowBox[{
              "r", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"\"\<UseCentring\>\"", "\[Rule]", "True"}]}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"Length", "@", "r"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"atomdata", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         "siteM"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[CapitalSigma]", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"Times", "@@@", "atomdata"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[Mu]", "=", 
         RowBox[{"\[CapitalSigma]", "/", "V"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"b", ".", " ", "Using"}], " ", "f"}], "-", "double", "-", 
         "prime"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "wavelength"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Lambda]", ">", "2.5"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"AttenuationCoefficient", "::", "asfLambda"}], ",", 
             RowBox[{"ToString", "@", "\[Lambda]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"column", "=", "3"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"Force", " ", 
          RowBox[{"p", ".", "e", ".", " ", "cross"}], " ", "section", " ", 
          "only"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"re", "=", "2.81794032*^-15"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"fpp", "=", 
         RowBox[{"Im", "@", 
          RowBox[{"StructureFactor", "[", 
           RowBox[{"crystal", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[Lambda]", ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"\"\<AbsoluteValue\>\"", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"\"\<f1f2Source\>\"", "\[Rule]", "source"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"(", 
          RowBox[{
          "See", " ", "formula", " ", "in", " ", "documentation", " ", "page",
            " ", "details"}], ")"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"\[Mu]", "=", 
         RowBox[{"2", "*", "re", "*", 
          RowBox[{"\[Lambda]", "/", "V"}], "*", 
          RowBox[{"Abs", "[", "fpp", "]"}], "*", 
          RowBox[{"Power", "[", 
           RowBox[{"10", ",", "18"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Normalise", " ", "by", " ", "mass", " ", 
       RowBox[{"density", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"coeff", "===", "\"\<MassAbsorption\>\""}], "&&", 
        RowBox[{"mcMethod", "===", "\"\<DivideByDensity\>\""}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\[Rho]", "=", 
         RowBox[{"CrystalDensity", "[", 
          RowBox[{"crystal", ",", 
           RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Return", "@", 
           RowBox[{"Quantity", "[", 
            RowBox[{
             RowBox[{"\[Mu]", "/", "\[Rho]"}], ",", 
             RowBox[{
              RowBox[{"\"\<Centimeters\>\"", "^", "2"}], "/", 
              "\"\<Grams\>\""}]}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          
          RowBox[{"Return", "[", 
           RowBox[{"\[Mu]", "/", "\[Rho]"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Output", " ", "linear", " ", "coefficient"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"unitsQ", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"\"\<Centimeters\>\"", "^", 
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}]}]}], "]"}], ",", "\[Mu]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327825752265*^9, {3.682327891309991*^9, 3.682327908905006*^9}, {
   3.682328462663025*^9, 3.682328464594318*^9}, {3.6823288379476137`*^9, 
   3.682328840375494*^9}, {3.6823289450420847`*^9, 3.682328948786008*^9}, 
   3.682329021553924*^9, {3.682329649608305*^9, 3.682329652832589*^9}, 
   3.6823298080835743`*^9, {3.682350312716905*^9, 3.682350378410404*^9}, 
   3.6823504635691757`*^9, {3.6823505010243587`*^9, 3.682350503583688*^9}, {
   3.68235624088593*^9, 3.68235624215532*^9}, {3.6824154065363083`*^9, 
   3.682415411290797*^9}, {3.6824949312809687`*^9, 3.682494933923278*^9}, {
   3.682494968776065*^9, 3.6824950015362787`*^9}, {3.682495062367214*^9, 
   3.6824950649247932`*^9}, {3.682495113046337*^9, 3.6824951159073544`*^9}, {
   3.68249526412218*^9, 3.682495265376318*^9}, {3.68249545065454*^9, 
   3.682495470163967*^9}, {3.682495512292554*^9, 3.682495515202944*^9}, {
   3.682495556347404*^9, 3.682495579369482*^9}, {3.6824958395091257`*^9, 
   3.682495843227323*^9}, {3.6824961499028397`*^9, 3.682496152773938*^9}, {
   3.682496263451882*^9, 3.682496267049795*^9}, {3.682496312064939*^9, 
   3.6824963159122458`*^9}, {3.682496526788476*^9, 3.682496526940209*^9}, {
   3.682496864685812*^9, 3.682496866861273*^9}, {3.682496942171248*^9, 
   3.68249696514644*^9}, 3.682497201839513*^9, {3.6824972729799232`*^9, 
   3.682497296643372*^9}, {3.6824973270838213`*^9, 3.68249734521832*^9}, 
   3.68268180724885*^9, {3.684128291025429*^9, 3.684128389624958*^9}, {
   3.68412845933915*^9, 3.684128486385932*^9}, {3.684128529353738*^9, 
   3.6841285582182617`*^9}, {3.6841288206899014`*^9, 3.684128901287672*^9}, {
   3.684128968928697*^9, 3.68412900913936*^9}, {3.6841292785084352`*^9, 
   3.684129357017983*^9}, {3.684129890723934*^9, 3.684129917971912*^9}, {
   3.6841300831135187`*^9, 3.684130083432626*^9}, {3.684138321122032*^9, 
   3.684138354809764*^9}, {3.684138494851803*^9, 3.6841385035605307`*^9}, {
   3.684138540043199*^9, 3.6841385752075777`*^9}, {3.685245928608788*^9, 
   3.685245936564748*^9}, {3.685292498644186*^9, 3.685292547209746*^9}, {
   3.685293229629302*^9, 3.685293257980389*^9}, {3.6852936989464273`*^9, 
   3.685293705920918*^9}, {3.685418988387327*^9, 3.6854191059404497`*^9}, 
   3.685765928283773*^9, {3.686654834485551*^9, 3.686654890223186*^9}, {
   3.68707046283397*^9, 3.687070498302699*^9}, {3.6870706403942127`*^9, 
   3.687070645183961*^9}, {3.687074314093583*^9, 3.687074317994583*^9}, {
   3.687074374371909*^9, 3.687074570760933*^9}, {3.687074652127841*^9, 
   3.687074670820685*^9}, {3.687074709674035*^9, 3.687074745552079*^9}, 
   3.6870747762370996`*^9, {3.687075134103478*^9, 3.687075190017233*^9}, {
   3.687075227136788*^9, 3.6870752283386497`*^9}, {3.687084433842494*^9, 
   3.687084434540505*^9}, {3.687252674715548*^9, 3.6872527537030087`*^9}, {
   3.6872530883472633`*^9, 3.687253099104884*^9}, {3.6872531543581467`*^9, 
   3.687253322775559*^9}, {3.7142771196500397`*^9, 3.714277178441402*^9}, {
   3.7142792444078503`*^9, 3.7142792456383257`*^9}, {3.7142796797387342`*^9, 
   3.714279682473756*^9}, 3.7142797831707277`*^9, {3.714279814324584*^9, 
   3.714279838321075*^9}, {3.717740904453494*^9, 3.717740920456429*^9}, {
   3.718696577274802*^9, 3.718696627861423*^9}, {3.7186967142424183`*^9, 
   3.7186967147340813`*^9}, {3.718696792968584*^9, 3.71869679321145*^9}, {
   3.718696906307351*^9, 3.7186969091161127`*^9}, {3.718696991305678*^9, 
   3.718697052988871*^9}, {3.7187172800606413`*^9, 3.7187173470382023`*^9}, {
   3.718717379383102*^9, 3.7187174148204517`*^9}, {3.718717488228198*^9, 
   3.718717491026578*^9}, {3.718720070887845*^9, 3.718720085142127*^9}, {
   3.7187201586451893`*^9, 3.718720352039188*^9}, {3.718720394463822*^9, 
   3.718720396278257*^9}, {3.718720543700461*^9, 3.7187206606961927`*^9}, {
   3.7187206908647337`*^9, 3.718720767621423*^9}, {3.718720836716254*^9, 
   3.7187208891380653`*^9}, {3.7187209291227837`*^9, 3.718720948201191*^9}, {
   3.718729205281302*^9, 3.718729248975091*^9}, {3.718814337621928*^9, 
   3.71881435191628*^9}, {3.718814945192078*^9, 3.718815025636673*^9}, {
   3.718815447675469*^9, 3.7188154905358686`*^9}, {3.718815868726829*^9, 
   3.7188159045504293`*^9}, {3.718816345921665*^9, 3.718816383590927*^9}, {
   3.7188164578149977`*^9, 3.718816470836544*^9}, {3.719060981858221*^9, 
   3.7190609882613688`*^9}, {3.719061020869276*^9, 3.719061069506462*^9}, {
   3.7252697943207827`*^9, 3.7252699678916187`*^9}, {3.725270603409759*^9, 
   3.7252706042367573`*^9}, {3.725270841256734*^9, 3.725270867576191*^9}, {
   3.725271247568046*^9, 3.725271324259781*^9}, {3.725271452850932*^9, 
   3.725271454009354*^9}, {3.725271492634151*^9, 3.72527151962381*^9}, {
   3.725271638847114*^9, 3.72527164350896*^9}, {3.7252719083608723`*^9, 
   3.725271923558984*^9}, {3.725272298431737*^9, 3.725272350421612*^9}, {
   3.725272402205048*^9, 3.72527244417188*^9}, {3.725272631784109*^9, 
   3.725272641227659*^9}, {3.72527267485524*^9, 3.725272691237422*^9}, {
   3.72527311647713*^9, 3.725273165306882*^9}, {3.725273206193162*^9, 
   3.7252732719148207`*^9}, {3.725273308513805*^9, 3.725273320479816*^9}, {
   3.725273448694283*^9, 3.725273484590317*^9}, {3.7252739664192963`*^9, 
   3.725273981306225*^9}, {3.7253735568340893`*^9, 3.7253735688323936`*^9}, {
   3.725373908459175*^9, 3.7253739128492823`*^9}, {3.725374117071377*^9, 
   3.725374122918681*^9}, 3.725374225021799*^9, {3.725374283442111*^9, 
   3.725374307704977*^9}, {3.725374666409811*^9, 3.72537471971462*^9}, {
   3.725374832313146*^9, 3.725374868301381*^9}, {3.7253749321418447`*^9, 
   3.725374952949141*^9}, {3.7253762167569838`*^9, 3.725376375167273*^9}, {
   3.725376414760065*^9, 3.725376424262648*^9}, {3.72537713590405*^9, 
   3.7253771382141247`*^9}, {3.72537720593338*^9, 3.725377241394939*^9}, 
   3.725431095469984*^9, {3.725431152356546*^9, 3.72543125425383*^9}, 
   3.725431405022188*^9, {3.72543144959653*^9, 3.725431458188115*^9}, {
   3.725431519565583*^9, 3.725431546084051*^9}, {3.725433607711245*^9, 
   3.725433607875033*^9}, {3.7254389561187887`*^9, 3.725439004963586*^9}, {
   3.725439035746935*^9, 3.725439142872712*^9}, {3.725440248570176*^9, 
   3.725440261217514*^9}, {3.72544031558554*^9, 3.725440322201033*^9}, {
   3.7254403689262133`*^9, 3.725440379566348*^9}, {3.725440948075251*^9, 
   3.725440951724298*^9}, {3.725441021544433*^9, 3.725441075693317*^9}, {
   3.725441121132326*^9, 3.725441256056897*^9}, {3.725441576763502*^9, 
   3.725441598666348*^9}, {3.725441629370322*^9, 3.725441648856089*^9}, {
   3.725441741502282*^9, 3.7254417720922337`*^9}, {3.725441859557227*^9, 
   3.725441915273739*^9}, {3.7254419624824533`*^9, 3.725442055527149*^9}, {
   3.725442090121353*^9, 3.725442108603052*^9}, {3.725442242651855*^9, 
   3.725442288329866*^9}, {3.725442363906097*^9, 3.7254423660232687`*^9}, {
   3.725442396985964*^9, 3.725442537300845*^9}, {3.725442783290227*^9, 
   3.725442789423853*^9}, {3.725443105257683*^9, 3.72544314562961*^9}, {
   3.725443620133412*^9, 3.7254436220111933`*^9}, {3.72544484502874*^9, 
   3.725444846177541*^9}, {3.725445506324738*^9, 3.725445603873625*^9}, {
   3.725445652876431*^9, 3.725445687655731*^9}, {3.7254457322718782`*^9, 
   3.725445739556692*^9}, {3.7254458126392517`*^9, 3.7254459732397957`*^9}, {
   3.72544600673927*^9, 3.7254460409294643`*^9}, {3.725446082440621*^9, 
   3.7254461459020844`*^9}, {3.725446176623804*^9, 3.725446194796921*^9}, {
   3.72544672485463*^9, 3.725446835458315*^9}, 3.7254468786986027`*^9, {
   3.725448207127932*^9, 3.7254482213255663`*^9}, {3.725448268045261*^9, 
   3.725448275798976*^9}, {3.725609594471175*^9, 3.725609595133806*^9}, {
   3.725609758182316*^9, 3.725609761577835*^9}, {3.72560987803113*^9, 
   3.725609878269611*^9}, {3.725609957261696*^9, 3.7256099612974873`*^9}, {
   3.725609993915262*^9, 3.725610016290868*^9}, {3.72561013470751*^9, 
   3.725610148319676*^9}, {3.7256101845660963`*^9, 3.725610184693945*^9}, {
   3.725610370045615*^9, 3.725610371249484*^9}, {3.725617536512475*^9, 
   3.725617639843293*^9}, {3.7256177173098183`*^9, 3.725617773224988*^9}, {
   3.726223688910334*^9, 3.726223779764642*^9}, {3.726223815839501*^9, 
   3.726223866310741*^9}, {3.7262241728333263`*^9, 3.726224173048872*^9}, {
   3.7263905219435463`*^9, 3.7263906120946083`*^9}, {3.726561290259503*^9, 
   3.726561293777958*^9}, {3.726857773261689*^9, 3.7268577967058907`*^9}, {
   3.726857833969409*^9, 3.7268578477674437`*^9}, {3.726857892679901*^9, 
   3.726857896783546*^9}, {3.726857955565792*^9, 3.726858019275367*^9}, {
   3.7268581230812817`*^9, 3.726858126855783*^9}, 3.726858172112897*^9, 
   3.726858344500679*^9, {3.7268585027128572`*^9, 3.726858514030747*^9}, {
   3.7268585488475924`*^9, 3.7268585522808332`*^9}, {3.726858598110031*^9, 
   3.726858617990168*^9}, {3.726858768474002*^9, 3.7268587977914457`*^9}, {
   3.7268588328870707`*^9, 3.726858856302162*^9}, {3.726858887679934*^9, 
   3.726858893773878*^9}, {3.726858966886116*^9, 3.7268589888202543`*^9}, 
   3.726859141635659*^9, {3.726859174188146*^9, 3.726859184593952*^9}, {
   3.726859228843294*^9, 3.726859278769764*^9}, {3.727596670713231*^9, 
   3.7275967212226667`*^9}, {3.727596790831655*^9, 3.7275967926392813`*^9}, 
   3.7275968328738327`*^9, {3.727596958300494*^9, 3.727596958786277*^9}, {
   3.727596992251334*^9, 3.72759700324319*^9}, {3.7275970345633163`*^9, 
   3.7275970574623632`*^9}, {3.7275985206670017`*^9, 3.7275986102626*^9}, {
   3.72759867778411*^9, 3.7275988954864492`*^9}, 3.727598942256852*^9, {
   3.72759897750863*^9, 3.727599013855448*^9}, {3.727599088736693*^9, 
   3.727599104855103*^9}, {3.7275992674093943`*^9, 3.727599269636272*^9}, {
   3.727599364485498*^9, 3.7275993811005487`*^9}, {3.727599481226458*^9, 
   3.727599654265373*^9}, {3.727599779038115*^9, 3.727599841389889*^9}, {
   3.727599892695681*^9, 3.727599892973947*^9}, {3.727600638814896*^9, 
   3.7276006514193687`*^9}, {3.727600731345932*^9, 3.72760074339881*^9}, {
   3.7276009822570972`*^9, 3.7276010181153183`*^9}, 3.727601077966126*^9, {
   3.727603141129677*^9, 3.7276032589689503`*^9}, {3.727603433788258*^9, 
   3.7276034759418287`*^9}, {3.7276045771758823`*^9, 3.727604794750452*^9}, {
   3.727604829108159*^9, 3.72760485079314*^9}, {3.727604918516605*^9, 
   3.727604969390821*^9}, {3.727605026307961*^9, 3.7276050292851267`*^9}, {
   3.727605065999736*^9, 3.727605180288286*^9}, {3.727605427264027*^9, 
   3.7276054278434753`*^9}, {3.727605927425639*^9, 3.727606184324828*^9}, {
   3.727606663389245*^9, 3.727606702607633*^9}, {3.727606753027483*^9, 
   3.7276067964221487`*^9}, {3.727607248788731*^9, 3.727607566831222*^9}, 
   3.727607635936228*^9, 3.727675292623402*^9, 3.7276766297925587`*^9, 
   3.7276767844661827`*^9, {3.72767684001958*^9, 3.727676885072239*^9}, {
   3.7277093097659683`*^9, 3.7277093347667027`*^9}, {3.727709430606303*^9, 
   3.727709469547093*^9}, {3.72780913314751*^9, 3.7278091900229177`*^9}, {
   3.727850767511487*^9, 3.7278507686851273`*^9}, {3.7303979306301003`*^9, 
   3.730397942962326*^9}, {3.730543777621201*^9, 3.7305437777754107`*^9}, {
   3.730544115579426*^9, 3.730544115737665*^9}, {3.7305441832318296`*^9, 
   3.730544209081943*^9}, {3.730622837829286*^9, 3.730622853681568*^9}, {
   3.730623110374165*^9, 3.730623130027525*^9}, {3.733170306280711*^9, 
   3.73317033309278*^9}, {3.7331710008147717`*^9, 3.7331710251738367`*^9}, {
   3.7331711000446978`*^9, 3.7331711361705*^9}, {3.733171473981695*^9, 
   3.733171578192926*^9}, {3.73317163623409*^9, 3.733171651943324*^9}, 
   3.733202970819314*^9, 3.733804172513041*^9, {3.733805704590872*^9, 
   3.733805760174259*^9}, {3.73380587632876*^9, 3.7338058814714823`*^9}, {
   3.733805933078506*^9, 3.733805933504356*^9}, {3.733805977388275*^9, 
   3.733806007688088*^9}, 3.7338072718163424`*^9, {3.73380732023398*^9, 
   3.7338074010980377`*^9}, {3.7350320858541594`*^9, 3.735032132405632*^9}, {
   3.7353065300461683`*^9, 3.735306694608877*^9}, {3.7353067342337008`*^9, 
   3.7353067586461554`*^9}, {3.735306793406844*^9, 3.735306880284782*^9}, {
   3.735307344890975*^9, 3.735307345154111*^9}, {3.735307447075685*^9, 
   3.735307455994753*^9}, {3.7373670527127934`*^9, 3.737367053341886*^9}, {
   3.737396039501148*^9, 3.737396089467263*^9}, {3.7373962440651417`*^9, 
   3.737396255360158*^9}, {3.7373962939034023`*^9, 3.737396313525474*^9}, {
   3.737396980671*^9, 3.737397015363579*^9}, {3.737397170086678*^9, 
   3.737397278098724*^9}, {3.737397338659171*^9, 3.737397347537478*^9}, {
   3.737397598268832*^9, 3.737397645663148*^9}, 3.737397735046486*^9, 
   3.737397767184107*^9, 3.737968466882496*^9, {3.738303813108982*^9, 
   3.7383038170508738`*^9}, {3.738304066063772*^9, 3.738304071176364*^9}, {
   3.739170316786953*^9, 3.7391703198315573`*^9}, {3.743865411764411*^9, 
   3.743865411809656*^9}, 3.7438658804015923`*^9, {3.744034697052298*^9, 
   3.744034710978043*^9}, {3.7440349179223413`*^9, 3.744034918150834*^9}, {
   3.7441701135312233`*^9, 3.744170114030244*^9}, {3.758528988970167*^9, 
   3.758528992606166*^9}, {3.758529030218317*^9, 3.758529091683517*^9}, {
   3.7595192248069153`*^9, 3.75951922489293*^9}, 3.762793093025393*^9, {
   3.786967961472329*^9, 3.786967962893998*^9}, {3.7869681859392014`*^9, 
   3.786968188073204*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[508]:=",ExpressionUUID->"9efca070-debe-4ee4-afe4-a79f70e6c480"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[509]:=",ExpressionUUID->"dab4db01-5156-4ede-8605-c500a591c019"]
}, Closed]],

Cell[CellGroupData[{

Cell["BraggAngle", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.8054419263202667`*^9, 
   3.8054419271085243`*^9}},ExpressionUUID->"77412c77-a615-40d2-af30-\
4a1af2d05756"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[510]:=",ExpressionUUID->"602f3b46-faf4-43c9-a94c-47ed02be07df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BraggAngle", "::", "invinput"}], "=", 
    "\"\<Input must either be the name of a crystal or a metric \
matrix.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "BraggAngle"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<AngleThreshold\>\"", "\[Rule]", 
       RowBox[{"90.", "*", "Degree"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "BraggAngle"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
  3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
  3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
  3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
  3.756710476208014*^9}, {3.787040989609151*^9, 3.7870409904715548`*^9}},
 CellLabel->
  "In[511]:=",ExpressionUUID->"3ef5e913-88ad-40ec-ba4a-85d36ad7ee94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[514]:=",ExpressionUUID->"45a3af02-dcf5-482d-beb8-8271513cc2eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BraggAngle", "[", "\[IndentingNewLine]", 
   RowBox[{"input_", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "reflections_List", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"hkl", ",", "G", ",", "H", ",", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"N", "@", "lambda"}]}], ",", "sl", ",", "bragg", ",", "angle", 
      ",", "angleThreshold"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "crystal", " ", 
      RowBox[{"(", 
       RowBox[{"or", " ", "metric"}], ")"}], " ", "and", " ", "reflection", 
      RowBox[{"(", "s", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<CrystalQ\>\"", ",", "input"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"G", "=", 
         RowBox[{"GetCrystalMetric", "@", "input"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MatrixQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"G", "=", "input"}], ",", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"BraggAngle", "::", "invinput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "reflections", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reciprocal", " ", "metric"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", "G"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Process", " ", "wavelength"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatrixQ", "@", "input"}], ",", "\[IndentingNewLine]", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
         "\"\<GetEnergyWavelength\>\"", ",", "\[Lambda]", ",", "False"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
         "\"\<ProcessWavelength\>\"", ",", "input", ",", "\[Lambda]"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Sin", "/", "lambda"}], ",", " ", 
       RowBox[{"from", " ", 
        RowBox[{"Bragg", "'"}], "s", " ", "law", " ", "and", " ", "inner", 
        " ", "product"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sl", "[", "h_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"h", ".", "H", ".", "h"}], "]"}], "/", "2."}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bragg", "[", "h_", "]"}], ":=", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          RowBox[{"sl", "[", "h", "]"}], "*", "\[Lambda]"}], "]"}], "]"}], "/.", 
       RowBox[{"x_Complex", "\[Rule]", "Undefined"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"bragg", "/@", "hkl"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Truncate", " ", "at", " ", "chosen", " ", "angle", " ", 
        "threshold"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"angleThreshold", "=", 
      RowBox[{"OptionValue", "[", "\"\<AngleThreshold\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"0", "\[LessEqual]", "angleThreshold", "<", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"angle", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"angle", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "\[LessEqual]", "angleThreshold"}], ")"}], "&"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"angle", "=", 
      RowBox[{"angle", "/", "Degree"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"angle", "=", 
         RowBox[{"Quantity", "[", 
          RowBox[{"angle", ",", "\"\<Degrees\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"angle", "=", 
         RowBox[{"angle", "/.", 
          RowBox[{
           RowBox[{"Quantity", "[", 
            RowBox[{"Undefined", ",", "\"\<Degrees\>\""}], "]"}], "\[Rule]", 
           "Undefined"}]}]}]}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "only", " ", "one", " ", "reflection"}], ",", " ", 
       RowBox[{"return", " ", "content"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "angle"}], "\[Equal]", "1"}], ",", 
       RowBox[{"First", "@", "angle"}], ",", "angle"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, 3.7627930930413857`*^9, {3.786967967829575*^9, 
   3.786967969739787*^9}, {3.786968198607836*^9, 3.786968200222228*^9}, {
   3.787041003562891*^9, 3.787041007840021*^9}, {3.787043442208609*^9, 
   3.787043442391634*^9}, {3.787043914533633*^9, 3.787043915029189*^9}, {
   3.787044187217134*^9, 3.7870442307590923`*^9}, {3.787046842382929*^9, 
   3.7870468580202*^9}, {3.7870471728770447`*^9, 3.787047173717057*^9}, 
   3.787047204333239*^9, {3.787047256923612*^9, 3.787047261939014*^9}, {
   3.787047443010352*^9, 3.78704745035876*^9}, {3.787047537317247*^9, 
   3.787047592643764*^9}, {3.787047639764551*^9, 3.787047640066835*^9}, {
   3.787047810729336*^9, 3.787047815479068*^9}, {3.7870479564520483`*^9, 
   3.787047970787119*^9}, {3.805442316344285*^9, 3.805442318724873*^9}, {
   3.8054424959322844`*^9, 3.80544249628139*^9}, {3.805442739570627*^9, 
   3.805442835642147*^9}, {3.805443017716633*^9, 3.805443018009399*^9}, {
   3.8054430621758013`*^9, 3.805443086152588*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[515]:=",ExpressionUUID->"d82dc607-3bbe-4a04-846a-00b5bcfdf75d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[516]:=",ExpressionUUID->"942809d9-27ea-497d-bb0c-f9629fac2430"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConstructDomains", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.778393857909237*^9, 3.7783938593413057`*^9}, {
   3.778393998569772*^9, 
   3.7783940016747923`*^9}},ExpressionUUID->"fefc468f-3f9f-47e1-b37c-\
dc9bfd50ce7d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[517]:=",ExpressionUUID->"01a0f71e-6182-4164-a95e-e6be8e908aa2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConstructDomains", "::", "SectorRegionsInvalidNumberOfPairs"}], 
   "=", "\"\<The number of pairs must be a natural number.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstructDomains", "::", "SectorRegionsInvalidWidth"}], "=", 
   "\"\<Angular width of the sectors must be a number\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConstructDomains", "::", "CompleteDomination"}], "=", 
    "\"\<A domain has reached complete domination after `1` cycles.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ConstructDomains"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<ReturnAllCycles\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ShowProgress\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TransitionProbabilities\>\"", "\[Rule]", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "\[Rule]", "0.95"}], ",", 
         RowBox[{"1", "\[Rule]", "0.92"}], ",", 
         RowBox[{"2", "\[Rule]", "0.86"}], ",", 
         RowBox[{"3", "\[Rule]", "0.75"}], ",", 
         RowBox[{"4", "\[Rule]", "0.40"}], ",", 
         RowBox[{"5", "\[Rule]", "0.50"}], ",", 
         RowBox[{"6", "\[Rule]", "0.75"}], ",", 
         RowBox[{"7", "\[Rule]", "0.12"}], ",", 
         RowBox[{"8", "\[Rule]", "0.03"}]}], "|>"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ConstructDomains"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
   3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
   3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
   3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
   3.756710476208014*^9}, {3.7783938695145197`*^9, 3.778393898177862*^9}, {
   3.7783939288296223`*^9, 3.77839394384756*^9}, {3.7783940118740396`*^9, 
   3.778394057472179*^9}, {3.7815481403509073`*^9, 3.781548219187777*^9}, 
   3.7815509027308702`*^9, {3.781551063980256*^9, 3.781551083306244*^9}, {
   3.781551237656418*^9, 3.781551267245728*^9}, {3.783967805458932*^9, 
   3.783967806048873*^9}, {3.7842709339728193`*^9, 3.7842709368756857`*^9}, {
   3.784318327103009*^9, 3.784318329709264*^9}, {3.8019327115679703`*^9, 
   3.801932716636982*^9}, {3.804579716961298*^9, 3.804579759178113*^9}, {
   3.804580437902779*^9, 3.8045804811403837`*^9}},
 CellLabel->
  "In[518]:=",ExpressionUUID->"310e0981-68bb-4525-966f-219eff6c468c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[523]:=",ExpressionUUID->"958eb401-0d70-48d4-9aab-c422c9b3ad19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstructDomains", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A_Integer", ",", "B_Integer", ",", "C_Integer"}], "}"}], ",", 
    "\[IndentingNewLine]", "numberOfDomains_Integer", ",", 
    "numberOfCycles_Integer", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"structureSize", "=", 
       RowBox[{"A", "*", "B", "*", "C"}]}], ",", "\[IndentingNewLine]", 
      "insertionCoordinates", ",", "domainTable", ",", 
      RowBox[{"cyclesPassed", "=", "0"}], ",", 
      RowBox[{"transitionProbabilities", "=", 
       RowBox[{"OptionValue", "[", "\"\<TransitionProbabilities\>\"", "]"}]}],
       ",", "\[IndentingNewLine]", "visitOrderInCurrentCycle", ",", 
      "currentCellIndex", ",", "currentCell", ",", "nearest", ",", 
      "nearestFiltered", ",", "neighbourDomains", ",", 
      "numberOfDomainsEqualToSelf", ",", "\[IndentingNewLine]", 
      "completeSeries", ",", 
      RowBox[{"storeAllCyclesQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ReturnAllCycles\>\"", "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"insertionCoordinates", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GenerateTargetPositions\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"domainTable", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", 
        RowBox[{"insertionCoordinates", "\[Rule]", 
         RowBox[{"RandomSample", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Range", "@", "numberOfDomains"}], ",", 
              RowBox[{"\[LeftCeiling]", 
               RowBox[{"structureSize", "/", "numberOfDomains"}], 
               "\[RightCeiling]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           "structureSize"}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ShowProgress\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"ProgressIndicator", "@", 
           RowBox[{"Dynamic", "[", 
            RowBox[{"cyclesPassed", "/", "numberOfCycles"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], "]"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"completeSeries", "=", 
      RowBox[{"Reap", "@", 
       RowBox[{"Catch", "@", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"visitOrderInCurrentCycle", "=", 
            RowBox[{"RandomSample", "@", 
             RowBox[{"Range", "@", "structureSize"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"currentCellIndex", "=", 
               RowBox[{
               "visitOrderInCurrentCycle", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"currentCell", "=", 
               RowBox[{
               "insertionCoordinates", "\[LeftDoubleBracket]", 
                "currentCellIndex", "\[RightDoubleBracket]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nearest", "=", 
               RowBox[{"Nearest", "[", 
                RowBox[{
                "insertionCoordinates", ",", "currentCell", ",", "26"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"nearestFiltered", "=", 
               RowBox[{"Select", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Delete", "[", 
                  RowBox[{"nearest", ",", "1"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SquaredEuclideanDistance", "[", 
                    RowBox[{"currentCell", ",", "#"}], "]"}], "\[LessEqual]", 
                   "3."}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"neighbourDomains", "=", 
               RowBox[{"Lookup", "[", 
                RowBox[{"domainTable", ",", "nearestFiltered", ",", "0."}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"numberOfDomainsEqualToSelf", "=", 
               RowBox[{"Count", "[", 
                RowBox[{"neighbourDomains", ",", 
                 RowBox[{"domainTable", "[", "currentCell", "]"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Random", "[", "]"}], "<", 
                 RowBox[{
                 "transitionProbabilities", "[", "numberOfDomainsEqualToSelf",
                   "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"domainTable", "[", "currentCell", "]"}], "=", 
                 RowBox[{"RandomChoice", "@", "neighbourDomains"}]}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "structureSize"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"storeAllCyclesQ", ",", 
             RowBox[{"Sow", "@", 
              RowBox[{"Values", "@", "domainTable"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{
               RowBox[{"Values", "@", "domainTable"}], ",", 
               RowBox[{
                RowBox[{"#", "===", 
                 RowBox[{"First", "@", "domainTable"}]}], "&"}]}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{"ConstructDomains", "::", "CompleteDomination"}], ",", 
                RowBox[{"cyclesPassed", "+", "1"}]}], "]"}], ";", 
              RowBox[{"Throw", "@", "domainTable"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"cyclesPassed", "++"}]}], ",", "numberOfCycles"}], 
         "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Express", " ", "domain", " ", "table", " ", 
       RowBox[{"as", " ", "'"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"outputSize", ",", " ", 
          RowBox[{"{", "domains", "}"}]}], "}"}], "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"storeAllCyclesQ", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", 
         RowBox[{"completeSeries", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", 
         RowBox[{"Values", "@", "domainTable"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, 3.7627930930413857`*^9, 3.77839396803053*^9, 
   3.778394245419972*^9, 3.780063470091641*^9, {3.80094174833749*^9, 
   3.800941756554976*^9}, {3.801932723168949*^9, 3.8019327907450857`*^9}, {
   3.8019328500229053`*^9, 3.801932869977603*^9}, {3.801932901914207*^9, 
   3.8019329307842607`*^9}, {3.804576863614471*^9, 3.80457686745037*^9}, {
   3.804577100319353*^9, 3.804577104406619*^9}, {3.804579634726375*^9, 
   3.804579662531315*^9}, {3.804579697236507*^9, 3.804579697338612*^9}, {
   3.804579768013996*^9, 3.804579769436986*^9}, {3.804579828797785*^9, 
   3.804579845180225*^9}, {3.804579977538054*^9, 3.804580011386649*^9}, {
   3.804580071272149*^9, 3.804580119169683*^9}, {3.804580159772274*^9, 
   3.804580162658392*^9}, {3.804580528443069*^9, 3.80458057536327*^9}, {
   3.804580642809811*^9, 3.804580651235973*^9}, {3.804580843384656*^9, 
   3.804580859297247*^9}, {3.804580966037656*^9, 3.804581016597342*^9}, {
   3.804582463968121*^9, 3.804582523730595*^9}, {3.808134525446342*^9, 
   3.8081345386525373`*^9}, {3.8081345880740356`*^9, 3.808134589824107*^9}, {
   3.8081346571374273`*^9, 3.808134663176176*^9}, {3.8081346947047987`*^9, 
   3.80813470400593*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[524]:=",ExpressionUUID->"40d83617-8b8e-43d1-86a1-c7b205a902c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstructDomains", "[", 
   RowBox[{"\"\<SectorRegions\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"A_Integer", ",", "B_Integer", ",", "C_Integer"}], "}"}], ",", 
    "regionSettings_List", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "insertionCoordinates", ",", "identifiers", ",", "\[IndentingNewLine]", 
      "regions", ",", "\[IndentingNewLine]", "MakeSectorRegion", ",", 
      "angleStarts", ",", "oppositeStarts", ",", "allStarts", ",", 
      "angleRanges", ",", "disks", ",", "\[IndentingNewLine]", "FindMatch", 
      ",", "n"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "cheks"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"regionSettings", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
            RowBox[{"Positive", "[", "#", "]"}]}], "&"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
         "ConstructDomains", "::", "SectorRegionsInvalidNumberOfPairs"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"regionSettings", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          "NumericQ"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
         "ConstructDomains", "::", "SectorRegionsInvalidNumberOfPairs"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Auxiliary", " ", "functions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeSectorRegion", "[", "\[IndentingNewLine]", 
       RowBox[{"numberOfPairs_Integer", ",", "\[IndentingNewLine]", 
        RowBox[{"width_", "?", "NumericQ"}], ",", "\[IndentingNewLine]", 
        RowBox[{"startAngle_", ":", "Null"}]}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", "startAngle"}], ",", "\[IndentingNewLine]", 
          RowBox[{"angleStarts", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"a", ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "startAngle", ",", 
               RowBox[{"2.", "*", "\[Pi]"}], ",", 
               RowBox[{"2.", "*", 
                RowBox[{"\[Pi]", "/", 
                 RowBox[{"(", 
                  RowBox[{"numberOfPairs", "*", "2"}], ")"}]}]}]}], "}"}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"angleStarts", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", 
               RowBox[{"2.", "*", "\[Pi]"}]}], "}"}], ",", "numberOfPairs"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oppositeStarts", "=", 
         RowBox[{"angleStarts", "+", "\[Pi]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"allStarts", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"angleStarts", ",", "oppositeStarts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"angleRanges", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"#", "+", "width"}]}], "}"}], "&"}], "/@", 
          "allStarts"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"disks", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"A", "/", "2"}], ",", 
               RowBox[{"B", "/", "2"}]}], "}"}], ",", "A", ",", "#"}], "]"}], 
           "&"}], "/@", "angleRanges"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RegionUnion", "@@", "disks"}]}], "\[IndentingNewLine]", 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FindMatch", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"RegionMember", "[", 
              RowBox[{
               RowBox[{
               "regions", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
             RowBox[{"Return", "@", "i"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "regions"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", "n"}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Main", " ", "procedure"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"insertionCoordinates", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"A", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"B", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"regions", "=", 
      RowBox[{"MakeSectorRegion", "@@@", "regionSettings"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"insertionCoordinates", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FindMatch", "/@", "insertionCoordinates"}], ")"}], 
       "\[IndentingNewLine]", "/.", 
       RowBox[{"{", 
        RowBox[{"Null", "\[Rule]", 
         RowBox[{
          RowBox[{"Length", "@", "regions"}], "+", "1"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"identifiers", "=", 
      RowBox[{"Values", "@", "insertionCoordinates"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"C", ">", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"identifiers", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"identifiers", ",", "C"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Express", " ", "domain", " ", "table", " ", 
       RowBox[{"as", " ", "'"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"outputSize", ",", " ", 
          RowBox[{"{", "domains", "}"}]}], "}"}], "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", "identifiers"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, 3.7627930930413857`*^9, 3.77839396803053*^9, 
   3.778394245419972*^9, 3.780063470091641*^9, {3.781547218807502*^9, 
   3.7815472289410057`*^9}, {3.781547311875914*^9, 3.7815473185628557`*^9}, 
   3.7815478129586897`*^9, {3.781547863828452*^9, 3.781547888428114*^9}, {
   3.78154793457206*^9, 3.7815479905855713`*^9}, {3.781548023897159*^9, 
   3.781548045944471*^9}, {3.7815481205430307`*^9, 3.781548133038559*^9}, {
   3.781548229150922*^9, 3.781548235876753*^9}, {3.78154827349203*^9, 
   3.781548353363368*^9}, {3.7815483894260483`*^9, 3.7815484286731863`*^9}, {
   3.7815484758648577`*^9, 3.781548483358767*^9}, {3.781548699914445*^9, 
   3.781548763705165*^9}, {3.7815488443686857`*^9, 3.781548895480525*^9}, {
   3.781549008988761*^9, 3.781549013637012*^9}, {3.781549052476359*^9, 
   3.781549054930234*^9}, {3.781549177049245*^9, 3.781549177367593*^9}, {
   3.7815492392486134`*^9, 3.781549253253821*^9}, {3.78154969649034*^9, 
   3.7815497006577177`*^9}, {3.781549867968217*^9, 3.78154987017511*^9}, {
   3.7815510104308434`*^9, 3.781551057723961*^9}, {3.781551140244316*^9, 
   3.781551186443186*^9}, {3.781551221066202*^9, 3.7815512305393744`*^9}, {
   3.7839678221075497`*^9, 3.783967822378026*^9}, {3.783967856857737*^9, 
   3.783967873401091*^9}, {3.7839679153865423`*^9, 3.783967918080244*^9}, {
   3.783967964009967*^9, 3.783967973337833*^9}, {3.784022916701779*^9, 
   3.784022921406543*^9}, {3.784022964174165*^9, 3.7840230101711617`*^9}, {
   3.784025013883009*^9, 3.784025016724684*^9}, {3.784318293953845*^9, 
   3.784318295991396*^9}, {3.7870567973211937`*^9, 3.787056808597653*^9}, 
   3.787056912148855*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[525]:=",ExpressionUUID->"e275ae56-164b-4a6f-82e8-c673f2de99f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[526]:=",ExpressionUUID->"a80f1595-10dc-4121-bda8-48d0b94566e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["CrystalDensity", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.7168206455457077`*^9, 
   3.7168206470560017`*^9}, 
   3.728623897643963*^9},ExpressionUUID->"1f58df03-5f77-463a-a880-\
6ffa2d42f38c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[527]:=",ExpressionUUID->"55c12aef-1898-4cc0-a959-7cba7bb718d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "CrystalDensity"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "CrystalDensity"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716830555691573*^9, 3.716830573285467*^9}, {
  3.727178675184021*^9, 3.727178689821534*^9}, {3.7271789775270367`*^9, 
  3.727178977979187*^9}, {3.7348564037912083`*^9, 3.7348564042430964`*^9}, {
  3.735021939129917*^9, 3.7350219394007053`*^9}, {3.756710532217661*^9, 
  3.7567105366789618`*^9}, {3.756710596575431*^9, 3.7567105969234953`*^9}},
 CellLabel->
  "In[528]:=",ExpressionUUID->"b51278f0-0770-4dc6-82a6-c7b87c11a43b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[530]:=",ExpressionUUID->"31e40fc0-6437-4b8f-897d-af9bfed7eac0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrystalDensity", "[", 
   RowBox[{"crystal_String", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "unitsQ", ",", "Z", ",", "\[IndentingNewLine]", "f", ",", 
      "m", ",", "V", ",", "NA", ",", "\[IndentingNewLine]", "X", ",", "o", 
      ",", "xyz", ",", "M", ",", "mass", ",", "\[IndentingNewLine]", "temp"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Input", " ", "check", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"data", "=", 
      RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"unitsQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Return", " ", "density", " ", "if", " ", "contained", " ", 
       RowBox[{"in", " ", "'"}], 
       RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"data", "[", "\"\<MassDensity\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "[", "temp", "]"}]}], ",", 
       RowBox[{"Return", "@", "temp"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Lookup", " ", "formula", " ", "units"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Z", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"data", ",", "\"\<FormulaUnits\>\"", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"*", " ", "Common", " ", "variables", " ", "*", "--"}]}], 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Volume", ",", " ", 
       RowBox[{"converted", " ", "to", " ", 
        SuperscriptBox["cm", "3"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"V", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"GetCrystalMetric", "@", "crystal"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"unitsQ", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"V", "=", 
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"V", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "24"}], ")"}]}]}], ",", 
          RowBox[{"\"\<Centimeters\>\"", "^", "3"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"V", "=", 
        RowBox[{"V", "*", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "24"}], ")"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Chemical", " ", "formula"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"f", "=", 
      RowBox[{"Sort", "@", 
       RowBox[{"GetElements", "[", 
        RowBox[{"crystal", ",", 
         RowBox[{"\"\<Tally\>\"", "\[Rule]", "True"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Positive", "@", "Z"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"*", " ", 
          RowBox[{"A", ".", " ", "Calculate"}], " ", "\[Rho]", " ", "from", 
          " ", "Z", " ", "*", "--"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Atomic", " ", "mass", " ", "of", " ", "one", " ", "unit"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"MapAt", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"$PeriodicTable", "[", 
             RowBox[{"#", ",", "\"\<StandardAtomicWeight\>\""}], "]"}], "&"}],
            ",", "f", ",", 
           RowBox[{"{", 
            RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"m", "=", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Times", "@@", "#"}], "&"}], "/@", "m"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", 
          RowBox[{"m", "=", 
           RowBox[{"Quantity", "[", 
            RowBox[{"m", ",", 
             RowBox[{"\"\<Grams\>\"", "/", "\"\<Moles\>\""}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Avogadro", "'"}], "s", " ", "constant"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"NA", "=", 
           RowBox[{"UnitConvert", "[", 
            RowBox[{
             RowBox[{"Quantity", "[", "\"\<AvogadroConstant\>\"", "]"}], ",", 
             
             RowBox[{"\"\<Moles\>\"", "^", 
              RowBox[{"-", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"NA", "=", "6.022140857*^23"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculating", " ", "\[Rho]"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Z", "*", "m"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"V", "*", "NA"}], ")"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"*", " ", 
           RowBox[{"B", ".", " ", "Calculate"}], " ", "\[Rho]", " ", "from", 
           " ", "atom", " ", "data"}]}], ",", " ", 
         RowBox[{
         "symmetry", " ", "and", " ", "occupation", " ", "*", "--"}]}], 
        "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Elements", ",", " ", 
         RowBox[{
         "occupation", " ", "factors", " ", "and", " ", "coordinates"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "o", ",", "xyz"}], "}"}], "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Values", "@", 
           RowBox[{"data", "\[LeftDoubleBracket]", 
            RowBox[{
            "\"\<AtomData\>\"", ",", "All", ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Element\>\"", ",", "\"\<OccupationFactor\>\"", ",", 
               "\"\<FractionalCoordinates\>\""}], "}"}]}], 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"X", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"X", ",", 
           RowBox[{"{", 
            RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"o", "=", 
         RowBox[{"o", "/.", 
          RowBox[{"_Missing", "\[Rule]", "1."}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Site", " ", "multiplicities"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"o", "*", 
          RowBox[{"(", 
           RowBox[{"Length", "/@", 
            RowBox[{"(", 
             RowBox[{
             "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"data", "[", "\"\<SpaceGroup\>\"", "]"}], ",", "xyz"}],
               "]"}], ")"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Counting", " ", "*)"}], "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Transpose", "/@", 
          RowBox[{"GatherBy", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "M"}], "}"}], "]"}], ",", "First"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"temp", "/.", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_List", ",", "m_List"}], "}"}], "/;", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Depth", "[", "x", "]"}], "===", "2"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", "x"}], ",", 
              RowBox[{"Total", "@", "m"}]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Total", " ", "atom", " ", "mass"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"mass", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"temp", "/.", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"f", "*", 
             RowBox[{"$PeriodicTable", "[", 
              RowBox[{"X", ",", "\"\<StandardAtomicWeight\>\""}], "]"}]}]}]}],
           "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"mass", "=", 
           RowBox[{"UnitConvert", "[", 
            RowBox[{
             RowBox[{"Quantity", "[", 
              RowBox[{"mass", ",", "\"\<AtomicMassUnit\>\""}], "]"}], ",", 
             "\"\<Grams\>\""}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"mass", "=", 
           RowBox[{"mass", "*", 
            RowBox[{"(", "1.6605390*^-24", ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculated", " ", "density"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", 
         RowBox[{"mass", "/", "V"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.716820660442363*^9, 
   3.716820685815736*^9}, {3.7168211039685993`*^9, 3.716821109006166*^9}, {
   3.716830615633079*^9, 3.716830618327636*^9}, {3.7168723525405407`*^9, 
   3.716872411915575*^9}, {3.716872455943388*^9, 3.7168724908148003`*^9}, {
   3.716872521843114*^9, 3.71687252385538*^9}, {3.716872577629528*^9, 
   3.716872657249303*^9}, {3.716873424383333*^9, 3.7168734253238173`*^9}, {
   3.716875831066147*^9, 3.7168758403345203`*^9}, {3.71687598845652*^9, 
   3.716876188212364*^9}, {3.7168762240798187`*^9, 3.7168762555551567`*^9}, {
   3.716876313371727*^9, 3.716876342141617*^9}, 3.716876387653263*^9, 
   3.716876502535068*^9, {3.716882273100884*^9, 3.716882302398086*^9}, {
   3.716882337123905*^9, 3.716882390906062*^9}, {3.716882612027913*^9, 
   3.7168826456643744`*^9}, {3.7168828190363073`*^9, 3.7168828245346737`*^9}, 
   3.716882856215295*^9, {3.7168828890295563`*^9, 3.716882933256938*^9}, {
   3.716882972687499*^9, 3.716883032260762*^9}, {3.71688311198413*^9, 
   3.716883264778429*^9}, {3.716883308679512*^9, 3.7168835749552794`*^9}, {
   3.716883632940834*^9, 3.7168840031145144`*^9}, {3.716884210520874*^9, 
   3.716884210652163*^9}, {3.717740920524342*^9, 3.717740920535383*^9}, 
   3.718802985939166*^9, {3.718803060838787*^9, 3.718803063559782*^9}, {
   3.718803405559519*^9, 3.7188034070203238`*^9}, {3.718803492139349*^9, 
   3.718803535440364*^9}, {3.718803581847631*^9, 3.7188036505416613`*^9}, {
   3.7188038013472958`*^9, 3.71880383502754*^9}, {3.718803880514141*^9, 
   3.718803890530003*^9}, {3.718813986629037*^9, 3.7188140133657503`*^9}, 
   3.71881405037298*^9, {3.718814127635518*^9, 3.7188141303137074`*^9}, {
   3.727183475234785*^9, 3.727183488999466*^9}, {3.727183544971184*^9, 
   3.7271835698504457`*^9}, {3.727183693593145*^9, 3.7271837314572287`*^9}, {
   3.7271839650112953`*^9, 3.727183970889502*^9}, {3.727601443857336*^9, 
   3.727601458561569*^9}, {3.727602392050802*^9, 3.727602394273776*^9}, {
   3.727602692519127*^9, 3.7276026948129663`*^9}, {3.727602995780644*^9, 
   3.727602996062334*^9}, {3.727675178716289*^9, 3.727675193108197*^9}, {
   3.727684023346468*^9, 3.727684073022949*^9}, {3.727684186645553*^9, 
   3.727684202766356*^9}, {3.7276844252746143`*^9, 3.72768450670531*^9}, {
   3.727684548973167*^9, 3.7276845839085617`*^9}, 3.727684876953658*^9, 
   3.727685350413744*^9, {3.72768540865455*^9, 3.727685435652676*^9}, {
   3.727685480661285*^9, 3.727685542117436*^9}, {3.7276856594542713`*^9, 
   3.7276856884172983`*^9}, {3.727692698149169*^9, 3.727692707306315*^9}, {
   3.727692834250257*^9, 3.727692906376815*^9}, {3.7276929786492853`*^9, 
   3.727692980203782*^9}, {3.7276930221399384`*^9, 3.727693046129095*^9}, {
   3.727693148918601*^9, 3.727693149211893*^9}, {3.728621778539184*^9, 
   3.728621782924053*^9}, {3.728622186113776*^9, 3.728622271893846*^9}, {
   3.72862235223105*^9, 3.7286224157269497`*^9}, {3.728622453339553*^9, 
   3.728622466177504*^9}, {3.728622506850314*^9, 3.728622522978869*^9}, {
   3.728622645073794*^9, 3.728622645599676*^9}, {3.7348563059328127`*^9, 
   3.7348563062980633`*^9}, {3.7348564089570417`*^9, 3.734856437378439*^9}, {
   3.7348565671615143`*^9, 3.734856757173696*^9}, {3.734856876619206*^9, 
   3.73485688172554*^9}, {3.7348571854573812`*^9, 3.734857202421248*^9}, {
   3.734857270457114*^9, 3.7348572948255177`*^9}, {3.734857353640752*^9, 
   3.734857369807686*^9}, {3.734857408151463*^9, 3.734857479130187*^9}, {
   3.734857547078599*^9, 3.734857552801969*^9}, {3.734858177353456*^9, 
   3.734858181956397*^9}, {3.734858239776766*^9, 3.734858241200975*^9}, {
   3.7348582725413446`*^9, 3.734858305971013*^9}, {3.734858338759254*^9, 
   3.734858341795685*^9}, 3.7348586238125353`*^9, {3.73485878448272*^9, 
   3.734858803584711*^9}, {3.734858863989711*^9, 3.734858897972817*^9}, {
   3.734858964998155*^9, 3.734859089189684*^9}, {3.7348591351432734`*^9, 
   3.7348592847685947`*^9}, {3.73485936145327*^9, 3.734859387056665*^9}, 
   3.7348594871559563`*^9, {3.734859535356381*^9, 3.734859552972501*^9}, {
   3.734861188424234*^9, 3.734861190526681*^9}, {3.7348612878515387`*^9, 
   3.734861360990584*^9}, {3.734864976814739*^9, 3.734864978427362*^9}, {
   3.734865010957749*^9, 3.734865018886321*^9}, {3.734866146927218*^9, 
   3.734866171017847*^9}, {3.734866292861107*^9, 3.734866294405472*^9}, {
   3.7349803030876837`*^9, 3.734980336750393*^9}, {3.734980386742298*^9, 
   3.734980389327104*^9}, {3.734980500442094*^9, 3.734980502952849*^9}, {
   3.734980691567004*^9, 3.734980733377968*^9}, {3.735021942077931*^9, 
   3.735021954390654*^9}, {3.735022261648856*^9, 3.735022271967949*^9}, {
   3.7350261439854383`*^9, 3.7350261538299723`*^9}, {3.7350321738180323`*^9, 
   3.735032236267974*^9}, 3.73796846710369*^9, {3.743992566993113*^9, 
   3.743992567160983*^9}, {3.75852913086285*^9, 3.758529133993688*^9}, {
   3.759519250043314*^9, 3.759519250560431*^9}, {3.7614159095772753`*^9, 
   3.7614159103901653`*^9}, 3.762793093063138*^9, {3.786968122195829*^9, 
   3.786968123457449*^9}, {3.805451757550959*^9, 3.805451762632482*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[531]:=",ExpressionUUID->"fda2eaaf-64ce-437e-8d85-548684f68546"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[532]:=",ExpressionUUID->"20daf76c-312c-4261-99ee-b0325325673b"]
}, Closed]],

Cell[CellGroupData[{

Cell["CrystalFormulaUnits", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.7168206455457077`*^9, 
   3.7168206470560017`*^9}, 3.728623897643963*^9, {3.7346870945420523`*^9, 
   3.734687096227003*^9}},ExpressionUUID->"57293870-c474-4350-b77d-\
ef6b4817b285"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[533]:=",ExpressionUUID->"27054959-8bb7-4f18-b798-a7b950108569"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CrystalFormulaUnits", "::", "mismatch"}], "=", 
    "\"\<Element mismatch detected.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "CrystalFormulaUnits"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<IgnoreHydrogen\>\"", "\[Rule]", "True"}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "CrystalFormulaUnits"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.737805885604123*^9, 3.737805925525569*^9}, {
  3.741975040331805*^9, 3.741975055618403*^9}, {3.756710627240746*^9, 
  3.756710639183731*^9}},
 CellLabel->
  "In[534]:=",ExpressionUUID->"6dddff0d-92f3-4b86-b95a-ab7004ed1dc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[537]:=",ExpressionUUID->"ab42411b-6dc9-4385-a0ee-07ea0255034c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrystalFormulaUnits", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "\[IndentingNewLine]", "\[Rho]", ",", "f", ",", "fWithoutH",
       ",", "m", ",", "V", ",", "NA", ",", "\[IndentingNewLine]", "X", ",", 
      "XwithoutH", ",", "o", ",", "xyz", ",", "M", ",", "Z", ",", 
      "\[IndentingNewLine]", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Input", " ", "check", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"data", "=", 
      RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Return", " ", "Z", " ", "if", " ", "contained", " ", 
       RowBox[{"in", " ", "'"}], 
       RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"data", "[", "\"\<FormulaUnits\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "[", "temp", "]"}]}], ",", 
       RowBox[{"Return", "@", "temp"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Lookup", " ", "density"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"data", ",", "\"\<MassDensity\>\"", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Chemical", " ", "formula"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"f", "=", 
      RowBox[{"Sort", "@", 
       RowBox[{"GetElements", "[", 
        RowBox[{"crystal", ",", 
         RowBox[{"\"\<Tally\>\"", "\[Rule]", "True"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Atomic", " ", "mass", " ", "of", " ", "one", " ", "unit"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"m", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"$PeriodicTable", "[", 
          RowBox[{"#", ",", "\"\<StandardAtomicWeight\>\""}], "]"}], "&"}], 
        ",", "f", ",", 
        RowBox[{"{", 
         RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"m", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Times", "@@", "#"}], "&"}], "/@", "m"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Volume", " ", "[", 
        RowBox[{"cubic", " ", "centimeters"}], "]"}], " ", "and", " ", 
       RowBox[{"Avogadro", "'"}], "s", " ", "constant"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{"Sqrt", "@", 
        RowBox[{"Det", "@", 
         RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}], "*", 
       RowBox[{"Power", "[", 
        RowBox[{"10", ",", 
         RowBox[{"-", "24"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"NA", "=", "6.022140857*^23"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Positive", "@", "\[Rho]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"*", " ", 
          RowBox[{"A", ".", " ", "Calculate"}], " ", "Z", " ", "from", " ", 
          "mass", " ", "denisty", " ", "*", "--"}]}], "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Calculate", " ", "formula", " ", "units", " ", "from", " ", 
         "density"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"QuantityQ", "@", "\[Rho]"}], ",", 
          RowBox[{"\[Rho]", "=", 
           RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", "\t", 
            RowBox[{"UnitConvert", "[", 
             RowBox[{"\[Rho]", ",", 
              RowBox[{"\"\<Grams\>\"", "/", 
               RowBox[{"\"\<Centimeters\>\"", "^", "3"}]}]}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Calculate", " ", "formula", " ", "units", " ", "from", " ", 
          "density"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", 
         RowBox[{"\[Rho]", "*", "V", "*", 
          RowBox[{"NA", "/", "m"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"*", " ", 
           RowBox[{"B", ".", " ", "Calculate"}], " ", "Z", " ", "by", " ", 
           "counting", " ", "symmetry"}]}], "-", 
         RowBox[{"generated", " ", "atoms", " ", "*", "--"}]}], "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Elements", ",", " ", 
         RowBox[{
         "occupation", " ", "factors", " ", "and", " ", "coordinates"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "o", ",", "xyz"}], "}"}], "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Values", "@", 
           RowBox[{"data", "\[LeftDoubleBracket]", 
            RowBox[{
            "\"\<AtomData\>\"", ",", "All", ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Element\>\"", ",", "\"\<OccupationFactor\>\"", ",", 
               "\"\<FractionalCoordinates\>\""}], "}"}]}], 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"X", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"X", ",", 
           RowBox[{"{", 
            RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"XwithoutH", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"X", ",", "\"\<H\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"o", "=", 
         RowBox[{"o", "/.", 
          RowBox[{"_Missing", "\[Rule]", "1."}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"fWithoutH", "=", 
         RowBox[{"Sort", "@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"f", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            "\"\<H\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", ":", " ", 
          RowBox[{
          "Compare", " ", "formula", " ", "and", " ", "atom", " ", "data"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"TrueQ", "@", 
            RowBox[{"OptionValue", "[", "\"\<IgnoreHydrogen\>\"", "]"}]}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"fWithoutH", "=", "f"}], ";", 
           RowBox[{"XwithoutH", "=", "X"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "@", 
            RowBox[{"DeleteDuplicates", "@", "XwithoutH"}]}], "=!=", 
           "fWithoutH"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"CrystalFormulaUnits", "::", "mismatch"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Site", " ", "multiplicities"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"o", "*", 
          RowBox[{"(", 
           RowBox[{"Length", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
               "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"data", "[", "\"\<SpaceGroup\>\"", "]"}], ",", "#"}],
                 "]"}], "&"}], "/@", "xyz"}], ")"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Counting", " ", "*)"}], "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Transpose", "/@", 
          RowBox[{"GatherBy", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "M"}], "}"}], "]"}], ",", "First"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"temp", "/.", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_List", ",", "m_List"}], "}"}], "/;", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Depth", "[", "x", "]"}], "===", "2"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", "x"}], ",", 
              RowBox[{"Round", "@", 
               RowBox[{"Total", "@", "m"}]}]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Check", " ", "if", " ", "hydrogen", " ", "is", " ", "ignored"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"f", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<H\>\"", ",", "_"}], "}"}]}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"temp", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<H\>\"", ",", "_"}], "}"}]}], "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"f", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"f", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<H\>\"", ",", "_"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"temp", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"temp", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<H\>\"", ",", "_"}], "}"}]}], "]"}]}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "agreement", " ", 
          RowBox[{"of", " ", "'"}], 
          RowBox[{"Z", "'"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", "\t", 
        RowBox[{"Z", "=", 
         RowBox[{
          RowBox[{"temp", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "/", 
          RowBox[{"f", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"a", ".", " ", "Common"}], " ", "integer", " ", "factor"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicates", "@", "Z"}], ",", 
            RowBox[{"{", "_Integer", "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Return", "@", 
           RowBox[{"First", "@", "Z"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"b", ".", " ", "Calculate"}], " ", "density"}], ",", " ", 
            RowBox[{"then", " ", "find", " ", "Z"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"\[Rho]", "=", 
            RowBox[{"CrystalDensity", "[", 
             RowBox[{"crystal", ",", 
              RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Z", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Rho]", "*", "V", "*", "NA"}], ")"}], "/", 
             RowBox[{"(", "m", ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
           
           RowBox[{"Return", "@", "Z"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.716820660442363*^9, 
   3.716820685815736*^9}, {3.7168211039685993`*^9, 3.716821109006166*^9}, {
   3.716830615633079*^9, 3.716830618327636*^9}, {3.7168723525405407`*^9, 
   3.716872411915575*^9}, {3.716872455943388*^9, 3.7168724908148003`*^9}, {
   3.716872521843114*^9, 3.71687252385538*^9}, {3.716872577629528*^9, 
   3.716872657249303*^9}, {3.716873424383333*^9, 3.7168734253238173`*^9}, {
   3.716875831066147*^9, 3.7168758403345203`*^9}, {3.71687598845652*^9, 
   3.716876188212364*^9}, {3.7168762240798187`*^9, 3.7168762555551567`*^9}, {
   3.716876313371727*^9, 3.716876342141617*^9}, 3.716876387653263*^9, 
   3.716876502535068*^9, {3.716882273100884*^9, 3.716882302398086*^9}, {
   3.716882337123905*^9, 3.716882390906062*^9}, {3.716882612027913*^9, 
   3.7168826456643744`*^9}, {3.7168828190363073`*^9, 3.7168828245346737`*^9}, 
   3.716882856215295*^9, {3.7168828890295563`*^9, 3.716882933256938*^9}, {
   3.716882972687499*^9, 3.716883032260762*^9}, {3.71688311198413*^9, 
   3.716883264778429*^9}, {3.716883308679512*^9, 3.7168835749552794`*^9}, {
   3.716883632940834*^9, 3.7168840031145144`*^9}, {3.716884210520874*^9, 
   3.716884210652163*^9}, {3.717740920524342*^9, 3.717740920535383*^9}, 
   3.718802985939166*^9, {3.718803060838787*^9, 3.718803063559782*^9}, {
   3.718803405559519*^9, 3.7188034070203238`*^9}, {3.718803492139349*^9, 
   3.718803535440364*^9}, {3.718803581847631*^9, 3.7188036505416613`*^9}, {
   3.7188038013472958`*^9, 3.71880383502754*^9}, {3.718803880514141*^9, 
   3.718803890530003*^9}, {3.718813986629037*^9, 3.7188140133657503`*^9}, 
   3.71881405037298*^9, {3.718814127635518*^9, 3.7188141303137074`*^9}, {
   3.727183475234785*^9, 3.727183488999466*^9}, {3.727183544971184*^9, 
   3.7271835698504457`*^9}, {3.727183693593145*^9, 3.7271837314572287`*^9}, {
   3.7271839650112953`*^9, 3.727183970889502*^9}, {3.727601443857336*^9, 
   3.727601458561569*^9}, {3.727602392050802*^9, 3.727602394273776*^9}, {
   3.727602692519127*^9, 3.7276026948129663`*^9}, {3.727602995780644*^9, 
   3.727602996062334*^9}, {3.727675178716289*^9, 3.727675193108197*^9}, {
   3.727684023346468*^9, 3.727684073022949*^9}, {3.727684186645553*^9, 
   3.727684202766356*^9}, {3.7276844252746143`*^9, 3.72768450670531*^9}, {
   3.727684548973167*^9, 3.7276845839085617`*^9}, 3.727684876953658*^9, 
   3.727685350413744*^9, {3.72768540865455*^9, 3.727685435652676*^9}, {
   3.727685480661285*^9, 3.727685542117436*^9}, {3.7276856594542713`*^9, 
   3.7276856884172983`*^9}, {3.727692698149169*^9, 3.727692707306315*^9}, {
   3.727692834250257*^9, 3.727692906376815*^9}, {3.7276929786492853`*^9, 
   3.727692980203782*^9}, {3.7276930221399384`*^9, 3.727693046129095*^9}, {
   3.727693148918601*^9, 3.727693149211893*^9}, {3.728621778539184*^9, 
   3.728621782924053*^9}, {3.728622186113776*^9, 3.728622271893846*^9}, {
   3.72862235223105*^9, 3.7286224157269497`*^9}, {3.728622453339553*^9, 
   3.728622466177504*^9}, {3.728622506850314*^9, 3.728622522978869*^9}, {
   3.728622645073794*^9, 3.728622645599676*^9}, {3.734687161906055*^9, 
   3.734687217425891*^9}, {3.734687257890682*^9, 3.734687269073254*^9}, {
   3.7346873666232443`*^9, 3.734687378098473*^9}, {3.734687514276444*^9, 
   3.734687542244218*^9}, {3.7346875859643993`*^9, 3.734687637851782*^9}, {
   3.7346878058770742`*^9, 3.7346878739433107`*^9}, {3.7346880727092648`*^9, 
   3.734688101082307*^9}, {3.734688520984953*^9, 3.734688557609003*^9}, {
   3.734688994670887*^9, 3.734689087888377*^9}, {3.734689126226308*^9, 
   3.7346892507199697`*^9}, {3.734689482004064*^9, 3.734689498298815*^9}, {
   3.73468958503522*^9, 3.734689615402967*^9}, {3.7346934629159603`*^9, 
   3.734693524738729*^9}, {3.734693563412406*^9, 3.734693711618286*^9}, {
   3.73469376053473*^9, 3.734693773730814*^9}, {3.7346938276192007`*^9, 
   3.734693886766075*^9}, {3.734693984030326*^9, 3.73469399856791*^9}, 
   3.734694087288121*^9, {3.734694142746725*^9, 3.734694154890108*^9}, {
   3.734769499710103*^9, 3.734769500083959*^9}, {3.734769540613845*^9, 
   3.734769554408991*^9}, {3.734769586464767*^9, 3.734769589151436*^9}, {
   3.734769629663395*^9, 3.73476965169698*^9}, {3.734769715671834*^9, 
   3.734769846125445*^9}, {3.734769933213776*^9, 3.734770014852292*^9}, {
   3.734770102155918*^9, 3.734770330015541*^9}, {3.734770363793829*^9, 
   3.734770376119488*^9}, {3.734770460743085*^9, 3.7347705412786007`*^9}, 
   3.734770833364869*^9, {3.734771295662282*^9, 3.734771298905621*^9}, {
   3.734771355342614*^9, 3.734771376951448*^9}, {3.734771416643319*^9, 
   3.7347714201074123`*^9}, {3.734771462129858*^9, 3.734771549654381*^9}, {
   3.7347921822384567`*^9, 3.734792256849484*^9}, {3.73479232636942*^9, 
   3.734792382382332*^9}, {3.7347926123147697`*^9, 3.7347926579128036`*^9}, {
   3.734792978195539*^9, 3.734792979801667*^9}, {3.734793537514904*^9, 
   3.734793562490337*^9}, {3.734793597033834*^9, 3.734793623362172*^9}, 
   3.734858146264872*^9, {3.735011928068985*^9, 3.735011929283972*^9}, {
   3.735022129174734*^9, 3.735022193859498*^9}, {3.735022236294388*^9, 
   3.7350222386909637`*^9}, {3.735022362318347*^9, 3.73502236523523*^9}, {
   3.735022411408517*^9, 3.7350224189611883`*^9}, {3.735022465054412*^9, 
   3.735022467889464*^9}, {3.735022502700996*^9, 3.735022530643366*^9}, {
   3.735023050990794*^9, 3.735023091343*^9}, {3.735023520292654*^9, 
   3.735023551142185*^9}, {3.735023593525428*^9, 3.735023619244958*^9}, {
   3.735024057638631*^9, 3.735024068726115*^9}, {3.735024959957273*^9, 
   3.735025120448887*^9}, {3.735025150867716*^9, 3.735025174485404*^9}, {
   3.735025282361462*^9, 3.735025311210437*^9}, {3.7350259055999126`*^9, 
   3.735026063672041*^9}, {3.735029542639955*^9, 3.7350295980897417`*^9}, {
   3.735029676721942*^9, 3.735029698911381*^9}, {3.735029756566386*^9, 
   3.7350297728322973`*^9}, {3.735029888413373*^9, 3.735029907658907*^9}, {
   3.7350300564679127`*^9, 3.7350300717479057`*^9}, 3.735030153130424*^9, {
   3.735032196089965*^9, 3.735032196711657*^9}, {3.737383693857211*^9, 
   3.737383756273583*^9}, {3.737383807902457*^9, 3.737383870451847*^9}, 
   3.737383909310376*^9, {3.7373845299832*^9, 3.73738466988605*^9}, {
   3.73738525214216*^9, 3.7373853094049673`*^9}, {3.737385357710146*^9, 
   3.737385373731523*^9}, 3.7373854098122387`*^9, {3.737805750049411*^9, 
   3.737805752159295*^9}, {3.737805783541308*^9, 3.737805878479924*^9}, {
   3.737806032042493*^9, 3.737806059430818*^9}, {3.737806185170886*^9, 
   3.737806240375677*^9}, {3.737806924291636*^9, 3.737806930594109*^9}, 
   3.7379684672079782`*^9, {3.74197308608463*^9, 3.7419730888570223`*^9}, 
   3.741973119779772*^9, {3.741973154475752*^9, 3.7419731547844553`*^9}, {
   3.7419732476803417`*^9, 3.741973283222967*^9}, {3.741973874439253*^9, 
   3.741973884643847*^9}, {3.74197406937014*^9, 3.741974070396022*^9}, {
   3.741974163219123*^9, 3.741974184939254*^9}, {3.7419743811728487`*^9, 
   3.741974383613929*^9}, {3.741974888452097*^9, 3.74197489089786*^9}, {
   3.741974952634684*^9, 3.741975000939262*^9}, {3.7419750698089027`*^9, 
   3.741975096285943*^9}, {3.741975128647184*^9, 3.7419751773726797`*^9}, {
   3.74197521584503*^9, 3.7419752326027412`*^9}, {3.7419752682037497`*^9, 
   3.7419752722415667`*^9}, {3.75852916086429*^9, 3.758529174529024*^9}, {
   3.7585292144704723`*^9, 3.7585292212840548`*^9}, {3.759519265267476*^9, 
   3.759519268584622*^9}, 3.7627930930877943`*^9, {3.7869679748950367`*^9, 
   3.786967976309065*^9}, 3.805451771261895*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[538]:=",ExpressionUUID->"edca1e99-40e2-4982-a6ab-6324cec7bcb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[539]:=",ExpressionUUID->"ff193bcc-6cba-46ee-9c07-9c80cf2790a2"]
}, Closed]],

Cell[CellGroupData[{

Cell["CrystalPlot", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.760949325114046*^9, 
   3.760949327267449*^9}},ExpressionUUID->"8f03f773-2569-442d-9a0e-\
f2c89bcd6ff7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[19]:=",ExpressionUUID->"27776e0b-3bc2-43a1-bbad-65ae8fb04ff4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CrystalPlot", "::", "InvalidMethod"}], "=", 
   "\"\<\\\"AtomSizeMethod\\\" must either be \\\"RadiusTable\\\" or \
\\\"DisplacementParameters\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CrystalPlot", "::", "InvalidDisplay"}], "=", 
   "\"\<\\\"UnitCell\\\" must be either \\\"Box\\\", \\\"Axes\\\" or \\\"None\
\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CrystalPlot", "::", "InvalidOpacityMap"}], "=", 
   "\"\<Keys of \\\"OpacityMap\\\" must be \\\"Host\\\", \\\"Guest\\\" or a \
chemical element, which was not the case for: `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CrystalPlot", "::", "InvalidAtomRadiusType"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid setting for \
\\\"AtomRadiusType\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CrystalPlot", "::", "NoAtomData"}], "=", 
    "\"\<\[LeftGuillemet]`1`\[RightGuillemet] does not contain any atom data.\
\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "CrystalPlot"}], "=", 
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"Union", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Association", "@", 
          RowBox[{"Options", "@", "Graphics3D"}]}], ",", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "\"\<AtomRadiusType\>\"", "\[Rule]", "\"\<CovalentRadius\>\""}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<AxisFunction\>\"", "\[Rule]", "Line"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<Ellipsoids\>\"", "\[Rule]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<OpacityMap\>\"", "\[Rule]", 
            RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<RGBStyle\>\"", "\[Rule]", "True"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<StructureSize\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<UnitCellDisplay\>\"", "\[Rule]", "\"\<Box\>\""}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Graphics3D", " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], 
          "\[IndentingNewLine]", "|>"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "CrystalPlot"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{"CrystalPlot", ",", "Graphics3D"}], "}"}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
   3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
   3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
   3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
   3.756710476208014*^9}, {3.760949332541236*^9, 3.76094933494974*^9}, {
   3.760949380424467*^9, 3.760949410672333*^9}, {3.761219705413692*^9, 
   3.761219710240984*^9}, {3.7612247494336042`*^9, 3.761224756985135*^9}, {
   3.761224890775395*^9, 3.7612248941088247`*^9}, {3.761224984701357*^9, 
   3.761225001539753*^9}, {3.7612251566896276`*^9, 3.761225158190507*^9}, {
   3.761248071523448*^9, 3.76124807230606*^9}, {3.761420022003708*^9, 
   3.761420058067872*^9}, 3.761420150574994*^9, {3.761420575838612*^9, 
   3.761420581179722*^9}, {3.761420631045661*^9, 3.76142063333079*^9}, {
   3.761421062468348*^9, 3.76142112730361*^9}, {3.761421272125429*^9, 
   3.7614213082038097`*^9}, {3.761421397884313*^9, 3.761421417345962*^9}, {
   3.7741829500904083`*^9, 3.774182956320072*^9}, {3.7741830656066933`*^9, 
   3.774183074645957*^9}, {3.7808237944516973`*^9, 3.780823794609888*^9}, {
   3.802697098058589*^9, 3.802697113017457*^9}, {3.802697368025024*^9, 
   3.8026974166473503`*^9}, {3.802697538286684*^9, 3.802697555699584*^9}, {
   3.802697638040058*^9, 3.8026976482245693`*^9}, {3.802697984927258*^9, 
   3.802698017013364*^9}, 3.802698444293851*^9, {3.802699206520279*^9, 
   3.802699264988562*^9}, {3.8026993202114067`*^9, 3.802699329610841*^9}, {
   3.8026993987697*^9, 3.802699410633287*^9}, 3.802699475432611*^9, {
   3.802704158266218*^9, 3.802704159880855*^9}, {3.805443368526494*^9, 
   3.805443396142654*^9}, {3.805443545572076*^9, 3.805443571447988*^9}, {
   3.829135364196486*^9, 3.829135369462446*^9}, {3.8292755324639807`*^9, 
   3.829275532946104*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"b511f743-2f0d-469c-9e90-0e3127b45ea6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[27]:=",ExpressionUUID->"0d7d8ec3-6e8b-482f-ac3f-dc13540748d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrystalPlot", "[", "\[IndentingNewLine]", 
   RowBox[{"crystalInput_String", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"CrystalPlot", ",", "Graphics3D"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"crystal", "=", "crystalInput"}], ",", "opacityKeysCheck", ",", 
      
      RowBox[{"useEllipsoids", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<Ellipsoids\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"crystalDataOriginal", "=", "$CrystalData"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"structureSize", "=", 
       RowBox[{"OptionValue", "[", "\"\<StructureSize\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rgbStyle", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<RGBStyle\>\"", "]"}]}]}], ",", 
      "latticeStyleList", ",", "CreateBoxEdges", ",", "toCartesianMatrix", 
      ",", "toCartesianMatrixTransposed", ",", "cartesianADPconverter", ",", 
      "\[IndentingNewLine]", "MakeRadiusFromElement", ",", 
      "MakeRadiusFromADPs", ",", "MakeSemiaxesFromADPs", ",", "shapeFunction",
       ",", "extentFunction", ",", "MakeAtomObject", ",", 
      "\[IndentingNewLine]", "FlattenSphereList", ",", "\[IndentingNewLine]", 
      
      RowBox[{"atomRadiusType", "=", 
       RowBox[{"OptionValue", "[", "\"\<AtomRadiusType\>\"", "]"}]}], ",", 
      "atomRadii", ",", "\[IndentingNewLine]", 
      RowBox[{"latticePlotFunction", "=", 
       RowBox[{"OptionValue", "[", "\"\<AxisFunction\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "atomData", ",", "atoms", ",", 
      "\[IndentingNewLine]", "basisArrowCoordinates", ",", "translations", 
      ",", "coordinatePairs", ",", "unitCellPlotData", ",", 
      RowBox[{"unitCellDisplay", "=", 
       RowBox[{"OptionValue", "[", "\"\<UnitCellDisplay\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"opacityMap", "=", 
       RowBox[{"OptionValue", "[", "\"\<OpacityMap\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "plotOptions"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Checks", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"$CrystalData", "[", "crystal", "]"}], ",", 
          "\"\<AtomData\>\"", ",", 
          RowBox[{"{", "}"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CrystalPlot", "::", "NoAtomData"}], ",", "crystal"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"opacityKeysCheck", "=", 
      RowBox[{"Complement", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Keys", "@", "opacityMap"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Keys", "@", "$PeriodicTable"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Host\>\"", ",", "\"\<Guest\>\""}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"opacityKeysCheck", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CrystalPlot", "::", "InvalidOpacityMap"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringDelete", "[", 
           RowBox[{
            RowBox[{"ToString", "@", "opacityKeysCheck"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<{\>\"", ",", "\"\<}\>\""}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Expand", " ", "crystal"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"structureSize", "=!=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandCrystal", "[", 
         RowBox[{"crystalInput", ",", "structureSize", ",", 
          RowBox[{"\"\<StoreTemporarily\>\"", "\[Rule]", "True"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"crystal", "=", 
         RowBox[{"First", "@", 
          RowBox[{"Keys", "@", "MaXrd`Private`$TempCrystalData"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$CrystalData", "=", "MaXrd`Private`$TempCrystalData"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Auxiliary", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"atomRadii", "=", 
      RowBox[{"$AtomRadii", "@", "atomRadiusType"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "@", "atomRadii"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CrystalPlot", "::", "InvalidAtomRadiusType"}], ",", 
          "atomRadiusType"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"latticeStyleList", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"Black", ",", "12"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"rgbStyle", ",", 
       RowBox[{
        RowBox[{"latticeStyleList", "\[LeftDoubleBracket]", 
         RowBox[{";;", "3"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"{", 
         RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CreateBoxEdges", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t1_", ",", "t2_", ",", "t3_"}], "}"}]}], "]"}], ":=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"a", ",", "b", ",", "c", ",", "\[IndentingNewLine]", 
        RowBox[{"t2", "[", "a", "]"}], ",", 
        RowBox[{"t1", "[", "b", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"t1", "[", "c", "]"}], ",", 
        RowBox[{"t2", "[", "c", "]"}], ",", 
        RowBox[{"t1", "[", 
         RowBox[{"t2", "[", "c", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"t3", "[", "a", "]"}], ",", 
        RowBox[{"t3", "[", "b", "]"}], ",", 
        RowBox[{"t3", "[", 
         RowBox[{"t2", "[", "a", "]"}], "]"}], ",", 
        RowBox[{"t3", "[", 
         RowBox[{"t1", "[", "b", "]"}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"toCartesianMatrix", "=", 
      RowBox[{"GetCrystalMetric", "[", 
       RowBox[{"crystal", ",", 
        RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toCartesianMatrixTransposed", "=", 
      RowBox[{"Transpose", "@", "toCartesianMatrix"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cartesianADPconverter", "=", 
      RowBox[{
      "TransformAtomicDisplacementParameters", "[", "\[IndentingNewLine]", 
       RowBox[{"crystal", ",", "\"\<CartesianConverter\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeRadiusFromElement", "[", "element_", "]"}], ":=", 
      RowBox[{"atomRadii", "@", "element"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeSemiaxesFromADPs", "[", "ADPs_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "@", "ADPs"}], ",", "\[IndentingNewLine]", 
          RowBox[{"2.36597", "*", "#"}], ",", "#"}], "]"}], "&"}], "@", 
       RowBox[{"cartesianADPconverter", "@", "ADPs"}]}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"2.36597", " ", "=", " ", 
       RowBox[{"InverseCDF", "[", 
        RowBox[{
         RowBox[{"ChiSquareDistribution", "@", "3"}], ",", "0.5"}], "]"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"X", "=", 
        RowBox[{"1.5382", "*", "X"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"shapeFunction", ",", "extentFunction"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"useEllipsoids", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Ellipsoid", ",", "MakeSemiaxesFromADPs"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Sphere", ",", "MakeRadiusFromElement"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeAtomObject", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"element_", ",", "xyz_", ",", "opacityTag_", ",", "ADPs_"}], 
         "}"}], ",", 
        RowBox[{"makeSpheresOnly_", ":", "False"}]}], "]"}], ":=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<Atoms\>\"", "]"}], "[", "element", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Opacity", "@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"opacityMap", ",", "element"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"opacityMap", "@", "element"}], ",", 
           RowBox[{"Lookup", "[", 
            RowBox[{"opacityMap", ",", "opacityTag", ",", "1.0"}], "]"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"shapeFunction", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"toCartesianMatrix", ".", "xyz"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"extentFunction", "@", 
           RowBox[{"If", "[", 
            RowBox[{"makeSpheresOnly", ",", "element", ",", "ADPs"}], 
            "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FlattenSphereList", "[", "spheres_List", "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"allCoordinates", ",", "representant", ",", "radius"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"allCoordinates", "=", 
          RowBox[{"spheres", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"representant", "=", 
          RowBox[{"First", "@", "spheres"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"radius", "=", 
          RowBox[{"representant", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "representant", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"Sphere", "[", 
           RowBox[{"allCoordinates", ",", "radius"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "representant"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "atom", " ", 
       RowBox[{"spheres", "/", "ellipsoids"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"atomData", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"$CrystalData", "[", 
         RowBox[{"crystal", ",", "\"\<AtomData\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Element\>\"", ",", "\"\<FractionalCoordinates\>\"", ",", 
          "\"\<Component\>\"", ",", "\"\<DisplacementParameters\>\""}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DeleteMissing", "/@", "atomData"}], "===", 
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "No"}], " ", "atom", " ", "content"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"atoms", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Regular"}], " ", "procedure"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"atomData", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{
           RowBox[{"atomData", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<+\>\"", ",", "\"\<-\>\"", ",", "DigitCharacter"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"atoms", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"MakeAtomObject", "[", 
            RowBox[{"#", ",", 
             RowBox[{"!", "useEllipsoids"}]}], "]"}], "&"}], "/@", 
          "atomData"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "useEllipsoids"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"atoms", "=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{"atoms", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{"#", "\[LeftDoubleBracket]", 
                  RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}],
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"atoms", "=", 
            RowBox[{"FlattenSphereList", "/@", "atoms"}]}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Basis", "/", "lattice"}], " ", "vectors", " ", "and", " ", 
       "boxes"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"basisArrowCoordinates", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "#"}], "}"}], "&"}],
        "/@", "toCartesianMatrixTransposed"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"translations", "=", 
      RowBox[{"TranslationTransform", "/@", "toCartesianMatrixTransposed"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"unitCellDisplay", "===", "\"\<Box\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coordinatePairs", "=", 
         RowBox[{"CreateBoxEdges", "[", "\[IndentingNewLine]", 
          RowBox[{"basisArrowCoordinates", ",", "translations"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"unitCellPlotData", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "latticeStyleList", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", ">", "3"}], ",", "#", ",", 
                 RowBox[{"Arrow", "@", "#"}]}], "]"}], "&"}], "@", 
              RowBox[{"latticePlotFunction", "@", 
               RowBox[{
               "coordinatePairs", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "coordinatePairs"}]}], "}"}]}], "]"}]}]}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"unitCellDisplay", "===", "\"\<Axes\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitCellPlotData", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"rgbStyle", ",", 
             RowBox[{"{", 
              RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"Black", ",", "3"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Arrow", "[", 
              RowBox[{"latticePlotFunction", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "#"}], "}"}],
                "]"}], "]"}], "&"}], "/@", "toCartesianMatrixTransposed"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"unitCellDisplay", "===", "\"\<None\>\""}], ",", 
       RowBox[{"unitCellPlotData", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"CrystalPlot", "::", "InvalidDisplay"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "crystal", " ", "was", " ", "expanded"}], ",", " ", 
       
       RowBox[{
       "reset", " ", "pointer", " ", "to", " ", "original", " ", 
        "$CrystalData"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"structureSize", "=!=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"$CrystalData", "=", "crystalDataOriginal"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plot", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"plotOptions", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Rule]", 
            RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Keys", "@", 
            RowBox[{"Options", "@", "CrystalPlot"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Options", "@", "Graphics3D"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Trigonal\>\"", ",", "\"\<Hexagonal\>\""}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"GetSymmetryData", "[", 
           RowBox[{"crystal", ",", "\"\<CrystalSystem\>\""}], "]"}]}], "]"}], 
        "&&", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<ViewPoint\>\"", "]"}], "===", 
         RowBox[{"OptionValue", "[", 
          RowBox[{"Graphics3D", ",", "ViewPoint"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AssociateTo", "[", 
         RowBox[{"plotOptions", ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Infinity]"}], "}"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"plotOptions", ",", 
          RowBox[{"ViewAngle", "\[Rule]", 
           RowBox[{"90", "\[Degree]"}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Plot", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"unitCellPlotData", ",", "atoms"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"Normal", "@", "plotOptions"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, 3.76094933831287*^9, 3.760949768973755*^9, {
   3.760984978066174*^9, 3.7609849782261057`*^9}, {3.7610413931761417`*^9, 
   3.761041413115313*^9}, {3.7610430860478983`*^9, 3.7610431431331463`*^9}, {
   3.761043822654356*^9, 3.761043826973112*^9}, {3.761043893872447*^9, 
   3.761043898359037*^9}, {3.761044578275333*^9, 3.761044579754964*^9}, {
   3.7610446519140987`*^9, 3.761044667819563*^9}, {3.7610449333385572`*^9, 
   3.761044933528962*^9}, {3.7611974752311287`*^9, 3.761197475395208*^9}, {
   3.761219720280757*^9, 3.761219720443687*^9}, 3.761219760708205*^9, {
   3.761219796192238*^9, 3.7612197966864157`*^9}, {3.761219880749118*^9, 
   3.761219917954582*^9}, {3.761219960450508*^9, 3.7612200276284847`*^9}, {
   3.761224270635038*^9, 3.7612242859363613`*^9}, {3.761224435792968*^9, 
   3.761224514091919*^9}, {3.7612246251383038`*^9, 3.761224733520315*^9}, {
   3.7612247722712793`*^9, 3.7612247764965963`*^9}, {3.7612248619479227`*^9, 
   3.761224879595311*^9}, {3.761224939212246*^9, 3.761224954897791*^9}, {
   3.7612250096029873`*^9, 3.761225024755363*^9}, 3.761225176113929*^9, {
   3.761226846793069*^9, 3.7612268777377367`*^9}, {3.761227986802516*^9, 
   3.761228018391322*^9}, {3.761244339357354*^9, 3.76124434274603*^9}, 
   3.761248076651359*^9, {3.761292747306129*^9, 3.761292752007421*^9}, {
   3.761292977932835*^9, 3.761293024578326*^9}, {3.761293056358447*^9, 
   3.761293066399618*^9}, 3.761293295578657*^9, {3.761293335488833*^9, 
   3.761293348363126*^9}, {3.761419025091445*^9, 3.761419128815998*^9}, {
   3.761419290964973*^9, 3.761419324809844*^9}, {3.7614193646659527`*^9, 
   3.761419374607725*^9}, {3.7614194094188557`*^9, 3.7614194224946833`*^9}, {
   3.761419540623413*^9, 3.761419714969212*^9}, {3.761419776545178*^9, 
   3.761419777511207*^9}, {3.7614199906197853`*^9, 3.761420000178577*^9}, {
   3.761420075498897*^9, 3.76142016521384*^9}, {3.761420687690447*^9, 
   3.761420717697867*^9}, {3.761421340825123*^9, 3.761421341388412*^9}, {
   3.7614218142311163`*^9, 3.76142187284282*^9}, 3.7614219059472637`*^9, {
   3.761422006897604*^9, 3.7614220684956284`*^9}, {3.761422135599387*^9, 
   3.761422250331128*^9}, {3.76142233220479*^9, 3.761422392600257*^9}, {
   3.761423510368361*^9, 3.7614235128850393`*^9}, 3.761423588080277*^9, 
   3.762793093125334*^9, {3.763795598026209*^9, 3.763795604168119*^9}, {
   3.7637957478383007`*^9, 3.763795785644519*^9}, {3.763795840509068*^9, 
   3.763795852858042*^9}, {3.78082380277636*^9, 3.780823813678226*^9}, {
   3.786968127926214*^9, 3.7869681291239653`*^9}, {3.802484708108547*^9, 
   3.802484718035901*^9}, {3.8026291553222218`*^9, 3.8026291554598227`*^9}, {
   3.802629190471525*^9, 3.8026292211377697`*^9}, {3.802630944420762*^9, 
   3.802630944653728*^9}, {3.802666763279166*^9, 3.8026667674351807`*^9}, {
   3.8026668415239983`*^9, 3.8026668497990837`*^9}, 3.802666953513707*^9, 
   3.802667039474736*^9, 3.802667097164507*^9, {3.802667148821329*^9, 
   3.802667151666338*^9}, {3.802675688111014*^9, 3.802675691509973*^9}, {
   3.8026758959841967`*^9, 3.802675997395389*^9}, {3.802676031756215*^9, 
   3.80267604977824*^9}, {3.802676079928746*^9, 3.802676095027589*^9}, {
   3.802676140617611*^9, 3.8026761432583027`*^9}, {3.802676391840394*^9, 
   3.802676431347678*^9}, {3.802696950599875*^9, 3.8026970928888273`*^9}, {
   3.802697431986003*^9, 3.802697526892215*^9}, {3.8026976660865707`*^9, 
   3.802697713157123*^9}, {3.802697998534004*^9, 3.8026980073354187`*^9}, {
   3.8026980388917923`*^9, 3.802698067027503*^9}, {3.802698464070364*^9, 
   3.802698520557004*^9}, {3.802698586610416*^9, 3.8026986287418756`*^9}, {
   3.80269874501525*^9, 3.802698785395142*^9}, {3.80269885711828*^9, 
   3.802698886614769*^9}, {3.802698953847685*^9, 3.802698956363974*^9}, {
   3.802699171191967*^9, 3.802699175155449*^9}, {3.8026992716326323`*^9, 
   3.8026993099443817`*^9}, {3.80269938294464*^9, 3.802699384687069*^9}, {
   3.802699432232874*^9, 3.802699481215476*^9}, {3.8026996419717197`*^9, 
   3.802699651779251*^9}, {3.8026997372274017`*^9, 3.802699777154406*^9}, {
   3.80269990629781*^9, 3.8026999824438868`*^9}, {3.802700023580497*^9, 
   3.802700023750852*^9}, {3.802700081464704*^9, 3.802700081941544*^9}, {
   3.8027001334756193`*^9, 3.8027002312053022`*^9}, {3.802700289307375*^9, 
   3.802700305506324*^9}, {3.802700335510912*^9, 3.8027005284985847`*^9}, {
   3.8027005693727713`*^9, 3.8027005784893713`*^9}, {3.802700632501647*^9, 
   3.802700643775036*^9}, {3.8027007095575113`*^9, 3.802700833796548*^9}, {
   3.8027019398589907`*^9, 3.802701955170393*^9}, {3.802702171951129*^9, 
   3.8027022057007523`*^9}, {3.802702294439208*^9, 3.80270232366968*^9}, {
   3.802702423963808*^9, 3.8027024448922663`*^9}, {3.802702499773677*^9, 
   3.802702514018312*^9}, {3.8027026782508507`*^9, 3.8027027275873737`*^9}, {
   3.802702835896628*^9, 3.802702854454877*^9}, {3.8027037799959784`*^9, 
   3.802703780240655*^9}, {3.8027038195490713`*^9, 3.802703827705442*^9}, {
   3.8027038824177923`*^9, 3.8027039379471684`*^9}, {3.802712080240498*^9, 
   3.8027120826291428`*^9}, 3.8027122530077753`*^9, {3.802712878552799*^9, 
   3.8027128971323833`*^9}, {3.802713362037744*^9, 3.802713362888157*^9}, {
   3.804410291057863*^9, 3.804410318768835*^9}, {3.804410349702424*^9, 
   3.804410350592589*^9}, {3.8054434964732437`*^9, 3.805443522962919*^9}, {
   3.805443565819339*^9, 3.805443566717695*^9}, {3.807986903904312*^9, 
   3.8079869230154333`*^9}, {3.807986954593642*^9, 3.8079869832530527`*^9}, {
   3.807987055271224*^9, 3.807987095882872*^9}, {3.829135474112577*^9, 
   3.829135479312687*^9}, {3.829135866647332*^9, 3.829135873721319*^9}, 
   3.8291359194808702`*^9, {3.8291359669407988`*^9, 3.829135983701188*^9}, 
   3.829136053523305*^9, {3.829136111417062*^9, 3.829136111583749*^9}, {
   3.8291361525098457`*^9, 3.829136155390767*^9}, {3.829136300502635*^9, 
   3.829136403377021*^9}, {3.829136542856743*^9, 3.829136563389483*^9}, {
   3.829136679871915*^9, 3.8291367168536167`*^9}, {3.8291367651909437`*^9, 
   3.8291367680976553`*^9}, {3.82913687174998*^9, 3.8291369936675797`*^9}, {
   3.829144453850665*^9, 3.829144459106696*^9}, 3.829144664124247*^9, {
   3.829144813530683*^9, 3.829144818118712*^9}, {3.829144860701685*^9, 
   3.829144894984788*^9}, {3.829145313022416*^9, 3.829145337013925*^9}, {
   3.829145387144754*^9, 3.829145402892374*^9}, {3.829145433189423*^9, 
   3.829145484419211*^9}, {3.829145520734646*^9, 3.829145630839534*^9}, {
   3.829145677257882*^9, 3.8291457448010674`*^9}, {3.829145789407584*^9, 
   3.829145827545981*^9}, {3.829145882279159*^9, 3.82914588437693*^9}, {
   3.82914628978397*^9, 3.8291463611298103`*^9}, {3.829146480846692*^9, 
   3.829146521976386*^9}, {3.829146557304842*^9, 3.829146672240868*^9}, {
   3.8291467315220203`*^9, 3.829146753853475*^9}, {3.829146819778351*^9, 
   3.82914684771354*^9}, {3.829146924312683*^9, 3.8291469419262733`*^9}, {
   3.829146989515245*^9, 3.829147027158252*^9}, {3.829147059162808*^9, 
   3.8291472894253397`*^9}, {3.8291473661277533`*^9, 3.829147366964712*^9}, {
   3.829147410663477*^9, 3.829147414760182*^9}, {3.829147733940523*^9, 
   3.829147796137689*^9}, {3.8291478269454308`*^9, 3.829147827232915*^9}, {
   3.8291478662463713`*^9, 3.829147876869204*^9}, 3.82914791822965*^9, {
   3.829147948955357*^9, 3.829147995890658*^9}, {3.8291480486163273`*^9, 
   3.829148117315915*^9}, {3.829148164447947*^9, 3.8291482060947657`*^9}, {
   3.829148395241098*^9, 3.829148396135536*^9}, {3.8291977685955477`*^9, 
   3.829197781460986*^9}, {3.829197863466599*^9, 3.829197865677249*^9}, {
   3.8291982895643883`*^9, 3.8291983493926487`*^9}, {3.829198621273136*^9, 
   3.8291986886296587`*^9}, {3.82919918302668*^9, 3.8291992094801073`*^9}, {
   3.829199246296228*^9, 3.829199321818822*^9}, {3.829199727773603*^9, 
   3.829199737105246*^9}, {3.82920292855157*^9, 3.829202936019396*^9}, {
   3.8292068215555477`*^9, 3.829206825226924*^9}, {3.8292069010042353`*^9, 
   3.8292069341045227`*^9}, {3.829207010926182*^9, 3.829207018142527*^9}, {
   3.829207310899825*^9, 3.82920734276645*^9}, {3.829207390377994*^9, 
   3.8292074073354588`*^9}, {3.829207489268343*^9, 3.829207511537191*^9}, {
   3.829207560726769*^9, 3.829207575562459*^9}, 3.829207629344021*^9, {
   3.829207708651444*^9, 3.829207773137863*^9}, {3.829207885781274*^9, 
   3.829208051911153*^9}, {3.829208306721325*^9, 3.829208544820374*^9}, {
   3.8292087637148027`*^9, 3.8292087788188066`*^9}, {3.829208867775486*^9, 
   3.829208947489504*^9}, {3.829215049734221*^9, 3.829215117514235*^9}, {
   3.829215153743882*^9, 3.829215161570367*^9}, {3.829215219630225*^9, 
   3.829215316703212*^9}, {3.829236044232724*^9, 3.829236070270341*^9}, {
   3.829236157454698*^9, 3.82923616072581*^9}, {3.829236201541174*^9, 
   3.8292362017196836`*^9}, {3.829236547187441*^9, 3.829236588619102*^9}, {
   3.8292369189724083`*^9, 3.829236920922974*^9}, {3.8292369547402*^9, 
   3.8292370041525297`*^9}, {3.8292708589287157`*^9, 
   3.8292708610532217`*^9}, {3.829271896542548*^9, 3.829271903389385*^9}, {
   3.8292724030001802`*^9, 3.829272403433216*^9}, {3.8292724443494043`*^9, 
   3.829272450118464*^9}, {3.8292742986754837`*^9, 3.829274319942129*^9}, {
   3.8292747909663973`*^9, 3.829274791148488*^9}, {3.829274850399791*^9, 
   3.829274899385055*^9}, {3.82927495553961*^9, 3.829274979117107*^9}, {
   3.829275562305149*^9, 3.8292755777678947`*^9}, {3.829275717209511*^9, 
   3.829275720755156*^9}, {3.829275780392604*^9, 3.829275878199795*^9}, {
   3.8292760325086193`*^9, 3.829276162273489*^9}, {3.829276214212961*^9, 
   3.829276249766745*^9}, {3.829276305701227*^9, 3.829276309387154*^9}, {
   3.829276518865806*^9, 3.8292765363942347`*^9}, {3.829276801185091*^9, 
   3.829276803103911*^9}, 3.8292768441403847`*^9, {3.8292769734173727`*^9, 
   3.829276973559679*^9}, {3.829277006122979*^9, 3.82927700792754*^9}, {
   3.8292770527341213`*^9, 3.829277087097206*^9}, {3.829277184824923*^9, 
   3.829277215734097*^9}, {3.8292794733383512`*^9, 3.829279556941203*^9}, {
   3.82927959331275*^9, 3.829279625472357*^9}, {3.829279704217807*^9, 
   3.8292798599661016`*^9}, {3.829279975000997*^9, 3.8292799904662933`*^9}, {
   3.8292804873397427`*^9, 3.8292804901710777`*^9}, {3.8292807137335043`*^9, 
   3.8292807193227777`*^9}, {3.829280750721343*^9, 3.829280851575781*^9}, {
   3.829281155031562*^9, 3.829281212854246*^9}, {3.829281267512043*^9, 
   3.829281277380476*^9}, {3.829281508696116*^9, 3.8292815115006742`*^9}, 
   3.829284285475293*^9, {3.8292843450831013`*^9, 3.829284348739924*^9}, {
   3.829284515051241*^9, 3.82928452173647*^9}, {3.8292859164514503`*^9, 
   3.829285936329883*^9}, {3.829286080101551*^9, 3.8292861090461283`*^9}, {
   3.829286190658805*^9, 3.829286192077181*^9}, {3.829286342256772*^9, 
   3.829286415440465*^9}, {3.829286504089368*^9, 3.829286526702176*^9}, {
   3.8292872416480627`*^9, 3.829287276907524*^9}, {3.829287351778956*^9, 
   3.829287422535306*^9}, {3.8292878252508707`*^9, 3.8292878265962477`*^9}, 
   3.8292878585867023`*^9, {3.829287904728862*^9, 3.8292879895237513`*^9}, {
   3.829289901713603*^9, 3.829289904691453*^9}, {3.829289942858902*^9, 
   3.829289965816914*^9}, {3.829290044090528*^9, 3.829290104657515*^9}, {
   3.829290804499116*^9, 3.829290834389989*^9}, {3.829291374455221*^9, 
   3.829291393449293*^9}, {3.829291474376635*^9, 3.829291484056369*^9}, {
   3.82929168376972*^9, 3.82929168762399*^9}, {3.829292294430132*^9, 
   3.829292309511879*^9}, {3.829292340880451*^9, 3.8292923426193857`*^9}, {
   3.829292584859273*^9, 3.829292598394807*^9}, {3.829292635313751*^9, 
   3.829292654437223*^9}, {3.829294761404716*^9, 3.8292948375335608`*^9}, {
   3.829294884463649*^9, 3.82929488611661*^9}, {3.8292949313329773`*^9, 
   3.829294935999784*^9}, {3.829295070726022*^9, 3.829295097949813*^9}, {
   3.8292951685559807`*^9, 3.8292952026618423`*^9}, {3.829296493894319*^9, 
   3.8292965445567417`*^9}, {3.82929657668174*^9, 3.829296595713621*^9}, {
   3.82929666075515*^9, 3.829296660966732*^9}, {3.829296910924992*^9, 
   3.829296914017223*^9}, {3.830407443893999*^9, 3.830407447269717*^9}, {
   3.830407478251835*^9, 3.830407534501219*^9}, {3.8304075658044243`*^9, 
   3.830407600155998*^9}, {3.8304076523632708`*^9, 3.830407682833804*^9}, {
   3.830407725526658*^9, 3.830407745738186*^9}, {3.8304077826931267`*^9, 
   3.8304077827750263`*^9}, {3.830407836184782*^9, 3.830407838240849*^9}, {
   3.8304081628459473`*^9, 3.830408165276929*^9}, {3.8304125977867947`*^9, 
   3.830412600398489*^9}, {3.8304127725742903`*^9, 3.830412812329652*^9}, {
   3.830412848138476*^9, 3.830412848996171*^9}, {3.830412966016157*^9, 
   3.830412985909759*^9}, {3.8304130257505293`*^9, 3.830413060926656*^9}, {
   3.830413096302099*^9, 3.830413166867173*^9}, {3.830414570245166*^9, 
   3.830414572426784*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"f8b5fc7e-7257-4572-aaaa-93bb1c290404"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$AtomRadii", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<AtomicRadius\>\"", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<H\>\"", "\[Rule]", "0.53`"}], ",", 
        RowBox[{"\"\<He\>\"", "\[Rule]", "0.31`"}], ",", 
        RowBox[{"\"\<Li\>\"", "\[Rule]", "1.67`"}], ",", 
        RowBox[{"\"\<Be\>\"", "\[Rule]", "1.12`"}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", "0.87`"}], ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", "0.67`"}], ",", 
        RowBox[{"\"\<N\>\"", "\[Rule]", "0.56`"}], ",", 
        RowBox[{"\"\<O\>\"", "\[Rule]", "0.48`"}], ",", 
        RowBox[{"\"\<F\>\"", "\[Rule]", "0.42`"}], ",", 
        RowBox[{"\"\<Ne\>\"", "\[Rule]", "0.38`"}], ",", 
        RowBox[{"\"\<Na\>\"", "\[Rule]", "1.9`"}], ",", 
        RowBox[{"\"\<Mg\>\"", "\[Rule]", "1.45`"}], ",", 
        RowBox[{"\"\<Al\>\"", "\[Rule]", "1.18`"}], ",", 
        RowBox[{"\"\<Si\>\"", "\[Rule]", "1.11`"}], ",", 
        RowBox[{"\"\<P\>\"", "\[Rule]", "0.98`"}], ",", 
        RowBox[{"\"\<S\>\"", "\[Rule]", "0.87`"}], ",", 
        RowBox[{"\"\<Cl\>\"", "\[Rule]", "0.79`"}], ",", 
        RowBox[{"\"\<Ar\>\"", "\[Rule]", "0.71`"}], ",", 
        RowBox[{"\"\<K\>\"", "\[Rule]", "2.43`"}], ",", 
        RowBox[{"\"\<Ca\>\"", "\[Rule]", "1.94`"}], ",", 
        RowBox[{"\"\<Sc\>\"", "\[Rule]", "1.84`"}], ",", 
        RowBox[{"\"\<Ti\>\"", "\[Rule]", "1.76`"}], ",", 
        RowBox[{"\"\<V\>\"", "\[Rule]", "1.71`"}], ",", 
        RowBox[{"\"\<Cr\>\"", "\[Rule]", "1.66`"}], ",", 
        RowBox[{"\"\<Mn\>\"", "\[Rule]", "1.61`"}], ",", 
        RowBox[{"\"\<Fe\>\"", "\[Rule]", "1.56`"}], ",", 
        RowBox[{"\"\<Co\>\"", "\[Rule]", "1.52`"}], ",", 
        RowBox[{"\"\<Ni\>\"", "\[Rule]", "1.49`"}], ",", 
        RowBox[{"\"\<Cu\>\"", "\[Rule]", "1.45`"}], ",", 
        RowBox[{"\"\<Zn\>\"", "\[Rule]", "1.42`"}], ",", 
        RowBox[{"\"\<Ga\>\"", "\[Rule]", "1.36`"}], ",", 
        RowBox[{"\"\<Ge\>\"", "\[Rule]", "1.25`"}], ",", 
        RowBox[{"\"\<As\>\"", "\[Rule]", "1.14`"}], ",", 
        RowBox[{"\"\<Se\>\"", "\[Rule]", "1.03`"}], ",", 
        RowBox[{"\"\<Br\>\"", "\[Rule]", "0.94`"}], ",", 
        RowBox[{"\"\<Kr\>\"", "\[Rule]", "0.87`"}], ",", 
        RowBox[{"\"\<Rb\>\"", "\[Rule]", "2.65`"}], ",", 
        RowBox[{"\"\<Sr\>\"", "\[Rule]", "2.19`"}], ",", 
        RowBox[{"\"\<Y\>\"", "\[Rule]", "2.12`"}], ",", 
        RowBox[{"\"\<Zr\>\"", "\[Rule]", "2.06`"}], ",", 
        RowBox[{"\"\<Nb\>\"", "\[Rule]", "1.98`"}], ",", 
        RowBox[{"\"\<Mo\>\"", "\[Rule]", "1.9`"}], ",", 
        RowBox[{"\"\<Tc\>\"", "\[Rule]", "1.83`"}], ",", 
        RowBox[{"\"\<Ru\>\"", "\[Rule]", "1.78`"}], ",", 
        RowBox[{"\"\<Rh\>\"", "\[Rule]", "1.73`"}], ",", 
        RowBox[{"\"\<Pd\>\"", "\[Rule]", "1.69`"}], ",", 
        RowBox[{"\"\<Ag\>\"", "\[Rule]", "1.65`"}], ",", 
        RowBox[{"\"\<Cd\>\"", "\[Rule]", "1.61`"}], ",", 
        RowBox[{"\"\<In\>\"", "\[Rule]", "1.56`"}], ",", 
        RowBox[{"\"\<Sn\>\"", "\[Rule]", "1.45`"}], ",", 
        RowBox[{"\"\<Sb\>\"", "\[Rule]", "1.33`"}], ",", 
        RowBox[{"\"\<Te\>\"", "\[Rule]", "1.23`"}], ",", 
        RowBox[{"\"\<I\>\"", "\[Rule]", "1.15`"}], ",", 
        RowBox[{"\"\<Xe\>\"", "\[Rule]", "1.08`"}], ",", 
        RowBox[{"\"\<Cs\>\"", "\[Rule]", "2.98`"}], ",", 
        RowBox[{"\"\<Ba\>\"", "\[Rule]", "2.53`"}], ",", 
        RowBox[{"\"\<La\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Ce\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Pr\>\"", "\[Rule]", "2.47`"}], ",", 
        RowBox[{"\"\<Nd\>\"", "\[Rule]", "2.06`"}], ",", 
        RowBox[{"\"\<Pm\>\"", "\[Rule]", "2.05`"}], ",", 
        RowBox[{"\"\<Sm\>\"", "\[Rule]", "2.38`"}], ",", 
        RowBox[{"\"\<Eu\>\"", "\[Rule]", "2.31`"}], ",", 
        RowBox[{"\"\<Gd\>\"", "\[Rule]", "2.33`"}], ",", 
        RowBox[{"\"\<Tb\>\"", "\[Rule]", "2.25`"}], ",", 
        RowBox[{"\"\<Dy\>\"", "\[Rule]", "2.28`"}], ",", 
        RowBox[{"\"\<Ho\>\"", "\[Rule]", "2.26`"}], ",", 
        RowBox[{"\"\<Er\>\"", "\[Rule]", "2.26`"}], ",", 
        RowBox[{"\"\<Tm\>\"", "\[Rule]", "2.22`"}], ",", 
        RowBox[{"\"\<Yb\>\"", "\[Rule]", "2.22`"}], ",", 
        RowBox[{"\"\<Lu\>\"", "\[Rule]", "2.17`"}], ",", 
        RowBox[{"\"\<Hf\>\"", "\[Rule]", "2.08`"}], ",", 
        RowBox[{"\"\<Ta\>\"", "\[Rule]", "2.`"}], ",", 
        RowBox[{"\"\<W\>\"", "\[Rule]", "1.93`"}], ",", 
        RowBox[{"\"\<Re\>\"", "\[Rule]", "1.88`"}], ",", 
        RowBox[{"\"\<Os\>\"", "\[Rule]", "1.85`"}], ",", 
        RowBox[{"\"\<Ir\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Pt\>\"", "\[Rule]", "1.77`"}], ",", 
        RowBox[{"\"\<Au\>\"", "\[Rule]", "1.74`"}], ",", 
        RowBox[{"\"\<Hg\>\"", "\[Rule]", "1.71`"}], ",", 
        RowBox[{"\"\<Tl\>\"", "\[Rule]", "1.56`"}], ",", 
        RowBox[{"\"\<Pb\>\"", "\[Rule]", "1.54`"}], ",", 
        RowBox[{"\"\<Bi\>\"", "\[Rule]", "1.43`"}], ",", 
        RowBox[{"\"\<Po\>\"", "\[Rule]", "1.35`"}], ",", 
        RowBox[{"\"\<At\>\"", "\[Rule]", "1.27`"}], ",", 
        RowBox[{"\"\<Rn\>\"", "\[Rule]", "1.2`"}], ",", 
        RowBox[{"\"\<Fr\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Ra\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Ac\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Th\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Pa\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<U\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Np\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Pu\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Am\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Cm\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Bk\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Cf\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Es\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Fm\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Md\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<No\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Lr\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Rf\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Db\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Sg\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Bh\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Hs\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Mt\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Ds\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Rg\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Cn\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Nh\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Fl\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Mc\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Lv\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Ts\>\"", "\[Rule]", "1.655`"}], ",", 
        RowBox[{"\"\<Og\>\"", "\[Rule]", "1.655`"}]}], 
       "\[RightAssociation]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<CovalentRadius\>\"", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<H\>\"", "\[Rule]", "0.31`"}], ",", 
        RowBox[{"\"\<He\>\"", "\[Rule]", "0.28`"}], ",", 
        RowBox[{"\"\<Li\>\"", "\[Rule]", "1.28`"}], ",", 
        RowBox[{"\"\<Be\>\"", "\[Rule]", "0.96`"}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", "0.85`"}], ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", "0.76`"}], ",", 
        RowBox[{"\"\<N\>\"", "\[Rule]", "0.71`"}], ",", 
        RowBox[{"\"\<O\>\"", "\[Rule]", "0.66`"}], ",", 
        RowBox[{"\"\<F\>\"", "\[Rule]", "0.57`"}], ",", 
        RowBox[{"\"\<Ne\>\"", "\[Rule]", "0.58`"}], ",", 
        RowBox[{"\"\<Na\>\"", "\[Rule]", "1.66`"}], ",", 
        RowBox[{"\"\<Mg\>\"", "\[Rule]", "1.41`"}], ",", 
        RowBox[{"\"\<Al\>\"", "\[Rule]", "1.21`"}], ",", 
        RowBox[{"\"\<Si\>\"", "\[Rule]", "1.11`"}], ",", 
        RowBox[{"\"\<P\>\"", "\[Rule]", "1.07`"}], ",", 
        RowBox[{"\"\<S\>\"", "\[Rule]", "1.05`"}], ",", 
        RowBox[{"\"\<Cl\>\"", "\[Rule]", "1.02`"}], ",", 
        RowBox[{"\"\<Ar\>\"", "\[Rule]", "1.06`"}], ",", 
        RowBox[{"\"\<K\>\"", "\[Rule]", "2.03`"}], ",", 
        RowBox[{"\"\<Ca\>\"", "\[Rule]", "1.76`"}], ",", 
        RowBox[{"\"\<Sc\>\"", "\[Rule]", "1.7`"}], ",", 
        RowBox[{"\"\<Ti\>\"", "\[Rule]", "1.6`"}], ",", 
        RowBox[{"\"\<V\>\"", "\[Rule]", "1.53`"}], ",", 
        RowBox[{"\"\<Cr\>\"", "\[Rule]", "1.39`"}], ",", 
        RowBox[{"\"\<Mn\>\"", "\[Rule]", "1.39`"}], ",", 
        RowBox[{"\"\<Fe\>\"", "\[Rule]", "1.32`"}], ",", 
        RowBox[{"\"\<Co\>\"", "\[Rule]", "1.26`"}], ",", 
        RowBox[{"\"\<Ni\>\"", "\[Rule]", "1.24`"}], ",", 
        RowBox[{"\"\<Cu\>\"", "\[Rule]", "1.32`"}], ",", 
        RowBox[{"\"\<Zn\>\"", "\[Rule]", "1.22`"}], ",", 
        RowBox[{"\"\<Ga\>\"", "\[Rule]", "1.22`"}], ",", 
        RowBox[{"\"\<Ge\>\"", "\[Rule]", "1.2`"}], ",", 
        RowBox[{"\"\<As\>\"", "\[Rule]", "1.19`"}], ",", 
        RowBox[{"\"\<Se\>\"", "\[Rule]", "1.2`"}], ",", 
        RowBox[{"\"\<Br\>\"", "\[Rule]", "1.2`"}], ",", 
        RowBox[{"\"\<Kr\>\"", "\[Rule]", "1.16`"}], ",", 
        RowBox[{"\"\<Rb\>\"", "\[Rule]", "2.2`"}], ",", 
        RowBox[{"\"\<Sr\>\"", "\[Rule]", "1.95`"}], ",", 
        RowBox[{"\"\<Y\>\"", "\[Rule]", "1.9`"}], ",", 
        RowBox[{"\"\<Zr\>\"", "\[Rule]", "1.75`"}], ",", 
        RowBox[{"\"\<Nb\>\"", "\[Rule]", "1.64`"}], ",", 
        RowBox[{"\"\<Mo\>\"", "\[Rule]", "1.54`"}], ",", 
        RowBox[{"\"\<Tc\>\"", "\[Rule]", "1.47`"}], ",", 
        RowBox[{"\"\<Ru\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Rh\>\"", "\[Rule]", "1.42`"}], ",", 
        RowBox[{"\"\<Pd\>\"", "\[Rule]", "1.39`"}], ",", 
        RowBox[{"\"\<Ag\>\"", "\[Rule]", "1.45`"}], ",", 
        RowBox[{"\"\<Cd\>\"", "\[Rule]", "1.44`"}], ",", 
        RowBox[{"\"\<In\>\"", "\[Rule]", "1.42`"}], ",", 
        RowBox[{"\"\<Sn\>\"", "\[Rule]", "1.39`"}], ",", 
        RowBox[{"\"\<Sb\>\"", "\[Rule]", "1.39`"}], ",", 
        RowBox[{"\"\<Te\>\"", "\[Rule]", "1.38`"}], ",", 
        RowBox[{"\"\<I\>\"", "\[Rule]", "1.39`"}], ",", 
        RowBox[{"\"\<Xe\>\"", "\[Rule]", "1.4`"}], ",", 
        RowBox[{"\"\<Cs\>\"", "\[Rule]", "2.44`"}], ",", 
        RowBox[{"\"\<Ba\>\"", "\[Rule]", "2.15`"}], ",", 
        RowBox[{"\"\<La\>\"", "\[Rule]", "2.07`"}], ",", 
        RowBox[{"\"\<Ce\>\"", "\[Rule]", "2.04`"}], ",", 
        RowBox[{"\"\<Pr\>\"", "\[Rule]", "2.03`"}], ",", 
        RowBox[{"\"\<Nd\>\"", "\[Rule]", "2.01`"}], ",", 
        RowBox[{"\"\<Pm\>\"", "\[Rule]", "1.99`"}], ",", 
        RowBox[{"\"\<Sm\>\"", "\[Rule]", "1.98`"}], ",", 
        RowBox[{"\"\<Eu\>\"", "\[Rule]", "1.98`"}], ",", 
        RowBox[{"\"\<Gd\>\"", "\[Rule]", "1.96`"}], ",", 
        RowBox[{"\"\<Tb\>\"", "\[Rule]", "1.94`"}], ",", 
        RowBox[{"\"\<Dy\>\"", "\[Rule]", "1.92`"}], ",", 
        RowBox[{"\"\<Ho\>\"", "\[Rule]", "1.92`"}], ",", 
        RowBox[{"\"\<Er\>\"", "\[Rule]", "1.89`"}], ",", 
        RowBox[{"\"\<Tm\>\"", "\[Rule]", "1.9`"}], ",", 
        RowBox[{"\"\<Yb\>\"", "\[Rule]", "1.87`"}], ",", 
        RowBox[{"\"\<Lu\>\"", "\[Rule]", "1.87`"}], ",", 
        RowBox[{"\"\<Hf\>\"", "\[Rule]", "1.75`"}], ",", 
        RowBox[{"\"\<Ta\>\"", "\[Rule]", "1.7`"}], ",", 
        RowBox[{"\"\<W\>\"", "\[Rule]", "1.62`"}], ",", 
        RowBox[{"\"\<Re\>\"", "\[Rule]", "1.51`"}], ",", 
        RowBox[{"\"\<Os\>\"", "\[Rule]", "1.44`"}], ",", 
        RowBox[{"\"\<Ir\>\"", "\[Rule]", "1.41`"}], ",", 
        RowBox[{"\"\<Pt\>\"", "\[Rule]", "1.36`"}], ",", 
        RowBox[{"\"\<Au\>\"", "\[Rule]", "1.36`"}], ",", 
        RowBox[{"\"\<Hg\>\"", "\[Rule]", "1.32`"}], ",", 
        RowBox[{"\"\<Tl\>\"", "\[Rule]", "1.45`"}], ",", 
        RowBox[{"\"\<Pb\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Bi\>\"", "\[Rule]", "1.48`"}], ",", 
        RowBox[{"\"\<Po\>\"", "\[Rule]", "1.4`"}], ",", 
        RowBox[{"\"\<At\>\"", "\[Rule]", "1.5`"}], ",", 
        RowBox[{"\"\<Rn\>\"", "\[Rule]", "1.5`"}], ",", 
        RowBox[{"\"\<Fr\>\"", "\[Rule]", "2.6`"}], ",", 
        RowBox[{"\"\<Ra\>\"", "\[Rule]", "2.21`"}], ",", 
        RowBox[{"\"\<Ac\>\"", "\[Rule]", "2.15`"}], ",", 
        RowBox[{"\"\<Th\>\"", "\[Rule]", "2.06`"}], ",", 
        RowBox[{"\"\<Pa\>\"", "\[Rule]", "2.`"}], ",", 
        RowBox[{"\"\<U\>\"", "\[Rule]", "1.96`"}], ",", 
        RowBox[{"\"\<Np\>\"", "\[Rule]", "1.9`"}], ",", 
        RowBox[{"\"\<Pu\>\"", "\[Rule]", "1.87`"}], ",", 
        RowBox[{"\"\<Am\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Cm\>\"", "\[Rule]", "1.69`"}], ",", 
        RowBox[{"\"\<Bk\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Cf\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Es\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Fm\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Md\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<No\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Lr\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Rf\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Db\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Sg\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Bh\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Hs\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Mt\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Ds\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Rg\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Cn\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Nh\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Fl\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Mc\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Lv\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Ts\>\"", "\[Rule]", "1.46`"}], ",", 
        RowBox[{"\"\<Og\>\"", "\[Rule]", "1.46`"}]}], 
       "\[RightAssociation]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<VanDerWaalsRadius\>\"", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<H\>\"", "\[Rule]", "1.2`"}], ",", 
        RowBox[{"\"\<He\>\"", "\[Rule]", "1.4`"}], ",", 
        RowBox[{"\"\<Li\>\"", "\[Rule]", "1.82`"}], ",", 
        RowBox[{"\"\<Be\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", "1.7`"}], ",", 
        RowBox[{"\"\<N\>\"", "\[Rule]", "1.55`"}], ",", 
        RowBox[{"\"\<O\>\"", "\[Rule]", "1.52`"}], ",", 
        RowBox[{"\"\<F\>\"", "\[Rule]", "1.47`"}], ",", 
        RowBox[{"\"\<Ne\>\"", "\[Rule]", "1.54`"}], ",", 
        RowBox[{"\"\<Na\>\"", "\[Rule]", "2.27`"}], ",", 
        RowBox[{"\"\<Mg\>\"", "\[Rule]", "1.73`"}], ",", 
        RowBox[{"\"\<Al\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Si\>\"", "\[Rule]", "2.1`"}], ",", 
        RowBox[{"\"\<P\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<S\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Cl\>\"", "\[Rule]", "1.75`"}], ",", 
        RowBox[{"\"\<Ar\>\"", "\[Rule]", "1.88`"}], ",", 
        RowBox[{"\"\<K\>\"", "\[Rule]", "2.75`"}], ",", 
        RowBox[{"\"\<Ca\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Sc\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ti\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<V\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Cr\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Mn\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Fe\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Co\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ni\>\"", "\[Rule]", "1.63`"}], ",", 
        RowBox[{"\"\<Cu\>\"", "\[Rule]", "1.4`"}], ",", 
        RowBox[{"\"\<Zn\>\"", "\[Rule]", "1.39`"}], ",", 
        RowBox[{"\"\<Ga\>\"", "\[Rule]", "1.87`"}], ",", 
        RowBox[{"\"\<Ge\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<As\>\"", "\[Rule]", "1.85`"}], ",", 
        RowBox[{"\"\<Se\>\"", "\[Rule]", "1.9`"}], ",", 
        RowBox[{"\"\<Br\>\"", "\[Rule]", "1.85`"}], ",", 
        RowBox[{"\"\<Kr\>\"", "\[Rule]", "2.02`"}], ",", 
        RowBox[{"\"\<Rb\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Sr\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Y\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Zr\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Nb\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Mo\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Tc\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ru\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Rh\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Pd\>\"", "\[Rule]", "1.63`"}], ",", 
        RowBox[{"\"\<Ag\>\"", "\[Rule]", "1.72`"}], ",", 
        RowBox[{"\"\<Cd\>\"", "\[Rule]", "1.58`"}], ",", 
        RowBox[{"\"\<In\>\"", "\[Rule]", "1.93`"}], ",", 
        RowBox[{"\"\<Sn\>\"", "\[Rule]", "2.17`"}], ",", 
        RowBox[{"\"\<Sb\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Te\>\"", "\[Rule]", "2.06`"}], ",", 
        RowBox[{"\"\<I\>\"", "\[Rule]", "1.98`"}], ",", 
        RowBox[{"\"\<Xe\>\"", "\[Rule]", "2.16`"}], ",", 
        RowBox[{"\"\<Cs\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ba\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<La\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ce\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Pr\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Nd\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Pm\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Sm\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Eu\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Gd\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Tb\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Dy\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ho\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Er\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Tm\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Yb\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Lu\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Hf\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ta\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<W\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Re\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Os\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ir\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Pt\>\"", "\[Rule]", "1.75`"}], ",", 
        RowBox[{"\"\<Au\>\"", "\[Rule]", "1.66`"}], ",", 
        RowBox[{"\"\<Hg\>\"", "\[Rule]", "1.55`"}], ",", 
        RowBox[{"\"\<Tl\>\"", "\[Rule]", "1.96`"}], ",", 
        RowBox[{"\"\<Pb\>\"", "\[Rule]", "2.02`"}], ",", 
        RowBox[{"\"\<Bi\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Po\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<At\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Rn\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Fr\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ra\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ac\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Th\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Pa\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<U\>\"", "\[Rule]", "1.86`"}], ",", 
        RowBox[{"\"\<Np\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Pu\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Am\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Cm\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Bk\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Cf\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Es\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Fm\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Md\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<No\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Lr\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Rf\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Db\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Sg\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Bh\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Hs\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Mt\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ds\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Rg\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Cn\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Nh\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Fl\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Mc\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Lv\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Ts\>\"", "\[Rule]", "1.8`"}], ",", 
        RowBox[{"\"\<Og\>\"", "\[Rule]", "1.8`"}]}], 
       "\[RightAssociation]"}]}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, 3.76094933831287*^9, 3.760949768973755*^9, {
   3.760984978066174*^9, 3.7609849782261057`*^9}, {3.7610413931761417`*^9, 
   3.761041413115313*^9}, {3.7610430860478983`*^9, 3.7610431431331463`*^9}, {
   3.761043822654356*^9, 3.761043826973112*^9}, {3.761043893872447*^9, 
   3.761043898359037*^9}, {3.761044578275333*^9, 3.761044579754964*^9}, {
   3.7610446519140987`*^9, 3.761044667819563*^9}, {3.7610449333385572`*^9, 
   3.761044933528962*^9}, {3.7611974752311287`*^9, 3.761197475395208*^9}, {
   3.761219720280757*^9, 3.761219720443687*^9}, 3.761219760708205*^9, {
   3.761219796192238*^9, 3.7612197966864157`*^9}, {3.761219880749118*^9, 
   3.761219917954582*^9}, {3.761219960450508*^9, 3.7612200276284847`*^9}, {
   3.761224270635038*^9, 3.7612242859363613`*^9}, {3.761224435792968*^9, 
   3.761224514091919*^9}, {3.7612246251383038`*^9, 3.761224733520315*^9}, {
   3.7612247722712793`*^9, 3.7612247764965963`*^9}, {3.7612248619479227`*^9, 
   3.761224879595311*^9}, {3.761224939212246*^9, 3.761224954897791*^9}, {
   3.7612250096029873`*^9, 3.761225024755363*^9}, 3.761225176113929*^9, {
   3.761226846793069*^9, 3.7612268777377367`*^9}, {3.761227986802516*^9, 
   3.761228018391322*^9}, {3.761244339357354*^9, 3.76124434274603*^9}, 
   3.761248076651359*^9, {3.761292747306129*^9, 3.761292752007421*^9}, {
   3.761292977932835*^9, 3.761293024578326*^9}, {3.761293056358447*^9, 
   3.761293066399618*^9}, 3.761293295578657*^9, {3.761293335488833*^9, 
   3.761293348363126*^9}, {3.761419025091445*^9, 3.761419128815998*^9}, {
   3.761419290964973*^9, 3.761419324809844*^9}, {3.7614193646659527`*^9, 
   3.761419374607725*^9}, {3.7614194094188557`*^9, 3.7614194224946833`*^9}, {
   3.761419540623413*^9, 3.761419714969212*^9}, {3.761419776545178*^9, 
   3.761419777511207*^9}, {3.7614199906197853`*^9, 3.761420000178577*^9}, {
   3.761420075498897*^9, 3.76142016521384*^9}, {3.761420687690447*^9, 
   3.761420717697867*^9}, {3.761421340825123*^9, 3.761421341388412*^9}, {
   3.7614218142311163`*^9, 3.76142187284282*^9}, 3.7614219059472637`*^9, {
   3.761422006897604*^9, 3.7614220684956284`*^9}, {3.761422135599387*^9, 
   3.761422250331128*^9}, {3.76142233220479*^9, 3.761422392600257*^9}, {
   3.761423510368361*^9, 3.7614235128850393`*^9}, 3.761423588080277*^9, 
   3.762793093125334*^9, {3.763795598026209*^9, 3.763795604168119*^9}, {
   3.7637957478383007`*^9, 3.763795785644519*^9}, {3.763795840509068*^9, 
   3.763795852858042*^9}, {3.78082380277636*^9, 3.780823813678226*^9}, {
   3.786968127926214*^9, 3.7869681291239653`*^9}, {3.802484708108547*^9, 
   3.802484718035901*^9}, {3.8026291553222218`*^9, 3.8026291554598227`*^9}, {
   3.802629190471525*^9, 3.8026292211377697`*^9}, {3.802630944420762*^9, 
   3.802630944653728*^9}, {3.802666763279166*^9, 3.8026667674351807`*^9}, {
   3.8026668415239983`*^9, 3.8026668497990837`*^9}, 3.802666953513707*^9, 
   3.802667039474736*^9, 3.802667097164507*^9, {3.802667148821329*^9, 
   3.802667151666338*^9}, {3.802675688111014*^9, 3.802675691509973*^9}, {
   3.8026758959841967`*^9, 3.802675997395389*^9}, {3.802676031756215*^9, 
   3.80267604977824*^9}, {3.802676079928746*^9, 3.802676095027589*^9}, {
   3.802676140617611*^9, 3.8026761432583027`*^9}, {3.802676391840394*^9, 
   3.802676431347678*^9}, {3.802696950599875*^9, 3.8026970928888273`*^9}, {
   3.802697431986003*^9, 3.802697526892215*^9}, {3.8026976660865707`*^9, 
   3.802697713157123*^9}, {3.802697998534004*^9, 3.8026980073354187`*^9}, {
   3.8026980388917923`*^9, 3.802698067027503*^9}, {3.802698464070364*^9, 
   3.802698520557004*^9}, {3.802698586610416*^9, 3.8026986287418756`*^9}, {
   3.80269874501525*^9, 3.802698785395142*^9}, {3.80269885711828*^9, 
   3.802698886614769*^9}, {3.802698953847685*^9, 3.802698956363974*^9}, {
   3.802699171191967*^9, 3.802699175155449*^9}, {3.8026992716326323`*^9, 
   3.8026993099443817`*^9}, {3.80269938294464*^9, 3.802699384687069*^9}, {
   3.802699432232874*^9, 3.802699481215476*^9}, {3.8026996419717197`*^9, 
   3.802699651779251*^9}, {3.8026997372274017`*^9, 3.802699777154406*^9}, {
   3.80269990629781*^9, 3.8026999824438868`*^9}, {3.802700023580497*^9, 
   3.802700023750852*^9}, {3.802700081464704*^9, 3.802700081941544*^9}, {
   3.8027001334756193`*^9, 3.8027002312053022`*^9}, {3.802700289307375*^9, 
   3.802700305506324*^9}, {3.802700335510912*^9, 3.8027005284985847`*^9}, {
   3.8027005693727713`*^9, 3.8027005784893713`*^9}, {3.802700632501647*^9, 
   3.802700643775036*^9}, {3.8027007095575113`*^9, 3.802700833796548*^9}, {
   3.8027019398589907`*^9, 3.802701955170393*^9}, {3.802702171951129*^9, 
   3.8027022057007523`*^9}, {3.802702294439208*^9, 3.80270232366968*^9}, {
   3.802702423963808*^9, 3.8027024448922663`*^9}, {3.802702499773677*^9, 
   3.802702514018312*^9}, {3.8027026782508507`*^9, 3.8027027275873737`*^9}, {
   3.802702835896628*^9, 3.802702854454877*^9}, {3.8027037799959784`*^9, 
   3.802703780240655*^9}, {3.8027038195490713`*^9, 3.802703827705442*^9}, {
   3.8027038824177923`*^9, 3.8027039379471684`*^9}, {3.802712080240498*^9, 
   3.8027120826291428`*^9}, 3.8027122530077753`*^9, {3.802712878552799*^9, 
   3.8027128971323833`*^9}, {3.802713362037744*^9, 3.802713362888157*^9}, {
   3.804410291057863*^9, 3.804410318768835*^9}, {3.804410349702424*^9, 
   3.804410350592589*^9}, {3.8054434964732437`*^9, 3.805443522962919*^9}, {
   3.805443565819339*^9, 3.805443566717695*^9}, {3.807986903904312*^9, 
   3.8079869230154333`*^9}, {3.807986954593642*^9, 3.8079869832530527`*^9}, {
   3.807987055271224*^9, 3.807987095882872*^9}, {3.829135474112577*^9, 
   3.829135479312687*^9}, {3.829135866647332*^9, 3.829135873721319*^9}, 
   3.8291359194808702`*^9, {3.8291359669407988`*^9, 3.829135983701188*^9}, 
   3.829136053523305*^9, {3.829136111417062*^9, 3.829136111583749*^9}, {
   3.8291361525098457`*^9, 3.829136155390767*^9}, {3.829136300502635*^9, 
   3.829136403377021*^9}, {3.829136542856743*^9, 3.829136563389483*^9}, {
   3.829136679871915*^9, 3.8291367168536167`*^9}, {3.8291367651909437`*^9, 
   3.8291367680976553`*^9}, {3.82913687174998*^9, 3.8291369936675797`*^9}, {
   3.829144453850665*^9, 3.829144459106696*^9}, 3.829144664124247*^9, {
   3.829144813530683*^9, 3.829144818118712*^9}, {3.829144860701685*^9, 
   3.829144894984788*^9}, {3.829145313022416*^9, 3.829145337013925*^9}, {
   3.829145387144754*^9, 3.829145402892374*^9}, {3.829145433189423*^9, 
   3.829145484419211*^9}, {3.829145520734646*^9, 3.829145630839534*^9}, {
   3.829145677257882*^9, 3.8291457448010674`*^9}, {3.829145789407584*^9, 
   3.829145827545981*^9}, {3.829145882279159*^9, 3.82914588437693*^9}, {
   3.82914628978397*^9, 3.8291463611298103`*^9}, {3.829146480846692*^9, 
   3.829146521976386*^9}, {3.829146557304842*^9, 3.829146672240868*^9}, {
   3.8291467315220203`*^9, 3.829146753853475*^9}, {3.829146819778351*^9, 
   3.82914684771354*^9}, {3.829146924312683*^9, 3.8291469419262733`*^9}, {
   3.829146989515245*^9, 3.829147027158252*^9}, {3.829147059162808*^9, 
   3.8291472894253397`*^9}, {3.8291473661277533`*^9, 3.829147366964712*^9}, {
   3.829147410663477*^9, 3.829147414760182*^9}, {3.829147733940523*^9, 
   3.829147796137689*^9}, {3.8291478269454308`*^9, 3.829147827232915*^9}, {
   3.8291478662463713`*^9, 3.829147876869204*^9}, 3.82914791822965*^9, {
   3.829147948955357*^9, 3.829147995890658*^9}, {3.8291480486163273`*^9, 
   3.829148117315915*^9}, {3.829148164447947*^9, 3.8291482060947657`*^9}, {
   3.829148395241098*^9, 3.829148396135536*^9}, {3.8291977685955477`*^9, 
   3.829197781460986*^9}, {3.829197863466599*^9, 3.829197865677249*^9}, {
   3.8291982895643883`*^9, 3.8291983493926487`*^9}, {3.829198621273136*^9, 
   3.8291986886296587`*^9}, {3.82919918302668*^9, 3.8291992094801073`*^9}, {
   3.829199246296228*^9, 3.829199321818822*^9}, {3.829199727773603*^9, 
   3.829199737105246*^9}, {3.829202887449029*^9, 3.8292029077329397`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[29]:=",ExpressionUUID->"af7b2561-9d58-4eca-97c0-9b4c0051e944"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[30]:=",ExpressionUUID->"0efa7a17-876a-4d2e-b049-ddc81c2e90c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["DarwinWidth", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.715064144253417*^9, 3.71506414748868*^9}, {
   3.715064220267487*^9, 3.715064227041099*^9}, 
   3.715067274120924*^9},ExpressionUUID->"40e4bfb9-1629-447f-849d-\
c3237fd14ed7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[551]:=",ExpressionUUID->"693b2688-6b0f-4b7c-8c03-c7de2a644c6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "DarwinWidth"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", "ExtinctionLength", " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "\"\<\[Pi]\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "DarwinWidth"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_.", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, 
   3.715064183906497*^9, {3.715066714738761*^9, 3.71506671898242*^9}, {
   3.728766841930744*^9, 3.728766893633369*^9}, 3.728770289709626*^9, {
   3.75671068623941*^9, 3.7567107090873737`*^9}, 3.7567108714046307`*^9},
 CellLabel->
  "In[552]:=",ExpressionUUID->"805b346e-cd1d-4919-b5f9-b8a55270bf38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[554]:=",ExpressionUUID->"3f7814b8-c82e-4a33-9f01-5f69745da6e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DarwinWidth", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "hklInput_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]o", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "1.0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]h", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "1.0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "hkl", ",", "L", ",", "\[Lambda]", ",", "\[Theta]", ",", 
      "\[CapitalLambda]o", ",", "\[Delta]os"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "hklInput", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "hkl"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<ProcessWavelength\>\"", ",", "crystal", ",", "lambda"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Miscellaneous", " ", "preparations"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{
       RowBox[{"BraggAngle", "[", 
        RowBox[{"crystal", ",", "\[Lambda]", ",", "hkl", ",", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}], "*", 
       "Degree"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{"ExtinctionLength", "[", 
       RowBox[{
       "crystal", ",", "\[Lambda]", ",", "hkl", ",", "\[Gamma]o", ",", 
        "\[Gamma]h", ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Polarisation\>\"", "\[Rule]", 
         RowBox[{"OptionValue", "[", "\"\<Polarisation\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Darwin", " ", "width"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Delta]os", "=", 
      RowBox[{"2", "*", 
       FractionBox["\[Lambda]", "\[CapitalLambda]o"], "*", 
       FractionBox["\[Gamma]h", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "\[Theta]"}], "]"}]], "*", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"1", " ", 
          RowBox[{"(*", " ", "\[Mu]m", " ", "*)"}]}], 
         RowBox[{
          SuperscriptBox["10", "4"], " ", 
          RowBox[{"(*", " ", "\[CapitalARing]", " ", "*)"}]}]], ")"}], "*", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["10", "6"], " ", 
          RowBox[{"(*", " ", "\[Mu]rad", " ", "*)"}]}], 
         RowBox[{"1", " ", 
          RowBox[{"(*", " ", "rad", " ", "*)"}]}]], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]os", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"Chop", "@", "\[Delta]os"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Delta]os", "=", 
        RowBox[{"\[Delta]os", "/.", 
         RowBox[{
          RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
          RowBox[{"Quantity", "[", 
           RowBox[{"x", ",", "\"\<Microradians\>\""}], "]"}]}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"L", "===", "1"}], ",", 
       RowBox[{"First", "@", "\[Delta]os"}], ",", "\[Delta]os"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.7150641849014177`*^9, 
   3.715064208336918*^9}, {3.715066724458549*^9, 3.715066727346246*^9}, {
   3.7150668733949633`*^9, 3.7150669069213676`*^9}, {3.715066957743388*^9, 
   3.7150670945197363`*^9}, {3.7150671517826033`*^9, 3.71506716730866*^9}, {
   3.7150674555066233`*^9, 3.7150674630550756`*^9}, 3.715327866692709*^9, {
   3.71774092056946*^9, 3.717740920587577*^9}, 3.7265614331647253`*^9, 
   3.7276752941593733`*^9, 3.7276767839805813`*^9, {3.728760781864067*^9, 
   3.7287607828225946`*^9}, {3.728766803061042*^9, 3.7287668218759413`*^9}, 
   3.728770283214877*^9, {3.730054697782065*^9, 3.730054698221176*^9}, {
   3.7300574692575827`*^9, 3.7300574868412457`*^9}, {3.730058435643704*^9, 
   3.730058435802568*^9}, {3.730058620360833*^9, 3.73005864540763*^9}, {
   3.7300587067907143`*^9, 3.730058724598506*^9}, {3.7300592235157948`*^9, 
   3.730059224427006*^9}, {3.730059279835189*^9, 3.730059284459189*^9}, {
   3.7300608042174263`*^9, 3.730060805888069*^9}, {3.7303831895898027`*^9, 
   3.7303831963897038`*^9}, {3.730395176711034*^9, 3.730395202212804*^9}, {
   3.730395349800102*^9, 3.730395368486767*^9}, {3.730395422453882*^9, 
   3.7303954240069523`*^9}, 3.7303958767970943`*^9, {3.7303960517966127`*^9, 
   3.7303960599069977`*^9}, {3.7303961470191793`*^9, 
   3.7303961694098387`*^9}, {3.730396435147455*^9, 3.730396462049367*^9}, {
   3.7303965227290487`*^9, 3.730396600446106*^9}, {3.7303967029735813`*^9, 
   3.730396703099786*^9}, {3.759519279416449*^9, 3.759519279686451*^9}, 
   3.762793093139943*^9, {3.7869679811010838`*^9, 3.786967982755187*^9}, {
   3.7869682134959517`*^9, 3.786968215352502*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[555]:=",ExpressionUUID->"62f963aa-8c56-42e3-88b4-add2a17efea4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[556]:=",ExpressionUUID->"a40837a6-412e-4a23-ae32-883ce4b7fc1f"]
}, Closed]],

Cell[CellGroupData[{

Cell["DistortStructure", "Subchapter",
 CellChangeTimes->{{3.763444064601392*^9, 3.76344406604885*^9}, {
  3.763444882154315*^9, 3.7634448855357943`*^9}, {3.769405708236856*^9, 
  3.769405711524967*^9}},ExpressionUUID->"1c408095-8000-4ba2-be7c-\
d547fe9c754f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[557]:=",ExpressionUUID->"f5a8c2ae-9705-48a2-b6a9-856d85122463"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DistortStructure", "::", "InvalidDistortionType"}], "=", 
   "\"\<\\\"DistortionType\\\" must be set to either \\\"Crystallographic\\\" \
or \\\"Cartesian\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DistortStructure", "::", "InvalidDimensions"}], "=", 
    "\"\<Function and variables must both be three-dimensional.\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "DistortStructure"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "\"\<DistortionType\>\"", "\[Rule]", "\"\<Crystallographic\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "DistortStructure"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_", ",", 
        RowBox[{"OptionsPattern", "[", 
         RowBox[{"{", 
          RowBox[{"CrystalPlot", ",", "VectorPlot3D"}], "}"}], "]"}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<LocalVariables\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Solve\>\"", ",", 
        RowBox[{"{", "3", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.764077769467882*^9, 3.764077800337893*^9}, {
   3.764088968802273*^9, 3.764088992279881*^9}, {3.764089095334777*^9, 
   3.764089123170733*^9}, 3.764089219185321*^9, {3.764091331011241*^9, 
   3.7640913561226883`*^9}, {3.7640947240969887`*^9, 3.764094724508909*^9}, {
   3.768892253325471*^9, 3.7688922656422987`*^9}, {3.7692345178775663`*^9, 
   3.769234520225293*^9}, {3.769495801455578*^9, 3.769495804527347*^9}, {
   3.7803801955892677`*^9, 3.7803801958021603`*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"15d6ce42-ae27-45d0-a98e-c672d7ca75eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[562]:=",ExpressionUUID->"b251b819-438b-453f-a549-c286f6f7f667"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DistortStructure", "[", 
    RowBox[{"crystal_", ",", "vectorField_", ",", "variables_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newLabel", "=", 
        RowBox[{"OptionValue", "[", "\"\<NewLabel\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"distortionType", "=", 
        RowBox[{"OptionValue", "[", "\"\<DistortionType\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "M", ",", "inverseM", ",", "f", ",", 
       "distortions", ",", "\[IndentingNewLine]", "coordinates", ",", 
       "coordinatesCartesian", ",", "newCoordinates", ",", 
       "\[IndentingNewLine]", "crystalCopy"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Input", " ", "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringQ", "@", "newLabel"}]}], "||", 
         RowBox[{"newLabel", "===", "\"\<\>\""}]}], ",", 
        RowBox[{"newLabel", "=", "crystal"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Cartesian\>\"", ",", "\"\<Crystallographic\>\""}], 
            "}"}], ",", "distortionType"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"EmbedStructure", "::", "InvalidDistortionType"}], "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"vectorField", ",", "variables"}], "}"}]}], "=!=", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"DistortStructure", "::", "InvalidDimensions"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Vector", " ", "field", " ", "function"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "[", "xyz_", "]"}], ":=", 
       RowBox[{
        RowBox[{"N", "@", "vectorField"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"variables", "\[Rule]", "xyz"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Calculate", " ", "individual", " ", "distortions"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"coordinates", "=", 
       RowBox[{"$CrystalData", "\[LeftDoubleBracket]", 
        RowBox[{
        "crystal", ",", "\"\<AtomData\>\"", ",", "All", ",", 
         "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"distortions", "=", 
       RowBox[{"f", "/@", "coordinates"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Determine", " ", "distortion", " ", "type"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"distortionType", "===", "\"\<Cartesian\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"M", "=", 
          RowBox[{"GetCrystalMetric", "[", 
           RowBox[{"crystal", ",", 
            RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"inverseM", "=", 
          RowBox[{"Inverse", "@", "M"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"coordinatesCartesian", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"M", ".", "#"}], "&"}], "/@", "coordinates"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newCoordinates", "=", 
          RowBox[{"coordinatesCartesian", "+", "distortions"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newCoordinates", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"inverseM", ".", "#"}], "&"}], "/@", 
           "newCoordinates"}]}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Shifts", " ", "in", " ", "a", " ", "pure", " ", "crystallographic", 
          " ", "frame"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newCoordinates", "=", 
         RowBox[{"coordinates", "+", "distortions"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Create", " ", "new", " ", "entry", " ", "in", " ", "`$CrystalData`"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"crystalCopy", "=", 
       RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"crystalCopy", "\[LeftDoubleBracket]", 
        RowBox[{
        "\"\<AtomData\>\"", ",", "All", ",", 
         "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}], "=", 
       "newCoordinates"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"$CrystalData", ",", 
        RowBox[{"newLabel", "\[Rule]", "crystalCopy"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Update", " ", "auto"}], "-", "completion"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
      "InputCheck", "[", "\"\<Update$CrystalDataAutoCompletion\>\"", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "newLabel"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.76407760636029*^9, 3.764077611000743*^9}, {
   3.7640776550010777`*^9, 3.764077673503346*^9}, {3.764077733120105*^9, 
   3.7640777339422092`*^9}, {3.764089221471836*^9, 3.764089246819138*^9}, {
   3.764089579320651*^9, 3.7640897291400757`*^9}, {3.764089761555708*^9, 
   3.76408976345118*^9}, {3.7640898106284943`*^9, 3.764090120594932*^9}, {
   3.764090164987732*^9, 3.764090218421933*^9}, {3.7640903173197527`*^9, 
   3.764090366310265*^9}, 3.7640904073023043`*^9, {3.764090484109116*^9, 
   3.764090587061961*^9}, {3.764090644616991*^9, 3.764090761212126*^9}, {
   3.7640908463715076`*^9, 3.764090859268345*^9}, {3.764090918867914*^9, 
   3.7640910429746733`*^9}, {3.764091079061781*^9, 3.76409116160111*^9}, {
   3.764091232287566*^9, 3.764091273923717*^9}, {3.764091366481679*^9, 
   3.7640914397121353`*^9}, {3.7640914826794662`*^9, 3.764091510293401*^9}, {
   3.764091876119646*^9, 3.764091956962891*^9}, {3.764092075699294*^9, 
   3.7640921879907207`*^9}, {3.7640924205602083`*^9, 
   3.7640924471960583`*^9}, {3.76409409540969*^9, 3.764094187741025*^9}, {
   3.7640942198617983`*^9, 3.7640942234741583`*^9}, {3.764094317994389*^9, 
   3.764094327629712*^9}, {3.764094736096356*^9, 3.764094771726056*^9}, {
   3.764094808893106*^9, 3.764094809019492*^9}, 3.764095038809267*^9, {
   3.765103518153047*^9, 3.765103587473827*^9}, {3.7651038193847713`*^9, 
   3.765103862705112*^9}, {3.765103919552752*^9, 3.765103920302374*^9}, {
   3.765103972134193*^9, 3.765104162370229*^9}, {3.765355492362525*^9, 
   3.765355493359848*^9}, {3.768886609491247*^9, 3.768886611594913*^9}, {
   3.768892464288546*^9, 3.768892529745674*^9}, {3.768892653877145*^9, 
   3.768892654598649*^9}, {3.768892771389144*^9, 3.76889278789213*^9}, {
   3.768893116506147*^9, 3.768893130412468*^9}, {3.7688932852563267`*^9, 
   3.7688932909292517`*^9}, {3.7688936364396667`*^9, 
   3.7688936608833227`*^9}, {3.768893695527102*^9, 3.76889374421351*^9}, {
   3.768893863042292*^9, 3.7688938876936913`*^9}, {3.768893923879408*^9, 
   3.7688939544192467`*^9}, {3.768893987348392*^9, 3.768893987543693*^9}, {
   3.768894168535639*^9, 3.768894172184104*^9}, {3.768894246339163*^9, 
   3.768894246681491*^9}, {3.769234203541739*^9, 3.769234206852635*^9}, {
   3.7692342431819763`*^9, 3.769234292793686*^9}, {3.769234322897381*^9, 
   3.769234424185979*^9}, {3.7692344714237843`*^9, 3.769234475210466*^9}, {
   3.769234581988104*^9, 3.769234582194984*^9}, {3.7692348086389227`*^9, 
   3.769234948677593*^9}, {3.769235276351882*^9, 3.76923530202918*^9}, {
   3.769236531534154*^9, 3.769236590961705*^9}, {3.769236931979405*^9, 
   3.7692369616190653`*^9}, {3.774162893840859*^9, 3.7741629048580923`*^9}, {
   3.780380202732039*^9, 3.780380204430646*^9}, {3.786967996501526*^9, 
   3.786967997923258*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[563]:=",ExpressionUUID->"7515078e-96bb-4d8d-9ed6-1cc2b1009ac2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[564]:=",ExpressionUUID->"5d901a36-c86b-47b9-b670-a1045587b260"]
}, Closed]],

Cell[CellGroupData[{

Cell["DomainPlot", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.778393857909237*^9, 
   3.7783938593413057`*^9}},ExpressionUUID->"fa3b1e28-6287-43a3-a048-\
475bb2a1f590"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[565]:=",ExpressionUUID->"9c40b441-47d5-4fa7-9935-2c0163e20878"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DomainPlot", "::", "InputMismatch"}], "=", 
   "\"\<Input size does not match size of domain list.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DomainPlot", "::", "InvalidDomainIndex"}], "=", 
    "\"\<Domain identifiers must be non-negative integers\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "DomainPlot"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Colours\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "Red", ",", "Green", ",", "Blue", ",", "Yellow", ",", "Purple"}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<CrystalFamily\>\"", "\[Rule]", "\"\<Cubic\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<GraphicFunction\>\"", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Opacity", "\[Rule]", "1.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<RotationAnchorReference\>\"", "\[Rule]", 
       "\"\<DomainCentroid\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAnchorShift\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationMap\>\"", "\[Rule]", 
       RowBox[{"<|", "|>"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "DomainPlot"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "_"}], "}"}], ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
   3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
   3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
   3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
   3.756710476208014*^9}, {3.7783938695145197`*^9, 3.778393898177862*^9}, {
   3.7783939288296223`*^9, 3.77839394384756*^9}, {3.778394076369825*^9, 
   3.778394077265583*^9}, {3.778822860934101*^9, 3.778822878428409*^9}, {
   3.778952269579671*^9, 3.778952305409567*^9}, 3.778954976903851*^9, {
   3.778959819264042*^9, 3.7789598532933617`*^9}, {3.778999895457884*^9, 
   3.778999896375359*^9}, {3.779000859857057*^9, 3.779000860716202*^9}, {
   3.779001947214672*^9, 3.779002000150318*^9}, {3.779007908434515*^9, 
   3.779007920922791*^9}, {3.7790091110245113`*^9, 3.779009111703333*^9}, {
   3.779046056991394*^9, 3.779046062917899*^9}, {3.779101376684245*^9, 
   3.779101377273547*^9}, {3.779132082996413*^9, 3.77913208400202*^9}, {
   3.779132126577898*^9, 3.779132127113213*^9}, {3.779542341735259*^9, 
   3.779542343108738*^9}, {3.7795424113239937`*^9, 3.779542420995036*^9}, {
   3.7795634857821703`*^9, 3.779563486611061*^9}, {3.779564916393796*^9, 
   3.7795649300246973`*^9}, {3.779604726425116*^9, 3.779604745831285*^9}, {
   3.779605402363422*^9, 3.779605402994779*^9}, {3.779620478532138*^9, 
   3.779620478693614*^9}, {3.7816789515104*^9, 3.7816789531643972`*^9}, {
   3.781678988508057*^9, 3.7816789917003098`*^9}, {3.781859258902314*^9, 
   3.781859263766994*^9}, 3.781859316939933*^9, {3.78185942886093*^9, 
   3.7818594314515*^9}, {3.781863894349139*^9, 3.781863905660524*^9}, {
   3.781863938960211*^9, 3.7818639399325113`*^9}, {3.781953653747182*^9, 
   3.7819537015684032`*^9}, {3.7819665400715723`*^9, 3.781966540541833*^9}, {
   3.7819687507791777`*^9, 3.781968752889134*^9}, {3.807466916777822*^9, 
   3.8074669209909983`*^9}},
 CellLabel->
  "In[566]:=",ExpressionUUID->"4aa6d0f4-0165-4591-8676-a5f7dc7f5ee9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[570]:=",ExpressionUUID->"364f8ddc-26c6-4eb1-a280-d8a4a14fb4b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DomainPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A_Integer", ",", "B_Integer", ",", "C_Integer"}], "}"}], ",", 
      "allDomains_List"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"domains", "=", "allDomains"}], ",", "seriesQ", ",", 
      "\[IndentingNewLine]", "twoDimensionalQ", ",", 
      RowBox[{"crystalFamily", "=", 
       RowBox[{"OptionValue", "[", "\"\<CrystalFamily\>\"", "]"}]}], ",", 
      RowBox[{"graphicFunction", "=", 
       RowBox[{"OptionValue", "[", "\"\<GraphicFunction\>\"", "]"}]}], ",", 
      "coordinates", ",", "coordinateDomainMap", ",", "M", ",", 
      "makePolytope", ",", "\[IndentingNewLine]", 
      RowBox[{"rotationMap", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationMap\>\"", "]"}]}], ",", 
      "rotationQ", ",", "R", ",", "\[IndentingNewLine]", 
      RowBox[{"anchorShift", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAnchorShift\>\"", "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"anchorReference", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAnchorReference\>\"", "]"}]}],
       ",", "\[IndentingNewLine]", "numberOfDomains", ",", 
      RowBox[{"preferredColours", "=", 
       RowBox[{"OptionValue", "[", "\"\<Colours\>\"", "]"}]}], ",", 
      "coloursToUse", ",", "colourTable", ",", "makeRotatedPolytope", ",", 
      "\[IndentingNewLine]", "MakePlot", ",", "polytopes", ",", 
      "graphicList"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Preparations", " ", "in", " ", "case", " ", "of", " ", "domain", " ", 
      "series"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"seriesQ", "=", 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"Dimensions", "@", "domains"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", 
          RowBox[{"A", "*", "B", "*", "C"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"seriesQ", ",", 
       RowBox[{"domains", "=", 
        RowBox[{"First", "@", "domains"}]}]}], 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "first", " ", "list", " ", "only"}], " ", "*)"}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"twoDimensionalQ", "=", 
      RowBox[{"C", "===", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", "*", "B", "*", "C"}], ")"}], "\[NotEqual]", 
        RowBox[{"Length", "@", "domains"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"DomainPlot", "::", "InputMismatch"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{"domains", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"NonNegative", "[", "#", "]"}], "\[Nand]", 
           RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"DomainPlot", "::", "InvalidDomainIndex"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Preparations", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"numberOfDomains", "=", 
      RowBox[{"Max", "@", "domains"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coordinates", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GenerateTargetPositions\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"twoDimensionalQ", ",", 
       RowBox[{"coordinates", "=", 
        RowBox[{"coordinates", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"coordinateDomainMap", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", 
        RowBox[{"coordinates", "\[Rule]", "domains"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"coloursToUse", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"preferredColours", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"96", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"numberOfDomains", "-", 
           RowBox[{"Length", "@", "preferredColours"}]}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"colourTable", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"<|", 
         RowBox[{"0", "\[Rule]", "Transparent"}], "|>"}], ",", 
        RowBox[{"Association", "@", 
         RowBox[{"Thread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Range", "@", "numberOfDomains"}], "\[Rule]", 
           RowBox[{"coloursToUse", "\[LeftDoubleBracket]", 
            RowBox[{";;", "numberOfDomains"}], "\[RightDoubleBracket]"}]}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Fitting", " ", "to", " ", "given", " ", "crystal", " ", "system"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "\"\<GetCrystalFamilyMetric\>\"", ",", "\[IndentingNewLine]", 
        "crystalFamily", ",", 
        RowBox[{"If", "[", 
         RowBox[{"twoDimensionalQ", ",", "\"\<2D\>\"", ",", "\"\<3D\>\""}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coordinateDomainMap", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"M", ".", "#1"}], "\[Rule]", "#2"}], "&"}], ",", 
         "coordinateDomainMap"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"graphicFunction", "=!=", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"makePolytope", "=", "graphicFunction"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"makePolytope", "[", "origin_", "]"}], ":=", 
        RowBox[{"Parallelepiped", "[", 
         RowBox[{"origin", ",", 
          RowBox[{"Transpose", "@", "M"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Checking", " ", "any", " ", "rotations", " ", "of", " ", "domains"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rotationQ", "=", 
      RowBox[{"rotationMap", "=!=", 
       RowBox[{"<|", "|>"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"rotationQ", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "=", 
         RowBox[{"InputCheck", "[", 
          RowBox[{
          "\"\<RotationTransformation\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", "domains"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "anchorShift", ",", "anchorReference", ",", "rotationMap"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"makeRotatedPolytope", "[", 
          RowBox[{"xyz_", ",", "d_"}], "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"anchorReference", "===", "\"\<Host\>\""}], "||", 
            RowBox[{"(", 
             RowBox[{"twoDimensionalQ", "&&", 
              RowBox[{"anchorReference", "=!=", "\"\<Unit\>\""}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"GeometricTransformation", "[", 
            RowBox[{
             RowBox[{"makePolytope", "[", "xyz", "]"}], ",", 
             RowBox[{"R", "[", "d", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"GeometricTransformation", "[", 
            RowBox[{
             RowBox[{"makePolytope", "[", "xyz", "]"}], ",", 
             RowBox[{"R", "[", 
              RowBox[{"d", ",", "xyz"}], "]"}]}], "]"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "graphics"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakePlot", "[", "domainMap_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polytopes", "=", 
         RowBox[{"If", "[", 
          RowBox[{"rotationQ", ",", "\[IndentingNewLine]", 
           RowBox[{"KeyValueMap", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"colourTable", "@", "#2"}], ",", 
                RowBox[{"makeRotatedPolytope", "[", 
                 RowBox[{"#1", ",", "#2"}], "]"}]}], "}"}], "&"}], ",", 
             "domainMap"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"KeyValueMap", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"colourTable", "@", "#2"}], ",", 
                RowBox[{"makePolytope", "@", "#1"}]}], "}"}], "&"}], ",", 
             "domainMap"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"graphicList", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Opacity", "@", 
            RowBox[{"OptionValue", "[", "Opacity", "]"}]}], ",", 
           "polytopes"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"twoDimensionalQ", ",", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"graphicList", ",", 
            RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{"graphicList", ",", 
            RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], "]"}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"seriesQ", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coordinates", "=", 
         RowBox[{"Keys", "@", "coordinateDomainMap"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"MakePlot", "@", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{"coordinates", "\[Rule]", 
             RowBox[{
             "allDomains", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "allDomains"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MakePlot", "@", "coordinateDomainMap"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, 3.7627930930413857`*^9, 3.77839396803053*^9, {
   3.778820107570076*^9, 3.778820126918624*^9}, {3.778820172367231*^9, 
   3.778820174885518*^9}, {3.77882067185793*^9, 3.7788207414337673`*^9}, {
   3.7788207921358757`*^9, 3.778820801226163*^9}, {3.778820996382948*^9, 
   3.778821015927256*^9}, {3.778821347016955*^9, 3.778821352300626*^9}, {
   3.778821386516824*^9, 3.778821405026845*^9}, {3.778824699865258*^9, 
   3.7788248060173197`*^9}, {3.778824848827717*^9, 3.7788248492152357`*^9}, {
   3.77882490113778*^9, 3.77882490172722*^9}, 3.7788249434012203`*^9, {
   3.778824987715786*^9, 3.778825086529162*^9}, {3.778825326520769*^9, 
   3.778825390690998*^9}, {3.778825544020668*^9, 3.7788255498890743`*^9}, {
   3.778825591813675*^9, 3.778825596326383*^9}, {3.778846969061141*^9, 
   3.7788469692990723`*^9}, {3.778847272325433*^9, 3.77884732173888*^9}, {
   3.778847354420401*^9, 3.778847433224267*^9}, {3.778847491945448*^9, 
   3.778847508510831*^9}, {3.778847593493825*^9, 3.778847625869935*^9}, {
   3.7788615504220533`*^9, 3.778861566030381*^9}, {3.77893402603288*^9, 
   3.778934061135666*^9}, {3.778935255758169*^9, 3.778935257429175*^9}, {
   3.778935348148226*^9, 3.7789354036888723`*^9}, {3.778935440990501*^9, 
   3.7789354814082413`*^9}, {3.7789502985725937`*^9, 3.77895044701685*^9}, {
   3.7789505479333553`*^9, 3.778950638231584*^9}, {3.778951843208255*^9, 
   3.778951902679483*^9}, {3.778952263349142*^9, 3.7789522642921124`*^9}, {
   3.7789523102282753`*^9, 3.778952320204196*^9}, {3.778953919047526*^9, 
   3.778954000252705*^9}, {3.778954048618457*^9, 3.778954079138438*^9}, {
   3.7789549641523943`*^9, 3.778954965239654*^9}, {3.7789557172987843`*^9, 
   3.778955744151863*^9}, {3.7789591646330633`*^9, 3.778959191710493*^9}, {
   3.778959240029207*^9, 3.778959277756064*^9}, {3.778959400201935*^9, 
   3.778959401561379*^9}, {3.778959431785816*^9, 3.778959592446004*^9}, {
   3.778959771570674*^9, 3.7789598117045813`*^9}, 3.7789598586642313`*^9, {
   3.778959926472324*^9, 3.778959927614208*^9}, {3.778960510364029*^9, 
   3.7789605232804203`*^9}, {3.778960567969893*^9, 3.778960597191093*^9}, {
   3.778960992434334*^9, 3.778961011887692*^9}, {3.778961062808988*^9, 
   3.778961089318676*^9}, {3.778961142541329*^9, 3.778961219132559*^9}, 
   3.7789612525011683`*^9, {3.778961292419545*^9, 3.778961378495866*^9}, {
   3.778961484279743*^9, 3.778961530724889*^9}, {3.7789615739659843`*^9, 
   3.77896157647616*^9}, {3.77896192980715*^9, 3.778961937676694*^9}, {
   3.778961996269643*^9, 3.7789620122583437`*^9}, {3.778962091931342*^9, 
   3.7789620930487013`*^9}, {3.778962158560989*^9, 3.778962202127589*^9}, {
   3.778962238335184*^9, 3.7789622891242867`*^9}, {3.778962359525539*^9, 
   3.7789623603467484`*^9}, {3.7789625981271553`*^9, 3.778962601877273*^9}, {
   3.778962674749792*^9, 3.778962686342181*^9}, {3.778962751184947*^9, 
   3.7789627716756077`*^9}, {3.778962811074438*^9, 3.77896282294944*^9}, {
   3.7789628599630833`*^9, 3.778962872179976*^9}, {3.7789630524667883`*^9, 
   3.778963053776197*^9}, {3.778999916510323*^9, 3.778999918339634*^9}, {
   3.778999962574134*^9, 3.7789999672211447`*^9}, {3.7790007787371197`*^9, 
   3.779000793943783*^9}, {3.779001204285698*^9, 3.779001265394004*^9}, {
   3.779001483431231*^9, 3.779001508959731*^9}, {3.779001699503317*^9, 
   3.779001771839829*^9}, {3.779001861402869*^9, 3.7790018631583033`*^9}, {
   3.779001894553171*^9, 3.77900192084683*^9}, {3.779002021906558*^9, 
   3.779002050457003*^9}, {3.779002120250176*^9, 3.779002128604896*^9}, {
   3.779002183954287*^9, 3.779002200087284*^9}, {3.7790024172212553`*^9, 
   3.7790024528136272`*^9}, {3.779002612703917*^9, 3.779002615815997*^9}, 
   3.779002666194558*^9, {3.779002811368451*^9, 3.7790028471983023`*^9}, {
   3.779003208577128*^9, 3.7790032569293737`*^9}, {3.7790033076746187`*^9, 
   3.7790033157381973`*^9}, {3.779004020825889*^9, 3.7790041179785767`*^9}, {
   3.779004811480001*^9, 3.7790048474636993`*^9}, {3.7790066319135027`*^9, 
   3.7790066590935907`*^9}, {3.7790066977388697`*^9, 3.779006719163795*^9}, {
   3.779006757974936*^9, 3.7790067614052277`*^9}, {3.779006835820278*^9, 
   3.779006837337995*^9}, {3.779006973871044*^9, 3.779006974663103*^9}, {
   3.779007025876602*^9, 3.779007026326079*^9}, {3.7790071330329943`*^9, 
   3.779007151138534*^9}, {3.7790072878908653`*^9, 3.779007298726532*^9}, {
   3.779007425608262*^9, 3.779007426186386*^9}, {3.779007568289116*^9, 
   3.7790075691780863`*^9}, {3.779007647015977*^9, 3.779007718597217*^9}, {
   3.779007810275612*^9, 3.779007819452279*^9}, {3.77900785041028*^9, 
   3.779007950381036*^9}, {3.779008003288294*^9, 3.779008007279051*^9}, {
   3.779008963294952*^9, 3.7790090802029467`*^9}, {3.7790093166969852`*^9, 
   3.779009351689014*^9}, {3.7790094793170557`*^9, 3.779009568016346*^9}, {
   3.7790096167280188`*^9, 3.7790096518091497`*^9}, {3.779009688499694*^9, 
   3.7790096903825083`*^9}, {3.779011924941119*^9, 3.779012007089539*^9}, {
   3.779012108645092*^9, 3.7790121392233047`*^9}, {3.779012180231926*^9, 
   3.779012193966757*^9}, {3.7790124062090816`*^9, 3.7790124771310368`*^9}, {
   3.77901316780553*^9, 3.779013171007272*^9}, {3.779013365227377*^9, 
   3.779013418937316*^9}, {3.779013467026578*^9, 3.779013512691662*^9}, {
   3.779013574431054*^9, 3.7790135775913763`*^9}, {3.779013637884959*^9, 
   3.779013658849807*^9}, {3.779013713529519*^9, 3.779013715000005*^9}, {
   3.779013753566025*^9, 3.779013778847309*^9}, {3.779013830383601*^9, 
   3.77901386411554*^9}, 3.779013953371379*^9, {3.7790140520272818`*^9, 
   3.779014054813897*^9}, {3.779014094097603*^9, 3.779014115853959*^9}, {
   3.779018219481862*^9, 3.7790183817415047`*^9}, {3.779036512454494*^9, 
   3.779036522939954*^9}, {3.779036978820792*^9, 3.779036990530486*^9}, {
   3.7790370367144127`*^9, 3.779037085872443*^9}, {3.779037146481399*^9, 
   3.779037156936326*^9}, {3.7790373798597593`*^9, 3.7790374352167273`*^9}, {
   3.779037475288199*^9, 3.779037500975648*^9}, {3.7790376656527777`*^9, 
   3.7790376820591803`*^9}, {3.779037734739072*^9, 3.7790377642418957`*^9}, {
   3.779037872289434*^9, 3.7790379375606327`*^9}, {3.7790379765749063`*^9, 
   3.779037999430995*^9}, {3.779038043645528*^9, 3.779038114258492*^9}, {
   3.779038179626939*^9, 3.779038257503357*^9}, {3.779038616927946*^9, 
   3.779038617295425*^9}, {3.779039112289215*^9, 3.779039112910562*^9}, {
   3.779039146127808*^9, 3.779039243244431*^9}, {3.779039309452442*^9, 
   3.7790393463700743`*^9}, {3.7790393873648252`*^9, 
   3.7790394259520817`*^9}, {3.779039658636862*^9, 3.779039665339354*^9}, {
   3.7790397016293488`*^9, 3.7790397053715754`*^9}, {3.7790397799458857`*^9, 
   3.779039844759807*^9}, {3.779039876361437*^9, 3.779039958552814*^9}, {
   3.7790405365875807`*^9, 3.779040543033502*^9}, {3.779040993569069*^9, 
   3.7790410036792803`*^9}, {3.7790410369505053`*^9, 3.7790410448621264`*^9}, 
   3.779041129910829*^9, {3.779041160333434*^9, 3.7790411645631037`*^9}, {
   3.779041203908268*^9, 3.779041206322308*^9}, {3.7790460696654797`*^9, 
   3.779046097032278*^9}, {3.779093720216074*^9, 3.779093724037397*^9}, {
   3.779093756457243*^9, 3.779093769934472*^9}, {3.779093863736862*^9, 
   3.7790938702054977`*^9}, {3.779093906833427*^9, 3.77909391796776*^9}, {
   3.779093964494224*^9, 3.779094013299913*^9}, {3.779094049984754*^9, 
   3.779094081974938*^9}, 3.7790941625695047`*^9, {3.7790942073804913`*^9, 
   3.7790942202607527`*^9}, {3.7790942513092012`*^9, 3.779094286616645*^9}, {
   3.779099503343889*^9, 3.779099510044094*^9}, 3.779102554303453*^9, {
   3.779126038339951*^9, 3.7791260535539303`*^9}, {3.7791306765767612`*^9, 
   3.7791306995752296`*^9}, {3.779130772053299*^9, 3.779130846752757*^9}, {
   3.779130976029971*^9, 3.7791310151253223`*^9}, {3.7791310933317204`*^9, 
   3.779131095011395*^9}, {3.7791312474740047`*^9, 3.779131249271612*^9}, {
   3.779131289495985*^9, 3.779131342893703*^9}, {3.7791314029199266`*^9, 
   3.7791315566412907`*^9}, {3.7791316312508993`*^9, 3.779131702709215*^9}, {
   3.77913174964485*^9, 3.779131793802815*^9}, {3.779131839403425*^9, 
   3.779131911088719*^9}, {3.779131948954524*^9, 3.77913195801794*^9}, {
   3.779132004208296*^9, 3.779132033821329*^9}, {3.779132206242516*^9, 
   3.779132215081346*^9}, {3.779542686639044*^9, 3.7795426976788883`*^9}, {
   3.779544671936179*^9, 3.779544693165428*^9}, {3.77955072823742*^9, 
   3.779550730173306*^9}, {3.7795648657190228`*^9, 3.7795648717567177`*^9}, {
   3.77956497833959*^9, 3.779564990657694*^9}, {3.779565082713812*^9, 
   3.7795651069426813`*^9}, {3.7795651883266478`*^9, 3.779565193173009*^9}, {
   3.779565407857689*^9, 3.779565539701556*^9}, {3.779565570854636*^9, 
   3.779565592223811*^9}, 3.779566528990271*^9, {3.7796034511743927`*^9, 
   3.779603519612215*^9}, {3.7796035517806053`*^9, 3.779603579444847*^9}, {
   3.779603806569478*^9, 3.779603811192848*^9}, 3.779603846833778*^9, {
   3.779603985735434*^9, 3.779604010164752*^9}, {3.7796041649397182`*^9, 
   3.779604165378793*^9}, {3.779604598933448*^9, 3.779604750962077*^9}, {
   3.779605940849968*^9, 3.779605940977306*^9}, {3.7796063590819263`*^9, 
   3.779606359257155*^9}, {3.779606608939646*^9, 3.7796066658656893`*^9}, {
   3.779606841567293*^9, 3.779606842558208*^9}, {3.779606874398141*^9, 
   3.779606911876989*^9}, 3.7796069668209953`*^9, {3.779607006972199*^9, 
   3.7796070495690193`*^9}, {3.779618896112294*^9, 3.779618903126152*^9}, {
   3.779619411463447*^9, 3.779619422475821*^9}, {3.779619473563892*^9, 
   3.7796195090390053`*^9}, {3.77961958940639*^9, 3.77961959233558*^9}, {
   3.779619757871492*^9, 3.779619784505307*^9}, 3.779620487995225*^9, {
   3.77962054061347*^9, 3.779620639940631*^9}, 3.779620720975492*^9, 
   3.779620912750801*^9, {3.7800634094825773`*^9, 3.780063430269939*^9}, 
   3.780063481065598*^9, {3.781678969783777*^9, 3.781678978382593*^9}, {
   3.78168546193715*^9, 3.781685482208407*^9}, 3.781859272358444*^9, {
   3.7818593193338757`*^9, 3.7818593195392017`*^9}, 3.7818593833612623`*^9, 
   3.781859436159031*^9, {3.7818639940577593`*^9, 3.781864002722919*^9}, 
   3.781864067233588*^9, {3.781950771770952*^9, 3.7819507794891233`*^9}, {
   3.781951908477002*^9, 3.7819519103304577`*^9}, {3.781951995963245*^9, 
   3.781951996120875*^9}, {3.781952057233232*^9, 3.781952070278882*^9}, {
   3.781952104648212*^9, 3.781952138006064*^9}, {3.781952858675034*^9, 
   3.7819528630713177`*^9}, {3.781952935230081*^9, 3.7819529359636593`*^9}, {
   3.781953158136344*^9, 3.78195316032825*^9}, {3.781953191912602*^9, 
   3.781953215951618*^9}, {3.781953264589658*^9, 3.781953264924047*^9}, 
   3.781953553959934*^9, {3.781953586150592*^9, 3.7819536364201593`*^9}, {
   3.781960490994595*^9, 3.781960497215815*^9}, {3.7819617333915977`*^9, 
   3.7819617336852703`*^9}, {3.781966546658682*^9, 3.7819665565606537`*^9}, {
   3.781968066149269*^9, 3.7819681249804497`*^9}, {3.781968172946484*^9, 
   3.781968173144689*^9}, {3.7819682384086637`*^9, 3.781968253606758*^9}, {
   3.781968507250236*^9, 3.781968516098647*^9}, {3.781968936081249*^9, 
   3.781968969886332*^9}, {3.781969004973576*^9, 3.781969024901784*^9}, {
   3.781969087172738*^9, 3.78196917558029*^9}, {3.781969499933185*^9, 
   3.781969514946437*^9}, {3.781969631849455*^9, 3.7819696321118097`*^9}, {
   3.781969674320839*^9, 3.781969677790588*^9}, {3.7819697180541477`*^9, 
   3.781969734207429*^9}, {3.781969799660811*^9, 3.781969837707428*^9}, 
   3.781969901091116*^9, {3.781970686742758*^9, 3.781970695108632*^9}, 
   3.781973749829962*^9, 3.781974294801626*^9, {3.7819760099989843`*^9, 
   3.781976012965131*^9}, 3.7819760481829777`*^9, 3.781985092211667*^9, {
   3.781985307733795*^9, 3.781985359363262*^9}, {3.782021725817206*^9, 
   3.7820217267677317`*^9}, {3.782021777278948*^9, 3.782021796543262*^9}, {
   3.78202294487101*^9, 3.782022945092609*^9}, {3.782023175568842*^9, 
   3.782023205415444*^9}, {3.804581443738765*^9, 3.804581524097353*^9}, {
   3.804581568341758*^9, 3.80458157964037*^9}, {3.804581863623909*^9, 
   3.8045818718003387`*^9}, {3.804581987528365*^9, 3.804582130728425*^9}, {
   3.804582234007798*^9, 3.8045822431965427`*^9}, {3.804582665749*^9, 
   3.804582738420783*^9}, {3.8045829199785233`*^9, 3.804582928220147*^9}, {
   3.804582976684347*^9, 3.8045829892702227`*^9}, {3.804583046077262*^9, 
   3.804583048568445*^9}, {3.8045832067627068`*^9, 3.804583211649191*^9}, {
   3.8045837937506647`*^9, 3.8045839162989073`*^9}, {3.804584442663656*^9, 
   3.804584488457818*^9}, {3.8045845628183317`*^9, 3.804584564431533*^9}, {
   3.804584621967166*^9, 3.804584650751348*^9}, {3.804584826505225*^9, 
   3.8045849598500347`*^9}, {3.8045850407656307`*^9, 
   3.8045850471696167`*^9}, {3.808108041847061*^9, 3.808108046611652*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[571]:=",ExpressionUUID->"0a23fef8-a5e5-457a-8385-358a1637ce28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[572]:=",ExpressionUUID->"29c961dc-1405-49b6-9ef8-68b160183866"]
}, Closed]],

Cell[CellGroupData[{

Cell["EmbedStructure", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.76094992673088*^9, 3.760949928918248*^9}, {
   3.76210239515066*^9, 3.7621023967322397`*^9}, 3.7629378913230247`*^9, 
   3.763134566815321*^9, 
   3.782489097261496*^9},ExpressionUUID->"5494cdfd-bf88-4eb7-9470-\
ccaa5447a242"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[573]:=",ExpressionUUID->"93aa1d40-13a5-4db7-a12a-e193c3641339"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidGuestInput"}], "=", 
   "\"\<Invalid guest unit input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidTargetPositions"}], "=", 
   "\"\<Invalid position input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidProbabilities"}], "=", 
   "\"\<The probabilities must be numbers between 0 and 1.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidTrimming"}], "=", 
   "\"\<Invalid setting for \\\"TrimBoundary\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidAlteration"}], "=", 
   "\"\<Invalid input for \\\"Distortions\\\" or \\\"Rotations\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidAlterationValues"}], "=", 
   "\"\<Distortion/rotation amplitudes should be numeric and on the form \
\[Delta] or {\!\(\*SubscriptBox[\(\[Delta]\), \(min\)]\), \!\(\*SubscriptBox[\
\(\[Delta]\), \(max\)]\)}.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidDistortionType"}], "=", 
   "\"\<\\\"DistortionType\\\" must be set to either \\\"Crystallographic\\\" \
or \\\"Cartesian\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidOverlapRadius"}], "=", 
   "\"\<\\\"OverlapRadius\\\" must be numeric.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EmbedStructure", "::", "InvalidAnchorReference"}], "=", 
    "\"\<Anchor reference type \[LeftGuillemet]`1`\[RightGuillemet] is \
invalid. Use either \\\"Host\\\" or \\\"Unit\\\".\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "EmbedStructure"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<DataFile\>\"", "\[Rule]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "$MaXrdPath", ",", "\"\<UserData\>\"", ",", 
          "\"\<CrystalData.m\>\""}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<DistortionType\>\"", "\[Rule]", "\"\<Cartesian\>\""}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"\"\<Distortions\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<MatchHostSize\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<OverlapPrecedence\>\"", "\[Rule]", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<OverlapRadius\>\"", "\[Rule]", "1.0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAnchorReference\>\"", "\[Rule]", "\"\<Unit\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAnchorShift\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAxes\>\"", "\[Rule]", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Rotations\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ShowProgress\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TrimBoundary\>\"", "\[Rule]", "\"\<None\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "EmbedStructure"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
   3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
   3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
   3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
   3.756710476208014*^9}, {3.7609499395994596`*^9, 3.760949952210801*^9}, {
   3.761382798168702*^9, 3.761382801188806*^9}, 3.761387743299842*^9, {
   3.7614169595191708`*^9, 3.761416989634704*^9}, {3.7625819241187563`*^9, 
   3.762581936362295*^9}, {3.76258884302853*^9, 3.762588851450523*^9}, 
   3.762589076924967*^9, {3.7625896339775553`*^9, 3.762589658596109*^9}, {
   3.762624399303061*^9, 3.762624399644244*^9}, {3.762677244824601*^9, 
   3.762677250311742*^9}, {3.762678377818852*^9, 3.7626784018057003`*^9}, {
   3.762678443594308*^9, 3.762678456014505*^9}, {3.762679553558345*^9, 
   3.762679555529254*^9}, {3.7626795868803377`*^9, 3.762679589719862*^9}, {
   3.762693565936051*^9, 3.7626935757572193`*^9}, {3.7627708510092287`*^9, 
   3.762770902407785*^9}, {3.76277179929348*^9, 3.762771800034438*^9}, {
   3.7628413129023113`*^9, 3.76284131999476*^9}, {3.762843408755947*^9, 
   3.762843409129547*^9}, {3.762844593824188*^9, 3.76284459455064*^9}, {
   3.762851310564897*^9, 3.7628513452626543`*^9}, {3.762855042249198*^9, 
   3.762855042887886*^9}, {3.7628699773896217`*^9, 3.7628700048433533`*^9}, {
   3.763193246869672*^9, 3.7631932885385237`*^9}, {3.763193413351872*^9, 
   3.7631934411868467`*^9}, {3.763198723049367*^9, 3.763198725398521*^9}, {
   3.7632157129389343`*^9, 3.763215717492394*^9}, {3.7632165211553783`*^9, 
   3.7632165319698553`*^9}, {3.763216646528513*^9, 3.763216696534143*^9}, {
   3.765784696315958*^9, 3.765784707567667*^9}, {3.765790502921135*^9, 
   3.7657905248017673`*^9}, {3.77056852074228*^9, 3.770568525131774*^9}, {
   3.770984647562096*^9, 3.7709846991780033`*^9}, {3.770984848565778*^9, 
   3.770984857912917*^9}, {3.770985219817625*^9, 3.770985223082101*^9}, {
   3.770985450191299*^9, 3.7709854783842793`*^9}, {3.770992189707036*^9, 
   3.7709921929106007`*^9}, {3.770998586720235*^9, 3.770998630878776*^9}, {
   3.7709994394780807`*^9, 3.7709994676277742`*^9}, {3.771003700248787*^9, 
   3.7710037223506413`*^9}, {3.771062398447394*^9, 3.7710623986299877`*^9}, {
   3.7710682563038692`*^9, 3.771068256495512*^9}, {3.771072269351981*^9, 
   3.7710722697192373`*^9}, {3.771147162046124*^9, 3.771147162172696*^9}, {
   3.7711472456758204`*^9, 3.7711472458133707`*^9}, 3.771147308234413*^9, {
   3.771233665717082*^9, 3.7712336713498*^9}, 3.7712366736666718`*^9, {
   3.7712385928068657`*^9, 3.7712385933026533`*^9}, {3.7741583744973583`*^9, 
   3.774158377341235*^9}, {3.7741805701112127`*^9, 3.774180570637176*^9}, {
   3.774200919292948*^9, 3.774200919668045*^9}, {3.777883096717073*^9, 
   3.777883100983252*^9}, {3.777883938782524*^9, 3.777883944398428*^9}, {
   3.777883984269555*^9, 3.777883995132277*^9}, {3.777884623063896*^9, 
   3.777884623306731*^9}, {3.778342084180808*^9, 3.778342084346471*^9}, {
   3.781613011768538*^9, 3.781613016878516*^9}, {3.781613151868073*^9, 
   3.7816131530434237`*^9}, {3.781625273343232*^9, 3.7816252735176067`*^9}, {
   3.781625334892302*^9, 3.781625349875886*^9}, {3.781625474169647*^9, 
   3.781625480833067*^9}, {3.781625760651558*^9, 3.781625760955124*^9}, {
   3.781684829598894*^9, 3.7816848692840347`*^9}, {3.781684980507568*^9, 
   3.781685005416746*^9}, {3.781859458714085*^9, 3.781859482154834*^9}, {
   3.78186192528793*^9, 3.781861927775096*^9}, {3.781864298646525*^9, 
   3.781864300954008*^9}, {3.781970213486908*^9, 3.781970215916421*^9}, 
   3.7819704760810137`*^9, {3.781983607507371*^9, 3.781983616249364*^9}, {
   3.782027511923891*^9, 3.7820275577518587`*^9}, {3.782035366577327*^9, 
   3.7820353668874407`*^9}, {3.782038024067473*^9, 3.782038026305305*^9}, {
   3.7820399583383408`*^9, 3.782039958527977*^9}, {3.7820408291757793`*^9, 
   3.782040834638109*^9}, {3.782041319700388*^9, 3.7820413199314117`*^9}, {
   3.787916049118555*^9, 3.7879160492610683`*^9}, {3.787917965124247*^9, 
   3.787917965418146*^9}, {3.8080518359824753`*^9, 3.808051836128194*^9}},
 CellLabel->
  "In[574]:=",ExpressionUUID->"72f4076a-4b75-4b70-b7fc-b9626ec21a01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[585]:=",ExpressionUUID->"7d729f40-b95b-4df8-b18e-1585c325c35b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
   RowBox[{
   "guestUnitsInput_", ",", "\[IndentingNewLine]", 
    "targetPositionsInput_List", ",", "\[IndentingNewLine]", 
    "hostCrystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newStructureLabel", "=", 
       RowBox[{"OptionValue", "[", "\"\<NewLabel\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "invAbort", ",", 
      RowBox[{"conditionFilterQ", "=", "False"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"crystalDataOriginal", "=", "$CrystalData"}], ",", 
      RowBox[{"dataFile", "=", 
       RowBox[{"OptionValue", "[", "\"\<DataFile\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "hostStructureSize", ",", "newSize", ",", 
      "\[IndentingNewLine]", "probabilities", ",", "units", ",", 
      "distributionList", ",", "i", ",", "\[IndentingNewLine]", "guestUnits", 
      ",", "guestCopies", ",", "crystalLabels", ",", "specialCrystalLabels", 
      ",", "nonVoidRange", ",", "\[IndentingNewLine]", 
      RowBox[{"matchHostSizeQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<MatchHostSize\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"anchorShift", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAnchorShift\>\"", "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"anchorReference", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAnchorReference\>\"", "]"}]}],
       ",", "\[IndentingNewLine]", "R", ",", 
      RowBox[{"rotationAxes", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAxes\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"targetPositions", "=", "targetPositionsInput"}], ",", 
      "embedLength", ",", "latticeTargetPositions", ",", "hostCoordinates", 
      ",", "mid", ",", "\[IndentingNewLine]", "latticeParameters", ",", 
      "latticeParametersABC", ",", "hostM", ",", "hostMinverse", ",", 
      "targetPositionsCartesian", ",", "\[IndentingNewLine]", "completed", 
      ",", "M", ",", "T", ",", "p", ",", "P", ",", "CheckAndMakeRuleList", 
      ",", "\[IndentingNewLine]", "distortions", ",", "rotations", ",", 
      "performShift", ",", "performTwist", ",", "\[IndentingNewLine]", 
      "conditions", ",", "list", ",", "shift", ",", "twist", ",", 
      "\[IndentingNewLine]", "MakeAlteration", ",", "PrepareAlterationList", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"conditionedDistortionsQ", "=", "False"}], ",", 
      RowBox[{"conditionedRotationsQ", "=", "False"}], ",", 
      "\[IndentingNewLine]", "coordinatesCrystal", ",", 
      "coordinatesCartesian", ",", "\[IndentingNewLine]", 
      "coordinatesCrystalEmbedded", ",", 
      "coordinatesCrystalEmbeddedTranslated", ",", "\[IndentingNewLine]", 
      "newCoordinates", ",", "newCoordinatesCartesian", ",", 
      "\[IndentingNewLine]", "atomDataHost", ",", "atomDataGuest", ",", 
      "joinedAtomData", ",", "boundary", ",", "hostCopy", ",", 
      "newUnitCellAtomCount", ",", "\[IndentingNewLine]", "findOverlap", ",", 
      "intervals", ",", "checks", ",", "atomData1", ",", "atomData2", ",", 
      "xyz1", ",", "xyz2", ",", "nearestList", ",", "overlappingCoordinates", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"overlapPrecedence", "=", 
       RowBox[{"OptionValue", "[", "\"\<OverlapPrecedence\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"overlapRadius", "=", 
       RowBox[{"OptionValue", "[", "\"\<OverlapRadius\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", "Input"}]}], " ", 
       RowBox[{"checks", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"boundary", "=", 
      RowBox[{"OptionValue", "[", "\"\<TrimBoundary\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Box\>\"", ",", "\"\<None\>\"", ",", "\"\<OuterEdges\>\""}], 
           "}"}], ",", "boundary"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidTrimming"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "overlapRadius"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidOverlapRadius"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"invAbort", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidGuestInput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"A", ".", " ", "'"}], 
        RowBox[{"guestUnits", "'"}], " ", "as", " ", "list", " ", "of", " ", 
        "crystals", " ", "or", " ", "elements"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListQ", "@", "guestUnitsInput"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"guestUnitsInput", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"invAbort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"A", ".", "a", ".", " ", "Regular"}], " ", "crystal", " ", 
           "entries"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"AllTrue", "[", 
            RowBox[{"guestUnitsInput", ",", "StringQ"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Depth", "@", "guestUnitsInput"}], "===", "2"}], ")"}]}],
           ",", "\[IndentingNewLine]", "\t", "Null", 
          RowBox[{"(*", " ", 
           RowBox[{"Check", " ", "complete"}], " ", "*)"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"A", ".", "b", ".", " ", "Conditional"}], " ", "rules"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"AllTrue", "[", 
            RowBox[{"guestUnitsInput", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "#", "]"}], "===", "Rule"}], "&"}]}], 
            "]"}], "&&", "\[IndentingNewLine]", "\t", 
           RowBox[{"AllTrue", "[", 
            RowBox[{
             RowBox[{"guestUnitsInput", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "#", "]"}], "===", "Condition"}], "&"}]}],
             "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"conditionFilterQ", "=", "True"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{"invAbort", "[", "]"}]}], "\[IndentingNewLine]", "\t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"B", ".", " ", "'"}], 
         RowBox[{"guestUnits", "'"}], " ", "as", " ", "list", " ", "paired", 
         " ", "with", " ", "probabilities"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "@", "guestUnitsInput"}], "===", "Rule"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Length", "/@", "guestUnitsInput"}], ",", 
             RowBox[{"x_", "\[Rule]", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", "\[Equal]", "x"}]}]}]}], "]"}]}], ",", 
          RowBox[{"invAbort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{
             RowBox[{
             "guestUnitsInput", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"0.0", "\[LessEqual]", "#", "\[LessEqual]", "1.0"}], 
              "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EmbedStructure", "::", "InvalidProbabilities"}], "]"}], 
           ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Invalid", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]",
        "True", ",", 
       RowBox[{"invAbort", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Dimensions", "@", "targetPositionsInput"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "3"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidTargetPositions"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Host\>\"", ",", "\"\<Unit\>\""}], "}"}], ",", 
          "anchorReference"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"EmbedStructure", "::", "InvalidAnchorReference"}], ",", 
          "anchorReference"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Checking"}]}], " ", "and", " ", "preparing", " ", 
        
        RowBox[{"embeddings", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"crystalLabels", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"hostCrystal", ",", "guestUnitsInput"}], "}"}], "]"}], ",",
          "_String", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Scan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<CrystalEntityQ\>\"", ",", "#"}], "]"}], "&"}], ",", 
       "crystalLabels"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"specialCrystalLabels", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<HandleSpecialLabels\>\"", ",", "crystalLabels"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"overlapRadius", "=", 
      RowBox[{"overlapRadius", "/", 
       RowBox[{
        RowBox[{"GetLatticeParameters", "[", "\[IndentingNewLine]", 
         RowBox[{"hostCrystal", ",", 
          RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"hostCopy", "=", 
      RowBox[{"$CrystalData", "[", "hostCrystal", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomDataHost", "=", 
      RowBox[{"hostCopy", "[", "\"\<AtomData\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hostCoordinates", "=", 
      RowBox[{"atomDataHost", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "\"\<FractionalCoordinates\>\""}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hostStructureSize", "=", 
      RowBox[{
       RowBox[{"hostCopy", "[", "\"\<Notes\>\"", "]"}], "[", 
       "\"\<StructureSize\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "hostStructureSize"}]}], ",", 
       RowBox[{"hostStructureSize", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Preparing"}]}], " ", "target", " ", 
        RowBox[{"positions", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"matchHostSizeQ", "&&", 
        RowBox[{"hostStructureSize", "=!=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"latticeTargetPositions", "=", 
         RowBox[{"InputCheck", "[", 
          RowBox[{
          "\"\<GenerateTargetPositions\>\"", ",", "hostStructureSize"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"targetPositions", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{
            "Plus", ",", "\[IndentingNewLine]", "latticeTargetPositions", ",",
              "targetPositions", ",", "1"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"targetPositions", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"targetPositions", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
            "\[IndentingNewLine]", 
            RowBox[{"Or", "@@", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Greater", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                 "hostStructureSize"}], "}"}]}], "]"}]}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"If", " ", "any", " ", "negative", " ", "coordinates"}], 
          ",", " ", 
          RowBox[{
          "assume", " ", "host", " ", "is", " ", "centred", " ", "around", 
           " ", "origin"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "hostCoordinates"}], ",", 
            RowBox[{
             RowBox[{"#", "<", 
              RowBox[{"-", "1."}]}], "&"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mid", "=", 
            RowBox[{"\[LeftFloor]", 
             RowBox[{"hostStructureSize", "/", "2."}], "\[RightFloor]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"targetPositions", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "-", "mid"}], "&"}], "/@", 
             "targetPositions"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"embedLength", "=", 
      RowBox[{"Length", "@", "targetPositions"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "list", " ", "to", " ", "be", " ", "used"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"guestUnits", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"conditionFilterQ", ",", "\[IndentingNewLine]", 
        RowBox[{"targetPositions", "/.", 
         RowBox[{"Append", "[", 
          RowBox[{"guestUnitsInput", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", "True"}], 
            "\[Rule]", "\"\<Void\>\""}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Head", "@", "guestUnitsInput"}], "===", "Rule"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"probabilities", ",", "units"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Keys", "@", "#"}], ",", 
              RowBox[{"Values", "@", "#"}]}], "}"}], "&"}], "@", 
           "guestUnitsInput"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"distributionList", "=", 
          RowBox[{"Round", "[", 
           RowBox[{"probabilities", "*", "embedLength"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", "distributionList"}], "<", "embedLength"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "@", "distributionList"}], "<", 
              "embedLength"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "@", "distributionList"}]}], "}"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "distributionList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "+=", "1"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Total", "@", "distributionList"}], ">", "embedLength"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "@", "distributionList"}], ">", 
              "embedLength"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "@", "distributionList"}]}], "}"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "distributionList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "-=", "1"}]}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"RandomSample", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{"ConstantArray", ",", 
             RowBox[{"{", 
              RowBox[{"units", ",", "distributionList"}], "}"}]}], 
            "]"}]}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{"#", ",", "embedLength", ",", "#"}], "]"}], "&"}], "@", 
         "guestUnitsInput"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"guestCopies", "=", 
      RowBox[{"$CrystalData", "/@", "guestUnits"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nonVoidRange", "=", 
      RowBox[{"Complement", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Range", "@", "embedLength"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", 
          RowBox[{"guestUnits", ",", "\"\<Void\>\""}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nonVoidRange", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"latticeParameters", "=", 
      RowBox[{"GetLatticeParameters", "[", "\[IndentingNewLine]", 
       RowBox[{"hostCrystal", ",", 
        RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"latticeParametersABC", "=", 
      RowBox[{"latticeParameters", "\[LeftDoubleBracket]", 
       RowBox[{";;", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hostM", "=", 
      RowBox[{"GetCrystalMetric", "[", "\[IndentingNewLine]", 
       RowBox[{"hostCrystal", ",", 
        RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hostMinverse", "=", 
      RowBox[{"Inverse", "@", "hostM"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"targetPositionsCartesian", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"hostM", ".", "#"}], "&"}], "/@", "targetPositions"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Distortions"}]}], " ", "and", " ", 
        RowBox[{"rotations", " ", "--"}], " ", "Checks", " ", "and", " ", 
        RowBox[{"preparations", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeAlteration", "[", "c_", "]"}], ":=", "c"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeAlteration", "[", 
       RowBox[{"{", 
        RowBox[{"min_", ",", "max_"}], "}"}], "]"}], ":=", 
      RowBox[{"Hold", "@", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"min", ",", "max"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeAlteration", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
      RowBox[{"MakeAlteration", "/@", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PrepareAlterationList", "[", 
       RowBox[{"conditionsQ_", ",", "ruleList_List"}], "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"conditionsQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conditions", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"ruleList", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", "True"}], 
             "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"list", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"MakeAlteration", ",", "conditions", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{"ReleaseHold", "@", "list"}]}], "&"}], "/@", 
          "targetPositions"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"ReleaseHold", "@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"MakeAlteration", "/@", "ruleList"}], ",", "embedLength"}],
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"distortions", "=", 
      RowBox[{"OptionValue", "[", "\"\<Distortions\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"performShift", "=", 
      RowBox[{"distortions", "=!=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rotations", "=", 
      RowBox[{"OptionValue", "[", "\"\<Rotations\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"performTwist", "=", 
      RowBox[{"rotations", "=!=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rotations", "=", 
      RowBox[{"rotations", "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c_Condition", "\[Rule]", "r_List"}], ")"}], 
          "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"N", "@", "c"}], "\[Rule]", 
            RowBox[{"N", "@", "r"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "}"}], "\[RuleDelayed]", 
          RowBox[{"N", "@", 
           RowBox[{"{", 
            RowBox[{"r1", ",", "r2", ",", "r3"}], "}"}]}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"NumericQ", "[", "#", "]"}], ")"}], "&"}]}], ";", 
     RowBox[{
      RowBox[{"P", "[", "x_", "]"}], ":=", 
      RowBox[{"p", "[", "x", "]"}]}], ";", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"p", "[", "x", "]"}], "&&", 
       RowBox[{"p", "[", "y", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckAndMakeRuleList", "[", "input_", "]"}], ":=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"input", "===", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ")"}], "||", 
           RowBox[{"SubsetQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Integer", ",", "Real", ",", "List"}], "}"}], ",", 
             RowBox[{"Head", "/@", "input"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"False", ",", 
            RowBox[{"CheckAndMakeRuleList", "[", 
             RowBox[{
              RowBox[{"N", "@", "input"}], ",", "\"\<Numeric\>\""}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{"Input", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", "Rule"}], "&"}]}], 
              "]"}], "&&", "\[IndentingNewLine]", 
             RowBox[{"AllTrue", "[", 
              RowBox[{
               RowBox[{"input", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", "Condition"}], 
                "&"}]}], "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "/@", "input"}], "===", 
             RowBox[{"{", 
              RowBox[{"Condition", ",", "List"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"True", ",", 
            RowBox[{"CheckAndMakeRuleList", "[", 
             RowBox[{
              RowBox[{"N", "@", "input"}], ",", "\"\<Conditions\>\""}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EmbedStructure", "::", "InvalidAlteration"}], "]"}], ";",
            "\[IndentingNewLine]", "\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CheckAndMakeRuleList", "[", 
       RowBox[{"input_", ",", "\"\<Conditions\>\""}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"P", "/@", "#"}], ")"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], "&"}], "/@", 
           RowBox[{"input", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EmbedStructure", "::", "InvalidAlterationValues"}], 
            "]"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"input", "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x_Condition", "\[Rule]", "y_"}], "}"}], "\[RuleDelayed]", 
          
          RowBox[{"{", 
           RowBox[{"x", "\[Rule]", 
            RowBox[{"N", "@", "y"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
       "\t", ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CheckAndMakeRuleList", "[", 
       RowBox[{"input_", ",", "\"\<Numeric\>\""}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"P", "/@", "input"}], ")"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EmbedStructure", "::", "InvalidAlterationValues"}], 
            "]"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", "input"}], "\[IndentingNewLine]", "\t", ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"conditionedDistortionsQ", ",", "distortions"}], "}"}], "=", 
      RowBox[{"CheckAndMakeRuleList", "@", "distortions"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distortions", "=", 
      RowBox[{"PrepareAlterationList", "[", 
       RowBox[{"conditionedDistortionsQ", ",", "distortions"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<DistortionType\>\"", "]"}], "===", 
        "\"\<Crystallographic\>\""}], ",", "\[IndentingNewLine]", "Null", ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<DistortionType\>\"", "]"}], "===", 
        "\"\<Cartesian\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"distortions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"hostMinverse", ".", "#"}], "&"}], "/@", "distortions"}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidDistortionType"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"conditionedRotationsQ", ",", "rotations"}], "}"}], "=", 
      RowBox[{"CheckAndMakeRuleList", "@", "rotations"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rotations", "=", 
      RowBox[{"PrepareAlterationList", "[", 
       RowBox[{"conditionedRotationsQ", ",", "rotations"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Actual"}]}], " ", 
        RowBox[{"tranformation", " ", "--"}], " ", "Loop", " ", "through", 
        " ", "each", " ", "guest", " ", 
        RowBox[{"unit", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"If", "[", 
       RowBox[{"performTwist", ",", "\[IndentingNewLine]", 
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<RotationTransformation\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"anchorShift", ",", "anchorReference", ",", 
            RowBox[{"{", "}"}], ",", "rotationAxes"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"completed", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ShowProgress\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"ProgressIndicator", "@", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"completed", "/", "embedLength"}], "]"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{"GetCrystalMetric", "[", 
          RowBox[{
           RowBox[{
           "guestUnits", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"T", "=", 
         RowBox[{"TranslationTransform", "[", 
          RowBox[{
          "targetPositions", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"coordinatesCrystal", "=", "\[IndentingNewLine]", 
         RowBox[{"guestCopies", "\[LeftDoubleBracket]", 
          RowBox[{
          "i", ",", "\"\<AtomData\>\"", ",", "All", ",", 
           "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"coordinatesCartesian", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"M", ".", "#"}], "&"}], "/@", "coordinatesCrystal"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"coordinatesCrystalEmbedded", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"hostMinverse", ".", "#"}], "\[IndentingNewLine]", "&"}], "/@",
           "coordinatesCartesian"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"coordinatesCrystalEmbeddedTranslated", "=", 
         RowBox[{"T", "/@", "coordinatesCrystalEmbedded"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "newCoordinates", "=", "coordinatesCrystalEmbeddedTranslated"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Optional", ":", " ", 
           RowBox[{"Perform", " ", "shifts"}]}], ",", " ", 
          RowBox[{"twists", " ", "or", " ", "transformations"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"performShift", "||", "performTwist"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Optional", ":", " ", "Rotations"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"performTwist", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"twist", "=", 
               RowBox[{"R", "[", 
                RowBox[{
                 RowBox[{
                 "rotations", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "targetPositionsCartesian", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newCoordinatesCartesian", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"hostM", ".", "#"}], "&"}], "/@", 
                "newCoordinates"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"newCoordinatesCartesian", "=", 
               RowBox[{"twist", "@", "newCoordinatesCartesian"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newCoordinates", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"hostMinverse", ".", "#"}], "&"}], "/@", 
                "newCoordinatesCartesian"}]}]}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Optional", ":", " ", "Distortions"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"performShift", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"shift", "=", 
               RowBox[{
               "distortions", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"newCoordinates", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", "shift"}], "&"}], "/@", 
                "newCoordinates"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"guestCopies", "\[LeftDoubleBracket]", 
          RowBox[{
          "i", ",", "\"\<AtomData\>\"", ",", "All", ",", 
           "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}], "=", 
         "newCoordinates"}], ";", "\[IndentingNewLine]", 
        RowBox[{"completed", "++"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nonVoidRange"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Merge"}]}], " ", "guest", " ", "units", " ", 
        "with", " ", "traget", " ", 
        RowBox[{"crystal", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"atomDataHost", "===", 
        RowBox[{"{", 
         RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}], "}"}]}], ",", 
       
       RowBox[{"atomDataHost", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"atomDataHost", "=", 
         RowBox[{"$CrystalData", "[", 
          RowBox[{"hostCrystal", ",", "\"\<AtomData\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"atomDataHost", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\"\<Component\>\"", "\[Rule]", "\"\<Host\>\""}]}], 
            "]"}], "&"}], "/@", "atomDataHost"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomDataGuest", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"guestCopies", "\[LeftDoubleBracket]", 
        RowBox[{"nonVoidRange", ",", "\"\<AtomData\>\""}], 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"atomDataGuest", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<Component\>\"", "\[Rule]", "\"\<Guest\>\""}]}], "]"}], 
        "&"}], "/@", "atomDataGuest"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Remove", " ", "overlapping", " ", "target", " ", "positions"}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"joinedAtomData", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Host\>\"", ",", "\"\<Guest\>\""}], "}"}], ",", 
           "overlapPrecedence"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"A", ".", " ", "No"}], " ", "measure", " ", "taken", " ", 
          "against", " ", "overlapping"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"atomDataHost", ",", "atomDataGuest"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Remove"}], " ", "superpositioned", " ", 
          "atoms"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"findOverlap", "[", 
           RowBox[{"point_", ",", "region_List"}], "]"}], ":=", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"region", "===", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"Return", "@", "Nothing"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"intervals", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Interval", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#1", "-", "#2"}], ",", 
                   RowBox[{"#1", "+", "#2"}]}], "}"}], "]"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"point", ",", "overlapRadius"}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"checks", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IntervalMemberQ", "[", 
                 RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"intervals", ",", 
                 RowBox[{"Transpose", "@", "region"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"checks", "=", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"And", "@@@", 
                RowBox[{"Transpose", "@", "checks"}]}], ",", "True"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"checks", "=!=", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"Part", "[", 
               RowBox[{"region", ",", 
                RowBox[{"Flatten", "@", "checks"}]}], "]"}], ",", "Nothing"}],
              "]"}]}], "\[IndentingNewLine]", ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"atomData1", ",", "atomData2"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"overlapPrecedence", "===", "\"\<Host\>\""}], ",", 
              "\[IndentingNewLine]", "#", ",", 
              RowBox[{"Reverse", "@", "#"}]}], "]"}], "&"}], "@", 
           RowBox[{"{", 
            RowBox[{"atomDataHost", ",", "atomDataGuest"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xyz1", ",", "xyz2"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"#", ",", "All", ",", "\"\<FractionalCoordinates\>\""}], 
             "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"atomData1", ",", "atomData2"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nearestList", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Nearest", "[", 
             RowBox[{"xyz2", ",", "#", ",", "5"}], "]"}], "&"}], "/@", 
           "xyz1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"overlappingCoordinates", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{"findOverlap", ",", 
              RowBox[{"{", 
               RowBox[{"xyz1", ",", "nearestList"}], "}"}]}], "]"}], ",", 
            "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"atomData2", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"atomData2", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
              RowBox[{"overlappingCoordinates", ",", 
               RowBox[{"x", "[", "\"\<FractionalCoordinates\>\"", "]"}]}], 
              "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"atomData1", ",", "atomData2"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Trim", " ", "the", " ", "outer", " ", "boundary"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"boundary", "=!=", "\"\<None\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"boundary", "===", "\"\<Box\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"joinedAtomData", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"joinedAtomData", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
              "\[IndentingNewLine]", 
              RowBox[{"Nand", "@@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"0", "\[LessEqual]", "#1", "<", "#2"}], "&"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                   "hostStructureSize"}], "}"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"boundary", "===", "\"\<OuterEdges\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"joinedAtomData", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"joinedAtomData", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
              "\[IndentingNewLine]", 
              RowBox[{"Nand", "@@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"0", "\[LessEqual]", "#1", "<", "#2"}], "&"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                   RowBox[{"hostStructureSize", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"joinedAtomData", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"joinedAtomData", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"#", ",", "\"\<FractionalCoordinates\>\""}], "]"}], 
            "&"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"joinedAtomData", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"Chop", "[", 
           RowBox[{"#", ",", 
            RowBox[{"10.", "^", 
             RowBox[{"-", "6"}]}]}], "]"}]}], "&"}], ",", "joinedAtomData", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"All", ",", "\"\<FractionalCoordinates\>\""}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hostCopy", "[", "\"\<AtomData\>\"", "]"}], "=", 
      "joinedAtomData"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Overwrite", " ", "host", " ", "or", " ", "create", " ", "new", " ", 
       "crystal", " ", "object"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newStructureLabel", "===", "\"\<Void\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"newStructureLabel", "=", "\"\<CustomStructure\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hostCrystal", "===", "\"\<Void\>\""}], "&&", 
        RowBox[{"newStructureLabel", "===", "\"\<\>\""}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"newStructureLabel", "=", "\"\<CustomStructure\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"newStructureLabel", "===", "\"\<\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"newStructureLabel", "=", "hostCrystal"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"$CrystalData", "=", "crystalDataOriginal"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newSize", "=", 
      RowBox[{
       RowBox[{"hostCopy", "[", 
        RowBox[{"\"\<Notes\>\"", ",", "\"\<StructureSize\>\""}], "]"}], "/.", 
       
       RowBox[{"_Missing", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newUnitCellAtomCount", "=", 
      RowBox[{"\[LeftCeiling]", 
       RowBox[{
        RowBox[{"Length", "@", "joinedAtomData"}], "/", 
        RowBox[{"Times", "@@", "newSize"}]}], "\[RightCeiling]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"hostCopy", ",", "\"\<Notes\>\""}], "]"}]}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"hostCopy", ",", 
         RowBox[{"\"\<Notes\>\"", "\[Rule]", 
          RowBox[{"<|", "|>"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"hostCopy", "[", "\"\<Notes\>\"", "]"}], ",", 
       RowBox[{
       "\"\<UnitCellAtomsCount\>\"", "\[Rule]", "newUnitCellAtomCount"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"hostCopy", "[", "\"\<Notes\>\"", "]"}], ",", 
       RowBox[{"\"\<AsymmetricUnitAtomsCount\>\"", "\[Rule]", "Null"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"hostCopy", "[", "\"\<Notes\>\"", "]"}], ",", 
       RowBox[{"\"\<StructureSize\>\"", "\[Rule]", "newSize"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{
      "\"\<Update$CrystalDataFile\>\"", ",", "dataFile", ",", 
       "newStructureLabel", ",", "hostCopy"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "newStructureLabel"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.760949958969305*^9, 3.760949981683304*^9}, {
   3.761293214948368*^9, 3.761293216277224*^9}, {3.7612932491535683`*^9, 
   3.761293266239336*^9}, {3.761301744392057*^9, 3.761301872616757*^9}, {
   3.761302012143058*^9, 3.761302053792026*^9}, {3.761302140612296*^9, 
   3.761302184387752*^9}, {3.761302215653625*^9, 3.761302371834009*^9}, {
   3.761305350267173*^9, 3.761305352016643*^9}, {3.761305433233409*^9, 
   3.761305456926918*^9}, {3.761305519231518*^9, 3.76130551950924*^9}, {
   3.761305575630074*^9, 3.761305600715294*^9}, {3.761305760897593*^9, 
   3.7613057700955153`*^9}, {3.7613058045618467`*^9, 
   3.7613058280625963`*^9}, {3.761305862695778*^9, 3.7613058768953533`*^9}, {
   3.7613059150793467`*^9, 3.761305977708088*^9}, {3.761306013453003*^9, 
   3.7613060187081127`*^9}, {3.761306086451448*^9, 3.761306090626646*^9}, {
   3.761306193185049*^9, 3.761306197742535*^9}, {3.761306300998806*^9, 
   3.761306310525038*^9}, {3.761306421973971*^9, 3.761306423331564*^9}, {
   3.76130651549807*^9, 3.761306533887826*^9}, {3.7613065840486107`*^9, 
   3.7613066639010563`*^9}, {3.761306716374682*^9, 3.7613067441575327`*^9}, {
   3.761306774355764*^9, 3.761306834154875*^9}, {3.7613070302953243`*^9, 
   3.76130705839765*^9}, {3.7613083285830812`*^9, 3.7613083680112553`*^9}, {
   3.761309155307118*^9, 3.761309204871757*^9}, {3.7613092929652863`*^9, 
   3.761309379971908*^9}, {3.761382820081716*^9, 3.761382834766548*^9}, {
   3.76138315468125*^9, 3.761383157817292*^9}, {3.761383193862713*^9, 
   3.76138328048495*^9}, 3.7613833364532213`*^9, 3.7613877480927563`*^9, {
   3.761416820764223*^9, 3.76141686629681*^9}, {3.761416902523122*^9, 
   3.7614169275690813`*^9}, 3.7614169932958717`*^9, {3.7614617979066343`*^9, 
   3.761461800263917*^9}, 3.76146194226432*^9, {3.7616505028255873`*^9, 
   3.761650575813095*^9}, {3.761650666739345*^9, 3.761650703178874*^9}, {
   3.7616507610057287`*^9, 3.7616508488080893`*^9}, {3.762102493064165*^9, 
   3.7621026170854588`*^9}, {3.762102653458495*^9, 3.7621028575895653`*^9}, {
   3.762102891406652*^9, 3.762103017523076*^9}, {3.762103123797048*^9, 
   3.7621031314881067`*^9}, {3.762103164532901*^9, 3.762103238945119*^9}, 
   3.762103317592228*^9, {3.7621033696723433`*^9, 3.762103462434218*^9}, {
   3.762103629759901*^9, 3.762103754707251*^9}, {3.7621038014130983`*^9, 
   3.762103806410224*^9}, {3.7621038468918457`*^9, 3.762103858985067*^9}, {
   3.7621039084031973`*^9, 3.76210391519419*^9}, {3.762104152869686*^9, 
   3.7621041787316008`*^9}, {3.7621042160107718`*^9, 3.762104237466498*^9}, {
   3.762104267531948*^9, 3.7621043406482563`*^9}, {3.76210454290287*^9, 
   3.762104646913961*^9}, {3.76210473605682*^9, 3.7621047956336927`*^9}, {
   3.7621060525237923`*^9, 3.762106102851467*^9}, {3.762106153193736*^9, 
   3.762106156977296*^9}, {3.762106233845892*^9, 3.7621063149591503`*^9}, {
   3.762106412252318*^9, 3.7621064325936728`*^9}, {3.7624981476201353`*^9, 
   3.7624981709837217`*^9}, {3.762498245640142*^9, 3.762498256352324*^9}, 
   3.76249833634416*^9, {3.762498474294816*^9, 3.7624984809086227`*^9}, {
   3.7624985993459177`*^9, 3.762498628779851*^9}, {3.762498829247604*^9, 
   3.762498890795834*^9}, {3.7624990015344687`*^9, 3.7624991378944902`*^9}, {
   3.762499186464332*^9, 3.762499199075432*^9}, {3.7624992314237423`*^9, 
   3.762499305348139*^9}, {3.7624994277885313`*^9, 3.7624994319119663`*^9}, 
   3.762499469112893*^9, {3.762502717125535*^9, 3.762502723358025*^9}, {
   3.762502796619301*^9, 3.762502813165999*^9}, 3.7625029804272127`*^9, {
   3.762582269029249*^9, 3.762582285160461*^9}, {3.762582363020563*^9, 
   3.762582371209998*^9}, {3.76258241136819*^9, 3.76258243328338*^9}, {
   3.762582502805962*^9, 3.7625825046410522`*^9}, {3.762582558771358*^9, 
   3.762582558915724*^9}, {3.762582622766678*^9, 3.762582668909976*^9}, {
   3.762583498732263*^9, 3.762583499808262*^9}, {3.7625868909898567`*^9, 
   3.7625869272595243`*^9}, {3.7625875285339193`*^9, 
   3.7625875336261053`*^9}, {3.762587894113284*^9, 3.762587923075026*^9}, 
   3.76258809506489*^9, {3.762588155350531*^9, 3.762588180402031*^9}, {
   3.762588260279954*^9, 3.7625882886755667`*^9}, {3.762588346744122*^9, 
   3.762588371114582*^9}, {3.762588435316472*^9, 3.762588436252501*^9}, {
   3.762588517935748*^9, 3.7625885463706617`*^9}, {3.7625885807674*^9, 
   3.762588636583043*^9}, {3.762588669342952*^9, 3.7625887225407887`*^9}, {
   3.762588756779875*^9, 3.762588791529193*^9}, {3.762588922131773*^9, 
   3.762588924291471*^9}, {3.76258907036896*^9, 3.7625890745146837`*^9}, {
   3.7625895442111187`*^9, 3.762589617782276*^9}, 3.762589672277542*^9, {
   3.7625897530368357`*^9, 3.7625898259629583`*^9}, 3.7625898720272217`*^9, {
   3.762677526601284*^9, 3.762677540127564*^9}, {3.7626775863101673`*^9, 
   3.7626776872626953`*^9}, {3.7626777357149353`*^9, 3.762677737203546*^9}, {
   3.76267779801667*^9, 3.762677862846698*^9}, {3.762677910666745*^9, 
   3.762677940490479*^9}, {3.7626780495680513`*^9, 3.7626780497560883`*^9}, {
   3.762678463334445*^9, 3.762678487964533*^9}, {3.7626793924788427`*^9, 
   3.762679408974279*^9}, {3.762679463677194*^9, 3.762679519637199*^9}, 
   3.7626795637191353`*^9, {3.7626799410582647`*^9, 3.762679971916801*^9}, {
   3.7626800059954567`*^9, 3.76268004651369*^9}, {3.7626925595935926`*^9, 
   3.762692562134397*^9}, {3.762692675814475*^9, 3.762692677636441*^9}, {
   3.762693290932212*^9, 3.762693334938401*^9}, {3.762693365224998*^9, 
   3.762693391462492*^9}, {3.762693515415144*^9, 3.762693522925078*^9}, {
   3.762693621956568*^9, 3.762693686752577*^9}, {3.762770920087637*^9, 
   3.7627710451232033`*^9}, {3.762771135383432*^9, 3.76277114985949*^9}, {
   3.762771252361383*^9, 3.762771272566834*^9}, {3.7627716580427732`*^9, 
   3.762771710541195*^9}, 3.762771862467991*^9, {3.7627719062598333`*^9, 
   3.7627719503838043`*^9}, {3.762771987567686*^9, 3.762772017414404*^9}, 
   3.7627720616618547`*^9, {3.762772940184148*^9, 3.76277297496988*^9}, {
   3.762773049524953*^9, 3.762773052855938*^9}, 3.7627735693834248`*^9, {
   3.7627736256459637`*^9, 3.7627736267320766`*^9}, {3.762841968043556*^9, 
   3.762841971689434*^9}, {3.7628420791683397`*^9, 3.762842152463503*^9}, {
   3.76284221049533*^9, 3.7628422427149963`*^9}, {3.7628422931097097`*^9, 
   3.762842294171431*^9}, {3.762843140783256*^9, 3.762843174540785*^9}, 
   3.76284323171906*^9, 3.7628432620848923`*^9, 3.762843472440621*^9, {
   3.762843530593953*^9, 3.7628435308216457`*^9}, {3.7628435699325647`*^9, 
   3.762843577277005*^9}, {3.762843736593616*^9, 3.7628437506719217`*^9}, {
   3.762843794550819*^9, 3.762843898821501*^9}, 3.76284399421274*^9, {
   3.762844053296976*^9, 3.7628441198318453`*^9}, {3.762844193463323*^9, 
   3.762844196869841*^9}, {3.7628442292314873`*^9, 3.762844230656508*^9}, {
   3.762844292214486*^9, 3.762844478110961*^9}, 3.7628446048960114`*^9, {
   3.762855052141629*^9, 3.762855055454192*^9}, {3.762855485339323*^9, 
   3.76285551580307*^9}, {3.762855575097687*^9, 3.762855598848749*^9}, {
   3.762855633761406*^9, 3.762855680941841*^9}, {3.762855838827366*^9, 
   3.762855863378171*^9}, {3.762856143012158*^9, 3.762856217441588*^9}, {
   3.762858311081154*^9, 3.7628583120304327`*^9}, {3.76285835880651*^9, 
   3.7628583684319677`*^9}, {3.7628607058960047`*^9, 3.7628607075987663`*^9}, 
   3.762866915430805*^9, {3.762866967761737*^9, 3.7628670119373503`*^9}, {
   3.762867059688072*^9, 3.76286708299951*^9}, {3.762867169663844*^9, 
   3.7628671824696083`*^9}, {3.762867374682057*^9, 3.7628675208138857`*^9}, {
   3.7628677656632967`*^9, 3.76286776963317*^9}, 3.7628678073862047`*^9, {
   3.7628678779517183`*^9, 3.7628679508301373`*^9}, {3.7628680210441303`*^9, 
   3.762868094231029*^9}, {3.762868251262959*^9, 3.762868259793219*^9}, {
   3.762868791577395*^9, 3.762868801797572*^9}, {3.762869160895444*^9, 
   3.7628692036455936`*^9}, {3.762869237734138*^9, 3.762869244027247*^9}, {
   3.762869321441249*^9, 3.762869356529216*^9}, 3.762869394554852*^9, {
   3.7628695579991703`*^9, 3.762869577148713*^9}, {3.7628696201495237`*^9, 
   3.762869692378208*^9}, {3.762869737186467*^9, 3.762869797397738*^9}, {
   3.76286990999438*^9, 3.762869964227026*^9}, {3.762870015871686*^9, 
   3.7628700317938643`*^9}, {3.762870134176379*^9, 3.7628701628786993`*^9}, {
   3.7628702301619473`*^9, 3.762870294612823*^9}, {3.762870473741437*^9, 
   3.762870479995652*^9}, {3.762870587287355*^9, 3.762870599093995*^9}, {
   3.762870644033637*^9, 3.762870722355867*^9}, {3.762870795124795*^9, 
   3.762870954982074*^9}, {3.762871004526711*^9, 3.762871033283514*^9}, 
   3.762871402901025*^9, {3.7628714747887173`*^9, 3.76287147568962*^9}, {
   3.762871515626314*^9, 3.762871608409374*^9}, {3.7628716725028067`*^9, 
   3.762871672685828*^9}, {3.762871708403867*^9, 3.762871949455731*^9}, {
   3.762871987106526*^9, 3.762872039287641*^9}, {3.762872081056032*^9, 
   3.7628721219021072`*^9}, {3.762872240222788*^9, 3.7628722403962383`*^9}, {
   3.762872351507962*^9, 3.762872395801134*^9}, 3.762872463195447*^9, {
   3.7628725183533173`*^9, 3.762872520397197*^9}, {3.762872600030006*^9, 
   3.762872679985482*^9}, {3.76287274173201*^9, 3.7628729286886177`*^9}, {
   3.7628729820175037`*^9, 3.762872993276016*^9}, {3.762873223952983*^9, 
   3.7628732645793457`*^9}, {3.762873306231241*^9, 3.762873319451611*^9}, {
   3.762873361710734*^9, 3.762873403405033*^9}, {3.762873480577733*^9, 
   3.762873514995167*^9}, {3.762873569354168*^9, 3.762873577454311*^9}, {
   3.762873622047131*^9, 3.762873626076936*^9}, {3.762873681562976*^9, 
   3.762873804669633*^9}, {3.762873874461594*^9, 3.7628739019298487`*^9}, {
   3.762873942034061*^9, 3.7628739499439297`*^9}, {3.762873998120645*^9, 
   3.7628740004947042`*^9}, {3.762874041584938*^9, 3.762874226449202*^9}, {
   3.762874271070135*^9, 3.762874277282874*^9}, {3.7628744181917953`*^9, 
   3.762874463581009*^9}, {3.762874515579569*^9, 3.762874543507349*^9}, {
   3.76287458123426*^9, 3.7628746222412777`*^9}, {3.762874671856251*^9, 
   3.762874677335286*^9}, {3.7628747670478163`*^9, 3.7628748156535063`*^9}, {
   3.7628749407155533`*^9, 3.762874952138845*^9}, {3.762875025608852*^9, 
   3.762875041191021*^9}, {3.762875073078917*^9, 3.762875088968438*^9}, {
   3.762875131293384*^9, 3.762875142717152*^9}, {3.762875189893785*^9, 
   3.762875228139299*^9}, {3.762875264602992*^9, 3.762875384703268*^9}, {
   3.7628754209230127`*^9, 3.7628754380168858`*^9}, {3.762875492924176*^9, 
   3.762875496297366*^9}, {3.7628755457294416`*^9, 3.762875553524787*^9}, {
   3.762875599213748*^9, 3.762875600597042*^9}, {3.762875632421335*^9, 
   3.76287563573954*^9}, {3.762875682395001*^9, 3.7628756847140007`*^9}, {
   3.7628757164263697`*^9, 3.7628757229691467`*^9}, {3.76287605211134*^9, 
   3.762876097288445*^9}, {3.762876135954174*^9, 3.762876195935535*^9}, {
   3.762876241711833*^9, 3.7628762494931927`*^9}, {3.762876384663487*^9, 
   3.762876479009344*^9}, {3.76287655336906*^9, 3.76287656601012*^9}, {
   3.762876596400938*^9, 3.762876634383113*^9}, {3.762876673710348*^9, 
   3.76287675187472*^9}, {3.762876791877123*^9, 3.762876819041494*^9}, {
   3.762876885505245*^9, 3.762876891022944*^9}, {3.762876937073703*^9, 
   3.7628771938795424`*^9}, 3.762877403929391*^9, {3.762877434780368*^9, 
   3.7628775218664*^9}, {3.762877580715034*^9, 3.762877631590403*^9}, 
   3.7628776663055677`*^9, {3.7628777044483967`*^9, 3.762877725317191*^9}, {
   3.762877789695075*^9, 3.762877793110955*^9}, 3.7628778423255033`*^9, {
   3.762877979538982*^9, 3.7628779882143593`*^9}, {3.762878277816328*^9, 
   3.76287833239133*^9}, {3.7628784710060663`*^9, 3.762878506972105*^9}, {
   3.7628785962592087`*^9, 3.762878801387622*^9}, {3.7628788387986393`*^9, 
   3.762878864223701*^9}, {3.762878899289844*^9, 3.7628792672629423`*^9}, {
   3.762879302100252*^9, 3.762879330120636*^9}, {3.7628793752089863`*^9, 
   3.762879376916254*^9}, {3.7628794219805403`*^9, 3.7628794729603786`*^9}, {
   3.7628795152925262`*^9, 3.762879545039997*^9}, {3.762879584664082*^9, 
   3.762879627053114*^9}, {3.762880097039065*^9, 3.7628801883595533`*^9}, {
   3.762880273098674*^9, 3.7628802847264767`*^9}, {3.762880640968452*^9, 
   3.7628806418162117`*^9}, {3.76288069938903*^9, 3.762880720578525*^9}, {
   3.7629306710210238`*^9, 3.762930744528843*^9}, {3.762930837033882*^9, 
   3.762930870447606*^9}, {3.762938095787146*^9, 3.7629381017712297`*^9}, {
   3.762938161287774*^9, 3.762938215926861*^9}, {3.7629382564830637`*^9, 
   3.762938281171281*^9}, {3.7629389096948557`*^9, 3.762938941986907*^9}, {
   3.762939377043207*^9, 3.762939380889515*^9}, {3.762939412233852*^9, 
   3.7629394140804863`*^9}, {3.762939511271194*^9, 3.7629395163268213`*^9}, {
   3.76293958614294*^9, 3.762939693652255*^9}, {3.7629397253426237`*^9, 
   3.7629398093529587`*^9}, {3.762939861473041*^9, 3.762939909743734*^9}, {
   3.762939955718019*^9, 3.7629399593092413`*^9}, {3.7631071345625963`*^9, 
   3.76310714375867*^9}, 3.763109010813422*^9, {3.7631092057400208`*^9, 
   3.7631094289466867`*^9}, {3.76310946139357*^9, 3.763109464777589*^9}, {
   3.763109609170587*^9, 3.763109612134158*^9}, {3.7631096445197697`*^9, 
   3.7631096660472937`*^9}, {3.763109717543357*^9, 3.7631097614270906`*^9}, {
   3.763113751318272*^9, 3.76311377566158*^9}, {3.763113847940092*^9, 
   3.763113852041291*^9}, {3.7631139697602367`*^9, 3.763114015545051*^9}, {
   3.76311408524647*^9, 3.763114095717828*^9}, {3.7631141392049513`*^9, 
   3.763114244720681*^9}, {3.763114313616914*^9, 3.763114335329433*^9}, {
   3.763114428789543*^9, 3.763114439084303*^9}, {3.763114657900378*^9, 
   3.76311466123164*^9}, {3.763114804404273*^9, 3.763114830891836*^9}, 
   3.76311492103691*^9, {3.7631149536921864`*^9, 3.7631149574953737`*^9}, 
   3.763115194117029*^9, {3.763117481664586*^9, 3.7631175073895884`*^9}, {
   3.763117541659478*^9, 3.763117546457182*^9}, {3.763118366263104*^9, 
   3.763118424888715*^9}, {3.7631184630443068`*^9, 3.763118556777619*^9}, {
   3.763118597267194*^9, 3.76311860862567*^9}, {3.763118669217677*^9, 
   3.763118678281003*^9}, {3.763118760253681*^9, 3.7631187818044777`*^9}, {
   3.763118852675838*^9, 3.763118874530364*^9}, {3.763118914883135*^9, 
   3.7631189239615602`*^9}, {3.76311903172056*^9, 3.763119095181788*^9}, {
   3.763119136625108*^9, 3.7631191532754908`*^9}, {3.763125215957747*^9, 
   3.763125237860512*^9}, {3.763125325265283*^9, 3.7631253453669357`*^9}, {
   3.763125382704082*^9, 3.763125403991729*^9}, {3.763125717784651*^9, 
   3.7631257305215178`*^9}, {3.763125776152041*^9, 3.763125776309593*^9}, {
   3.763125812131754*^9, 3.763125910381338*^9}, {3.7631259626923637`*^9, 
   3.7631259841422453`*^9}, {3.763126035211269*^9, 3.763126036239753*^9}, {
   3.7631261701418447`*^9, 3.763126180115364*^9}, {3.763126279914678*^9, 
   3.7631263241774693`*^9}, {3.7631263669207563`*^9, 3.763126393551303*^9}, {
   3.7631264476942673`*^9, 3.7631264609978867`*^9}, {3.76312650025568*^9, 
   3.763126573461645*^9}, {3.7631266195254803`*^9, 3.763126623002365*^9}, {
   3.7631272758447733`*^9, 3.763127309275083*^9}, {3.7631275505577602`*^9, 
   3.7631275721993113`*^9}, {3.763127617738536*^9, 3.76312765133419*^9}, {
   3.76312787086615*^9, 3.763127891746153*^9}, {3.763127975647997*^9, 
   3.763127977794919*^9}, {3.763128010713504*^9, 3.763128021567861*^9}, {
   3.763128246913335*^9, 3.763128318277091*^9}, {3.7631285502832937`*^9, 
   3.7631285749907627`*^9}, {3.7631286142239313`*^9, 3.763128621583006*^9}, {
   3.763128714046776*^9, 3.763128718181245*^9}, {3.7631297011891193`*^9, 
   3.763129721772406*^9}, {3.763129763584149*^9, 3.763129768832306*^9}, {
   3.763129847014283*^9, 3.76312986407797*^9}, {3.763129927313559*^9, 
   3.7631300438891373`*^9}, {3.763130179369866*^9, 3.7631302060726833`*^9}, {
   3.763130245968479*^9, 3.763130335547166*^9}, {3.7631303657106133`*^9, 
   3.7631303802433157`*^9}, {3.7631304247119904`*^9, 3.763130455888669*^9}, {
   3.763130521792214*^9, 3.7631305406864758`*^9}, {3.7631305965443153`*^9, 
   3.763130660171047*^9}, {3.763130706718121*^9, 3.763130829968198*^9}, {
   3.76313096353717*^9, 3.763131008181438*^9}, {3.763131576616784*^9, 
   3.763131593542778*^9}, {3.7631317388395023`*^9, 3.7631317501629963`*^9}, {
   3.763131892771203*^9, 3.763131892992467*^9}, {3.763132007751411*^9, 
   3.763132018592195*^9}, {3.763132085855482*^9, 3.763132118941799*^9}, {
   3.76313225950935*^9, 3.7631322966720047`*^9}, {3.763132346415104*^9, 
   3.763132378887425*^9}, {3.763132545890561*^9, 3.763132580825664*^9}, {
   3.763132747293684*^9, 3.7631328034437017`*^9}, {3.7631329730980597`*^9, 
   3.76313297389685*^9}, {3.763133056669232*^9, 3.763133188717005*^9}, {
   3.763133935427595*^9, 3.763133935595489*^9}, {3.763187227503315*^9, 
   3.763187255977352*^9}, {3.763187457039694*^9, 3.763187459878124*^9}, {
   3.7631875802780323`*^9, 3.763187625750729*^9}, {3.7631876604547977`*^9, 
   3.763187695133733*^9}, {3.763188212310367*^9, 3.763188223797275*^9}, {
   3.7631884932904*^9, 3.76318850267904*^9}, {3.763188670813423*^9, 
   3.763188686690158*^9}, {3.763188967603389*^9, 3.763188971753989*^9}, {
   3.763189112892579*^9, 3.7631891137284737`*^9}, {3.763189143865053*^9, 
   3.763189176599208*^9}, {3.7631892258070707`*^9, 3.7631892574490843`*^9}, {
   3.763189493136047*^9, 3.7631894989397297`*^9}, {3.7631896003011436`*^9, 
   3.7631896082865353`*^9}, {3.763189847050942*^9, 3.763189849706423*^9}, {
   3.763189984007719*^9, 3.763189987835786*^9}, {3.763190061651286*^9, 
   3.7631900848977213`*^9}, {3.7631901264431887`*^9, 3.763190167151824*^9}, {
   3.763190252366623*^9, 3.763190261428344*^9}, {3.763190406913002*^9, 
   3.763190430824905*^9}, {3.763190468801447*^9, 3.763190469190565*^9}, {
   3.763190622378428*^9, 3.763190630267044*^9}, {3.763190661152936*^9, 
   3.7631906670871983`*^9}, {3.763190724114277*^9, 3.763190829622073*^9}, {
   3.763190883250929*^9, 3.763190886503768*^9}, {3.763190917838767*^9, 
   3.7631909193172626`*^9}, {3.763191046078986*^9, 3.763191055993108*^9}, {
   3.7631911205882196`*^9, 3.763191168179716*^9}, {3.763191227422003*^9, 
   3.763191252791547*^9}, {3.763191329027898*^9, 3.763191469921081*^9}, {
   3.763191504955181*^9, 3.763191539257966*^9}, {3.7631915873067007`*^9, 
   3.7631916335588217`*^9}, {3.7631916944415503`*^9, 3.763191763003018*^9}, {
   3.763191812380579*^9, 3.763191882334046*^9}, {3.763191928001873*^9, 
   3.763191961271028*^9}, {3.763192105280212*^9, 3.76319210639229*^9}, {
   3.763192138213997*^9, 3.7631921652834473`*^9}, {3.7631927565237713`*^9, 
   3.763192778410982*^9}, {3.763193346873497*^9, 3.763193398671426*^9}, {
   3.763193458829427*^9, 3.7631934913421307`*^9}, {3.763193543342906*^9, 
   3.763193585165707*^9}, {3.763193615957055*^9, 3.7631936161804447`*^9}, {
   3.763193647289423*^9, 3.76319364936325*^9}, {3.763193721572187*^9, 
   3.763193723439939*^9}, {3.7631938176581697`*^9, 3.763193824975697*^9}, {
   3.763193862394617*^9, 3.763193926233437*^9}, {3.763194023337283*^9, 
   3.763194034343214*^9}, {3.763194615618539*^9, 3.763194619036454*^9}, {
   3.763194658740366*^9, 3.763194692672081*^9}, {3.763194755420477*^9, 
   3.7631947699246273`*^9}, {3.763195334094963*^9, 3.763195338909153*^9}, {
   3.7631975202638683`*^9, 3.763197548230151*^9}, {3.763197626392477*^9, 
   3.7631976888784437`*^9}, {3.763197723624353*^9, 3.7631977253245687`*^9}, {
   3.763197890121645*^9, 3.763197953778249*^9}, {3.763198031792822*^9, 
   3.763198054939842*^9}, {3.76321612243653*^9, 3.763216135394136*^9}, {
   3.763216452860265*^9, 3.763216512562997*^9}, {3.763216619929467*^9, 
   3.7632166276714373`*^9}, {3.76321670921714*^9, 3.763216717734356*^9}, {
   3.7632168429845753`*^9, 3.763216860041214*^9}, {3.763219483617481*^9, 
   3.763219484646124*^9}, 3.7637480980874977`*^9, 3.7656132382169933`*^9, {
   3.7656132847518272`*^9, 3.765613290129304*^9}, {3.765613322429381*^9, 
   3.765613322559623*^9}, {3.7656133923118057`*^9, 3.765613401977973*^9}, {
   3.765617239109764*^9, 3.765617256380885*^9}, {3.765617301508347*^9, 
   3.765617328981081*^9}, {3.765617359205852*^9, 3.7656173781026287`*^9}, {
   3.765784620232706*^9, 3.765784689781252*^9}, {3.765784870221239*^9, 
   3.765784892170088*^9}, {3.7657850012632504`*^9, 3.765785001478718*^9}, {
   3.765786854221891*^9, 3.76578701567861*^9}, {3.76578707263732*^9, 
   3.765787072783017*^9}, {3.7657872632027473`*^9, 3.7657872785712852`*^9}, {
   3.765787316876203*^9, 3.765787339591667*^9}, {3.765787373522758*^9, 
   3.7657874200352573`*^9}, {3.765787450044582*^9, 3.7657874663117313`*^9}, {
   3.7657874982950697`*^9, 3.7657875068386927`*^9}, {3.765787587486917*^9, 
   3.765787617689131*^9}, {3.765787781196168*^9, 3.765787815427401*^9}, {
   3.765787850054681*^9, 3.765787856021174*^9}, {3.765787891382762*^9, 
   3.765787954740789*^9}, {3.7657879904948072`*^9, 3.765787992037723*^9}, {
   3.7657880294366407`*^9, 3.765788030041398*^9}, 3.765788076272851*^9, 
   3.765788126200704*^9, {3.765788276626862*^9, 3.7657883998158607`*^9}, {
   3.7657884591537046`*^9, 3.76578846122993*^9}, {3.765788571737989*^9, 
   3.7657885749533253`*^9}, {3.7657886084416723`*^9, 3.765788610521564*^9}, {
   3.7657886533592777`*^9, 3.765788689744301*^9}, {3.765788727265636*^9, 
   3.765788823548274*^9}, {3.76578893364857*^9, 3.7657890745241117`*^9}, {
   3.765789321204677*^9, 3.765789323836171*^9}, {3.765789383162809*^9, 
   3.76578939527948*^9}, 3.765789506485285*^9, {3.765789559942175*^9, 
   3.76578957941516*^9}, {3.765789610372075*^9, 3.7657896215452633`*^9}, {
   3.765789652426416*^9, 3.765789670747816*^9}, {3.765789726199593*^9, 
   3.7657897711495047`*^9}, {3.7657898329974194`*^9, 3.76578983839888*^9}, {
   3.765789882716711*^9, 3.765790118721635*^9}, {3.765790156394946*^9, 
   3.765790159211773*^9}, {3.765790226468259*^9, 3.7657902461019993`*^9}, {
   3.765790534617981*^9, 3.765790570961727*^9}, {3.765790646513578*^9, 
   3.765790648697698*^9}, {3.766133130511834*^9, 3.766133191520647*^9}, {
   3.766133393203856*^9, 3.766133397097556*^9}, {3.7661334909023046`*^9, 
   3.766133502477824*^9}, {3.766133547276335*^9, 3.766133599590375*^9}, {
   3.766133647697535*^9, 3.766133752010853*^9}, {3.76613385276198*^9, 
   3.766133853360251*^9}, {3.766136088935584*^9, 3.766136089197337*^9}, {
   3.767418339006063*^9, 3.767418373391323*^9}, {3.76741865255199*^9, 
   3.767418659977913*^9}, {3.767418772659123*^9, 3.767418776351082*^9}, {
   3.7674188354921303`*^9, 3.767418843488943*^9}, {3.767419391561277*^9, 
   3.7674193933080072`*^9}, {3.767419477135425*^9, 3.767419478396847*^9}, {
   3.7674212389643307`*^9, 3.767421243094317*^9}, {3.767421388067708*^9, 
   3.767421408273843*^9}, 3.7674214825380497`*^9, {3.767421748315342*^9, 
   3.76742176753896*^9}, {3.7674221360416183`*^9, 3.767422150623794*^9}, {
   3.767422873176009*^9, 3.7674228861233063`*^9}, {3.767423176220377*^9, 
   3.767423288843697*^9}, {3.767423319599174*^9, 3.7674233300793962`*^9}, {
   3.767423656813138*^9, 3.767423657009758*^9}, {3.7674242736796913`*^9, 
   3.767424282134386*^9}, 3.767424359730546*^9, {3.767425400287179*^9, 
   3.767425438842709*^9}, {3.7674254732233057`*^9, 3.7674254753341827`*^9}, {
   3.76742591047171*^9, 3.767426135839841*^9}, {3.767426781512274*^9, 
   3.767426781644022*^9}, {3.7674268512227297`*^9, 3.767426853051519*^9}, {
   3.76742759519308*^9, 3.767427620099413*^9}, {3.767427894905375*^9, 
   3.767427898429635*^9}, {3.767428043794436*^9, 3.767428052749457*^9}, {
   3.767429496716354*^9, 3.76742950712227*^9}, {3.7705685388204727`*^9, 
   3.77056855609783*^9}, {3.770985255621977*^9, 3.77098533433296*^9}, {
   3.7709853979701557`*^9, 3.770985429562252*^9}, {3.7709854802462187`*^9, 
   3.77098548903078*^9}, {3.770992216824781*^9, 3.770992217581645*^9}, {
   3.770992263809794*^9, 3.770992274212365*^9}, {3.770992316847095*^9, 
   3.7709923668539667`*^9}, {3.770992843329639*^9, 3.770992847623066*^9}, {
   3.7709937469717007`*^9, 3.770993754167997*^9}, {3.77099404442232*^9, 
   3.770994057522037*^9}, {3.7709942504947023`*^9, 3.770994251172936*^9}, {
   3.770994313420412*^9, 3.770994333179612*^9}, {3.7709947381180363`*^9, 
   3.770994746114501*^9}, {3.77099489728544*^9, 3.770994903087699*^9}, {
   3.7709955146884212`*^9, 3.770995519188938*^9}, {3.7709955885900097`*^9, 
   3.770995603621776*^9}, {3.7709985161231823`*^9, 3.770998573504325*^9}, {
   3.770998636718886*^9, 3.77099866864684*^9}, {3.770999271890346*^9, 
   3.7709992748324633`*^9}, {3.77099932832793*^9, 3.770999435197094*^9}, {
   3.770999473700451*^9, 3.77099954163769*^9}, {3.7709996054438562`*^9, 
   3.77099970778405*^9}, {3.770999776833643*^9, 3.770999798197777*^9}, {
   3.7709998298969727`*^9, 3.7709999055790854`*^9}, {3.771000913605406*^9, 
   3.771000994531023*^9}, {3.771001058025551*^9, 3.771001085103985*^9}, {
   3.771001155512368*^9, 3.771001215445347*^9}, {3.771001257175239*^9, 
   3.771001295878345*^9}, {3.7710033329319677`*^9, 3.771003360971566*^9}, {
   3.77100354006137*^9, 3.7710036064113626`*^9}, {3.771003657619206*^9, 
   3.7710036944494877`*^9}, 3.771003727767627*^9, 3.771062394226145*^9, {
   3.771062571972788*^9, 3.7710625760835648`*^9}, {3.7710626284198513`*^9, 
   3.771062632297975*^9}, {3.771062770322917*^9, 3.771062781615706*^9}, {
   3.771062835425494*^9, 3.771062892468504*^9}, 3.7710629725583553`*^9, {
   3.771063096550644*^9, 3.77106312575948*^9}, {3.7710631628487053`*^9, 
   3.771063189685732*^9}, {3.771063374106915*^9, 3.7710634136717167`*^9}, {
   3.771063715324141*^9, 3.771063723856834*^9}, 3.7710637716993*^9, {
   3.7710663266989393`*^9, 3.7710663295535192`*^9}, {3.771066369739533*^9, 
   3.771066412961162*^9}, {3.771066589388928*^9, 3.771066591324184*^9}, {
   3.771066696018014*^9, 3.771066756432719*^9}, {3.771066818583774*^9, 
   3.771066819938601*^9}, {3.771067050293045*^9, 3.771067073807219*^9}, {
   3.77106721868401*^9, 3.771067235962707*^9}, {3.7710678738916483`*^9, 
   3.771067946032868*^9}, {3.771068096310753*^9, 3.771068170859066*^9}, {
   3.7710682057955303`*^9, 3.771068213657659*^9}, {3.771068243801957*^9, 
   3.77106833510456*^9}, {3.771068961022511*^9, 3.7710690398331823`*^9}, {
   3.7710690833632727`*^9, 3.771069083504656*^9}, {3.7710691353442497`*^9, 
   3.771069149303069*^9}, {3.771069198154456*^9, 3.771069232605229*^9}, {
   3.7710696182554483`*^9, 3.77106962241162*^9}, {3.771071024377389*^9, 
   3.7710711687241383`*^9}, {3.771071223269198*^9, 3.7710712555852633`*^9}, {
   3.771071297666704*^9, 3.7710712989299517`*^9}, {3.7710713301115828`*^9, 
   3.771071587457263*^9}, {3.77107162312395*^9, 3.771071624129236*^9}, {
   3.771071687296813*^9, 3.77107182861987*^9}, {3.7710718649574947`*^9, 
   3.7710718681068993`*^9}, {3.771218359146858*^9, 3.771218371633432*^9}, 
   3.771218633021106*^9, 3.771219750185355*^9, {3.771227804121016*^9, 
   3.771227805860454*^9}, {3.7712280867684526`*^9, 3.771228092370463*^9}, {
   3.771228492507588*^9, 3.77122849265583*^9}, {3.771229675233079*^9, 
   3.771229680331314*^9}, {3.771229885322709*^9, 3.7712299013359747`*^9}, {
   3.7712299416509113`*^9, 3.771229942983835*^9}, {3.7712304741539307`*^9, 
   3.7712305157645483`*^9}, {3.7712306706620092`*^9, 
   3.7712307683413067`*^9}, {3.771230847027277*^9, 3.771230906810211*^9}, {
   3.771230971727503*^9, 3.771230996070547*^9}, {3.77123104405582*^9, 
   3.7712310789673653`*^9}, {3.771231137938733*^9, 3.771231139371385*^9}, 
   3.771231185248641*^9, {3.7712313407334642`*^9, 3.771231351223959*^9}, {
   3.771231399192821*^9, 3.771231400594159*^9}, {3.771231438048242*^9, 
   3.771231449680297*^9}, {3.771231660158917*^9, 3.771231660235083*^9}, {
   3.77123171146215*^9, 3.7712317477201843`*^9}, {3.7712317866697483`*^9, 
   3.771231805928154*^9}, {3.771231857513937*^9, 3.771231922606146*^9}, {
   3.7712322109702272`*^9, 3.771232245011187*^9}, {3.77123232501055*^9, 
   3.7712323279219637`*^9}, {3.7712323608281937`*^9, 3.771232361010892*^9}, {
   3.771232396338902*^9, 3.771232424695243*^9}, {3.771236683796921*^9, 
   3.771236718438673*^9}, {3.771238579955537*^9, 3.77123858039727*^9}, {
   3.774163342992441*^9, 3.774163349465139*^9}, 3.774163732272812*^9, {
   3.774170626573571*^9, 3.774170635524674*^9}, {3.7741707477912607`*^9, 
   3.774170756370921*^9}, {3.774171154343649*^9, 3.774171174268244*^9}, {
   3.774171207282909*^9, 3.774171229698924*^9}, {3.774171280793515*^9, 
   3.7741713078089027`*^9}, {3.777883110942696*^9, 3.777883121513275*^9}, {
   3.777883300718519*^9, 3.777883303748021*^9}, {3.777883597200561*^9, 
   3.7778836198610353`*^9}, {3.7778841982352753`*^9, 3.777884240627591*^9}, {
   3.777884354490204*^9, 3.777884390100523*^9}, {3.777884496376441*^9, 
   3.777884550767989*^9}, {3.7778845886714563`*^9, 3.777884618561845*^9}, {
   3.777884741239046*^9, 3.7778847422165823`*^9}, {3.777884847900238*^9, 
   3.777884848695868*^9}, {3.777884881478932*^9, 3.777884893190099*^9}, {
   3.777884936268408*^9, 3.777884938034113*^9}, {3.7778849898832073`*^9, 
   3.777884992009694*^9}, {3.777886841769018*^9, 3.777886847035543*^9}, {
   3.777886938832423*^9, 3.777886938991823*^9}, {3.777886974197579*^9, 
   3.77788697454423*^9}, {3.777888208711817*^9, 3.777888209786521*^9}, {
   3.7778884873875313`*^9, 3.7778884879400873`*^9}, {3.778341547712955*^9, 
   3.7783416140779133`*^9}, {3.778342096135556*^9, 3.7783421122925663`*^9}, {
   3.7783423980957613`*^9, 3.778342436409171*^9}, 3.7783425371184177`*^9, 
   3.7783428037732286`*^9, {3.778343228103939*^9, 3.778343252000104*^9}, {
   3.778343855424313*^9, 3.778343874590789*^9}, {3.77834691848427*^9, 
   3.778346921962772*^9}, {3.77834703461736*^9, 3.778347056218598*^9}, {
   3.778347317730957*^9, 3.778347335275222*^9}, {3.778347463422864*^9, 
   3.778347572532193*^9}, {3.77834765722755*^9, 3.778347660842284*^9}, {
   3.778347746485642*^9, 3.778347755029956*^9}, {3.778347956245047*^9, 
   3.778347964018465*^9}, 3.7784846769299726`*^9, {3.779517206742679*^9, 
   3.779517247454179*^9}, {3.7795175246690474`*^9, 3.7795175559046183`*^9}, {
   3.779517586114908*^9, 3.7795175871998987`*^9}, {3.779517645545917*^9, 
   3.779517656862606*^9}, {3.779517811668775*^9, 3.7795178497309723`*^9}, 
   3.779526036951063*^9, {3.77952796708489*^9, 3.7795279763312407`*^9}, {
   3.779528344596788*^9, 3.779528346410655*^9}, {3.779528489755775*^9, 
   3.779528491208659*^9}, {3.7795285236167393`*^9, 3.779528526815249*^9}, {
   3.779528558298008*^9, 3.7795286018374643`*^9}, {3.779528800371364*^9, 
   3.7795288549048758`*^9}, {3.779528919376288*^9, 3.779529034125331*^9}, {
   3.7801170933815823`*^9, 3.7801171255234756`*^9}, {3.78161320625354*^9, 
   3.7816132784104643`*^9}, {3.781613466583273*^9, 3.781613474582327*^9}, {
   3.781613518662004*^9, 3.781613521863761*^9}, {3.781613740528426*^9, 
   3.7816137471257153`*^9}, {3.781613895330988*^9, 3.7816139316812687`*^9}, {
   3.781614096031432*^9, 3.78161415612395*^9}, 3.7816159785577297`*^9, {
   3.781616027676881*^9, 3.781616060487369*^9}, 3.781616096101468*^9, {
   3.7816161385105867`*^9, 3.781616162353176*^9}, {3.781616435909308*^9, 
   3.78161643626823*^9}, {3.781617040934772*^9, 3.781617069205027*^9}, {
   3.781617228538068*^9, 3.781617236672196*^9}, {3.78161727927229*^9, 
   3.781617292631782*^9}, {3.7816174735244093`*^9, 3.781617491058634*^9}, {
   3.781617527758053*^9, 3.781617566098106*^9}, {3.781617666985403*^9, 
   3.781617694464521*^9}, {3.781617747945244*^9, 3.781617798852406*^9}, {
   3.781617877981491*^9, 3.781617925018609*^9}, {3.781618166592342*^9, 
   3.781618166765592*^9}, {3.78161820857272*^9, 3.7816182108997583`*^9}, {
   3.781618346661129*^9, 3.781618360457876*^9}, {3.781618423314724*^9, 
   3.781618432911172*^9}, {3.781618541119955*^9, 3.781618575804497*^9}, {
   3.781618747961049*^9, 3.781618749711997*^9}, {3.781618849422463*^9, 
   3.781618892708911*^9}, {3.781619490567857*^9, 3.7816195224157763`*^9}, {
   3.7816197712209473`*^9, 3.78161978506593*^9}, {3.7816198457084*^9, 
   3.781619857176858*^9}, {3.781625278010277*^9, 3.781625278320633*^9}, {
   3.781625507076171*^9, 3.7816255135539083`*^9}, {3.781625669295478*^9, 
   3.781625682670639*^9}, {3.7816257643671703`*^9, 3.78162576471795*^9}, {
   3.7816258194699907`*^9, 3.781625878530567*^9}, {3.7816259136011744`*^9, 
   3.7816260848868437`*^9}, {3.781626326233399*^9, 3.781626333704397*^9}, {
   3.781626980439177*^9, 3.781627007036531*^9}, {3.781627113972267*^9, 
   3.781627154804058*^9}, {3.781627219665454*^9, 3.781627248855564*^9}, {
   3.781628075852029*^9, 3.781628075995063*^9}, {3.781628168145582*^9, 
   3.781628264007738*^9}, {3.781628457828092*^9, 3.781628527113945*^9}, {
   3.781628581808958*^9, 3.781628598640403*^9}, {3.781629271180827*^9, 
   3.781629277538378*^9}, 3.781629552681849*^9, 3.781630265952499*^9, {
   3.781630513131585*^9, 3.781630816343946*^9}, {3.781637794421029*^9, 
   3.781637799560951*^9}, {3.7816397465121393`*^9, 3.78163976192807*^9}, {
   3.781640974084455*^9, 3.781640976293817*^9}, {3.7816410135354967`*^9, 
   3.781641013718293*^9}, {3.7816411364758987`*^9, 3.781641191553282*^9}, {
   3.7816412292679377`*^9, 3.781641263383588*^9}, {3.781641329231557*^9, 
   3.781641407480527*^9}, {3.7816414736695557`*^9, 3.781641494356456*^9}, {
   3.781641665977538*^9, 3.781641775323806*^9}, {3.7816418499103003`*^9, 
   3.781641899700966*^9}, {3.781641933766172*^9, 3.781642020388858*^9}, {
   3.781642050782839*^9, 3.781642054363265*^9}, {3.78164251745315*^9, 
   3.7816425582402477`*^9}, {3.78164267991064*^9, 3.7816427406446466`*^9}, {
   3.7816428476543827`*^9, 3.781642877563442*^9}, {3.781642916602785*^9, 
   3.781642920353833*^9}, {3.781642977177203*^9, 3.781642983425953*^9}, {
   3.781643013848412*^9, 3.781643052783231*^9}, {3.78164318704478*^9, 
   3.781643219731113*^9}, {3.781643272051425*^9, 3.7816433006016893`*^9}, {
   3.781643334898526*^9, 3.78164336265945*^9}, {3.781643442740518*^9, 
   3.781643451844163*^9}, {3.7816435563877*^9, 3.7816435585687637`*^9}, {
   3.7816436149431553`*^9, 3.781643621143251*^9}, {3.7816436804139547`*^9, 
   3.781643706429069*^9}, {3.781643743317902*^9, 3.7816438016986732`*^9}, {
   3.78164387296428*^9, 3.781643893202812*^9}, {3.781643925212257*^9, 
   3.781643935090425*^9}, {3.781643980002695*^9, 3.781643980824354*^9}, {
   3.781684735387897*^9, 3.781684819903823*^9}, {3.781684876734529*^9, 
   3.781684878127458*^9}, {3.781685026220841*^9, 3.781685026346856*^9}, 
   3.781685837596628*^9, {3.7818586600248327`*^9, 3.781858698654344*^9}, {
   3.781970479428784*^9, 3.781970484385592*^9}, {3.7819705355792217`*^9, 
   3.7819705604817953`*^9}, {3.78197064168012*^9, 3.781970681374538*^9}, {
   3.781970827474432*^9, 3.781970842441272*^9}, {3.781970876577787*^9, 
   3.781970888529028*^9}, {3.781970921400443*^9, 3.781970922960889*^9}, {
   3.781971313856226*^9, 3.781971348884428*^9}, 3.781973267320959*^9, {
   3.781973703254539*^9, 3.7819737120300198`*^9}, {3.781973757511489*^9, 
   3.781973759420343*^9}, {3.781973861345709*^9, 3.78197387908136*^9}, {
   3.781974403127407*^9, 3.781974427431816*^9}, {3.781974693619644*^9, 
   3.7819747015123672`*^9}, {3.7819748007121973`*^9, 
   3.7819748021185293`*^9}, {3.781975016770525*^9, 3.781975053425517*^9}, {
   3.7819753436909113`*^9, 3.781975360712893*^9}, {3.7819754145529757`*^9, 
   3.7819754494211483`*^9}, {3.781975481328372*^9, 3.7819754824002047`*^9}, {
   3.7819755501415653`*^9, 3.7819755872747087`*^9}, {3.7819756407124987`*^9, 
   3.781975708991906*^9}, {3.78197574343906*^9, 3.781975746360037*^9}, {
   3.781975781934388*^9, 3.7819758380507174`*^9}, {3.781975908523636*^9, 
   3.781975946423642*^9}, {3.781976094639604*^9, 3.781976192465424*^9}, {
   3.781976298402731*^9, 3.781976311159066*^9}, {3.781976504781452*^9, 
   3.781976515809821*^9}, {3.781976551492639*^9, 3.7819766200321712`*^9}, {
   3.7819766626814957`*^9, 3.781976763756845*^9}, {3.781976798118968*^9, 
   3.7819767987484922`*^9}, {3.781976851045764*^9, 3.7819770452495193`*^9}, {
   3.7819770875915937`*^9, 3.78197709450902*^9}, {3.781977343242259*^9, 
   3.781977352551201*^9}, {3.7819775153986683`*^9, 3.781977530740782*^9}, {
   3.781977564973339*^9, 3.781977573613017*^9}, {3.78197768755695*^9, 
   3.7819776941169443`*^9}, {3.781978216329488*^9, 3.781978243885551*^9}, {
   3.781983043634603*^9, 3.781983062376174*^9}, {3.781983123876878*^9, 
   3.781983128904243*^9}, {3.781983220548943*^9, 3.781983236694174*^9}, {
   3.7819834188814163`*^9, 3.781983432538183*^9}, {3.7819835455932083`*^9, 
   3.781983545661634*^9}, {3.781983686372409*^9, 3.781983704587221*^9}, {
   3.781983762849457*^9, 3.7819837781295643`*^9}, {3.781983821008318*^9, 
   3.78198385551932*^9}, {3.781983895262005*^9, 3.78198390497884*^9}, {
   3.7819841503967333`*^9, 3.781984165499565*^9}, 3.781984242698344*^9, {
   3.7819842789530497`*^9, 3.781984279111786*^9}, {3.781984336959611*^9, 
   3.781984399729515*^9}, {3.781984517716167*^9, 3.781984527771372*^9}, {
   3.781984767737414*^9, 3.7819847792293167`*^9}, {3.781985508450797*^9, 
   3.7819855164880657`*^9}, {3.7819866804963017`*^9, 3.781986681576619*^9}, {
   3.782020606289318*^9, 3.7820206331435223`*^9}, {3.782020836806452*^9, 
   3.782020849458085*^9}, {3.782020983745294*^9, 3.782020983854931*^9}, {
   3.7820212678906403`*^9, 3.782021294257024*^9}, {3.782021329650251*^9, 
   3.78202133154151*^9}, {3.78202307822106*^9, 3.782023103458386*^9}, {
   3.7820234551894703`*^9, 3.7820234585371227`*^9}, {3.782023777791298*^9, 
   3.782023786260988*^9}, {3.7820253817016478`*^9, 3.782025383650928*^9}, 
   3.7820255471854687`*^9, 3.7820255859523373`*^9, {3.78202595944545*^9, 
   3.7820259762225237`*^9}, {3.782026155003845*^9, 3.7820261565214043`*^9}, {
   3.7820262807623777`*^9, 3.7820262809270267`*^9}, {3.782026501789748*^9, 
   3.782026517802761*^9}, {3.7820274957744493`*^9, 3.7820275343413277`*^9}, {
   3.782030134478948*^9, 3.782030142811864*^9}, {3.782034835007429*^9, 
   3.782034868548449*^9}, {3.782034903724308*^9, 3.782034927037004*^9}, {
   3.782035117844241*^9, 3.782035191248231*^9}, {3.782035246703274*^9, 
   3.782035254485135*^9}, {3.78203534310105*^9, 3.782035393256496*^9}, {
   3.782035430752219*^9, 3.7820355008637743`*^9}, {3.782035531168173*^9, 
   3.7820355391955442`*^9}, {3.782035572957782*^9, 3.782035588181326*^9}, {
   3.782035621490081*^9, 3.782035622157496*^9}, {3.782035658116057*^9, 
   3.7820356592597713`*^9}, 3.782035752108653*^9, {3.782036605747527*^9, 
   3.782036609700107*^9}, {3.782036650872085*^9, 3.7820366750627003`*^9}, {
   3.782036739938059*^9, 3.782036748220147*^9}, {3.7820368536072197`*^9, 
   3.782036910382469*^9}, {3.782036961408597*^9, 3.782036964044695*^9}, 
   3.7820369943271627`*^9, {3.782037102594823*^9, 3.782037312166492*^9}, {
   3.782037414354631*^9, 3.782037522984377*^9}, {3.782037900270732*^9, 
   3.782037909791239*^9}, {3.782037953216354*^9, 3.782037973174725*^9}, {
   3.7820380918057547`*^9, 3.782038191673614*^9}, 3.782038276033437*^9, {
   3.782038360101893*^9, 3.782038449443288*^9}, {3.782038481098366*^9, 
   3.7820385887878447`*^9}, {3.782038674366754*^9, 3.782038676101048*^9}, {
   3.782038866846766*^9, 3.782038879675267*^9}, {3.782039658796513*^9, 
   3.782039658953662*^9}, {3.7820399967957973`*^9, 3.782040022257876*^9}, {
   3.782040890193972*^9, 3.782040915526806*^9}, 3.782041806438738*^9, {
   3.782489132803646*^9, 3.782489138581966*^9}, {3.783763538227076*^9, 
   3.783763545309702*^9}, {3.783763727238998*^9, 3.7837637486463118`*^9}, {
   3.783763846990728*^9, 3.7837639973529463`*^9}, {3.783764027806872*^9, 
   3.783764164585115*^9}, {3.783787583535782*^9, 3.783787588853381*^9}, {
   3.783787710799172*^9, 3.783787711308346*^9}, {3.783787849426342*^9, 
   3.783787880169121*^9}, {3.7837879209771214`*^9, 3.7837879268709583`*^9}, {
   3.7837988126584253`*^9, 3.7837988168567133`*^9}, {3.7869680103110657`*^9, 
   3.786968011884375*^9}, {3.7870566359357862`*^9, 3.787056638333597*^9}, 
   3.787902487443215*^9, {3.7879035827870407`*^9, 3.787903613818424*^9}, {
   3.78790367329218*^9, 3.787903696103341*^9}, {3.7879039877148247`*^9, 
   3.787904066881048*^9}, {3.787906924247305*^9, 3.787906960126708*^9}, {
   3.7879071325107718`*^9, 3.78790713757917*^9}, {3.787907198035866*^9, 
   3.787907241874853*^9}, {3.787915826876635*^9, 3.787915845924526*^9}, {
   3.787915881740589*^9, 3.78791588221117*^9}, {3.787916055527948*^9, 
   3.787916067192184*^9}, {3.7879178373424397`*^9, 3.787917841109544*^9}, {
   3.787917871851177*^9, 3.78791789665902*^9}, 3.787918939616555*^9, {
   3.7879213712090187`*^9, 3.787921377010886*^9}, {3.787921409843429*^9, 
   3.787921444207378*^9}, 3.802711297491666*^9, {3.807789915632619*^9, 
   3.80778991868692*^9}, {3.8077924732085743`*^9, 3.807792495883554*^9}, {
   3.807793454425742*^9, 3.8077934566446037`*^9}, 3.807793558128088*^9, {
   3.807793593831057*^9, 3.80779359895788*^9}, {3.807793677325316*^9, 
   3.807793704536694*^9}, {3.807985442010429*^9, 3.807985449040804*^9}, {
   3.807989386739872*^9, 3.807989397753536*^9}, {3.808051946372415*^9, 
   3.808051952663107*^9}, {3.808051999703402*^9, 3.808052057538762*^9}, {
   3.8080521606877327`*^9, 3.8080521652535467`*^9}, {3.808052225095913*^9, 
   3.808052275722418*^9}, {3.8080523965587*^9, 3.80805242422392*^9}, {
   3.808054331745401*^9, 3.808054332513186*^9}, {3.8080544308108463`*^9, 
   3.808054441988483*^9}, {3.808054580677874*^9, 3.808054598614485*^9}, {
   3.808054631815812*^9, 3.808054655834497*^9}, {3.80805474464145*^9, 
   3.8080547750901833`*^9}, {3.808054828143489*^9, 3.8080548620110683`*^9}, {
   3.8080550021215982`*^9, 3.8080551118957653`*^9}, {3.808055306425462*^9, 
   3.8080554502579403`*^9}, {3.808055513055287*^9, 3.8080555465537148`*^9}, {
   3.8080556207663116`*^9, 3.808055701661311*^9}, {3.808055734870295*^9, 
   3.8080557577706347`*^9}, {3.808055848605351*^9, 3.808055864570939*^9}, {
   3.808055895947966*^9, 3.808056026951891*^9}, {3.808056067398547*^9, 
   3.80805609395954*^9}, {3.808056140924355*^9, 3.808056202175819*^9}, {
   3.808056310199999*^9, 3.808056420770576*^9}, {3.808056468322728*^9, 
   3.8080566282111607`*^9}, {3.8080566702265587`*^9, 3.808056692227126*^9}, {
   3.808058176077817*^9, 3.808058197536375*^9}, {3.8080582308528*^9, 
   3.80805823747373*^9}, {3.8080591072686987`*^9, 3.8080591485491753`*^9}, {
   3.808059221866251*^9, 3.808059264339147*^9}, 3.8080593192139683`*^9, {
   3.808059418587134*^9, 3.808059501906302*^9}, {3.8080599308221607`*^9, 
   3.8080600137908287`*^9}, {3.80806010284832*^9, 3.808060113073138*^9}, {
   3.808066205204237*^9, 3.80806622192096*^9}, {3.808066427817491*^9, 
   3.8080664627818613`*^9}, {3.808066530854473*^9, 3.808066588264064*^9}, {
   3.80806664110874*^9, 3.8080666639649763`*^9}, {3.808069024792268*^9, 
   3.80806902514886*^9}, {3.808157691104542*^9, 3.8081576919534817`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[586]:=",ExpressionUUID->"5bf4a945-2832-4ded-bd46-b2a2c36cb644"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[587]:=",ExpressionUUID->"df4ff8bf-a235-4fa3-891e-260aed6f45df"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExpandCrystal", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.7609498283827267`*^9, 
   3.76094983161379*^9}},ExpressionUUID->"d8be70f0-5abd-4408-aff5-\
7a8cb4ec6342"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[593]:=",ExpressionUUID->"76155d8f-62c9-4b40-9727-17b64ac2a814"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExpandCrystal", "::", "InvalidSize"}], "=", 
   "\"\<The structure size must be a list of three natural numbers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandCrystal", "::", "DuplicateLabel"}], "=", 
    "\"\<The new label must be different from the input.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ExpandCrystal"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<DataFile\>\"", "\[Rule]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "$MaXrdPath", ",", "\"\<UserData\>\"", ",", 
          "\"\<CrystalData.m\>\""}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ExpandIntoNegative\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<FirstTransformTo\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<IgnoreSymmetry\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<IncludeBoundary\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<StoreTemporarily\>\"", "\[Rule]", "False"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ExpandCrystal"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
  3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
  3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
  3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
  3.756710476208014*^9}, {3.76094984995916*^9, 3.760949866421854*^9}, {
  3.762482676390929*^9, 3.762482706347602*^9}, {3.762487787402885*^9, 
  3.762487787935628*^9}, {3.787918971244069*^9, 3.7879189714753017`*^9}, {
  3.789890750985115*^9, 3.789890755442998*^9}},
 CellLabel->
  "In[594]:=",ExpressionUUID->"b48e0bd8-0193-45cd-a2cc-4be751b57aa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[598]:=",ExpressionUUID->"f1b20d08-e6a9-43f7-ab52-fb334a364cd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandCrystal", "[", 
   RowBox[{"crystal_String", ",", 
    RowBox[{"structureSize_List", ":", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"crystalDataOriginal", "=", "$CrystalData"}], ",", 
      RowBox[{"dataFile", "=", 
       RowBox[{"OptionValue", "[", "\"\<DataFile\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"newLabel", "=", 
       RowBox[{"OptionValue", "[", "\"\<NewLabel\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"changeCell", "=", 
       RowBox[{"OptionValue", "[", "\"\<FirstTransformTo\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"storeTempQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<StoreTemporarily\>\"", "]"}]}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ignoreSymmetryQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<IgnoreSymmetry\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", "crystalData", ",", "crystalCopy", ",", 
      "atomData", ",", "coordinates", ",", "spaceGroup", ",", "generated", 
      ",", "\[IndentingNewLine]", "copyTranslations", ",", "mid", ",", 
      "atomDataMapUnitCell", ",", "\[IndentingNewLine]", "cutoffFunction", 
      ",", "atomDataMapExpanded", ",", "lengths", ",", "\[IndentingNewLine]", 
      "newAtomData"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Input", " ", "check", " ", "and", " ", "data", " ", "acquisition"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AllTrue", "[", 
         RowBox[{"structureSize", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Positive", "[", "#", "]"}], "&&", 
            RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}]}], "]"}], "\[Nand]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "[", "structureSize", "]"}], "===", "3"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ExpandCrystal", "::", "InvalidSize"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"crystalData", "=", 
      RowBox[{"crystalCopy", "=", 
       RowBox[{"$CrystalData", "[", "crystal", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"crystal", "===", "newLabel"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ExpandCrystal", "::", "DuplicateLabel"}], ",", 
          "newLabel"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"newLabel", "===", "\"\<\>\""}], ",", 
       RowBox[{"newLabel", "=", 
        RowBox[{"crystal", "<>", "\"\<_\>\"", "<>", 
         RowBox[{"StringJoin", "@", 
          RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToString", "/@", "structureSize"}], ",", "\"\<x\>\""}], 
           "]"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Transform", " ", "cell", " ", "beforehand"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"changeCell", "=!=", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<InterpretSpaceGroup\>\"", ",", "changeCell"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"$CrystalData", ",", 
          RowBox[{"newLabel", "\[Rule]", "crystalCopy"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"UnitCellTransformation", "[", 
         RowBox[{"newLabel", ",", "changeCell"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"crystalData", "=", 
         RowBox[{"crystalCopy", "=", 
          RowBox[{"$CrystalData", "[", "newLabel", "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Expand", " ", "asymmetric", " ", "unit", " ", "to", " ", "unit", " ", 
       "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"atomData", "=", 
      RowBox[{"crystalData", "[", "\"\<AtomData\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coordinates", "=", 
      RowBox[{"atomData", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "\"\<FractionalCoordinates\>\""}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spaceGroup", "=", 
      RowBox[{"crystalData", "[", "\"\<SpaceGroup\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Ignory", " ", "symmetry", " ", "and", " ", "simply", " ", "copy", " ",
         "content", " ", "as", " ", "is"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"generated", "=", 
      RowBox[{"N", "@", 
       RowBox[{"If", "[", 
        RowBox[{"ignoreSymmetryQ", ",", "\[IndentingNewLine]", 
         RowBox[{"Partition", "[", 
          RowBox[{"coordinates", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"SymmetryEquivalentPositions", "[", 
            RowBox[{"spaceGroup", ",", "#"}], "]"}], "&"}], "/@", 
          "coordinates"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Generate", " ", "full", " ", "content", " ", "of", " ", "the", " ", 
       "unit", " ", "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"atomDataMapUnitCell", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "atomData"}]}], "\[Rule]", "generated"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Copy", " ", "by", " ", "translation"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"copyTranslations", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GenerateTargetPositions\>\"", ",", 
        RowBox[{"structureSize", "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomDataMapExpanded", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"Plus", ",", "copyTranslations", ",", "#", ",", "1"}], 
           "]"}], ",", "\[IndentingNewLine]", "1"}], "]"}], "&"}], "/@", 
       "atomDataMapUnitCell"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Complete", " ", "the", " ", "outer", " ", "boundary"}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cutoffFunction", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<IncludeBoundary\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "Greater", ",", "GreaterEqual"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Delete", " ", "atoms", " ", "whose", " ", "coordinates", " ", "are", 
       " ", "outside"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"atomDataMapExpanded", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"atomDataMapExpanded", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
         "\[IndentingNewLine]", 
         RowBox[{"Or", "@@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"cutoffFunction", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
              "structureSize"}], "}"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Center", " ", "translations", " ", "around", " ", "origin"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ExpandIntoNegative\>\"", "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mid", "=", 
         RowBox[{"\[LeftFloor]", 
          RowBox[{"structureSize", "/", "2."}], "\[RightFloor]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"atomDataMapExpanded", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "-", "mid"}], "&"}], ",", "atomDataMapExpanded", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Create", " ", "new", " ", "atom", " ", "data", " ", "structure"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"lengths", "=", 
      RowBox[{"Values", "[", 
       RowBox[{"Length", "/@", "atomDataMapExpanded"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newAtomData", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{
          "atomData", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "lengths", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "atomData"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newAtomData", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "\"\<FractionalCoordinates\>\""}], 
       "\[RightDoubleBracket]"}], "=", "\[IndentingNewLine]", 
      RowBox[{"Values", "@", "atomDataMapExpanded"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newAtomData", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"newAtomData", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Create", " ", "new", " ", "crystal", " ", "entry"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"crystalCopy", "[", "\"\<AtomData\>\"", "]"}], "=", 
      "newAtomData"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"crystalCopy", ",", 
       RowBox[{"\"\<Notes\>\"", "\[Rule]", 
        RowBox[{"<|", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<StructureSize\>\"", "\[Rule]", "structureSize"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<UnitCellAtomsCount\>\"", "\[Rule]", 
           RowBox[{"Total", "[", 
            RowBox[{"Length", "/@", "generated"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<AsymmetricUnitAtomsCount\>\"", "\[Rule]", 
           RowBox[{"Length", "@", "atomDataMapUnitCell"}]}]}], 
         "\[IndentingNewLine]", "|>"}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "If", " ", "temporary", " ", "storage", " ", "was", " ", "used"}], ",",
        " ", 
       RowBox[{
       "reset", " ", "pointer", " ", "to", " ", "original", " ", 
        "$CrystalData"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"storeTempQ", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MaXrd`Private`$TempCrystalData", "=", 
         RowBox[{"<|", 
          RowBox[{"newLabel", "\[Rule]", "crystalCopy"}], "|>"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$CrystalData", "=", "crystalDataOriginal"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "InputCheck", "[", "\"\<Update$CrystalDataAutoCompletion\>\"", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"InputCheck", "[", 
        RowBox[{
        "\"\<Update$CrystalDataFile\>\"", ",", "dataFile", ",", "newLabel", 
         ",", "crystalCopy"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "newLabel"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.7609498833793907`*^9, 3.76094989465484*^9}, {
   3.760985435505022*^9, 3.760985472615333*^9}, {3.761044721985759*^9, 
   3.7610447510077763`*^9}, {3.76104481522427*^9, 3.761044820157362*^9}, {
   3.76104492312523*^9, 3.76104492561299*^9}, {3.761045245983004*^9, 
   3.7610452901170893`*^9}, {3.761045366668412*^9, 3.761045378723996*^9}, {
   3.76124639061635*^9, 3.761246410336463*^9}, {3.761246468837595*^9, 
   3.761246470395545*^9}, {3.761246673739036*^9, 3.761246692142757*^9}, {
   3.761246756527741*^9, 3.761246831173169*^9}, {3.7612468685554323`*^9, 
   3.761246869827717*^9}, {3.7612469112124767`*^9, 3.761247051614558*^9}, {
   3.761247130070651*^9, 3.7612471343322563`*^9}, {3.761247190774343*^9, 
   3.761247226696908*^9}, {3.7612472608003902`*^9, 3.761247277095755*^9}, {
   3.7612473349529333`*^9, 3.761247347238995*^9}, {3.761247379119833*^9, 
   3.761247382237371*^9}, {3.761247500765175*^9, 3.761247531645439*^9}, {
   3.761247581531475*^9, 3.761247581665276*^9}, {3.76124761695472*^9, 
   3.761247712374427*^9}, {3.7612478775715733`*^9, 3.7612479024911127`*^9}, {
   3.761248027065674*^9, 3.7612480322790403`*^9}, {3.761248133261649*^9, 
   3.761248133821176*^9}, {3.762483079092483*^9, 3.762483079506445*^9}, {
   3.7624831653076982`*^9, 3.762483255155518*^9}, {3.762483448748105*^9, 
   3.762483459337694*^9}, {3.762484937954467*^9, 3.762484940528129*^9}, {
   3.762485478717585*^9, 3.762485519250081*^9}, {3.762485687785385*^9, 
   3.7624856997759*^9}, {3.762485763767784*^9, 3.7624857909884033`*^9}, {
   3.762485821389303*^9, 3.762485821901321*^9}, {3.762485865116181*^9, 
   3.76248587338028*^9}, {3.7624863035622253`*^9, 3.762486306889323*^9}, 
   3.7624864059931593`*^9, {3.762486451749774*^9, 3.762486453088664*^9}, {
   3.762486658295171*^9, 3.762486679735591*^9}, {3.762486914173285*^9, 
   3.762486976278838*^9}, {3.762487161588236*^9, 3.762487164161865*^9}, {
   3.762582301146738*^9, 3.762582302868475*^9}, {3.7625825420446243`*^9, 
   3.7625825422070208`*^9}, 3.7627930931894283`*^9, {3.763708440950055*^9, 
   3.763708444458358*^9}, {3.763795706131096*^9, 3.76379571208855*^9}, {
   3.763795807464473*^9, 3.763795831454368*^9}, {3.767429560180451*^9, 
   3.767429568446164*^9}, {3.774162986206664*^9, 3.7741629917030163`*^9}, 
   3.7741630430762568`*^9, {3.774335933431451*^9, 3.7743359338200397`*^9}, 
   3.783764253513776*^9, {3.786968024534349*^9, 3.786968026020122*^9}, {
   3.786968233887024*^9, 3.786968234926949*^9}, {3.787918929208872*^9, 
   3.787918930742538*^9}, {3.787921457534053*^9, 3.787921461294797*^9}, {
   3.787921521078904*^9, 3.787921571054237*^9}, {3.789890763246366*^9, 
   3.78989077689367*^9}, {3.789890814202901*^9, 3.789890868453092*^9}, {
   3.789890918464478*^9, 3.789890933945571*^9}, {3.789893102417894*^9, 
   3.789893129978921*^9}, {3.789893434137013*^9, 3.7898934724694023`*^9}, {
   3.789893510559649*^9, 3.7898935222545424`*^9}, {3.7898937339835253`*^9, 
   3.7898937396849833`*^9}, {3.789893851421419*^9, 3.789893903637013*^9}, {
   3.789893973952984*^9, 3.789893978097289*^9}, 3.789894029115768*^9, {
   3.789894063622571*^9, 3.789894084695013*^9}, {3.808154601598259*^9, 
   3.808154617757903*^9}, {3.808154670533194*^9, 3.808154670660129*^9}, {
   3.808154742124251*^9, 3.80815474902457*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[599]:=",ExpressionUUID->"69ae2f53-5d24-4c53-aae5-f53221459a2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[600]:=",ExpressionUUID->"c94c2bf3-84c7-42e2-8b09-c242a0d20754"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExportCrystalData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, 3.7609476409800777`*^9, {3.7609487462297173`*^9, 
   3.760948749343501*^9}},ExpressionUUID->"f7a8ab5e-bed2-4065-9968-\
ed763bd03f9c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[601]:=",ExpressionUUID->"5571c796-7697-4606-870e-cb6667435c26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExportCrystalData", "::", "InvalidProgramOrFormat"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid program/format.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportCrystalData", "::", "ParameterError"}], "=", 
   "\"\<Invalid input parameters.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportCrystalData", "::", "DirectoryExpected"}], "=", 
   "\"\<An existing output directory was expected.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportCrystalData", "::", "InvalidSubtractionMode"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid scattering \
subtraction mode.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExportCrystalData", "::", "InvalidImageDimensions"}], "=", 
    "\"\<Image dimensions must be two positive integers.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ExportCrystalData"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Detailed\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<IncludeStructureSizeInfo\>\"", "\[Rule]", "True"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ExportCrystalData"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_", ",", "_.", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
   3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
   3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
   3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
   3.756710476208014*^9}, {3.760947644803529*^9, 3.760947651026847*^9}, {
   3.760948534996868*^9, 3.760948535383339*^9}, {3.760948688241331*^9, 
   3.7609486934259567`*^9}, {3.7609487820228167`*^9, 3.76094879210434*^9}, {
   3.760949201797782*^9, 3.760949202747923*^9}, {3.762260658085307*^9, 
   3.76226066257444*^9}, {3.7622609746385403`*^9, 3.762261058218439*^9}, {
   3.762261088555375*^9, 3.762261091391992*^9}, {3.7622612217375727`*^9, 
   3.76226123364686*^9}, {3.762268206412442*^9, 3.7622682070976057`*^9}, {
   3.779730376903879*^9, 3.7797303820552464`*^9}, {3.783096300229866*^9, 
   3.783096316052045*^9}, {3.783096386987299*^9, 3.783096389634581*^9}, {
   3.783183295178351*^9, 3.783183302775968*^9}, {3.7836006713866453`*^9, 
   3.783600672561048*^9}, {3.783600830261743*^9, 3.783600844235523*^9}, {
   3.7836020742464542`*^9, 3.7836020750707073`*^9}, {3.783602179652493*^9, 
   3.783602194643867*^9}, {3.7836023402490273`*^9, 3.7836023404084663`*^9}, {
   3.783603784506094*^9, 3.783603828296677*^9}, {3.783886429013074*^9, 
   3.783886450354972*^9}, {3.785686786631078*^9, 3.785686832676466*^9}, {
   3.7856868715223713`*^9, 3.785686890705042*^9}, {3.787396040835217*^9, 
   3.787396040908201*^9}, {3.787396078866993*^9, 3.787396088575492*^9}, {
   3.8073693683380136`*^9, 3.807369403240162*^9}, 3.8073702984142857`*^9},
 CellLabel->
  "In[602]:=",ExpressionUUID->"6ceb2ccc-2625-4f56-bc27-d58b0808cf26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[609]:=",ExpressionUUID->"b9a0c610-6a60-491a-9387-586588077ba9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExportCrystalData", "[", 
   RowBox[{
   "\"\<DISCUS\>\"", ",", "crystal_String", ",", "outputFile_String", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "crystalData", ",", "atomData", ",", "size", ",", "unitCellAtomCount", 
      ",", "latticeParameters", ",", "\[IndentingNewLine]", "formatter", ",", 
      "appendComma", ",", "simpleQ", ",", "\[IndentingNewLine]", 
      "preambleTitle", ",", "preambleSpaceGroup", ",", "preambleCell", ",", 
      "preambleCount", ",", "preambleAtomsHeader", ",", "preamble", ",", 
      "\[IndentingNewLine]", "elements", ",", "coordinates", ",", "dispPars", 
      ",", "items", ",", "spacesToUse", ",", "additional", ",", "makeSpace", 
      ",", "atoms"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Loading", " ", "necessary", " ", "data"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "crystalData", ",", "atomData", ",", "size", ",", 
        "latticeParameters"}], "}"}], "=", 
      RowBox[{"ECD$LoadNecessaries", "@", "crystal"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"unitCellAtomCount", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"crystalData", "[", "\"\<Notes\>\"", "]"}], ",", 
        "\[IndentingNewLine]", "\"\<UnitCellAtomsCount\>\"", ",", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Length", "[", "atomData", "]"}], "/", 
          RowBox[{"Times", "@@", "size"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Auxiliary", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"formatter", "[", "x_", "]"}], ":=", 
      RowBox[{"ToString", "@", 
       RowBox[{"NumberForm", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"Chop", "[", 
           RowBox[{"x", ",", 
            RowBox[{"Power", "[", 
             RowBox[{"10.", ",", 
              RowBox[{"-", "5"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "6"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"appendComma", "[", "x_", "]"}], ":=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringInsert", "[", 
          RowBox[{"#", ",", "\"\<,\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "&"}], ",", "x", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"simpleQ", "=", 
      RowBox[{"!", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<Detailed\>\"", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"latticeParameters", "=", 
      RowBox[{"If", "[", 
       RowBox[{"simpleQ", ",", "\[IndentingNewLine]", 
        RowBox[{"ToString", "/@", 
         RowBox[{"N", "@", "latticeParameters"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{"formatter", ",", "latticeParameters", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Creating", " ", "the", " ", "preamble"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"preambleTitle", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<title  \>\"", ",", "crystal"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"preambleSpaceGroup", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<spcgr  \>\"", ",", 
        RowBox[{"StringDelete", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"$GroupSymbolRedirect", "[", 
            RowBox[{"crystalData", "[", "\"\<SpaceGroup\>\"", "]"}], "]"}], 
           "\[IndentingNewLine]", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinShort\>\""}], 
           "]"}], ",", "\"\< \>\""}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"preambleCell", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<cell   \>\"", ",", 
        RowBox[{"StringJoin", "@", 
         RowBox[{"Riffle", "[", 
          RowBox[{"latticeParameters", ",", "\"\<  \>\""}], "]"}]}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"preambleCount", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<ncell  \>\"", ",", 
        RowBox[{"StringJoin", "@", 
         RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ToString", "/@", 
            RowBox[{"Join", "[", 
             RowBox[{"size", ",", 
              RowBox[{"{", "unitCellAtomCount", "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\"\<,  \>\""}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"preambleAtomsHeader", "=", 
      RowBox[{"If", "[", 
       RowBox[{"simpleQ", ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\"\<atoms\\n\>\"", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
        "{", "\"\<atoms      x,              y,              z,             \
Biso,    Property,  MoleNo,  MoleAt,   Occ\\n\>\"", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"preamble", "=", 
      RowBox[{"StringJoin", "@", 
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "preambleTitle", ",", "preambleSpaceGroup", ",", "preambleCell", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"TrueQ", "@", 
              RowBox[{
              "OptionValue", "[", "\"\<IncludeStructureSizeInfo\>\"", "]"}]}],
              ",", "\[IndentingNewLine]", "preambleCount", ",", "Nothing"}], 
            "]"}], ",", "\[IndentingNewLine]", "preambleAtomsHeader"}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\"\<\\n\>\"", "}"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "atom", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"ToUpperCase", "@", 
       RowBox[{"Lookup", "[", 
        RowBox[{"atomData", ",", "\"\<Element\>\""}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"elements", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<+\>\"", ",", "\"\<-\>\"", ",", "DigitCharacter"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coordinates", "=", 
      RowBox[{"N", "@", 
       RowBox[{"Lookup", "[", 
        RowBox[{"atomData", ",", "\"\<FractionalCoordinates\>\""}], "]"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"coordinates", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"formatter", ",", "coordinates", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "simpleQ"}], ",", 
       RowBox[{"coordinates", "=", 
        RowBox[{"appendComma", "@", "coordinates"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dispPars", "=", 
      RowBox[{
       RowBox[{
       "TransformAtomicDisplacementParameters", "[", "\[IndentingNewLine]", 
        RowBox[{"crystal", ",", "\"\<EquivalentIsotropic\>\""}], "]"}], "/.", 
       
       RowBox[{"_Missing", "\[Rule]", "0."}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"dispPars", "=", 
      RowBox[{"formatter", "/@", "dispPars"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "simpleQ"}], ",", 
       RowBox[{"dispPars", "=", 
        RowBox[{"appendComma", "@", "dispPars"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"items", "=", 
      RowBox[{"{", 
       RowBox[{"elements", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Transpose", "@", "coordinates"}]}], ",", "dispPars"}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Determining", " ", "spacing", " ", "information"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"spacesToUse", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"11", ",", "16", ",", "16", ",", "15", ",", "8"}], "}"}], 
         ",", 
         RowBox[{"Length", "@", "atomData"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"additional", "=", "\"\<1,       0,       0,   1.000000\>\""}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "spacesToUse", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
         "=", 
        RowBox[{
         RowBox[{
         "spacesToUse", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], "-", 
         RowBox[{"(", 
          RowBox[{"StringLength", "/@", 
           RowBox[{
           "items", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "@", "items"}], "-", "1"}]}], "}"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"spacesToUse", "=", 
      RowBox[{"Transpose", "@", "spacesToUse"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"makeSpace", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"\"\< \>\"", ",", 
        RowBox[{"spacesToUse", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Writing", " ", "atom", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"atoms", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Sow", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "elements", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"makeSpace", "[", 
              RowBox[{"i", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"coordinates", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"makeSpace", "[", 
              RowBox[{"i", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"coordinates", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"makeSpace", "[", 
              RowBox[{"i", ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"coordinates", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"makeSpace", "[", 
              RowBox[{"i", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "dispPars", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"makeSpace", "[", 
              RowBox[{"i", ",", "5"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"simpleQ", ",", "\"\<\>\"", ",", "additional"}], "]"}], 
             ",", "\[IndentingNewLine]", "\"\<\\n\>\""}], 
            "\[IndentingNewLine]", "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "atomData"}]}], "}"}]}], "]"}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Prepare", " ", "output", " ", "and", " ", "export"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"outputFile", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"preamble", ",", "atoms"}], "]"}], ",", "\"\<String\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.760948481143589*^9, 3.760948499262701*^9}, {
   3.7609488207683067`*^9, 3.760948841778069*^9}, {3.760948882588552*^9, 
   3.760948883842764*^9}, {3.760948940717063*^9, 3.760948975282666*^9}, {
   3.760949011970159*^9, 3.760949012184416*^9}, 3.760949083736237*^9, {
   3.760949130238394*^9, 3.76094916161519*^9}, 3.760985557982565*^9, {
   3.7611975087352133`*^9, 3.76119751660457*^9}, {3.761474171084214*^9, 
   3.761474174768375*^9}, {3.761474414190099*^9, 3.761474436739811*^9}, {
   3.761474489155945*^9, 3.761474515473364*^9}, {3.761474549322021*^9, 
   3.761474603151936*^9}, {3.761474729429777*^9, 3.761474784036825*^9}, {
   3.761474849276947*^9, 3.7614748512846203`*^9}, 3.7614749412429934`*^9, {
   3.761475075055262*^9, 3.761475111589944*^9}, {3.761475177678194*^9, 
   3.761475208235873*^9}, {3.7614754099022007`*^9, 3.761475460275897*^9}, {
   3.7614755580354347`*^9, 3.7614755584485207`*^9}, {3.761475602255143*^9, 
   3.761475618458747*^9}, {3.761475728303033*^9, 3.7614757291959743`*^9}, {
   3.761475895540306*^9, 3.761475953150948*^9}, {3.7614759877525053`*^9, 
   3.7614760216772137`*^9}, {3.761476346852703*^9, 3.761476436475614*^9}, {
   3.761476501004677*^9, 3.7614765014024887`*^9}, {3.76147653684481*^9, 
   3.7614765625145817`*^9}, {3.7614766027780857`*^9, 3.761476696389943*^9}, {
   3.761476781958541*^9, 3.761476847138636*^9}, {3.761476879235957*^9, 
   3.761476898257463*^9}, {3.7614769388987217`*^9, 3.761476939672125*^9}, {
   3.7617280288811703`*^9, 3.7617280290289*^9}, {3.762062000358593*^9, 
   3.762062002890757*^9}, 3.7622515661086082`*^9, {3.762251817102137*^9, 
   3.762251929165433*^9}, {3.762252005452671*^9, 3.762252005611527*^9}, {
   3.762252046930657*^9, 3.7622520653518887`*^9}, {3.7622521337322073`*^9, 
   3.762252160781577*^9}, {3.762252243669989*^9, 3.762252252382333*^9}, {
   3.7622522870584927`*^9, 3.7622523110998173`*^9}, {3.7622525892905617`*^9, 
   3.762252653190784*^9}, {3.762252687617072*^9, 3.76225268868604*^9}, 
   3.762252720098925*^9, {3.7622602134972677`*^9, 3.762260245781844*^9}, {
   3.7622603606728363`*^9, 3.7622603955795927`*^9}, 3.762260809124468*^9, {
   3.762260920835347*^9, 3.7622609336590014`*^9}, {3.7622611020859957`*^9, 
   3.7622611022128*^9}, {3.762265433988163*^9, 3.762265647951427*^9}, {
   3.762265682974736*^9, 3.762265714676045*^9}, {3.7622657998190107`*^9, 
   3.762265823490719*^9}, {3.762266150777772*^9, 3.762266183714326*^9}, {
   3.762266297442079*^9, 3.762266404084507*^9}, {3.762266503346043*^9, 
   3.7622665058192873`*^9}, {3.762266581522806*^9, 3.762266603588318*^9}, {
   3.762266694495263*^9, 3.762266728238165*^9}, {3.762266789430751*^9, 
   3.76226681293922*^9}, {3.7622668497813883`*^9, 3.762266850066354*^9}, {
   3.762267098742383*^9, 3.762267102028309*^9}, {3.762267643315309*^9, 
   3.7622677082670116`*^9}, {3.762267743017583*^9, 3.762267788543005*^9}, {
   3.7622678343978357`*^9, 3.762267872315877*^9}, {3.762267908117887*^9, 
   3.762267928051405*^9}, 3.762267973773315*^9, {3.762268017780451*^9, 
   3.7622680575155687`*^9}, 3.762793093215591*^9, {3.763796995475988*^9, 
   3.7637970043599586`*^9}, {3.7643154838421183`*^9, 3.764315495506998*^9}, {
   3.764945527167924*^9, 3.764945538174453*^9}, {3.767432814398486*^9, 
   3.767432819483389*^9}, {3.7674328754926987`*^9, 3.767432894311245*^9}, {
   3.7674334785881023`*^9, 3.76743347876075*^9}, {3.783069231678774*^9, 
   3.783069266967184*^9}, 3.7830693020753717`*^9, 3.7830876846213007`*^9, {
   3.783601557168208*^9, 3.78360156744668*^9}, {3.7836022865660763`*^9, 
   3.783602306060294*^9}, {3.783602507800161*^9, 3.783602521215067*^9}, {
   3.7836025595507593`*^9, 3.783602559800055*^9}, {3.783604816433077*^9, 
   3.783604819534629*^9}, {3.783749852081997*^9, 3.7837498583161583`*^9}, {
   3.783839612368231*^9, 3.783839619375147*^9}, {3.7838397408860607`*^9, 
   3.783839742547872*^9}, 3.7838399432332*^9, {3.78383997716043*^9, 
   3.783839994134857*^9}, {3.783840038479353*^9, 3.783840055934451*^9}, {
   3.7856866354927807`*^9, 3.785686661125942*^9}, {3.787396175011367*^9, 
   3.787396179069569*^9}, {3.787396223402565*^9, 3.7873962849858294`*^9}, {
   3.787397043019964*^9, 3.7873970855250607`*^9}, {3.7873971691273746`*^9, 
   3.787397172890153*^9}, {3.829193497127316*^9, 3.829193508579809*^9}, {
   3.8291935399744463`*^9, 3.829193553462473*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"a4cd486d-bc96-4d05-b50a-fa58a9049e19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExportCrystalData", "[", 
   RowBox[{
   "\"\<DIFFUSE\>\"", ",", "crystal_String", ",", "outputDir_String", ",", 
    "hklPlane_", ",", "indexLimit_", ",", "subtractionMode_String", ",", 
    RowBox[{"{", 
     RowBox[{"width_Integer", ",", "height_Integer"}], "}"}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "reorganise", ",", "source", ",", "scatteringFactorTemplate", ",", 
      "\[IndentingNewLine]", "crystalData", ",", "atomData", ",", 
      "allElements", ",", "size", ",", "latticeParameters", ",", 
      "directionCosines", ",", "M", ",", "\[IndentingNewLine]", "partA", ",", 
      "X", ",", "Y", ",", "Z", ",", "unitCells", ",", "MakeSitesTable", ",", 
      "table", ",", "sitesList", ",", "\[IndentingNewLine]", "partB", ",", 
      "maxPossibleSites", ",", "newAtomData", ",", "blockLengths", ",", 
      "\[IndentingNewLine]", "headerComments", ",", "headerData", ",", 
      "padWidth", ",", "header", ",", "scatteringData"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Checks", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "@", "outputDir"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ExportCrystalData", "::", "DirectoryExpected"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<N\>\"", ",", "\"\<Y\>\"", ",", "\"\<E\>\"", ",", 
            "\"\<e\>\""}], "}"}], ",", "subtractionMode"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ExportCrystalData", "::", "InvalidSubtractionMode"}], ",", 
          "subtractionMode"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"width", ",", "height"}], "}"}], ",", "Positive"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ExportCrystalData", "::", "InvalidImageDimensions"}], "]"}],
         ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Auxiliary", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reorganise", "[", "data_Association", "]"}], ":=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xyz", "=", 
          RowBox[{"data", "[", "\"\<FractionalCoordinates\>\"", "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "/@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"IntegerPart", "@", "xyz"}], "+", "1"}], ",", "size"}],
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
           RowBox[{"\"\<   \>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"StringPadRight", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "@", 
                 RowBox[{"DecimalForm", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"11", ",", "5"}], "}"}]}], "]"}]}], "&"}], "/@", 
               RowBox[{"FractionalPart", "@", "xyz"}]}], ",", "11"}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"StringDelete", "[", 
             RowBox[{
              RowBox[{"data", "[", "\"\<Element\>\"", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}],
                "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeSitesTable", "[", "stop_Integer", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"table", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", ">", "stop"}], ",", "0", ",", "i"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "maxPossibleSites"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"table", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"ToString", ",", "table", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"table", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"StringPadLeft", "[", 
            RowBox[{"#", ",", "6"}], "]"}], "&"}], "/@", "table"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "/@", "table"}]}], "\[IndentingNewLine]", 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"source", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
          "\"\<AtomicScatteringFactor\>\"", ",", 
          "\"\<InternationalTablesC(3rd).m\>\""}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"scatteringFactorTemplate", "[", "element_", "]"}], ":=", 
      RowBox[{
       RowBox[{
       "StringTemplate", "[", 
        "\"\<'`X`'\n`a1`,`b1`,`a2`,`b2`\n`a3`,`b3`,`a4`,`b4`,`c`\n\
0.0,0.0\>\"", "]"}], "@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"source", "[", "element", "]"}], ",", 
         RowBox[{"<|", 
          RowBox[{"\"\<X\>\"", "\[Rule]", "element"}], "|>"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Loading", " ", "necessary", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "crystalData", ",", "atomData", ",", "size", ",", 
        "latticeParameters"}], "}"}], "=", 
      RowBox[{"ECD$LoadNecessaries", "@", "crystal"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allElements", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"atomData", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "\"\<Element\>\""}], 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allElements", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringDelete", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
            "}"}]}], "]"}], "&"}], "/@", "allElements"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"directionCosines", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"DecimalForm", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"#", "*", "Degree"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"6", ",", "5"}], "}"}]}], "]"}]}], "&"}], "/@", 
       RowBox[{"N", "@", 
        RowBox[{"latticeParameters", "\[LeftDoubleBracket]", 
         RowBox[{"4", ";;", "6"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"GetCrystalMetric", "[", 
       RowBox[{"crystal", ",", 
        RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"File", " ", "1"}], ":", " ", 
       RowBox[{"Crystal", " ", "data", " ", 
        RowBox[{"in", " ", "'"}], 
        RowBox[{"DIFFUSE", "'"}], " ", "format"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Part", " ", "B"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newAtomData", "=", 
      RowBox[{"reorganise", "/@", "atomData"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"newAtomData", "=", 
      RowBox[{"DeleteDuplicates", "/@", 
       RowBox[{"GatherBy", "[", 
        RowBox[{"newAtomData", ",", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"blockLengths", "=", 
      RowBox[{"Length", "/@", "newAtomData"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"maxPossibleSites", "=", 
      RowBox[{"Max", "@", "blockLengths"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"partB", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTemplate", "[", "\"\< `1` `2` `3`\>\"", "]"}], "@@@", 
          RowBox[{"newAtomData", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"newAtomData", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Part", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sitesList", "=", 
      RowBox[{"MakeSitesTable", "/@", "blockLengths"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}], "=", "size"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"unitCells", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTemplate", "[", "\"\< `1` `2` `3`\>\"", "]"}], "[", 
           
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1", ",", "X"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "1", ",", "Y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "1", ",", "Z"}], "}"}]}], "]"}], ",", "2"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"partA", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"unitCells", ",", "sitesList"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"partA", ",", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\< `X` `Y` `Z` `N1` `N1`\>\"", "]"}], "@", 
        RowBox[{"<|", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<X\>\"", "\[Rule]", "X"}], ",", 
          RowBox[{"\"\<Y\>\"", "\[Rule]", "Y"}], ",", 
          RowBox[{"\"\<Z\>\"", "\[Rule]", "Z"}], ",", 
          RowBox[{"\"\<N1\>\"", "\[Rule]", "maxPossibleSites"}]}], "|>"}]}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"File", " ", "2"}], ":", " ", 
       RowBox[{
        RowBox[{"Input", "/", "summary"}], " ", "file"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"headerComments", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<Header or structure label\>\"", ",", "\[IndentingNewLine]", 
        "\"\<Random number seeds\>\"", ",", "\[IndentingNewLine]", 
        "\"\<Cell coord's; angles are cos(ang)\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\<Size of crystal simulation (unit cells)\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Periodic Boundary?\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Origin of volume\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\<u-axis (bottom right) and image x-dimension\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\<v-axis (top left) and image y-dimension\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\<w-axis (top right) and image z-dimension\>\"", ",", 
        "\[IndentingNewLine]", "\"\<sin(theta)/lambda maximum\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Lot size\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Number of lots\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Number of atom sites per cell\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\<Number of different atom types (list of sc.coef's below)\>\"", 
        ",", "\[IndentingNewLine]", 
        "\"\<Subtract average lattice? ('N', 'e', 'E' or 'Y')\>\""}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"headerData", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "crystal", ",", "\[IndentingNewLine]", "\"\<12645, 9676\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "StringTemplate", "[", "\"\<`1` `2` `3`  `4` `5` `6`\>\"", "]"}], "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"latticeParameters", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], ",", 
           "directionCosines"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StringTemplate", "[", "\"\<`1` `2` `3`\>\"", "]"}], "@@", 
         "size"}], ",", "\[IndentingNewLine]", "\"\<Y\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"InputCheck", "[", 
          RowBox[{
          "\"\<GetReciprocalImageOrientation\>\"", ",", "\[IndentingNewLine]",
            "crystal", ",", "hklPlane", ",", "indexLimit", ",", 
           RowBox[{"{", 
            RowBox[{"width", ",", "height"}], "}"}], ",", "True"}], "]"}]}], 
        ",", "\[IndentingNewLine]", "\"\<3.0\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StringTemplate", "[", "\"\<`1` `2` `3`\>\"", "]"}], "@@", 
         "size"}], ",", "\[IndentingNewLine]", "\"\<1\>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ToString", "@", "maxPossibleSites"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ToString", "@", 
         RowBox[{"Length", "@", "allElements"}]}], ",", "\[IndentingNewLine]",
         "subtractionMode"}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"padWidth", "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"StringLength", "/@", "headerData"}], "]"}], "+", "3"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"headerData", "=", 
      RowBox[{"StringPadRight", "[", 
       RowBox[{"headerData", ",", "padWidth"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"header", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"headerData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<! \>\"", "<>", "#"}], "&"}], "/@", 
          "headerComments"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"scatteringData", "=", 
      RowBox[{"scatteringFactorTemplate", "/@", "allElements"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Prepare", " ", "output", " ", "and", " ", "export"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Export", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"outputDir", ",", "\"\<diffuse_input1_crystal.txt\>\""}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"partA", ",", "partB", ",", 
           RowBox[{"{", "\"\<\\n\>\"", "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\"\<Table\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"outputDir", ",", "\"\<diffuse_input2_setup.txt\>\""}], 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"header", ",", "scatteringData", ",", 
           RowBox[{"{", "\"\<\\n\>\"", "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\"\<Table\>\""}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.760948481143589*^9, 3.760948499262701*^9}, {
   3.7609488207683067`*^9, 3.760948841778069*^9}, {3.760948882588552*^9, 
   3.760948883842764*^9}, {3.760948940717063*^9, 3.760948975282666*^9}, {
   3.760949011970159*^9, 3.760949012184416*^9}, 3.760949083736237*^9, {
   3.760949130238394*^9, 3.76094916161519*^9}, 3.760985557982565*^9, {
   3.7611975087352133`*^9, 3.76119751660457*^9}, {3.761474171084214*^9, 
   3.761474174768375*^9}, {3.761474414190099*^9, 3.761474436739811*^9}, {
   3.761474489155945*^9, 3.761474515473364*^9}, {3.761474549322021*^9, 
   3.761474603151936*^9}, {3.761474729429777*^9, 3.761474784036825*^9}, {
   3.761474849276947*^9, 3.7614748512846203`*^9}, 3.7614749412429934`*^9, {
   3.761475075055262*^9, 3.761475111589944*^9}, {3.761475177678194*^9, 
   3.761475208235873*^9}, {3.7614754099022007`*^9, 3.761475460275897*^9}, {
   3.7614755580354347`*^9, 3.7614755584485207`*^9}, {3.761475602255143*^9, 
   3.761475618458747*^9}, {3.761475728303033*^9, 3.7614757291959743`*^9}, {
   3.761475895540306*^9, 3.761475953150948*^9}, {3.7614759877525053`*^9, 
   3.7614760216772137`*^9}, {3.761476346852703*^9, 3.761476436475614*^9}, {
   3.761476501004677*^9, 3.7614765014024887`*^9}, {3.76147653684481*^9, 
   3.7614765625145817`*^9}, {3.7614766027780857`*^9, 3.761476696389943*^9}, {
   3.761476781958541*^9, 3.761476847138636*^9}, {3.761476879235957*^9, 
   3.761476898257463*^9}, {3.7614769388987217`*^9, 3.761476939672125*^9}, {
   3.7617280288811703`*^9, 3.7617280290289*^9}, {3.762062000358593*^9, 
   3.762062002890757*^9}, 3.7622515661086082`*^9, {3.762251817102137*^9, 
   3.762251929165433*^9}, {3.762252005452671*^9, 3.762252005611527*^9}, {
   3.762252046930657*^9, 3.7622520653518887`*^9}, {3.7622521337322073`*^9, 
   3.762252160781577*^9}, {3.762252243669989*^9, 3.762252252382333*^9}, {
   3.7622522870584927`*^9, 3.7622523110998173`*^9}, {3.7622525892905617`*^9, 
   3.762252653190784*^9}, {3.762252687617072*^9, 3.76225268868604*^9}, 
   3.762252720098925*^9, {3.7622602134972677`*^9, 3.762260245781844*^9}, {
   3.7622603606728363`*^9, 3.7622603955795927`*^9}, 3.762260809124468*^9, {
   3.762260920835347*^9, 3.7622609336590014`*^9}, {3.7622611020859957`*^9, 
   3.7622611022128*^9}, {3.762265433988163*^9, 3.762265647951427*^9}, {
   3.762265682974736*^9, 3.762265714676045*^9}, {3.7622657998190107`*^9, 
   3.762265823490719*^9}, {3.762266150777772*^9, 3.762266183714326*^9}, {
   3.762266297442079*^9, 3.762266404084507*^9}, {3.762266503346043*^9, 
   3.7622665058192873`*^9}, {3.762266581522806*^9, 3.762266603588318*^9}, {
   3.762266694495263*^9, 3.762266728238165*^9}, {3.762266789430751*^9, 
   3.76226681293922*^9}, {3.7622668497813883`*^9, 3.762266850066354*^9}, {
   3.762267098742383*^9, 3.762267102028309*^9}, {3.762267643315309*^9, 
   3.7622677082670116`*^9}, {3.762267743017583*^9, 3.762267788543005*^9}, {
   3.7622678343978357`*^9, 3.762267872315877*^9}, {3.762267908117887*^9, 
   3.762267928051405*^9}, 3.762267973773315*^9, {3.762268017780451*^9, 
   3.7622680575155687`*^9}, 3.762793093215591*^9, {3.763796995475988*^9, 
   3.7637970043599586`*^9}, {3.7643154838421183`*^9, 3.764315495506998*^9}, {
   3.764945527167924*^9, 3.764945538174453*^9}, {3.767432814398486*^9, 
   3.767432819483389*^9}, {3.7674328754926987`*^9, 3.767432894311245*^9}, {
   3.7674334785881023`*^9, 3.76743347876075*^9}, {3.783069231678774*^9, 
   3.783069266967184*^9}, 3.7830693020753717`*^9, {3.783087670253394*^9, 
   3.783087692517221*^9}, {3.783087735097041*^9, 3.7830880407310047`*^9}, {
   3.7830896557036057`*^9, 3.783089655981719*^9}, {3.7830960653733*^9, 
   3.783096097330763*^9}, {3.783096177529833*^9, 3.783096217488394*^9}, 
   3.783096403572884*^9, {3.783096499380589*^9, 3.783096678487729*^9}, {
   3.7830967101189957`*^9, 3.7830967683185453`*^9}, {3.783096810245809*^9, 
   3.7830969314424973`*^9}, {3.783157041710597*^9, 3.783157071451893*^9}, 
   3.783158293531158*^9, {3.783158345329475*^9, 3.7831584119283037`*^9}, {
   3.783162888798779*^9, 3.7831629160834846`*^9}, {3.783173913377779*^9, 
   3.783173927301927*^9}, {3.78317468233254*^9, 3.783174731586187*^9}, {
   3.783181333932486*^9, 3.783181355705113*^9}, 3.783182265822321*^9, {
   3.783182316941475*^9, 3.783182383458167*^9}, {3.783182554647244*^9, 
   3.7831825600059423`*^9}, {3.783182822376739*^9, 3.783182853542233*^9}, {
   3.783182889878277*^9, 3.783182934134598*^9}, {3.783182995421097*^9, 
   3.783183036649972*^9}, {3.783183069050721*^9, 3.783183191030245*^9}, {
   3.783183232775155*^9, 3.783183237420909*^9}, {3.78318339958671*^9, 
   3.7831834296081047`*^9}, {3.783183827440568*^9, 3.783183870661778*^9}, {
   3.7831858146833487`*^9, 3.783185820360832*^9}, {3.78318620357759*^9, 
   3.7831863955464983`*^9}, {3.7831864488989487`*^9, 3.783186585983418*^9}, {
   3.783186670150992*^9, 3.783186732816155*^9}, {3.783186772100696*^9, 
   3.7831867922121983`*^9}, {3.783186878850333*^9, 3.783186879920302*^9}, {
   3.7831870216135387`*^9, 3.783187032301166*^9}, {3.783187090181974*^9, 
   3.783187119805009*^9}, {3.783187195209736*^9, 3.783187211600642*^9}, {
   3.783187389227145*^9, 3.7831873956208487`*^9}, {3.7831874423488693`*^9, 
   3.7831874482836246`*^9}, {3.783187498147171*^9, 3.783187519594695*^9}, 
   3.783187549691279*^9, {3.7831875806594877`*^9, 3.7831875942107162`*^9}, 
   3.783187641746428*^9, {3.783187675529022*^9, 3.783187719981183*^9}, {
   3.78318775777507*^9, 3.783187777507882*^9}, {3.783195034318838*^9, 
   3.783195082369486*^9}, {3.783195129176243*^9, 3.783195130654354*^9}, 
   3.783195600430035*^9, {3.783195875568955*^9, 3.783195923116975*^9}, 
   3.7832404866326427`*^9, 3.783240537982945*^9, {3.783241766563958*^9, 
   3.783241770169858*^9}, {3.783242019589055*^9, 3.783242038913435*^9}, {
   3.783242224440885*^9, 3.783242232079968*^9}, {3.783242363414337*^9, 
   3.7832424064301023`*^9}, {3.783242440565166*^9, 3.7832424648026743`*^9}, {
   3.7832425068205843`*^9, 3.7832425069775333`*^9}, {3.7832428495568666`*^9, 
   3.7832428525702267`*^9}, {3.7833542866937017`*^9, 3.783354309444758*^9}, {
   3.783355614593163*^9, 3.783355640838348*^9}, {3.78335833421679*^9, 
   3.783358334758829*^9}, {3.783359693620332*^9, 3.783359721627674*^9}, {
   3.783361653056139*^9, 3.7833616572554417`*^9}, 3.783362194124464*^9, 
   3.78336223465842*^9, {3.783362393368207*^9, 3.78336245282276*^9}, {
   3.7833631602478237`*^9, 3.78336317317529*^9}, {3.783363636844595*^9, 
   3.783363674874811*^9}, {3.7834053675756693`*^9, 3.7834053792610207`*^9}, {
   3.78340583132686*^9, 3.783405831388301*^9}, {3.7834059187574177`*^9, 
   3.783405920434761*^9}, {3.783406753268241*^9, 3.783406758700287*^9}, {
   3.783408564127472*^9, 3.783408564196937*^9}, {3.783409214047086*^9, 
   3.783409220333387*^9}, {3.7834092529907017`*^9, 3.783409266756735*^9}, {
   3.783409308918028*^9, 3.783409328267762*^9}, {3.7834093770844517`*^9, 
   3.783409380945528*^9}, {3.783409474178068*^9, 3.783409480351221*^9}, {
   3.783409516417066*^9, 3.783409528518855*^9}, {3.7834095696870127`*^9, 
   3.783409575533265*^9}, {3.78341403995479*^9, 3.783414061688508*^9}, {
   3.783414179951048*^9, 3.783414199261772*^9}, {3.783415241625046*^9, 
   3.783415258198558*^9}, {3.783415294945393*^9, 3.783415333013176*^9}, {
   3.7834154590669413`*^9, 3.783415468578064*^9}, {3.7834155039130774`*^9, 
   3.783415527368451*^9}, {3.783418581398685*^9, 3.783418664800386*^9}, {
   3.783418723713091*^9, 3.7834187328069143`*^9}, {3.783419129079568*^9, 
   3.783419161050747*^9}, {3.783419483639987*^9, 3.783419490022593*^9}, 
   3.783419546414909*^9, {3.783419624037633*^9, 3.783419629859383*^9}, {
   3.783419691492093*^9, 3.78341970060884*^9}, {3.7834197798175917`*^9, 
   3.783419786526613*^9}, {3.7834198795754337`*^9, 3.783419888324492*^9}, {
   3.783419978237026*^9, 3.783419988274308*^9}, {3.783420066460009*^9, 
   3.783420075168106*^9}, {3.783420141537942*^9, 3.783420151366643*^9}, {
   3.783420438571474*^9, 3.783420446959621*^9}, {3.7834206705259237`*^9, 
   3.7834206829308367`*^9}, {3.7834207424382133`*^9, 3.783420750859206*^9}, {
   3.783421365767969*^9, 3.783421373597426*^9}, {3.783421965333004*^9, 
   3.783422006585594*^9}, {3.783422059923292*^9, 3.783422066422491*^9}, {
   3.783422880213716*^9, 3.783422887304878*^9}, {3.783423017795732*^9, 
   3.783423131788115*^9}, {3.783423170557499*^9, 3.7834231864683104`*^9}, {
   3.783423235235924*^9, 3.783423243065174*^9}, {3.7834232813629103`*^9, 
   3.78342328419268*^9}, {3.783423332465522*^9, 3.783423360958775*^9}, {
   3.7834235748693542`*^9, 3.783423585625668*^9}, {3.783423829774604*^9, 
   3.783423906795795*^9}, {3.7835949976169567`*^9, 3.783595000387117*^9}, {
   3.7835964592279263`*^9, 3.783596465811654*^9}, {3.783600610945345*^9, 
   3.7836006122709923`*^9}, {3.783600797137312*^9, 3.783600797760571*^9}, {
   3.7836009041833963`*^9, 3.7836009135655317`*^9}, {3.7836015781115103`*^9, 
   3.783601584526657*^9}, {3.783602323461935*^9, 3.783602331901326*^9}, {
   3.783602567824038*^9, 3.783602568007573*^9}, {3.7836026056154127`*^9, 
   3.783602606878813*^9}, {3.7836026943742332`*^9, 3.7836027045402813`*^9}, 
   3.783603676744483*^9, {3.7836048280155373`*^9, 3.7836048306712303`*^9}, {
   3.7836120126686773`*^9, 3.783612058163261*^9}, {3.7836294962427387`*^9, 
   3.7836294971450243`*^9}, {3.78367855699205*^9, 3.7836785579939947`*^9}, {
   3.783751914143035*^9, 3.783751917364276*^9}, {3.783752456130177*^9, 
   3.7837524597846203`*^9}, {3.783753178273793*^9, 3.783753232024022*^9}, {
   3.783761366904949*^9, 3.7837614049966393`*^9}, {3.783762226638749*^9, 
   3.7837622471563997`*^9}, 3.783762278390437*^9, {3.783762607811885*^9, 
   3.783762642173745*^9}, {3.7837627210564404`*^9, 3.783762723836267*^9}, {
   3.7837627643079977`*^9, 3.7837627663538103`*^9}, {3.78376300089753*^9, 
   3.783763029750209*^9}, 3.7837631167895403`*^9, {3.783766768067577*^9, 
   3.7837668049512367`*^9}, {3.78376695714963*^9, 3.783767014492795*^9}, {
   3.783767086923337*^9, 3.783767089664115*^9}, {3.783767156740288*^9, 
   3.783767218452998*^9}, 3.7837672577199917`*^9, 3.78376737697598*^9, {
   3.7837674952646513`*^9, 3.783767633994014*^9}, {3.7837676961523323`*^9, 
   3.783767700096168*^9}, {3.783768354186084*^9, 3.78376836807111*^9}, {
   3.7837685061291428`*^9, 3.7837685383131104`*^9}, {3.783768583505228*^9, 
   3.783768592440967*^9}, {3.783768656671399*^9, 3.783768659730729*^9}, {
   3.783769004845414*^9, 3.783769041874454*^9}, {3.783769082066485*^9, 
   3.7837691263582697`*^9}, {3.7837691578773613`*^9, 3.783769194706942*^9}, {
   3.783769244773*^9, 3.7837693116340923`*^9}, {3.783769378120384*^9, 
   3.7837693975069513`*^9}, {3.7837694287139883`*^9, 3.7837694316590853`*^9}, 
   3.783769462289791*^9, {3.783769511026675*^9, 3.7837695164456472`*^9}, {
   3.783769552251379*^9, 3.783769586155624*^9}, {3.783786861387738*^9, 
   3.783786871321435*^9}, {3.783787197957829*^9, 3.783787223225919*^9}, {
   3.7837872601933928`*^9, 3.7837872608809643`*^9}, {3.783787299674459*^9, 
   3.783787300224313*^9}, {3.783788877735794*^9, 3.7837888819900703`*^9}, {
   3.783789037918386*^9, 3.7837890457150793`*^9}, 3.7837891814017687`*^9, {
   3.783789836378255*^9, 3.783789846952216*^9}, {3.783790172246834*^9, 
   3.7837901876340103`*^9}, {3.783839057600107*^9, 3.783839063365744*^9}, {
   3.783839110887517*^9, 3.783839128574362*^9}, {3.783840111454967*^9, 
   3.783840145989664*^9}, {3.7838402114228907`*^9, 3.7838402115883293`*^9}, {
   3.783856824593422*^9, 3.783856824936243*^9}, {3.783885890028225*^9, 
   3.783885899531683*^9}, {3.78388639965694*^9, 3.783886424847077*^9}, {
   3.78388646471933*^9, 3.783886500022209*^9}, {3.783887115446066*^9, 
   3.7838871162491217`*^9}, {3.7869680323113327`*^9, 3.786968033813298*^9}, {
   3.807369324569687*^9, 3.807369334674325*^9}, {3.8073694455637693`*^9, 
   3.8073695042251997`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[611]:=",ExpressionUUID->"0502aef3-99ab-4176-9f64-f6e697b1f164"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ECD$LoadNecessaries", "[", "crystal_String", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "crystalData", ",", "atomData", ",", "crystalNotes", ",", "size", ",", 
      "latticeParameters"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"crystalData", "=", 
      RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomData", "=", 
      RowBox[{"N", "@", 
       RowBox[{"crystalData", "[", "\"\<AtomData\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"crystalNotes", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"crystalData", ",", "\"\<Notes\>\"", ",", 
        RowBox[{"<|", "|>"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AssociationQ", "@", "crystalNotes"}]}], ",", 
       RowBox[{"crystalNotes", "=", 
        RowBox[{"<|", "|>"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"size", "=", 
      RowBox[{
       RowBox[{"Lookup", "[", 
        RowBox[{
        "crystalNotes", ",", "\"\<StructureSize\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Round", "/@", 
          RowBox[{"Max", "/@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"atomData", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "\"\<FractionalCoordinates\>\""}], 
             "\[RightDoubleBracket]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], 
       "/.", 
       RowBox[{"{", 
        RowBox[{"0", "\[Rule]", "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"latticeParameters", "=", 
      RowBox[{"GetLatticeParameters", "[", 
       RowBox[{"crystal", ",", 
        RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "crystalData", ",", "atomData", ",", "size", ",", "latticeParameters"}],
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.760948481143589*^9, 3.760948499262701*^9}, {
   3.7609488207683067`*^9, 3.760948841778069*^9}, {3.760948882588552*^9, 
   3.760948883842764*^9}, {3.760948940717063*^9, 3.760948975282666*^9}, {
   3.760949011970159*^9, 3.760949012184416*^9}, 3.760949083736237*^9, {
   3.760949130238394*^9, 3.76094916161519*^9}, 3.760985557982565*^9, {
   3.7611975087352133`*^9, 3.76119751660457*^9}, {3.761474171084214*^9, 
   3.761474174768375*^9}, {3.761474414190099*^9, 3.761474436739811*^9}, {
   3.761474489155945*^9, 3.761474515473364*^9}, {3.761474549322021*^9, 
   3.761474603151936*^9}, {3.761474729429777*^9, 3.761474784036825*^9}, {
   3.761474849276947*^9, 3.7614748512846203`*^9}, 3.7614749412429934`*^9, {
   3.761475075055262*^9, 3.761475111589944*^9}, {3.761475177678194*^9, 
   3.761475208235873*^9}, {3.7614754099022007`*^9, 3.761475460275897*^9}, {
   3.7614755580354347`*^9, 3.7614755584485207`*^9}, {3.761475602255143*^9, 
   3.761475618458747*^9}, {3.761475728303033*^9, 3.7614757291959743`*^9}, {
   3.761475895540306*^9, 3.761475953150948*^9}, {3.7614759877525053`*^9, 
   3.7614760216772137`*^9}, {3.761476346852703*^9, 3.761476436475614*^9}, {
   3.761476501004677*^9, 3.7614765014024887`*^9}, {3.76147653684481*^9, 
   3.7614765625145817`*^9}, {3.7614766027780857`*^9, 3.761476696389943*^9}, {
   3.761476781958541*^9, 3.761476847138636*^9}, {3.761476879235957*^9, 
   3.761476898257463*^9}, {3.7614769388987217`*^9, 3.761476939672125*^9}, {
   3.7617280288811703`*^9, 3.7617280290289*^9}, {3.762062000358593*^9, 
   3.762062002890757*^9}, 3.7622515661086082`*^9, {3.762251817102137*^9, 
   3.762251929165433*^9}, {3.762252005452671*^9, 3.762252005611527*^9}, {
   3.762252046930657*^9, 3.7622520653518887`*^9}, {3.7622521337322073`*^9, 
   3.762252160781577*^9}, {3.762252243669989*^9, 3.762252252382333*^9}, {
   3.7622522870584927`*^9, 3.7622523110998173`*^9}, {3.7622525892905617`*^9, 
   3.762252653190784*^9}, {3.762252687617072*^9, 3.76225268868604*^9}, 
   3.762252720098925*^9, {3.7622602134972677`*^9, 3.762260245781844*^9}, {
   3.7622603606728363`*^9, 3.7622603955795927`*^9}, 3.762260809124468*^9, {
   3.762260920835347*^9, 3.7622609336590014`*^9}, {3.7622611020859957`*^9, 
   3.7622611022128*^9}, {3.762265433988163*^9, 3.762265647951427*^9}, {
   3.762265682974736*^9, 3.762265714676045*^9}, {3.7622657998190107`*^9, 
   3.762265823490719*^9}, {3.762266150777772*^9, 3.762266183714326*^9}, {
   3.762266297442079*^9, 3.762266404084507*^9}, {3.762266503346043*^9, 
   3.7622665058192873`*^9}, {3.762266581522806*^9, 3.762266603588318*^9}, {
   3.762266694495263*^9, 3.762266728238165*^9}, {3.762266789430751*^9, 
   3.76226681293922*^9}, {3.7622668497813883`*^9, 3.762266850066354*^9}, {
   3.762267098742383*^9, 3.762267102028309*^9}, {3.762267643315309*^9, 
   3.7622677082670116`*^9}, {3.762267743017583*^9, 3.762267788543005*^9}, {
   3.7622678343978357`*^9, 3.762267872315877*^9}, {3.762267908117887*^9, 
   3.762267928051405*^9}, 3.762267973773315*^9, {3.762268017780451*^9, 
   3.7622680575155687`*^9}, 3.762793093215591*^9, {3.763796995475988*^9, 
   3.7637970043599586`*^9}, {3.7643154838421183`*^9, 3.764315495506998*^9}, {
   3.764945527167924*^9, 3.764945538174453*^9}, {3.767432814398486*^9, 
   3.767432819483389*^9}, {3.7674328754926987`*^9, 3.767432894311245*^9}, {
   3.7674334785881023`*^9, 3.76743347876075*^9}, {3.783069231678774*^9, 
   3.783069266967184*^9}, 3.7830693020753717`*^9, 3.7830876846213007`*^9, {
   3.783601557168208*^9, 3.78360156744668*^9}, {3.7836022865660763`*^9, 
   3.783602306060294*^9}, {3.783602507800161*^9, 3.783602521215067*^9}, {
   3.7836025595507593`*^9, 3.783602559800055*^9}, {3.783604816433077*^9, 
   3.783604819534629*^9}, {3.783749852081997*^9, 3.7837498583161583`*^9}, {
   3.783839612368231*^9, 3.783839619375147*^9}, {3.7838397408860607`*^9, 
   3.783839742547872*^9}, 3.7838399432332*^9, {3.78383997716043*^9, 
   3.783839994134857*^9}, {3.783840038479353*^9, 3.7838400808994637`*^9}, {
   3.783841286096673*^9, 3.783841286359161*^9}, {3.7869680370032673`*^9, 
   3.7869680380252666`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[612]:=",ExpressionUUID->"5eff56b2-6e4a-495c-9b9c-28771d7f6b2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExportCrystalData", "[", 
   RowBox[{"invalidProgram_String", ",", "rest___"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<DISCUS\>\"", ",", "\"\<DIFFUSE\>\""}], "}"}], ",", 
         "invalidProgram"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"ExportCrystalData", "::", "InvalidProgramOrFormat"}], ",", 
        "invalidProgram"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Message", "[", 
       RowBox[{"ExportCrystalData", "::", "ParameterError"}], "]"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.760948481143589*^9, 3.760948499262701*^9}, {
   3.7609488207683067`*^9, 3.760948841778069*^9}, {3.760948882588552*^9, 
   3.760948883842764*^9}, {3.760948940717063*^9, 3.760948975282666*^9}, {
   3.760949011970159*^9, 3.760949012184416*^9}, 3.760949083736237*^9, {
   3.760949130238394*^9, 3.76094916161519*^9}, 3.760985557982565*^9, {
   3.7611975087352133`*^9, 3.76119751660457*^9}, {3.761474171084214*^9, 
   3.761474174768375*^9}, {3.761474414190099*^9, 3.761474436739811*^9}, {
   3.761474489155945*^9, 3.761474515473364*^9}, {3.761474549322021*^9, 
   3.761474603151936*^9}, {3.761474729429777*^9, 3.761474784036825*^9}, {
   3.761474849276947*^9, 3.7614748512846203`*^9}, 3.7614749412429934`*^9, {
   3.761475075055262*^9, 3.761475111589944*^9}, {3.761475177678194*^9, 
   3.761475208235873*^9}, {3.7614754099022007`*^9, 3.761475460275897*^9}, {
   3.7614755580354347`*^9, 3.7614755584485207`*^9}, {3.761475602255143*^9, 
   3.761475618458747*^9}, {3.761475728303033*^9, 3.7614757291959743`*^9}, {
   3.761475895540306*^9, 3.761475953150948*^9}, {3.7614759877525053`*^9, 
   3.7614760216772137`*^9}, {3.761476346852703*^9, 3.761476436475614*^9}, {
   3.761476501004677*^9, 3.7614765014024887`*^9}, {3.76147653684481*^9, 
   3.7614765625145817`*^9}, {3.7614766027780857`*^9, 3.761476696389943*^9}, {
   3.761476781958541*^9, 3.761476847138636*^9}, {3.761476879235957*^9, 
   3.761476898257463*^9}, {3.7614769388987217`*^9, 3.761476939672125*^9}, {
   3.7617280288811703`*^9, 3.7617280290289*^9}, {3.762062000358593*^9, 
   3.762062002890757*^9}, 3.7622515661086082`*^9, {3.762251817102137*^9, 
   3.762251929165433*^9}, {3.762252005452671*^9, 3.762252005611527*^9}, {
   3.762252046930657*^9, 3.7622520653518887`*^9}, {3.7622521337322073`*^9, 
   3.762252160781577*^9}, {3.762252243669989*^9, 3.762252252382333*^9}, {
   3.7622522870584927`*^9, 3.7622523110998173`*^9}, {3.7622525892905617`*^9, 
   3.762252653190784*^9}, {3.762252687617072*^9, 3.76225268868604*^9}, 
   3.762252720098925*^9, {3.7622602134972677`*^9, 3.762260245781844*^9}, {
   3.7622603606728363`*^9, 3.7622603955795927`*^9}, 3.762260809124468*^9, {
   3.762260920835347*^9, 3.7622609336590014`*^9}, {3.7622611020859957`*^9, 
   3.7622611022128*^9}, {3.762265433988163*^9, 3.762265647951427*^9}, {
   3.762265682974736*^9, 3.762265714676045*^9}, {3.7622657998190107`*^9, 
   3.762265823490719*^9}, {3.762266150777772*^9, 3.762266183714326*^9}, {
   3.762266297442079*^9, 3.762266404084507*^9}, {3.762266503346043*^9, 
   3.7622665058192873`*^9}, {3.762266581522806*^9, 3.762266603588318*^9}, {
   3.762266694495263*^9, 3.762266728238165*^9}, {3.762266789430751*^9, 
   3.76226681293922*^9}, {3.7622668497813883`*^9, 3.762266850066354*^9}, {
   3.762267098742383*^9, 3.762267102028309*^9}, {3.762267643315309*^9, 
   3.7622677082670116`*^9}, {3.762267743017583*^9, 3.762267788543005*^9}, {
   3.7622678343978357`*^9, 3.762267872315877*^9}, {3.762267908117887*^9, 
   3.762267928051405*^9}, 3.762267973773315*^9, {3.762268017780451*^9, 
   3.7622680575155687`*^9}, 3.762793093215591*^9, {3.763796995475988*^9, 
   3.7637970043599586`*^9}, {3.7643154838421183`*^9, 3.764315495506998*^9}, {
   3.764945527167924*^9, 3.764945538174453*^9}, {3.767432814398486*^9, 
   3.767432819483389*^9}, {3.7674328754926987`*^9, 3.767432894311245*^9}, {
   3.7674334785881023`*^9, 3.76743347876075*^9}, {3.783069231678774*^9, 
   3.783069266967184*^9}, 3.7830693020753717`*^9, 3.7830876846213007`*^9, {
   3.783601557168208*^9, 3.78360156744668*^9}, {3.7836022865660763`*^9, 
   3.783602306060294*^9}, {3.783602507800161*^9, 3.783602521215067*^9}, {
   3.7836025595507593`*^9, 3.783602559800055*^9}, {3.783604816433077*^9, 
   3.783604819534629*^9}, {3.783749852081997*^9, 3.7837498583161583`*^9}, {
   3.783839612368231*^9, 3.783839619375147*^9}, {3.7838397408860607`*^9, 
   3.783839742547872*^9}, 3.7838399432332*^9, {3.78383997716043*^9, 
   3.783839994134857*^9}, {3.783840038479353*^9, 3.783840055934451*^9}, {
   3.7856866354927807`*^9, 3.785686770095469*^9}, {3.785686913801567*^9, 
   3.7856869257325363`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[613]:=",ExpressionUUID->"ec65ff9d-dcc3-4c62-8fcd-ffe5e2dc8b23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[614]:=",ExpressionUUID->"263cc96a-cdbd-41b2-b127-3422100f2606"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtinctionLength", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.715064144253417*^9, 3.71506414748868*^9}, 
   3.7150666427337*^9, 3.728770283393445*^9, 
   3.730386833829701*^9},ExpressionUUID->"064698d7-07ee-4271-a0fb-\
5fe392638921"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[615]:=",ExpressionUUID->"0535ff75-a812-46ee-9080-8106546d401b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ExtinctionLength"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "\"\<\[Pi]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ExtinctionLength"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_.", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, 
   3.715064183906497*^9, {3.715064323351753*^9, 3.715064331811014*^9}, {
   3.717137410052381*^9, 3.717137423793882*^9}, {3.7171375187693367`*^9, 
   3.7171375311190987`*^9}, {3.7171379767179403`*^9, 
   3.7171379940600653`*^9}, {3.71713832618981*^9, 3.7171383388679*^9}, {
   3.71907160441745*^9, 3.719071610599937*^9}, {3.726561450330326*^9, 
   3.72656145245828*^9}, {3.728765825984562*^9, 3.728765826319784*^9}, 
   3.728770283404731*^9, {3.756710835044408*^9, 3.7567108480185957`*^9}},
 CellLabel->
  "In[616]:=",ExpressionUUID->"61475c29-6689-4673-9c6a-46c789db1be2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[618]:=",ExpressionUUID->"5fc9123d-2dc6-493b-bb3e-c3f12a741bcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtinctionLength", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "hklInput_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]o", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]h", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "sg", ",", "hkl", ",", "L", ",", "\[IndentingNewLine]", "\[Lambda]", ",",
       "V", ",", "\[Theta]", ",", "R", ",", "C", ",", "FhFhbar", ",", "g", 
      ",", "\[CapitalLambda]o", ",", "\[IndentingNewLine]", "temp"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"crystal", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "hklInput", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "hkl"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Wavelength", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<ProcessWavelength\>\"", ",", "crystal", ",", "lambda"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Unit", " ", "cell", " ", "volume"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Classical", " ", "electron", " ", "radius"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"QuantityMagnitude", "@", 
         RowBox[{"UnitConvert", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Quantity", "[", "\"\<ClassicalElectronRadius\>\"", "]"}], 
           ",", "\"\<Angstroms\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"2.81794032", "*", 
         RowBox[{"Power", "[", 
          RowBox[{"10", ",", 
           RowBox[{"-", "5"}]}], "]"}]}]}], 
       RowBox[{"(*", " ", "\[ARing]ngstr\[ODoubleDot]ms", " ", "*)"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Bragg", " ", "angle", " ", "and", " ", "polarisation"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{
       RowBox[{"BraggAngle", "[", 
        RowBox[{"crystal", ",", "\[Lambda]", ",", "hkl", ",", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}], "*", 
       "Degree"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"C", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<Polarisation\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{"OptionValue", "[", "\"\<Polarisation\>\"", "]"}], ",", 
          RowBox[{"2", "\[Theta]"}]}], "]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Structure", " ", "factors"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StructureFactor", "[", 
         RowBox[{"crystal", ",", "#", ",", "\[Lambda]", ",", 
          RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"hkl", ",", 
         RowBox[{"-", "hkl"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"temp", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F_", "?", "NumericQ"}], ",", 
           RowBox[{"\[Phi]_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
         "F"}], ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FhFhbar", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"temp", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "L"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Message", " ", "about", " ", "extinction"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "FhFhbar", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"StructureFactor", "::", "extinct"}], ",", 
           RowBox[{
           "hkl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",",
            "sg"}], "]"}]}], "\[IndentingNewLine]", "\t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "L"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extinction", " ", 
       RowBox[{"(", "Pendell\[ODoubleDot]sung", ")"}], " ", "distance"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Gamma]o", "===", "\[Gamma]h", "===", "1"}], ",", 
       RowBox[{"g", "=", "1"}], ",", 
       RowBox[{"g", "=", 
        RowBox[{"\[Pi]", "*", 
         SqrtBox[
          RowBox[{"\[Gamma]o", "*", 
           RowBox[{"Abs", "[", "\[Gamma]h", "]"}]}]]}]}]}], "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"geometrical", " ", "factor"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Quiet", "@", 
           RowBox[{"Sow", "[", "\[IndentingNewLine]", 
            RowBox[{
             FractionBox[
              RowBox[{"V", " ", "*", "g"}], 
              RowBox[{"R", "*", "\[Lambda]", "*", 
               RowBox[{
               "C", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "*", 
               RowBox[{"Sqrt", "@", 
                RowBox[{
                "FhFhbar", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}]], "*", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"1", " ", 
                RowBox[{"(*", " ", "\[Mu]m", " ", "*)"}]}], 
               RowBox[{
                SuperscriptBox["10", "4"], " ", 
                RowBox[{"(*", " ", "\[CapitalARing]", " ", "*)"}]}]], ")"}]}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{"\[CapitalLambda]o", "/.", 
       RowBox[{"ComplexInfinity", "\[Rule]", "Undefined"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]o", "=", 
        RowBox[{"\[CapitalLambda]o", "/.", 
         RowBox[{
          RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
          RowBox[{"Quantity", "[", 
           RowBox[{"x", ",", "\"\<Micrometers\>\""}], "]"}]}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"L", "===", "1"}], ",", 
       RowBox[{"First", "@", "\[CapitalLambda]o"}], ",", 
       "\[CapitalLambda]o"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.7150641849014177`*^9, 
   3.715064208336918*^9}, {3.715064336668919*^9, 3.715064336823771*^9}, {
   3.7150644336583357`*^9, 3.71506443498072*^9}, {3.715064599313464*^9, 
   3.7150646079814262`*^9}, {3.7150648325136347`*^9, 3.715064858683421*^9}, {
   3.715064959383336*^9, 3.71506497243955*^9}, {3.715065015991144*^9, 
   3.7150650391032743`*^9}, 3.7150652844595957`*^9, {3.7150653189201393`*^9, 
   3.715065425962084*^9}, {3.715065469844347*^9, 3.7150655302803*^9}, {
   3.7150655873892384`*^9, 3.715065652967656*^9}, {3.715065689624295*^9, 
   3.7150656959385242`*^9}, {3.715065775044579*^9, 3.7150657795680733`*^9}, {
   3.715065865470538*^9, 3.7150658691411257`*^9}, {3.715066032083479*^9, 
   3.7150662475735207`*^9}, {3.71506629896938*^9, 3.715066312996698*^9}, {
   3.71506637443011*^9, 3.715066441209529*^9}, 3.715067144046503*^9, 
   3.715327875529291*^9, {3.717137869706513*^9, 3.71713797227919*^9}, 
   3.7171380204468603`*^9, {3.717138085667194*^9, 3.717138099861533*^9}, {
   3.717138257794202*^9, 3.717138300046898*^9}, {3.717740904476035*^9, 
   3.717740920625993*^9}, {3.719071295169293*^9, 3.719071306145207*^9}, {
   3.7190713453679743`*^9, 3.7190713498706007`*^9}, {3.719071570331616*^9, 
   3.719071600316853*^9}, {3.719071682617531*^9, 3.719071716415783*^9}, 
   3.726561454928636*^9, 3.727675294974962*^9, 3.727676784058449*^9, {
   3.728625084281598*^9, 3.7286250868079367`*^9}, {3.7287655420810003`*^9, 
   3.72876556364753*^9}, 3.728765689062871*^9, {3.7287659418637114`*^9, 
   3.728765973270775*^9}, {3.7287702834174*^9, 3.728770283426715*^9}, {
   3.7295875960614223`*^9, 3.7295876066718073`*^9}, {3.7295880419212914`*^9, 
   3.729588045870008*^9}, 3.729588317886677*^9, {3.730016054914228*^9, 
   3.73001609916604*^9}, {3.7300162031051483`*^9, 3.7300162210708637`*^9}, {
   3.730016402805884*^9, 3.730016434946889*^9}, {3.7300169223225613`*^9, 
   3.730016931871814*^9}, {3.730016980487012*^9, 3.730016988414926*^9}, {
   3.730017058262102*^9, 3.73001713016367*^9}, {3.730017389367407*^9, 
   3.730017393031343*^9}, {3.730017910923271*^9, 3.730017911905787*^9}, {
   3.7300179421231947`*^9, 3.730017942425879*^9}, {3.730053508967078*^9, 
   3.7300535115130463`*^9}, {3.730053588041451*^9, 3.7300536135897427`*^9}, {
   3.730053685134899*^9, 3.730053747427683*^9}, {3.7303807975703983`*^9, 
   3.73038082949577*^9}, {3.7303808808461246`*^9, 3.730380883510571*^9}, {
   3.730382682670476*^9, 3.730382722798382*^9}, {3.730382907061781*^9, 
   3.730382914851068*^9}, {3.730382972130056*^9, 3.7303829955933104`*^9}, {
   3.7303868622474203`*^9, 3.730386862802196*^9}, 3.730386912351308*^9, {
   3.7303872993762083`*^9, 3.7303873037725277`*^9}, {3.730388758219499*^9, 
   3.7303887933365726`*^9}, {3.7303890223980083`*^9, 3.730389028347728*^9}, {
   3.7303891190410757`*^9, 3.730389120834405*^9}, {3.730389164680416*^9, 
   3.730389217974998*^9}, {3.730389325933663*^9, 3.7303893344932623`*^9}, {
   3.730389642846589*^9, 3.730389655727233*^9}, {3.730389688718611*^9, 
   3.730389705765634*^9}, {3.73038984820268*^9, 3.73038984832907*^9}, {
   3.730389887448902*^9, 3.7303899156151333`*^9}, 3.730389960327202*^9, {
   3.7303900446145487`*^9, 3.73039005030311*^9}, {3.7303900846210203`*^9, 
   3.7303901525709753`*^9}, {3.730390218609873*^9, 3.730390291473195*^9}, {
   3.730390334190436*^9, 3.730390535722308*^9}, {3.7303905678253393`*^9, 
   3.7303905815937366`*^9}, {3.730390637143609*^9, 3.730390642919252*^9}, {
   3.730390688143659*^9, 3.7303906887496223`*^9}, {3.7303907485088778`*^9, 
   3.730390781341004*^9}, {3.7303908537158613`*^9, 3.730390889281506*^9}, {
   3.730390963086314*^9, 3.7303910164482117`*^9}, {3.730392295188819*^9, 
   3.7303923353288403`*^9}, {3.730392372387158*^9, 3.730392380323042*^9}, {
   3.730392429994944*^9, 3.73039254936828*^9}, {3.7303925800948*^9, 
   3.7303926065978394`*^9}, {3.730392641925551*^9, 3.730392715523513*^9}, {
   3.730396806995736*^9, 3.730396938711412*^9}, {3.730397029158411*^9, 
   3.730397057216755*^9}, {3.730397227802558*^9, 3.730397239752108*^9}, {
   3.730544224646261*^9, 3.730544224758662*^9}, 3.737968467860733*^9, {
   3.739170328108973*^9, 3.7391703389556093`*^9}, {3.7585292324233837`*^9, 
   3.758529259814826*^9}, {3.759519321072632*^9, 3.759519322814753*^9}, 
   3.7627930932348967`*^9, {3.786968042941324*^9, 3.786968044515555*^9}, {
   3.786968249405877*^9, 3.786968310108507*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[619]:=",ExpressionUUID->"fdc9d81f-59dc-4973-9d53-1e4a7e533f55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[620]:=",ExpressionUUID->"2922f8f5-f28e-4855-93c0-a2013bea323b"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindPixelClusters", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.6678188399987793`*^9, 3.667818878319042*^9}, 
   3.667973368548716*^9},ExpressionUUID->"d69b5591-dd13-4ce5-9222-\
6adec15759cd"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[3]:=",ExpressionUUID->"b8ee57d8-6851-497e-8cbb-118c83b20113"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindPixelClusters", "::", "method"}], "=", 
   "\"\<The method \[LeftGuillemet]`1`\[RightGuillemet] was not recognised.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindPixelClusters", "::", "pixels"}], "=", 
   "\"\<Pixels in the binarised image: `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindPixelClusters", "::", "dir"}], "=", 
    "\"\<Invalid directory.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "FindPixelClusters"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ClusterRange\>\"", "\[Rule]", "3"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ClearStatus\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Method", "\[Rule]", "\"\<Median\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PixelDataFile\>\"", "\[Rule]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$TemporaryDirectory", ",", "\"\<MaXrd\>\"", ",", 
         "\"\<PixelData.m\>\""}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"\"\<RetrieveData\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnBinaryImage\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<UpdateDataFile\>\"", "\[Rule]", "True"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.667926883433126*^9, 3.667926892913142*^9}, {
   3.6679303915678787`*^9, 3.667930397064508*^9}, {3.667930504515873*^9, 
   3.6679305119877663`*^9}, {3.667930552979792*^9, 3.6679305587145452`*^9}, {
   3.6679305964269743`*^9, 3.667930598585484*^9}, {3.66793271531362*^9, 
   3.667932721040504*^9}, {3.667972261358046*^9, 3.6679722648457327`*^9}, {
   3.6679723098927813`*^9, 3.667972310700526*^9}, {3.667973385739415*^9, 
   3.667973388827128*^9}, {3.667977543043991*^9, 3.667977558082513*^9}, {
   3.667995016616452*^9, 3.667995022446369*^9}, {3.6679950722772903`*^9, 
   3.6679950740452623`*^9}, {3.6679957762713337`*^9, 3.667995776453274*^9}, {
   3.667996475790578*^9, 3.6679964973333187`*^9}, {3.668230520096628*^9, 
   3.668230520296247*^9}, {3.668231248823513*^9, 3.668231266470131*^9}, {
   3.668231934350088*^9, 3.6682319425497923`*^9}, {3.6682320393165903`*^9, 
   3.668232046291453*^9}, {3.668232248143578*^9, 3.668232275009239*^9}, {
   3.6682338783511744`*^9, 3.668233902814499*^9}, {3.6682341617838697`*^9, 
   3.66823416263997*^9}, 3.668234334356662*^9, {3.668234369772044*^9, 
   3.6682343712508717`*^9}, {3.668234441121419*^9, 3.668234442249284*^9}, {
   3.668234474145546*^9, 3.668234476228924*^9}, {3.668234888878497*^9, 
   3.668234889678135*^9}, {3.668234943421139*^9, 3.6682349550848227`*^9}, {
   3.6682352736460247`*^9, 3.66823528523668*^9}, {3.668235379331465*^9, 
   3.668235382934746*^9}, {3.6682354313782387`*^9, 3.6682354331850758`*^9}, {
   3.68751217918044*^9, 3.687512181304822*^9}, 3.7138583598504868`*^9, {
   3.714207623856532*^9, 3.7142076294786367`*^9}, {3.7142085710706787`*^9, 
   3.7142085726870623`*^9}, {3.824549415607658*^9, 3.824549449868452*^9}, {
   3.824549692777103*^9, 3.8245497188627357`*^9}, {3.824549834932473*^9, 
   3.8245498504033012`*^9}, {3.8245500716598988`*^9, 3.824550077150653*^9}, {
   3.824550187318911*^9, 3.824550202311926*^9}, {3.824550542168377*^9, 
   3.8245505440933247`*^9}, {3.824550875643718*^9, 3.8245508795590973`*^9}, {
   3.8246242446635027`*^9, 3.824624253471257*^9}, {3.824624286567259*^9, 
   3.824624286867517*^9}, {3.824624791458826*^9, 3.8246247971838093`*^9}, {
   3.824624985774453*^9, 3.824624986847002*^9}, {3.8246262066743*^9, 
   3.824626207100642*^9}, 3.824836304974125*^9, {3.824836400750367*^9, 
   3.824836405742276*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"1be478aa-d26a-46dd-b092-2a2a7c168a73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[8]:=",ExpressionUUID->"758c0ae7-002b-47eb-a0e6-93d136d7a167"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FPC$LoadPixelDataFile", "[", "dataFile_String", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "dataFile"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"CreateDirectory", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DirectoryName", "@", "dataFile"}], ",", 
           RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{"dataFile", ",", 
            RowBox[{"<|", "|>"}]}], "]"}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Import", "@", "dataFile"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667819015852723*^9, {3.667926743191167*^9, 
   3.667926756485921*^9}, {3.6679268065659847`*^9, 3.6679268096604767`*^9}, {
   3.667926962553701*^9, 3.6679269943921003`*^9}, 3.6679277909347057`*^9, {
   3.6679278215421352`*^9, 3.6679278447888317`*^9}, {3.667927921354144*^9, 
   3.66792792396218*^9}, {3.667927998418087*^9, 3.667927998617405*^9}, {
   3.6679280547365437`*^9, 3.667928057183651*^9}, {3.667928585451659*^9, 
   3.667928696849235*^9}, {3.667930404905075*^9, 3.6679304216077147`*^9}, {
   3.6679304533630323`*^9, 3.667930454063971*^9}, {3.6679310019224863`*^9, 
   3.667931184397665*^9}, {3.667931227245723*^9, 3.667931371281341*^9}, {
   3.667931420882256*^9, 3.667931517142481*^9}, 3.667931552079372*^9, {
   3.667931592230816*^9, 3.6679315953351383`*^9}, {3.66793164158883*^9, 
   3.667931735041656*^9}, {3.667931797945294*^9, 3.667931835823868*^9}, {
   3.667931870240131*^9, 3.667931910901052*^9}, {3.6679320411065617`*^9, 
   3.667932042282494*^9}, {3.6679321631039057`*^9, 3.667932185255023*^9}, {
   3.6679322367038527`*^9, 3.6679322536777477`*^9}, 3.667939889308084*^9, {
   3.667969769378148*^9, 3.667969771378113*^9}, 3.667970090993989*^9, {
   3.667973390326392*^9, 3.6679733948223467`*^9}, {3.667976913750659*^9, 
   3.667976916404254*^9}, {3.6679769619491863`*^9, 3.667976962373781*^9}, 
   3.66797708246696*^9, 3.667977633341072*^9, {3.667977678626876*^9, 
   3.667977952564095*^9}, {3.667982385812993*^9, 3.6679823891230717`*^9}, {
   3.667982552768587*^9, 3.6679825768232183`*^9}, {3.667982617631548*^9, 
   3.667982618230095*^9}, 3.667982783740485*^9, 3.667982978648044*^9, {
   3.667987233443955*^9, 3.6679872350670633`*^9}, 3.667987319881976*^9, {
   3.667995025393314*^9, 3.667995077673361*^9}, {3.667995795417122*^9, 
   3.6679958330065393`*^9}, 3.66799604865274*^9, {3.667996211983923*^9, 
   3.667996238685172*^9}, {3.667996325731824*^9, 3.6679963500750713`*^9}, 
   3.6679964246118183`*^9, {3.6679964925539827`*^9, 3.6679965140880003`*^9}, {
   3.6679966308453293`*^9, 3.667996631124778*^9}, {3.667996667541781*^9, 
   3.667996679667149*^9}, {3.6682298967733393`*^9, 3.668230154667777*^9}, {
   3.6682302282495613`*^9, 3.668230337862431*^9}, {3.66823037439754*^9, 
   3.6682304210040913`*^9}, {3.668230470966654*^9, 3.668230509026909*^9}, {
   3.6682305945216846`*^9, 3.668230608294874*^9}, {3.668230649418269*^9, 
   3.6682306552087507`*^9}, {3.668230777855473*^9, 3.668230779342372*^9}, {
   3.668230827027471*^9, 3.668230869589425*^9}, {3.6682309020436172`*^9, 
   3.6682309032099752`*^9}, {3.668230964088015*^9, 3.6682309837305403`*^9}, {
   3.668231043206236*^9, 3.668231198625996*^9}, {3.6682312793778677`*^9, 
   3.668231309239684*^9}, {3.668231360770649*^9, 3.668231478579686*^9}, {
   3.6682315182903957`*^9, 3.6682316606075783`*^9}, {3.668231853738429*^9, 
   3.6682319097544107`*^9}, 3.6682320481299458`*^9, {3.66823231198499*^9, 
   3.668232340966546*^9}, {3.668232413221817*^9, 3.6682324555084667`*^9}, {
   3.668232593908114*^9, 3.6682326569589863`*^9}, {3.668232694967547*^9, 
   3.6682327934677343`*^9}, {3.668233168339756*^9, 3.668233211018368*^9}, {
   3.668233911929123*^9, 3.668233912673284*^9}, {3.668234165475075*^9, 
   3.668234166434887*^9}, 3.668234335726321*^9, {3.668234375925832*^9, 
   3.668234383685205*^9}, {3.6682344192284307`*^9, 3.668234420445109*^9}, {
   3.6682344814285107`*^9, 3.668234482946336*^9}, {3.668234565665369*^9, 
   3.6682345756405*^9}, {3.668234658311418*^9, 3.668234660936935*^9}, {
   3.668234729151449*^9, 3.668234734437337*^9}, {3.668234775292177*^9, 
   3.668234776492208*^9}, {3.6682348149806547`*^9, 3.6682348872015553`*^9}, {
   3.668234957471792*^9, 3.668234962599025*^9}, {3.66823500756784*^9, 
   3.668235010638788*^9}, {3.668235386702396*^9, 3.6682353879562407`*^9}, {
   3.668235436429007*^9, 3.668235463195363*^9}, {3.668235513409904*^9, 
   3.668235551480637*^9}, 3.668235614055798*^9, {3.668235690567173*^9, 
   3.668235719044767*^9}, {3.6695562972398148`*^9, 3.669556297373962*^9}, {
   3.687512196806978*^9, 3.6875121973395967`*^9}, {3.713802902597312*^9, 
   3.713802915932815*^9}, {3.713803320942219*^9, 3.713803345450964*^9}, {
   3.7138034257374067`*^9, 3.713803460759953*^9}, 3.713803519649189*^9, {
   3.713803604382509*^9, 3.713803680578794*^9}, {3.7138037681305428`*^9, 
   3.713803775505362*^9}, {3.713803860977088*^9, 3.713803917581181*^9}, {
   3.713803974310575*^9, 3.713803976182168*^9}, 3.7138040436679573`*^9, {
   3.7138063486627274`*^9, 3.713806350942552*^9}, {3.713807462694106*^9, 
   3.713807489203656*^9}, {3.7138075517857037`*^9, 3.713807559617502*^9}, {
   3.713807618953618*^9, 3.713807903852294*^9}, {3.713808001585246*^9, 
   3.7138080016781054`*^9}, 3.71380855458074*^9, {3.71380863487689*^9, 
   3.7138087192939777`*^9}, {3.713808846860177*^9, 3.713808857421461*^9}, {
   3.713808897778977*^9, 3.713808912465152*^9}, {3.713808955217936*^9, 
   3.7138089628015137`*^9}, {3.713808995906348*^9, 3.713809022295484*^9}, {
   3.713809073335235*^9, 3.713809100565136*^9}, {3.713809177854271*^9, 
   3.7138093132746353`*^9}, {3.7138093441213913`*^9, 
   3.7138093456793613`*^9}, {3.713809453317717*^9, 3.713809513685094*^9}, {
   3.7138095931785507`*^9, 3.713809626242549*^9}, {3.713809658033081*^9, 
   3.713809664135953*^9}, 3.713809740064288*^9, {3.713809808472837*^9, 
   3.7138099121534863`*^9}, {3.713844685073086*^9, 3.7138446872542553`*^9}, {
   3.71384588184228*^9, 3.7138458833230133`*^9}, {3.713846292992717*^9, 
   3.713846349611416*^9}, 3.713846695574162*^9, {3.7138467278378*^9, 
   3.713846731171411*^9}, {3.713846806808646*^9, 3.713846913776025*^9}, {
   3.7138469529141293`*^9, 3.713846953470827*^9}, {3.713847032551959*^9, 
   3.7138470334900837`*^9}, {3.713847168612919*^9, 3.713847198830091*^9}, {
   3.713847280190546*^9, 3.713847327524582*^9}, {3.713847407284361*^9, 
   3.713847407599958*^9}, {3.7138474475624743`*^9, 3.713847471334959*^9}, {
   3.713847502755796*^9, 3.713847510323131*^9}, {3.7138476002010098`*^9, 
   3.713847681785532*^9}, {3.7138477189303513`*^9, 3.713847720783132*^9}, {
   3.713848047572956*^9, 3.713848050312454*^9}, {3.713848196591464*^9, 
   3.713848212251227*^9}, {3.713848276669099*^9, 3.713848283663631*^9}, {
   3.713855305653678*^9, 3.713855338332179*^9}, {3.713855626443754*^9, 
   3.713855628890686*^9}, 3.713855941830909*^9, {3.713856433219384*^9, 
   3.713856437634218*^9}, {3.713862011147923*^9, 3.713862014225955*^9}, {
   3.713865700953743*^9, 3.7138657011938753`*^9}, {3.824549157884141*^9, 
   3.824549159319586*^9}, {3.8245492253561296`*^9, 3.824549247629485*^9}, 
   3.8245493292632647`*^9, {3.824549386072567*^9, 3.824549410357386*^9}, {
   3.824549474902042*^9, 3.824549512116287*^9}, {3.824549598827116*^9, 
   3.8245496604630527`*^9}, {3.824549706380138*^9, 3.8245497609777327`*^9}, {
   3.824549844913988*^9, 3.824549846763631*^9}, {3.8245498794471292`*^9, 
   3.824549881428441*^9}, {3.824549979839823*^9, 3.8245499800738077`*^9}, 
   3.824550016309486*^9, {3.824550263587179*^9, 3.824550273676351*^9}, {
   3.824550356454542*^9, 3.824550397848559*^9}, 3.8245505155203037`*^9, {
   3.82455056653398*^9, 3.8245506401875257`*^9}, {3.824550689620389*^9, 
   3.824550805106915*^9}, {3.824550840692254*^9, 3.8245508686236134`*^9}, {
   3.8245509105415916`*^9, 3.824550941488265*^9}, {3.824550999983103*^9, 
   3.824551000135416*^9}, {3.824551191065404*^9, 3.824551310428009*^9}, {
   3.824551371207891*^9, 3.824551387084132*^9}, {3.82455163461265*^9, 
   3.824551641709669*^9}, {3.824551676989612*^9, 3.8245516908209543`*^9}, {
   3.824551744320958*^9, 3.8245517988387537`*^9}, {3.8245518437147007`*^9, 
   3.824551878676241*^9}, {3.824552093824395*^9, 3.824552094964884*^9}, {
   3.824613355161584*^9, 3.82461335891087*^9}, {3.8246134068736477`*^9, 
   3.824613526703142*^9}, {3.824613697948286*^9, 3.824613729276009*^9}, {
   3.82461691671942*^9, 3.8246169170846767`*^9}, {3.828939188712387*^9, 
   3.828939190369705*^9}, 3.828940292571979*^9},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"d3789866-1f12-44e7-b3c8-386355b1b418"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FPC$MakeImageHash", "[", "image_Image", "]"}], ":=", 
   RowBox[{"Hash", "[", 
    RowBox[{"image", ",", "\"\<Expression\>\"", ",", "\"\<HexString\>\""}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.824617695426052*^9, 3.8246177365094843`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[10]:=",ExpressionUUID->"6653b959-0d3d-4b5b-8ac2-a0c8cde07b00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FPC$LookupPixelData", "[", 
   RowBox[{"dataFile_String", ",", "image_Image"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "hash"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"FPC$LoadPixelDataFile", "@", "dataFile"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hash", "=", 
      RowBox[{"FPC$MakeImageHash", "@", "image"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Lookup", "[", 
      RowBox[{"data", ",", "hash"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667819015852723*^9, {3.667926743191167*^9, 
   3.667926756485921*^9}, {3.6679268065659847`*^9, 3.6679268096604767`*^9}, {
   3.667926962553701*^9, 3.6679269943921003`*^9}, 3.6679277909347057`*^9, {
   3.6679278215421352`*^9, 3.6679278447888317`*^9}, {3.667927921354144*^9, 
   3.66792792396218*^9}, {3.667927998418087*^9, 3.667927998617405*^9}, {
   3.6679280547365437`*^9, 3.667928057183651*^9}, {3.667928585451659*^9, 
   3.667928696849235*^9}, {3.667930404905075*^9, 3.6679304216077147`*^9}, {
   3.6679304533630323`*^9, 3.667930454063971*^9}, {3.6679310019224863`*^9, 
   3.667931184397665*^9}, {3.667931227245723*^9, 3.667931371281341*^9}, {
   3.667931420882256*^9, 3.667931517142481*^9}, 3.667931552079372*^9, {
   3.667931592230816*^9, 3.6679315953351383`*^9}, {3.66793164158883*^9, 
   3.667931735041656*^9}, {3.667931797945294*^9, 3.667931835823868*^9}, {
   3.667931870240131*^9, 3.667931910901052*^9}, {3.6679320411065617`*^9, 
   3.667932042282494*^9}, {3.6679321631039057`*^9, 3.667932185255023*^9}, {
   3.6679322367038527`*^9, 3.6679322536777477`*^9}, 3.667939889308084*^9, {
   3.667969769378148*^9, 3.667969771378113*^9}, 3.667970090993989*^9, {
   3.667973390326392*^9, 3.6679733948223467`*^9}, {3.667976913750659*^9, 
   3.667976916404254*^9}, {3.6679769619491863`*^9, 3.667976962373781*^9}, 
   3.66797708246696*^9, 3.667977633341072*^9, {3.667977678626876*^9, 
   3.667977952564095*^9}, {3.667982385812993*^9, 3.6679823891230717`*^9}, {
   3.667982552768587*^9, 3.6679825768232183`*^9}, {3.667982617631548*^9, 
   3.667982618230095*^9}, 3.667982783740485*^9, 3.667982978648044*^9, {
   3.667987233443955*^9, 3.6679872350670633`*^9}, 3.667987319881976*^9, {
   3.667995025393314*^9, 3.667995077673361*^9}, {3.667995795417122*^9, 
   3.6679958330065393`*^9}, 3.66799604865274*^9, {3.667996211983923*^9, 
   3.667996238685172*^9}, {3.667996325731824*^9, 3.6679963500750713`*^9}, 
   3.6679964246118183`*^9, {3.6679964925539827`*^9, 3.6679965140880003`*^9}, {
   3.6679966308453293`*^9, 3.667996631124778*^9}, {3.667996667541781*^9, 
   3.667996679667149*^9}, {3.6682298967733393`*^9, 3.668230154667777*^9}, {
   3.6682302282495613`*^9, 3.668230337862431*^9}, {3.66823037439754*^9, 
   3.6682304210040913`*^9}, {3.668230470966654*^9, 3.668230509026909*^9}, {
   3.6682305945216846`*^9, 3.668230608294874*^9}, {3.668230649418269*^9, 
   3.6682306552087507`*^9}, {3.668230777855473*^9, 3.668230779342372*^9}, {
   3.668230827027471*^9, 3.668230869589425*^9}, {3.6682309020436172`*^9, 
   3.6682309032099752`*^9}, {3.668230964088015*^9, 3.6682309837305403`*^9}, {
   3.668231043206236*^9, 3.668231198625996*^9}, {3.6682312793778677`*^9, 
   3.668231309239684*^9}, {3.668231360770649*^9, 3.668231478579686*^9}, {
   3.6682315182903957`*^9, 3.6682316606075783`*^9}, {3.668231853738429*^9, 
   3.6682319097544107`*^9}, 3.6682320481299458`*^9, {3.66823231198499*^9, 
   3.668232340966546*^9}, {3.668232413221817*^9, 3.6682324555084667`*^9}, {
   3.668232593908114*^9, 3.6682326569589863`*^9}, {3.668232694967547*^9, 
   3.6682327934677343`*^9}, {3.668233168339756*^9, 3.668233211018368*^9}, {
   3.668233911929123*^9, 3.668233912673284*^9}, {3.668234165475075*^9, 
   3.668234166434887*^9}, 3.668234335726321*^9, {3.668234375925832*^9, 
   3.668234383685205*^9}, {3.6682344192284307`*^9, 3.668234420445109*^9}, {
   3.6682344814285107`*^9, 3.668234482946336*^9}, {3.668234565665369*^9, 
   3.6682345756405*^9}, {3.668234658311418*^9, 3.668234660936935*^9}, {
   3.668234729151449*^9, 3.668234734437337*^9}, {3.668234775292177*^9, 
   3.668234776492208*^9}, {3.6682348149806547`*^9, 3.6682348872015553`*^9}, {
   3.668234957471792*^9, 3.668234962599025*^9}, {3.66823500756784*^9, 
   3.668235010638788*^9}, {3.668235386702396*^9, 3.6682353879562407`*^9}, {
   3.668235436429007*^9, 3.668235463195363*^9}, {3.668235513409904*^9, 
   3.668235551480637*^9}, 3.668235614055798*^9, {3.668235690567173*^9, 
   3.668235719044767*^9}, {3.6695562972398148`*^9, 3.669556297373962*^9}, {
   3.687512196806978*^9, 3.6875121973395967`*^9}, {3.713802902597312*^9, 
   3.713802915932815*^9}, {3.713803320942219*^9, 3.713803345450964*^9}, {
   3.7138034257374067`*^9, 3.713803460759953*^9}, 3.713803519649189*^9, {
   3.713803604382509*^9, 3.713803680578794*^9}, {3.7138037681305428`*^9, 
   3.713803775505362*^9}, {3.713803860977088*^9, 3.713803917581181*^9}, {
   3.713803974310575*^9, 3.713803976182168*^9}, 3.7138040436679573`*^9, {
   3.7138063486627274`*^9, 3.713806350942552*^9}, {3.713807462694106*^9, 
   3.713807489203656*^9}, {3.7138075517857037`*^9, 3.713807559617502*^9}, {
   3.713807618953618*^9, 3.713807903852294*^9}, {3.713808001585246*^9, 
   3.7138080016781054`*^9}, 3.71380855458074*^9, {3.71380863487689*^9, 
   3.7138087192939777`*^9}, {3.713808846860177*^9, 3.713808857421461*^9}, {
   3.713808897778977*^9, 3.713808912465152*^9}, {3.713808955217936*^9, 
   3.7138089628015137`*^9}, {3.713808995906348*^9, 3.713809022295484*^9}, {
   3.713809073335235*^9, 3.713809100565136*^9}, {3.713809177854271*^9, 
   3.7138093132746353`*^9}, {3.7138093441213913`*^9, 
   3.7138093456793613`*^9}, {3.713809453317717*^9, 3.713809513685094*^9}, {
   3.7138095931785507`*^9, 3.713809626242549*^9}, {3.713809658033081*^9, 
   3.713809664135953*^9}, 3.713809740064288*^9, {3.713809808472837*^9, 
   3.7138099121534863`*^9}, {3.713844685073086*^9, 3.7138446872542553`*^9}, {
   3.71384588184228*^9, 3.7138458833230133`*^9}, {3.713846292992717*^9, 
   3.713846349611416*^9}, 3.713846695574162*^9, {3.7138467278378*^9, 
   3.713846731171411*^9}, {3.713846806808646*^9, 3.713846913776025*^9}, {
   3.7138469529141293`*^9, 3.713846953470827*^9}, {3.713847032551959*^9, 
   3.7138470334900837`*^9}, {3.713847168612919*^9, 3.713847198830091*^9}, {
   3.713847280190546*^9, 3.713847327524582*^9}, {3.713847407284361*^9, 
   3.713847407599958*^9}, {3.7138474475624743`*^9, 3.713847471334959*^9}, {
   3.713847502755796*^9, 3.713847510323131*^9}, {3.7138476002010098`*^9, 
   3.713847681785532*^9}, {3.7138477189303513`*^9, 3.713847720783132*^9}, {
   3.713848047572956*^9, 3.713848050312454*^9}, {3.713848196591464*^9, 
   3.713848212251227*^9}, {3.713848276669099*^9, 3.713848283663631*^9}, {
   3.713855305653678*^9, 3.713855338332179*^9}, {3.713855626443754*^9, 
   3.713855628890686*^9}, 3.713855941830909*^9, {3.713856433219384*^9, 
   3.713856437634218*^9}, {3.713862011147923*^9, 3.713862014225955*^9}, {
   3.713865700953743*^9, 3.7138657011938753`*^9}, {3.824549157884141*^9, 
   3.824549159319586*^9}, {3.8245492253561296`*^9, 3.824549247629485*^9}, 
   3.8245493292632647`*^9, {3.824549386072567*^9, 3.824549410357386*^9}, {
   3.824549474902042*^9, 3.824549512116287*^9}, {3.824549598827116*^9, 
   3.8245496604630527`*^9}, {3.824549706380138*^9, 3.8245497609777327`*^9}, {
   3.824549844913988*^9, 3.824549846763631*^9}, {3.8245498794471292`*^9, 
   3.824549881428441*^9}, {3.824549979839823*^9, 3.8245499800738077`*^9}, 
   3.824550016309486*^9, {3.824550263587179*^9, 3.824550273676351*^9}, {
   3.824550356454542*^9, 3.824550397848559*^9}, 3.8245505155203037`*^9, {
   3.82455056653398*^9, 3.8245506401875257`*^9}, {3.824550689620389*^9, 
   3.824550805106915*^9}, {3.824550840692254*^9, 3.8245508686236134`*^9}, {
   3.8245509105415916`*^9, 3.824550941488265*^9}, {3.824550999983103*^9, 
   3.824551000135416*^9}, {3.824551191065404*^9, 3.824551310428009*^9}, {
   3.824551371207891*^9, 3.824551387084132*^9}, {3.82455163461265*^9, 
   3.824551641709669*^9}, {3.824551676989612*^9, 3.8245516908209543`*^9}, {
   3.824551744320958*^9, 3.8245517988387537`*^9}, {3.8245518437147007`*^9, 
   3.824551878676241*^9}, {3.824552093824395*^9, 3.824552094964884*^9}, {
   3.824613355161584*^9, 3.82461335891087*^9}, {3.8246134068736477`*^9, 
   3.824613526703142*^9}, {3.824613697948286*^9, 3.824613729276009*^9}, {
   3.82461691671942*^9, 3.8246169170846767`*^9}, {3.8246169924812803`*^9, 
   3.824617030306223*^9}, {3.824617078730901*^9, 3.824617123391067*^9}, {
   3.82461773205303*^9, 3.82461773369724*^9}, 3.824625965110029*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[11]:=",ExpressionUUID->"50f8361f-3362-4fab-bfa1-157ce544b980"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FPC$UpdatePixelDataFile", "[", 
   RowBox[{"dataFile_String", ",", "image_Image", ",", "newEntryData_List"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "hash"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"FPC$LoadPixelDataFile", "@", "dataFile"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hash", "=", 
      RowBox[{"FPC$MakeImageHash", "@", "image"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"data", ",", 
       RowBox[{"hash", "\[Rule]", "newEntryData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"dataFile", ",", "data"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Length", "@", "data"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667819015852723*^9, {3.667926743191167*^9, 
   3.667926756485921*^9}, {3.6679268065659847`*^9, 3.6679268096604767`*^9}, {
   3.667926962553701*^9, 3.6679269943921003`*^9}, 3.6679277909347057`*^9, {
   3.6679278215421352`*^9, 3.6679278447888317`*^9}, {3.667927921354144*^9, 
   3.66792792396218*^9}, {3.667927998418087*^9, 3.667927998617405*^9}, {
   3.6679280547365437`*^9, 3.667928057183651*^9}, {3.667928585451659*^9, 
   3.667928696849235*^9}, {3.667930404905075*^9, 3.6679304216077147`*^9}, {
   3.6679304533630323`*^9, 3.667930454063971*^9}, {3.6679310019224863`*^9, 
   3.667931184397665*^9}, {3.667931227245723*^9, 3.667931371281341*^9}, {
   3.667931420882256*^9, 3.667931517142481*^9}, 3.667931552079372*^9, {
   3.667931592230816*^9, 3.6679315953351383`*^9}, {3.66793164158883*^9, 
   3.667931735041656*^9}, {3.667931797945294*^9, 3.667931835823868*^9}, {
   3.667931870240131*^9, 3.667931910901052*^9}, {3.6679320411065617`*^9, 
   3.667932042282494*^9}, {3.6679321631039057`*^9, 3.667932185255023*^9}, {
   3.6679322367038527`*^9, 3.6679322536777477`*^9}, 3.667939889308084*^9, {
   3.667969769378148*^9, 3.667969771378113*^9}, 3.667970090993989*^9, {
   3.667973390326392*^9, 3.6679733948223467`*^9}, {3.667976913750659*^9, 
   3.667976916404254*^9}, {3.6679769619491863`*^9, 3.667976962373781*^9}, 
   3.66797708246696*^9, 3.667977633341072*^9, {3.667977678626876*^9, 
   3.667977952564095*^9}, {3.667982385812993*^9, 3.6679823891230717`*^9}, {
   3.667982552768587*^9, 3.6679825768232183`*^9}, {3.667982617631548*^9, 
   3.667982618230095*^9}, 3.667982783740485*^9, 3.667982978648044*^9, {
   3.667987233443955*^9, 3.6679872350670633`*^9}, 3.667987319881976*^9, {
   3.667995025393314*^9, 3.667995077673361*^9}, {3.667995795417122*^9, 
   3.6679958330065393`*^9}, 3.66799604865274*^9, {3.667996211983923*^9, 
   3.667996238685172*^9}, {3.667996325731824*^9, 3.6679963500750713`*^9}, 
   3.6679964246118183`*^9, {3.6679964925539827`*^9, 3.6679965140880003`*^9}, {
   3.6679966308453293`*^9, 3.667996631124778*^9}, {3.667996667541781*^9, 
   3.667996679667149*^9}, {3.6682298967733393`*^9, 3.668230154667777*^9}, {
   3.6682302282495613`*^9, 3.668230337862431*^9}, {3.66823037439754*^9, 
   3.6682304210040913`*^9}, {3.668230470966654*^9, 3.668230509026909*^9}, {
   3.6682305945216846`*^9, 3.668230608294874*^9}, {3.668230649418269*^9, 
   3.6682306552087507`*^9}, {3.668230777855473*^9, 3.668230779342372*^9}, {
   3.668230827027471*^9, 3.668230869589425*^9}, {3.6682309020436172`*^9, 
   3.6682309032099752`*^9}, {3.668230964088015*^9, 3.6682309837305403`*^9}, {
   3.668231043206236*^9, 3.668231198625996*^9}, {3.6682312793778677`*^9, 
   3.668231309239684*^9}, {3.668231360770649*^9, 3.668231478579686*^9}, {
   3.6682315182903957`*^9, 3.6682316606075783`*^9}, {3.668231853738429*^9, 
   3.6682319097544107`*^9}, 3.6682320481299458`*^9, {3.66823231198499*^9, 
   3.668232340966546*^9}, {3.668232413221817*^9, 3.6682324555084667`*^9}, {
   3.668232593908114*^9, 3.6682326569589863`*^9}, {3.668232694967547*^9, 
   3.6682327934677343`*^9}, {3.668233168339756*^9, 3.668233211018368*^9}, {
   3.668233911929123*^9, 3.668233912673284*^9}, {3.668234165475075*^9, 
   3.668234166434887*^9}, 3.668234335726321*^9, {3.668234375925832*^9, 
   3.668234383685205*^9}, {3.6682344192284307`*^9, 3.668234420445109*^9}, {
   3.6682344814285107`*^9, 3.668234482946336*^9}, {3.668234565665369*^9, 
   3.6682345756405*^9}, {3.668234658311418*^9, 3.668234660936935*^9}, {
   3.668234729151449*^9, 3.668234734437337*^9}, {3.668234775292177*^9, 
   3.668234776492208*^9}, {3.6682348149806547`*^9, 3.6682348872015553`*^9}, {
   3.668234957471792*^9, 3.668234962599025*^9}, {3.66823500756784*^9, 
   3.668235010638788*^9}, {3.668235386702396*^9, 3.6682353879562407`*^9}, {
   3.668235436429007*^9, 3.668235463195363*^9}, {3.668235513409904*^9, 
   3.668235551480637*^9}, 3.668235614055798*^9, {3.668235690567173*^9, 
   3.668235719044767*^9}, {3.6695562972398148`*^9, 3.669556297373962*^9}, {
   3.687512196806978*^9, 3.6875121973395967`*^9}, {3.713802902597312*^9, 
   3.713802915932815*^9}, {3.713803320942219*^9, 3.713803345450964*^9}, {
   3.7138034257374067`*^9, 3.713803460759953*^9}, 3.713803519649189*^9, {
   3.713803604382509*^9, 3.713803680578794*^9}, {3.7138037681305428`*^9, 
   3.713803775505362*^9}, {3.713803860977088*^9, 3.713803917581181*^9}, {
   3.713803974310575*^9, 3.713803976182168*^9}, 3.7138040436679573`*^9, {
   3.7138063486627274`*^9, 3.713806350942552*^9}, {3.713807462694106*^9, 
   3.713807489203656*^9}, {3.7138075517857037`*^9, 3.713807559617502*^9}, {
   3.713807618953618*^9, 3.713807903852294*^9}, {3.713808001585246*^9, 
   3.7138080016781054`*^9}, 3.71380855458074*^9, {3.71380863487689*^9, 
   3.7138087192939777`*^9}, {3.713808846860177*^9, 3.713808857421461*^9}, {
   3.713808897778977*^9, 3.713808912465152*^9}, {3.713808955217936*^9, 
   3.7138089628015137`*^9}, {3.713808995906348*^9, 3.713809022295484*^9}, {
   3.713809073335235*^9, 3.713809100565136*^9}, {3.713809177854271*^9, 
   3.7138093132746353`*^9}, {3.7138093441213913`*^9, 
   3.7138093456793613`*^9}, {3.713809453317717*^9, 3.713809513685094*^9}, {
   3.7138095931785507`*^9, 3.713809626242549*^9}, {3.713809658033081*^9, 
   3.713809664135953*^9}, 3.713809740064288*^9, {3.713809808472837*^9, 
   3.7138099121534863`*^9}, {3.713844685073086*^9, 3.7138446872542553`*^9}, {
   3.71384588184228*^9, 3.7138458833230133`*^9}, {3.713846292992717*^9, 
   3.713846349611416*^9}, 3.713846695574162*^9, {3.7138467278378*^9, 
   3.713846731171411*^9}, {3.713846806808646*^9, 3.713846913776025*^9}, {
   3.7138469529141293`*^9, 3.713846953470827*^9}, {3.713847032551959*^9, 
   3.7138470334900837`*^9}, {3.713847168612919*^9, 3.713847198830091*^9}, {
   3.713847280190546*^9, 3.713847327524582*^9}, {3.713847407284361*^9, 
   3.713847407599958*^9}, {3.7138474475624743`*^9, 3.713847471334959*^9}, {
   3.713847502755796*^9, 3.713847510323131*^9}, {3.7138476002010098`*^9, 
   3.713847681785532*^9}, {3.7138477189303513`*^9, 3.713847720783132*^9}, {
   3.713848047572956*^9, 3.713848050312454*^9}, {3.713848196591464*^9, 
   3.713848212251227*^9}, {3.713848276669099*^9, 3.713848283663631*^9}, {
   3.713855305653678*^9, 3.713855338332179*^9}, {3.713855626443754*^9, 
   3.713855628890686*^9}, 3.713855941830909*^9, {3.713856433219384*^9, 
   3.713856437634218*^9}, {3.713862011147923*^9, 3.713862014225955*^9}, {
   3.713865700953743*^9, 3.7138657011938753`*^9}, {3.824549157884141*^9, 
   3.824549159319586*^9}, {3.8245492253561296`*^9, 3.824549247629485*^9}, 
   3.8245493292632647`*^9, {3.824549386072567*^9, 3.824549410357386*^9}, {
   3.824549474902042*^9, 3.824549512116287*^9}, {3.824549598827116*^9, 
   3.8245496604630527`*^9}, {3.824549706380138*^9, 3.8245497609777327`*^9}, {
   3.824549844913988*^9, 3.824549846763631*^9}, {3.8245498794471292`*^9, 
   3.824549881428441*^9}, {3.824549979839823*^9, 3.8245499800738077`*^9}, 
   3.824550016309486*^9, {3.824550263587179*^9, 3.824550273676351*^9}, {
   3.824550356454542*^9, 3.824550397848559*^9}, 3.8245505155203037`*^9, {
   3.82455056653398*^9, 3.8245506401875257`*^9}, {3.824550689620389*^9, 
   3.824550805106915*^9}, {3.824550840692254*^9, 3.8245508686236134`*^9}, {
   3.8245509105415916`*^9, 3.824550941488265*^9}, {3.824550999983103*^9, 
   3.824551000135416*^9}, {3.824551191065404*^9, 3.824551310428009*^9}, {
   3.824551371207891*^9, 3.824551387084132*^9}, {3.82455163461265*^9, 
   3.824551641709669*^9}, {3.824551676989612*^9, 3.8245516908209543`*^9}, {
   3.824551744320958*^9, 3.8245517988387537`*^9}, {3.8245518437147007`*^9, 
   3.824551878676241*^9}, {3.824552093824395*^9, 3.824552094964884*^9}, {
   3.824613355161584*^9, 3.82461335891087*^9}, {3.8246134068736477`*^9, 
   3.824613526703142*^9}, {3.824613816634026*^9, 3.824613870024139*^9}, {
   3.824616868141634*^9, 3.824616895695395*^9}, 3.82461693079196*^9, {
   3.824617089412416*^9, 3.824617091916669*^9}, 3.824617742039572*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[12]:=",ExpressionUUID->"d7af6261-0147-4143-8899-1313b88b7dfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FPC$Process", "[", 
   RowBox[{"image_Image", ",", 
    RowBox[{"OptionsPattern", "@", "FindPixelClusters"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "bin", ",", "data", ",", "L", ",", "method", ",", "fraction", ",", 
      "check", ",", "\[IndentingNewLine]", "P", ",", "update", ",", "start", 
      ",", "near", ",", "r", ",", "progress", ",", "status", ",", "total", 
      ",", "p", ",", "i", ",", "j", ",", "neighbours", ",", "new", ",", "n", 
      ",", "new2", ",", "\[IndentingNewLine]", "clusters", ",", "k"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "image", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Otsu", "'"}], "s", " ", "cluster", " ", "variance", " ", 
      "maximization", " ", "method"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bin", "=", 
      RowBox[{"Binarize", "@", "image"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"PixelValuePositions", "[", 
       RowBox[{"bin", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Choose", " ", "method"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"method", "=", 
      RowBox[{"OptionValue", "[", "Method", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Median\>\"", ",", "\"\<Mean\>\"", ",", "\"\<Cluster\>\"", 
            ",", "\"\<HighestFraction\>\"", ",", "\"\<BinariseOnly\>\""}], 
           "}"}], ",", "method"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"FindPixelClusters", "::", "method"}], ",", "method"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"method", "===", "\"\<BinariseOnly\>\""}], ",", 
       RowBox[{"Goto", "[", "\"\<BinarisationDone\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "further", " ", "refinement", " ", "is", " ", 
       "necessary"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "\[LessEqual]", "20000"}], ",", "Null", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"L", "\[LessEqual]", "50000"}], ",", 
       RowBox[{"bin", "=", 
        RowBox[{"DeleteSmallComponents", "[", 
         RowBox[{"bin", ",", 
          RowBox[{"Method", "\[Rule]", "method"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Special", " ", "procedure", " ", "for", " ", "very", " ", "noisy", 
         " ", "images"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"fraction", "=", "1.00"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"check", "=", "True"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"While", "[", 
         RowBox[{"check", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"fraction", "=", 
            RowBox[{"fraction", "-", "0.005"}]}], ";", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"bin", "=", 
            RowBox[{"Binarize", "[", 
             RowBox[{"image", ",", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<BlackFraction\>\"", ",", " ", "fraction"}], 
                "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"check", "=", 
            RowBox[{
             RowBox[{"PixelValuePositions", "[", 
              RowBox[{"bin", ",", "1"}], "]"}], "\[Equal]", 
             RowBox[{"{", "}"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"bin", "=", 
         RowBox[{"DeleteSmallComponents", "[", 
          RowBox[{"bin", ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Mean\>\""}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"PixelValuePositions", "[", 
       RowBox[{"bin", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{
       "Return", " ", "binary", " ", "image", " ", "and", " ", "data", " ", 
        "length", " ", "for", " ", "inspection"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<BinarisationDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ReturnBinaryImage\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"FindPixelClusters", "::", "pixels"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ToString", "@", 
           RowBox[{"NumberForm", "[", 
            RowBox[{
             RowBox[{"Length", "@", "data"}], ",", 
             RowBox[{"DigitBlock", "\[Rule]", "3"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "bin"}]}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Cluster", " ", "determination", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", "all", " ", "pixels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"update", "=", 
      RowBox[{"N", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"start", "=", 
      RowBox[{"First", "@", "update"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"N", "@", 
       RowBox[{"OptionValue", "[", "\"\<ClusterRange\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"near", "=", 
      RowBox[{"N", "@", 
       RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"-", "r"}], ",", "r"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"total", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"progress", "=", "total"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dynamic", " ", "status"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"status", "=", 
      RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Determining pixel clusters:\>\"", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Avenir Next\>\""}], ",", 
              "14"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"ProgressIndicator", "[", 
             RowBox[{"1", "-", 
              RowBox[{"progress", "/", "total"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]", 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", "pixel"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"Reap", "@", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"update", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"First", " ", "iteration"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"neighbours", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"start", "+", "#"}], "&"}], "/@", "near"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"new", "=", 
           RowBox[{"Intersection", "[", 
            RowBox[{"update", ",", "neighbours"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Avoid", " ", "looping", " ", "over", " ", "the", " ", "same", " ",
             "single", " ", "pixel"}], " ", "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"new", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"update", "=", 
             RowBox[{"Rest", "@", "update"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"p", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"p", ",", "new"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"update", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"update", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"The", " ", "next", " ", "iterations"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"new", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Current", " ", "and", " ", "rest"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"n", "=", 
              RowBox[{"First", "@", "new"}]}], ";", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"new", "=", 
              RowBox[{"Rest", "@", "new"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"neighbours", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "+", "#"}], "&"}], "/@", "near"}]}], ";", 
             "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{"Actual", " ", "new", " ", "elements"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"new2", "=", 
              RowBox[{"Intersection", "[", 
               RowBox[{"update", ",", "neighbours"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"p", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"p", ",", "new2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
             RowBox[{"update", "=", 
              RowBox[{"Complement", "[", 
               RowBox[{"update", ",", "p"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"new", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"new", ",", "new2"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"One", " ", "pixel", " ", "done"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Sow", "[", "p", "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"progress", "=", 
           RowBox[{"Length", "@", "update"}]}], ";", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"update", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"start", "=", 
             RowBox[{"First", "@", "update"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ClearStatus\>\"", "]"}]}], ",", 
       RowBox[{"NotebookDelete", "@", "status"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"P", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"clusters", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"P", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Merge", " ", "pixel", " ", "clusters", 
       " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"Reap", "@", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"k", "=", 
           RowBox[{"Round", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Total", "@", 
                RowBox[{"clusters", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "All", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Total", "@", 
                RowBox[{"clusters", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "All", ",", "2"}], 
                 "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "}"}], 
             "/", 
             RowBox[{"Length", "@", 
              RowBox[{
              "clusters", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Sow", "[", "k", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "clusters"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", 
     RowBox[{"P", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667819015852723*^9, {3.667926743191167*^9, 
   3.667926756485921*^9}, {3.6679268065659847`*^9, 3.6679268096604767`*^9}, {
   3.667926962553701*^9, 3.6679269943921003`*^9}, 3.6679277909347057`*^9, {
   3.6679278215421352`*^9, 3.6679278447888317`*^9}, {3.667927921354144*^9, 
   3.66792792396218*^9}, {3.667927998418087*^9, 3.667927998617405*^9}, {
   3.6679280547365437`*^9, 3.667928057183651*^9}, {3.667928585451659*^9, 
   3.667928696849235*^9}, {3.667930404905075*^9, 3.6679304216077147`*^9}, {
   3.6679304533630323`*^9, 3.667930454063971*^9}, {3.6679310019224863`*^9, 
   3.667931184397665*^9}, {3.667931227245723*^9, 3.667931371281341*^9}, {
   3.667931420882256*^9, 3.667931517142481*^9}, 3.667931552079372*^9, {
   3.667931592230816*^9, 3.6679315953351383`*^9}, {3.66793164158883*^9, 
   3.667931735041656*^9}, {3.667931797945294*^9, 3.667931835823868*^9}, {
   3.667931870240131*^9, 3.667931910901052*^9}, {3.6679320411065617`*^9, 
   3.667932042282494*^9}, {3.6679321631039057`*^9, 3.667932185255023*^9}, {
   3.6679322367038527`*^9, 3.6679322536777477`*^9}, 3.667939889308084*^9, {
   3.667969769378148*^9, 3.667969771378113*^9}, 3.667970090993989*^9, {
   3.667973390326392*^9, 3.6679733948223467`*^9}, {3.667976913750659*^9, 
   3.667976916404254*^9}, {3.6679769619491863`*^9, 3.667976962373781*^9}, 
   3.66797708246696*^9, 3.667977633341072*^9, {3.667977678626876*^9, 
   3.667977952564095*^9}, {3.667982385812993*^9, 3.6679823891230717`*^9}, {
   3.667982552768587*^9, 3.6679825768232183`*^9}, {3.667982617631548*^9, 
   3.667982618230095*^9}, 3.667982783740485*^9, 3.667982978648044*^9, {
   3.667987233443955*^9, 3.6679872350670633`*^9}, 3.667987319881976*^9, {
   3.667995025393314*^9, 3.667995077673361*^9}, {3.667995795417122*^9, 
   3.6679958330065393`*^9}, 3.66799604865274*^9, {3.667996211983923*^9, 
   3.667996238685172*^9}, {3.667996325731824*^9, 3.6679963500750713`*^9}, 
   3.6679964246118183`*^9, {3.6679964925539827`*^9, 3.6679965140880003`*^9}, {
   3.6679966308453293`*^9, 3.667996631124778*^9}, {3.667996667541781*^9, 
   3.667996679667149*^9}, {3.6682298967733393`*^9, 3.668230154667777*^9}, {
   3.6682302282495613`*^9, 3.668230337862431*^9}, {3.66823037439754*^9, 
   3.6682304210040913`*^9}, {3.668230470966654*^9, 3.668230509026909*^9}, {
   3.6682305945216846`*^9, 3.668230608294874*^9}, {3.668230649418269*^9, 
   3.6682306552087507`*^9}, {3.668230777855473*^9, 3.668230779342372*^9}, {
   3.668230827027471*^9, 3.668230869589425*^9}, {3.6682309020436172`*^9, 
   3.6682309032099752`*^9}, {3.668230964088015*^9, 3.6682309837305403`*^9}, {
   3.668231043206236*^9, 3.668231198625996*^9}, {3.6682312793778677`*^9, 
   3.668231309239684*^9}, {3.668231360770649*^9, 3.668231478579686*^9}, {
   3.6682315182903957`*^9, 3.6682316606075783`*^9}, {3.668231853738429*^9, 
   3.6682319097544107`*^9}, 3.6682320481299458`*^9, {3.66823231198499*^9, 
   3.668232340966546*^9}, {3.668232413221817*^9, 3.6682324555084667`*^9}, {
   3.668232593908114*^9, 3.6682326569589863`*^9}, {3.668232694967547*^9, 
   3.6682327934677343`*^9}, {3.668233168339756*^9, 3.668233211018368*^9}, {
   3.668233911929123*^9, 3.668233912673284*^9}, {3.668234165475075*^9, 
   3.668234166434887*^9}, 3.668234335726321*^9, {3.668234375925832*^9, 
   3.668234383685205*^9}, {3.6682344192284307`*^9, 3.668234420445109*^9}, {
   3.6682344814285107`*^9, 3.668234482946336*^9}, {3.668234565665369*^9, 
   3.6682345756405*^9}, {3.668234658311418*^9, 3.668234660936935*^9}, {
   3.668234729151449*^9, 3.668234734437337*^9}, {3.668234775292177*^9, 
   3.668234776492208*^9}, {3.6682348149806547`*^9, 3.6682348872015553`*^9}, {
   3.668234957471792*^9, 3.668234962599025*^9}, {3.66823500756784*^9, 
   3.668235010638788*^9}, {3.668235386702396*^9, 3.6682353879562407`*^9}, {
   3.668235436429007*^9, 3.668235463195363*^9}, {3.668235513409904*^9, 
   3.668235551480637*^9}, 3.668235614055798*^9, {3.668235690567173*^9, 
   3.668235719044767*^9}, {3.6695562972398148`*^9, 3.669556297373962*^9}, {
   3.687512196806978*^9, 3.6875121973395967`*^9}, {3.713802902597312*^9, 
   3.713802915932815*^9}, {3.713803320942219*^9, 3.713803345450964*^9}, {
   3.7138034257374067`*^9, 3.713803460759953*^9}, 3.713803519649189*^9, {
   3.713803604382509*^9, 3.713803680578794*^9}, {3.7138037681305428`*^9, 
   3.713803775505362*^9}, {3.713803860977088*^9, 3.713803917581181*^9}, {
   3.713803974310575*^9, 3.713803976182168*^9}, 3.7138040436679573`*^9, {
   3.7138063486627274`*^9, 3.713806350942552*^9}, {3.713807462694106*^9, 
   3.713807489203656*^9}, {3.7138075517857037`*^9, 3.713807559617502*^9}, {
   3.713807618953618*^9, 3.713807903852294*^9}, {3.713808001585246*^9, 
   3.7138080016781054`*^9}, 3.71380855458074*^9, {3.71380863487689*^9, 
   3.7138087192939777`*^9}, {3.713808846860177*^9, 3.713808857421461*^9}, {
   3.713808897778977*^9, 3.713808912465152*^9}, {3.713808955217936*^9, 
   3.7138089628015137`*^9}, {3.713808995906348*^9, 3.713809022295484*^9}, {
   3.713809073335235*^9, 3.713809100565136*^9}, {3.713809177854271*^9, 
   3.7138093132746353`*^9}, {3.7138093441213913`*^9, 
   3.7138093456793613`*^9}, {3.713809453317717*^9, 3.713809513685094*^9}, {
   3.7138095931785507`*^9, 3.713809626242549*^9}, {3.713809658033081*^9, 
   3.713809664135953*^9}, 3.713809740064288*^9, {3.713809808472837*^9, 
   3.7138099121534863`*^9}, {3.713844685073086*^9, 3.7138446872542553`*^9}, {
   3.71384588184228*^9, 3.7138458833230133`*^9}, {3.713846292992717*^9, 
   3.713846349611416*^9}, 3.713846695574162*^9, {3.7138467278378*^9, 
   3.713846731171411*^9}, {3.713846806808646*^9, 3.713846913776025*^9}, {
   3.7138469529141293`*^9, 3.713846953470827*^9}, {3.713847032551959*^9, 
   3.7138470334900837`*^9}, {3.713847168612919*^9, 3.713847198830091*^9}, {
   3.713847280190546*^9, 3.713847327524582*^9}, {3.713847407284361*^9, 
   3.713847407599958*^9}, {3.7138474475624743`*^9, 3.713847471334959*^9}, {
   3.713847502755796*^9, 3.713847510323131*^9}, {3.7138476002010098`*^9, 
   3.713847681785532*^9}, {3.7138477189303513`*^9, 3.713847720783132*^9}, {
   3.713848047572956*^9, 3.713848050312454*^9}, {3.713848196591464*^9, 
   3.713848212251227*^9}, {3.713848276669099*^9, 3.713848283663631*^9}, {
   3.713855305653678*^9, 3.713855338332179*^9}, {3.713855626443754*^9, 
   3.713855628890686*^9}, 3.713855941830909*^9, {3.713856433219384*^9, 
   3.713856437634218*^9}, {3.713862011147923*^9, 3.713862014225955*^9}, {
   3.713865700953743*^9, 3.7138657011938753`*^9}, {3.82454916718884*^9, 
   3.824549169309597*^9}, {3.824549214504971*^9, 3.824549215420236*^9}, {
   3.824617767285918*^9, 3.824617774114985*^9}, {3.82461787872042*^9, 
   3.824617888779348*^9}, {3.8246179607368393`*^9, 3.8246179984130287`*^9}, {
   3.8246303637223663`*^9, 3.82463056320922*^9}, {3.828892148816979*^9, 
   3.828892153094716*^9}, {3.8288922635245533`*^9, 3.82889228105836*^9}, {
   3.828892341602765*^9, 3.828892466761808*^9}, {3.82889251813033*^9, 
   3.828892518991088*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[13]:=",ExpressionUUID->"37237089-a0e0-47d7-ae1f-86dd3fc96880"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindPixelClusters", "[", 
   RowBox[{"image_Image", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dataFile", "=", 
       RowBox[{"OptionValue", "[", "\"\<PixelDataFile\>\"", "]"}]}], ",", 
      "imageClusterData"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Driver", " ", 
      RowBox[{"routine", " ", "--"}], " ", "Check", " ", "if", " ", "image", 
      " ", "has", " ", "been", " ", "processed"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imageClusterData", "=", 
      RowBox[{"FPC$LookupPixelData", "[", 
       RowBox[{"dataFile", ",", "image"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MissingQ", "@", "imageClusterData"}]}], 
        "\[IndentingNewLine]", "&&", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<RetrieveData\>\"", "]"}]}], 
        "\[IndentingNewLine]", "&&", 
        RowBox[{"!", 
         RowBox[{"TrueQ", "@", 
          RowBox[{
          "OptionValue", "[", "\"\<ReturnBinaryImage\>\"", "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Load"}], " ", "data"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "imageClusterData"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Find"}], " ", "clusters"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"imageClusterData", "=", 
         RowBox[{"FPC$Process", "[", 
          RowBox[{"image", ",", "options"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"TrueQ", "@", 
           RowBox[{"OptionValue", "[", "\"\<UpdateDataFile\>\"", "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"FPC$UpdatePixelDataFile", "[", 
           RowBox[{"dataFile", ",", "image", ",", "imageClusterData"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "imageClusterData"}]}],
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.667819015852723*^9, {3.667926743191167*^9, 
   3.667926756485921*^9}, {3.6679268065659847`*^9, 3.6679268096604767`*^9}, {
   3.667926962553701*^9, 3.6679269943921003`*^9}, 3.6679277909347057`*^9, {
   3.6679278215421352`*^9, 3.6679278447888317`*^9}, {3.667927921354144*^9, 
   3.66792792396218*^9}, {3.667927998418087*^9, 3.667927998617405*^9}, {
   3.6679280547365437`*^9, 3.667928057183651*^9}, {3.667928585451659*^9, 
   3.667928696849235*^9}, {3.667930404905075*^9, 3.6679304216077147`*^9}, {
   3.6679304533630323`*^9, 3.667930454063971*^9}, {3.6679310019224863`*^9, 
   3.667931184397665*^9}, {3.667931227245723*^9, 3.667931371281341*^9}, {
   3.667931420882256*^9, 3.667931517142481*^9}, 3.667931552079372*^9, {
   3.667931592230816*^9, 3.6679315953351383`*^9}, {3.66793164158883*^9, 
   3.667931735041656*^9}, {3.667931797945294*^9, 3.667931835823868*^9}, {
   3.667931870240131*^9, 3.667931910901052*^9}, {3.6679320411065617`*^9, 
   3.667932042282494*^9}, {3.6679321631039057`*^9, 3.667932185255023*^9}, {
   3.6679322367038527`*^9, 3.6679322536777477`*^9}, 3.667939889308084*^9, {
   3.667969769378148*^9, 3.667969771378113*^9}, 3.667970090993989*^9, {
   3.667973390326392*^9, 3.6679733948223467`*^9}, {3.667976913750659*^9, 
   3.667976916404254*^9}, {3.6679769619491863`*^9, 3.667976962373781*^9}, 
   3.66797708246696*^9, 3.667977633341072*^9, {3.667977678626876*^9, 
   3.667977952564095*^9}, {3.667982385812993*^9, 3.6679823891230717`*^9}, {
   3.667982552768587*^9, 3.6679825768232183`*^9}, {3.667982617631548*^9, 
   3.667982618230095*^9}, 3.667982783740485*^9, 3.667982978648044*^9, {
   3.667987233443955*^9, 3.6679872350670633`*^9}, 3.667987319881976*^9, {
   3.667995025393314*^9, 3.667995077673361*^9}, {3.667995795417122*^9, 
   3.6679958330065393`*^9}, 3.66799604865274*^9, {3.667996211983923*^9, 
   3.667996238685172*^9}, {3.667996325731824*^9, 3.6679963500750713`*^9}, 
   3.6679964246118183`*^9, {3.6679964925539827`*^9, 3.6679965140880003`*^9}, {
   3.6679966308453293`*^9, 3.667996631124778*^9}, {3.667996667541781*^9, 
   3.667996679667149*^9}, {3.6682298967733393`*^9, 3.668230154667777*^9}, {
   3.6682302282495613`*^9, 3.668230337862431*^9}, {3.66823037439754*^9, 
   3.6682304210040913`*^9}, {3.668230470966654*^9, 3.668230509026909*^9}, {
   3.6682305945216846`*^9, 3.668230608294874*^9}, {3.668230649418269*^9, 
   3.6682306552087507`*^9}, {3.668230777855473*^9, 3.668230779342372*^9}, {
   3.668230827027471*^9, 3.668230869589425*^9}, {3.6682309020436172`*^9, 
   3.6682309032099752`*^9}, {3.668230964088015*^9, 3.6682309837305403`*^9}, {
   3.668231043206236*^9, 3.668231198625996*^9}, {3.6682312793778677`*^9, 
   3.668231309239684*^9}, {3.668231360770649*^9, 3.668231478579686*^9}, {
   3.6682315182903957`*^9, 3.6682316606075783`*^9}, {3.668231853738429*^9, 
   3.6682319097544107`*^9}, 3.6682320481299458`*^9, {3.66823231198499*^9, 
   3.668232340966546*^9}, {3.668232413221817*^9, 3.6682324555084667`*^9}, {
   3.668232593908114*^9, 3.6682326569589863`*^9}, {3.668232694967547*^9, 
   3.6682327934677343`*^9}, {3.668233168339756*^9, 3.668233211018368*^9}, {
   3.668233911929123*^9, 3.668233912673284*^9}, {3.668234165475075*^9, 
   3.668234166434887*^9}, 3.668234335726321*^9, {3.668234375925832*^9, 
   3.668234383685205*^9}, {3.6682344192284307`*^9, 3.668234420445109*^9}, {
   3.6682344814285107`*^9, 3.668234482946336*^9}, {3.668234565665369*^9, 
   3.6682345756405*^9}, {3.668234658311418*^9, 3.668234660936935*^9}, {
   3.668234729151449*^9, 3.668234734437337*^9}, {3.668234775292177*^9, 
   3.668234776492208*^9}, {3.6682348149806547`*^9, 3.6682348872015553`*^9}, {
   3.668234957471792*^9, 3.668234962599025*^9}, {3.66823500756784*^9, 
   3.668235010638788*^9}, {3.668235386702396*^9, 3.6682353879562407`*^9}, {
   3.668235436429007*^9, 3.668235463195363*^9}, {3.668235513409904*^9, 
   3.668235551480637*^9}, 3.668235614055798*^9, {3.668235690567173*^9, 
   3.668235719044767*^9}, {3.6695562972398148`*^9, 3.669556297373962*^9}, {
   3.687512196806978*^9, 3.6875121973395967`*^9}, {3.713802902597312*^9, 
   3.713802915932815*^9}, {3.713803320942219*^9, 3.713803345450964*^9}, {
   3.7138034257374067`*^9, 3.713803460759953*^9}, 3.713803519649189*^9, {
   3.713803604382509*^9, 3.713803680578794*^9}, {3.7138037681305428`*^9, 
   3.713803775505362*^9}, {3.713803860977088*^9, 3.713803917581181*^9}, {
   3.713803974310575*^9, 3.713803976182168*^9}, 3.7138040436679573`*^9, {
   3.7138063486627274`*^9, 3.713806350942552*^9}, {3.713807462694106*^9, 
   3.713807489203656*^9}, {3.7138075517857037`*^9, 3.713807559617502*^9}, {
   3.713807618953618*^9, 3.713807903852294*^9}, {3.713808001585246*^9, 
   3.7138080016781054`*^9}, 3.71380855458074*^9, {3.71380863487689*^9, 
   3.7138087192939777`*^9}, {3.713808846860177*^9, 3.713808857421461*^9}, {
   3.713808897778977*^9, 3.713808912465152*^9}, {3.713808955217936*^9, 
   3.7138089628015137`*^9}, {3.713808995906348*^9, 3.713809022295484*^9}, {
   3.713809073335235*^9, 3.713809100565136*^9}, {3.713809177854271*^9, 
   3.7138093132746353`*^9}, {3.7138093441213913`*^9, 
   3.7138093456793613`*^9}, {3.713809453317717*^9, 3.713809513685094*^9}, {
   3.7138095931785507`*^9, 3.713809626242549*^9}, {3.713809658033081*^9, 
   3.713809664135953*^9}, 3.713809740064288*^9, {3.713809808472837*^9, 
   3.7138099121534863`*^9}, {3.713844685073086*^9, 3.7138446872542553`*^9}, {
   3.71384588184228*^9, 3.7138458833230133`*^9}, {3.713846292992717*^9, 
   3.713846349611416*^9}, 3.713846695574162*^9, {3.7138467278378*^9, 
   3.713846731171411*^9}, {3.713846806808646*^9, 3.713846913776025*^9}, {
   3.7138469529141293`*^9, 3.713846953470827*^9}, {3.713847032551959*^9, 
   3.7138470334900837`*^9}, {3.713847168612919*^9, 3.713847198830091*^9}, {
   3.713847280190546*^9, 3.713847327524582*^9}, {3.713847407284361*^9, 
   3.713847407599958*^9}, {3.7138474475624743`*^9, 3.713847471334959*^9}, {
   3.713847502755796*^9, 3.713847510323131*^9}, {3.7138476002010098`*^9, 
   3.713847681785532*^9}, {3.7138477189303513`*^9, 3.713847720783132*^9}, {
   3.713848047572956*^9, 3.713848050312454*^9}, {3.713848196591464*^9, 
   3.713848212251227*^9}, {3.713848276669099*^9, 3.713848283663631*^9}, {
   3.713855305653678*^9, 3.713855338332179*^9}, {3.713855626443754*^9, 
   3.713855628890686*^9}, 3.713855941830909*^9, {3.713856433219384*^9, 
   3.713856437634218*^9}, {3.713862011147923*^9, 3.713862014225955*^9}, {
   3.713865700953743*^9, 3.7138657011938753`*^9}, {3.824549157884141*^9, 
   3.824549159319586*^9}, {3.8245492253561296`*^9, 3.824549247629485*^9}, 
   3.8245493292632647`*^9, {3.824549386072567*^9, 3.824549410357386*^9}, {
   3.824549474902042*^9, 3.824549512116287*^9}, {3.824549598827116*^9, 
   3.8245496604630527`*^9}, {3.824549706380138*^9, 3.8245497609777327`*^9}, {
   3.824549844913988*^9, 3.824549846763631*^9}, {3.8245498794471292`*^9, 
   3.824549881428441*^9}, {3.824549979839823*^9, 3.8245499800738077`*^9}, 
   3.824550016309486*^9, {3.824550263587179*^9, 3.824550273676351*^9}, {
   3.824550356454542*^9, 3.824550397848559*^9}, 3.8245505155203037`*^9, {
   3.82455056653398*^9, 3.8245506401875257`*^9}, {3.824550689620389*^9, 
   3.824550805106915*^9}, {3.824550840692254*^9, 3.8245508686236134`*^9}, {
   3.8245509105415916`*^9, 3.824550941488265*^9}, {3.824550999983103*^9, 
   3.824551000135416*^9}, {3.824551212577854*^9, 3.8245512141205063`*^9}, {
   3.824551325246599*^9, 3.8245513640924883`*^9}, 3.8245515969950953`*^9, {
   3.824552098427424*^9, 3.824552098819729*^9}, 3.8246134737650003`*^9, {
   3.8246135601434402`*^9, 3.824613570016657*^9}, {3.8246138922813263`*^9, 
   3.8246138983205347`*^9}, {3.82461507173906*^9, 3.824615086599884*^9}, 
   3.8246169319832973`*^9, {3.8246171459686937`*^9, 3.824617240300456*^9}, {
   3.8246172785112658`*^9, 3.824617369029109*^9}, {3.824617414068103*^9, 
   3.824617473034834*^9}, {3.824617548497631*^9, 3.824617556226779*^9}, {
   3.82462481065853*^9, 3.8246248610496807`*^9}, {3.8246257036741343`*^9, 
   3.8246257113721247`*^9}, {3.824625778124867*^9, 3.824625788974369*^9}, {
   3.8246259814629602`*^9, 3.8246259816828823`*^9}, {3.824626029958932*^9, 
   3.8246260372164717`*^9}, {3.824626068192058*^9, 3.824626073707467*^9}, 
   3.824836320153598*^9, {3.8287857176684437`*^9, 3.828785746750169*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[14]:=",ExpressionUUID->"157713f5-80da-424a-9ebd-52c81fdb2a5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindPixelClusters", "[", 
   RowBox[{"images_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"progress", ",", "L", ",", "\[IndentingNewLine]", 
      RowBox[{"dataFile", "=", 
       RowBox[{"OptionValue", "[", "\"\<PixelDataFile\>\"", "]"}]}], ",", 
      "tempDataFile", ",", "firstEntry", ",", "\[IndentingNewLine]", "image", 
      ",", "hash", ",", "data", ",", "newData"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Dynamic", " ", "status"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"progress", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "images"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", 
      RowBox[{"Row", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Progress:\>\"", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}], ",", 
             "16"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{"progress", "/", "L"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "[", 
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<Images done: \>\"", "<>", 
               RowBox[{"ToString", "[", "progress", "]"}], "<>", 
               "\"\< of \>\"", "<>", 
               RowBox[{"ToString", "@", "L"}]}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}], ",", 
              "12"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Alignment", "\[Rule]", "Center"}]}], "\[IndentingNewLine]", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "output", " ", "file"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"tempDataFile", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "$TemporaryDirectory", ",", "\"\<MaXrd\>\"", ",", 
         "\"\<PixelData_InProgress.m\>\""}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"DeleteFile", "@", "tempDataFile"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Loop", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"image", "=", 
         RowBox[{
         "images", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", "image"}], ",", 
          RowBox[{"image", "=", 
           RowBox[{"Import", "@", "image"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"ImageQ", "@", "image"}]}], ",", 
          RowBox[{
           RowBox[{"progress", "++"}], ";", 
           RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"FPC$Process", "[", 
          RowBox[{
           RowBox[{
           "images", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "options"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"FPC$UpdatePixelDataFile", "[", 
         RowBox[{"tempDataFile", ",", "image", ",", "data"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"progress", "++"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "images"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "End", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newData", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"FPC$LoadPixelDataFile", "@", "dataFile"}], ",", 
        RowBox[{"Import", "@", "tempDataFile"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<UpdateDataFile\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"CreateDirectory", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DirectoryName", "@", "dataFile"}], ",", 
           RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{"dataFile", ",", "newData"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "newData"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82462343794386*^9, 3.824623462472959*^9}, {
   3.824623594880454*^9, 3.824623621469824*^9}, {3.824623652596282*^9, 
   3.824623825984915*^9}, {3.8246239096278067`*^9, 3.82462403670092*^9}, {
   3.824624084157564*^9, 3.82462411572295*^9}, {3.824624316289703*^9, 
   3.8246244857146378`*^9}, {3.824624557865745*^9, 3.8246245652765427`*^9}, {
   3.824624638828724*^9, 3.824624729271182*^9}, 3.8246249671333942`*^9, {
   3.8246250610374413`*^9, 3.8246250612654943`*^9}, {3.8246250913785048`*^9, 
   3.8246250925559072`*^9}, {3.824625128768745*^9, 3.824625132000638*^9}, {
   3.824625163511495*^9, 3.824625172162393*^9}, {3.824625208684952*^9, 
   3.8246252114802837`*^9}, {3.824625278188076*^9, 3.824625307986364*^9}, {
   3.824625528055335*^9, 3.824625538777615*^9}, {3.824626225632885*^9, 
   3.8246262263082533`*^9}, {3.824626350424768*^9, 3.824626364308844*^9}, {
   3.824626406165593*^9, 3.824626460701604*^9}, {3.824626654418415*^9, 
   3.824626661554172*^9}, {3.824626697406028*^9, 3.824626718389853*^9}, {
   3.8246267517243547`*^9, 3.824626761703583*^9}, {3.824626805767438*^9, 
   3.824626819798925*^9}, {3.824626862604327*^9, 3.824626870531557*^9}, {
   3.824626964329198*^9, 3.824626995561145*^9}, {3.824627057924707*^9, 
   3.8246272250366993`*^9}, {3.824627273299508*^9, 3.824627433801586*^9}, {
   3.824629840259576*^9, 3.824629846108986*^9}, {3.824629923009941*^9, 
   3.82462992358692*^9}, {3.8246301159463043`*^9, 3.824630125408814*^9}, {
   3.824630158195307*^9, 3.8246301637459593`*^9}, {3.8246302167280483`*^9, 
   3.824630255288044*^9}, {3.828431767442685*^9, 3.8284317797690496`*^9}, {
   3.828432050008582*^9, 3.828432051320863*^9}, {3.828432102567946*^9, 
   3.828432111245284*^9}, {3.8285867606002417`*^9, 3.828586762607375*^9}, {
   3.828586928068185*^9, 3.828586933612702*^9}, 3.828940298201776*^9},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"33f91451-5120-47e8-8980-08202e39725e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[16]:=",ExpressionUUID->"a10cd45d-e7d8-4bae-8b09-f89839768f2a"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetAtomicScatteringFactors", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.6823273339048023`*^9, 3.6823273376015463`*^9}, 3.6823289774394608`*^9, 
   3.683970210830709*^9, 3.6841265886995287`*^9, 3.719063106743903*^9, {
   3.74287932850016*^9, 
   3.7428793293897877`*^9}},ExpressionUUID->"ce497608-7634-4ce0-a45a-\
40d4d78da363"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[632]:=",ExpressionUUID->"21c8d12d-acdd-4752-9cf1-4afe2050dc5c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetAtomicScatteringFactors", "::", "source"}], "=", 
   "\"\<Invalid data source option.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAtomicScatteringFactors", "::", "missing"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is missing in data source for \
the `2`.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAtomicScatteringFactors", "::", "slRequired"}], "=", 
   "\"\<Crystal name or Sin[\[Theta]]/\[Lambda] values required.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAtomicScatteringFactors", "::", "slRange"}], "=", 
    "\"\<The value `1` \!\(\*SuperscriptBox[\(\[CapitalARing]\), \(-1\)]\) is \
out of range for the f0 source `2`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "GetAtomicScatteringFactors"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<DispersionCorrections\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<f0Source\>\"", "\[Rule]", "\"\<WaasmaierKirfel\>\""}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"\"\<f1f2Source\>\"", "\[Rule]", "\"\<CromerLiberman\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<IgnoreIonCharge\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<SeparateCorrections\>\"", "\[Rule]", "False"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "GetAtomicScatteringFactors"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685419009402873*^9, 3.685419029744906*^9}, {
   3.7125579359845037`*^9, 3.7125579398401833`*^9}, {3.712558012825982*^9, 
   3.712558016365078*^9}, {3.712558329822263*^9, 3.712558336510482*^9}, 
   3.7190631067759323`*^9, {3.7190632013232603`*^9, 3.719063246833488*^9}, {
   3.719063683402504*^9, 3.719063702743443*^9}, 3.719064421775221*^9, {
   3.719064571481073*^9, 3.7190645880804996`*^9}, 3.719081603083643*^9, {
   3.721116109499786*^9, 3.721116109669585*^9}, {3.721116270843298*^9, 
   3.721116293378092*^9}, {3.721118253561348*^9, 3.721118283400021*^9}, {
   3.7219790998464947`*^9, 3.721979108957181*^9}, {3.721979808508971*^9, 
   3.721979808678824*^9}, {3.7220628094983597`*^9, 3.722062820951103*^9}, {
   3.727243953544322*^9, 3.7272439559577703`*^9}, 3.72724401051222*^9, {
   3.7275499818549232`*^9, 3.727549987372429*^9}, {3.73530062366187*^9, 
   3.735300624212389*^9}, {3.737968443951145*^9, 3.737968443986042*^9}, {
   3.738033298568212*^9, 3.738033315017757*^9}, {3.7380336856293583`*^9, 
   3.738033688741171*^9}, {3.738033775094706*^9, 3.738033896732421*^9}, 
   3.738044095733487*^9, 3.73837483731066*^9, {3.738377190650757*^9, 
   3.738377219040332*^9}, {3.7389895484485607`*^9, 3.7389895490286427`*^9}, {
   3.73912287327794*^9, 3.739122879307662*^9}, {3.739123332751502*^9, 
   3.739123336915341*^9}, {3.742836431091338*^9, 3.742836481639064*^9}, {
   3.74283683011233*^9, 3.742836833782606*^9}, {3.742837103929655*^9, 
   3.742837111560454*^9}, {3.742837486368683*^9, 3.742837490095265*^9}, {
   3.743865850503646*^9, 3.743865850653304*^9}, {3.7567109504828167`*^9, 
   3.7567109663176193`*^9}},
 CellLabel->
  "In[633]:=",ExpressionUUID->"f854cfaa-8501-47af-8ffd-b06d678f0a87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[639]:=",ExpressionUUID->"28ff112b-882b-47b9-94a8-87906b3e98ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAtomicScatteringFactors", "[", "\[IndentingNewLine]", 
   RowBox[{
   "crystal_String", ",", "\[IndentingNewLine]", "hklInput_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"input\[Lambda]", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", "input\[Lambda]"}], ",", "hkl", ",", 
      "elements", ",", "sl", ",", "options"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Basic", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Crystal", " ", "and", " ", 
      RowBox[{"wavelength", "/", "energy"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "\"\<ProcessWavelength\>\"", ",", "crystal", ",", "\[Lambda]", ",", 
        "False"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reflection", 
       RowBox[{"(", "s", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "hklInput", ",", "\"\<WrapSingle\>\"", ",", "\"\<Integer\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Processing", " ", "elements"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"GetElements", "[", 
       RowBox[{"crystal", ",", 
        RowBox[{"\"\<Tally\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Remove", " ", "charge", " ", "of", " ", "ions"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IgnoreIonCharge\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"elements", "=", 
        RowBox[{"DeleteDuplicates", "@", "\[IndentingNewLine]", "\t", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"elements", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
            "}"}]}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "\[Lambda]"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", 
         RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"#", ".", "H", ".", "#"}], "]"}], "/", "2."}], "&"}], "/@", 
       "hkl"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Relaying", " ", "data", " ", "to", " ",
        "main", " ", "function", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
       "\[IndentingNewLine]", 
       RowBox[{"Keys", "@", 
        RowBox[{"Options", "@", "GetAtomicScatteringFactors"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"GetAtomicScatteringFactors", "[", 
      RowBox[{"elements", ",", "sl", ",", "\[Lambda]", ",", 
       RowBox[{"Sequence", "@@", "options"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.738989411700222*^9, 3.7389894703928623`*^9}, 
   3.7389895343950033`*^9, {3.739029454453026*^9, 3.739029456444997*^9}, {
   3.7390294877647667`*^9, 3.7390294956530647`*^9}, {3.739029646544499*^9, 
   3.739029646943084*^9}, {3.7390298191600237`*^9, 3.739029819507209*^9}, {
   3.7390298759303627`*^9, 3.739029876202117*^9}, {3.739029943482131*^9, 
   3.739029944952951*^9}, {3.7390304120579443`*^9, 3.739030416064248*^9}, {
   3.7390305372605953`*^9, 3.7390305987622757`*^9}, {3.739030733247385*^9, 
   3.739030855731241*^9}, {3.739067582047143*^9, 3.73906758245932*^9}, {
   3.739067624590288*^9, 3.7390676362436237`*^9}, {3.739067930645776*^9, 
   3.739067952733529*^9}, {3.739068052660912*^9, 3.739068131969618*^9}, {
   3.7390686573589497`*^9, 3.7390686762449627`*^9}, {3.739070614123968*^9, 
   3.7390706179920053`*^9}, {3.739070671409206*^9, 3.739070709350171*^9}, {
   3.7390915530140953`*^9, 3.739091562318021*^9}, {3.7390917410760517`*^9, 
   3.739091742376841*^9}, {3.73909183390029*^9, 3.739091834556602*^9}, {
   3.739092703120399*^9, 3.739092717995928*^9}, {3.739092892829237*^9, 
   3.73909291572052*^9}, {3.739093000100039*^9, 3.739093000439804*^9}, {
   3.739093050480298*^9, 3.7390930522227297`*^9}, {3.739122449036809*^9, 
   3.73912245066613*^9}, {3.739124954088542*^9, 3.739124955982615*^9}, {
   3.739126141134688*^9, 3.739126155128496*^9}, {3.7428354928371267`*^9, 
   3.742835505521462*^9}, {3.742837884031802*^9, 3.742837886711232*^9}, {
   3.7438658506946383`*^9, 3.7438658507734423`*^9}, 3.744034734712717*^9, {
   3.7595193372472153`*^9, 3.7595193379646807`*^9}, 3.762793093248846*^9, {
   3.786968327932839*^9, 3.786968329463501*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[640]:=",ExpressionUUID->"47f9540e-562f-452c-94b8-8640462c63b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAtomicScatteringFactors", "[", "\[IndentingNewLine]", 
   RowBox[{
   "inputElements_List", ",", "\[IndentingNewLine]", "inputSL_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"input\[Lambda]", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", "input\[Lambda]"}], ",", 
      RowBox[{"elements", "=", "inputElements"}], ",", 
      RowBox[{"sl", "=", "inputSL"}], ",", "\[IndentingNewLine]", "f0Source", 
      ",", "f1f2Source", ",", "$f0Local", ",", "$f1f2Local", ",", 
      "\[IndentingNewLine]", "upperLimit", ",", "ignore", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"addCorrectionsQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{
        "OptionValue", "[", "\"\<DispersionCorrections\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"separateQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<SeparateCorrections\>\"", "]"}]}]}], 
      ",", "\[IndentingNewLine]", "ipfQ", ",", "\[IndentingNewLine]", 
      "coefficients", ",", "akeys", ",", "bkeys", ",", "a", ",", "b", ",", 
      "c", ",", "\[IndentingNewLine]", "f0", ",", "corrections", ",", 
      "output", ",", "\[IndentingNewLine]", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checking", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Elements", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"elements", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<InterpretElement\>\"", ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "elements", "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "\[Lambda]"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"sl", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "sl", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"sl", ",", 
          RowBox[{
           RowBox[{"TrueQ", "@", 
            RowBox[{"Not", "@", 
             RowBox[{"Negative", "[", "#", "]"}]}]}], "&"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetAtomicScatteringFactors", "::", "slRequired"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Wavelength", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Lambda]", "\[NotEqual]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", 
         RowBox[{"InputCheck", "[", 
          RowBox[{"\"\<GetEnergyWavelength\>\"", ",", "\[Lambda]"}], 
          "]"}]}]}]}], "]"}], ";", "\t", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Data", " ", "sources"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"f0Source", "=", 
      RowBox[{"OptionValue", "[", "\"\<f0Source\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f1f2Source", "=", 
      RowBox[{"OptionValue", "[", "\"\<f1f2Source\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ignore", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<H\>\"", ",", "\"\<He\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Validating", " ", "sources"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"FileBaseName", "/@", 
            RowBox[{"FileNames", "[", 
             RowBox[{"\"\<*.m\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
                 "\[IndentingNewLine]", "\"\<AtomicScatteringFactor\>\""}], 
                "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           "f0Source"}], "]"}]}], "||", "\[IndentingNewLine]", "\t", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"FileBaseName", "/@", 
            RowBox[{"FileNames", "[", 
             RowBox[{"\"\<*.m\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
                 "\[IndentingNewLine]", "\"\<AtomicScatteringFactor\>\"", 
                 ",", "\"\<AnomalousCorrections\>\""}], "}"}], "]"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", "f1f2Source"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetAtomicScatteringFactors", "::", "source"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Useful", " ", "variables", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "specific", " ", "range", " ", "limits"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"upperLimit", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f0Source", "===", "\"\<CromerMann\>\""}], ",", "1.5", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"f0Source", "===", "\"\<InternationalTablesC(3rd)\>\""}], ",",
         "2.0", ",", "\[IndentingNewLine]", 
        RowBox[{"f0Source", "===", "\"\<WaasmaierKirfel\>\""}], ",", "6.0", 
        ",", "\[IndentingNewLine]", "True", ",", "2.5"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
         "sl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", ">", "upperLimit"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"GetAtomicScatteringFactors", "::", "slRange"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ToString", "@", "temp"}], ",", "f0Source"}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "sl"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Loading", " ", "source", " ", "for", " ", "calculating", " ", "f0"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Setup", " ", "accumulative", " ", "variable", " ", "for", " ", "the", 
       " ", "session"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AssociationQ", "@", "$f0"}]}], ",", 
       RowBox[{"$f0", "=", 
        RowBox[{"<|", "|>"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", "Check"}], " ", "if", " ", "same", " ", 
        "source", " ", "is", " ", "imported", " ", "already"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$f0", ",", "f0Source"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"$f0Local", "=", 
        RowBox[{"$f0", "[", "f0Source", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Import"}], " ", "specified", " ", "data"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"$f0Local", "=", 
         RowBox[{"Import", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
             "\[IndentingNewLine]", "\t", "\"\<AtomicScatteringFactor\>\"", 
             ",", 
             RowBox[{"f0Source", "<>", "\"\<.m\>\""}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Update", " ", "the", " ", "accumulative", " ", "variable"}],
          " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"$f0", ",", 
          RowBox[{"f0Source", "\[Rule]", "$f0Local"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "atom", " ", "types", " ", "are", " ", "found",
        " ", "in", " ", "$f0", " ", "source"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elements", ",", 
        RowBox[{"Keys", "@", "$f0Local"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetAtomicScatteringFactors", "::", "missing"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"First", "@", "temp"}], ",", 
          "\"\<non-dispersive part \
(\!\(TraditionalForm\`\*SubscriptBox[\(f\), \(0\)]\))\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculating", " ", "form", " ", 
       "factor", " ", 
       RowBox[{"(", "f0", ")"}], " ", "from", " ", "tabulated", " ", "data", 
       " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ipfQ", "=", 
      RowBox[{
       RowBox[{"Head", "@", 
        RowBox[{"First", "@", "$f0Local"}]}], "===", 
       "InterpolatingFunction"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", "Interpolation"}], " ", "data"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"sin", 
        RowBox[{
         RowBox[{"(", "\[Theta]", ")"}], "/", "\[Lambda]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ipfQ", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Non", "-", 
         RowBox[{
         "dispersive", " ", "part", " ", "of", " ", "form", " ", "factor"}]}],
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"f0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", ",", 
            RowBox[{
             RowBox[{"$f0Local", "[", "X", "]"}], "[", "s", "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"s", ",", "sl"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", "elements"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"b", ".", " ", "Coefficients"}], " ", "*)"}], 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Stored", " ", "with", " ", 
         RowBox[{"alternating", " ", "'"}], 
         RowBox[{"a", "'"}], " ", 
         RowBox[{"and", " ", "'"}], 
         RowBox[{"b", "'"}], "\[IndentingNewLine]", "\t", 
         RowBox[{"and", " ", "'"}], 
         RowBox[{"c", "'"}], " ", "last"}], " ", "*)"}], "\t\t", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"coefficients", "=", 
         RowBox[{
         "$f0Local", "\[LeftDoubleBracket]", "elements", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"akeys", ",", "bkeys"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Keys", "@", 
               RowBox[{"First", "@", "coefficients"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "~~", 
               RowBox[{"DigitCharacter", ".."}]}]}], "]"}]}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"\"\<a\>\"", ",", "\"\<b\>\""}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Values", "/@", 
            RowBox[{"coefficients", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "akeys"}], "\[RightDoubleBracket]"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Values", "/@", 
            RowBox[{"coefficients", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "bkeys"}], "\[RightDoubleBracket]"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Values", "@", 
            RowBox[{"coefficients", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "\"\<c\>\""}], "\[RightDoubleBracket]"}]}]}],
           "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Non", "-", 
          RowBox[{
          "dispersive", " ", "part", " ", "of", " ", "form", " ", 
           "factor"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"f0", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "coefficients", "]"}], 
              "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                "*", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                   "b", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "*", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    "sl", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ")"}], "2"]}], "]"}]}], "]"}], 
              "+", 
              RowBox[{
              "c", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
             "}"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "@", "sl"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "elements"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", ":", " ", 
       RowBox[{
       "Correct", " ", "normalisation", " ", "by", " ", "electrons"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"ipfQ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"$f0Local", "[", "\"\<C\>\"", "]"}], "[", "0", "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Total", "@", 
              RowBox[{"Values", "@", 
               RowBox[{"$f0Local", "\[LeftDoubleBracket]", 
                RowBox[{"\"\<C\>\"", ",", "akeys"}], 
                "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "+", 
             RowBox[{"$f0Local", "[", 
              RowBox[{"\"\<C\>\"", ",", "\"\<c\>\""}], "]"}]}]}], "]"}], "-", 
          "6"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Carbon", ":", " ", "Z"}], "=", "6"}], " ", "*)"}], "]"}], 
        ">", "0.5"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f0", "=", 
        RowBox[{"f0", "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X_String", ",", 
            RowBox[{"f_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"X", ",", 
            RowBox[{"f", "*", 
             RowBox[{"$PeriodicTable", "[", 
              RowBox[{"X", ",", "\"\<AtomicNumber\>\""}], "]"}]}]}], 
           "}"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Dispersion", " ", "corrections", " ", 
       RowBox[{"(", 
        RowBox[{"f1", " ", "+", " ", "f2"}], ")"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"No", " ", "dispersion", " ", "corrections"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Lambda]", "===", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"addCorrectionsQ", "=", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "addCorrectionsQ"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Prepare", " ", "output"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"output", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Association", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
            "f0"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Loading", " ", "source", " ", "for", " ", "calculating", " ", 
        RowBox[{"f", "'"}]}], " ", "+", " ", 
       RowBox[{"f", "''"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Setup", " ", "global", " ", "variable", " ", "for", " ", "the", " ", 
       "session"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AssociationQ", "@", "$f1f2"}]}], ",", 
       RowBox[{"$f1f2", "=", 
        RowBox[{"<|", "|>"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", "Check"}], " ", "if", " ", "same", " ", 
        "source", " ", "is", " ", "imported", " ", "already"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$f1f2", ",", "f1f2Source"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"$f1f2Local", "=", 
        RowBox[{"$f1f2", "[", "f1f2Source", "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Import"}], " ", "specified", " ", "data"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"$f1f2Local", "=", 
         RowBox[{"Import", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
             "\[IndentingNewLine]", "\t", "\"\<AtomicScatteringFactor\>\"", 
             ",", "\"\<AnomalousCorrections\>\"", ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"f1f2Source", "<>", "\"\<.m\>\""}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Update", " ", "the", " ", 
          RowBox[{"session", "'"}], "s", " ", "global", " ", "variable"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"$f1f2", ",", 
          RowBox[{"f1f2Source", "\[Rule]", "$f1f2Local"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "atom", " ", "types", " ", "are", " ", "found",
        " ", "in", " ", "$f1f2", " ", "source"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elements", ",", 
        RowBox[{"Keys", "@", "$f1f2Local"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"temp", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"ignore", "\[Rule]", "Nothing"}], "]"}]}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"ignored", " ", "elements"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetAtomicScatteringFactors", "::", "missing"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"First", "@", "temp"}], ",", 
          "\"\<dispersion corrections \
(\!\(\*FormBox[RowBox[{SuperscriptBox[\"f\", \
\"\[Prime]\",MultilineFunction->None], \"+\", SuperscriptBox[\"f\", \
\"\[Prime]\[Prime]\",MultilineFunction->None]}],TraditionalForm]\))\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Procedure", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"ignore", ",", 
            RowBox[{
            "elements", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"corrections", "=", 
         RowBox[{
          RowBox[{"$f1f2Local", "[", 
           RowBox[{
           "elements", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
            "]"}], "[", "\[Lambda]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"f0", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
          "corrections"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "sl"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "@", "elements"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "and", " ", 
       "returning", " ", "association", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"separateQ", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Return"}], " ", "f0", " ", "and", " ", 
         "f1f2", " ", "separated"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f0", "=", 
        RowBox[{"f0", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Elements", " ", "with", " ", "corrections"}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f0_", "?", "NumericQ"}], ",", 
              RowBox[{"f1f2_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"X", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<f0\>\"", "\[Rule]", "f0"}], ",", 
                RowBox[{"\"\<f1f2\>\"", "\[Rule]", "f1f2"}]}], "|>"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Without", " ", "corrections", " ", 
             RowBox[{"(", 
              RowBox[{"ignored", " ", "elements"}], ")"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f0_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"X", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<f0\>\"", "\[Rule]", "f0"}], ",", 
                RowBox[{"\"\<f1f2\>\"", "\[Rule]", "0."}]}], "|>"}]}], 
             ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Return"}], " ", "f0", " ", "and", " ", 
         "f1f2", " ", "combined"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f0", "=", 
        RowBox[{"f0", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Elements", " ", "with", " ", "corrections"}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f0_", "?", "NumericQ"}], ",", 
              RowBox[{"f1f2_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"X", "\[Rule]", 
              RowBox[{"f0", "+", "f1f2"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Without", " ", "corections", " ", 
             RowBox[{"(", 
              RowBox[{"ignored", " ", "elements"}], ")"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f0_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"X", "\[Rule]", "f0"}], ")"}]}]}], "\[IndentingNewLine]",
           "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"Association", "/@", "f0"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "output"}], "\[Equal]", "1"}], ",", 
       RowBox[{"First", "@", "output"}], ",", "output"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327825752265*^9, {3.682327891309991*^9, 3.682327908905006*^9}, {
   3.682328462663025*^9, 3.682328464594318*^9}, {3.6823288379476137`*^9, 
   3.682328840375494*^9}, {3.6823289450420847`*^9, 3.682328948786008*^9}, 
   3.682329021553924*^9, {3.682329649608305*^9, 3.682329652832589*^9}, 
   3.6823298080835743`*^9, {3.682350312716905*^9, 3.682350378410404*^9}, 
   3.6823504635691757`*^9, {3.6823505010243587`*^9, 3.682350503583688*^9}, {
   3.68235624088593*^9, 3.68235624215532*^9}, {3.6824154065363083`*^9, 
   3.682415411290797*^9}, {3.6824949312809687`*^9, 3.682494933923278*^9}, {
   3.682494968776065*^9, 3.6824950015362787`*^9}, {3.682495062367214*^9, 
   3.6824950649247932`*^9}, {3.682495113046337*^9, 3.6824951159073544`*^9}, {
   3.68249526412218*^9, 3.682495265376318*^9}, {3.68249545065454*^9, 
   3.682495470163967*^9}, {3.682495512292554*^9, 3.682495515202944*^9}, {
   3.682495556347404*^9, 3.682495579369482*^9}, {3.6824958395091257`*^9, 
   3.682495843227323*^9}, {3.6824961499028397`*^9, 3.682496152773938*^9}, {
   3.682496263451882*^9, 3.682496267049795*^9}, {3.682496312064939*^9, 
   3.6824963159122458`*^9}, {3.682496526788476*^9, 3.682496526940209*^9}, {
   3.682496864685812*^9, 3.682496866861273*^9}, {3.682496942171248*^9, 
   3.68249696514644*^9}, 3.682497201839513*^9, {3.6824972729799232`*^9, 
   3.682497296643372*^9}, {3.6824973270838213`*^9, 3.68249734521832*^9}, 
   3.68268180724885*^9, {3.684128291025429*^9, 3.684128389624958*^9}, {
   3.68412845933915*^9, 3.684128486385932*^9}, {3.684128529353738*^9, 
   3.6841285582182617`*^9}, {3.6841288206899014`*^9, 3.684128901287672*^9}, {
   3.684128968928697*^9, 3.68412900913936*^9}, {3.6841292785084352`*^9, 
   3.684129357017983*^9}, {3.684129890723934*^9, 3.684129917971912*^9}, {
   3.6841300831135187`*^9, 3.684130083432626*^9}, {3.684138321122032*^9, 
   3.684138354809764*^9}, {3.684138494851803*^9, 3.6841385035605307`*^9}, {
   3.684138540043199*^9, 3.6841385752075777`*^9}, {3.685245928608788*^9, 
   3.685245936564748*^9}, {3.685292498644186*^9, 3.685292547209746*^9}, {
   3.685293229629302*^9, 3.685293257980389*^9}, {3.6852936989464273`*^9, 
   3.685293705920918*^9}, {3.685418988387327*^9, 3.6854191059404497`*^9}, 
   3.685765928283773*^9, {3.686654834485551*^9, 3.686654890223186*^9}, {
   3.6870719114095488`*^9, 3.687071942441597*^9}, {3.687073759256621*^9, 
   3.687073768483142*^9}, {3.7125582963506203`*^9, 3.712558305396607*^9}, {
   3.712559925957469*^9, 3.712559958639057*^9}, {3.7144624028419037`*^9, 
   3.71446242110505*^9}, {3.714462795136908*^9, 3.714462796079183*^9}, {
   3.7144629484210367`*^9, 3.714462949924136*^9}, {3.7147117501417923`*^9, 
   3.714711761681143*^9}, {3.714816107140924*^9, 3.714816126138484*^9}, {
   3.717740896691929*^9, 3.7177409196728354`*^9}, {3.717952009923753*^9, 
   3.7179520150663*^9}, {3.7179522469270687`*^9, 3.717952248741308*^9}, {
   3.7179527562586317`*^9, 3.7179527571544733`*^9}, {3.718544518737887*^9, 
   3.7185445547663393`*^9}, {3.718544588671667*^9, 3.718544588764153*^9}, {
   3.7185446206531773`*^9, 3.718544630189608*^9}, {3.718544762313016*^9, 
   3.718544814550006*^9}, {3.718544854669929*^9, 3.718544932380745*^9}, {
   3.718544962436681*^9, 3.718545027673493*^9}, {3.71854509931327*^9, 
   3.718545153141809*^9}, {3.7185453205399714`*^9, 3.718545412007901*^9}, {
   3.718545450896759*^9, 3.718545474214239*^9}, {3.718545507359365*^9, 
   3.718545544238356*^9}, {3.718616920438265*^9, 3.7186169486191177`*^9}, {
   3.718618101945353*^9, 3.718618175014943*^9}, {3.71861823134766*^9, 
   3.718618233851248*^9}, {3.718618432192004*^9, 3.71861847096095*^9}, {
   3.71861933868747*^9, 3.7186193433759203`*^9}, {3.718619375509334*^9, 
   3.718619496235456*^9}, {3.718619532771413*^9, 3.718619580864337*^9}, 
   3.718619728829987*^9, {3.718630103558402*^9, 3.7186301187980003`*^9}, {
   3.7186366955384483`*^9, 3.718636713785058*^9}, {3.7186374428406067`*^9, 
   3.7186374662234697`*^9}, {3.718656479247999*^9, 3.7186564858851337`*^9}, {
   3.718983804226858*^9, 3.71898380604974*^9}, 3.719062288435821*^9, {
   3.71906310678584*^9, 3.719063106792266*^9}, {3.719064122833111*^9, 
   3.719064129919709*^9}, {3.71906420106341*^9, 3.719064259852654*^9}, {
   3.719064297563863*^9, 3.719064496821637*^9}, {3.719064545749486*^9, 
   3.719064592700036*^9}, {3.719064642354143*^9, 3.71906476771029*^9}, {
   3.719064823557804*^9, 3.719065238482019*^9}, {3.719065277135886*^9, 
   3.719065303399061*^9}, {3.719065395813827*^9, 3.719065399308429*^9}, {
   3.719065437323184*^9, 3.7190654511549473`*^9}, {3.719065561170032*^9, 
   3.719065627343844*^9}, {3.719065670965363*^9, 3.719065959082838*^9}, {
   3.719065992179327*^9, 3.719066064234557*^9}, {3.719066151894588*^9, 
   3.719066207283177*^9}, {3.719066242019342*^9, 3.719066304096162*^9}, {
   3.719066351920788*^9, 3.719066359399228*^9}, {3.71906641432609*^9, 
   3.719066542108021*^9}, {3.719066589433022*^9, 3.7190665954992647`*^9}, {
   3.719067892506781*^9, 3.71906802254603*^9}, {3.719068084604827*^9, 
   3.719068291842124*^9}, {3.719068376944273*^9, 3.71906849841955*^9}, {
   3.719069206288807*^9, 3.719069218336574*^9}, {3.71906933199855*^9, 
   3.7190693337006483`*^9}, 3.719069638219943*^9, {3.719069709698402*^9, 
   3.719069710945162*^9}, {3.719070447671543*^9, 3.719070461169828*^9}, {
   3.7190705162010508`*^9, 3.719070528918353*^9}, 3.719081605979241*^9, {
   3.721111484659971*^9, 3.721111498639818*^9}, {3.721114454508944*^9, 
   3.721114476380396*^9}, {3.721116073710249*^9, 3.721116105096229*^9}, {
   3.721116139165756*^9, 3.7211161755548077`*^9}, {3.7211162447180643`*^9, 
   3.7211162652677107`*^9}, {3.721116304117589*^9, 3.721116355056438*^9}, {
   3.721116452754876*^9, 3.721116467221505*^9}, {3.7211169325691433`*^9, 
   3.7211170058057423`*^9}, {3.721117041112558*^9, 3.7211170477626753`*^9}, {
   3.721117332499308*^9, 3.7211173675329247`*^9}, {3.7211179516387444`*^9, 
   3.721117953257985*^9}, {3.7211180826882343`*^9, 3.721118171815936*^9}, {
   3.721118217999258*^9, 3.721118247833887*^9}, 3.7211182947294817`*^9, {
   3.72111835817647*^9, 3.721118370282798*^9}, 3.721118417964911*^9, {
   3.721118679807076*^9, 3.7211188691654882`*^9}, {3.721119001756874*^9, 
   3.721119004843071*^9}, {3.7213695267756367`*^9, 3.72136952711127*^9}, {
   3.7213696067684183`*^9, 3.721369607060883*^9}, 3.721369689533557*^9, {
   3.721369757784193*^9, 3.7213698829506197`*^9}, {3.721371083758843*^9, 
   3.7213710990474377`*^9}, {3.72137113797754*^9, 3.7213711507631893`*^9}, {
   3.7213711847212*^9, 3.721371188174782*^9}, {3.721371685952198*^9, 
   3.7213717065716248`*^9}, {3.721371766390019*^9, 3.7213719755300817`*^9}, {
   3.721372756009329*^9, 3.721372949382916*^9}, {3.721470172812934*^9, 
   3.721470178730687*^9}, {3.7214702679556103`*^9, 3.72147034954385*^9}, {
   3.7216675361871223`*^9, 3.721667588792684*^9}, {3.7217381025032473`*^9, 
   3.721738163898419*^9}, {3.7217381946470137`*^9, 3.721738227941464*^9}, {
   3.721738503929742*^9, 3.721738506861105*^9}, {3.721738837218*^9, 
   3.721738838966873*^9}, {3.721738890429645*^9, 3.721738905286234*^9}, {
   3.721738943252236*^9, 3.721738999644347*^9}, {3.721739033683166*^9, 
   3.7217390375656013`*^9}, {3.72173907096627*^9, 3.721739079289625*^9}, {
   3.721739320598371*^9, 3.721739348557314*^9}, {3.721739402271968*^9, 
   3.721739404192616*^9}, {3.7217394351329517`*^9, 3.7217394636473303`*^9}, 
   3.721978061389715*^9, 3.721978138688751*^9, {3.721978206640265*^9, 
   3.721978208092898*^9}, {3.7219785079842653`*^9, 3.721978509914443*^9}, {
   3.7219785635057592`*^9, 3.721978563662822*^9}, {3.721978732407447*^9, 
   3.7219787397994967`*^9}, {3.721978918989682*^9, 3.721978976909795*^9}, {
   3.721979165739716*^9, 3.721979210741995*^9}, 3.721979597187673*^9, {
   3.7219796310100183`*^9, 3.7219796891672897`*^9}, {3.7219798180589237`*^9, 
   3.721979818654977*^9}, {3.721979861140045*^9, 3.721979863917323*^9}, {
   3.721982886145628*^9, 3.721982890654036*^9}, 3.721983004540848*^9, 
   3.7219833873520203`*^9, {3.7220628751118727`*^9, 3.722062879005816*^9}, {
   3.722062917283605*^9, 3.7220629634710503`*^9}, {3.7220630332216253`*^9, 
   3.722063111337685*^9}, {3.7220631494555893`*^9, 3.7220631950136127`*^9}, {
   3.722063245677351*^9, 3.722063245754569*^9}, {3.7220632861497726`*^9, 
   3.722063298693756*^9}, {3.722063614430664*^9, 3.7220636503987513`*^9}, {
   3.722063724542623*^9, 3.7220638054642982`*^9}, {3.722063847312479*^9, 
   3.722063959471467*^9}, {3.722064007036425*^9, 3.722064008040326*^9}, {
   3.722064091453974*^9, 3.722064098537808*^9}, {3.7220642034603243`*^9, 
   3.722064223013564*^9}, {3.7220648781494017`*^9, 3.722064899648937*^9}, {
   3.722064959884466*^9, 3.722064997021698*^9}, {3.722070723902894*^9, 
   3.7220708235593147`*^9}, {3.7220710632953033`*^9, 
   3.7220710658061457`*^9}, {3.722071129589094*^9, 3.722071146534827*^9}, {
   3.722071669280542*^9, 3.722071765901602*^9}, {3.722071822272051*^9, 
   3.722071845683749*^9}, {3.722072164516849*^9, 3.722072167780717*^9}, {
   3.722073655169406*^9, 3.7220736617514887`*^9}, 3.722073805452601*^9, {
   3.72207386943486*^9, 3.722073870941247*^9}, {3.7220740869677896`*^9, 
   3.722074234766919*^9}, {3.722074642509527*^9, 3.722074668862341*^9}, {
   3.722074757686634*^9, 3.7220747595372257`*^9}, {3.72207490374716*^9, 
   3.7220749274001503`*^9}, {3.722074961839517*^9, 3.722074971593493*^9}, {
   3.722075008921195*^9, 3.722075018780717*^9}, {3.722075215353648*^9, 
   3.7220753120849047`*^9}, {3.722076994991275*^9, 3.722077069678069*^9}, {
   3.722077195062983*^9, 3.722077243822541*^9}, 3.7220772743854513`*^9, {
   3.722243649938464*^9, 3.7222437148647757`*^9}, 3.722243761880186*^9, {
   3.72224401456736*^9, 3.7222440921223297`*^9}, {3.7222441629239063`*^9, 
   3.722244206882749*^9}, {3.72224429108885*^9, 3.722244297037649*^9}, {
   3.722244469565585*^9, 3.722244493083477*^9}, {3.722244742617938*^9, 
   3.722244829576676*^9}, {3.722244864913772*^9, 3.722244865438043*^9}, {
   3.722244904946373*^9, 3.7222449065887117`*^9}, {3.7222449569000607`*^9, 
   3.722244985152135*^9}, {3.7222450326142883`*^9, 3.722245087078844*^9}, {
   3.722245211235154*^9, 3.722245324219537*^9}, {3.722245388354319*^9, 
   3.72224546123627*^9}, {3.722245564764122*^9, 3.722245602990396*^9}, {
   3.722245650062417*^9, 3.7222458427141237`*^9}, {3.7222459236619883`*^9, 
   3.722245925999093*^9}, {3.7222459577587442`*^9, 3.722246038452992*^9}, {
   3.722246068729703*^9, 3.7222461134808683`*^9}, 3.722246197289178*^9, {
   3.722246227722828*^9, 3.722246233988699*^9}, {3.722246466996821*^9, 
   3.722246489019541*^9}, {3.7222465272614803`*^9, 3.72224653182295*^9}, {
   3.722246623496787*^9, 3.7222466492769814`*^9}, {3.722246684608173*^9, 
   3.7222467872720537`*^9}, {3.722246865247857*^9, 3.722246897929769*^9}, {
   3.725450303231864*^9, 3.725450375874055*^9}, {3.7254506754329567`*^9, 
   3.7254506760393887`*^9}, {3.725617035799721*^9, 3.725617090660178*^9}, {
   3.726561272575226*^9, 3.726561274880137*^9}, {3.727190754853161*^9, 
   3.727190758466567*^9}, 3.7272440207193537`*^9, {3.727244062854665*^9, 
   3.7272440720571413`*^9}, {3.7272441062895412`*^9, 3.7272441219715643`*^9}, 
   3.727675291335369*^9, 3.727676784440756*^9, {3.727677723074018*^9, 
   3.7276777305774937`*^9}, {3.727677842605393*^9, 3.727677842848339*^9}, 
   3.7303792902468443`*^9, 3.7303795870483294`*^9, 3.730544161219339*^9, {
   3.735300592767964*^9, 3.735300700450007*^9}, {3.7353007716396646`*^9, 
   3.735300799957919*^9}, {3.73780662301538*^9, 3.737806623155034*^9}, {
   3.73780665691374*^9, 3.737806661938918*^9}, {3.737968444012001*^9, 
   3.737968466742126*^9}, {3.738033394156886*^9, 3.738033405133856*^9}, {
   3.738033463353322*^9, 3.738033466796254*^9}, {3.7380336179612617`*^9, 
   3.738033675235551*^9}, {3.738033907923669*^9, 3.7380339474822598`*^9}, {
   3.738034499039502*^9, 3.738034829837838*^9}, {3.738042804020746*^9, 
   3.7380428243889933`*^9}, 3.738042869407331*^9, {3.738044069175473*^9, 
   3.738044075665268*^9}, {3.738044587915038*^9, 3.738044609408504*^9}, {
   3.738374849526939*^9, 3.73837486611399*^9}, {3.738375561949725*^9, 
   3.7383755788616657`*^9}, {3.738376351336351*^9, 3.73837636721344*^9}, {
   3.73837648700519*^9, 3.738376504603709*^9}, {3.7383765957531567`*^9, 
   3.738376597048367*^9}, {3.738377383380872*^9, 3.7383774119624166`*^9}, {
   3.738377483068665*^9, 3.7383775471710443`*^9}, {3.738989535573518*^9, 
   3.738989564467999*^9}, {3.7390294441931458`*^9, 3.739029452581423*^9}, 
   3.73902948487638*^9, {3.7390305195750637`*^9, 3.7390305356373043`*^9}, {
   3.739030588203383*^9, 3.739030612183899*^9}, {3.739067426454228*^9, 
   3.739067431611511*^9}, {3.739067543213336*^9, 3.73906755042027*^9}, {
   3.7390677181533937`*^9, 3.739067809999744*^9}, {3.739068246421269*^9, 
   3.739068367918603*^9}, {3.73906846077668*^9, 3.73906848789557*^9}, {
   3.7390692568568907`*^9, 3.739069262310021*^9}, {3.73907016157126*^9, 
   3.739070228128346*^9}, {3.739070266641101*^9, 3.7390703796683273`*^9}, {
   3.73907043147178*^9, 3.739070482013937*^9}, {3.739070549748425*^9, 
   3.739070581456558*^9}, 3.739070651144397*^9, {3.7390707171014223`*^9, 
   3.739070888355019*^9}, {3.739070920225849*^9, 3.7390709932279167`*^9}, {
   3.739071046423064*^9, 3.739071106867024*^9}, {3.739071139516616*^9, 
   3.739071139644754*^9}, {3.7390712048593607`*^9, 3.739071214027072*^9}, {
   3.739091844973487*^9, 3.739091848421885*^9}, {3.739118949258746*^9, 
   3.73911895237396*^9}, {3.739122084305634*^9, 3.739122107394026*^9}, {
   3.739122175929167*^9, 3.739122197093604*^9}, {3.739122277093368*^9, 
   3.7391223277430763`*^9}, {3.7391223601992397`*^9, 3.739122427148471*^9}, {
   3.739122494574834*^9, 3.739122547036766*^9}, {3.7391225967208633`*^9, 
   3.739122868703513*^9}, {3.739122942628067*^9, 3.739122960537838*^9}, {
   3.739122996377776*^9, 3.739123025222269*^9}, {3.7391232755617447`*^9, 
   3.739123311458004*^9}, {3.739123345161305*^9, 3.7391234203204117`*^9}, {
   3.739123471040163*^9, 3.7391234988332644`*^9}, {3.739123583213578*^9, 
   3.7391236164442587`*^9}, {3.739123707773747*^9, 3.739123716331357*^9}, {
   3.739123838903887*^9, 3.73912390812017*^9}, {3.7391239656894083`*^9, 
   3.7391239800613203`*^9}, {3.739124013732561*^9, 3.7391240438900843`*^9}, {
   3.739124092146432*^9, 3.739124101163595*^9}, {3.7391242703740892`*^9, 
   3.7391243138881083`*^9}, {3.7391243821879387`*^9, 3.739124431664143*^9}, {
   3.739124645162651*^9, 3.7391246482649107`*^9}, 3.742836771505156*^9, {
   3.742836807056857*^9, 3.742836816961413*^9}, {3.742836880541464*^9, 
   3.742836967507223*^9}, {3.742837040956266*^9, 3.742837078243389*^9}, {
   3.742837238855632*^9, 3.742837258821867*^9}, {3.7428373668286657`*^9, 
   3.742837429504389*^9}, {3.7428374630660954`*^9, 3.742837470649785*^9}, {
   3.7428375176544447`*^9, 3.742837519601564*^9}, {3.7428376441124363`*^9, 
   3.7428376444445887`*^9}, {3.742839789437457*^9, 3.74283982100668*^9}, {
   3.742839878580009*^9, 3.7428398869376783`*^9}, {3.7428400477123137`*^9, 
   3.742840079988522*^9}, {3.7428793564906693`*^9, 3.742879357265019*^9}, {
   3.7438654119933443`*^9, 3.743865412153145*^9}, {3.743865850854823*^9, 
   3.7438658511023407`*^9}, 3.7440347878671427`*^9, {3.758529265067565*^9, 
   3.758529328654203*^9}, {3.7585293735907288`*^9, 3.75852938658265*^9}, {
   3.7595193416703978`*^9, 3.759519341922925*^9}, 3.762793093289785*^9, {
   3.78696833908181*^9, 3.7869683491996813`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[641]:=",ExpressionUUID->"4967cd28-6976-4128-b0ee-9285d067ed54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[642]:=",ExpressionUUID->"274cc24d-fecb-44ab-9c25-feed4dd03b30"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetCrystalMetric", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.8293026231106577`*^9, 
   3.829302623823535*^9}, {3.8293027570071087`*^9, 3.829302758946487*^9}, 
   3.82930394452954*^9, 
   3.829483783750011*^9},ExpressionUUID->"04a41a43-bab0-42c7-ba0a-\
06efd718cf2f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[272]:=",ExpressionUUID->"cf5243ac-5c96-469c-8154-ab804479f35f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetCrystalMetric", "::", "InvalidCategory"}], "=", 
   "\"\<Category must be either \\\"LatticeParameters\\\" or \\\"MetricMatrix\
\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetCrystalMetric", "::", "InvalidSpace"}], "=", 
   "\"\<\\\"Space\\\" must either be \\\"Direct\\\", \\\"Reciprocal\\\" or \\\
\"Both\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetCrystalMetric", "::", "InvalidMatrix"}], "=", 
   "\"\<Input metric must be a 3\[Times]3 matrix.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetCrystalMetric", "::", "InvalidList"}], "=", 
   "\"\<Expected six numerical lattice parameters.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetCrystalMetric", "::", "InvalidAssociation"}], "=", 
   "\"\<Association expected to contain six lattice parameters with keys \
\\\"a\\\", \\\"b\\\", \\\"c\\\", \\\"\[Alpha]\\\", \\\"\[Beta]\\\" and \\\"\
\[Gamma]\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetCrystalMetric", "::", "InvalidInput"}], "=", 
    "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "GetCrystalMetric"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Category\>\"", "\[Rule]", "\"\<MetricMatrix\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Space\>\"", "\[Rule]", "\"\<Direct\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Radians\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RoundAnglesThreshold\>\"", "\[Rule]", "0.001"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "GetCrystalMetric"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.737968467400035*^9, {3.756710992038847*^9, 3.756711001818603*^9}, {
   3.759514376819886*^9, 3.759514390944339*^9}, {3.759514442752858*^9, 
   3.759514459127879*^9}, {3.7620606915941668`*^9, 3.762060716966055*^9}, {
   3.763737124837572*^9, 3.763737131186804*^9}, {3.829300211244548*^9, 
   3.829300217928252*^9}, {3.829302771514923*^9, 3.829302776632184*^9}, {
   3.829302952319541*^9, 3.829302987952648*^9}, {3.8293030304877157`*^9, 
   3.829303031633305*^9}, {3.82930327661059*^9, 3.829303302161089*^9}, {
   3.8293039445335627`*^9, 3.829303944535755*^9}, {3.8293040617743483`*^9, 
   3.829304101521532*^9}, {3.829304604525337*^9, 3.829304661234688*^9}, {
   3.829304782361739*^9, 3.8293048057294703`*^9}, {3.829304879618533*^9, 
   3.829304886535797*^9}, {3.82930505441435*^9, 3.829305065996848*^9}, {
   3.829305224429802*^9, 3.829305227855773*^9}, {3.829364019884699*^9, 
   3.829364020154853*^9}, {3.8294676949563847`*^9, 3.82946769965521*^9}, {
   3.829483715227597*^9, 3.8294837159035883`*^9}, {3.8296554628880568`*^9, 
   3.829655481752392*^9}, {3.829655649738199*^9, 3.829655650368064*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"5cce676a-3156-49d4-9a2b-deaf43477133"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[281]:=",ExpressionUUID->"4b4d4455-ea40-4cf6-add6-6459371a2e98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCrystalMetric", "[", 
   RowBox[{"userInput_", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"outputCategory", "=", 
       RowBox[{"OptionValue", "[", "\"\<Category\>\"", "]"}]}], ",", 
      RowBox[{"outputSpace", "=", 
       RowBox[{"OptionValue", "[", "\"\<Space\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "inputCategory", ",", "reciprocalInputQ", ",", 
      "\[IndentingNewLine]", "latticeParameters", ",", "outputSettings"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LatticeParameters\>\"", ",", "\"\<MetricMatrix\>\""}],
            "}"}], ",", "outputCategory"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetCrystalMetric", "::", "InvalidCategory"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Direct\>\"", ",", "\"\<Reciprocal\>\"", ",", "\"\<Both\>\""}],
            "}"}], ",", "outputSpace"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetCrystalMetric", "::", "InvalidSpace"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"latticeParameters", "=", 
      RowBox[{"GCM$ExtractLatticeParameters", "@", "userInput"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reciprocalInputQ", "=", 
      RowBox[{"AnyTrue", "[", 
       RowBox[{"latticeParameters", ",", 
        RowBox[{
         RowBox[{"CompatibleUnitQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Quantity", "[", 
            RowBox[{"1", "/", "\"\<Angstroms\>\""}], "]"}]}], "]"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"latticeParameters", "=", 
      RowBox[{
      "GCM$StandardizeLatticeParameters", "[", "\[IndentingNewLine]", 
       RowBox[{"latticeParameters", ",", "reciprocalInputQ"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"outputSettings", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<LatticeQ\>\"", "\[Rule]", 
         RowBox[{"outputCategory", "===", "\"\<LatticeParameters\>\""}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Threshold\>\"", "\[Rule]", 
         RowBox[{"OptionValue", "[", "\"\<RoundAnglesThreshold\>\"", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<ReciprocalQ\>\"", "\[Rule]", 
         RowBox[{"outputSpace", "===", "\"\<Reciprocal\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<UnitsQ\>\"", "\[Rule]", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<RadiansQ\>\"", "\[Rule]", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"OptionValue", "[", "\"\<Radians\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<OrthogonalizeQ\>\"", "\[Rule]", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"OptionValue", "[", "\"\<ToCartesian\>\"", "]"}]}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"outputSpace", "===", "\"\<Both\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"GCM$DeliverOutput", "[", 
          RowBox[{"latticeParameters", ",", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"outputSettings", ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<ReciprocalQ\>\"", "\[Rule]", "#"}]}], "]"}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"False", ",", "True"}], "}"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"GCM$DeliverOutput", "[", 
        RowBox[{"latticeParameters", ",", "outputSettings"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.73796846746421*^9, 
   3.737968467560033*^9}, 3.7595144390987997`*^9, {3.759514625711541*^9, 
   3.7595146264809847`*^9}, {3.7595146838035517`*^9, 3.759514690635151*^9}, {
   3.759514763059952*^9, 3.7595147901447783`*^9}, {3.759514834448648*^9, 
   3.759514916333564*^9}, {3.759515128606327*^9, 3.759515167675393*^9}, {
   3.7595152352855597`*^9, 3.759515258119936*^9}, {3.759515364824544*^9, 
   3.759515368332971*^9}, {3.7595162005877247`*^9, 3.759516208018134*^9}, {
   3.75951629777057*^9, 3.7595163408148623`*^9}, {3.7595163778885307`*^9, 
   3.7595164110130987`*^9}, {3.759516461214458*^9, 3.7595166165525713`*^9}, {
   3.759516755231249*^9, 3.759516812865972*^9}, {3.7595176681151123`*^9, 
   3.7595176683065777`*^9}, {3.759517707451805*^9, 3.7595177778473387`*^9}, {
   3.759517837200191*^9, 3.75951794375373*^9}, {3.759517984477271*^9, 
   3.759517993570887*^9}, {3.759518304886416*^9, 3.759518414857388*^9}, {
   3.7595184616339293`*^9, 3.75951861236721*^9}, {3.759518681333305*^9, 
   3.759518682508336*^9}, {3.759518743028657*^9, 3.7595187431700993`*^9}, {
   3.7595189639997797`*^9, 3.759519026860339*^9}, 3.762793093306291*^9, {
   3.763735307214972*^9, 3.763735323859365*^9}, {3.763735374443718*^9, 
   3.763735515015348*^9}, {3.763735604949443*^9, 3.763735656620427*^9}, {
   3.763735692571999*^9, 3.763735711779261*^9}, {3.76373583003401*^9, 
   3.763735863088757*^9}, 3.7637364222218018`*^9, {3.76373681850941*^9, 
   3.763736835699888*^9}, {3.763736867931713*^9, 3.763737064870956*^9}, {
   3.7637371143362617`*^9, 3.76373714702308*^9}, {3.7637371771275578`*^9, 
   3.763737195476788*^9}, {3.763737226101709*^9, 3.7637372706108017`*^9}, {
   3.763737354299376*^9, 3.7637373599928627`*^9}, {3.76373754326728*^9, 
   3.7637375602360563`*^9}, {3.763737729709491*^9, 3.763737798690954*^9}, {
   3.763737934208025*^9, 3.763737934479949*^9}, {3.763737983415518*^9, 
   3.7637380656281157`*^9}, {3.76373812159638*^9, 3.7637381488767967`*^9}, {
   3.7637381947641573`*^9, 3.763738196392647*^9}, {3.7637383302094927`*^9, 
   3.763738413933064*^9}, {3.7637387092258244`*^9, 3.76373871989156*^9}, {
   3.76373875447615*^9, 3.763738762634541*^9}, {3.763738807163105*^9, 
   3.763738841747683*^9}, {3.763738876556121*^9, 3.763738938990823*^9}, {
   3.76373902141601*^9, 3.763739031429598*^9}, {3.76373909330882*^9, 
   3.7637391444280043`*^9}, {3.763739181115068*^9, 3.763739232679335*^9}, {
   3.763739334310902*^9, 3.763739336179943*^9}, {3.763739446516017*^9, 
   3.763739457094846*^9}, {3.763739517785274*^9, 3.7637395232393923`*^9}, {
   3.7637395810453978`*^9, 3.7637397973451014`*^9}, {3.7637398285757513`*^9, 
   3.76373984386397*^9}, {3.763739900974869*^9, 3.763740029253831*^9}, {
   3.76374006447647*^9, 3.763740081466466*^9}, {3.763740113162266*^9, 
   3.763740113689055*^9}, {3.7637402042162123`*^9, 3.763740251805451*^9}, {
   3.763740406579955*^9, 3.763740411531116*^9}, {3.763740493971175*^9, 
   3.7637404941200867`*^9}, {3.76374056243196*^9, 3.76374057227813*^9}, {
   3.763740762043529*^9, 3.763740763160961*^9}, {3.7637408225134974`*^9, 
   3.763740822983884*^9}, 3.764957586406007*^9, {3.781598023770009*^9, 
   3.781598024960236*^9}, {3.781598282140304*^9, 3.781598343481772*^9}, {
   3.781598419937907*^9, 3.7815984233916683`*^9}, {3.781598455033387*^9, 
   3.781598518549818*^9}, {3.781598559216206*^9, 3.781598583252808*^9}, {
   3.781598613301051*^9, 3.781598694362977*^9}, {3.781598775866355*^9, 
   3.7815988788708687`*^9}, {3.7815993661732063`*^9, 3.781599394124114*^9}, {
   3.78159943845222*^9, 3.781599456218769*^9}, {3.781599577488717*^9, 
   3.781599585759841*^9}, {3.781599670952115*^9, 3.7815997144059677`*^9}, {
   3.786968049877883*^9, 3.786968051123526*^9}, {3.829300098290213*^9, 
   3.8293001000784397`*^9}, 3.829300158299266*^9, {3.829300689637033*^9, 
   3.829300879518415*^9}, 3.82930126747305*^9, {3.8293013022166843`*^9, 
   3.8293013223527603`*^9}, {3.82930142848499*^9, 3.829301436079876*^9}, {
   3.829301469291156*^9, 3.829301565421558*^9}, {3.829301606208708*^9, 
   3.829301611576733*^9}, {3.8293016416232033`*^9, 3.829301740364512*^9}, {
   3.8293028199667683`*^9, 3.829302858074114*^9}, {3.8293029329984703`*^9, 
   3.829302936579877*^9}, {3.829302997894484*^9, 3.829303066893353*^9}, {
   3.829303369670743*^9, 3.829303394540687*^9}, {3.8293034359004383`*^9, 
   3.829303529168194*^9}, {3.8293035750691767`*^9, 3.829303581190557*^9}, {
   3.829303699707815*^9, 3.829303720364944*^9}, {3.829303806499789*^9, 
   3.829303808195684*^9}, 3.829303871384306*^9, {3.82930390334405*^9, 
   3.8293039445378637`*^9}, {3.829303981455184*^9, 3.8293040565778723`*^9}, {
   3.829304105505796*^9, 3.82930411491089*^9}, {3.829304232211289*^9, 
   3.8293043275716257`*^9}, {3.829304507524486*^9, 3.829304587783533*^9}, {
   3.8293046666962023`*^9, 3.8293046678898973`*^9}, {3.82930470154191*^9, 
   3.829304754279142*^9}, {3.829304812428781*^9, 3.8293048642146463`*^9}, {
   3.8293049049109783`*^9, 3.829304915590927*^9}, {3.8293049740777483`*^9, 
   3.82930502306391*^9}, 3.8293050714474497`*^9, {3.829305191023116*^9, 
   3.829305193182929*^9}, {3.829324731718067*^9, 3.829324790829871*^9}, {
   3.829324910391863*^9, 3.829325070343267*^9}, {3.829363112738798*^9, 
   3.82936311353531*^9}, {3.8293632160254993`*^9, 3.829363229705492*^9}, {
   3.8293635155184*^9, 3.829363518693747*^9}, {3.829363555254383*^9, 
   3.829363593448433*^9}, {3.829363974580515*^9, 3.829363992149003*^9}, {
   3.829364034393001*^9, 3.82936406190694*^9}, {3.829373570341778*^9, 
   3.829373587445153*^9}, {3.829373635051536*^9, 3.8293736521428547`*^9}, {
   3.829376403996024*^9, 3.829376464222014*^9}, {3.829376551745672*^9, 
   3.829376552913776*^9}, {3.829376586948677*^9, 3.82937660365388*^9}, {
   3.8293800214700212`*^9, 3.8293800589796*^9}, 3.829380550189166*^9, {
   3.829380696081829*^9, 3.829380708737759*^9}, {3.829386376656414*^9, 
   3.82938638417586*^9}, {3.829386578513236*^9, 3.829386617059888*^9}, {
   3.8293866542771053`*^9, 3.8293866784568787`*^9}, {3.829386876276155*^9, 
   3.829386931508686*^9}, {3.829457367124856*^9, 3.829457414858489*^9}, {
   3.8294578282732143`*^9, 3.829457892469348*^9}, {3.82945900250633*^9, 
   3.829459011073886*^9}, {3.829459057579803*^9, 3.829459088949053*^9}, {
   3.829459120583506*^9, 3.82945915525939*^9}, {3.829460294784258*^9, 
   3.829460299869467*^9}, {3.829460332419499*^9, 3.8294603342597303`*^9}, {
   3.829460384840852*^9, 3.8294603851286497`*^9}, {3.8294609960081453`*^9, 
   3.8294611545411663`*^9}, {3.8294612104192*^9, 3.82946126084347*^9}, {
   3.829461574689789*^9, 3.829461645599517*^9}, {3.829461728301395*^9, 
   3.82946173681913*^9}, {3.829461828453684*^9, 3.829461828965756*^9}, {
   3.829462356820475*^9, 3.829462438014144*^9}, {3.829462486159487*^9, 
   3.829462494038417*^9}, {3.8294626306837187`*^9, 3.829462636304756*^9}, {
   3.8294630852354517`*^9, 3.829463152958663*^9}, {3.829463204309998*^9, 
   3.8294632873072*^9}, {3.829463321706894*^9, 3.829463348490913*^9}, {
   3.8294634059803667`*^9, 3.829463499729168*^9}, {3.8294636936510897`*^9, 
   3.829463710161933*^9}, {3.8294671908037577`*^9, 3.8294672070204782`*^9}, {
   3.829467414150881*^9, 3.8294674143059177`*^9}, {3.829468667254691*^9, 
   3.829468683306059*^9}, {3.829468723630272*^9, 3.829468839050561*^9}, {
   3.829469250990179*^9, 3.829469297566183*^9}, {3.829469674395145*^9, 
   3.829469690051963*^9}, {3.8294698176330347`*^9, 3.82946982255958*^9}, {
   3.8294699056024237`*^9, 3.829469956714449*^9}, {3.829470028289917*^9, 
   3.829470052118741*^9}, {3.829470159745446*^9, 3.829470164660273*^9}, {
   3.829470205465598*^9, 3.829470205628922*^9}, 3.829470258473681*^9, {
   3.8294704014670553`*^9, 3.829470412763039*^9}, {3.8294837152339973`*^9, 
   3.829483715236293*^9}, {3.829495732330559*^9, 3.829495734823403*^9}, {
   3.829655404950688*^9, 3.8296554859624643`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[282]:=",ExpressionUUID->"4ff8e84c-d336-4703-90e9-a8703717e4e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$DeliverOutput", "[", 
   RowBox[{"latticeParameters_", ",", "settings_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"settings", "[", "\"\<LatticeQ\>\"", "]"}], ",", 
      "\[IndentingNewLine]", "GCM$DeliverLatticeParameterOutput", ",", 
      "\[IndentingNewLine]", "GCM$DeliverMetricMatrixOutput"}], "]"}], "[", 
    RowBox[{"latticeParameters", ",", "settings"}], "]"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829462677335065*^9, 3.829462956393991*^9}, {
  3.8294629921675863`*^9, 3.829463076758236*^9}, {3.829467801923867*^9, 
  3.829467823973534*^9}, {3.829467863142993*^9, 3.829467877878818*^9}, {
  3.829468008515428*^9, 3.829468037944085*^9}, {3.829468225927374*^9, 
  3.829468237434434*^9}, {3.829469352517949*^9, 3.829469420904505*^9}, {
  3.8294694579272537`*^9, 3.829469540657599*^9}, {3.829469748829134*^9, 
  3.829469804357545*^9}, {3.829470182016231*^9, 3.829470193332243*^9}, {
  3.8294702761755123`*^9, 3.829470295632271*^9}, {3.8294704342399607`*^9, 
  3.829470440672687*^9}, {3.829495735853649*^9, 3.8294957371777887`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[283]:=",ExpressionUUID->"4b771d54-16ad-40c9-a9ea-0eee964ff0c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$DeliverLatticeParameterOutput", "[", 
   RowBox[{"latticeParameters_", ",", "settings_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "=", "latticeParameters"}], ",", "\[Delta]", ",", 
      "reciprocalQ", ",", "unitsQ", ",", "radiansQ"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Delta]", ",", "reciprocalQ", ",", "unitsQ", ",", "radiansQ"}], 
       "}"}], "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"settings", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Threshold\>\"", ",", "\"\<ReciprocalQ\>\"", ",", 
          "\"\<UnitsQ\>\"", ",", "\"\<RadiansQ\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"reciprocalQ", ",", 
       RowBox[{"output", "=", 
        RowBox[{"GCM$FlipLatticeParameters", "@", "output"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"GCM$RoundAngles", "[", 
       RowBox[{"output", ",", "\[Delta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"unitsQ", ",", 
       RowBox[{"output", "=", 
        RowBox[{"GCM$ApplyUnitsList", "[", 
         RowBox[{"output", ",", "reciprocalQ"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"radiansQ", ",", 
       RowBox[{
        RowBox[{"output", "\[LeftDoubleBracket]", 
         RowBox[{"4", ";;", "6"}], "\[RightDoubleBracket]"}], "*=", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "output"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829462677335065*^9, 3.829462956393991*^9}, {
  3.8294629921675863`*^9, 3.829463076758236*^9}, {3.829467801923867*^9, 
  3.829467823973534*^9}, {3.829467863142993*^9, 3.829467877878818*^9}, {
  3.829468008515428*^9, 3.829468037944085*^9}, {3.829468225927374*^9, 
  3.829468237434434*^9}, {3.829469352517949*^9, 3.829469420904505*^9}, {
  3.8294694579272537`*^9, 3.829469540657599*^9}, {3.82947045332906*^9, 
  3.8294704828725023`*^9}, {3.829495737687511*^9, 3.829495740090231*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[284]:=",ExpressionUUID->"7364ab7e-4944-4fb6-abc9-3684f9fa3d52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$DeliverMetricMatrixOutput", "[", 
   RowBox[{"latticeParameters_", ",", "settings_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "=", "latticeParameters"}], ",", "reciprocalQ", ",", 
      "unitsQ", ",", "orthogonalizeQ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reciprocalQ", ",", "unitsQ", ",", "orthogonalizeQ"}], "}"}], 
      "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"settings", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<ReciprocalQ\>\"", ",", "\"\<UnitsQ\>\"", ",", 
          "\"\<OrthogonalizeQ\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"GCM$MakeMetricFromLatticeParameters", "@", "output"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"reciprocalQ", ",", 
       RowBox[{"output", "=", 
        RowBox[{"Inverse", "@", "output"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"unitsQ", ",", 
       RowBox[{"output", "=", 
        RowBox[{"GCM$ApplyUnitsMatrix", "[", 
         RowBox[{"output", ",", "reciprocalQ"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"orthogonalizeQ", ",", 
       RowBox[{"output", "=", 
        RowBox[{"CholeskyDecomposition", "@", "output"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829462677335065*^9, 3.829462956393991*^9}, {
  3.8294629921675863`*^9, 3.829463076758236*^9}, {3.829467801923867*^9, 
  3.829467823973534*^9}, {3.829467863142993*^9, 3.829467877878818*^9}, {
  3.829468008515428*^9, 3.829468037944085*^9}, {3.829468162113006*^9, 
  3.829468185879871*^9}, {3.82946822033722*^9, 3.8294682616193666`*^9}, {
  3.829469555361401*^9, 3.829469616486815*^9}, {3.8294703172393293`*^9, 
  3.829470366300042*^9}, {3.8294704856503963`*^9, 3.82947051275263*^9}, {
  3.829470549571623*^9, 3.829470607107449*^9}, {3.829495741528576*^9, 
  3.829495742759262*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[285]:=",ExpressionUUID->"ab40b46e-dec9-4537-9d5d-01e287a1d6cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GCM$ExtractLatticeParameters", "[", "userInput_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "temp", "}"}], ",", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "userInput", ",", "\[IndentingNewLine]", "_String", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<CrystalQ\>\"", ",", "userInput"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GCM$ExtractLatticeParameters", "@", 
         RowBox[{"$CrystalData", "[", 
          RowBox[{"userInput", ",", "\"\<LatticeParameters\>\""}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
            RowBox[{"Dimensions", "[", "userInput", "]"}], "===", 
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"GetCrystalMetric", "::", "InvalidMatrix"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"GCM$MakeLatticeParametersFromMetric", "@", "userInput"}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_Association", ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"userInput", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", 
             "\"\<\[Alpha]\>\"", ",", "\"\<\[Beta]\>\"", ",", 
             "\"\<\[Gamma]\>\""}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{"temp", ",", "MissingQ"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"GetCrystalMetric", "::", "InvalidAssociation"}], "]"}], 
           ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "temp"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_List",
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{"AllTrue", "[", 
             RowBox[{"userInput", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"NumericQ", "[", "#", "]"}], "||", 
                RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], "||", 
           RowBox[{
            RowBox[{"Length", "[", "userInput", "]"}], "\[NotEqual]", "6"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"GetCrystalMetric", "::", "InvalidList"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "userInput"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "_", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetCrystalMetric", "::", "InvalidInput"}], ",", 
          "userInput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82936333103767*^9, 3.829363398470859*^9}, 
   3.8294593166427193`*^9, {3.829459380051065*^9, 3.829459427546936*^9}, {
   3.829463645699288*^9, 3.829463646015271*^9}, {3.829463757258629*^9, 
   3.8294637822092257`*^9}, {3.829483698112355*^9, 3.829483715240263*^9}, {
   3.8303447250612717`*^9, 3.830344738167624*^9}, {3.830344830050962*^9, 
   3.830344835460709*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[286]:=",ExpressionUUID->"98325794-a260-4f2e-b78b-d84c46481ea5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "GCM$MakeMetricFromLatticeParameters", "[", "latticeParameters_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
      "\[Gamma]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
        "\[Gamma]"}], "}"}], "=", "latticeParameters"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], "*=", 
      RowBox[{"\[Pi]", "/", "180"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"N", "@", 
      RowBox[{"Chop", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["a", "2"], ",", 
           RowBox[{"a", "*", "b", "*", 
            RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], ",", 
           RowBox[{"a", "*", "c", "*", 
            RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "*", "b", "*", 
            RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], ",", 
           SuperscriptBox["b", "2"], ",", 
           RowBox[{"b", "*", "c", "*", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "*", "c", "*", 
            RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
           RowBox[{"b", "*", "c", "*", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
           SuperscriptBox["c", "2"]}], "}"}]}], "}"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.73796846746421*^9, 
   3.737968467560033*^9}, 3.7595144390987997`*^9, {3.759514625711541*^9, 
   3.7595146264809847`*^9}, {3.7595146838035517`*^9, 3.759514690635151*^9}, {
   3.759514763059952*^9, 3.7595147901447783`*^9}, {3.759514834448648*^9, 
   3.759514916333564*^9}, {3.759515128606327*^9, 3.759515167675393*^9}, {
   3.7595152352855597`*^9, 3.759515258119936*^9}, {3.759515364824544*^9, 
   3.759515368332971*^9}, {3.7595162005877247`*^9, 3.759516208018134*^9}, {
   3.75951629777057*^9, 3.7595163408148623`*^9}, {3.7595163778885307`*^9, 
   3.7595164110130987`*^9}, {3.759516461214458*^9, 3.7595166165525713`*^9}, {
   3.759516755231249*^9, 3.759516812865972*^9}, {3.7595176681151123`*^9, 
   3.7595176683065777`*^9}, {3.759517707451805*^9, 3.7595177778473387`*^9}, {
   3.759517837200191*^9, 3.75951794375373*^9}, {3.759517984477271*^9, 
   3.759517993570887*^9}, {3.759518304886416*^9, 3.759518414857388*^9}, {
   3.7595184616339293`*^9, 3.75951861236721*^9}, {3.759518681333305*^9, 
   3.759518682508336*^9}, {3.759518743028657*^9, 3.7595187431700993`*^9}, {
   3.7595189639997797`*^9, 3.759519026860339*^9}, 3.762793093306291*^9, {
   3.763735307214972*^9, 3.763735323859365*^9}, {3.763735374443718*^9, 
   3.763735515015348*^9}, {3.763735604949443*^9, 3.763735656620427*^9}, {
   3.763735692571999*^9, 3.763735711779261*^9}, {3.76373583003401*^9, 
   3.763735863088757*^9}, 3.7637364222218018`*^9, {3.76373681850941*^9, 
   3.763736835699888*^9}, {3.763736867931713*^9, 3.763737064870956*^9}, {
   3.7637371143362617`*^9, 3.76373714702308*^9}, {3.7637371771275578`*^9, 
   3.763737195476788*^9}, {3.763737226101709*^9, 3.7637372706108017`*^9}, {
   3.763737354299376*^9, 3.7637373599928627`*^9}, {3.76373754326728*^9, 
   3.7637375602360563`*^9}, {3.763737729709491*^9, 3.763737798690954*^9}, {
   3.763737934208025*^9, 3.763737934479949*^9}, {3.763737983415518*^9, 
   3.7637380656281157`*^9}, {3.76373812159638*^9, 3.7637381488767967`*^9}, {
   3.7637381947641573`*^9, 3.763738196392647*^9}, {3.7637383302094927`*^9, 
   3.763738413933064*^9}, {3.7637387092258244`*^9, 3.76373871989156*^9}, {
   3.76373875447615*^9, 3.763738762634541*^9}, {3.763738807163105*^9, 
   3.763738841747683*^9}, {3.763738876556121*^9, 3.763738938990823*^9}, {
   3.76373902141601*^9, 3.763739031429598*^9}, {3.76373909330882*^9, 
   3.7637391444280043`*^9}, {3.763739181115068*^9, 3.763739232679335*^9}, {
   3.763739334310902*^9, 3.763739336179943*^9}, {3.763739446516017*^9, 
   3.763739457094846*^9}, {3.763739517785274*^9, 3.7637395232393923`*^9}, {
   3.7637395810453978`*^9, 3.7637397973451014`*^9}, {3.7637398285757513`*^9, 
   3.76373984386397*^9}, {3.763739900974869*^9, 3.763740029253831*^9}, {
   3.76374006447647*^9, 3.763740081466466*^9}, {3.763740113162266*^9, 
   3.763740113689055*^9}, {3.7637402042162123`*^9, 3.763740251805451*^9}, {
   3.763740406579955*^9, 3.763740411531116*^9}, {3.763740493971175*^9, 
   3.7637404941200867`*^9}, {3.76374056243196*^9, 3.76374057227813*^9}, {
   3.763740762043529*^9, 3.763740763160961*^9}, {3.7637408225134974`*^9, 
   3.763740822983884*^9}, 3.764957586406007*^9, {3.781598023770009*^9, 
   3.781598024960236*^9}, {3.781598282140304*^9, 3.781598343481772*^9}, {
   3.781598419937907*^9, 3.7815984233916683`*^9}, {3.781598455033387*^9, 
   3.781598518549818*^9}, {3.781598559216206*^9, 3.781598583252808*^9}, {
   3.781598613301051*^9, 3.781598694362977*^9}, {3.781598775866355*^9, 
   3.7815988788708687`*^9}, {3.7815993661732063`*^9, 3.781599394124114*^9}, {
   3.78159943845222*^9, 3.781599456218769*^9}, {3.781599577488717*^9, 
   3.781599585759841*^9}, {3.781599670952115*^9, 3.7815997144059677`*^9}, {
   3.786968049877883*^9, 3.786968051123526*^9}, {3.829300098290213*^9, 
   3.8293001000784397`*^9}, 3.829300158299266*^9, 3.829300293011322*^9, {
   3.829300426385214*^9, 3.82930058340714*^9}, {3.8293006398558903`*^9, 
   3.829300674923359*^9}, {3.829303082964505*^9, 3.829303084095482*^9}, 
   3.8293041650768137`*^9, {3.8294594766879883`*^9, 3.829459480671301*^9}, {
   3.829460771786022*^9, 3.82946090217877*^9}, 3.8294836981144657`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[287]:=",ExpressionUUID->"d22c44cc-5906-4635-b87a-10c034555f85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$MakeLatticeParametersFromMetric", "[", "matrix_", "]"}], ":=", 
  
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
      "\[Gamma]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Diagonal", "@", "matrix"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"matrix", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "/", 
         RowBox[{"(", 
          RowBox[{"b", "*", "c"}], ")"}]}], "]"}], "/", "Degree"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"matrix", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "/", 
         RowBox[{"(", 
          RowBox[{"a", "*", "c"}], ")"}]}], "]"}], "/", "Degree"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", "=", 
      RowBox[{
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"matrix", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/", 
         RowBox[{"(", 
          RowBox[{"a", "*", "b"}], ")"}]}], "]"}], "/", "Degree"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
       "\[Gamma]"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.73796846746421*^9, 
   3.737968467560033*^9}, 3.7595144390987997`*^9, {3.759514625711541*^9, 
   3.7595146264809847`*^9}, {3.7595146838035517`*^9, 3.759514690635151*^9}, {
   3.759514763059952*^9, 3.7595147901447783`*^9}, {3.759514834448648*^9, 
   3.759514916333564*^9}, {3.759515128606327*^9, 3.759515167675393*^9}, {
   3.7595152352855597`*^9, 3.759515258119936*^9}, {3.759515364824544*^9, 
   3.759515368332971*^9}, {3.7595162005877247`*^9, 3.759516208018134*^9}, {
   3.75951629777057*^9, 3.7595163408148623`*^9}, {3.7595163778885307`*^9, 
   3.7595164110130987`*^9}, {3.759516461214458*^9, 3.7595166165525713`*^9}, {
   3.759516755231249*^9, 3.759516812865972*^9}, {3.7595176681151123`*^9, 
   3.7595176683065777`*^9}, {3.759517707451805*^9, 3.7595177778473387`*^9}, {
   3.759517837200191*^9, 3.75951794375373*^9}, {3.759517984477271*^9, 
   3.759517993570887*^9}, {3.759518304886416*^9, 3.759518414857388*^9}, {
   3.7595184616339293`*^9, 3.75951861236721*^9}, {3.759518681333305*^9, 
   3.759518682508336*^9}, {3.759518743028657*^9, 3.7595187431700993`*^9}, {
   3.7595189639997797`*^9, 3.759519026860339*^9}, 3.762793093306291*^9, {
   3.763735307214972*^9, 3.763735323859365*^9}, {3.763735374443718*^9, 
   3.763735515015348*^9}, {3.763735604949443*^9, 3.763735656620427*^9}, {
   3.763735692571999*^9, 3.763735711779261*^9}, {3.76373583003401*^9, 
   3.763735863088757*^9}, 3.7637364222218018`*^9, {3.76373681850941*^9, 
   3.763736835699888*^9}, {3.763736867931713*^9, 3.763737064870956*^9}, {
   3.7637371143362617`*^9, 3.76373714702308*^9}, {3.7637371771275578`*^9, 
   3.763737195476788*^9}, {3.763737226101709*^9, 3.7637372706108017`*^9}, {
   3.763737354299376*^9, 3.7637373599928627`*^9}, {3.76373754326728*^9, 
   3.7637375602360563`*^9}, {3.763737729709491*^9, 3.763737798690954*^9}, {
   3.763737934208025*^9, 3.763737934479949*^9}, {3.763737983415518*^9, 
   3.7637380656281157`*^9}, {3.76373812159638*^9, 3.7637381488767967`*^9}, {
   3.7637381947641573`*^9, 3.763738196392647*^9}, {3.7637383302094927`*^9, 
   3.763738413933064*^9}, {3.7637387092258244`*^9, 3.76373871989156*^9}, {
   3.76373875447615*^9, 3.763738762634541*^9}, {3.763738807163105*^9, 
   3.763738841747683*^9}, {3.763738876556121*^9, 3.763738938990823*^9}, {
   3.76373902141601*^9, 3.763739031429598*^9}, {3.76373909330882*^9, 
   3.7637391444280043`*^9}, {3.763739181115068*^9, 3.763739232679335*^9}, {
   3.763739334310902*^9, 3.763739336179943*^9}, {3.763739446516017*^9, 
   3.763739457094846*^9}, {3.763739517785274*^9, 3.7637395232393923`*^9}, {
   3.7637395810453978`*^9, 3.7637397973451014`*^9}, {3.7637398285757513`*^9, 
   3.76373984386397*^9}, {3.763739900974869*^9, 3.763740029253831*^9}, {
   3.76374006447647*^9, 3.763740081466466*^9}, {3.763740113162266*^9, 
   3.763740113689055*^9}, {3.7637402042162123`*^9, 3.763740251805451*^9}, {
   3.763740406579955*^9, 3.763740411531116*^9}, {3.763740493971175*^9, 
   3.7637404941200867`*^9}, {3.76374056243196*^9, 3.76374057227813*^9}, {
   3.763740762043529*^9, 3.763740763160961*^9}, {3.7637408225134974`*^9, 
   3.763740822983884*^9}, 3.764957586406007*^9, {3.781598023770009*^9, 
   3.781598024960236*^9}, {3.781598282140304*^9, 3.781598343481772*^9}, {
   3.781598419937907*^9, 3.7815984233916683`*^9}, {3.781598455033387*^9, 
   3.781598518549818*^9}, {3.781598559216206*^9, 3.781598583252808*^9}, {
   3.781598613301051*^9, 3.781598694362977*^9}, {3.781598775866355*^9, 
   3.7815988788708687`*^9}, {3.7815993661732063`*^9, 3.781599394124114*^9}, {
   3.78159943845222*^9, 3.781599456218769*^9}, {3.781599577488717*^9, 
   3.781599585759841*^9}, {3.781599670952115*^9, 3.7815997144059677`*^9}, {
   3.786968049877883*^9, 3.786968051123526*^9}, {3.829300098290213*^9, 
   3.8293001000784397`*^9}, 3.829300158299266*^9, 3.829300293011322*^9, {
   3.829300426385214*^9, 3.82930058340714*^9}, {3.8293006398558903`*^9, 
   3.829300674923359*^9}, {3.829303082964505*^9, 3.829303084095482*^9}, {
   3.829304136585977*^9, 3.829304187324222*^9}, {3.829376447131809*^9, 
   3.829376448714078*^9}, 3.829483698116271*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[288]:=",ExpressionUUID->"887a4611-b492-424c-9198-3e0e94dda306"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$StandardizeLatticeParameters", "[", 
   RowBox[{"latticeParameters_List", ",", 
    RowBox[{"reciprocalQ_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cell", "=", "latticeParameters"}], ",", "lengths", ",", 
      "angles"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lengths", ",", "angles"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"cell", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", 
         RowBox[{"4", ";;", "6"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lengths", "=", 
      RowBox[{"lengths", "/.", 
       RowBox[{"q_Quantity", "\[RuleDelayed]", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{"q", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"TrueQ", "@", "reciprocalQ"}], ",", "\[IndentingNewLine]", 
            RowBox[{"1", "/", "\"\<Angstroms\>\""}], ",", 
            "\"\<Angstroms\>\""}], "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angles", "=", 
      RowBox[{"angles", "/.", 
       RowBox[{"q_Quantity", "\[RuleDelayed]", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{"q", ",", "\"\<Degrees\>\""}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cell", "=", 
      RowBox[{"N", "@", 
       RowBox[{"QuantityMagnitude", "[", 
        RowBox[{"Join", "@@", 
         RowBox[{"{", 
          RowBox[{"lengths", ",", "angles"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", "reciprocalQ"}], ",", 
       RowBox[{"cell", "=", 
        RowBox[{"GCM$FlipLatticeParameters", "@", "cell"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "cell"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.73796846746421*^9, 
   3.737968467560033*^9}, 3.7595144390987997`*^9, {3.759514625711541*^9, 
   3.7595146264809847`*^9}, {3.7595146838035517`*^9, 3.759514690635151*^9}, {
   3.759514763059952*^9, 3.7595147901447783`*^9}, {3.759514834448648*^9, 
   3.759514916333564*^9}, {3.759515128606327*^9, 3.759515167675393*^9}, {
   3.7595152352855597`*^9, 3.759515258119936*^9}, {3.759515364824544*^9, 
   3.759515368332971*^9}, {3.7595162005877247`*^9, 3.759516208018134*^9}, {
   3.75951629777057*^9, 3.7595163408148623`*^9}, {3.7595163778885307`*^9, 
   3.7595164110130987`*^9}, {3.759516461214458*^9, 3.7595166165525713`*^9}, {
   3.759516755231249*^9, 3.759516812865972*^9}, {3.7595176681151123`*^9, 
   3.7595176683065777`*^9}, {3.759517707451805*^9, 3.7595177778473387`*^9}, {
   3.759517837200191*^9, 3.75951794375373*^9}, {3.759517984477271*^9, 
   3.759517993570887*^9}, {3.759518304886416*^9, 3.759518414857388*^9}, {
   3.7595184616339293`*^9, 3.75951861236721*^9}, {3.759518681333305*^9, 
   3.759518682508336*^9}, {3.759518743028657*^9, 3.7595187431700993`*^9}, {
   3.7595189639997797`*^9, 3.759519026860339*^9}, 3.762793093306291*^9, {
   3.763735307214972*^9, 3.763735323859365*^9}, {3.763735374443718*^9, 
   3.763735515015348*^9}, {3.763735604949443*^9, 3.763735656620427*^9}, {
   3.763735692571999*^9, 3.763735711779261*^9}, {3.76373583003401*^9, 
   3.763735863088757*^9}, 3.7637364222218018`*^9, {3.76373681850941*^9, 
   3.763736835699888*^9}, {3.763736867931713*^9, 3.763737064870956*^9}, {
   3.7637371143362617`*^9, 3.76373714702308*^9}, {3.7637371771275578`*^9, 
   3.763737195476788*^9}, {3.763737226101709*^9, 3.7637372706108017`*^9}, {
   3.763737354299376*^9, 3.7637373599928627`*^9}, {3.76373754326728*^9, 
   3.7637375602360563`*^9}, {3.763737729709491*^9, 3.763737798690954*^9}, {
   3.763737934208025*^9, 3.763737934479949*^9}, {3.763737983415518*^9, 
   3.7637380656281157`*^9}, {3.76373812159638*^9, 3.7637381488767967`*^9}, {
   3.7637381947641573`*^9, 3.763738196392647*^9}, {3.7637383302094927`*^9, 
   3.763738413933064*^9}, {3.7637387092258244`*^9, 3.76373871989156*^9}, {
   3.76373875447615*^9, 3.763738762634541*^9}, {3.763738807163105*^9, 
   3.763738841747683*^9}, {3.763738876556121*^9, 3.763738938990823*^9}, {
   3.76373902141601*^9, 3.763739031429598*^9}, {3.76373909330882*^9, 
   3.7637391444280043`*^9}, {3.763739181115068*^9, 3.763739232679335*^9}, {
   3.763739334310902*^9, 3.763739336179943*^9}, {3.763739446516017*^9, 
   3.763739457094846*^9}, {3.763739517785274*^9, 3.7637395232393923`*^9}, {
   3.7637395810453978`*^9, 3.7637397973451014`*^9}, {3.7637398285757513`*^9, 
   3.76373984386397*^9}, {3.763739900974869*^9, 3.763740029253831*^9}, {
   3.76374006447647*^9, 3.763740081466466*^9}, {3.763740113162266*^9, 
   3.763740113689055*^9}, {3.7637402042162123`*^9, 3.763740251805451*^9}, {
   3.763740406579955*^9, 3.763740411531116*^9}, {3.763740493971175*^9, 
   3.7637404941200867`*^9}, {3.76374056243196*^9, 3.76374057227813*^9}, {
   3.763740762043529*^9, 3.763740763160961*^9}, {3.7637408225134974`*^9, 
   3.763740822983884*^9}, 3.764957586406007*^9, {3.781598023770009*^9, 
   3.781598024960236*^9}, {3.781598282140304*^9, 3.781598343481772*^9}, {
   3.781598419937907*^9, 3.7815984233916683`*^9}, {3.781598455033387*^9, 
   3.781598518549818*^9}, {3.781598559216206*^9, 3.781598583252808*^9}, {
   3.781598613301051*^9, 3.781598694362977*^9}, {3.781598775866355*^9, 
   3.7815988788708687`*^9}, {3.7815993661732063`*^9, 3.781599394124114*^9}, {
   3.78159943845222*^9, 3.781599456218769*^9}, {3.781599577488717*^9, 
   3.781599585759841*^9}, {3.781599670952115*^9, 3.7815997144059677`*^9}, {
   3.786968049877883*^9, 3.786968051123526*^9}, {3.829300098290213*^9, 
   3.8293001000784397`*^9}, 3.829300158299266*^9, 3.829300293011322*^9, {
   3.829300426385214*^9, 3.82930058340714*^9}, {3.8293006398558903`*^9, 
   3.829300674923359*^9}, {3.829303082964505*^9, 3.829303084095482*^9}, {
   3.829304136585977*^9, 3.829304187324222*^9}, {3.829304363143013*^9, 
   3.829304391664052*^9}, {3.829363775367573*^9, 3.829363800116502*^9}, {
   3.829369024027823*^9, 3.8293690764163303`*^9}, {3.829369189315782*^9, 
   3.829369202052966*^9}, {3.829373485191098*^9, 3.8293735263563347`*^9}, {
   3.829386505752795*^9, 3.829386559619773*^9}, {3.829457255123455*^9, 
   3.829457305529911*^9}, {3.8294672816779346`*^9, 3.8294672855238457`*^9}, {
   3.829467331875564*^9, 3.829467333344322*^9}, {3.8294836981180696`*^9, 
   3.829483698118939*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[289]:=",ExpressionUUID->"3142ba3c-df4e-4e15-be42-795ead41a1a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$RoundAngles", "[", 
   RowBox[{"cell_List", ",", "threshold_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"temp", "=", "cell"}], ",", "fr"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"fr", "=", 
         RowBox[{"FractionalPart", "@", 
          RowBox[{
          "temp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fr", ">", "0.5"}], ",", 
          RowBox[{"fr", "=", 
           RowBox[{"1", "-", "fr"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fr", "\[LessEqual]", "threshold"}], ",", 
          RowBox[{
           RowBox[{
           "temp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Round", "@", 
            RowBox[{
            "temp", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4", ",", "6"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "temp"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82938326516136*^9, 3.8293833416780376`*^9}, 
   3.82938381651091*^9, {3.829386397339683*^9, 3.8293864028506813`*^9}, 
   3.829483698120419*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[290]:=",ExpressionUUID->"42588147-1750-4b0a-8ace-79ccc603dee5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$ApplyUnitsList", "[", 
   RowBox[{"cell_", ",", 
    RowBox[{"reciprocalQ_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Quantity", "[", 
     RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
   RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"cell", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "#1", ",", "#1", ",", "#1", ",", "#2", ",", "#2", ",", "#2"}], "}"}],
         "&"}], "@@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TrueQ", "@", "reciprocalQ"}], ",", 
           RowBox[{"1", "/", "\"\<Angstroms\>\""}], ",", 
           "\"\<Angstroms\>\""}], "]"}], ",", "\"\<Degrees\>\""}], "}"}]}]}], 
     "}"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829363909169589*^9, 3.829363914883003*^9}, 
   3.829380746577376*^9, {3.829381118169898*^9, 3.829381132067706*^9}, {
   3.829383834364353*^9, 3.829383952103496*^9}, {3.829383998887149*^9, 
   3.829384074856642*^9}, {3.829461505782133*^9, 3.829461549984158*^9}, 
   3.829483698121871*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[291]:=",ExpressionUUID->"7b16ec35-71d8-4484-92cf-821053ec4be6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$ApplyUnitsMatrix", "[", 
   RowBox[{"metric_", ",", 
    RowBox[{"reciprocalQ_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Quantity", "[", 
   RowBox[{"metric", ",", 
    RowBox[{"Evaluate", "@", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TrueQ", "@", "reciprocalQ"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"\"\<Angstroms\>\"", "^", "2"}]}], ",", 
       RowBox[{"\"\<Angstroms\>\"", "^", "2"}]}], "]"}]}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.829363909169589*^9, 3.829363914883003*^9}, 
   3.829380746577376*^9, {3.829381118169898*^9, 3.829381132067706*^9}, {
   3.829383834364353*^9, 3.829383952103496*^9}, {3.829383998887149*^9, 
   3.829384074856642*^9}, {3.829461505782133*^9, 3.829461549984158*^9}, {
   3.8294618619824047`*^9, 3.8294618678280907`*^9}, {3.8294620292409353`*^9, 
   3.829462054082436*^9}, {3.829462124057104*^9, 3.829462275622712*^9}, 
   3.829483698123266*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[292]:=",ExpressionUUID->"d418a3ce-62f7-43c7-a910-378b29c2afb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GCM$FlipLatticeParameters", "[", "latticeParameters_List", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "metric", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"metric", "=", 
      RowBox[{
      "GCM$MakeMetricFromLatticeParameters", "@", "latticeParameters"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"GCM$MakeLatticeParametersFromMetric", "@", 
      RowBox[{"Inverse", "@", "metric"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829384536022561*^9, 3.8293845475591707`*^9}, {
   3.8293863024604273`*^9, 3.8293863537545433`*^9}, 3.8294605568592253`*^9, {
   3.8294606785609837`*^9, 3.829460683070484*^9}, {3.8294609214952393`*^9, 
   3.829460921659889*^9}, {3.829483698124606*^9, 3.8294836981256113`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[293]:=",ExpressionUUID->"f1a7bdf4-7aa8-4de3-b51f-efc578c88659"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[294]:=",ExpressionUUID->"a6653335-459e-4d11-adf7-d20c0acaeb7e"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetElements", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, 
   3.717739586397138*^9},ExpressionUUID->"88c4de5a-4949-4b68-97ca-\
4759909bd9bf"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[651]:=",ExpressionUUID->"38c1c577-79e2-4841-b88b-708f6fd6e513"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetElements", "::", "InvalidFormula"}], "=", 
   "\"\<Invalid chemical formula.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetElements", "::", "InvalidElements"}], "=", 
    "\"\<Invalid elements detected: `1`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "GetElements"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<IgnoreIonCharge\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Tally\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"GetElements", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "GetElements"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719174557698147*^9, 3.719174575089182*^9}, 
   3.7272440207601767`*^9, {3.735028184066166*^9, 3.735028195898958*^9}, {
   3.735028314418393*^9, 3.7350283221953506`*^9}, {3.756711191744135*^9, 
   3.756711197701984*^9}, {3.761729420079978*^9, 3.761729420357827*^9}, {
   3.785688061057519*^9, 3.785688068304034*^9}, {3.785688099776156*^9, 
   3.7856881015857267`*^9}},
 CellLabel->
  "In[652]:=",ExpressionUUID->"88fadf1d-ba42-4f8e-af1c-b209a884eebf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[657]:=",ExpressionUUID->"b175460b-c6b9-41d7-aa11-cd8f2602c4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetElements", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"formula", "=", "input"}], ",", "patternX", ",", "groupX", ",", 
      
      RowBox[{"tallyQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<Tally\>\"", "]"}]}]}], ",", 
      "elements", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Check", " ", "input", " ", "string", 
      " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"--", 
      RowBox[{"*", " ", 
       RowBox[{"A", ".", " ", "Crystal"}], " ", "name", " ", "input", " ", 
       "*", "--"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "@", "$CrystalData"}], ",", "input"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Use"}], " ", "chemical", " ", "formula"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"$CrystalData", "@", "input"}], ",", 
          "\"\<ChemicalFormula\>\"", ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"b", ".", " ", "Return"}], " ", "elements", " ", 
            "contained", " ", 
            RowBox[{"in", " ", "'"}], 
            RowBox[{"AtomData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"elements", "=", 
            RowBox[{"$CrystalData", "\[LeftDoubleBracket]", 
             RowBox[{
             "input", ",", "\"\<AtomData\>\"", ",", "All", ",", 
              "\"\<Element\>\""}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"tallyQ", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Return", " ", "tally"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "@", 
              RowBox[{"Tally", "@", "elements"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Return", " ", "elements", " ", "only"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "@", 
              RowBox[{"DeleteDuplicates", "@", "elements"}]}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"*", " ", 
        RowBox[{"B", ".", " ", "Chemical"}], " ", "formula", " ", "string", 
        " ", "*", "--"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"FullForm", "@", "formula"}]}], ",", "\"\<!\>\""}], "]"}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Formatted"}], " ", "string"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Considering", " ", "the", " ", "full", " ", "form"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"elements", "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"FullForm", "@", "formula"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Marking", " ", "subscripts", " ", 
            RowBox[{"with", " ", "'"}], 
            RowBox[{"$", "'"}], " ", "\[IndentingNewLine]", "\t\t", 
            "elements"}], "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"elements", ",", 
             RowBox[{"\"\<\\\\), \\\\(\>\"", "\[Rule]", "\"\<$\>\""}]}], 
            "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Cleaning", " ", "the", " ", "full", " ", "form"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"elements", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"elements", ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\\\\!\\\\(\\\\*SubscriptBox[\\\\(\>\"", ",", 
             "\[IndentingNewLine]", "\t\t", "\"\<[\\\\(\>\"", ",", 
             "\"\<\\\\)]\\\\)\>\"", ",", "\"\<\\\\), \\\\(\>\""}], "}"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Plain"}], " ", "string"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"elements", "=", "formula"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Useful", " ", "local", " ", 
       "variables", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"patternX", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"_", "?", "UpperCaseQ"}], "~~", 
         RowBox[{"_", "?", "LowerCaseQ"}]}], ",", 
        RowBox[{"_", "?", "UpperCaseQ"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"groupX", "[", "S_", "]"}], ":=", 
      RowBox[{
       RowBox[{"StringCases", "[", 
        RowBox[{"S", ",", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", "patternX"}], "~~", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"n1", ":", 
                RowBox[{"DigitCharacter", ".."}]}], "~~", "\"\<.\>\"", "~~", 
               RowBox[{"n2", ":", 
                RowBox[{"DigitCharacter", ".."}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "\t", "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"n1", "<>", "\"\<.\>\"", "<>", "n2"}], "]"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", "patternX"}], "~~", 
             RowBox[{"n", ":", 
              RowBox[{"DigitCharacter", ".."}]}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}]}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"n", "~~", "pm"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", "patternX"}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"n", "~~", "pm"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", "patternX"}], "~~", 
             RowBox[{"n", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"ToExpression", "@", "n"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "\t", "}"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<\>\"", "\[Rule]", "\"\<1\>\""}], ",", 
         RowBox[{"Null", "\[Rule]", "1"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Extracting", " ", "symbols", " ", 
       "and", " ", "numbers", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Distribute", " ", "parenthesis", " ", "subscripts"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"elements", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"elements", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"\"\<(\>\"", "~~", "p__", "~~", "\"\<)\>\"", "~~", 
          RowBox[{"s", ":", 
           RowBox[{"DigitCharacter", ".."}]}]}], "\[IndentingNewLine]", 
         "\t\t", "\[RuleDelayed]", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"ToString", "/@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"MapAt", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "*", 
                RowBox[{"ToExpression", "[", "s", "]"}]}], "&"}], ",", 
              RowBox[{"groupX", "@", "p"}], ",", 
              RowBox[{"{", 
               RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Group", " ", "elements", " ", "and", " ", "corresponding", " ", 
       "subscripts"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"elements", "=", 
      RowBox[{"groupX", "@", "elements"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"elements", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetElements", "::", "InvalidFormula"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"elements", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<InterpretElement\>\"", ",", "temp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"DeleteDuplicates", "@", "temp"}]}], ";", "\[IndentingNewLine]",
      "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"Keys", "@", "$PeriodicTable"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetElements", "::", "InvalidElements"}], ",", 
          RowBox[{"ToString", "@", "temp"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Merge", " ", "equal", " ", "elements"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DuplicateFreeQ", "[", 
         RowBox[{"First", "/@", "elements"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"elements", "=", 
         RowBox[{"MapAt", "[", 
          RowBox[{"ToExpression", ",", "elements", ",", 
           RowBox[{"{", 
            RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"elements", "=", 
         RowBox[{"GatherBy", "[", 
          RowBox[{"elements", ",", "First"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"elements", "=", 
         RowBox[{"elements", "/.", 
          RowBox[{
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"Depth", "[", "x", "]"}], "===", "3"}]}], 
           "\[RuleDelayed]", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"Total", "@", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
            "}"}]}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Checking", " ", "for", " ", "ions"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elements", "=", 
      RowBox[{"elements", "/.", 
       RowBox[{
        RowBox[{"x_List", "/;", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
          RowBox[{"StringContainsQ", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "]"}]}]}], 
        "\[RuleDelayed]", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"StringJoin", "@@", "x"}], ",", "\"\<1\>\""}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Remove", " ", "charge", " ", "of", " ", "ions"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IgnoreIonCharge\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"elements", "=", 
        RowBox[{"MapAt", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StringDelete", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
              "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", "elements", 
          ",", 
          RowBox[{"{", 
           RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Confirm", " ", "that", " ", "tally", " ", "numbers", " ", "are", " ", 
       "expressions"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{"ToExpression", ",", "elements", ",", 
        RowBox[{"{", 
         RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Keep", " ", "tally", " ", "of", " ", "the", " ", "various", " ", 
        "atoms"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "tallyQ"}], ",", 
       RowBox[{"elements", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"First", "/@", "elements"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "elements"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.685292929314414*^9, 3.685292949551355*^9}, {
   3.685292980630427*^9, 3.685293093109366*^9}, {3.6852935686996202`*^9, 
   3.685293592607072*^9}, {3.685294304496677*^9, 3.685294312832938*^9}, {
   3.685294359159436*^9, 3.685294392591338*^9}, 3.685294452156907*^9, {
   3.7125585005216303`*^9, 3.712558599149044*^9}, {3.712558653688374*^9, 
   3.712558706404811*^9}, 3.712558740953339*^9, {3.7125590860901546`*^9, 
   3.712559142612122*^9}, {3.7125592016674137`*^9, 3.7125592063906593`*^9}, {
   3.712559401604739*^9, 3.71255953948845*^9}, {3.716825435019915*^9, 
   3.716825443192257*^9}, {3.716829256621364*^9, 3.716829678456518*^9}, {
   3.716829747406776*^9, 3.7168297497583103`*^9}, {3.716829817072053*^9, 
   3.716829872267585*^9}, {3.7168702686821833`*^9, 3.716870278953738*^9}, {
   3.719168963772888*^9, 3.7191689675316343`*^9}, {3.7191690693051367`*^9, 
   3.71916911050533*^9}, {3.719169157745376*^9, 3.7191691630471363`*^9}, {
   3.719169213549266*^9, 3.719169225037245*^9}, {3.7191694293210917`*^9, 
   3.719169484711543*^9}, {3.719169568221366*^9, 3.71916957778019*^9}, {
   3.7191703668084784`*^9, 3.7191704010195827`*^9}, {3.719170432031032*^9, 
   3.719170480309218*^9}, {3.7191707916063957`*^9, 3.719170851325012*^9}, {
   3.719170886467657*^9, 3.719170977504312*^9}, {3.719171068463624*^9, 
   3.7191711057322683`*^9}, {3.719171210442648*^9, 3.719171214817477*^9}, {
   3.7191717353185587`*^9, 3.71917173550896*^9}, {3.719171831764216*^9, 
   3.719171832127336*^9}, {3.719171976553056*^9, 3.719171978487883*^9}, {
   3.719172633208712*^9, 3.7191726664464083`*^9}, {3.719173370807959*^9, 
   3.719173382142346*^9}, {3.71917342099035*^9, 3.719173584729095*^9}, {
   3.7191736766562643`*^9, 3.71917378886082*^9}, 3.719173877524808*^9, {
   3.719173941337644*^9, 3.7191739875119867`*^9}, 3.719174069918503*^9, {
   3.7191742150360928`*^9, 3.719174247370132*^9}, {3.719174503030614*^9, 
   3.7191745794530478`*^9}, {3.719174865447359*^9, 3.719174867454191*^9}, {
   3.719174900223995*^9, 3.719174903453495*^9}, {3.719174946589995*^9, 
   3.7191749492283287`*^9}, {3.719174996797008*^9, 3.7191750201387253`*^9}, {
   3.719175669790955*^9, 3.7191757249355516`*^9}, {3.719176455672847*^9, 
   3.719176469255004*^9}, {3.719176846095621*^9, 3.719177110017375*^9}, 
   3.7272440207729063`*^9, {3.735026359560768*^9, 3.735026415725293*^9}, {
   3.735026452534255*^9, 3.7350264984462748`*^9}, {3.735026556379381*^9, 
   3.73502668032768*^9}, {3.735027182439661*^9, 3.735027257538212*^9}, {
   3.735027287691483*^9, 3.73502735715379*^9}, {3.735027390658354*^9, 
   3.735027451511298*^9}, {3.735027580296316*^9, 3.735027583171487*^9}, {
   3.735027614671505*^9, 3.73502765105129*^9}, {3.735027695863276*^9, 
   3.735027748161511*^9}, {3.7350278283459587`*^9, 3.735027830051031*^9}, {
   3.735027908613785*^9, 3.7350279090084343`*^9}, {3.7350279586886263`*^9, 
   3.735027997182349*^9}, {3.735028138640189*^9, 3.735028172319462*^9}, {
   3.7350283323634443`*^9, 3.7350284239931192`*^9}, {3.7350284765515842`*^9, 
   3.735028502245571*^9}, {3.735028532733877*^9, 3.7350285646801977`*^9}, {
   3.7350286139958363`*^9, 3.735028614225257*^9}, {3.737384802769537*^9, 
   3.73738485758283*^9}, {3.737384892058063*^9, 3.737384920149081*^9}, {
   3.737384968509556*^9, 3.737385024213161*^9}, {3.7373850962752028`*^9, 
   3.737385169697603*^9}, {3.737385206944845*^9, 3.737385234562249*^9}, {
   3.739210170513124*^9, 3.739210172239122*^9}, {3.7392102340995407`*^9, 
   3.7392102379176903`*^9}, {3.739210281988481*^9, 3.7392102932204247`*^9}, {
   3.7392104917399178`*^9, 3.739210492064567*^9}, {3.739210768332066*^9, 
   3.739210783338932*^9}, {3.73921083063846*^9, 3.7392108948330183`*^9}, {
   3.7392109736499968`*^9, 3.739211116047324*^9}, {3.7392111528303413`*^9, 
   3.739211209194542*^9}, {3.742020582664439*^9, 3.7420205872094193`*^9}, {
   3.742020622844721*^9, 3.742020679523018*^9}, {3.742021091478095*^9, 
   3.74202109197392*^9}, {3.74202121505618*^9, 3.742021236453971*^9}, {
   3.7420213185883703`*^9, 3.7420213578267717`*^9}, {3.7420213952475348`*^9, 
   3.742021407915893*^9}, {3.7420216306880617`*^9, 3.742021632527237*^9}, {
   3.7585293888930483`*^9, 3.7585294093832912`*^9}, {3.75951936129001*^9, 
   3.7595193615112133`*^9}, 3.7627930933445883`*^9, {3.7856880719969873`*^9, 
   3.785688077785399*^9}, 3.785688120580406*^9, {3.786968355406589*^9, 
   3.7869683574198503`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[658]:=",ExpressionUUID->"1347a758-df44-4a37-811e-a5f71f856ecc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[659]:=",ExpressionUUID->"88892b1f-2c9d-4af4-90e3-325b656413cd"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetLatticeParameters", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 
   3.705030491163352*^9}},ExpressionUUID->"83c266d6-504a-4004-b6a7-\
b06bafe5c55a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[660]:=",ExpressionUUID->"a8a0970e-2413-44ef-b0c2-44f83abdd4a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "GetLatticeParameters"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"OptionsPattern", "@", "GetCrystalMetric"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQveDshM17yl876vFKbQHRQkznD4Pohbd+nALRK/53
vj0x67Vj0UfmdyD67cqjaieBdClLnAaIvjNPrwtEV7jlgOlfbosOgei+4/uO
g+ju2r8fola/dnw1ifcjiDY5u+f88rWvHecdOw2mbb4Vv5t987VjCV8ZmD6t
M2Fl9N/XjilVAatBdLxE41VFpjeOy28FXQfRu7IvOCkB6YDta91BtJ1yzyEQ
3bd3O5huOnnokC+QPjaz/jCIvnlnB5s/kG7uOAym9534+4ND643jxqX8P0H0
gVTL99Pb3zhu27MDTLd95G/W7ADqfyHSAqLf/BHkrQXSe5M9wDQAjfao8Q==

  "],ExpressionUUID->"512ac662-5267-466d-b67c-a97e353b16bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[665]:=",ExpressionUUID->"fca868db-efc7-45c2-887f-8c77a8ed85ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetLatticeParameters", "[", 
   RowBox[{"input_", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "@", "GetCrystalMetric"}]}]}], "]"}], ":=", 
  RowBox[{"GetCrystalMetric", "[", 
   RowBox[{"input", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Category\>\"", "\[Rule]", "\"\<LatticeParameters\>\""}], ",", 
    RowBox[{"\"\<Space\>\"", "\[Rule]", 
     RowBox[{"OptionValue", "[", "\"\<Space\>\"", "]"}]}], ",", "options"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, 3.705030516132319*^9, {
   3.705030854490851*^9, 3.705030855594645*^9}, {3.705030886826001*^9, 
   3.705030897163478*^9}, {3.705031098702557*^9, 3.705031114340454*^9}, {
   3.705031170526485*^9, 3.7050311927839212`*^9}, {3.705031531018292*^9, 
   3.705031543220398*^9}, {3.70503165376649*^9, 3.705031676591818*^9}, {
   3.705031712520639*^9, 3.705031713810836*^9}, {3.7050318153266163`*^9, 
   3.705031930883963*^9}, {3.705031983369022*^9, 3.705032057059581*^9}, {
   3.7137185004843197`*^9, 3.7137185357381477`*^9}, 3.714924306008999*^9, {
   3.714924684167651*^9, 3.714924833922771*^9}, {3.71492487802812*^9, 
   3.7149249497280197`*^9}, {3.714924983688899*^9, 3.7149250098399477`*^9}, {
   3.7149250443684483`*^9, 3.714925097110804*^9}, {3.714925261826474*^9, 
   3.714925271569159*^9}, 3.7177409207486897`*^9, {3.730145347590613*^9, 
   3.730145350061535*^9}, {3.737968499769812*^9, 3.737968499911303*^9}, {
   3.758529411976033*^9, 3.758529447744554*^9}, {3.758529510672456*^9, 
   3.7585295122315207`*^9}, {3.759214128869026*^9, 3.759214129487618*^9}, {
   3.759214273277697*^9, 3.7592143965695066`*^9}, {3.759214914395612*^9, 
   3.759214987863502*^9}, {3.7592150245868397`*^9, 3.759215039947249*^9}, {
   3.759215072046776*^9, 3.759215120620841*^9}, {3.759215177099942*^9, 
   3.7592152180372353`*^9}, {3.75921530886723*^9, 3.759215317243203*^9}, {
   3.7592155275536137`*^9, 3.759215532043428*^9}, {3.7592156191927977`*^9, 
   3.759215628751072*^9}, {3.759215873817337*^9, 3.7592161211308517`*^9}, {
   3.7592161762079163`*^9, 3.7592162307507887`*^9}, {3.759216311543207*^9, 
   3.759216341586823*^9}, {3.7592165147090483`*^9, 3.759216647627503*^9}, {
   3.759216762942222*^9, 3.759216786322085*^9}, {3.759305944991763*^9, 
   3.759305995859367*^9}, {3.759306458627666*^9, 3.75930650793466*^9}, 
   3.759306809682476*^9, {3.75930709183512*^9, 3.75930709248184*^9}, {
   3.7593071429612494`*^9, 3.759307243560383*^9}, {3.75930728769536*^9, 
   3.7593073095578814`*^9}, {3.759307353303314*^9, 3.759307387075882*^9}, {
   3.7593074955236683`*^9, 3.7593074998642473`*^9}, {3.7593075371608877`*^9, 
   3.7593075392236156`*^9}, {3.759307575647236*^9, 3.759307622862166*^9}, {
   3.759307663319539*^9, 3.759307878689664*^9}, {3.759308556762401*^9, 
   3.7593086249283333`*^9}, {3.759308655119772*^9, 3.7593088915720577`*^9}, {
   3.7593089367253437`*^9, 3.759309046088253*^9}, {3.759309092553344*^9, 
   3.759309116742985*^9}, {3.759309329637364*^9, 3.759309352642446*^9}, {
   3.759519369568359*^9, 3.75951937011089*^9}, 3.762793093368389*^9, {
   3.7637405528325443`*^9, 3.763740582589224*^9}, {3.786968053837101*^9, 
   3.786968054890833*^9}, {3.829186606511395*^9, 3.829186606641438*^9}, {
   3.829186705720471*^9, 3.829186719796191*^9}, {3.8291868434660263`*^9, 
   3.829186898683683*^9}, {3.8291869411215067`*^9, 3.8291870491159267`*^9}, {
   3.829187094597036*^9, 3.8291871863886414`*^9}, {3.829187262412809*^9, 
   3.829187264340592*^9}, {3.829187329191555*^9, 3.829187456684247*^9}, {
   3.82918750797943*^9, 3.8291875271215878`*^9}, {3.829483984939872*^9, 
   3.829483987919022*^9}, {3.829484117987528*^9, 3.829484158839014*^9}, 
   3.829484265497972*^9, {3.829484364279852*^9, 3.829484430619885*^9}, {
   3.829484523492304*^9, 3.829484536848072*^9}, {3.8296556645885487`*^9, 
   3.829655674325438*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"1f6f1972-6af8-4c70-97ae-982f951c724e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[667]:=",ExpressionUUID->"025da413-f892-46d5-b527-d2a5e50c4768"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetLaueClass", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.684667958524547*^9, 3.684667960120316*^9}, {3.6846686457735453`*^9, 
   3.6846686463667*^9}, 
   3.68570063082576*^9},ExpressionUUID->"898cafc9-ecd9-4aba-8e7d-\
9a05e3db7235"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[668]:=",ExpressionUUID->"66d71e77-4ab7-478d-84fe-59fd855cb3af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetLaueClass", "::", "missing"}], "=", 
    "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "GetLaueClass"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "_", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.737968520211151*^9, {3.756711269674296*^9, 3.756711273361972*^9}, {
   3.756711355733519*^9, 3.7567114217022133`*^9}},
 CellLabel->
  "In[669]:=",ExpressionUUID->"f25998bc-df47-499a-8b0a-9c97ae5497bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[671]:=",ExpressionUUID->"79ea042e-a351-4320-bd3f-aedef5fe4bbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetLaueClass", "[", "symbol_String", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", ",", "extract"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "$CrystalData", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"$CrystalData", "[", "symbol", "]"}], "[", 
       "\"\<SpaceGroup\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "g"}], ",", 
       RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", 
        RowBox[{
         RowBox[{"-", "3"}], "m"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "symbol", "\[Equal]", 
         "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)1m\>\""}], "||", 
        RowBox[{"symbol", "\[Equal]", "\"\<-31m\>\""}]}], ",", 
       RowBox[{
       "Return", "[", "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)1m\>\"", "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "symbol", "\[Equal]", 
         "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)m:r\>\""}], "||", 
        RowBox[{"symbol", "\[Equal]", "\"\<-3m:r\>\""}]}], ",", 
       RowBox[{
       "Return", "[", "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)m:r\>\"", "]"}],
        ",", "\[IndentingNewLine]", "True", ",", "Null"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Point", " ", "group", " ", "or", " ", "space", " ", "group"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"$GroupSymbolRedirect", "[", "symbol", "]"}], "[", 
       "\"\<LaueClass\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "g"}], ",", 
       RowBox[{"Return", "@", "g"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Point", " ", "group", " ", "or", " ", "space", " ", "group", " ", 
       RowBox[{"(", 
        RowBox[{"alternative", " ", "setting"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"extract", "=", 
      RowBox[{
       RowBox[{"FullForm", "[", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Extract", "[", "\[IndentingNewLine]", 
          RowBox[{
          "$GroupSymbolRedirect", ",", "\[IndentingNewLine]", "symbol", ",", 
           "Inactivate"}], "]"}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"$GroupSymbolRedirect", "[", "extract", "]"}], "[", 
       "\"\<LaueClass\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"No", " ", "match"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringQ", "@", "g"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetLaueClass", "::", "missing"}], ",", "symbol"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "g"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"End", " ", 
       RowBox[{"(", 
        RowBox[{"for", " ", "use", " ", "with", " ", "$CrystalData"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"GetLaueClass", "[", "g", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, {
   3.685079528520215*^9, 3.6850795700522537`*^9}, {3.685079609824223*^9, 
   3.68507976209107*^9}, {3.6850801175697823`*^9, 3.685080136669197*^9}, {
   3.6850801705077353`*^9, 3.685080193540316*^9}, {3.6850802428064957`*^9, 
   3.685080244336314*^9}, {3.68508029169517*^9, 3.6850803659439173`*^9}, {
   3.685080400088478*^9, 3.685080401518166*^9}, {3.6850805073455763`*^9, 
   3.685080567126417*^9}, {3.6852486796520853`*^9, 3.6852486864393597`*^9}, {
   3.685248720001297*^9, 3.685248724174099*^9}, 3.6852487544120092`*^9, {
   3.685248800204956*^9, 3.685248803000963*^9}, {3.685249136526149*^9, 
   3.685249179200903*^9}, {3.685249683180578*^9, 3.6852497229340143`*^9}, {
   3.685249765477912*^9, 3.685249806794134*^9}, {3.685249936405735*^9, 
   3.685250039598538*^9}, {3.685250203904066*^9, 3.685250237194146*^9}, {
   3.685250268520568*^9, 3.685250278543681*^9}, {3.685250310995026*^9, 
   3.685250473891493*^9}, {3.685250515497068*^9, 3.685250550260337*^9}, {
   3.685250596138503*^9, 3.685250597311151*^9}, {3.685250650170144*^9, 
   3.685250701320359*^9}, {3.685678714163109*^9, 3.685678724227903*^9}, {
   3.685680631552026*^9, 3.685680726344557*^9}, {3.685680777866826*^9, 
   3.685680813584144*^9}, {3.685700637133027*^9, 3.685700641664912*^9}, {
   3.7177409045951014`*^9, 3.717740920784957*^9}, {3.730145930529347*^9, 
   3.730145931248543*^9}, {3.730146045655348*^9, 3.730146046973926*^9}, {
   3.737968520312047*^9, 3.737968520667469*^9}, {3.7438654556085653`*^9, 
   3.743865455699587*^9}, {3.758529519679034*^9, 3.7585295218073063`*^9}, 
   3.7627930933853416`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[672]:=",ExpressionUUID->"15a6dfdb-c115-405c-b0e9-dd98448c8011"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[673]:=",ExpressionUUID->"74663297-5820-4131-8c01-782e637c78f3"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetScatteringCrossSections", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, 3.717739586397138*^9, {
   3.735291133581037*^9, 
   3.735291138159142*^9}},ExpressionUUID->"feafbab9-d59a-4ca9-94ed-\
3ac0157ec3a6"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[674]:=",ExpressionUUID->"1efaff58-21c3-441d-b94d-b681e0d368ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringCrossSections", "::", "\"\<invsrc\>\""}], "=", 
   "\"\<Invalid source.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringCrossSections", "::", "\"\<invelt\>\""}], "=", 
   "\"\<Invalid element.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringCrossSections", "::", "invproc"}], "=", 
   "\"\<The scattering process type \[LeftGuillemet]`1`\[RightGuillemet] is \
not recognised.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetScatteringCrossSections", "::", "\"\<invwlrange\>\""}], "=", 
    "\"\<The wavelength, `1` \[CapitalARing], must be within (0.001 \
\[LessEqual] \[Lambda] \[LessEqual] 3.000) \[CapitalARing] when using cross \
sections.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "GetScatteringCrossSections"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<PhysicalProcess\>\"", "\[Rule]", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Source\>\"", "\[Rule]", "\"\<xraylib\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "GetScatteringCrossSections"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719174557698147*^9, 3.719174575089182*^9}, 
   3.7272440207601767`*^9, {3.735028184066166*^9, 3.735028195898958*^9}, {
   3.735028314418393*^9, 3.7350283221953506`*^9}, {3.735291141295652*^9, 
   3.735291184066963*^9}, {3.735291225379405*^9, 3.735291229257778*^9}, {
   3.735291632802617*^9, 3.7352916596886263`*^9}, {3.735291714655457*^9, 
   3.735291726262683*^9}, {3.735291774887849*^9, 3.735291810741148*^9}, {
   3.7352918492397757`*^9, 3.735291853499892*^9}, {3.7352946419742203`*^9, 
   3.735294652334242*^9}, {3.73529518760988*^9, 3.7352951926106787`*^9}, {
   3.735295565794612*^9, 3.73529556679265*^9}, {3.735295724749537*^9, 
   3.735295724893229*^9}, 3.735306079956148*^9, {3.735306390011011*^9, 
   3.735306399498732*^9}, {3.7438658806326017`*^9, 3.743865880812434*^9}, 
   3.744172272698161*^9, {3.75671155508288*^9, 3.7567115785387573`*^9}},
 CellLabel->
  "In[675]:=",ExpressionUUID->"4b14ee0a-1324-48de-9d66-7c4ab7b7fc16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[681]:=",ExpressionUUID->"f714e5a1-512c-4505-a27e-115a7be13ab0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetScatteringCrossSections", "[", 
   RowBox[{"input_", ",", "\[IndentingNewLine]", 
    RowBox[{"wavelength", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"src", ",", "unitsQ", ",", "elements", ",", 
      RowBox[{"\[Lambda]", "=", "wavelength"}], ",", 
      RowBox[{"pp", "=", 
       RowBox[{"OptionValue", "[", "\"\<PhysicalProcess\>\"", "]"}]}], ",", 
      "column", ",", "\[IndentingNewLine]", "setpos", ",", "\[Sigma]", ",", 
      "file", ",", "read", ",", "\[Sigma]i"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checks", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Chemical", " ", "element", 
      RowBox[{"(", "s", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"elements", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"GetElements", "[", "input", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Data", " ", "source"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"src", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<CrossSections\>\"", ",", 
         RowBox[{"OptionValue", "[", "\"\<Source\>\"", "]"}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "@", "src"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetScatteringCrossSections", "::", "\"\<invsrc\>\""}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"unitsQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wavelength", " ", "and", " ", "its", " ", "range"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
         "0.001", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", "3.000"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetScatteringCrossSections", "::", "invwlrange"}], ",", 
          RowBox[{"ToString", "@", "\[Lambda]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "\"\<ProcessWavelength\>\"", ",", "\"\<\>\"", ",", "wavelength"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Column", " ", "to", " ", "read", " ", "from", " ", 
       RowBox[{"(", 
        RowBox[{"cross", " ", "section", " ", "type"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"column", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pp", "===", "\"\<\>\""}], ",", "5", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<Photoelectric\>\"", ",", "\"\<Photoionisation\>\""}], 
           "}"}], ",", "pp"}], "]"}], ",", "2", ",", "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Coherent\>\"", ",", "\"\<Rayleigh\>\"", ",", 
            "\"\<Thompson\>\"", ",", "\[IndentingNewLine]", 
            "\"\<Classical\>\"", ",", "\"\<Elastic\>\""}], "}"}], ",", "pp"}],
          "]"}], ",", "3", ",", "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Incoherent\>\"", ",", "\"\<Compton\>\"", ",", 
            "\"\<Inelastic\>\""}], "\[IndentingNewLine]", "}"}], ",", "pp"}], 
         "]"}], ",", "4", ",", "\[IndentingNewLine]", 
        RowBox[{"pp", "===", "\"\<Total\>\""}], ",", "5", ",", 
        "\[IndentingNewLine]", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"GetScatteringCrossSections", "::", "invproc"}], ",", 
           "pp"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Read", " ", "from", " ", "file", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Stream", " ", "position", " ", "in", " ", "dat", " ", "files"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"setpos", "=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"$OperatingSystem", "===", "\"\<Windows\>\""}], ",", "65", 
         ",", "66"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"1000", "*", "\[Lambda]"}], "]"}], "-", "1"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Extract", " ", "cross", " ", "sections"}], ";", " ", 
       RowBox[{"\[Sigma]", " ", "=", " ", 
        RowBox[{"\[Sigma]", 
         RowBox[{"(", 
          RowBox[{"element", ",", " ", "wavelength"}], ")"}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"file", "=", 
         RowBox[{"OpenRead", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"src", ",", 
             RowBox[{"X", "<>", "\"\<.dat\>\""}]}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetStreamPosition", "[", 
         RowBox[{"file", ",", "setpos"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"read", "=", 
         RowBox[{"Read", "[", 
          RowBox[{"file", ",", "Record"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Sigma]i", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", "read", "]"}], 
             "\[LeftDoubleBracket]", "column", "\[RightDoubleBracket]"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"m__", "~~", "\"\<E\>\"", "~~", 
              RowBox[{"s", ":", 
               RowBox[{"{", 
                RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
              RowBox[{"e", ":", 
               RowBox[{"DigitCharacter", ".."}]}]}], "\[RuleDelayed]", 
             "\[IndentingNewLine]", 
             RowBox[{
             "m", "<>", "\"\<*10^(\>\"", "<>", "s", "<>", "e", "<>", 
              "\"\<)\>\""}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", 
          RowBox[{"\[Sigma]i", "=", 
           RowBox[{"Quantity", "[", 
            RowBox[{"\[Sigma]i", ",", "\"\<Barns\>\""}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Close", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"\[Sigma]", ",", 
          RowBox[{"X", "\[Rule]", "\[Sigma]i"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"X", ",", "elements"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Output", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Association", "@", "\[Sigma]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.685292929314414*^9, 3.685292949551355*^9}, {
   3.685292980630427*^9, 3.685293093109366*^9}, {3.6852935686996202`*^9, 
   3.685293592607072*^9}, {3.685294304496677*^9, 3.685294312832938*^9}, {
   3.685294359159436*^9, 3.685294392591338*^9}, 3.685294452156907*^9, {
   3.7125585005216303`*^9, 3.712558599149044*^9}, {3.712558653688374*^9, 
   3.712558706404811*^9}, 3.712558740953339*^9, {3.7125590860901546`*^9, 
   3.712559142612122*^9}, {3.7125592016674137`*^9, 3.7125592063906593`*^9}, {
   3.712559401604739*^9, 3.71255953948845*^9}, {3.716825435019915*^9, 
   3.716825443192257*^9}, {3.716829256621364*^9, 3.716829678456518*^9}, {
   3.716829747406776*^9, 3.7168297497583103`*^9}, {3.716829817072053*^9, 
   3.716829872267585*^9}, {3.7168702686821833`*^9, 3.716870278953738*^9}, {
   3.719168963772888*^9, 3.7191689675316343`*^9}, {3.7191690693051367`*^9, 
   3.71916911050533*^9}, {3.719169157745376*^9, 3.7191691630471363`*^9}, {
   3.719169213549266*^9, 3.719169225037245*^9}, {3.7191694293210917`*^9, 
   3.719169484711543*^9}, {3.719169568221366*^9, 3.71916957778019*^9}, {
   3.7191703668084784`*^9, 3.7191704010195827`*^9}, {3.719170432031032*^9, 
   3.719170480309218*^9}, {3.7191707916063957`*^9, 3.719170851325012*^9}, {
   3.719170886467657*^9, 3.719170977504312*^9}, {3.719171068463624*^9, 
   3.7191711057322683`*^9}, {3.719171210442648*^9, 3.719171214817477*^9}, {
   3.7191717353185587`*^9, 3.71917173550896*^9}, {3.719171831764216*^9, 
   3.719171832127336*^9}, {3.719171976553056*^9, 3.719171978487883*^9}, {
   3.719172633208712*^9, 3.7191726664464083`*^9}, {3.719173370807959*^9, 
   3.719173382142346*^9}, {3.71917342099035*^9, 3.719173584729095*^9}, {
   3.7191736766562643`*^9, 3.71917378886082*^9}, 3.719173877524808*^9, {
   3.719173941337644*^9, 3.7191739875119867`*^9}, 3.719174069918503*^9, {
   3.7191742150360928`*^9, 3.719174247370132*^9}, {3.719174503030614*^9, 
   3.7191745794530478`*^9}, {3.719174865447359*^9, 3.719174867454191*^9}, {
   3.719174900223995*^9, 3.719174903453495*^9}, {3.719174946589995*^9, 
   3.7191749492283287`*^9}, {3.719174996797008*^9, 3.7191750201387253`*^9}, {
   3.719175669790955*^9, 3.7191757249355516`*^9}, {3.719176455672847*^9, 
   3.719176469255004*^9}, {3.719176846095621*^9, 3.719177110017375*^9}, 
   3.7272440207729063`*^9, {3.735026359560768*^9, 3.735026415725293*^9}, {
   3.735026452534255*^9, 3.7350264984462748`*^9}, {3.735026556379381*^9, 
   3.73502668032768*^9}, {3.735027182439661*^9, 3.735027257538212*^9}, {
   3.735027287691483*^9, 3.73502735715379*^9}, {3.735027390658354*^9, 
   3.735027451511298*^9}, {3.735027580296316*^9, 3.735027583171487*^9}, {
   3.735027614671505*^9, 3.73502765105129*^9}, {3.735027695863276*^9, 
   3.735027748161511*^9}, {3.7350278283459587`*^9, 3.735027830051031*^9}, {
   3.735027908613785*^9, 3.7350279090084343`*^9}, {3.7350279586886263`*^9, 
   3.735027997182349*^9}, {3.735028138640189*^9, 3.735028172319462*^9}, {
   3.7350283323634443`*^9, 3.7350284239931192`*^9}, {3.7350284765515842`*^9, 
   3.735028502245571*^9}, {3.735028532733877*^9, 3.7350285646801977`*^9}, {
   3.7350286139958363`*^9, 3.735028614225257*^9}, {3.735291150800659*^9, 
   3.735291169475254*^9}, {3.7352912368180227`*^9, 3.735291276457193*^9}, {
   3.7352913496176023`*^9, 3.735291377512362*^9}, {3.735291591653658*^9, 
   3.735291622523106*^9}, 3.735291701489131*^9, {3.735291733794158*^9, 
   3.735291771207726*^9}, {3.7352918222169437`*^9, 3.7352918270087843`*^9}, {
   3.73529186003209*^9, 3.7352918997085457`*^9}, {3.735291981203569*^9, 
   3.735291995311404*^9}, {3.7352920944713697`*^9, 3.735292333783617*^9}, {
   3.7352941774627867`*^9, 3.735294198529961*^9}, {3.735294360872147*^9, 
   3.735294364486846*^9}, {3.735294395526725*^9, 3.735294431941141*^9}, {
   3.7352944887078648`*^9, 3.735294628272335*^9}, {3.735294660521525*^9, 
   3.73529471570223*^9}, {3.735294793471644*^9, 3.735294809995585*^9}, {
   3.735294879211343*^9, 3.735295003526989*^9}, {3.735295180916245*^9, 
   3.735295183786879*^9}, {3.73529522295564*^9, 3.735295272817762*^9}, {
   3.73529531596251*^9, 3.7352953605696497`*^9}, {3.735295452357264*^9, 
   3.735295486173215*^9}, {3.735295532692325*^9, 3.7352955332273684`*^9}, {
   3.735295645691324*^9, 3.735295710297604*^9}, {3.7352997948361263`*^9, 
   3.7352998463232727`*^9}, {3.735305592745775*^9, 3.7353057118758707`*^9}, {
   3.73530577839625*^9, 3.735305809425119*^9}, 3.7353059146736517`*^9, {
   3.735306278649869*^9, 3.735306367750526*^9}, {3.735306415334628*^9, 
   3.735306434406185*^9}, 3.735306484402957*^9, 3.743865412276691*^9, {
   3.743865880884262*^9, 3.743865881015009*^9}, {3.743992547175686*^9, 
   3.7439925517869883`*^9}, {3.758529524205367*^9, 3.758529526512549*^9}, {
   3.759519391967732*^9, 3.759519392245387*^9}, 3.7627930934071407`*^9, {
   3.786968368341013*^9, 3.7869683711069813`*^9}, 3.8073799255123653`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[682]:=",ExpressionUUID->"84427fe3-bf97-4c7b-abed-513b77389f90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[683]:=",ExpressionUUID->"acb916b9-adf5-4e95-8aba-68fa65ad15d3"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetSymmetryData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9, {3.713180935870894*^9, 3.713180938209676*^9}, 
   3.717767492093237*^9},ExpressionUUID->"ec3234e6-9ccb-40af-a7f8-\
b85486276271"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[684]:=",ExpressionUUID->"71425781-fcfc-4379-a882-1c1575233aad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetSymmetryData", "::", "InvalidLabel"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised \
label.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSymmetryData", "::", "Incompatible"}], "=", 
    "\"\<Incompatible group type and label.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "GetSymmetryData"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<UnambiguousSymbol\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<UseMainEntry\>\"", "\[Rule]", "False"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "GetSymmetryData"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7131810413608723`*^9, 3.713181077064309*^9}, {
  3.713181132188043*^9, 3.7131811983538933`*^9}, {3.713255047767827*^9, 
  3.713255056779663*^9}, {3.713255506659046*^9, 3.713255517296316*^9}, {
  3.713255553288314*^9, 3.7132555744919357`*^9}, {3.7136030670066347`*^9, 
  3.7136030675094767`*^9}, {3.7143685834948673`*^9, 3.714368593787736*^9}, {
  3.71785181409776*^9, 3.717851843742972*^9}, {3.7379685452616777`*^9, 
  3.737968545394628*^9}, {3.756711602445937*^9, 3.7567116052607718`*^9}, {
  3.756711644373386*^9, 3.7567116716863194`*^9}, {3.785392030238619*^9, 
  3.785392081267581*^9}},
 CellLabel->
  "In[685]:=",ExpressionUUID->"e740b5bc-96f8-46d7-8a8a-0912dbc9684a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[689]:=",ExpressionUUID->"a2dbefa0-179a-42ec-aa6d-46cb75f01c77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetSymmetryData", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"label_String", ":", "\"\<Lookup\>\""}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "group", ",", "validLabels", ",", "type", ",", "data", ",", "dataMain", 
      ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Extract", " ", "point"}], "-", " ", 
      RowBox[{"or", " ", "space", " ", "group", " ", 
       RowBox[{"(", 
        RowBox[{"also", " ", "check", " ", "$CrystalData"}], ")"}]}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"group", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GetPointSpaceGroupCrystal\>\"", ",", "input"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"validLabels", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Lookup\>\"", ",", "\"\<Symbol\>\"", ",", 
        "\"\<HermannMauguinFull\>\"", ",", "\"\<HermannMauguinShort\>\"", ",",
         "\t", "\"\<HallString\>\"", ",", "\"\<PointGroupNumber\>\"", ",", 
        "\"\<SpaceGroupNumber\>\"", ",", "\"\<LaueClass\>\"", ",", 
        "\"\<CrystalSystem\>\"", ",", "\"\<Centring\>\"", ",", 
        "\"\<MainEntryQ\>\"", ",", "\"\<GroupType\>\"", ",", 
        "\"\<Setting\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"validLabels", ",", "label"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetSymmetryData", "::", "InvalidLabel"}], ",", "label"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"$GroupSymbolRedirect", "@", "group"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"type", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"$PointGroups", ",", "data", ",", "Infinity"}], "]"}], ",", 
        "\"\<PointGroup\>\"", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"type", "===", "\"\<PointGroup\>\""}], "&&", 
          RowBox[{"label", "===", "\"\<SpaceGroupNumber\>\""}]}], ")"}], "||",
         "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"type", "===", "\"\<SpaceGroup\>\""}], "&&", 
          RowBox[{"label", "===", "\"\<PointGroupNumber\>\""}]}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetSymmetryData", "::", "incompatible"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "===", "\"\<GroupType\>\""}], ",", 
       RowBox[{"Return", "@", "type"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Group", " ", "designation"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"group", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "===", "\"\<SpaceGroup\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "[", 
         RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"data", "[", 
         RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "\[Equal]", "\"\<Centring\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"type", "\[Equal]", "\"\<PointGroup\>\""}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"GetSymmetryData", "::", "Incompatible"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "@", 
         RowBox[{"StringTake", "[", 
          RowBox[{"group", ",", "1"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Ascertain", " ", "main", " ", "entry"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"dataMain", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "===", "\"\<SpaceGroup\>\""}], ",", "\t", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temp", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"$SpaceGroups", ",", "group"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$SpaceGroups", "[", 
          RowBox[{"temp", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temp", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"$PointGroups", ",", "data"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"$PointGroups", "[", 
          RowBox[{"temp", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Use", " ", "main", " ", "entry", " ", "corresponding", " ", "to", " ",
         "input"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<UseMainEntry\>\"", "]"}]}], ",", 
       RowBox[{"data", "=", "dataMain"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Executing", " ", "commands"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "===", "\"\<Lookup\>\""}], ",", 
       RowBox[{"Return", "@", "data"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "===", "\"\<MainEntryQ\>\""}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"data", ",", 
          RowBox[{"type", "<>", "\"\<Number\>\""}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Symbol\>\"", ",", "\"\<HermannMauguinFull\>\"", ",", 
           "\[IndentingNewLine]", "\"\<HermannMauguinShort\>\"", ",", 
           "\"\<HallString\>\""}], "}"}], ",", "label"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Optional", ":", " ", 
         RowBox[{"Let", " ", "output", " ", "be", " ", "unambiguous"}]}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TrueQ", "@", 
           RowBox[{"OptionValue", "[", "\"\<UnambiguousSymbol\>\"", "]"}]}], "&&", 
          RowBox[{"label", "===", "\"\<Symbol\>\""}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "@", 
          RowBox[{"ToStandardSetting", "@", 
           RowBox[{"data", "[", 
            RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], 
            "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "@", 
          RowBox[{"data", "[", 
           RowBox[{"\"\<Name\>\"", ",", "label"}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "===", "\"\<Setting\>\""}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"data", "@", "label"}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<PointGroupNumber\>\"", ",", "\"\<SpaceGroupNumber\>\"", ",", 
           "\[IndentingNewLine]", "\"\<LaueClass\>\"", ",", 
           "\"\<CrystalSystem\>\""}], "}"}], ",", "label"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "@", 
        RowBox[{"dataMain", "@", "label"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, 3.685686496167932*^9, {3.6856944477863503`*^9, 
   3.68569446921675*^9}, {3.685694605238812*^9, 3.6856946062341757`*^9}, {
   3.685695893282233*^9, 3.685695896451762*^9}, {3.6856960214137506`*^9, 
   3.6856960251722317`*^9}, {3.687521359980748*^9, 3.687521435237295*^9}, {
   3.6875214687991743`*^9, 3.687521494623404*^9}, {3.6876768933160543`*^9, 
   3.687676910356525*^9}, {3.712650700261273*^9, 3.7126507027975063`*^9}, {
   3.7126508246994467`*^9, 3.7126508373862047`*^9}, {3.712650880057147*^9, 
   3.71265091066479*^9}, {3.712650944551971*^9, 3.712650951383466*^9}, {
   3.712651061181072*^9, 3.7126510654943533`*^9}, {3.71265113385168*^9, 
   3.712651134019478*^9}, {3.7126512882721786`*^9, 3.712651310583632*^9}, {
   3.712651420262867*^9, 3.712651422476676*^9}, {3.7131809448179398`*^9, 
   3.7131810356054564`*^9}, {3.713181086907085*^9, 3.713181107379854*^9}, {
   3.713181159084453*^9, 3.713181161701188*^9}, {3.713181213099559*^9, 
   3.713181282581812*^9}, {3.713181395925655*^9, 3.71318151312195*^9}, {
   3.7131815453258333`*^9, 3.713181580107853*^9}, {3.713251827327198*^9, 
   3.7132518702424192`*^9}, {3.713251944205166*^9, 3.713251965880468*^9}, 
   3.713253926836597*^9, {3.713254030079486*^9, 3.713254056001268*^9}, {
   3.713254601042029*^9, 3.713254606903442*^9}, {3.713255033399905*^9, 
   3.7132550452582607`*^9}, {3.713255173715601*^9, 3.713255178277837*^9}, {
   3.713255269047741*^9, 3.713255296701899*^9}, {3.7132554233367357`*^9, 
   3.713255456956232*^9}, {3.713255524341331*^9, 3.7132555370046387`*^9}, {
   3.713255630041746*^9, 3.713255754351347*^9}, {3.713255878197596*^9, 
   3.713255884948148*^9}, {3.713256297692585*^9, 3.7132563372575808`*^9}, {
   3.71325646948123*^9, 3.713256549123855*^9}, {3.713256593063978*^9, 
   3.713256606351722*^9}, {3.713256684861882*^9, 3.713256723112616*^9}, {
   3.7132567780590973`*^9, 3.713256778951418*^9}, {3.7132569482601748`*^9, 
   3.7132569919648247`*^9}, {3.7132570445646544`*^9, 3.713257318364801*^9}, {
   3.713257422816969*^9, 3.71325751243474*^9}, {3.713257781793808*^9, 
   3.713257789422627*^9}, {3.713257920552896*^9, 3.713257951558282*^9}, {
   3.713258002738751*^9, 3.713258023002263*^9}, {3.713258132808494*^9, 
   3.7132581573886557`*^9}, {3.713258280011162*^9, 3.713258306930822*^9}, {
   3.713258406157126*^9, 3.7132584079015827`*^9}, {3.713258483627623*^9, 
   3.713258501832863*^9}, {3.713258874176128*^9, 3.7132589621947727`*^9}, {
   3.713259006586093*^9, 3.71325902705698*^9}, {3.713259151029574*^9, 
   3.713259157722631*^9}, {3.713259295981337*^9, 3.713259305376504*^9}, {
   3.713259340305367*^9, 3.713259344080024*^9}, {3.7132593807762957`*^9, 
   3.713259395145294*^9}, {3.7132594289741507`*^9, 3.7132595096258097`*^9}, {
   3.713259724575598*^9, 3.7132597478771753`*^9}, {3.713259845692296*^9, 
   3.7132598664044523`*^9}, {3.713259951731834*^9, 3.713259957818882*^9}, {
   3.7132601222001143`*^9, 3.7132601792802553`*^9}, {3.71326028434074*^9, 
   3.7132602890460987`*^9}, {3.7132603605954638`*^9, 
   3.7132603734089727`*^9}, {3.7132604960901403`*^9, 3.713260498539002*^9}, {
   3.713260967143147*^9, 3.7132610324499474`*^9}, {3.713261075884906*^9, 
   3.713261088728733*^9}, {3.713261130434133*^9, 3.713261149036117*^9}, {
   3.7132611849243603`*^9, 3.7132611850904217`*^9}, {3.713261308398665*^9, 
   3.713261362591132*^9}, {3.7132614080968943`*^9, 3.713261418237978*^9}, {
   3.713261503519844*^9, 3.713261575487731*^9}, {3.713261606302849*^9, 
   3.713261608471685*^9}, {3.713261675536581*^9, 3.7132617730431957`*^9}, {
   3.7132628769562807`*^9, 3.713262902060273*^9}, {3.7132629411877193`*^9, 
   3.713262972458766*^9}, {3.713497308178856*^9, 3.713497311117917*^9}, {
   3.7134975717584867`*^9, 3.71349757189139*^9}, {3.7134976066938972`*^9, 
   3.7134976090462093`*^9}, {3.713588548318825*^9, 3.7135886446923227`*^9}, {
   3.71360308316119*^9, 3.7136031245029917`*^9}, {3.713604419569841*^9, 
   3.713604489759857*^9}, {3.713604571895423*^9, 3.713604587756934*^9}, {
   3.713604657988145*^9, 3.7136046586250687`*^9}, {3.714368625065659*^9, 
   3.714368677606341*^9}, {3.714368711557106*^9, 3.7143687468505793`*^9}, {
   3.7143688423652163`*^9, 3.714368893670738*^9}, {3.7143691901424303`*^9, 
   3.714369196393856*^9}, {3.7143692468223867`*^9, 3.714369320979141*^9}, {
   3.7143694816793833`*^9, 3.714369533987314*^9}, {3.714383361847651*^9, 
   3.71438336499629*^9}, {3.714457630929338*^9, 3.714457636104167*^9}, {
   3.716614813072504*^9, 3.716614815003395*^9}, {3.7166159509002*^9, 
   3.71661595367447*^9}, {3.7166160223818274`*^9, 3.716616068780747*^9}, {
   3.717740896766366*^9, 3.717740919790469*^9}, {3.717828717817094*^9, 
   3.717828728359373*^9}, 3.717829526691352*^9, {3.717829561834627*^9, 
   3.717829567842368*^9}, {3.717829711332901*^9, 3.7178297138923473`*^9}, {
   3.717829820148017*^9, 3.71782984300292*^9}, {3.717829873857195*^9, 
   3.71782999705438*^9}, {3.717830146665791*^9, 3.717830174018708*^9}, {
   3.717830961192195*^9, 3.717830998176252*^9}, {3.7178516904059267`*^9, 
   3.717851800821513*^9}, 3.7178518557153673`*^9, {3.7178520759837837`*^9, 
   3.717852103172366*^9}, {3.7178521808521338`*^9, 3.717852207898322*^9}, {
   3.7263414849809303`*^9, 3.7263415053987093`*^9}, {3.726341580490561*^9, 
   3.726341596874646*^9}, {3.72767546182131*^9, 3.727675588001774*^9}, {
   3.727677599027997*^9, 3.7276776008168907`*^9}, {3.727679791641213*^9, 
   3.7276797934416122`*^9}, 3.7276806018676662`*^9, {3.7276807387029448`*^9, 
   3.7276807612601*^9}, {3.728625292765798*^9, 3.728625298660047*^9}, {
   3.728625349898917*^9, 3.7286253534828987`*^9}, {3.728674363211102*^9, 
   3.7286744204279222`*^9}, {3.728674524191201*^9, 3.728674527109857*^9}, 
   3.728674560656323*^9, {3.737968545464172*^9, 3.737968545759601*^9}, {
   3.742813077399351*^9, 3.742813176814568*^9}, 3.743865455795642*^9, {
   3.7585295289114113`*^9, 3.758529536216538*^9}, {3.759519400784865*^9, 
   3.7595194010715*^9}, 3.762793093433989*^9, {3.7853909358609943`*^9, 
   3.785391074473959*^9}, {3.7853911060423*^9, 3.785391422081409*^9}, {
   3.7853919174900208`*^9, 3.78539211230951*^9}, {3.785392548533534*^9, 
   3.785392574948049*^9}, {3.786968460923102*^9, 3.786968462045446*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[690]:=",ExpressionUUID->"fbc1dde7-d186-4c38-8c08-58bc8d674121"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[691]:=",ExpressionUUID->"568bc022-84ce-464d-861d-64f0650057f5"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetSymmetryOperations", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.684667958524547*^9, 3.684667960120316*^9}, {3.6846686457735453`*^9, 
   3.6846686463667*^9}, {3.684837480210894*^9, 3.684837483365593*^9}, 
   3.685074444164577*^9, 3.68508167559099*^9, 
   3.685700701541703*^9},ExpressionUUID->"6513d779-508b-4c9d-8863-\
2646b2054565"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[564]:=",ExpressionUUID->"22e4ea95-b932-4347-bc71-ab4c6527bfdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSymmetryOperations", "::", "missing"}], "=", 
    "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "GetSymmetryOperations"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<AugmentedMatrix\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<UseCentring\>\"", "\[Rule]", "False"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "GetSymmetryOperations"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.734076134151382*^9, 3.7340761479096622`*^9}, {
  3.7379685760782547`*^9, 3.7379685761314907`*^9}, {3.756711740652343*^9, 
  3.756711763554955*^9}, {3.830418533597329*^9, 3.8304185396776867`*^9}, {
  3.830424829091278*^9, 3.830424856371311*^9}},
 CellLabel->
  "In[849]:=",ExpressionUUID->"f19c32b8-1de4-4bb4-8a27-bb84902a2cdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[568]:=",ExpressionUUID->"b73e844e-1d6f-4680-bf5d-23fc04d7828e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetSymmetryOperations", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"symData", ",", "operations", ",", 
      RowBox[{"pointGroupQ", "=", "False"}], ",", "centeringVectors"}], "}"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"symData", "=", 
      RowBox[{"$GroupSymbolRedirect", "@", 
       RowBox[{"InputCheck", "[", 
        RowBox[{"\"\<GetPointSpaceGroupCrystal\>\"", ",", "input"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"operations", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"symData", ",", "\"\<SymmetryOperations\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "operations"}], "||", 
        RowBox[{"AssociationQ", "@", "operations"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pointGroupQ", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"operations", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MissingQ", "@", "operations"}], ",", "symData", ",", 
             "operations"}], "]"}], ",", "\"\<MatrixOperations\>\""}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", "pointGroupQ"}], "&&", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<UseCentring\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"centeringVectors", "=", 
         RowBox[{"InputCheck", "[", 
          RowBox[{"\"\<GetCentringVectors\>\"", ",", "input"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"operations", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"operations", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"operations", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
                  RowBox[{
                  "centeringVectors", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}]}], ",", "1"}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "@", "centeringVectors"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "operations"}]}], "}"}]}], "]"}], ",", 
           "1"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<AugmentedMatrix\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"GSO$AugmentOperation", "/@", "operations"}], ",", 
       "operations"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, 
   3.685074261443593*^9, {3.685080709320731*^9, 3.685080721804512*^9}, {
   3.685080764745716*^9, 3.6850808805559807`*^9}, {3.68508092962964*^9, 
   3.6850809341411123`*^9}, {3.685081014698917*^9, 3.6850811293896*^9}, {
   3.685081173070106*^9, 3.685081230337706*^9}, 3.685081300925284*^9, {
   3.685081341850636*^9, 3.685081358126698*^9}, {3.6850818355206947`*^9, 
   3.685081835699297*^9}, {3.685120724135499*^9, 3.685120754724948*^9}, {
   3.685120804629829*^9, 3.685120838795546*^9}, 3.685120900087543*^9, {
   3.685120954884305*^9, 3.6851209627033567`*^9}, {3.6851210281209993`*^9, 
   3.685121100111109*^9}, {3.685121131684601*^9, 3.685121175144966*^9}, {
   3.6851212087246017`*^9, 3.6851214248011837`*^9}, {3.685121460013051*^9, 
   3.685121487798689*^9}, {3.6851217072037277`*^9, 3.685121914718864*^9}, {
   3.6851220048170958`*^9, 3.685122005941601*^9}, {3.6851220491750507`*^9, 
   3.685122049974614*^9}, {3.685123695915769*^9, 3.685123701937531*^9}, {
   3.685123734493568*^9, 3.6851237403569517`*^9}, {3.6851241822831697`*^9, 
   3.685124185297907*^9}, {3.685125479207363*^9, 3.685125499047991*^9}, {
   3.6851263077107067`*^9, 3.68512644910214*^9}, {3.685126547021373*^9, 
   3.685126702387765*^9}, {3.685350851724683*^9, 3.685350853038637*^9}, {
   3.6856794352419147`*^9, 3.685679544384791*^9}, {3.685679692841302*^9, 
   3.6856797084427013`*^9}, {3.685679746023396*^9, 3.68567987927634*^9}, {
   3.685685092575449*^9, 3.6856851072626762`*^9}, {3.6856949536468353`*^9, 
   3.685694959496551*^9}, {3.685695023405781*^9, 3.685695049017387*^9}, {
   3.685699158166354*^9, 3.685699158825663*^9}, {3.685700703455983*^9, 
   3.6857007046212263`*^9}, {3.685702859526775*^9, 3.685702879954515*^9}, {
   3.717740903622292*^9, 3.717740919923519*^9}, {3.727505260288527*^9, 
   3.7275052607324343`*^9}, {3.72751425216635*^9, 3.7275142589027233`*^9}, {
   3.727514317450564*^9, 3.727514334992009*^9}, {3.727514377326157*^9, 
   3.727514442630692*^9}, {3.7275145339976892`*^9, 3.7275145367939262`*^9}, {
   3.727547164727139*^9, 3.7275471776929483`*^9}, {3.727677154651916*^9, 
   3.727677154917931*^9}, {3.734076226619268*^9, 3.734076285681925*^9}, {
   3.734076434114067*^9, 3.734076442966711*^9}, 3.734076483606106*^9, {
   3.7340808632864323`*^9, 3.734080953803822*^9}, {3.734080986930374*^9, 
   3.734081101183668*^9}, {3.7340820059912653`*^9, 3.734082109729949*^9}, {
   3.734082146450555*^9, 3.7340821634971313`*^9}, {3.734082297607605*^9, 
   3.734082329565339*^9}, 3.73408240619228*^9, 3.737968576183352*^9, 
   3.743865455889378*^9, {3.758529538846924*^9, 3.758529548927311*^9}, {
   3.759519411749242*^9, 3.759519412091115*^9}, 3.762793093451117*^9, {
   3.786968468177456*^9, 3.786968480063651*^9}, {3.786968844574111*^9, 
   3.786968847349703*^9}, {3.8304187522200737`*^9, 3.8304189060446463`*^9}, {
   3.8304190866766443`*^9, 3.830419107491737*^9}, {3.830419297844837*^9, 
   3.830419341603291*^9}, {3.8304194014414186`*^9, 3.830419403536846*^9}, {
   3.830419632312839*^9, 3.8304197890311003`*^9}, {3.830419864718289*^9, 
   3.830419887996809*^9}, {3.8304199604115887`*^9, 3.830420051259441*^9}, {
   3.830420103585454*^9, 3.830420140736999*^9}, {3.830420257218768*^9, 
   3.830420281475507*^9}, {3.830420745317636*^9, 3.830420764322356*^9}, {
   3.830420814095933*^9, 3.8304208159574137`*^9}, {3.830420880394525*^9, 
   3.830420939694368*^9}, {3.8304210815478973`*^9, 3.830421151113655*^9}, {
   3.830421183204404*^9, 3.8304211854495897`*^9}, {3.830421265619823*^9, 
   3.830421348606834*^9}, {3.830421507141693*^9, 3.830421508899123*^9}, {
   3.830424670912216*^9, 3.830424808495482*^9}, 3.830424926480537*^9, {
   3.830425821353731*^9, 3.830425828635159*^9}, {3.830432899412693*^9, 
   3.83043290635485*^9}, {3.8304371339145193`*^9, 3.8304371373431664`*^9}, {
   3.830437175865596*^9, 3.830437232006667*^9}, {3.8304392621928663`*^9, 
   3.8304393214410553`*^9}, {3.830439414135427*^9, 3.830439414428596*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[1029]:=",ExpressionUUID->"aeb99971-88fd-4f00-8e59-31cf01b4b0a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GSO$AugmentOperation", "[", 
   RowBox[{"{", 
    RowBox[{"matrix_", ",", 
     RowBox[{"vector_", ":", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], "]"}], ":=", 
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"matrix", ",", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", "vector", "}"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, 
   3.685074261443593*^9, {3.685080709320731*^9, 3.685080721804512*^9}, {
   3.685080764745716*^9, 3.6850808805559807`*^9}, {3.68508092962964*^9, 
   3.6850809341411123`*^9}, {3.685081014698917*^9, 3.6850811293896*^9}, {
   3.685081173070106*^9, 3.685081230337706*^9}, 3.685081300925284*^9, {
   3.685081341850636*^9, 3.685081358126698*^9}, {3.6850818355206947`*^9, 
   3.685081835699297*^9}, {3.685120724135499*^9, 3.685120754724948*^9}, {
   3.685120804629829*^9, 3.685120838795546*^9}, 3.685120900087543*^9, {
   3.685120954884305*^9, 3.6851209627033567`*^9}, {3.6851210281209993`*^9, 
   3.685121100111109*^9}, {3.685121131684601*^9, 3.685121175144966*^9}, {
   3.6851212087246017`*^9, 3.6851214248011837`*^9}, {3.685121460013051*^9, 
   3.685121487798689*^9}, {3.6851217072037277`*^9, 3.685121914718864*^9}, {
   3.6851220048170958`*^9, 3.685122005941601*^9}, {3.6851220491750507`*^9, 
   3.685122049974614*^9}, {3.685123695915769*^9, 3.685123701937531*^9}, {
   3.685123734493568*^9, 3.6851237403569517`*^9}, {3.6851241822831697`*^9, 
   3.685124185297907*^9}, {3.685125479207363*^9, 3.685125499047991*^9}, {
   3.6851263077107067`*^9, 3.68512644910214*^9}, {3.685126547021373*^9, 
   3.685126702387765*^9}, {3.685350851724683*^9, 3.685350853038637*^9}, {
   3.6856794352419147`*^9, 3.685679544384791*^9}, {3.685679692841302*^9, 
   3.6856797084427013`*^9}, {3.685679746023396*^9, 3.68567987927634*^9}, {
   3.685685092575449*^9, 3.6856851072626762`*^9}, {3.6856949536468353`*^9, 
   3.685694959496551*^9}, {3.685695023405781*^9, 3.685695049017387*^9}, {
   3.685699158166354*^9, 3.685699158825663*^9}, {3.685700703455983*^9, 
   3.6857007046212263`*^9}, {3.685702859526775*^9, 3.685702879954515*^9}, {
   3.717740903622292*^9, 3.717740919923519*^9}, {3.727505260288527*^9, 
   3.7275052607324343`*^9}, {3.72751425216635*^9, 3.7275142589027233`*^9}, {
   3.727514317450564*^9, 3.727514334992009*^9}, {3.727514377326157*^9, 
   3.727514442630692*^9}, {3.7275145339976892`*^9, 3.7275145367939262`*^9}, {
   3.727547164727139*^9, 3.7275471776929483`*^9}, {3.727677154651916*^9, 
   3.727677154917931*^9}, {3.734076226619268*^9, 3.734076285681925*^9}, {
   3.734076434114067*^9, 3.734076442966711*^9}, 3.734076483606106*^9, {
   3.7340808632864323`*^9, 3.734080953803822*^9}, {3.734080986930374*^9, 
   3.734081101183668*^9}, {3.7340820059912653`*^9, 3.734082109729949*^9}, {
   3.734082146450555*^9, 3.7340821634971313`*^9}, {3.734082297607605*^9, 
   3.734082329565339*^9}, 3.73408240619228*^9, 3.737968576183352*^9, 
   3.743865455889378*^9, {3.758529538846924*^9, 3.758529548927311*^9}, {
   3.759519411749242*^9, 3.759519412091115*^9}, 3.762793093451117*^9, {
   3.786968468177456*^9, 3.786968480063651*^9}, {3.786968844574111*^9, 
   3.786968847349703*^9}, {3.8304187522200737`*^9, 3.8304189060446463`*^9}, {
   3.8304190866766443`*^9, 3.830419107491737*^9}, {3.830419297844837*^9, 
   3.830419341603291*^9}, {3.8304194014414186`*^9, 3.830419403536846*^9}, {
   3.830419632312839*^9, 3.8304197890311003`*^9}, {3.830419864718289*^9, 
   3.830419887996809*^9}, {3.8304199604115887`*^9, 3.830420051259441*^9}, {
   3.830420103585454*^9, 3.830420140736999*^9}, {3.830420257218768*^9, 
   3.8304203097955217`*^9}, {3.830420452477396*^9, 3.8304204832092657`*^9}, {
   3.83042071905753*^9, 3.8304207332111053`*^9}, {3.830420781843957*^9, 
   3.830420806332467*^9}, 3.83042492151313*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[570]:=",ExpressionUUID->"937f2180-c24e-4b56-a1ce-18a923f8d867"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[571]:=",ExpressionUUID->"73966252-1630-4cea-b0a8-cb4299d45836"]
}, Closed]],

Cell[CellGroupData[{

Cell["ImportCrystalData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, 
   3.717942205149007*^9, {3.7268980577164307`*^9, 
   3.726898057878839*^9}},ExpressionUUID->"5037ea76-deeb-4152-a2c1-\
0e470ff06c4f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[699]:=",ExpressionUUID->"e92e519b-0ea3-4f22-b776-30b8e5bbb859"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "subdataInteger"}], "=", 
   "\"\<\\\"\!\(\*StyleBox[\"ExtractSubdata\", \"Program\"]\)\\\" must be a \
positive integer.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "subdataLength"}], "=", 
   "\"\<The \!\(\*StyleBox[\".\", \"Program\"]\)\!\(\*StyleBox[\"cif\", \
\"Program\"]\) file has a subdata length of `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "latticeParameters"}], "=", 
   "\"\<No lattice parameters were located, or they have an invalid \
form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "atomData"}], "=", 
   "\"\<No atom data was located.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "SG"}], "=", 
   "\"\<Could not determine space group. 'P1' will be used.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "cell"}], "=", 
   "\"\<Could not work out the unit cell properly.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "notMaXrd"}], "=", 
   "\"\<Data collected using `1` radiation. Errors may occur.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "modulation"}], "=", 
   "\"\<Modulated structure detected. Errors may occur.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImportCrystalData", "::", "SpecialLabel"}], "=", 
    "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is a reserved label and should \
not be used.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ImportCrystalData"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<DataFile\>\"", "\[Rule]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "$MaXrdPath", ",", "\"\<UserData\>\"", ",", 
          "\"\<CrystalData.m\>\""}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ExtractSubdata\>\"", "\[Rule]", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<IgnoreIonCharge\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Notes\>\"", "\[Rule]", 
       RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<RoundAnglesThreshold\>\"", "\[Rule]", "0.001"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<OverwriteWarning\>\"", "\[Rule]", "True"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ImportCrystalData"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"___", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.66810571214802*^9, {3.6681867516522207`*^9, 
   3.668186778354513*^9}, {3.6681868394172163`*^9, 3.6681868614325943`*^9}, {
   3.668187374101748*^9, 3.6681874104278383`*^9}, {3.668187695125526*^9, 
   3.668187730468417*^9}, {3.668188056044814*^9, 3.668188056876872*^9}, {
   3.6681926250344687`*^9, 3.668192625250432*^9}, 3.68166923708845*^9, {
   3.6817064191712627`*^9, 3.68170642414537*^9}, {3.6817239114596*^9, 
   3.681723955601696*^9}, {3.681724223652172*^9, 3.681724224172266*^9}, {
   3.6818128705108147`*^9, 3.681812886108671*^9}, {3.681819874858591*^9, 
   3.681819895264824*^9}, {3.681835709479094*^9, 3.681835743293057*^9}, {
   3.682100938006762*^9, 3.682100938717538*^9}, {3.683537673194815*^9, 
   3.683537695846451*^9}, {3.683537801117275*^9, 3.683537820368045*^9}, {
   3.6835378509602337`*^9, 3.6835379652168307`*^9}, {3.683872568026477*^9, 
   3.6838725813488774`*^9}, {3.6838755364193954`*^9, 
   3.6838755630017953`*^9}, {3.683875596619796*^9, 3.6838755997709956`*^9}, {
   3.683883154459938*^9, 3.6838831559107385`*^9}, {3.6838834647439404`*^9, 
   3.68388346822274*^9}, 3.6838844948587465`*^9, {3.683884644312748*^9, 
   3.683884657962748*^9}, {3.6838850595535507`*^9, 3.6838850748883505`*^9}, {
   3.683885134589551*^9, 3.6838851736519513`*^9}, {3.683913171307146*^9, 
   3.683913207514256*^9}, {3.6839171824682417`*^9, 3.683917209618238*^9}, {
   3.6839469879120827`*^9, 3.683947021990581*^9}, 3.683966169680979*^9, {
   3.683966389814184*^9, 3.683966401444254*^9}, {3.6839672153149443`*^9, 
   3.683967216968305*^9}, 3.685383224383915*^9, 3.6865396500180807`*^9, {
   3.6865474433420763`*^9, 3.6865474810423117`*^9}, {3.717394967952651*^9, 
   3.717394985509343*^9}, {3.7173986023852253`*^9, 3.717398648986843*^9}, {
   3.717942206289736*^9, 3.717942206316785*^9}, {3.717951917348363*^9, 
   3.717951925065959*^9}, {3.718014808848607*^9, 3.718014817499877*^9}, 
   3.718015826329137*^9, 3.718016203248323*^9, {3.72111992623072*^9, 
   3.721119960300297*^9}, {3.73736723509699*^9, 3.737367235446919*^9}, {
   3.737374290135022*^9, 3.737374293045693*^9}, {3.738307378688077*^9, 
   3.738307378902713*^9}, {3.739209258179865*^9, 3.739209258423847*^9}, {
   3.739209866595991*^9, 3.739209867810956*^9}, {3.739251594550383*^9, 
   3.739251605678607*^9}, {3.7392653600532627`*^9, 3.739265382579735*^9}, {
   3.739502515356379*^9, 3.7395025380522223`*^9}, {3.739503650580277*^9, 
   3.7395036705144863`*^9}, {3.7395047560359173`*^9, 3.739504756236701*^9}, 
   3.743865412368585*^9, {3.7567124299510717`*^9, 3.756712434787074*^9}, {
   3.756712488661512*^9, 3.756712490705117*^9}, {3.780117202234179*^9, 
   3.780117203032283*^9}, {3.787914610923992*^9, 3.787914612145852*^9}, {
   3.807984457845402*^9, 3.807984458936859*^9}},
 CellLabel->
  "In[700]:=",ExpressionUUID->"f22ad440-d639-405c-ace0-7115c9febf3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[711]:=",ExpressionUUID->"a01f8dab-f887-4343-8669-820d33ddcd7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportCrystalData", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"CrystalName_String", ",", "\[IndentingNewLine]", 
      RowBox[{"ChemicalFormula", ":", 
       RowBox[{"_", "?", "StringQ"}], ":", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Z", ":", 
       RowBox[{"_", "?", "IntegerQ"}], ":", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SpaceGroup_", ":", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Wavelength", ":", 
       RowBox[{"_", "?", "NumericQ"}], ":", 
       RowBox[{"-", "1"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "GetLatticeParameters_List", ",", 
    "\[IndentingNewLine]", "AtomData_List", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "choice", ",", "name", ",", "sg", ",", "cell", ",", "\[Delta]", ",", 
      "fr", ",", "latticeItem", ",", "\[Lambda]", ",", "itemAtomData", ",", 
      "item", ",", 
      RowBox[{"dataFile", "=", 
       RowBox[{"OptionValue", "[", "\"\<DataFile\>\"", "]"}]}], ",", "temp"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Check", " ", "if", " ", "name", " ", 
      "already", " ", "exists", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"CrystalName", "===", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"name", "=", 
        RowBox[{"\"\<ImportedCrystal_\>\"", "<>", 
         RowBox[{"DateString", "[", "\"\<ISODate\>\"", "]"}]}]}], ",", 
       RowBox[{"name", "=", "CrystalName"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<OverwriteWarning\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"$CrystalData", ",", "name"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"choice", "=", 
           RowBox[{"ChoiceDialog", "[", 
            RowBox[{
            "\"\<\[LeftGuillemet]\>\"", "<>", "name", "<>", 
             "\[IndentingNewLine]", 
             "\"\<\[RightGuillemet] already exists in $CrystalData.\\nDo you \
want to overwrite this entry?\>\""}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "choice"}], ",", 
          RowBox[{"Return", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", "Space"}]}], " ", "Group", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GetPointSpaceGroupCrystal\>\"", ",", "SpaceGroup"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"ToStandardSetting", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Lattice", " ", "parameters", " ", "*", 
       
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"AllTrue", "[", 
          RowBox[{"GetLatticeParameters", ",", 
           RowBox[{
            RowBox[{"NumericQ", "[", "#", "]"}], "&"}]}], "]"}]}], "||", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "@", "GetLatticeParameters"}], "\[NotEqual]", 
         "6"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Message", "[", 
        RowBox[{"ImportCrystalData", "::", "latticeParameters"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Round", " ", "angles"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"cell", "=", "GetLatticeParameters"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"OptionValue", "[", "\"\<RoundAnglesThreshold\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"fr", "=", 
         RowBox[{"FractionalPart", "@", 
          RowBox[{
          "cell", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fr", ">", "0.5"}], ",", 
          RowBox[{"fr", "=", 
           RowBox[{"1", "-", "fr"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fr", "\[LessEqual]", "\[Delta]"}], ",", 
          RowBox[{
           RowBox[{
           "cell", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"Round", "@", 
            RowBox[{
            "cell", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4", ",", "6"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Use", " ", "units"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"i", "\[LessEqual]", "3"}], ",", 
           RowBox[{
            RowBox[{
            "cell", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"Quantity", "[", 
             RowBox[{
              RowBox[{
              "cell", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", "\"\<Angstroms\>\""}], "]"}]}], ",", "\[IndentingNewLine]",
            "\t", 
           RowBox[{"i", "\[GreaterEqual]", "4"}], ",", 
           RowBox[{
            RowBox[{
            "cell", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"Quantity", "[", 
             RowBox[{
              RowBox[{
              "cell", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", "\"\<Degrees\>\""}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Prepare", " ", "association", " ", "entry"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"latticeItem", "=", 
      RowBox[{"Association", "@", "\[IndentingNewLine]", "\t", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", 
           "\"\<\[Alpha]\>\"", ",", "\"\<\[Beta]\>\"", ",", 
           "\"\<\[Gamma]\>\""}], "}"}], "\[Rule]", "cell"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Wavelength", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Use", " ", "units"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"Quantity", "[", 
         RowBox[{"Wavelength", ",", "\"\<Angstroms\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", "Wavelength"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Atom", " ", "data", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AtomData", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"itemAtomData", "=", 
        RowBox[{"{", 
         RowBox[{"<|", "|>"}], "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"itemAtomData", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DeleteMissing", "@", 
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{
              "AtomData", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
               "\"\<Element\>\"", ",", "\[IndentingNewLine]", 
                "\"\<OccupationFactor\>\"", ",", "\[IndentingNewLine]", 
                "\"\<SiteSymmetryMultiplicity\>\"", ",", 
                "\[IndentingNewLine]", "\"\<SiteSymmetryOrder\>\"", ",", 
                "\[IndentingNewLine]", "\"\<FractionalCoordinates\>\"", ",", 
                "\[IndentingNewLine]", "\"\<DisplacementParameters\>\"", ",", 
                "\[IndentingNewLine]", "\"\<Type\>\""}], "}"}]}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "AtomData"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{
              RowBox[{"First", "@", "itemAtomData"}], ",", "k"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"itemAtomData", "=", 
             RowBox[{"MapAt", "[", "\[IndentingNewLine]", 
              RowBox[{"ToExpression", ",", "itemAtomData", ",", 
               RowBox[{"{", 
                RowBox[{"All", ",", 
                 RowBox[{"Key", "[", "k", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"{", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<OccupationFactor\>\"", ",", "\[IndentingNewLine]", "\t", 
              "\"\<SiteSymmetryMultiplicity\>\"", ",", "\[IndentingNewLine]", 
              "\t", "\"\<SiteSymmetryOrder\>\"", ",", "\[IndentingNewLine]", 
              "\t", "\"\<DisplacementParameters\>\""}], "}"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Checking", " ", "strings", " ", "in", " ", "coordinates"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"itemAtomData", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "\"\<FractionalCoordinates\>\""}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{"itemAtomData", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "\"\<FractionalCoordinates\>\""}], 
             "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"x_String", "\[RuleDelayed]", 
             RowBox[{"ToExpression", "[", "x", "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "itemAtomData"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "item", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"item", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\"\<ChemicalFormula\>\"", "\[Rule]", "ChemicalFormula"}], 
        ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<FormulaUnits\>\"", "\[Rule]", "Z"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<SpaceGroup\>\"", "\[Rule]", "sg"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<LatticeParameters\>\"", "\[Rule]", "latticeItem"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<Wavelength\>\"", "\[Rule]", "\[Lambda]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<AtomData\>\"", "\[Rule]", "itemAtomData"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<Notes\>\"", "\[Rule]", 
         RowBox[{"OptionValue", "[", "\"\<Notes\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "\t", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Delete", " ", "certain", " ", "keys"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"item", "[", "\"\<ChemicalFormula\>\"", "]"}], "===", 
        "\"\<\>\""}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{"item", ",", "\"\<ChemicalFormula\>\""}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"item", "[", "\"\<Notes\>\"", "]"}], "===", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{"item", ",", "\"\<Notes\>\""}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"Positive", "@", 
         RowBox[{"item", "[", "\"\<Wavelength\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{"item", ",", "\"\<Wavelength\>\""}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Z", "===", "0"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{"item", ",", "\"\<FormulaUnits\>\""}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", " ", "all", " ", "occupation", " ", "factors"}], " ", 
        "=", " ", "1"}], ",", " ", 
       RowBox[{"delete", " ", "column"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"item", "\[LeftDoubleBracket]", 
       RowBox[{
       "\"\<AtomData\>\"", ",", "All", ",", "\"\<OccupationFactor\>\""}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"N", "@", "temp"}], ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "1."}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"item", "\[LeftDoubleBracket]", 
         RowBox[{"\"\<AtomData\>\"", ",", "All"}], "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{"KeyDrop", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"item", "\[LeftDoubleBracket]", 
           RowBox[{"\"\<AtomData\>\"", ",", "All"}], 
           "\[RightDoubleBracket]"}], ",", "\"\<OccupationFactor\>\""}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", " ", "all", " ", "displacement", " ", "parameters"}], 
        " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"delete", " ", "column"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"item", "\[LeftDoubleBracket]", 
       RowBox[{
       "\"\<AtomData\>\"", ",", "All", ",", 
        "\"\<DisplacementParameters\>\""}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"N", "@", "temp"}], ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "0."}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"item", "\[LeftDoubleBracket]", 
         RowBox[{"\"\<AtomData\>\"", ",", "All"}], "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{"KeyDrop", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"item", "\[LeftDoubleBracket]", 
           RowBox[{"\"\<AtomData\>\"", ",", "All"}], 
           "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"\"\<DisplacementParameters\>\"", ",", "\"\<Type\>\""}], 
           "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{
      "\"\<Update$CrystalDataFile\>\"", ",", "dataFile", ",", "name", ",", 
       "item"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<ShallowDisplayCrystal\>\"", ",", "name"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682676951614175*^9, 
   3.682677014282371*^9}, {3.682743302412827*^9, 3.682743302984312*^9}, {
   3.68283882611203*^9, 3.682838829861582*^9}, {3.682839274791851*^9, 
   3.6828392951419153`*^9}, {3.6828394322211113`*^9, 3.682839485235921*^9}, {
   3.682839522176443*^9, 3.6828396062695837`*^9}, {3.6838754373593946`*^9, 
   3.6838754620697947`*^9}, {3.683875498464595*^9, 3.6838755411461954`*^9}, {
   3.6838755757937956`*^9, 3.6838756168373957`*^9}, {3.683877299628604*^9, 
   3.683877302748604*^9}, {3.683877625231806*^9, 3.683877735617407*^9}, {
   3.6838777700934067`*^9, 3.683877786629407*^9}, {3.683877824459407*^9, 
   3.683877883255808*^9}, {3.683877991675808*^9, 3.6838780441230087`*^9}, 
   3.6838781541810093`*^9, {3.6838785155238113`*^9, 3.6838785162258115`*^9}, {
   3.683883648168741*^9, 3.6838836561403418`*^9}, {3.6838836902887416`*^9, 
   3.683884028949144*^9}, {3.6838840713655443`*^9, 3.6838841621887445`*^9}, {
   3.683885078039551*^9, 3.6838850783983507`*^9}, {3.6840604337874165`*^9, 
   3.6840604341150165`*^9}, {3.684060677475018*^9, 3.6840607181130185`*^9}, {
   3.684064659458737*^9, 3.684064660824226*^9}, {3.684065013290655*^9, 
   3.6840651007018023`*^9}, 3.684091992501087*^9, {3.684092047571642*^9, 
   3.684092056517186*^9}, {3.684092093787097*^9, 3.684092109418057*^9}, {
   3.684092154139434*^9, 3.684092154840337*^9}, 3.684092215316921*^9, {
   3.684092293078665*^9, 3.684092296157777*^9}, {3.684092465243285*^9, 
   3.684092482747108*^9}, {3.684092743174653*^9, 3.684092745262229*^9}, {
   3.684122119660481*^9, 3.684122119802287*^9}, {3.684122540865759*^9, 
   3.684122543651548*^9}, {3.684122650380859*^9, 3.684122682496744*^9}, {
   3.684122718574717*^9, 3.6841227264847918`*^9}, {3.6841275607768307`*^9, 
   3.684127629729051*^9}, {3.684127891116247*^9, 3.684127892571128*^9}, {
   3.684483205713032*^9, 3.684483211262594*^9}, {3.684483790403738*^9, 
   3.684483795123879*^9}, {3.685285890213419*^9, 3.685285902411302*^9}, {
   3.6852859679097023`*^9, 3.685285972385825*^9}, {3.686539651186246*^9, 
   3.686539652401841*^9}, {3.6865488692683764`*^9, 3.686548871875628*^9}, {
   3.686549678453073*^9, 3.686549812821848*^9}, {3.6865498480750237`*^9, 
   3.6865498666827497`*^9}, {3.686549900073018*^9, 3.686549936893228*^9}, {
   3.6865499930279913`*^9, 3.686550060430197*^9}, {3.686550112225142*^9, 
   3.6865501356261597`*^9}, {3.6865501835287313`*^9, 3.686550267746396*^9}, {
   3.686550530272417*^9, 3.686550577558567*^9}, {3.686636392798913*^9, 
   3.686636458512154*^9}, {3.686636825377118*^9, 3.6866368257130737`*^9}, {
   3.690876148810753*^9, 3.690876180435878*^9}, {3.690888859078938*^9, 
   3.690888904056428*^9}, {3.6908895958854427`*^9, 3.690889596291432*^9}, {
   3.690889701343381*^9, 3.690889744880413*^9}, {3.690889780680581*^9, 
   3.690889820427496*^9}, {3.690890032406951*^9, 3.690890053995669*^9}, {
   3.690890444323526*^9, 3.6908904470700083`*^9}, {3.690890814997316*^9, 
   3.690890815831262*^9}, {3.690891007984201*^9, 3.690891031395673*^9}, {
   3.690891133552911*^9, 3.690891137120051*^9}, {3.690891176841043*^9, 
   3.6908911898237658`*^9}, {3.690891626381727*^9, 3.690891627189205*^9}, {
   3.690891712786038*^9, 3.690891713655484*^9}, {3.690891758219355*^9, 
   3.6908917585035152`*^9}, {3.690891852466124*^9, 3.690891855496437*^9}, {
   3.690892074279029*^9, 3.690892122266016*^9}, {3.690892157891358*^9, 
   3.690892159507001*^9}, {3.690892460974785*^9, 3.690892488819858*^9}, {
   3.690892643174568*^9, 3.6908926561424713`*^9}, {3.690892695920432*^9, 
   3.690892761646077*^9}, {3.705381561172036*^9, 3.705381563232807*^9}, {
   3.705381730133943*^9, 3.705381731010749*^9}, {3.705381761485899*^9, 
   3.7053817625813923`*^9}, {3.705381961091528*^9, 3.705381961739848*^9}, {
   3.705382886776128*^9, 3.705382910719694*^9}, {3.70538298540779*^9, 
   3.705382999790876*^9}, {3.705383200859761*^9, 3.705383201317832*^9}, {
   3.712039804004003*^9, 3.712039837410914*^9}, {3.712039888007128*^9, 
   3.712039976950371*^9}, {3.712040039595913*^9, 3.7120400428353252`*^9}, {
   3.71437291775845*^9, 3.714372920591165*^9}, {3.714373013115429*^9, 
   3.714373111168646*^9}, {3.714381611549461*^9, 3.71438168878443*^9}, {
   3.71438182004793*^9, 3.7143818226490498`*^9}, {3.714913981660367*^9, 
   3.714913993459426*^9}, {3.716819647322055*^9, 3.716819649144059*^9}, {
   3.716819738528111*^9, 3.716819741943658*^9}, {3.716819893292836*^9, 
   3.716819911259316*^9}, {3.716820049225861*^9, 3.716820110288262*^9}, {
   3.716820157664789*^9, 3.7168201582227993`*^9}, 3.716820271941564*^9, {
   3.7173994935959806`*^9, 3.717399535062772*^9}, 3.717740896966391*^9, {
   3.7179422063447857`*^9, 3.717942206357648*^9}, {3.7180130748350773`*^9, 
   3.7180130910990973`*^9}, {3.7180148242351923`*^9, 
   3.7180148311457357`*^9}, {3.718014898102281*^9, 3.718014898233629*^9}, {
   3.718015243930171*^9, 3.718015282584255*^9}, 3.718015315920961*^9, {
   3.7180156461055937`*^9, 3.718015755165243*^9}, {3.7180157967662783`*^9, 
   3.718015829733087*^9}, {3.7180158831958733`*^9, 3.7180160053342524`*^9}, {
   3.718016239795858*^9, 3.718016245499477*^9}, {3.71844534122999*^9, 
   3.718445351214416*^9}, {3.718445534462845*^9, 3.718445544887985*^9}, {
   3.726464354380864*^9, 3.726464357211823*^9}, {3.7264644108631153`*^9, 
   3.72646442689914*^9}, {3.726470847882986*^9, 3.726470865128058*^9}, {
   3.7264709109909163`*^9, 3.72647099076378*^9}, {3.726471087701652*^9, 
   3.726471104816641*^9}, {3.726474185878257*^9, 3.726474189604694*^9}, 
   3.726474223211694*^9, {3.7264744761979103`*^9, 3.726474483011284*^9}, {
   3.7264745194447823`*^9, 3.72647451967942*^9}, {3.726904493491934*^9, 
   3.726904531469075*^9}, {3.726905529651862*^9, 3.726905645699419*^9}, 
   3.727164723614419*^9, {3.7271647636423893`*^9, 3.727164798426024*^9}, {
   3.727164958421529*^9, 3.727164988222075*^9}, {3.727165042310004*^9, 
   3.7271650488753567`*^9}, {3.727679329728222*^9, 3.727679384869399*^9}, 
   3.72767941926967*^9, {3.7301441859807997`*^9, 3.7301441909532824`*^9}, {
   3.7305437419606*^9, 3.7305437430825768`*^9}, {3.730544137286261*^9, 
   3.730544137542388*^9}, {3.730544272563367*^9, 3.73054429091084*^9}, {
   3.734086643112812*^9, 3.734086650280046*^9}, {3.734086721542708*^9, 
   3.734086741504282*^9}, {3.734086996113962*^9, 3.7340869980551243`*^9}, 
   3.73408730066591*^9, {3.734087391864551*^9, 3.734087401446116*^9}, {
   3.734087436367076*^9, 3.734087460116948*^9}, {3.7340876420579853`*^9, 
   3.7340876423708982`*^9}, {3.734087932780149*^9, 3.734088059863969*^9}, {
   3.734088377921844*^9, 3.7340884199114656`*^9}, {3.734088509745023*^9, 
   3.734088518509304*^9}, {3.7340885760800037`*^9, 3.734088595190104*^9}, 
   3.7340888079526997`*^9, {3.734088951665037*^9, 3.734089018509555*^9}, {
   3.734092222193697*^9, 3.73409229550977*^9}, {3.734092364593038*^9, 
   3.73409237038064*^9}, {3.734097452322815*^9, 3.7340974727356043`*^9}, {
   3.7340976191960287`*^9, 3.734097652441235*^9}, {3.73410054000917*^9, 
   3.734100541951701*^9}, {3.735030627906562*^9, 3.7350306391261253`*^9}, {
   3.7350306883908873`*^9, 3.7350307008109818`*^9}, {3.7350309342608757`*^9, 
   3.735030941583761*^9}, {3.7350311561314373`*^9, 3.73503121656846*^9}, {
   3.735031371649341*^9, 3.73503137200354*^9}, {3.7350314486109877`*^9, 
   3.735031497236422*^9}, {3.735031527623269*^9, 3.735031536838859*^9}, {
   3.737968498976862*^9, 3.737968499224889*^9}, {3.758529550852418*^9, 
   3.758529723846592*^9}, {3.759519421858753*^9, 3.759519422273179*^9}, 
   3.762793093487715*^9, {3.767429226854641*^9, 3.767429227023518*^9}, {
   3.767429361529838*^9, 3.767429372416533*^9}, {3.7741631032659397`*^9, 
   3.774163106115437*^9}, {3.7801172241973057`*^9, 3.780117258802784*^9}, {
   3.780117937312771*^9, 3.7801179398540087`*^9}, {3.7869684882693243`*^9, 
   3.786968489587207*^9}, {3.7874610484996147`*^9, 3.787461049168895*^9}, 
   3.7879189518581457`*^9, {3.787919893314981*^9, 3.787919899779025*^9}, 
   3.787920620467207*^9, {3.787920703361155*^9, 3.787920714504895*^9}, {
   3.787920784495517*^9, 3.787920869957136*^9}, {3.7879209123963003`*^9, 
   3.787920926755817*^9}, {3.787921181054405*^9, 3.7879212051335506`*^9}, {
   3.807981747899035*^9, 3.8079817644104156`*^9}, {3.808076122478218*^9, 
   3.80807614447685*^9}, {3.808105402037675*^9, 3.808105473542317*^9}, {
   3.808105508712895*^9, 3.80810550943211*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[712]:=",ExpressionUUID->"8bec8f45-67ff-4553-bdc8-a2a53ef217d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportCrystalData", "[", 
   RowBox[{"ciffile_", ",", 
    RowBox[{"Name_String", ":", "\"\<\>\""}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"A", ".", " ", "Input"}], " ", "check", " ", "and", " ", 
       "setup"}], " ", "*)"}], 
     RowBox[{"name", ",", 
      RowBox[{"specialLabels", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\"\<Void\>\"", "}"}], ",", 
         RowBox[{"Keys", "@", "$PeriodicTable"}]}], "]"}]}], ",", "import", 
      ",", "sub", ",", "endstring", ",", "enc", ",", "left", ",", "mid", ",", 
      "right", ",", "\[IndentingNewLine]", 
      RowBox[{"modulationQ", "=", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"B", ".", " ", "Lattice"}], " ", "parameters"}], " ", "*)"}], 
      "cell", ",", "x", ",", "X", ",", "multipleQ", ",", "parts", ",", 
      "coordCount", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"C", ".", " ", "Atom"}], " ", "data"}], " ", "*)"}], 
      "atomdata", ",", "atomtags", ",", "c", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"D", ".", " ", "Anisotropic"}], " ", "displacement", " ", 
        "parameters", " ", 
        RowBox[{"(", "ADPs", ")"}]}], " ", "*)"}], "anisodata", ",", 
      "anisoOrder", ",", "P", ",", "atomoverview", ",", "tags", ",", "labels",
       ",", "disp", ",", "item", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"E", ".", " ", "Misc"}], " ", "data", " ", "labels", " ", 
        RowBox[{"(", 
         RowBox[{"wavelength", ",", " ", 
          RowBox[{"formula", " ", "units"}]}], ")"}]}], " ", "*)"}], 
      "\[Lambda]", ",", "Z", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"F", ".", " ", "Chemical"}], " ", "formula"}], " ", "*)"}], 
      "formula", ",", "chemicalformula", ",", "L", ",", "l", ",", "r", ",", 
      "checkParentheses", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"G", ".", " ", "Space"}], " ", "group"}], " ", "*)"}], 
      "sgTags", ",", "sgData", ",", "sg", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"H", ".", " ", "Adding"}], " ", "item", " ", "to", " ", 
        "dataset"}], " ", "*)"}], "options", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Misc", " ", "*)"}], "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "check", " ", "and", " ", 
      "setup", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Name", "\[Equal]", "\"\<\>\""}], ",", 
       RowBox[{"name", "=", 
        RowBox[{"FileBaseName", "[", "ciffile", "]"}]}], ",", 
       RowBox[{"name", "=", "Name"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"specialLabels", ",", "name"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ImportCrystalData", "::", "SpecialLabel"}], ",", "name"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".1", ".", " ", "Check"}], " ", "file"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"import", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"ciffile", ",", "\"\<String\>\""}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sub", "=", 
      RowBox[{"OptionValue", "[", "\"\<ExtractSubdata\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
            RowBox[{"Positive", "[", "#", "]"}]}], "&"}], "@", "sub"}], 
         ")"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "subdataInteger"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Auxiliary"}], " ", "variables"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"endstring", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<loop_\>\"", ",", "\"\<\\n\\n\>\"", ",", "\"\<;\>\"", ",", 
        "\"\<#\>\"", ",", "EndOfString"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"enc", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"annotation", "/", "enclosing"}], " ", "marks"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{"left", ",", "mid", ",", "right"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\\!\\(\\*SubscriptBox[\\(\>\"", ",", "\"\<\\), \\(\>\"", ",", 
         "\"\<\\)]\\)\>\""}], "}"}]}],
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True], 
     StyleBox[";",
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".3", ".", " ", "Check"}], " ", "radiation", " ", "type"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<_diffrn_radiation_type\>\"", ",", 
             "\"\<_diffrn_radiation_probe\>\""}], "}"}], 
           "\[IndentingNewLine]", "~~", "Whitespace", "~~", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "enc"}], "}"}], "~~", 
           RowBox[{"t", ":", 
            RowBox[{"LetterCharacter", ".."}]}], "~~", "\"\<\\n\>\""}], "]"}],
          "\[RuleDelayed]", "t"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"temp", ",", "#"}], "]"}], ",", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ImportCrystalData", "::", "notMaXrd"}], ",", "#"}], 
          "]"}]}], "]"}], "\[IndentingNewLine]", "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<neutron\>\"", ",", "\"\<electron\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".4", ".", " ", "Check"}], " ", "for", " ", "modulation"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"import", ",", "\"\<_space_group_ssg_name\>\""}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"modulationQ", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"ImportCrystalData", "::", "modulation"}], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Lattice"}], " ", "parameters", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Extracting"}], " ", "lattice", " ", 
       "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cell", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<_cell_\>\"", "~~", 
              RowBox[{"{", 
               RowBox[{"\"\<length\>\"", ",", "\"\<angle\>\""}], "}"}], "~~", 
              "__", "~~", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"DigitCharacter", ",", "\"\<.\>\""}], "}"}], ".."}]}],
              ")"}]}], "~~", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<(\>\"", ",", "Whitespace"}], "}"}]}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"ToLowerCase", "@", "x"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cell", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "latticeParameters"}], "]"}], ";",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".2", ".", " ", "Check"}], " ", "for", " ", "multiplue", " ", 
       "structures"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"cell", ",", "Whitespace"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "cell"}], ">", "6"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"multipleQ", "=", "True"}], ";", 
        RowBox[{"parts", "=", 
         RowBox[{
          RowBox[{"Length", "[", "cell", "]"}], "/", "6"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Length", "@", "cell"}], "\[Equal]", "6"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"multipleQ", "=", "False"}], ";", 
        RowBox[{"parts", "=", "1"}]}], ",", "\[IndentingNewLine]", "\t", 
       "True", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "cell"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "@", "cell"}]}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Correct", " ", "ordering"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"cell", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Length", "@", "cell"}], "/", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"Length", "@", "cell"}], ",", "6"}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "=", 
         RowBox[{
         "cell", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"x", "=", 
         RowBox[{"X", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"P", "=", 
         RowBox[{"FindPermutation", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "\"\<_cell_length_a\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_length_b\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_length_c\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_angle_alpha\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_angle_beta\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_angle_gamma\>\""}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
         "cell", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
         
         RowBox[{"Permute", "[", 
          RowBox[{"X", ",", "P"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "cell"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"cell", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".3", ".", " ", "Check"}], " ", "subdata", " ", "extraction"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Verify", " ", "with", " ", "fractional", " ", "coordinates"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"coordCount", "=", 
      RowBox[{"StringCount", "[", 
       RowBox[{"import", ",", "\"\<_atom_site_fract_x\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coordCount", "===", "0"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "atomData"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\t", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"parts", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"parts", ",", "coordCount"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"multipleQ", "&&", 
          RowBox[{"sub", ">", "parts"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"!", "multipleQ"}], "&&", 
          RowBox[{"sub", "\[NotEqual]", "1"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ImportCrystalData", "::", "subdataLength"}], ",", 
          "parts"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "parts", "]"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "subdataInteger"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "@", "parts"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extract", " ", "subdata"}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{
       "cell", "\[LeftDoubleBracket]", "sub", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Atom"}], " ", "data", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<AtomData\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Extracting"}], " ", "relevant", " ", "data", 
       " ", "block"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Fractional", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Occupation", " ", "factor"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Site", " ", "symmetry", " ", "multiplicity"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "_atom", "_site", " ", "loop"}], " ", "*)"}],
      "\[IndentingNewLine]", "\t", 
     RowBox[{"atomdata", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"labels", ":", 
            RowBox[{"(", 
             RowBox[{
             "Whitespace", "~~", "\"\<_atom_site_\>\"", "~~", "__", "~~", 
              "\"\<\\n\>\""}], ")"}]}], "~~", 
           RowBox[{"data", ":", 
            RowBox[{"(", 
             RowBox[{"StartOfLine", "~~", 
              RowBox[{"Whitespace", "..."}], "~~", "LetterCharacter", "~~", 
              "__", "~~", "\"\<\\n\>\""}], ")"}]}], "\[IndentingNewLine]", "~~", 
           RowBox[{"{", 
            RowBox[{"endstring", ",", "\"\<_atom_site_aniso\>\"", ",", 
             RowBox[{"\"\<_\>\"", "~~", 
              RowBox[{"Except", "[", "\"\<a\>\"", "]"}]}]}], "}"}]}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"labels", ",", "data"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"No", " ", 
       RowBox[{"data", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"atomdata", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "atomData"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Delete", " ", "cases", " ", "containing", " ", "anisotropy", " ", 
       "data"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"atomdata", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"atomdata", ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"x_", "/;", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{
           "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "\"\<aniso\>\""}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Specify", " ", "sub"}], "-", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"atomdata", "=", 
      RowBox[{
      "atomdata", "\[LeftDoubleBracket]", "sub", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".2", ".", " ", "Organising"}], " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"atomtags", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{
         RowBox[{
         "atomdata", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<_atom_site_\>\"", "~~", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"WordCharacter", ",", "\"\<_\>\""}], "}"}], ".."}]}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"atomdata", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{
        "atomdata", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"\"\<(\>\"", "~~", 
         RowBox[{"DigitCharacter", ".."}], "~~", "\"\<)\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"atomdata", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"StringSplit", "@", "atomdata"}], ",", 
        RowBox[{"Length", "@", "atomtags"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomdata", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"atomdata", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "x", "]"}], "\[NotEqual]", 
          RowBox[{"Length", "[", "atomtags", "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomdata", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", 
        RowBox[{"atomtags", "\[Rule]", 
         RowBox[{"Transpose", "@", "atomdata"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", ".3", " ", "Fixing", " ", "entries"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", " ", "'"}], "site_type", 
        RowBox[{"_symbol", "'"}], " ", "is", " ", "missing"}], ",", " ", 
       RowBox[{
        RowBox[{"copy", " ", "'"}], 
        RowBox[{"site_label", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"atomdata", ",", "\"\<_atom_site_type_symbol\>\""}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"atomdata", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<_atom_site_type_symbol\>\"", "\[Rule]", 
          RowBox[{"atomdata", "[", "\"\<_atom_site_label\>\"", "]"}]}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Process", " ", "and", " ", "check", " ", "elements"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"atomdata", "[", "\"\<_atom_site_type_symbol\>\"", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<InterpretElement\>\"", ",", "temp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Clear", " ", "any", " ", "ion", " ", "charges"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IgnoreIonCharge\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"StringDelete", "[", 
         RowBox[{"temp", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<+\>\"", ",", "\"\<-\>\"", ",", "DigitCharacter"}], 
           "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Update", " ", "'"}], 
       RowBox[{"atomdata", "'"}], " ", 
       RowBox[{"with", " ", "'"}], 
       RowBox[{"temp", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"atomdata", "[", "\"\<_atom_site_type_symbol\>\"", "]"}], "=", 
      "temp"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Anisotropic"}], " ", "displacement", " ", 
       "parameters", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"D", 
        RowBox[{".1", ".", " ", "If"}], " ", "missing"}], ",", " ", 
       RowBox[{
       "use", " ", "default", " ", "values", " ", "for", " ", "ADP"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"First", "@", "atomdata"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"atomdata", ",", "\"\<_atom_site_adp_type\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"atomdata", ",", 
         RowBox[{"\"\<_atom_site_adp_type\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"\"\<Uiso\>\"", ",", "L"}], "]"}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"atomdata", ",", "\"\<_atom_site_U_iso_or_equiv\>\""}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"atomdata", ",", 
         RowBox[{"\"\<_atom_site_U_iso_or_equiv\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "L"}], "]"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"D", 
       RowBox[{".2", ".", " ", "Anisotropic"}], " ", "displacement", " ", 
       "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "\"\<loop_\>\"", "~~", "Whitespace", "~~", "\[IndentingNewLine]", 
           RowBox[{"x", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<_atom_site_aniso\>\"", "~~", "__"}], ")"}]}], "~~", 
           "endstring"}], "]"}], "\[RuleDelayed]", "x"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"anisodata", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Goto", "[", "\"\<OrganiseAtomdata\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"anisodata", "=", 
        RowBox[{
        "anisodata", "\[LeftDoubleBracket]", "sub", 
         "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"D", 
       RowBox[{".3", ".", " ", "Noting"}], " ", "the", " ", "order", " ", 
       RowBox[{"(", "permutation", ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"anisoOrder", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"anisodata", ",", 
         RowBox[{"\"\<U_\>\"", "~~", 
          RowBox[{"DigitCharacter", ".."}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"FindPermutation", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<U_11\>\"", ",", "\"\<U_22\>\"", ",", "\"\<U_33\>\"", ",", 
          "\"\<U_12\>\"", ",", "\"\<U_13\>\"", ",", "\"\<U_23\>\""}], "}"}], 
        ",", "anisoOrder"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Nothing", " ", "there", " ", "to", " ", 
       RowBox[{"extract", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"anisodata", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Shortest", "[", 
           RowBox[{
           "\"\<_atom_site_aniso_\>\"", "~~", "x__", "~~", "Whitespace"}], 
           "]"}], "\[RuleDelayed]", "x"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"c", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"Position", "[", 
         RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"x_", "/;", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"x", ",", "\"\<U\>\""}], "]"}]}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"D", 
       RowBox[{".4", ".", " ", "Extracting"}], " ", "relevant", " ", "data", 
       " ", "and", " ", "trimming"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"anisodata", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Shortest", "[", 
           RowBox[{
           "\"\<_atom_site_aniso\>\"", "~~", "__", "~~", "EndOfLine"}], "]"}],
           "~~", "Whitespace", "~~", 
          RowBox[{"(*", " ", 
           RowBox[{"Last", " ", "line"}], " ", "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"x", ":", 
           RowBox[{"(", 
            RowBox[{"WordCharacter", "~~", "__"}], ")"}]}]}], 
         "\[RuleDelayed]", "x"}]}], 
       RowBox[{"(*", " ", "Content", " ", "*)"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "there", " ", "is", " ", "any", " ", "actual", 
       " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"anisodata", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<OrganiseAtomdata\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"First", "@", "anisodata"}], ",", "Whitespace"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"anisodata", ",", 
        RowBox[{
         RowBox[{"x__", "~~", "\"\<(\>\"", "~~", "__", "~~", "\"\<)\>\""}], 
         "\[RuleDelayed]", "x"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"anisodata", ",", 
        RowBox[{"Length", "@", "temp"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Correcting", " ", "parameter", " ", "order"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"anisodata", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "c"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Permute", "[", 
         RowBox[{"#", ",", "P"}], "]"}], "&"}], "/@", 
       RowBox[{"anisodata", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "c"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Associating", " ", "each", " ", "atom", " ", "with", " ", "values"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"Association", "[", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"anisodata", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
          RowBox[{"anisodata", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "c"}], "\[RightDoubleBracket]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "anisodata"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"D", 
       RowBox[{".5", ".", " ", "Organising"}], " ", "the", " ", "atom", " ", 
       "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<OrganiseAtomdata\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomoverview", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tags", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<_atom_site_occupancy\>\"", ",", "\[IndentingNewLine]", 
        "\"\<_atom_site_site_symmetry_multiplicity\>\"", ",", 
        "\[IndentingNewLine]", "\"\<_atom_site_site_symmetry_order\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"labels", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<OccupationFactor\>\"", ",", "\[IndentingNewLine]", 
        "\"\<SiteSymmetryMultiplicity\>\"", ",", "\[IndentingNewLine]", 
        "\"\<SiteSymmetryOrder\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"item", "=", 
         RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"item", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Element\>\"", "\[Rule]", 
           RowBox[{"atomdata", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<_atom_site_type_symbol\>\"", ",", "i"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"atomdata", ",", 
              RowBox[{
              "tags", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"item", ",", 
              RowBox[{
               RowBox[{
               "labels", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}], "\[Rule]", "\[IndentingNewLine]", 
               RowBox[{"atomdata", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{
                 "tags", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], ",", "i"}], 
                "\[RightDoubleBracket]"}]}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "tags"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"item", ",", 
          RowBox[{
          "\"\<FractionalCoordinates\>\"", "\[Rule]", "\[IndentingNewLine]", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"atomdata", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"\"\<_atom_site_fract_\>\"", "<>", "#"}], ",", "i"}], 
               "\[RightDoubleBracket]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
              "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"atomdata", "\[LeftDoubleBracket]", 
              RowBox[{"\"\<_atom_site_adp_type\>\"", ",", "i"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"-", "3"}]}], "]"}], "===", "\"\<ani\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"disp", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"anisodata", ",", 
             RowBox[{"atomdata", "\[LeftDoubleBracket]", 
              RowBox[{"\"\<_atom_site_label\>\"", ",", "i"}], 
              "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"disp", "=", 
           RowBox[{"atomdata", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<_atom_site_U_iso_or_equiv\>\"", ",", "i"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"item", ",", 
          RowBox[{"\"\<DisplacementParameters\>\"", "\[Rule]", "disp"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"item", ",", 
          RowBox[{"\"\<Type\>\"", "\[Rule]", 
           RowBox[{"atomdata", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<_atom_site_adp_type\>\"", ",", "i"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"AppendTo", "[", 
         RowBox[{"atomoverview", ",", "item"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"First", "@", "atomdata"}]}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"E", ".", " ", "Misc"}], " ", "data", " ", "labels", " ", "*", 
       
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"E", 
       RowBox[{".1", ".", " ", "Wavelength"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "\"\<_diffrn_radiation_wavelength\>\"", "~~", "\[IndentingNewLine]",
            "Whitespace", "~~", 
           RowBox[{"x", ":", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"DigitCharacter", ",", "\"\<.\>\""}], "}"}], ".."}]}], "~~",
            "Whitespace"}], "]"}], "\[RuleDelayed]", "x"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Lambda]", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "\[Lambda]"}], ">", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]", "=", 
          RowBox[{"ToExpression", "@", 
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "sub", 
            "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]", "=", 
          RowBox[{"ToExpression", "@", 
           RowBox[{"First", "@", "\[Lambda]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"E", 
       RowBox[{".2", ".", " ", "Forumla"}], " ", "units", " ", 
       RowBox[{"(", "Z", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Z", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "\"\<_cell_formula_units_Z\>\"", "~~", "\[IndentingNewLine]", 
           "Whitespace", "~~", 
           RowBox[{"z", ":", "DigitCharacter"}]}], "]"}], "\[RuleDelayed]", 
         "z"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Z", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Z", "=", "0"}], ",", 
       RowBox[{"Z", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"First", "@", "Z"}]}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"F", ".", " ", "Chemical"}], " ", "formula", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"F", 
       RowBox[{".1", ".", " ", "Extracting"}], " ", "formula"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"formula", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{"import", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Shortest", "[", 
            RowBox[{"#", "~~", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Whitespace", ",", "\"\<\\n\>\""}], "}"}], ".."}], "~~", 
             RowBox[{"{", 
              RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", "f__", 
             "~~", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Whitespace", ",", "\"\<\\n\>\""}], "}"}], ".."}]}], 
            "]"}], "\[RuleDelayed]", "f"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Prioritised", " ", "order"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<_chemical_formula_iupac\>\"", ",", "\[IndentingNewLine]", 
         "\"\<_chemical_formula_structural\>\"", ",", "\[IndentingNewLine]", 
         "\"\<_chemical_formula_sum\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"formula", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", "formula"}], ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<,\>\"", ",", "\"\<?\>\""}], "}"}]}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"formula", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"formula", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\\r\>\"", ",", "\"\<~\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"F", 
       RowBox[{".2", ".", " ", "Check"}], " ", "for", " ", "simplest", " ", 
       "formula"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"formula", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<(\>\""}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"formula", "=", 
        RowBox[{"{", 
         RowBox[{"First", "@", "temp"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"F", 
       RowBox[{".3", ".", " ", "Misc"}], " ", "treatmeant", " ", "and", " ", 
       "possible", " ", "subdata", " ", "selection"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"formula", "===", 
         RowBox[{"{", "}"}]}], "||", 
        RowBox[{"formula", "===", 
         RowBox[{"{", "\"\<\>\"", "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chemicalformula", "=", "\"\<\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroup\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"formula", "=", 
      RowBox[{"{", 
       RowBox[{"StringDelete", "[", 
        RowBox[{
         RowBox[{"StringTrim", "@", 
          RowBox[{"First", "@", "formula"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}]}], "]"}], "}"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"formula", "===", 
        RowBox[{"{", "\"\<\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chemicalformula", "=", "\"\<\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroup\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"StringSplit", "@", "formula"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "formula"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{
        "formula", "\[LeftDoubleBracket]", "sub", "\[RightDoubleBracket]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"Flatten", "@", "formula"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"F", 
       RowBox[{".4", ".", " ", "Loop"}], " ", "for", " ", "formatting", " ", 
       "the", " ", "chemical", " ", "formula"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<FormatFormula\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{"formula", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}], "&"}]}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l", ",", "r"}], "}"}], "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"StringPosition", "[", "\[IndentingNewLine]", 
             RowBox[{"formula", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_"}], "}"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"checkParentheses", "=", "True"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"chemicalformula", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"StringCases", "[", 
           RowBox[{
            RowBox[{
            "formula", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"x", ":", 
               RowBox[{"LetterCharacter", ".."}]}], "~~", 
              "\[IndentingNewLine]", 
              RowBox[{"y", ":", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"{", 
                  RowBox[{"DigitCharacter", ",", "\"\<.\>\""}], "}"}], ")"}], 
                ".."}]}]}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"temp", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"chemicalformula", ",", 
            RowBox[{
            "formula", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "temp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[Equal]", "\"\<1\>\""}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"chemicalformula", ",", 
            RowBox[{
            "temp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", "\[IndentingNewLine]", "True", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"chemicalformula", ",", 
            RowBox[{"left", "<>", 
             RowBox[{
             "temp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<>",
              "mid", "<>", 
             RowBox[{
             "temp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "<>",
              "right"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "formula"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"chemicalformula", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"chemicalformula", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Adding", " ", "back", " ", "parentheses"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"checkParentheses", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
         "chemicalformula", "\[LeftDoubleBracket]", "l", 
          "\[RightDoubleBracket]"}], "=", 
         RowBox[{"\"\<(\>\"", "<>", 
          RowBox[{
          "chemicalformula", "\[LeftDoubleBracket]", "l", 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "chemicalformula", "\[LeftDoubleBracket]", "r", 
          "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{
          "chemicalformula", "\[LeftDoubleBracket]", "r", 
           "\[RightDoubleBracket]"}], "<>", "\"\<)\>\""}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"chemicalformula", "=", 
      RowBox[{"StringJoin", "@", "chemicalformula"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"G", ".", " ", "Space"}], " ", "group", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SpaceGroup\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".1", ".", " ", "Prioritised"}], " ", "list", " ", "of", " ", 
       "data", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sgTags", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<_space_group_name_Hall\>\"", ",", "\[IndentingNewLine]", 
        "\"\<_space_group_name_H-M_alt\>\"", ",", "\[IndentingNewLine]", 
        "\"\<_space_group_IT_number\>\"", ",", "\[IndentingNewLine]", 
        "\"\<_symmetry_space_group_name_Hall\>\"", ",", 
        "\[IndentingNewLine]", "\"\<_symmetry_space_group_name_H-M\>\"", ",", 
        "\[IndentingNewLine]", "\"\<_symmetry_Int_Tables_number\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".2", ".", " ", "Extract"}], " ", "space", " ", "group", " ", 
       "sections", " ", "from", " ", "imported", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{"Shortest", "[", 
         RowBox[{"sgTags", "~~", "__", "~~", "\"\<loop_\>\""}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "sgData", "]"}], ">", "0"}], ",", 
       RowBox[{"sgData", "=", 
        RowBox[{
        "sgData", "\[LeftDoubleBracket]", "sub", 
         "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"StringTrim", "@", 
       RowBox[{"StringDelete", "[", 
        RowBox[{"sgData", ",", "\"\<loop_\>\""}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".3", ".", " ", "Make"}], " ", "association", " ", "of", " ", 
       "tags", " ", "and", " ", "corresponding", " ", "info"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"sgData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"t", ":", "sgTags"}], "~~", "Whitespace", "~~", 
          RowBox[{"sg", ":", 
           RowBox[{"Shortest", "[", 
            RowBox[{
             RowBox[{"Except", "[", "WhitespaceCharacter", "]"}], "~~", 
             "__"}], "]"}]}], "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<\\n\>\"", ",", "EndOfString"}], "}"}]}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "sg"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Flatten", "@", "sgData"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"sgData", ",", "\"\<?\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".4", ".", " ", "Go"}], " ", "through", " ", "priority", " ", 
       "order", " ", "and", " ", "validate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"sgData", "[", 
          RowBox[{
          "sgTags", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"Quiet", "@", 
          RowBox[{"InputCheck", "[", 
           RowBox[{"\"\<InterpretSpaceGroup\>\"", ",", "sg", ",", "False"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sg", "=!=", "Null"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "sgTags"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".5", ".", " ", "For"}], " ", "modulated", " ", "structures"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sg", "===", "Null"}], "&&", "modulationQ"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"import", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "\"\<_space_group_ssg_name\>\"", "~~", "Whitespace", "~~", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", "sg__",
              "~~", 
             RowBox[{"{", 
              RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
             "\"\<\\n\>\""}], "\[RuleDelayed]", "sg"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"sg", ",", 
           RowBox[{
            RowBox[{"Shortest", "[", 
             RowBox[{"StartOfString", "~~", "___", "\[IndentingNewLine]", "~~", 
              RowBox[{"sg", ":", 
               RowBox[{"(", 
                RowBox[{"LetterCharacter", "~~", "__"}], ")"}]}], "~~", 
              "\"\<(\>\""}], "]"}], "\[RuleDelayed]", "sg"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sg", "=!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"sg", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"InputCheck", "[", 
             RowBox[{
             "\"\<InterpretSpaceGroup\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"First", "@", 
               RowBox[{"Flatten", "@", "sg"}]}], ",", "False"}], "]"}]}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"G", 
        RowBox[{".6", ".", " ", "If"}], " ", "missing", " ", "space", " ", 
        "group"}], ",", " ", 
       RowBox[{"display", " ", "message", " ", "and", " ", 
        RowBox[{"use", " ", "'"}], 
        RowBox[{"P1", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "Null"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "SG"}], "]"}], ";", 
        RowBox[{"sg", "=", "\"\<P1\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"H", ".", " ", "Adding"}], " ", "item", " ", "to", " ", 
       "dataset", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"#", "\[Rule]", 
           RowBox[{"OptionValue", "[", "#", "]"}]}], ",", "String"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"First", "/@", 
         RowBox[{"Options", "@", "ImportCrystalData"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ImportCrystalData", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "name", ",", "chemicalformula", ",", "Z", ",", "sg", ",", 
         "\[Lambda]"}], "}"}], ",", "\[IndentingNewLine]", "cell", ",", 
       "atomoverview", ",", "\[IndentingNewLine]", "options"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.681837686555131*^9, 3.681837715873535*^9}, {
   3.681877151035359*^9, 3.681877151857564*^9}, {3.681877348954164*^9, 
   3.681877351369781*^9}, {3.6819101014855537`*^9, 3.681910102580982*^9}, {
   3.681910388849527*^9, 3.681910408879343*^9}, {3.68191049699089*^9, 
   3.681910537526072*^9}, 3.681911688964922*^9, {3.681911786680073*^9, 
   3.68191179058315*^9}, {3.6819118723996363`*^9, 3.681911873844613*^9}, {
   3.6819140964123163`*^9, 3.681914157322269*^9}, {3.681914205795579*^9, 
   3.681914208330812*^9}, {3.6819143084716177`*^9, 3.681914309199279*^9}, {
   3.681915194701557*^9, 3.68191521259623*^9}, {3.681915428641061*^9, 
   3.6819154541920223`*^9}, {3.681915508982588*^9, 3.6819155187349586`*^9}, {
   3.6819168348799667`*^9, 3.681916852300927*^9}, {3.681916888900612*^9, 
   3.6819168922893877`*^9}, {3.6820739592699213`*^9, 3.682073996952688*^9}, {
   3.682077463877149*^9, 3.6820776052573*^9}, {3.6820776372594213`*^9, 
   3.682077686799657*^9}, {3.682082418603697*^9, 3.682082430746922*^9}, {
   3.682082519458561*^9, 3.682082521010309*^9}, {3.682082595976618*^9, 
   3.682082596294907*^9}, {3.6820837443110313`*^9, 3.682083747517606*^9}, {
   3.682085086096871*^9, 3.682085095360746*^9}, 3.682085308263221*^9, {
   3.682100925090796*^9, 3.682100925856657*^9}, {3.682101196995595*^9, 
   3.68210120054681*^9}, {3.682102829546782*^9, 3.682102838691023*^9}, {
   3.682102904632976*^9, 3.68210290614216*^9}, {3.6821029535021467`*^9, 
   3.68210296190212*^9}, {3.6821774013515873`*^9, 3.6821774370058517`*^9}, {
   3.682177563252334*^9, 3.6821775661249437`*^9}, {3.682177600506325*^9, 
   3.682177656459094*^9}, {3.682177729400577*^9, 3.6821778309729347`*^9}, {
   3.6821779750759077`*^9, 3.6821780129943647`*^9}, {3.682178072320471*^9, 
   3.682178073136857*^9}, {3.682214729418475*^9, 3.68221473007382*^9}, {
   3.682214797329495*^9, 3.682214821071869*^9}, {3.682677055762129*^9, 
   3.682677082149714*^9}, {3.682832420816259*^9, 3.682832449368558*^9}, {
   3.682832537779292*^9, 3.682832682693927*^9}, {3.682832735492477*^9, 
   3.682832824132668*^9}, {3.6828328598467293`*^9, 3.682833026767085*^9}, 
   3.682833162444942*^9, {3.682837210396799*^9, 3.6828372402788343`*^9}, 
   3.6828373947973213`*^9, {3.68283759506389*^9, 3.682837664986249*^9}, {
   3.682837709908091*^9, 3.682837753503565*^9}, {3.6828379970329027`*^9, 
   3.682838055525839*^9}, 3.682838232320035*^9, {3.682838429627843*^9, 
   3.682838434879648*^9}, {3.682838593168171*^9, 3.682838596462935*^9}, {
   3.682838879126762*^9, 3.6828390199199743`*^9}, {3.682839067845223*^9, 
   3.682839077317922*^9}, {3.682839121979623*^9, 3.682839223955677*^9}, {
   3.6828393367109547`*^9, 3.682839338923073*^9}, 3.682839501563301*^9, {
   3.6828417490831413`*^9, 3.682841811537655*^9}, {3.682842027045608*^9, 
   3.6828420299735603`*^9}, {3.682842258778105*^9, 3.682842282884631*^9}, {
   3.683459177108799*^9, 3.683459293968474*^9}, {3.6834593554150763`*^9, 
   3.683459366581719*^9}, {3.6834598133851852`*^9, 3.683459848895413*^9}, {
   3.683459997268997*^9, 3.6834600067561207`*^9}, {3.6835293248460393`*^9, 
   3.683529326321478*^9}, {3.6835294138321333`*^9, 3.6835295044250803`*^9}, {
   3.683537492652543*^9, 3.68353749405657*^9}, {3.683537541824689*^9, 
   3.6835375782357893`*^9}, {3.683537711555953*^9, 3.683537794377946*^9}, {
   3.683537977977876*^9, 3.683537990192911*^9}, {3.6835380313465023`*^9, 
   3.6835380750741434`*^9}, {3.683538285553391*^9, 3.6835383618232574`*^9}, {
   3.6835383921034403`*^9, 3.6835383922126417`*^9}, {3.6835385237387714`*^9, 
   3.683538644173087*^9}, {3.683538876743412*^9, 3.6835388845745115`*^9}, {
   3.683539294421953*^9, 3.683539430798027*^9}, 3.6835395063385925`*^9, {
   3.683539599016776*^9, 3.683539607581341*^9}, {3.683539676599069*^9, 
   3.6835396785491066`*^9}, {3.6835397231971655`*^9, 3.683539733087755*^9}, {
   3.683540253168607*^9, 3.6835404587493606`*^9}, {3.6835404930700207`*^9, 
   3.6835404965800877`*^9}, {3.683540560868924*^9, 3.6835405975523753`*^9}, {
   3.6835406619192133`*^9, 3.6835407044144306`*^9}, 3.683541270345587*^9, {
   3.68354135218476*^9, 3.6835414187044396`*^9}, {3.6835414565975685`*^9, 
   3.683541461776868*^9}, {3.683541917711236*^9, 3.6835419313458977`*^9}, 
   3.6835422222290916`*^9, {3.683572964384384*^9, 3.683572966999359*^9}, {
   3.6835730541015053`*^9, 3.683573069879159*^9}, {3.683573103784048*^9, 
   3.683573132220851*^9}, {3.68357317178211*^9, 3.683573226507544*^9}, {
   3.68357326053117*^9, 3.683573653411612*^9}, {3.683573688834921*^9, 
   3.6835737835140333`*^9}, {3.683573824322988*^9, 3.6835738252471046`*^9}, {
   3.683595424868795*^9, 3.683595451786187*^9}, {3.683595483733911*^9, 
   3.683595484340826*^9}, {3.6835955910574837`*^9, 3.6835956274016047`*^9}, {
   3.683595762457136*^9, 3.683595797136365*^9}, {3.683595846224218*^9, 
   3.683596001170824*^9}, {3.6835960422674*^9, 3.6835960891762123`*^9}, {
   3.6835962378875504`*^9, 3.6835962484282827`*^9}, {3.683596395857547*^9, 
   3.6835966353910303`*^9}, {3.683596898118559*^9, 3.683596901156117*^9}, {
   3.683596978213135*^9, 3.6835970018659067`*^9}, {3.683597032809555*^9, 
   3.6835970665686617`*^9}, {3.68359712696749*^9, 3.6835971278314257`*^9}, {
   3.683597176550775*^9, 3.68359717787001*^9}, {3.68359720886909*^9, 
   3.683597216597783*^9}, {3.6835972585402813`*^9, 3.6835972594512873`*^9}, {
   3.68359730637988*^9, 3.68359732121716*^9}, {3.683597369010441*^9, 
   3.6835974243989*^9}, {3.683597489283207*^9, 3.6835974932304993`*^9}, {
   3.6835975761879187`*^9, 3.683597578756028*^9}, {3.683597619308737*^9, 
   3.683597743987504*^9}, 3.683598235040094*^9, {3.683598338929348*^9, 
   3.683598413911125*^9}, {3.68359850546655*^9, 3.683598562786562*^9}, {
   3.683600135064497*^9, 3.6836001441563673`*^9}, 3.683600190405829*^9, {
   3.683600223266963*^9, 3.68360022351584*^9}, {3.683861653697109*^9, 
   3.6838617583709097`*^9}, {3.6838617890837097`*^9, 3.68386180051851*^9}, {
   3.6838720230872736`*^9, 3.6838721491664743`*^9}, {3.6838722337964754`*^9, 
   3.6838723530428762`*^9}, {3.683872389047676*^9, 3.683872467032077*^9}, {
   3.68387824945021*^9, 3.68387825924701*^9}, {3.6838782937698097`*^9, 
   3.6838783371378107`*^9}, {3.683878387057811*^9, 3.6838784373210115`*^9}, {
   3.683878666485012*^9, 3.6838787350002127`*^9}, {3.683879405377817*^9, 
   3.6838794279042177`*^9}, {3.6838794682146177`*^9, 3.683879531597418*^9}, {
   3.6838823679725337`*^9, 3.683882399500134*^9}, {3.683882440028934*^9, 
   3.683882440200534*^9}, {3.68388345639794*^9, 3.68388345794234*^9}, {
   3.683883545037141*^9, 3.683883563881941*^9}, {3.6838843089223456`*^9, 
   3.6838843101859455`*^9}, {3.6838846093375473`*^9, 
   3.6838846380259476`*^9}, {3.6838847150743484`*^9, 3.683884738474348*^9}, {
   3.683884796022749*^9, 3.683884836645149*^9}, {3.683884879498349*^9, 
   3.6838848901375494`*^9}, {3.68388495205395*^9, 3.68388501010155*^9}, {
   3.68388504030315*^9, 3.68388504270555*^9}, 3.6838850989123507`*^9, {
   3.683885198268751*^9, 3.683885218689152*^9}, {3.683912883065785*^9, 
   3.683912893756435*^9}, {3.683913100428589*^9, 3.6839131623230047`*^9}, {
   3.6839132253230247`*^9, 3.6839132395051737`*^9}, {3.683913537550117*^9, 
   3.68391355671695*^9}, {3.683914614791511*^9, 3.683914615884431*^9}, {
   3.683914757414419*^9, 3.683914851565317*^9}, {3.683914963356751*^9, 
   3.683915043562475*^9}, {3.6839150884529943`*^9, 3.68391514006312*^9}, {
   3.683915261541957*^9, 3.683915267605801*^9}, {3.683915370843563*^9, 
   3.683915373148366*^9}, {3.6839154629056883`*^9, 3.683915465520754*^9}, {
   3.683916066162204*^9, 3.683916209881385*^9}, {3.683916242403504*^9, 
   3.68391624273678*^9}, {3.68391631311016*^9, 3.683916315029543*^9}, {
   3.683916417398801*^9, 3.683916493270235*^9}, 3.683916540969326*^9, {
   3.6839165797143183`*^9, 3.683916597561346*^9}, {3.683916669848016*^9, 
   3.6839166878486032`*^9}, {3.683916731510866*^9, 3.6839167406461277`*^9}, {
   3.683916779525547*^9, 3.683916810603664*^9}, {3.683916856013338*^9, 
   3.683916880227283*^9}, {3.683916915864532*^9, 3.6839169239385757`*^9}, {
   3.683916981905188*^9, 3.683917053855734*^9}, 3.683917085238093*^9, {
   3.683917117406871*^9, 3.683917155940662*^9}, {3.683917254301112*^9, 
   3.683917322640829*^9}, {3.683917369048996*^9, 3.6839173725287027`*^9}, {
   3.683945926436631*^9, 3.683945951299859*^9}, {3.6839460310261507`*^9, 
   3.683946039878233*^9}, {3.683946754408388*^9, 3.683946763862039*^9}, {
   3.683946855058311*^9, 3.6839468559487123`*^9}, {3.683946888930604*^9, 
   3.6839468916350193`*^9}, {3.683965973504136*^9, 3.683965981803792*^9}, {
   3.6839660266131144`*^9, 3.6839660635760393`*^9}, {3.683966150618153*^9, 
   3.68396615989508*^9}, {3.683966552362355*^9, 3.683966630751149*^9}, {
   3.683966716879807*^9, 3.6839667201718407`*^9}, {3.683966814971418*^9, 
   3.683966816827961*^9}, {3.6839670871586246`*^9, 3.683967092940967*^9}, {
   3.6839672384469957`*^9, 3.683967264565357*^9}, {3.68396731494932*^9, 
   3.6839673155162992`*^9}, {3.6839675945381927`*^9, 
   3.6839676210608873`*^9}, {3.683967653597517*^9, 3.683967667282453*^9}, {
   3.683967706895344*^9, 3.68396783896605*^9}, {3.683967886281891*^9, 
   3.683967890763636*^9}, {3.6839680655577517`*^9, 3.683968086932863*^9}, {
   3.6840603924630165`*^9, 3.684060392650216*^9}, {3.6840604459398165`*^9, 
   3.6840604461270165`*^9}, {3.684060758127019*^9, 3.6840607719330187`*^9}, {
   3.684091108204876*^9, 3.684091109186337*^9}, {3.6840912297215223`*^9, 
   3.684091257151688*^9}, {3.684091304149659*^9, 3.6840913743737698`*^9}, {
   3.684091528500297*^9, 3.684091546612001*^9}, {3.6840916760088882`*^9, 
   3.684091710208632*^9}, {3.684091779365342*^9, 3.6840917872010107`*^9}, {
   3.6840918193186693`*^9, 3.684091822997663*^9}, {3.6840920204991217`*^9, 
   3.684092027753368*^9}, {3.684092242821933*^9, 3.68409224877349*^9}, {
   3.684092375853321*^9, 3.684092446402137*^9}, {3.684092529479371*^9, 
   3.684092601541663*^9}, {3.684092631976705*^9, 3.684092706444932*^9}, {
   3.684122583204362*^9, 3.684122583338593*^9}, {3.684122617769887*^9, 
   3.6841226326425533`*^9}, {3.684122842850892*^9, 3.6841228803670053`*^9}, 
   3.684662456408539*^9, {3.685083215676849*^9, 3.685083225479327*^9}, {
   3.685273842160692*^9, 3.685273843369611*^9}, 3.6852859866984377`*^9, {
   3.6852865797565203`*^9, 3.6852867418301563`*^9}, {3.68528678670284*^9, 
   3.685286837658393*^9}, {3.6852876402392797`*^9, 3.68528764082928*^9}, {
   3.685287686672612*^9, 3.6852877328345823`*^9}, 3.685288359599786*^9, {
   3.685288405265378*^9, 3.685288413567605*^9}, {3.685288460159389*^9, 
   3.6852885790055923`*^9}, {3.685288768401976*^9, 3.685288776719144*^9}, {
   3.6852888594727592`*^9, 3.685288869167355*^9}, {3.6852889018778133`*^9, 
   3.685288928989695*^9}, {3.685289137837894*^9, 3.685289156578895*^9}, {
   3.6852893298741426`*^9, 3.685289339184761*^9}, {3.6852894371950483`*^9, 
   3.685289490675153*^9}, {3.685289568013756*^9, 3.685289576976079*^9}, {
   3.685289608357773*^9, 3.685289658711172*^9}, {3.685289735218001*^9, 
   3.6852898069422903`*^9}, {3.685289930471755*^9, 3.6852900810382442`*^9}, {
   3.685290184784808*^9, 3.685290208077758*^9}, {3.685290251165133*^9, 
   3.685290252421399*^9}, {3.68529039678588*^9, 3.685290434036058*^9}, {
   3.6852905616198597`*^9, 3.685290648834957*^9}, {3.685290772225479*^9, 
   3.6852908445314827`*^9}, {3.685290944529559*^9, 3.685290945406761*^9}, {
   3.6852994143987617`*^9, 3.6852994382525454`*^9}, {3.685299497976466*^9, 
   3.685299503829215*^9}, {3.6852995392171392`*^9, 3.685299553596043*^9}, {
   3.685299992582048*^9, 3.685300067802575*^9}, {3.685300115636456*^9, 
   3.6853001652887*^9}, {3.685857413666704*^9, 3.685857416648685*^9}, {
   3.685857458690517*^9, 3.685857460318738*^9}, {3.685857739673769*^9, 
   3.685857804387884*^9}, {3.685858053804237*^9, 3.685858097255934*^9}, {
   3.685858148189295*^9, 3.685858151202751*^9}, {3.6858582764177513`*^9, 
   3.685858278372242*^9}, {3.685858315119955*^9, 3.685858329069948*^9}, {
   3.6858583599842167`*^9, 3.685858443918298*^9}, {3.685858474929714*^9, 
   3.685858549786276*^9}, {3.685858646044956*^9, 3.685858729439179*^9}, {
   3.685858780464095*^9, 3.6858588174599037`*^9}, {3.6858588495554333`*^9, 
   3.685858854343585*^9}, {3.685858884851486*^9, 3.685858951983511*^9}, {
   3.6858589994260674`*^9, 3.685859010716827*^9}, {3.6858590913432503`*^9, 
   3.6858590933696404`*^9}, {3.6858591266083927`*^9, 3.685859175567238*^9}, 
   3.6858592443417377`*^9, {3.685859293152143*^9, 3.685859295503252*^9}, {
   3.685859355430237*^9, 3.685859372237409*^9}, {3.685859410728088*^9, 
   3.685859590839635*^9}, {3.685859820712883*^9, 3.685859834624839*^9}, {
   3.685859901734437*^9, 3.685859903978137*^9}, {3.685860388384758*^9, 
   3.685860416754836*^9}, {3.6858604795627413`*^9, 3.685860511227654*^9}, {
   3.685860553637973*^9, 3.685860566610154*^9}, {3.685860914338649*^9, 
   3.685860923340206*^9}, {3.6858609596753263`*^9, 3.685861032397937*^9}, {
   3.685861066897966*^9, 3.685861207437435*^9}, {3.685861269462768*^9, 
   3.685861333954526*^9}, {3.68586136454725*^9, 3.685861474318748*^9}, {
   3.685861517225202*^9, 3.685861630127417*^9}, 3.686539654224182*^9, {
   3.6865404731983*^9, 3.686540476632311*^9}, {3.686540838010448*^9, 
   3.6865408409572363`*^9}, {3.6865408783411818`*^9, 
   3.6865409309172087`*^9}, {3.6865410083871517`*^9, 3.686541019566337*^9}, {
   3.686541108523757*^9, 3.6865411160838137`*^9}, {3.686541345632307*^9, 
   3.6865413786757183`*^9}, {3.686541414671311*^9, 3.6865414232386217`*^9}, {
   3.686542165948737*^9, 3.686542250863388*^9}, {3.686542299286373*^9, 
   3.686542419483355*^9}, {3.686542765365814*^9, 3.686542896718195*^9}, {
   3.6865429651805696`*^9, 3.686542994361959*^9}, {3.686543052880053*^9, 
   3.68654308126692*^9}, {3.686543188486841*^9, 3.686543246136475*^9}, {
   3.686543277183275*^9, 3.686543354140892*^9}, {3.6865439221051064`*^9, 
   3.6865439500516567`*^9}, {3.686543985426251*^9, 3.6865439866119337`*^9}, {
   3.686545075225861*^9, 3.686545085996263*^9}, {3.686545142403131*^9, 
   3.686545154301223*^9}, {3.686545598710578*^9, 3.686545685031988*^9}, {
   3.686545806504096*^9, 3.686545808221018*^9}, {3.686545843613908*^9, 
   3.686545858760723*^9}, {3.6865468611972027`*^9, 3.686546864228973*^9}, {
   3.686547018082903*^9, 3.686547062903644*^9}, {3.686547103018654*^9, 
   3.6865472172532377`*^9}, {3.686547286632975*^9, 3.6865473094649553`*^9}, {
   3.68654734925193*^9, 3.686547436898713*^9}, {3.68654749370965*^9, 
   3.686547528959359*^9}, {3.6865475636469088`*^9, 3.686547609057955*^9}, {
   3.686547718709216*^9, 3.6865477759813023`*^9}, {3.686547826737184*^9, 
   3.6865480149557037`*^9}, {3.686548045811688*^9, 3.6865480534768553`*^9}, {
   3.686548358608864*^9, 3.6865483707973957`*^9}, {3.686548545229116*^9, 
   3.686548549254797*^9}, {3.686548686552582*^9, 3.686548712479574*^9}, {
   3.686548761541046*^9, 3.686548806149107*^9}, {3.686548844469076*^9, 
   3.6865488456614323`*^9}, {3.6865512672815323`*^9, 3.686551349772369*^9}, {
   3.686551394491152*^9, 3.686551419220949*^9}, {3.68655189093897*^9, 
   3.686551964617752*^9}, {3.686552125034718*^9, 3.686552127678214*^9}, {
   3.686552278738872*^9, 3.686552288051901*^9}, {3.6865525035827713`*^9, 
   3.6865525526784353`*^9}, {3.686552735101828*^9, 3.686552795442685*^9}, {
   3.686628436474517*^9, 3.686628536322258*^9}, {3.68662881083289*^9, 
   3.686628821580617*^9}, {3.686628873638318*^9, 3.686628910585565*^9}, {
   3.686628983168025*^9, 3.686628993135873*^9}, {3.6866290244093027`*^9, 
   3.686629036936223*^9}, {3.6866293771745977`*^9, 3.686629573836637*^9}, {
   3.686629642177215*^9, 3.686629642772787*^9}, {3.6866297243246927`*^9, 
   3.6866297671380577`*^9}, {3.68662980589575*^9, 3.686629921941725*^9}, {
   3.6866301477171917`*^9, 3.6866302198000402`*^9}, {3.686631051792659*^9, 
   3.686631052244384*^9}, {3.686631154483254*^9, 3.6866311697969627`*^9}, {
   3.686631263333723*^9, 3.686631263601918*^9}, {3.68663139867869*^9, 
   3.686631404581489*^9}, {3.686632984962451*^9, 3.686633004174432*^9}, {
   3.686633061394642*^9, 3.686633130346314*^9}, 3.68663316413481*^9, {
   3.686633214954659*^9, 3.686633436141959*^9}, {3.686633467345083*^9, 
   3.6866334864811068`*^9}, {3.686633732074704*^9, 3.686633950675581*^9}, {
   3.6866339912854033`*^9, 3.6866340595716867`*^9}, {3.686634611539404*^9, 
   3.686634722427601*^9}, {3.686634814350337*^9, 3.686634814637828*^9}, {
   3.686634848303295*^9, 3.686634860468422*^9}, {3.686634959197269*^9, 
   3.686635026207364*^9}, {3.68663506717763*^9, 3.6866350677294807`*^9}, {
   3.686635268873169*^9, 3.686635270603788*^9}, {3.68663534659659*^9, 
   3.6866353696721687`*^9}, {3.686635471413412*^9, 3.686635473760983*^9}, {
   3.6866356402250023`*^9, 3.686635644442481*^9}, {3.686635679985345*^9, 
   3.686635680347102*^9}, {3.686635843450626*^9, 3.686635908529458*^9}, {
   3.686635953810897*^9, 3.6866359950759563`*^9}, {3.686636042815072*^9, 
   3.6866360445918283`*^9}, {3.686636224007688*^9, 3.686636234413014*^9}, {
   3.6866363817222557`*^9, 3.6866363842471933`*^9}, {3.686636486734826*^9, 
   3.686636604026161*^9}, {3.686636645111916*^9, 3.6866366626343937`*^9}, {
   3.6866368484698067`*^9, 3.6866368552832947`*^9}, {3.686636984722148*^9, 
   3.686637049101089*^9}, {3.6866375767735558`*^9, 3.686637597148796*^9}, {
   3.686637631857192*^9, 3.686637660318914*^9}, 3.686637776999043*^9, 
   3.6866378241871567`*^9, {3.686638044023232*^9, 3.6866380683314543`*^9}, {
   3.686648571674737*^9, 3.686648590586588*^9}, {3.686648644103341*^9, 
   3.686648699630372*^9}, {3.6866488318241167`*^9, 3.686648927329699*^9}, {
   3.686649011926078*^9, 3.686649017761073*^9}, 3.6866490558613367`*^9, {
   3.686649180311656*^9, 3.686649237585517*^9}, {3.686649268341486*^9, 
   3.686649299889591*^9}, 3.686649347683876*^9, 3.6866493803691263`*^9, {
   3.686649421883061*^9, 3.686649452018013*^9}, {3.68664949952623*^9, 
   3.686649514816061*^9}, {3.686649598044321*^9, 3.6866496640735693`*^9}, {
   3.6866499742318172`*^9, 3.686650012613455*^9}, {3.68665014714787*^9, 
   3.686650168490876*^9}, {3.686653129809244*^9, 3.686653140923666*^9}, 
   3.686653171799799*^9, {3.686653203816307*^9, 3.686653397228634*^9}, {
   3.686653465870021*^9, 3.686653466088895*^9}, {3.6866591193849993`*^9, 
   3.6866591352071877`*^9}, {3.6866591837970877`*^9, 3.686659210764454*^9}, {
   3.690874230627651*^9, 3.690874268469171*^9}, {3.69087456514154*^9, 
   3.690874571118001*^9}, {3.690874767574018*^9, 3.690874860731365*^9}, {
   3.690875040950881*^9, 3.6908750514047613`*^9}, {3.690875087293241*^9, 
   3.69087508958405*^9}, {3.6908751460732193`*^9, 3.690875201464147*^9}, {
   3.690875238324142*^9, 3.690875244244442*^9}, {3.690875332110111*^9, 
   3.690875363938733*^9}, {3.690875479188937*^9, 3.690875485268502*^9}, 
   3.690875705424657*^9, {3.6908757446717033`*^9, 3.6908757566453743`*^9}, {
   3.690876018113851*^9, 3.690876090202244*^9}, {3.690876130301553*^9, 
   3.6908761305931997`*^9}, {3.6908777563640127`*^9, 3.690877779628961*^9}, 
   3.690877827070587*^9, {3.690877871694067*^9, 3.690877874641543*^9}, {
   3.69087798628898*^9, 3.6908779879454107`*^9}, {3.6908781424130697`*^9, 
   3.6908781425572853`*^9}, {3.6908803713150663`*^9, 3.690880375245215*^9}, {
   3.690880409207288*^9, 3.690880410842257*^9}, {3.690880443383237*^9, 
   3.6908804962567787`*^9}, {3.6908805517361307`*^9, 3.690880564888294*^9}, {
   3.69088101790664*^9, 3.690881022556374*^9}, {3.690881227807176*^9, 
   3.690881275933888*^9}, {3.690881502287149*^9, 3.690881522253579*^9}, {
   3.6908815757498693`*^9, 3.690881595413355*^9}, {3.690881689977112*^9, 
   3.69088169272445*^9}, {3.690881823214643*^9, 3.69088186786427*^9}, {
   3.690881955183896*^9, 3.690881961966961*^9}, {3.690881998162924*^9, 
   3.6908820032421503`*^9}, {3.690882071583241*^9, 3.6908821174670258`*^9}, {
   3.6908824066073523`*^9, 3.690882492658814*^9}, {3.690882526130692*^9, 
   3.690882543146225*^9}, {3.690882573247946*^9, 3.6908826192923326`*^9}, {
   3.690882691946703*^9, 3.6908827488378057`*^9}, {3.690883257173853*^9, 
   3.690883258024938*^9}, 3.690883321343444*^9, {3.6908834730530787`*^9, 
   3.690883505616665*^9}, {3.690883586666316*^9, 3.690883587886053*^9}, {
   3.690883726732333*^9, 3.690883730635768*^9}, {3.6908847416899967`*^9, 
   3.690884800086941*^9}, {3.690884833588965*^9, 3.690884846707543*^9}, {
   3.690884956325741*^9, 3.690884960595014*^9}, {3.6908851561812887`*^9, 
   3.690885159020203*^9}, {3.6908851897244253`*^9, 3.690885201131942*^9}, {
   3.690885272446883*^9, 3.6908852729055567`*^9}, {3.6908859970913353`*^9, 
   3.6908859977945843`*^9}, {3.6908861081770906`*^9, 
   3.6908862090540743`*^9}, {3.6908862482401733`*^9, 3.690886364363151*^9}, {
   3.690886399985446*^9, 3.690886400137809*^9}, {3.6908865069000893`*^9, 
   3.6908865110757093`*^9}, {3.690886573914403*^9, 3.690886576086144*^9}, {
   3.6908866803232403`*^9, 3.690886722521126*^9}, {3.690886883712907*^9, 
   3.6908868936917353`*^9}, {3.690886953697514*^9, 3.69088720818289*^9}, {
   3.690887585108078*^9, 3.690887606738702*^9}, {3.690887655800318*^9, 
   3.690887749544612*^9}, {3.6908879194909277`*^9, 3.690888005258441*^9}, {
   3.690888075006751*^9, 3.690888123005012*^9}, {3.690888154107943*^9, 
   3.690888165839559*^9}, {3.6908882161064177`*^9, 3.690888300778494*^9}, {
   3.690888770051404*^9, 3.690888783892008*^9}, {3.6908901458703527`*^9, 
   3.69089015758394*^9}, {3.690890191114049*^9, 3.690890310979289*^9}, {
   3.690890370799263*^9, 3.6908904356941547`*^9}, {3.6908905934376993`*^9, 
   3.690890698958642*^9}, {3.690890731521749*^9, 3.690890737003929*^9}, {
   3.690890771478266*^9, 3.690890787306638*^9}, {3.6908910420417356`*^9, 
   3.690891074213822*^9}, {3.690891258425971*^9, 3.690891490528727*^9}, {
   3.690891524491589*^9, 3.690891537510817*^9}, {3.690891574588409*^9, 
   3.6908916135805607`*^9}, {3.690891651212935*^9, 3.69089166958366*^9}, {
   3.705028644018639*^9, 3.705028647599525*^9}, {3.705029101172365*^9, 
   3.705029107290732*^9}, {3.705029149528407*^9, 3.705029166206131*^9}, {
   3.7050292214937363`*^9, 3.705029222428486*^9}, {3.705029256554995*^9, 
   3.7050292575576143`*^9}, {3.705029316649047*^9, 3.705029347147097*^9}, {
   3.705379984089679*^9, 3.7053800543548393`*^9}, {3.705380095250505*^9, 
   3.705380108115614*^9}, 3.705380148169414*^9, {3.70538019683451*^9, 
   3.705380213095047*^9}, {3.7053804166764708`*^9, 3.7053804402345467`*^9}, {
   3.705380566776813*^9, 3.705380576521379*^9}, {3.705380611345931*^9, 
   3.705380640053465*^9}, {3.705380722618957*^9, 3.7053807433800993`*^9}, {
   3.705380799464793*^9, 3.7053808012668877`*^9}, {3.70538083355977*^9, 
   3.7053808588703537`*^9}, {3.705380894266776*^9, 3.705380895503932*^9}, {
   3.705381058358472*^9, 3.705381065358697*^9}, {3.705381102219154*^9, 
   3.705381105719275*^9}, {3.7053811558848658`*^9, 3.705381277348399*^9}, {
   3.705381974474321*^9, 3.705382003060091*^9}, {3.70538203810003*^9, 
   3.7053820411788607`*^9}, {3.705382108889456*^9, 3.7053821467573442`*^9}, {
   3.7053821786248293`*^9, 3.705382179617531*^9}, {3.705382481290308*^9, 
   3.705382522062904*^9}, {3.7053825535503798`*^9, 3.705382555679167*^9}, {
   3.705382630831314*^9, 3.705382708240117*^9}, {3.705383207993224*^9, 
   3.705383246279758*^9}, {3.7053833306512327`*^9, 3.705383407796979*^9}, {
   3.7053834552078743`*^9, 3.705383537800829*^9}, {3.705384029774302*^9, 
   3.7053840422253847`*^9}, {3.705384123564886*^9, 3.705384143090168*^9}, {
   3.705384309537613*^9, 3.7053843356127777`*^9}, {3.705384405334144*^9, 
   3.705384495729072*^9}, {3.705384623715996*^9, 3.7053846592758636`*^9}, {
   3.711351111770576*^9, 3.711351113856388*^9}, {3.711351145943018*^9, 
   3.711351152774556*^9}, {3.711352489546802*^9, 3.7113524914060583`*^9}, {
   3.711352591876399*^9, 3.711352760371176*^9}, {3.711352795505945*^9, 
   3.7113528061494007`*^9}, {3.711352946687026*^9, 3.711352947992275*^9}, {
   3.711872206103055*^9, 3.711872263469742*^9}, {3.711872332850672*^9, 
   3.711872333104144*^9}, {3.712038639037058*^9, 3.712038722071074*^9}, {
   3.712039155304579*^9, 3.712039158509935*^9}, {3.712039224408853*^9, 
   3.712039251439427*^9}, 3.712039316350741*^9, {3.712039482613575*^9, 
   3.7120395129520063`*^9}, {3.712039594482299*^9, 3.712039605579571*^9}, 
   3.712039718787567*^9, {3.712039758887706*^9, 3.7120397888413477`*^9}, {
   3.712041870075758*^9, 3.712041943264638*^9}, {3.712042231432576*^9, 
   3.712042273473843*^9}, {3.712042360001617*^9, 3.71204237737145*^9}, {
   3.7120424364915*^9, 3.712042501698626*^9}, {3.7120431096884727`*^9, 
   3.712043171911232*^9}, {3.712476026225499*^9, 3.712476051024411*^9}, 
   3.712476100775619*^9, {3.712476645729344*^9, 3.712476702921423*^9}, {
   3.712476737449065*^9, 3.712476758588127*^9}, {3.712476821297773*^9, 
   3.712476831624687*^9}, {3.712478672953239*^9, 3.712478687162466*^9}, {
   3.71247877161519*^9, 3.7124788849639*^9}, {3.71247892120807*^9, 
   3.712479085521503*^9}, 3.712479672963057*^9, 3.712479765712575*^9, {
   3.712479876872574*^9, 3.712479903650322*^9}, {3.71247996505613*^9, 
   3.712479966003675*^9}, {3.712480117261688*^9, 3.712480119698488*^9}, {
   3.712482156061984*^9, 3.71248216501117*^9}, {3.712482757208851*^9, 
   3.712482776726468*^9}, {3.712483335793894*^9, 3.712483376257092*^9}, {
   3.712483534540847*^9, 3.712483585245718*^9}, {3.712554043916257*^9, 
   3.71255407205492*^9}, {3.7125541494405003`*^9, 3.712554259995756*^9}, {
   3.7143644954690237`*^9, 3.714364498620454*^9}, {3.714364530650523*^9, 
   3.714364532234413*^9}, {3.7143646331374283`*^9, 3.714364648867915*^9}, {
   3.714365035935523*^9, 3.714365068184824*^9}, {3.7143652039844503`*^9, 
   3.714365213251802*^9}, {3.714365295999627*^9, 3.7143653030948477`*^9}, {
   3.7143657521081333`*^9, 3.714365762242819*^9}, {3.714366393814814*^9, 
   3.714366419913129*^9}, {3.714366466477858*^9, 3.714366467674356*^9}, {
   3.714366501937438*^9, 3.714366505723628*^9}, {3.714367167021729*^9, 
   3.71436740245326*^9}, {3.71436784827663*^9, 3.71436790164959*^9}, {
   3.714368199518496*^9, 3.714368219341834*^9}, {3.714371806450234*^9, 
   3.7143718693604507`*^9}, {3.714382063322034*^9, 3.7143820825814953`*^9}, {
   3.714382171958996*^9, 3.714382227738618*^9}, {3.7143822632015457`*^9, 
   3.714382264865775*^9}, {3.714382426612254*^9, 3.714382427651102*^9}, {
   3.714382513226758*^9, 3.714382549358738*^9}, {3.714382765216748*^9, 
   3.71438278235201*^9}, {3.714382814153933*^9, 3.714382877397443*^9}, {
   3.714382914463346*^9, 3.7143829604795856`*^9}, {3.7143830031041183`*^9, 
   3.714383016857888*^9}, {3.714383452159505*^9, 3.714383452706373*^9}, {
   3.71438357484027*^9, 3.714383576234696*^9}, {3.7143842702358847`*^9, 
   3.7143842886956043`*^9}, {3.714384418210403*^9, 3.714384448154595*^9}, {
   3.714384480836069*^9, 3.7143844888277197`*^9}, {3.714384681093793*^9, 
   3.714384684135685*^9}, {3.714384749336495*^9, 3.714384813372967*^9}, {
   3.714913420900578*^9, 3.714913427072555*^9}, {3.714913637647194*^9, 
   3.714913637787532*^9}, {3.717255063345069*^9, 3.717255067807077*^9}, {
   3.717395044031961*^9, 3.7173950695702343`*^9}, {3.717398264490716*^9, 
   3.717398264834695*^9}, {3.7173982974356413`*^9, 3.71739829773092*^9}, {
   3.7173983312148123`*^9, 3.717398410935465*^9}, {3.7173985489270277`*^9, 
   3.7173985906669397`*^9}, {3.717398663320311*^9, 3.7173986995367126`*^9}, {
   3.717398766756649*^9, 3.7173988344406033`*^9}, 3.71774089699483*^9, {
   3.717942206461034*^9, 3.717942206596238*^9}, {3.718001083421361*^9, 
   3.7180010863717527`*^9}, {3.718001135716935*^9, 3.7180011730042562`*^9}, {
   3.7180012420205603`*^9, 3.718001246082906*^9}, {3.71800131202584*^9, 
   3.718001490297841*^9}, {3.718001758217325*^9, 3.7180017624723253`*^9}, {
   3.7180020086844378`*^9, 3.71800202103938*^9}, {3.7180021208313513`*^9, 
   3.718002138298472*^9}, {3.718002178107481*^9, 3.7180021870757427`*^9}, {
   3.718002278697837*^9, 3.7180022917418327`*^9}, {3.718004011257444*^9, 
   3.718004060306809*^9}, {3.718004178323606*^9, 3.718004200606402*^9}, {
   3.718004231644692*^9, 3.718004294053293*^9}, {3.718004332014246*^9, 
   3.7180043497396603`*^9}, {3.718004412450512*^9, 3.718004595533595*^9}, {
   3.7180050361781807`*^9, 3.718005036907324*^9}, {3.7180052709414*^9, 
   3.7180052733987427`*^9}, {3.718005586792924*^9, 3.7180056075707893`*^9}, {
   3.718005658259408*^9, 3.718005754817443*^9}, {3.71800856463656*^9, 
   3.71800857111441*^9}, {3.718011555406355*^9, 3.7180116436145687`*^9}, {
   3.7180116767277927`*^9, 3.718011716802039*^9}, {3.718011812817415*^9, 
   3.7180119039718733`*^9}, {3.718011946973734*^9, 3.718012009401104*^9}, {
   3.7180123279232197`*^9, 3.7180123303706408`*^9}, {3.71801252154222*^9, 
   3.718012528853718*^9}, {3.718012574849312*^9, 3.718012574966339*^9}, {
   3.718013271916046*^9, 3.7180133097037563`*^9}, {3.718016115636971*^9, 
   3.718016120139029*^9}, 3.718016215078356*^9, {3.718019262481444*^9, 
   3.718019291892578*^9}, {3.718019370276717*^9, 3.718019382214369*^9}, {
   3.7211196117950983`*^9, 3.7211196190156116`*^9}, {3.721119873978917*^9, 
   3.7211199180767117`*^9}, {3.721120069028652*^9, 3.721120086820054*^9}, {
   3.7211203629974737`*^9, 3.721120378086216*^9}, {3.721120546601379*^9, 
   3.721120563053873*^9}, {3.721120663741705*^9, 3.721120766165029*^9}, {
   3.721120876472484*^9, 3.721120891775013*^9}, {3.7264644375260687`*^9, 
   3.7264645036052856`*^9}, {3.726464686640902*^9, 3.726464771880875*^9}, {
   3.7264648643195066`*^9, 3.726464864714224*^9}, {3.726464894788763*^9, 
   3.726464899931055*^9}, {3.726465521020912*^9, 3.7264655296166677`*^9}, {
   3.726465562307811*^9, 3.726465564286838*^9}, {3.7264656031749563`*^9, 
   3.726465603565353*^9}, {3.72646579688305*^9, 3.726465891906356*^9}, {
   3.7264663432198753`*^9, 3.72646636188659*^9}, {3.726466394426621*^9, 
   3.726466397906537*^9}, {3.72646643028502*^9, 3.7264664738672743`*^9}, {
   3.726470472993636*^9, 3.726470659912174*^9}, {3.726470703245821*^9, 
   3.7264708113652277`*^9}, {3.726471139895425*^9, 3.726471141013126*^9}, {
   3.726472819712816*^9, 3.726472845807508*^9}, {3.726472914426814*^9, 
   3.726472989073833*^9}, {3.7264736097205877`*^9, 3.7264736249601183`*^9}, {
   3.726473937644083*^9, 3.7264740296429377`*^9}, {3.726474069875421*^9, 
   3.726474072787526*^9}, {3.726474120797406*^9, 3.726474143959763*^9}, {
   3.726903049806059*^9, 3.7269030547343407`*^9}, {3.726903142272684*^9, 
   3.7269031702654457`*^9}, {3.72690323817605*^9, 3.72690324214952*^9}, {
   3.726904666797345*^9, 3.72690472961802*^9}, {3.72690503908265*^9, 
   3.7269050510823603`*^9}, {3.7269053676492443`*^9, 
   3.7269053707222843`*^9}, {3.726905403463994*^9, 3.7269054117154408`*^9}, {
   3.726905443971477*^9, 3.726905503921131*^9}, {3.727164034637611*^9, 
   3.727164037865155*^9}, {3.7271640764732323`*^9, 3.727164077961165*^9}, {
   3.727164122196415*^9, 3.727164195119008*^9}, {3.72716427909273*^9, 
   3.7271643209900007`*^9}, {3.727164551035019*^9, 3.727164566305697*^9}, {
   3.727164826004902*^9, 3.727164856425762*^9}, {3.727164911864665*^9, 
   3.7271649472276087`*^9}, 3.727165028000827*^9, {3.727165439732793*^9, 
   3.727165443410883*^9}, {3.7271655152345543`*^9, 3.727165518210894*^9}, {
   3.727165612817891*^9, 3.7271656329615726`*^9}, {3.727165667879693*^9, 
   3.727165694496305*^9}, {3.727165734300901*^9, 3.727165734484397*^9}, {
   3.7271657951285973`*^9, 3.727165800373414*^9}, 3.727166507374901*^9, {
   3.727166549641523*^9, 3.7271665498291388`*^9}, {3.727679363556376*^9, 
   3.72767937948258*^9}, {3.730144293448069*^9, 3.730144296917568*^9}, {
   3.73054370707415*^9, 3.730543712122634*^9}, {3.730543761369562*^9, 
   3.730543761517167*^9}, {3.7305443832698298`*^9, 3.730544389970169*^9}, {
   3.7305444347499123`*^9, 3.730544441814794*^9}, {3.7338213833691607`*^9, 
   3.73382142523367*^9}, {3.733821517836343*^9, 3.733821589706148*^9}, {
   3.7340600124562607`*^9, 3.734060063003248*^9}, {3.734060151981092*^9, 
   3.734060191746683*^9}, {3.734060532242168*^9, 3.734060537704068*^9}, {
   3.734060585434946*^9, 3.7340606246327257`*^9}, {3.734061322798773*^9, 
   3.7340613832977667`*^9}, {3.734069414109047*^9, 3.734069418132304*^9}, {
   3.734069680538341*^9, 3.734069682825083*^9}, {3.734069733114378*^9, 
   3.734069767695834*^9}, {3.734070638970187*^9, 3.7340706410756283`*^9}, {
   3.734070708827845*^9, 3.7340707230922327`*^9}, {3.734083757070177*^9, 
   3.734083760402235*^9}, {3.7340840063424*^9, 3.734084006846657*^9}, 
   3.734084066556363*^9, {3.7340842329062567`*^9, 3.7340842649203176`*^9}, {
   3.734084439828793*^9, 3.734084441876491*^9}, 3.734085096434462*^9, {
   3.735025726975864*^9, 3.7350257613559637`*^9}, {3.7350258084118757`*^9, 
   3.73502582134374*^9}, {3.7373672276558247`*^9, 3.737367228060437*^9}, {
   3.737367271609766*^9, 3.737367504463647*^9}, {3.737367582693924*^9, 
   3.737367631755705*^9}, {3.737367687697275*^9, 3.737367900789085*^9}, {
   3.737367931531619*^9, 3.7373679328500347`*^9}, {3.737367992378326*^9, 
   3.737368184001418*^9}, {3.737368333564695*^9, 3.737368401954623*^9}, {
   3.737368455521988*^9, 3.7373687186417828`*^9}, {3.7373687558414373`*^9, 
   3.737368894109664*^9}, {3.737370888637344*^9, 3.737370901891749*^9}, {
   3.737371024231876*^9, 3.7373711379412193`*^9}, {3.737371190992815*^9, 
   3.737371197173321*^9}, {3.7373714128846693`*^9, 3.737371471027995*^9}, 
   3.73737150259584*^9, {3.7373716044231253`*^9, 3.737371628470811*^9}, {
   3.737371991230308*^9, 3.73737216973435*^9}, {3.737372259597537*^9, 
   3.73737230284109*^9}, {3.737372371273141*^9, 3.737372416495337*^9}, {
   3.7373726176529007`*^9, 3.737372640371661*^9}, {3.737372675754272*^9, 
   3.737372688047003*^9}, {3.737372730568018*^9, 3.737372787801385*^9}, {
   3.737373842226688*^9, 3.7373738544398613`*^9}, {3.737373922351479*^9, 
   3.7373739660355883`*^9}, {3.7373739961147947`*^9, 
   3.7373740095217733`*^9}, {3.73737417904727*^9, 3.7373741904563*^9}, {
   3.737374318036729*^9, 3.737374333651806*^9}, {3.737374502409672*^9, 
   3.737374528134899*^9}, {3.737374592736747*^9, 3.73737462776425*^9}, {
   3.737382441958872*^9, 3.737382542523754*^9}, {3.737382588651662*^9, 
   3.737382598538786*^9}, {3.737382658892776*^9, 3.737382680641808*^9}, 
   3.737968544778825*^9, {3.738044991514905*^9, 3.738045063823347*^9}, {
   3.738045218611374*^9, 3.738045254776026*^9}, {3.738045467737158*^9, 
   3.738045468426176*^9}, {3.738292472268417*^9, 3.738292476830532*^9}, {
   3.7382975723874826`*^9, 3.738297572664035*^9}, {3.738297678253478*^9, 
   3.738297691732843*^9}, {3.738297799382346*^9, 3.738297799698987*^9}, {
   3.738297854337059*^9, 3.7382978562770987`*^9}, {3.738299981879734*^9, 
   3.738299985756028*^9}, {3.738300232134356*^9, 3.738300265159543*^9}, {
   3.738301417561187*^9, 3.738301421379984*^9}, {3.738305570882181*^9, 
   3.738305574359171*^9}, {3.738305621413837*^9, 3.738305622716712*^9}, {
   3.7383056704989567`*^9, 3.7383056997381477`*^9}, {3.738307257373272*^9, 
   3.738307324478037*^9}, {3.738307399772354*^9, 3.7383074103856564`*^9}, {
   3.738308050665287*^9, 3.7383081040337133`*^9}, {3.738308166180523*^9, 
   3.7383082080336847`*^9}, {3.7383082450667143`*^9, 3.738308250712489*^9}, {
   3.738308384535429*^9, 3.7383083908472548`*^9}, {3.738308495902157*^9, 
   3.738308505252943*^9}, {3.7383086210103207`*^9, 3.7383086225272503`*^9}, {
   3.738308655158655*^9, 3.7383086656697283`*^9}, {3.738309065814824*^9, 
   3.73830911591614*^9}, {3.7383091656127863`*^9, 3.7383092548540363`*^9}, {
   3.7383093166278467`*^9, 3.738309381077928*^9}, {3.7383094140745573`*^9, 
   3.7383094144477453`*^9}, {3.738309474660437*^9, 3.7383094763264933`*^9}, {
   3.738309544373711*^9, 3.7383095672818317`*^9}, {3.738309626746223*^9, 
   3.738309686606472*^9}, {3.7383097878300123`*^9, 3.7383098080184298`*^9}, {
   3.73831008863527*^9, 3.7383100931104927`*^9}, {3.73831012540152*^9, 
   3.738310153239818*^9}, {3.73831018813549*^9, 3.7383101906998787`*^9}, {
   3.738310702605604*^9, 3.7383107366660223`*^9}, {3.738311448517243*^9, 
   3.738311476287703*^9}, {3.73831153232588*^9, 3.738311643201743*^9}, {
   3.73831170591776*^9, 3.7383117596420403`*^9}, {3.738311803135922*^9, 
   3.738311881839653*^9}, {3.738312660839986*^9, 3.738312769887286*^9}, {
   3.738312858806275*^9, 3.738312880821744*^9}, {3.7383130875270042`*^9, 
   3.738313159525738*^9}, {3.73831449690935*^9, 3.73831472574437*^9}, {
   3.738315037050962*^9, 3.738315100386753*^9}, 3.7386448366225033`*^9, {
   3.739209267282373*^9, 3.739209268018241*^9}, {3.739209326856827*^9, 
   3.7392094359818153`*^9}, {3.739209885542487*^9, 3.739209934701859*^9}, {
   3.7392514819307404`*^9, 3.739251581962144*^9}, {3.739255008253765*^9, 
   3.739255011490672*^9}, {3.739255066656047*^9, 3.7392550824240007`*^9}, {
   3.739255142878743*^9, 3.739255283903492*^9}, {3.739255720480454*^9, 
   3.739255727111*^9}, {3.739256287055029*^9, 3.739256341393654*^9}, {
   3.73925641825317*^9, 3.7392565173479767`*^9}, {3.739263649822032*^9, 
   3.739263658124049*^9}, 3.739263715216667*^9, {3.7392637780936117`*^9, 
   3.7392638339231377`*^9}, {3.7392646974800873`*^9, 
   3.7392647880938883`*^9}, {3.739264828770708*^9, 3.739264860614913*^9}, {
   3.739265111538767*^9, 3.73926511238643*^9}, 3.7392651895141582`*^9, {
   3.739265274853752*^9, 3.739265344393036*^9}, 3.739265406508833*^9, {
   3.739265501727188*^9, 3.7392655468414288`*^9}, {3.7392655797055807`*^9, 
   3.739265654530856*^9}, {3.7392658147651653`*^9, 3.739265844506536*^9}, {
   3.739265905041802*^9, 3.739265913559229*^9}, {3.739265992597846*^9, 
   3.739265993275798*^9}, {3.739266033723297*^9, 3.739266035422327*^9}, {
   3.739266811418664*^9, 3.73926687478578*^9}, {3.739266977670642*^9, 
   3.739267041586645*^9}, {3.7392670907045803`*^9, 3.739267124775742*^9}, {
   3.739267566391371*^9, 3.739267581859811*^9}, {3.739267693849613*^9, 
   3.739267733480055*^9}, {3.739500656020678*^9, 3.739500659976337*^9}, {
   3.7395006969264317`*^9, 3.739500713982374*^9}, {3.739501495335629*^9, 
   3.739501544167218*^9}, {3.739501598877145*^9, 3.739501624752326*^9}, {
   3.739501656382229*^9, 3.73950165674544*^9}, {3.739501696252055*^9, 
   3.739501700174621*^9}, {3.739501815789463*^9, 3.739501848527233*^9}, {
   3.7395020425474033`*^9, 3.739502055293776*^9}, {3.739502270383594*^9, 
   3.7395023249533443`*^9}, {3.739502364851117*^9, 3.7395023649874983`*^9}, {
   3.739502397724936*^9, 3.73950245059044*^9}, {3.739502494773876*^9, 
   3.7395025078806763`*^9}, {3.739503687333411*^9, 3.739503690907442*^9}, {
   3.739504615185549*^9, 3.7395046199765778`*^9}, {3.7395046607954073`*^9, 
   3.7395046937366962`*^9}, {3.739504739026966*^9, 3.7395047466587133`*^9}, {
   3.739504808349332*^9, 3.739504840551146*^9}, {3.739505054065979*^9, 
   3.739505086771042*^9}, {3.739505219115593*^9, 3.7395052742229757`*^9}, {
   3.7395053160638657`*^9, 3.7395053687482347`*^9}, {3.739505438709841*^9, 
   3.739505440939834*^9}, {3.739505712856276*^9, 3.739505720094058*^9}, {
   3.73950674796898*^9, 3.7395067895030527`*^9}, {3.739506837284807*^9, 
   3.7395069307398977`*^9}, {3.739510669635346*^9, 3.7395106958391943`*^9}, {
   3.739510854101157*^9, 3.7395108698816967`*^9}, {3.739510902032847*^9, 
   3.7395109474224663`*^9}, {3.739510978476756*^9, 3.739511061221396*^9}, {
   3.739511141633822*^9, 3.739511147488902*^9}, {3.739511365717485*^9, 
   3.7395113847506*^9}, {3.739511574592642*^9, 3.7395115751698093`*^9}, {
   3.739512742152898*^9, 3.739512781917255*^9}, {3.739512835388238*^9, 
   3.739512836450012*^9}, {3.73951292009779*^9, 3.7395129219629602`*^9}, {
   3.73951303923135*^9, 3.739513068695093*^9}, {3.739513170936591*^9, 
   3.739513178640259*^9}, {3.7395132394206257`*^9, 3.739513271927874*^9}, 
   3.739513333199873*^9, {3.739513835482668*^9, 3.7395138598415413`*^9}, {
   3.739516616294798*^9, 3.739516630184428*^9}, {3.739520325663392*^9, 
   3.739520357127063*^9}, 3.73952039036992*^9, {3.739520609942298*^9, 
   3.739520628512047*^9}, {3.7395213965133944`*^9, 3.7395215217751837`*^9}, {
   3.7395218684504423`*^9, 3.739521868798478*^9}, {3.739522181151222*^9, 
   3.739522185509658*^9}, {3.7395250428083553`*^9, 3.73952512999087*^9}, {
   3.739525231381093*^9, 3.739525236148944*^9}, {3.739525441628783*^9, 
   3.739525447141528*^9}, {3.739525625305385*^9, 3.739525630522257*^9}, {
   3.739525688987609*^9, 3.7395257248002577`*^9}, {3.739525961073133*^9, 
   3.739525961341238*^9}, {3.739526200207596*^9, 3.739526260428417*^9}, {
   3.739526412293812*^9, 3.739526448415297*^9}, {3.7395270643373623`*^9, 
   3.7395270673875637`*^9}, {3.7395271048722343`*^9, 3.739527119577311*^9}, {
   3.739527214889127*^9, 3.739527301903318*^9}, {3.739527355429894*^9, 
   3.739527358675673*^9}, {3.7395273897861547`*^9, 3.739527416968782*^9}, {
   3.742010806687113*^9, 3.742010858483757*^9}, {3.742010908226156*^9, 
   3.742010932749796*^9}, {3.742011160214778*^9, 3.74201116475535*^9}, 
   3.742011265860978*^9, {3.74201160271281*^9, 3.7420116069067287`*^9}, {
   3.74201165267314*^9, 3.7420117396509542`*^9}, {3.7420117771334352`*^9, 
   3.742011792107109*^9}, {3.742011841321661*^9, 3.742011845982538*^9}, {
   3.742012242145617*^9, 3.742012242629952*^9}, {3.7420122736923532`*^9, 
   3.7420122964333153`*^9}, {3.742012345700942*^9, 3.742012353132306*^9}, {
   3.74201258496979*^9, 3.742012717560898*^9}, {3.7420256773746157`*^9, 
   3.742025723268963*^9}, {3.742025753509473*^9, 3.742025844855604*^9}, {
   3.742025881411282*^9, 3.742025899104787*^9}, {3.744033690604783*^9, 
   3.7440336969133663`*^9}, 3.744034816827615*^9, {3.75852973119795*^9, 
   3.758529911294166*^9}, {3.759519442614482*^9, 3.759519442890905*^9}, 
   3.762793093566566*^9, {3.786968497135445*^9, 3.786968519427211*^9}, {
   3.807112975593889*^9, 3.807112977103804*^9}, {3.8072434507187567`*^9, 
   3.8072434635701313`*^9}, {3.807244211742119*^9, 3.8072442498268414`*^9}, {
   3.807422768452511*^9, 3.8074227687671003`*^9}, {3.807984471886338*^9, 
   3.807984479498459*^9}, {3.80807600523897*^9, 3.808076112139817*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[713]:=",ExpressionUUID->"8d559df2-20f3-4e6d-818e-906d6986e2f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "[", "\"\<RunDialogue\>\"", "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "name", ",", "gridA", ",", "gridB", ",", "currentGrid", ",", 
         "updGrid", ",", "\[IndentingNewLine]", 
         RowBox[{"sgKeys", "=", 
          RowBox[{"Keys", "@", "$SpaceGroups"}]}], ",", 
         RowBox[{"sgNumber", "=", "Null"}], ",", 
         RowBox[{"sgSymbol", "=", "Null"}], ",", "\[IndentingNewLine]", 
         "crystalSystem", ",", "systemParameterFields", ",", 
         "parameterFields", ",", "\[IndentingNewLine]", 
         RowBox[{"a", "=", "Null"}], ",", 
         RowBox[{"b", "=", "Null"}], ",", 
         RowBox[{"c", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]", "=", "Null"}], ",", 
         RowBox[{"\[Beta]", "=", "Null"}], ",", 
         RowBox[{"\[Gamma]", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"chemicalFormula", "=", "Null"}], ",", 
         RowBox[{"wavelength", "=", "Null"}], ",", 
         RowBox[{"massDensity", "=", "Null"}], ",", 
         RowBox[{"formulaUnits", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"atomdata", "=", 
          RowBox[{"{", "}"}]}], ",", "atomdataSummary", ",", 
         "updAtomdataSummary", ",", "\[IndentingNewLine]", 
         "createDeleteButtons", ",", "deleteButtons", ",", 
         "createAtomdataPanel", ",", 
         RowBox[{"atomdataPanel", "=", "\"\<(no entries)\>\""}], ",", 
         "updAtomdataPanel", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Adding", " ", "entries"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"element", "=", "Null"}], ",", "elementListWithNumber", ",", 
         "\[IndentingNewLine]", "coordinates", ",", "\[IndentingNewLine]", 
         RowBox[{"coordX", "=", "Null"}], ",", 
         RowBox[{"coordY", "=", "Null"}], ",", 
         RowBox[{"coordZ", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"occupationFactor", "=", "Null"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"adpType", "=", "\"\<Isotropic\>\""}], ",", "createAdpField",
          ",", "adpField", ",", "\[IndentingNewLine]", 
         RowBox[{"adpU11", "=", "Null"}], ",", 
         RowBox[{"adpU22", "=", "Null"}], ",", 
         RowBox[{"adpU33", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"adpU12", "=", "Null"}], ",", 
         RowBox[{"adpU13", "=", "Null"}], ",", 
         RowBox[{"adpU23", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"adpUiso", "=", "Null"}], ",", "ADPs", ",", 
         "\[IndentingNewLine]", "updRet", ",", "toBeReturned", ",", 
         RowBox[{"validQ", "=", "False"}]}], "\[IndentingNewLine]", "}"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", "-"}], "*", " ", "Setup", " ", "for", " ", "grid", " ",
          "B", " ", "*", 
         RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Logic", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"elementListWithNumber", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< (\>\"", "<>", "\[IndentingNewLine]", 
            RowBox[{"ToString", "@", 
             RowBox[{"$PeriodicTable", "[", 
              RowBox[{"#", ",", "\"\<AtomicNumber\>\""}], "]"}]}], "<>", 
            "\[IndentingNewLine]", "\"\<)\>\""}], "&"}], "/@", 
          RowBox[{"Keys", "@", "$PeriodicTable"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"elementListWithNumber", "=", 
         RowBox[{"Thread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Keys", "@", "$PeriodicTable"}], "\[Rule]", 
           "elementListWithNumber"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"createAdpField", "[", "]"}], ":=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"adpType", "===", "\"\<Isotropic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"adpField", "=", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"adpUiso", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpUiso", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                 ",", "\[IndentingNewLine]", "Number", ",", 
                 RowBox[{"FieldSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                 RowBox[{
                 "FieldHint", "\[Rule]", 
                  "\"\<\!\(\*SubscriptBox[\(U\), \(iso\)]\)\>\""}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Spacer", "[", 
                RowBox[{"{", 
                 RowBox[{"165.", ",", "17.5"}], "}"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"adpType", "===", "\"\<Anisotropic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"adpField", "=", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU11", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU11", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(11\)]\)\>\""}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Spacer", "[", "5", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU22", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU22", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(22\)]\)\>\""}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Spacer", "[", "5", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU33", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU33", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(33\)]\)\>\""}]}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU12", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU12", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(12\)]\)\>\""}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Spacer", "[", "5", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU13", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU13", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(13\)]\)\>\""}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Spacer", "[", "5", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU23", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU23", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(23\)]\)\>\""}]}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"createAdpField", "[", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Dynamic", " ", "variable", " ", "storing", " ", "input", " ", 
          "data"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ADPs", "=", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"{", 
           RowBox[{
           "adpU11", ",", "adpU22", ",", "adpU33", ",", "adpU12", ",", 
            "adpU13", ",", "adpU23"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coordinates", "=", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"{", 
           RowBox[{"coordX", ",", "coordY", ",", "coordZ"}], "}"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updRet", "[", "]"}], ":=", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"toBeReturned", "=", 
            RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"element", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"toBeReturned", ",", 
               RowBox[{"\"\<Element\>\"", "\[Rule]", "element"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"KeyDropFrom", "[", 
              RowBox[{"toBeReturned", ",", "\"\<Element\>\""}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"occupationFactor", "=!=", "Null"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"toBeReturned", ",", 
               RowBox[{
               "\"\<OccupationFactor\>\"", "\[Rule]", "occupationFactor"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"KeyDropFrom", "[", 
              RowBox[{"toBeReturned", ",", "\"\<OccupationFactor\>\""}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{
               RowBox[{
               "coordinates", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], ",", "NumericQ"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"toBeReturned", ",", 
               RowBox[{
               "\"\<FractionalCoordinates\>\"", "\[Rule]", "coordinates"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"KeyDropFrom", "[", 
              RowBox[{"toBeReturned", ",", "\"\<FractionalCoordinates\>\""}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"adpType", "===", "\"\<Anisotropic\>\""}], ")"}], "&&", 
              RowBox[{"AllTrue", "[", 
               RowBox[{
                RowBox[{
                "ADPs", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", "NumericQ"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"AssociateTo", "[", 
               RowBox[{"toBeReturned", ",", 
                RowBox[{
                "\"\<DisplacementParameters\>\"", "\[Rule]", "ADPs"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"toBeReturned", ",", 
                RowBox[{"\"\<Type\>\"", "\[Rule]", "\"\<Uani\>\""}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"adpType", "===", "\"\<Isotropic\>\""}], ")"}], "&&", 
              RowBox[{"NumericQ", "@", "adpUiso"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"AssociateTo", "[", 
               RowBox[{"toBeReturned", ",", 
                RowBox[{
                "\"\<DisplacementParameters\>\"", "\[Rule]", "adpUiso"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"toBeReturned", ",", 
                RowBox[{"\"\<Type\>\"", "\[Rule]", "\"\<Uiso\>\""}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", "True", ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"KeyDropFrom", "[", 
              RowBox[{"toBeReturned", ",", "\"\<DisplacementParameters\>\""}],
               "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"element", "=!=", "Null"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"AllTrue", "[", 
                RowBox[{
                 RowBox[{
                 "coordinates", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", "NumericQ"}], "]"}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"validQ", "=", "True"}], ",", 
             RowBox[{"validQ", "=", "False"}]}], "]"}]}], 
          "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"updRet", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"--", "-"}], "*"}], " ", "//", " ", 
           RowBox[{"End", " ", "of", " ", "grid", " ", "B", " ", "setup"}]}], 
          " ", "//", " ", 
          RowBox[{"*", 
           RowBox[{"--", "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Logic", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"systemParameterFields", "[", "system_String", "]"}], ":=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"system", "===", "\"\<Triclinic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "a"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "b"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "\[Alpha]"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "\[Beta]"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "\[Gamma]"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"system", "===", "\"\<Monoclinic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "a"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "b"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "\[Gamma]"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"system", "===", "\"\<Orthorhombic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "a"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "b"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Gamma]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"system", "===", "\"\<Tetragonal\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "=", "#"}], ";", 
                    RowBox[{"b", "=", "#"}]}], ")"}], "&"}]}], "]"}], ",", 
                    "Number", ",", "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"b", "=", 
                    RowBox[{"Dynamic", "@", "a"}]}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"system", "===", "\"\<Hexagonal\>\""}], "||", 
            RowBox[{"system", "===", "\"\<Trigonal\>\""}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "=", "#"}], ";", 
                    RowBox[{"b", "=", "#"}]}], ")"}], "&"}]}], "]"}], ",", 
                    "Number", ",", "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"b", "=", 
                    RowBox[{"Dynamic", "@", "a"}]}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "=", "120"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"system", "===", "\"\<Cubic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "=", "#"}], ";", 
                    RowBox[{"b", "=", "#"}], ";", 
                    RowBox[{"c", "=", "#"}]}], ")"}], "&"}]}], "]"}], ",", 
                    "Number", ",", "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"b", "=", 
                    RowBox[{"Dynamic", "@", "a"}]}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"c", "=", 
                    RowBox[{"Dynamic", "@", "a"}]}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Atom", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updAtomdataSummary", "[", "]"}], ":=", 
         RowBox[{"atomdataSummary", "=", 
          RowBox[{"atomdata", "\[LeftDoubleBracket]", "\[IndentingNewLine]", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Element\>\"", ",", "\"\<FractionalCoordinates\>\""}], 
             "}"}]}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"createDeleteButtons", "[", "]"}], ":=", 
         RowBox[{"deleteButtons", "=", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Button", "[", 
             RowBox[{"\"\<\[Times]\>\"", ",", 
              RowBox[{
               RowBox[{"atomdataSummary", "=", 
                RowBox[{"Delete", "[", 
                 RowBox[{"atomdataSummary", ",", "#"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"createDeleteButtons", "[", "]"}], ";", 
               RowBox[{"createAtomdataPanel", "[", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], "]"}],
             "&"}], "/@", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", "atomdataSummary"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"createAtomdataPanel", "[", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"deleteButtons", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"atomdataPanel", "=", "\"\<(no entries)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"atomdataPanel", "=", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"Pane", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Grid", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "@", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Values", "@", "atomdataSummary"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "deleteButtons", "}"}]}], "]"}]}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], ",", 
                RowBox[{"Scrollbars", "\[Rule]", "False"}]}], "]"}], "}"}], 
             "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updAtomdataPanel", "[", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"atomdata", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"atomdataPanel", "=", "\"\<(no entries)\>\""}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"updAtomdataSummary", "[", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"createDeleteButtons", "[", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"createAtomdataPanel", "[", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Initial", " ", "settings"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"parameterFields", "=", 
         RowBox[{"systemParameterFields", "[", "\"\<Triclinic\>\"", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"updAtomdataPanel", "[", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"--", "-"}], "*", " ", "Grids", " ", "*", 
          RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grid", " ", "switcher"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updGrid", "[", "label_String", "]"}], ":=", 
         RowBox[{"currentGrid", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"label", "===", "\"\<A\>\""}], ",", "gridA", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"label", "===", "\"\<B\>\""}], ",", "gridB"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"updGrid", "[", "\"\<A\>\"", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grid", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"gridA", "=", 
         RowBox[{"Dynamic", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Crystal name\>\"", ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "name"}], ",", "String", ",", 
                RowBox[{
                "FieldHint", "\[Rule]", "\"\<Crystal name or label\>\""}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<Space group\>\"", ",", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"Row", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"PopupMenu", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"sgNumber", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"sgNumber", "=", "#"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sgSymbol", "=", 
                    RowBox[{
                    "sgKeys", "\[LeftDoubleBracket]", "sgNumber", 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"crystalSystem", "=", 
                    RowBox[{"$SpaceGroups", "[", 
                    RowBox[{"sgSymbol", ",", "\"\<CrystalSystem\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"parameterFields", "=", 
                    RowBox[{
                    "systemParameterFields", "[", "crystalSystem", "]"}]}]}], 
                    "\[IndentingNewLine]", ")"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\t", 
                    RowBox[{"Range", "@", "230"}], ",", "\"\<Number\>\""}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"PopupMenu", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"sgSymbol", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"sgSymbol", "=", "#"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sgNumber", "=", 
                    RowBox[{"$SpaceGroups", "[", 
                    RowBox[{"sgSymbol", ",", "\"\<SpaceGroupNumber\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"crystalSystem", "=", 
                    RowBox[{"$SpaceGroups", "[", 
                    RowBox[{"sgSymbol", ",", "\"\<CrystalSystem\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"parameterFields", "=", 
                    RowBox[{
                    "systemParameterFields", "[", "crystalSystem", "]"}]}]}], 
                    "\[IndentingNewLine]", ")"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\t", 
                    RowBox[{"Keys", "@", "$SpaceGroups"}], ",", 
                    "\"\<Symbol\>\""}], "]"}]}], "}"}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{"\"\<Lattice parameters\>\"", ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<a  b  c\>\"", ",", 
                   "\"\<\[Alpha]  \[Beta]  \[Gamma]\>\"", ",", 
                   "\"\<\[ARing]ngstr\[ODoubleDot]m and degree\>\""}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "@", "parameterFields"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
               "\"\<Chemical formula\>\"", ",", 
                "\"\<e.g. 'C13 H22 Fe N6 S3'\>\"", ",", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "chemicalFormula"}], ",", "String", 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                "FieldHint", "\[Rule]", "\"\<e.g. 'C13 H22 Fe N6 S3'\>\""}]}],
                "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
               "\"\<Wavelength\>\"", ",", 
                "\"\<\[ARing]ngstr\[ODoubleDot]m\>\"", ",", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "wavelength"}], ",", "Number", ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Lambda]\>\""}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PopupMenu", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "wavelength"}], ",", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "1.54059", "\[Rule]", 
                    "\"\<Cu \!\(\*SubscriptBox[\(K\[Alpha]\), \(1\)]\)\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "1.54443", "\[Rule]", 
                    "\"\<Cu \!\(\*SubscriptBox[\(K\[Alpha]\), \(2\)]\)\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "1.39223", "\[Rule]", 
                    "\"\<Cu \!\(\*SubscriptBox[\(K\[Beta]\), \(1\)]\)\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "0.70932", "\[Rule]", 
                    "\"\<Mo \!\(\*SubscriptBox[\(K\[Alpha]\), \(1\)]\)\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "0.71361", "\[Rule]", 
                    "\"\<Mo \!\(\*SubscriptBox[\(K\[Alpha]\), \(2\)]\)\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "0.63230", "\[Rule]", 
                    "\"\<Mo \!\(\*SubscriptBox[\(K\[Beta]\), \
\(1\)]\)\>\""}]}], "\[IndentingNewLine]", "}"}], ",", 
                   "\"\<(Predefined)\>\""}], "]"}]}], "\[IndentingNewLine]", 
                "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
               "\"\<Mass density\>\"", ",", 
                "\"\<g/\!\(\*SuperscriptBox[\(cm\), \(3\)]\)\>\"", ",", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "massDensity"}], ",", "Number", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Rho]\>\""}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", "\"\<formula units\>\"", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "formulaUnits"}], ",", "Number", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<Z\>\""}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<Atom data\>\"", ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<Add new element\>\"", ",", 
                   RowBox[{"updGrid", "[", "\"\<B\>\"", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "@", "atomdataPanel"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"CancelButton", "[", "]"}], ",", 
                 RowBox[{"DefaultButton", "[", "\[IndentingNewLine]", 
                  RowBox[{"DialogReturn", "[", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{"Final", " ", "checks"}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"StringQ", "@", "name"}]}], ",", 
                    RowBox[{"name", "=", "\"\<(no name)\>\""}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"chemicalFormula", "===", "Null"}], ",", 
                    RowBox[{"chemicalFormula", "=", "\"\<\>\""}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"formulaUnits", "===", "Null"}], ",", 
                    RowBox[{"formulaUnits", "=", "0"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sgSymbol", "===", "Null"}], ",", 
                    RowBox[{"sgSymbol", "=", "1"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"wavelength", "===", "Null"}], ",", 
                    RowBox[{"wavelength", "=", 
                    RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]",
                     "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", "Return", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"MaXrd`Private`$temp", "=", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "name", ",", "chemicalFormula", ",", "formulaUnits", ",", 
                    "sgSymbol", ",", "wavelength"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", 
                    ",", "\[Gamma]"}], "}"}], ",", "atomdata"}], 
                    "\[IndentingNewLine]", "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MaXrd`Private`$temp", "=", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"MaXrd`Private`$temp", ",", "\[IndentingNewLine]", 
                    RowBox[{"x_Dynamic", "\[RuleDelayed]", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
                   "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grid", " ", "B"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"gridB", "=", 
         RowBox[{"Dynamic", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Element\>\"", ",", 
              RowBox[{"PopupMenu", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"element", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"element", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                ",", "\[IndentingNewLine]", "elementListWithNumber", ",", 
                "\"\<Element\>\""}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<Fractional coordinates\>\"", ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"coordX", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"coordX", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<x\>\""}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"coordY", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"coordY", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<y\>\""}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"coordZ", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"coordZ", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<z\>\""}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<Occupation factor\>\"", ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"occupationFactor", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"occupationFactor", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                ",", "Number", ",", 
                RowBox[{"FieldSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                RowBox[{"FieldHint", "\[Rule]", "\"\<1\>\""}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
               "\"\<ADP type\>\"", ",", 
                "\"\<Anisotropic displacement parameters\>\"", ",", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"RadioButtonBar", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"adpType", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpType", "=", "#"}], ";", 
                    RowBox[{"createAdpField", "[", "]"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Isotropic\>\"", ",", "\"\<Anisotropic\>\""}], 
                 "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<Active\>\""}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"Dynamic", "@", "adpField"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"CancelButton", "[", 
                  RowBox[{"updGrid", "[", "\"\<A\>\"", "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"DefaultButton", "[", 
                  RowBox[{"\"\<Add\>\"", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"atomdata", ",", "\[IndentingNewLine]", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"toBeReturned", ",", 
                    RowBox[{"x_Dynamic", "\[RuleDelayed]", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"updAtomdataPanel", "[", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"updGrid", "[", "\"\<A\>\"", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"Dynamic", "@", "validQ"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grid", " ", "on", " ", "display"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Dynamic", "@", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{
           "currentGrid", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0.5"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dialogue", " ", "settings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
     "WindowTitle", "\[Rule]", "\"\<Add crystal to $CrystalData\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Modal", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"WindowSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"310", ",", "All"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739595978214114*^9, 3.739595990960588*^9}, {
   3.739596669627418*^9, 3.739596695911725*^9}, {3.739596912394574*^9, 
   3.739596932092749*^9}, {3.7395970199751673`*^9, 3.739597066689048*^9}, {
   3.73959711186619*^9, 3.739597356240508*^9}, {3.739597461697694*^9, 
   3.7395975030637703`*^9}, {3.739597555516307*^9, 3.739597641340172*^9}, {
   3.739597793824828*^9, 3.7395978241317577`*^9}, {3.739597855600132*^9, 
   3.739597902263493*^9}, {3.739598245770096*^9, 3.739598361343294*^9}, {
   3.739599172833571*^9, 3.739599177517766*^9}, {3.739599213923336*^9, 
   3.739599322529324*^9}, 3.739599511772471*^9, {3.739599555972958*^9, 
   3.739599564138731*^9}, {3.739599596703545*^9, 3.739599679162033*^9}, {
   3.739599709968329*^9, 3.739599729728099*^9}, {3.739599777433371*^9, 
   3.739599819200165*^9}, {3.7396001729638844`*^9, 3.7396002251424217`*^9}, 
   3.739600299286446*^9, {3.739600366177018*^9, 3.739600398831429*^9}, {
   3.739600442540759*^9, 3.739600442810607*^9}, {3.739600491367622*^9, 
   3.7396005534641953`*^9}, {3.7396006186292343`*^9, 
   3.7396006874968777`*^9}, {3.739600838419689*^9, 3.7396009595871468`*^9}, {
   3.739601031898162*^9, 3.7396010323136044`*^9}, {3.73960143563618*^9, 
   3.739601464736333*^9}, {3.739601721310192*^9, 3.739601722306417*^9}, {
   3.739602479115416*^9, 3.739602547709318*^9}, {3.73960261429424*^9, 
   3.739602633508088*^9}, {3.739602666336516*^9, 3.7396026675947447`*^9}, {
   3.7396027284612103`*^9, 3.739602738197445*^9}, {3.739602881326993*^9, 
   3.739602909640366*^9}, {3.739603624511942*^9, 3.739603791042316*^9}, {
   3.739603996203532*^9, 3.739604101606237*^9}, {3.739604146456543*^9, 
   3.73960415529599*^9}, {3.739604214561223*^9, 3.739604219167306*^9}, {
   3.7396042506303787`*^9, 3.739604268312009*^9}, {3.739604473386827*^9, 
   3.739604664867947*^9}, {3.739604847714067*^9, 3.73960497908556*^9}, {
   3.739605188312948*^9, 3.73960526815869*^9}, {3.7396053616518307`*^9, 
   3.739605380756493*^9}, {3.739606390752233*^9, 3.739606582251404*^9}, {
   3.73960661254064*^9, 3.739606647981111*^9}, {3.7396067107737417`*^9, 
   3.739606739461856*^9}, {3.7396075023942213`*^9, 3.73960754045004*^9}, {
   3.7396075782464437`*^9, 3.7396076187558393`*^9}, {3.73960765770329*^9, 
   3.739607781095315*^9}, {3.739607816578467*^9, 3.7396079456654997`*^9}, {
   3.7396079883067503`*^9, 3.739608014913579*^9}, {3.739608138957831*^9, 
   3.7396081392048283`*^9}, {3.739608180236808*^9, 3.73960818041252*^9}, {
   3.739608232358246*^9, 3.7396082832029963`*^9}, {3.739608314916871*^9, 
   3.7396083814410763`*^9}, {3.739608413778994*^9, 3.739608414923287*^9}, {
   3.739608540812207*^9, 3.739608564697151*^9}, {3.7396086208319187`*^9, 
   3.739608707325838*^9}, {3.7396087516824512`*^9, 3.739608772848316*^9}, {
   3.7396088172813683`*^9, 3.739608873886364*^9}, {3.739608949401414*^9, 
   3.739608971227984*^9}, {3.739609090888156*^9, 3.7396091126284237`*^9}, {
   3.739609146205271*^9, 3.739609200960956*^9}, {3.739609272821333*^9, 
   3.739609364028111*^9}, {3.739609461069508*^9, 3.739609674326315*^9}, {
   3.739609740987973*^9, 3.7396097423774967`*^9}, {3.7396098442242126`*^9, 
   3.739609861229912*^9}, 3.739609894456533*^9, {3.739610012922155*^9, 
   3.739610013510725*^9}, {3.739610062273484*^9, 3.739610108332995*^9}, 
   3.739610279762279*^9, 3.739610309890603*^9, {3.7396103881359386`*^9, 
   3.739610408666873*^9}, {3.739610449368506*^9, 3.739610474008996*^9}, {
   3.739610518181279*^9, 3.739610561128326*^9}, {3.739610605216217*^9, 
   3.7396106533798933`*^9}, {3.7396106961302347`*^9, 3.739610719521283*^9}, {
   3.7396107514167*^9, 3.739610785658737*^9}, {3.739610821836543*^9, 
   3.7396108270223303`*^9}, {3.739610904406472*^9, 3.7396109432912703`*^9}, {
   3.739610983393579*^9, 3.739610985921002*^9}, {3.739611047610756*^9, 
   3.739611082981056*^9}, {3.7396111202331247`*^9, 3.739611141913677*^9}, {
   3.739611174288352*^9, 3.7396112737859983`*^9}, {3.739611337138582*^9, 
   3.739611396260716*^9}, {3.7396228109407873`*^9, 3.739622874736499*^9}, {
   3.739622964649042*^9, 3.7396229763536654`*^9}, {3.739623010221518*^9, 
   3.73962313081952*^9}, {3.7396231658281612`*^9, 3.739623295079341*^9}, {
   3.739623332696557*^9, 3.739623332845948*^9}, {3.7396233779106073`*^9, 
   3.739623380655662*^9}, {3.7396234416776657`*^9, 3.739623517554187*^9}, {
   3.739623579334292*^9, 3.739623580450202*^9}, {3.739623651727364*^9, 
   3.739623662398727*^9}, {3.739623711135504*^9, 3.739623723580459*^9}, {
   3.7396273924772997`*^9, 3.739627495663086*^9}, {3.739627533657785*^9, 
   3.7396275715670977`*^9}, {3.739627602949834*^9, 3.739627758744505*^9}, {
   3.7396279052729*^9, 3.739627995644252*^9}, {3.73962812681828*^9, 
   3.739628140968225*^9}, {3.739628194120064*^9, 3.739628295620471*^9}, {
   3.739628515689384*^9, 3.739628592021266*^9}, {3.73962863395826*^9, 
   3.739628672903981*^9}, {3.739628719307742*^9, 3.739628853107712*^9}, {
   3.739628886385207*^9, 3.739628914180913*^9}, {3.739628990749894*^9, 
   3.739629014507296*^9}, {3.739629048859845*^9, 3.7396290748589783`*^9}, {
   3.739629383121718*^9, 3.7396293892553387`*^9}, {3.739629419353114*^9, 
   3.739629467696455*^9}, {3.739629579611897*^9, 3.739629594562914*^9}, {
   3.7396297021955147`*^9, 3.739629738962376*^9}, {3.7396298004087954`*^9, 
   3.7396299112522182`*^9}, {3.739629988308178*^9, 3.7396300054739428`*^9}, {
   3.739630076970662*^9, 3.739630092649198*^9}, {3.739630156530631*^9, 
   3.739630228830247*^9}, {3.739630260800342*^9, 3.739630351211857*^9}, {
   3.739630389373459*^9, 3.739630435431656*^9}, {3.7396304725706778`*^9, 
   3.739630502657832*^9}, {3.7396306002789*^9, 3.739630622685934*^9}, {
   3.739630702597105*^9, 3.739630787593442*^9}, {3.739630862777617*^9, 
   3.739630943598301*^9}, {3.739630996477914*^9, 3.739631079224884*^9}, {
   3.739631110227867*^9, 3.739631216168207*^9}, {3.739631268639762*^9, 
   3.7396314065719137`*^9}, {3.7396314393177147`*^9, 3.739631458844926*^9}, {
   3.73963149461353*^9, 3.73963155381565*^9}, {3.739631623512226*^9, 
   3.73963177342599*^9}, 3.739631815864191*^9, {3.739631869031271*^9, 
   3.739631945612903*^9}, {3.739631979531575*^9, 3.7396319840424557`*^9}, {
   3.7396320736534*^9, 3.7396320917410088`*^9}, {3.739632142721302*^9, 
   3.739632142863393*^9}, {3.73963219202211*^9, 3.7396322821004553`*^9}, {
   3.739632388268977*^9, 3.739632402956642*^9}, {3.739632435368124*^9, 
   3.7396327242385*^9}, {3.739632762526031*^9, 3.739632785336027*^9}, {
   3.739632827056922*^9, 3.739632827878628*^9}, {3.739632862923669*^9, 
   3.739632886577631*^9}, {3.739632963861861*^9, 3.7396330248348637`*^9}, {
   3.739675412157125*^9, 3.739675516086557*^9}, {3.739675594294528*^9, 
   3.739675656767128*^9}, {3.739675800550416*^9, 3.739675861434029*^9}, {
   3.7396759204476757`*^9, 3.739675943988346*^9}, {3.7396761895284767`*^9, 
   3.7396762101909847`*^9}, {3.739679000703518*^9, 3.7396791367361727`*^9}, {
   3.739679188600012*^9, 3.739679190122048*^9}, 3.739679236458902*^9, {
   3.739679299103034*^9, 3.739679382796001*^9}, {3.739679426804431*^9, 
   3.739679432938841*^9}, {3.7396794731976*^9, 3.739679510055163*^9}, {
   3.7396795991342297`*^9, 3.739679636995349*^9}, {3.739679699275319*^9, 
   3.7396797003419943`*^9}, {3.739679741712719*^9, 3.7396798364763117`*^9}, {
   3.739679885259416*^9, 3.739679887258333*^9}, {3.739680577068009*^9, 
   3.7396805980576267`*^9}, {3.73968066677735*^9, 3.739680678443376*^9}, {
   3.7396808330637836`*^9, 3.7396808539610367`*^9}, {3.7396810247286797`*^9, 
   3.739681026881317*^9}, {3.739681155384138*^9, 3.739681213740945*^9}, {
   3.739681332020043*^9, 3.739681407632062*^9}, {3.739682613028644*^9, 
   3.739682671253872*^9}, {3.7396828519162493`*^9, 3.7396829003948298`*^9}, {
   3.7396833755889797`*^9, 3.739683405064172*^9}, {3.7396834374814043`*^9, 
   3.7396834429171047`*^9}, 3.739683489676093*^9, {3.739684106265815*^9, 
   3.739684118955434*^9}, {3.739684179627265*^9, 3.7396842015951138`*^9}, {
   3.739684263587494*^9, 3.739684283216798*^9}, {3.73968880388513*^9, 
   3.739688838171343*^9}, {3.739688873192896*^9, 3.739688946020999*^9}, {
   3.739688988543015*^9, 3.739689104402824*^9}, {3.739689142834998*^9, 
   3.739689192432645*^9}, {3.73968922669903*^9, 3.7396892327928667`*^9}, {
   3.7396892708092947`*^9, 3.739689272888376*^9}, {3.739689314201379*^9, 
   3.739689368910149*^9}, {3.739689510382373*^9, 3.7396895422579107`*^9}, {
   3.739689774190139*^9, 3.739689778940134*^9}, {3.739689829620129*^9, 
   3.73968990164141*^9}, {3.739689951569553*^9, 3.739690108283433*^9}, {
   3.73969017399741*^9, 3.739690229819253*^9}, {3.739690264866005*^9, 
   3.739690342849268*^9}, {3.739758946799944*^9, 3.7397589481111593`*^9}, {
   3.739758995366086*^9, 3.739759002839532*^9}, {3.739863575531982*^9, 
   3.739863578353183*^9}, {3.739863707824779*^9, 3.739863740157061*^9}, {
   3.739863771072855*^9, 3.739863791517488*^9}, {3.739863868162785*^9, 
   3.739863870886099*^9}, {3.7398639129310913`*^9, 3.739863948384541*^9}, {
   3.739864013949608*^9, 3.7398640383000107`*^9}, {3.739864207728085*^9, 
   3.739864230387827*^9}, 3.739864282806341*^9, {3.739864336316687*^9, 
   3.739864377023755*^9}, {3.7398644823866262`*^9, 3.739864508937294*^9}, {
   3.739864848672627*^9, 3.739864856776475*^9}, {3.739864925721705*^9, 
   3.739864955440385*^9}, {3.739865048067428*^9, 3.739865100600758*^9}, {
   3.739865824948411*^9, 3.739865847441052*^9}, 3.739865896990898*^9, {
   3.739865928772797*^9, 3.739865969487401*^9}, {3.739866026639572*^9, 
   3.739866030789463*^9}, {3.7398661246333723`*^9, 3.739866125022056*^9}, {
   3.739866218724064*^9, 3.739866234677065*^9}, {3.739866367311499*^9, 
   3.739866367481835*^9}, {3.7398663985689*^9, 3.739866523829637*^9}, {
   3.739866571058456*^9, 3.7398665713374557`*^9}, {3.739866652844152*^9, 
   3.739866658837242*^9}, {3.739866718000596*^9, 3.7398667238271933`*^9}, {
   3.739866781347661*^9, 3.739866804024081*^9}, {3.7398668441415777`*^9, 
   3.7398668846214046`*^9}, {3.739866960197887*^9, 3.739867013444448*^9}, {
   3.739867046244567*^9, 3.739867065060412*^9}, {3.739867836084358*^9, 
   3.7398679029305677`*^9}, {3.739868009517646*^9, 3.7398680099155197`*^9}, {
   3.73986838483932*^9, 3.739868480695668*^9}, {3.739868581166408*^9, 
   3.7398685893985233`*^9}, {3.739868636008234*^9, 3.739868658031337*^9}, {
   3.7398686946914787`*^9, 3.739868712473447*^9}, {3.739868787636284*^9, 
   3.739868804537919*^9}, {3.739869520246541*^9, 3.7398695411085653`*^9}, {
   3.739869953126285*^9, 3.739869976386943*^9}, {3.739870087611046*^9, 
   3.7398702328716516`*^9}, {3.739870350125676*^9, 3.739870392186141*^9}, {
   3.739870422566345*^9, 3.7398704849265003`*^9}, {3.7398705309234533`*^9, 
   3.7398705454106703`*^9}, {3.739870622355419*^9, 3.739870711135853*^9}, {
   3.739870762703689*^9, 3.739870762984342*^9}, {3.739876439573551*^9, 
   3.739876456494874*^9}, {3.73987676781678*^9, 3.739876806094466*^9}, {
   3.739876944013143*^9, 3.739876966551764*^9}, {3.739877083454373*^9, 
   3.739877148859359*^9}, {3.739877228013012*^9, 3.739877232938452*^9}, {
   3.739877402328149*^9, 3.7398774168235397`*^9}, 3.739883203190524*^9, {
   3.7398838170096703`*^9, 3.7398838284660063`*^9}, {3.739884144446562*^9, 
   3.739884151374771*^9}, 3.7398842053380117`*^9, {3.739884364414351*^9, 
   3.739884366328815*^9}, 3.739884400758272*^9, {3.740715301864786*^9, 
   3.74071530491991*^9}, {3.740718948306694*^9, 3.740718974231278*^9}, {
   3.740719005521709*^9, 3.740719076476572*^9}, {3.740719249286849*^9, 
   3.740719282471192*^9}, {3.740719319774604*^9, 3.740719321100967*^9}, {
   3.740719355530716*^9, 3.740719356375108*^9}, {3.740719476017921*^9, 
   3.740719545357823*^9}, {3.740719585650416*^9, 3.740719627948525*^9}, {
   3.7407196636576643`*^9, 3.740719678868546*^9}, {3.740720112294278*^9, 
   3.7407202424705763`*^9}, {3.740720281690967*^9, 3.740720360295545*^9}, {
   3.7407204178744917`*^9, 3.7407204517139597`*^9}, {3.740720542486318*^9, 
   3.7407206238042316`*^9}, {3.7407206598393383`*^9, 3.740720683396193*^9}, {
   3.7407207541633797`*^9, 3.740720754676684*^9}, {3.740722123423622*^9, 
   3.740722139079146*^9}, {3.740722618155561*^9, 3.740722618528919*^9}, {
   3.740725597051619*^9, 3.7407256103766947`*^9}, {3.743835348895899*^9, 
   3.743835350614464*^9}, {3.744033597296912*^9, 3.7440336078716087`*^9}, {
   3.7440336543163357`*^9, 3.744033668984364*^9}, {3.7585299130209827`*^9, 
   3.758529955658185*^9}, 3.7627930936625423`*^9, {3.7649582675680656`*^9, 
   3.764958270948595*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[714]:=",
 CellID->737696194,ExpressionUUID->"f213a4cc-ad69-490a-86c7-33eb3e706dcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportCrystalData", "[", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "name", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MaXrd`Private`$temp", "=", "Null"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ImportCrystalData", "[", "\"\<RunDialogue\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MaXrd`Private`$temp", "===", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"name", "=", 
      RowBox[{"MaXrd`Private`$temp", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Execute", " ", "ImportCrystalData", " ", "on", " ", "input", " ", 
       "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "@", "MaXrd`Private`$temp"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "MaXrd`Private`$temp", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"x_Dynamic", "\[RuleDelayed]", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
             ",", "NumericQ"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ImportCrystalData", "::", "latticeParameters"}], "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImportCrystalData", "@@", "MaXrd`Private`$temp"}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reset", " ", "temporary", " ", "variable"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"MaXrd`Private`$temp", "=", "Null"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<ShallowDisplayCrystal\>\"", ",", "name"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739877426691807*^9, 3.739877512185233*^9}, {
   3.739877546275635*^9, 3.7398776229190817`*^9}, {3.739877703000132*^9, 
   3.739877749709647*^9}, {3.739877809507863*^9, 3.739877812473098*^9}, {
   3.73988326754291*^9, 3.7398833299152517`*^9}, 3.739883389420485*^9, {
   3.739883430701161*^9, 3.7398834730901318`*^9}, {3.7407211261529217`*^9, 
   3.740721187584734*^9}, 3.740721261813945*^9, {3.740721315715322*^9, 
   3.740721315988946*^9}, {3.740721861127396*^9, 3.7407218680373373`*^9}, {
   3.7407225108236713`*^9, 3.740722544404612*^9}, {3.740722575666327*^9, 
   3.740722581820733*^9}, {3.7407266695846148`*^9, 3.7407266704084167`*^9}, {
   3.7416719890224524`*^9, 3.74167199814979*^9}, {3.741672032958386*^9, 
   3.741672045595846*^9}, {3.743835351755103*^9, 3.7438353571302423`*^9}, {
   3.758529957439567*^9, 3.7585299679328337`*^9}, 3.762793093672283*^9, {
   3.787461129238645*^9, 3.7874611307007437`*^9}, {3.807981693826251*^9, 
   3.80798170921765*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[715]:=",ExpressionUUID->"10e950f1-eac3-4f49-8a35-c93f6b81a050"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[716]:=",ExpressionUUID->"03553b0d-e275-46a6-8bf3-3a190fe1a871"]
}, Closed]],

Cell[CellGroupData[{

Cell["InputCheck", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9, {3.6856909140644207`*^9, 3.6856909161285*^9}, {
   3.6856955548132*^9, 3.685695556654903*^9}, {3.77962127899403*^9, 
   3.779621281340384*^9}},ExpressionUUID->"a26e7007-56fc-4489-b3ba-\
83810c05b931"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[717]:=",ExpressionUUID->"8d040ff4-f96a-456a-823d-e6502cfc9655"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidLabel"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised check label.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidTuple"}], "=", 
   "\"\<Reflections (and coordinates) must be on a {\!\(\*StyleBox[\"h\", \
\"TI\"]\), \!\(\*StyleBox[\"k\", \"TI\"]\), \!\(\*StyleBox[\"l\", \"TI\"]\)} \
(or {\!\(\*StyleBox[\"x\", \"TI\"]\), \!\(\*StyleBox[\"y\", \"TI\"]\), \
\!\(\*StyleBox[\"z\", \"TI\"]\)}) form\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SingleTupleExpected"}], "=", 
   "\"\<Only one `1` expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "IntegerExpected"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidInputType"}], "=", 
   "\"\<Head of indices must be either Integer, String or Symbol.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "MultipleTuplesExpected"}], "=", 
    "\"\<At least two reflections are required to make comparisons.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "EnergyUnitExpected"}], "=", 
   "\"\<Input does not have a unit compatible with energy or \
wavelength.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidEnergyInput"}], "=", 
   "\"\<Input must be an energy or wavelength compatible Quantity, or a \
number.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "EnergyMustBePositive"}], "=", 
    "\"\<The wavelength/energy must be positive.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidCrystalEntity"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid crystal entity.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "NotIn$CrystalData"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "NoWavelengthIncluded"}], "=", 
   "\"\<No wavelength was found for crystal \[LeftGuillemet]`1`\
\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidUserInput"}], "=", 
   "\"\<Invalid user input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "InvalidPolarisationSetting"}], "=", 
    "\"\<Invalid polarisation setting.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidPointOrSpaceGroup"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point- \
or space group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidPointGroup"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidSpaceGroup"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a space \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidSpaceGroupNumber"}], "=", 
   "\"\<Valid space group numbers are between 1 and 230.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidSpaceGroupInCrystal"}], "=", 
   "\"\<Crystal entry \[LeftGuillemet]`1`\[RightGuillemet] has invalid space \
group \[LeftGuillemet]`2`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "InvalidSymmetryObject"}], "=", 
    "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group, space group or a crystal.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidCentring"}], "=", 
   "\"\<Invalid space group centring.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementNumber"}], "=", 
   "\"\<Element number `1` is out of range.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementFailed"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a \
chemical element.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "ElementError"}], "=", 
    "\"\<The element \[LeftGuillemet]`1`\[RightGuillemet] cannot be \
interpreted.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidCrystalFamily"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid crystal family.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "InvalidDimension"}], "=", 
    "\"\<Dimension must be either \\\"2D\\\" or \\\"3D\\\".\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "DomainSizeError"}], "=", 
   "\"\<Discrepancy between given domain size and length.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidRotationPoint"}], "=", 
   "\"\<Invalid rotation point.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "InvalidRotationReference"}], "=", 
   "\"\<Reference for rotation anchor must either be \\\"Host\\\", \\\"Domain\
\\\", \\\"DomainCentroid\\\" or \\\"Unit\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "InvalidRotationMap"}], "=", 
    "\"\<Values of `1`D rotation maps must be `2`.\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "InputCheck"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "__", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6856820263060083`*^9, 3.6856820338793163`*^9}, {
   3.685682083417005*^9, 3.685682092894709*^9}, {3.6856840260308533`*^9, 
   3.685684026178547*^9}, {3.685686819102976*^9, 3.6856868408053513`*^9}, {
   3.685687011142066*^9, 3.685687017829006*^9}, {3.685687131249773*^9, 
   3.685687151398356*^9}, {3.685687183159276*^9, 3.6856871838215933`*^9}, {
   3.685687254295497*^9, 3.685687281286789*^9}, {3.685687660039452*^9, 
   3.6856877115995817`*^9}, {3.68568838863011*^9, 3.6856884381337767`*^9}, {
   3.685690949932845*^9, 3.6856909574232817`*^9}, {3.685691048596792*^9, 
   3.685691065258542*^9}, {3.685691555385049*^9, 3.685691595897393*^9}, {
   3.685693407917099*^9, 3.6856934105491962`*^9}, {3.685693449539488*^9, 
   3.685693464972211*^9}, {3.685693732995039*^9, 3.6856937393916893`*^9}, {
   3.685693867613049*^9, 3.685693870503192*^9}, {3.685694016861869*^9, 
   3.685694053583612*^9}, {3.685694415120605*^9, 3.685694415410471*^9}, {
   3.6856953860999413`*^9, 3.685695404607368*^9}, {3.68569555947088*^9, 
   3.685695605133265*^9}, {3.685696124318612*^9, 3.68569613828201*^9}, {
   3.685696178849712*^9, 3.685696180401723*^9}, {3.685696592780033*^9, 
   3.6856965970349083`*^9}, {3.6870711449669037`*^9, 3.687071165830688*^9}, {
   3.6870725649937353`*^9, 3.687072567422408*^9}, {3.711081329746539*^9, 
   3.711081335862384*^9}, {3.711083709642126*^9, 3.71108372803414*^9}, {
   3.712990896317184*^9, 3.712990899230811*^9}, {3.713603056038671*^9, 
   3.7136030717991047`*^9}, 3.713603337329356*^9, {3.7136034598308163`*^9, 
   3.713603470204297*^9}, {3.713604348937676*^9, 3.71360436129599*^9}, {
   3.717147714818186*^9, 3.717147739983534*^9}, {3.7171480835458517`*^9, 
   3.717148091231995*^9}, {3.726560324583314*^9, 3.7265603577752657`*^9}, {
   3.726853588279467*^9, 3.7268536391946774`*^9}, {3.7271789201847763`*^9, 
   3.727178947159677*^9}, {3.7275066313384666`*^9, 3.72750665317505*^9}, {
   3.727513894430643*^9, 3.727513902461985*^9}, {3.727596618528956*^9, 
   3.727596645209611*^9}, {3.727601483861143*^9, 3.7276014841869497`*^9}, {
   3.7276028953923073`*^9, 3.727602914012473*^9}, {3.728109699712471*^9, 
   3.728109743760724*^9}, {3.728765837392223*^9, 3.728765846807078*^9}, {
   3.7340775949863367`*^9, 3.734077598710491*^9}, {3.7372791075805187`*^9, 
   3.73727914741197*^9}, {3.7372792368998547`*^9, 3.737279256825714*^9}, {
   3.737285569781273*^9, 3.737285603410686*^9}, {3.739187854951786*^9, 
   3.73918785517507*^9}, {3.742016334042914*^9, 3.742016337494812*^9}, {
   3.742016368507223*^9, 3.74201638931714*^9}, {3.7567126007785892`*^9, 
   3.756712616867313*^9}, 3.75671264844755*^9, {3.756712756093667*^9, 
   3.756712764043981*^9}, {3.75671279769972*^9, 3.756712815035034*^9}, {
   3.756713298279908*^9, 3.7567132995556707`*^9}, {3.7791347576669817`*^9, 
   3.779134757825488*^9}, {3.7796213397964487`*^9, 3.7796213411942797`*^9}, {
   3.781861177096654*^9, 3.7818611798947363`*^9}, {3.7818638659283743`*^9, 
   3.78186388273141*^9}, {3.781864125333624*^9, 3.781864154780567*^9}, {
   3.7818642056977167`*^9, 3.781864219490481*^9}, {3.781865551234782*^9, 
   3.781865576031451*^9}, {3.7818656537778378`*^9, 3.781865662184041*^9}, {
   3.781866087341042*^9, 3.781866138388178*^9}, {3.781957515808682*^9, 
   3.781957520990094*^9}, {3.782030887076083*^9, 3.782030887369808*^9}, 
   3.7869545931030684`*^9, 3.7869549247582397`*^9, 3.786955007868844*^9, {
   3.786955074079344*^9, 3.786955101762665*^9}, {3.786955133945662*^9, 
   3.786955161089117*^9}, {3.786955399308937*^9, 3.786955428954468*^9}, {
   3.786955463442379*^9, 3.786955510679736*^9}, {3.786955562839375*^9, 
   3.786955606909911*^9}, 3.786955656525093*^9, {3.786955720347637*^9, 
   3.786955755177781*^9}, {3.786956142290414*^9, 3.786956147840975*^9}, {
   3.7869562148642387`*^9, 3.786956220863571*^9}, {3.7869562601435432`*^9, 
   3.7869562665982647`*^9}, {3.7869563064305763`*^9, 3.786956311021562*^9}, {
   3.786956360525083*^9, 3.786956367533533*^9}, {3.808029109531475*^9, 
   3.80802913181882*^9}},
 CellLabel->
  "In[718]:=",ExpressionUUID->"12339070-6b6d-47ba-9792-4624b8624d60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[749]:=",ExpressionUUID->"06378c21-bc9e-4d0d-af64-2f372bd701d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_List", ",", 
    RowBox[{"labels___", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SubsetQ", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", ",", 
           "\"\<Multiple\>\"", ",", "\"\<StringSymbol\>\"", ",", 
           "\"\<WrapSingle\>\""}], "}"}], ",", 
         RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ")"}]}]}], 
   "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"check", ",", "hkl", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"check", "=", 
      RowBox[{"{", "labels", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
         "check", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", 
               ",", "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
               "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], 
             ",", "temp"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"InputCheck", "::", "InvalidLabel"}], ",", "temp"}], 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dimensions", " ", "check", " ", 
       RowBox[{"(", 
        RowBox[{"always", " ", "required"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Single", " ", 
        RowBox[{"reflection", "/", "coordinate"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"input", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
            "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"hkl", "=", 
        RowBox[{"{", "input", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Multiple", " ", 
         RowBox[{"reflections", "/", "coordinates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
             RowBox[{"!", 
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
               "]"}]}]}]}], "]"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{"hkl", "=", "input"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "InvalidTuple"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", 
       RowBox[{"reflection", "/", "coordinates"}], " ", "check"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1hkl\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "SingleTupleExpected"}], ",", 
            "\"\<reflection\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1xyz\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "SingleTupleExpected"}], ",", 
            "\"\<coordinate\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Multiple", " ", "reflections", " ", "check"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Multiple\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "<", "2"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "MultipleTuplesExpected"}], "]"}], ";",
           "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Integer", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Integer\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "hkl"}], ",", "IntegerQ"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "IntegerExpected"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "if", " ", "Integer"}], ",", " ", 
       RowBox[{"String", " ", "or", " ", "Symbol"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<StringSymbol\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ContainsAll", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Integer", ",", "String", ",", "Symbol", ",", "Times"}], 
             "}"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Head", "/@", 
             RowBox[{"Flatten", "@", "hkl"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "InvalidInputType"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wrap", " ", "single", " ", "reflections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<WrapSingle\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "input", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Return", "[", "input", "]"}]}], "\[IndentingNewLine]", "\t",
         "]"}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.687070782983131*^9, 3.687070826316058*^9}, {
   3.711080493388452*^9, 3.711080530269607*^9}, {3.7110838434149733`*^9, 
   3.711083844960722*^9}, {3.712990600076755*^9, 3.712990608318782*^9}, {
   3.712990804480831*^9, 3.7129908060016212`*^9}, {3.712990947248521*^9, 
   3.712990947808515*^9}, {3.713510243799721*^9, 3.7135102514986553`*^9}, {
   3.713510288538774*^9, 3.713510293259116*^9}, {3.7135103372502947`*^9, 
   3.713510338184915*^9}, {3.71431192571665*^9, 3.7143119392365303`*^9}, {
   3.7143120972494097`*^9, 3.714312097447524*^9}, {3.7143121915742683`*^9, 
   3.7143122110300217`*^9}, {3.714312273573138*^9, 3.714312308114839*^9}, {
   3.71445784032449*^9, 3.714457847602706*^9}, 3.714458049967931*^9, {
   3.7147109057397537`*^9, 3.714710909787726*^9}, {3.714710945019298*^9, 
   3.714710963965468*^9}, {3.717143871479184*^9, 3.717143873754469*^9}, {
   3.717146708601173*^9, 3.717146713501816*^9}, {3.717147467353772*^9, 
   3.717147472518999*^9}, {3.717147554646175*^9, 3.717147555923188*^9}, {
   3.717147595628448*^9, 3.717147596128397*^9}, 3.7171476872925243`*^9, {
   3.717147790297018*^9, 3.7171478112554407`*^9}, {3.7171480444680862`*^9, 
   3.717148048818454*^9}, {3.7171482182403383`*^9, 3.7171482183828487`*^9}, {
   3.717148818843635*^9, 3.717148834361803*^9}, {3.7171489319542913`*^9, 
   3.717148951600135*^9}, {3.717149178012879*^9, 3.71714919115486*^9}, {
   3.717149260050128*^9, 3.717149280072538*^9}, {3.717149333315688*^9, 
   3.717149397350493*^9}, {3.717149552908246*^9, 3.7171495813302383`*^9}, {
   3.718521630559267*^9, 3.718521641789692*^9}, {3.7185216726962433`*^9, 
   3.7185216733580647`*^9}, {3.718636471385057*^9, 3.7186364749898767`*^9}, {
   3.7186366347963343`*^9, 3.718636636271434*^9}, {3.7259581138852463`*^9, 
   3.725958115603722*^9}, {3.7372783098194*^9, 3.737278316869255*^9}, 
   3.737371806626379*^9, 3.737384013131838*^9, {3.7373840435457*^9, 
   3.7373840851194687`*^9}, {3.737384137351205*^9, 3.73738418240597*^9}, {
   3.7373842155798798`*^9, 3.737384232171645*^9}, {3.737384415256804*^9, 
   3.737384433510865*^9}, {3.75852996982882*^9, 3.758529971762226*^9}, 
   3.7627930936957808`*^9, {3.786954584256233*^9, 3.786954589718793*^9}, {
   3.786954913336426*^9, 3.786954919895287*^9}, {3.78695501065422*^9, 
   3.7869550144384604`*^9}, {3.786955074082953*^9, 3.786955090281755*^9}, {
   3.7869551207236137`*^9, 3.786955157090266*^9}, {3.786961588352356*^9, 
   3.7869615908880243`*^9}, {3.786961866658291*^9, 3.786961876697589*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[750]:=",ExpressionUUID->"240f0fac-1c34-413b-8694-abceef82f9b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<CrystalEntityQ\>\"", ",", "input_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"input", "===", "\"\<Void\>\""}], ",", 
      RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "$PeriodicTable"}], ",", "input"}], "]"}], ",", 
      RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "$CrystalData"}], ",", "input"}], "]"}], ",", 
      RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"InputCheck", "::", "InvalidCrystalEntity"}], ",", "input"}], 
     "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.808028800134062*^9, 3.8080288107230253`*^9}, {
  3.808028877698202*^9, 3.8080289067839737`*^9}, {3.808028959926174*^9, 
  3.808029073819161*^9}, {3.8080291380469627`*^9, 3.8080291414093447`*^9}, {
  3.808029233032518*^9, 3.808029234822619*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[751]:=",ExpressionUUID->"2d098b1d-1c2c-4d0d-a597-fba43ec40962"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<CrystalQ\>\"", ",", "input_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "entry", " ", "exists", " ", 
     RowBox[{"in", " ", "'"}], 
     RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MissingQ", "@", 
      RowBox[{"$CrystalData", "[", "input", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "NotIn$CrystalData"}], ",", "input"}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.7276035463522577`*^9, 
   3.72760354706783*^9}, {3.74556825639723*^9, 3.7455682923534517`*^9}, {
   3.745568690840042*^9, 3.745568699006835*^9}, 3.7820474980874853`*^9, {
   3.7869555468961906`*^9, 3.786955551854266*^9}, {3.7869616322927837`*^9, 
   3.7869616350531397`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[752]:=",ExpressionUUID->"c99eba25-1a28-4e97-a48c-1d15d35b1e1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<FilterSpecialLabels\>\"", ",", "input_List"}], "]"}], ":=", 
  RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "\"\<Void\>\"", "}"}], ",", 
      RowBox[{"Keys", "@", "$PeriodicTable"}]}], "]"}], ",", "input"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.808022780866338*^9, 3.8080228377542763`*^9}, {
  3.808024138359148*^9, 3.80802415587668*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[753]:=",ExpressionUUID->"5e288eee-940f-4f30-988b-b40c92a7c3ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<GenerateTargetPositions\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"X_", ",", "Y_", ",", "Z_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0.", ",", 
        RowBox[{
         RowBox[{"N", "@", "X"}], "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0.", ",", 
        RowBox[{
         RowBox[{"N", "@", "Y"}], "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0.", ",", 
        RowBox[{
         RowBox[{"N", "@", "Z"}], "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.807790128332697*^9, 3.807790184936688*^9}, 
   3.8077902350810347`*^9, {3.807790295789818*^9, 3.807790316944312*^9}, {
   3.807795616231709*^9, 3.807795621918097*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[754]:=",ExpressionUUID->"9e3b7ad9-3861-4f3f-b9d6-e4d375fe2e18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<GetCentringVectors\>\"", ",", "centring_String"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"group", ",", "vectors"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringLength", "@", "centring"}], "=!=", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"group", "=", 
         RowBox[{"InputCheck", "[", 
          RowBox[{"\"\<GetPointSpaceGroupCrystal\>\"", ",", "centring"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "@", 
         RowBox[{"InputCheck", "[", 
          RowBox[{"\"\<GetCentringVectors\>\"", ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{"group", ",", "1"}], "]"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"centring", "===", "\"\<P\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<F\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<I\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<R\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<A\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<B\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "0", ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<C\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<H\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "InvalidCentring"}], "]"}], ";", 
        RowBox[{"vectors", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"vectors", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}, {
   3.734077376632456*^9, 3.734077480964463*^9}, {3.734412586131454*^9, 
   3.7344125991220827`*^9}, 3.762793093706504*^9, 3.786956374957906*^9, {
   3.786961889887927*^9, 3.7869618920559807`*^9}, {3.830430267827496*^9, 
   3.83043033462963*^9}, {3.830430414711422*^9, 3.8304304286191807`*^9}, {
   3.830430805405685*^9, 3.830430841705861*^9}, {3.830433620836817*^9, 
   3.830433639225922*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[821]:=",ExpressionUUID->"815767a5-cd86-49be-90ad-9b56bee85a05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{
   "\"\<GetCrystalFamilyMetric\>\"", ",", "family_", ",", "dimension_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "M", ",", "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
      "\[Gamma]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Cubic\>\"", ",", "\"\<Hexagonal\>\"", ",", 
            "\"\<Tetragonal\>\"", ",", "\"\<Orthorhombic\>\"", ",", 
            "\"\<Monoclinic\>\"", ",", "\"\<Triclinic\>\""}], "}"}], ",", 
          "\[IndentingNewLine]", "family"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "InvalidCrystalFamily"}], ",", 
          "family"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<2D\>\"", ",", "\"\<3D\>\""}], "}"}], ",", 
          "dimension"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "InvalidDimension"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Metric", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"b", " ", 
           RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], ",", 
          RowBox[{"c", " ", 
           RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], ",", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Gamma]", "]"}]}]}], ")"}], " ", 
           RowBox[{"Csc", "[", "\[Gamma]", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"c", " ", "*", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Beta]", "]"}], "2"], "-", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cos", "[", "\[Alpha]", "]"}], "-", 
                 RowBox[{
                  RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
                  RowBox[{"Cos", "[", "\[Gamma]", "]"}]}]}], ")"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"Csc", "[", "\[Gamma]", "]"}], "2"]}]}], "]"}]}]}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"M", "=", 
      RowBox[{"N", "[", 
       RowBox[{"M", "/.", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"family", "===", "\"\<Cubic\>\""}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "1."}], ",", 
            RowBox[{"b", "\[Rule]", "1."}], ",", 
            RowBox[{"c", "\[Rule]", "1."}], ",", "\[IndentingNewLine]", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Gamma]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}]}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"family", "===", "\"\<Hexagonal\>\""}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "1."}], ",", 
            RowBox[{"b", "\[Rule]", "1."}], ",", 
            RowBox[{"c", "\[Rule]", "1."}], ",", "\[IndentingNewLine]", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Gamma]", "\[Rule]", 
             RowBox[{"120", "\[Degree]"}]}]}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"family", "===", "\"\<Tetragonal\>\""}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "1."}], ",", 
            RowBox[{"b", "\[Rule]", "1."}], ",", 
            RowBox[{"c", "\[Rule]", "1.61803"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Gamma]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}]}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"family", "===", "\"\<Orthorhombic\>\""}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "1.7"}], ",", 
            RowBox[{"b", "\[Rule]", "1.2"}], ",", 
            RowBox[{"c", "\[Rule]", "0.85"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Gamma]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}]}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"family", "===", "\"\<Monoclinic\>\""}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "1."}], ",", 
            RowBox[{"b", "\[Rule]", "0.7"}], ",", 
            RowBox[{"c", "\[Rule]", "1.2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", 
             RowBox[{"72.", "\[Degree]"}]}], ",", 
            RowBox[{"\[Gamma]", "\[Rule]", 
             RowBox[{"90", "\[Degree]"}]}]}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"family", "===", "\"\<Triclinic\>\""}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "1.3"}], ",", 
            RowBox[{"b", "\[Rule]", "0.8"}], ",", 
            RowBox[{"c", "\[Rule]", "0.9"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"66.", "\[Degree]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", 
             RowBox[{"77.", "\[Degree]"}]}], ",", 
            RowBox[{"\[Gamma]", "\[Rule]", 
             RowBox[{"88.", "\[Degree]"}]}]}], "\[IndentingNewLine]", "}"}]}],
          "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dimension", "===", "\"\<2D\>\""}], ",", 
       RowBox[{"M", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], ",", 
       "M"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.687070782983131*^9, 3.687070826316058*^9}, {
   3.711080493388452*^9, 3.711080530269607*^9}, {3.7110838434149733`*^9, 
   3.711083844960722*^9}, {3.712990600076755*^9, 3.712990608318782*^9}, {
   3.712990804480831*^9, 3.7129908060016212`*^9}, {3.712990947248521*^9, 
   3.712990947808515*^9}, {3.713510243799721*^9, 3.7135102514986553`*^9}, {
   3.713510288538774*^9, 3.713510293259116*^9}, {3.7135103372502947`*^9, 
   3.713510338184915*^9}, {3.71431192571665*^9, 3.7143119392365303`*^9}, {
   3.7143120972494097`*^9, 3.714312097447524*^9}, {3.7143121915742683`*^9, 
   3.7143122110300217`*^9}, {3.714312273573138*^9, 3.714312308114839*^9}, {
   3.71445784032449*^9, 3.714457847602706*^9}, 3.714458049967931*^9, {
   3.7147109057397537`*^9, 3.714710909787726*^9}, {3.714710945019298*^9, 
   3.714710963965468*^9}, {3.717143871479184*^9, 3.717143873754469*^9}, {
   3.717146708601173*^9, 3.717146713501816*^9}, {3.717147467353772*^9, 
   3.717147472518999*^9}, {3.717147554646175*^9, 3.717147555923188*^9}, {
   3.717147595628448*^9, 3.717147596128397*^9}, 3.7171476872925243`*^9, {
   3.717147790297018*^9, 3.7171478112554407`*^9}, {3.7171480444680862`*^9, 
   3.717148048818454*^9}, {3.7171482182403383`*^9, 3.7171482183828487`*^9}, {
   3.717148818843635*^9, 3.717148834361803*^9}, {3.7171489319542913`*^9, 
   3.717148951600135*^9}, {3.717149178012879*^9, 3.71714919115486*^9}, {
   3.717149260050128*^9, 3.717149280072538*^9}, {3.717149333315688*^9, 
   3.717149397350493*^9}, {3.717149552908246*^9, 3.7171495813302383`*^9}, {
   3.718521630559267*^9, 3.718521641789692*^9}, {3.7185216726962433`*^9, 
   3.7185216733580647`*^9}, {3.718636471385057*^9, 3.7186364749898767`*^9}, {
   3.7186366347963343`*^9, 3.718636636271434*^9}, {3.7259581138852463`*^9, 
   3.725958115603722*^9}, {3.7372783098194*^9, 3.737278316869255*^9}, 
   3.737371806626379*^9, 3.737384013131838*^9, {3.7373840435457*^9, 
   3.7373840851194687`*^9}, {3.737384137351205*^9, 3.73738418240597*^9}, {
   3.7373842155798798`*^9, 3.737384232171645*^9}, {3.737384415256804*^9, 
   3.737384433510865*^9}, {3.75852996982882*^9, 3.758529971762226*^9}, 
   3.7627930936957808`*^9, 3.779621383606275*^9, {3.779623655366046*^9, 
   3.7796236628541946`*^9}, {3.7796237819756413`*^9, 3.7796238196668234`*^9}},
 
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[756]:=",ExpressionUUID->"341f1e6a-cb61-4a48-9864-0f6230eca215"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<GetCrystalFormulaUnits\>\"", ",", "input_String"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "input"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
       "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
         "\"\<FormulaUnits\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"input", ",", "\"\<FormulaUnits\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "not"}], ",", " ", 
         RowBox[{"query", " ", "user", " ", "manually"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"InputString", "[", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Cannot determine the number of formula units \>\"", "<>", 
           "\[IndentingNewLine]", "\"\<for \[LeftGuillemet]\>\"", "<>", 
           "input", "<>", "\"\<\[RightGuillemet].\>\"", "<>", "\"\<\\n\>\"", "<>",
            "\[IndentingNewLine]", 
           "\"\<Please enter that number or the density below.\>\""}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "output"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "InvalidUserInput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "output"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.727178717966507*^9, 
   3.727178721188702*^9}, {3.727178758964155*^9, 3.727178761323883*^9}, {
   3.727178860595625*^9, 3.727178901192408*^9}, {3.727178964913246*^9, 
   3.727178966567266*^9}, {3.727601687423465*^9, 3.727601704808043*^9}, {
   3.727601744534422*^9, 3.727601771061698*^9}, {3.727602475651042*^9, 
   3.727602607286476*^9}, {3.7276026482929697`*^9, 3.727602649418606*^9}, {
   3.727602816432906*^9, 3.727602879307555*^9}, {3.7276029234914637`*^9, 
   3.727602926124346*^9}, {3.727603730383863*^9, 3.72760373066368*^9}, {
   3.727603973849247*^9, 3.7276039750255003`*^9}, {3.738049785054161*^9, 
   3.7380497898471613`*^9}, 3.762793093715082*^9, {3.786955599831296*^9, 
   3.78695560341047*^9}, {3.7869620256301737`*^9, 3.786962027653013*^9}, {
   3.7869680814899187`*^9, 3.786968082808133*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[757]:=",ExpressionUUID->"53366e63-f7c5-4eb1-bf5b-d2edbccd440b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<GetCrystalSpaceGroup\>\"", ",", "input_String"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "input"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "is", " ", "valid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "InvalidSpaceGroupInCrystal"}], ",", 
          "input", ",", "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.727506566988821*^9, 
   3.7275065675308313`*^9}, {3.7276035560711937`*^9, 3.72760355630114*^9}, {
   3.7276036304674597`*^9, 3.727603631524433*^9}, 3.727676784104806*^9, {
   3.7340864321506767`*^9, 3.7340865206369267`*^9}, 3.743865456049979*^9, 
   3.762793093722595*^9, 3.786956274496245*^9, {3.786962061484593*^9, 
   3.786962063155972*^9}, {3.786968086928224*^9, 3.786968088255666*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[758]:=",ExpressionUUID->"7d18bb11-07b6-427b-807e-6acd176385fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<GetCrystalWavelength\>\"", ",", "input_String", ",", 
    RowBox[{"abortQ_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InputCheck", "[", 
     RowBox[{"\"\<CrystalQ\>\"", ",", "input"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
      "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
        "\"\<Wavelength\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "@", 
       RowBox[{"$CrystalData", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"input", ",", "\"\<Wavelength\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", " ", "not"}], ",", " ", 
        RowBox[{
         RowBox[{"abort", " ", "OR", " ", 
          RowBox[{"return", " ", "'"}]}], "-", 
         RowBox[{"1", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"abortQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InputCheck", "::", "NoWavelengthIncluded"}], ",", 
           "input"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}],
    ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.739125707135515*^9, 3.7391257657796993`*^9}, 
   3.786955585359413*^9, {3.786962080980385*^9, 3.78696208273151*^9}, {
   3.786968091320426*^9, 3.786968092871867*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[759]:=",ExpressionUUID->"d1af9d99-a7b4-4ac8-b525-f714105fdc7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Converts", " ", "to", " ", 
    RowBox[{"wavelength", " ", "[", "\[ARing]ngstr\[ODoubleDot]ms", "]"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"InputCheck", "[", 
    RowBox[{"\"\<GetEnergyWavelength\>\"", ",", "input_", ",", 
     RowBox[{"unitsQ_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hcKeV", "=", "12.398420"}], ",", "\[Lambda]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Only", " ", "exception"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"input", "===", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "if", " ", "positive"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"Positive", "@", "input"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "EnergyMustBePositive"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"A", ".", " ", "Number"}], " ", "input"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NumericQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"1.", " ", "Assume", " ", "\[ARing]ngstr\[ODoubleDot]ms"}], 
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"input", " ", "\[LessEqual]", " ", "5.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"N", "@", "input"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"2.", " ", "Assume", " ", "kilo", " ", "electronvolt"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"input", " ", "\[LessEqual]", " ", "250.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", "input"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"3.", " ", "Assume", " ", "electronvolts"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"1000", "*", 
            RowBox[{"hcKeV", "/", "input"}]}]}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Quantity"}], " ", "input"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"QuantityQ", "[", "input", "]"}], " ", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Convert", " ", "wavelength", " ", "or", " ", "energy", " ", "to", 
          " ", "\[ARing]ngstr\[ODoubleDot]ms"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"UnitDimensions", "[", "input", "]"}], "===", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\"\<LengthUnit\>\"", ",", "1"}], "}"}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"\[Lambda]", "=", 
            RowBox[{"UnitConvert", "[", 
             RowBox[{"input", ",", "\"\<Angstroms\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"unitsQ", ",", 
             RowBox[{"Return", "@", "\[Lambda]"}], ",", 
             RowBox[{"Return", "@", 
              RowBox[{"QuantityMagnitude", "@", "\[Lambda]"}]}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"CompatibleUnitQ", "[", 
           RowBox[{"input", ",", "\"\<Joules\>\""}], "]"}], ",", "\t\t", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", 
            RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"UnitConvert", "[", 
              RowBox[{"input", ",", "\"\<Kiloelectronvols\>\""}], "]"}]}]}]}],
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"InputCheck", "::", "EnergyUnitExpected"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"C", ".", " ", "None"}], " ", "of", " ", "the", " ", 
          "above"}], " ", "*)"}], "\[IndentingNewLine]", "True", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "InvalidEnergyInput"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Set", " ", "in", " ", "Quantity", " ", "if", " ", "desired"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"unitsQ", ",", "\[IndentingNewLine]", 
        RowBox[{"Quantity", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Angstroms\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\[Lambda]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.726560443424157*^9, 
   3.726560447064084*^9}, 3.72685205362494*^9, {3.7268524061436033`*^9, 
   3.7268525118996563`*^9}, {3.726853451219391*^9, 3.726853553519404*^9}, {
   3.72685364594137*^9, 3.726853659220982*^9}, {3.726853721494712*^9, 
   3.7268537360194597`*^9}, {3.726853814139167*^9, 3.726853866046702*^9}, {
   3.72685391283145*^9, 3.726854013342908*^9}, {3.72685443464507*^9, 
   3.726854444243165*^9}, {3.726854740941407*^9, 3.726854744623098*^9}, {
   3.726854833074029*^9, 3.726854873935768*^9}, {3.72685491084039*^9, 
   3.726854918136497*^9}, {3.72685498979923*^9, 3.726855068318531*^9}, {
   3.726855109331604*^9, 3.726855122067479*^9}, {3.7268555301237164`*^9, 
   3.726855539752921*^9}, {3.7268559339858027`*^9, 3.726855959866241*^9}, {
   3.7268559904322023`*^9, 3.72685603510135*^9}, {3.72685615357065*^9, 
   3.72685615402689*^9}, {3.726856216650893*^9, 3.726856369277254*^9}, {
   3.7268564800835943`*^9, 3.7268564992580137`*^9}, {3.726856620967496*^9, 
   3.726856621815027*^9}, {3.726856668775392*^9, 3.726856720204636*^9}, {
   3.7268568209881*^9, 3.72685684971353*^9}, {3.72685688102668*^9, 
   3.7268569498483753`*^9}, {3.7268570554316273`*^9, 3.726857141124441*^9}, {
   3.72685733536134*^9, 3.726857445821105*^9}, {3.7268574798936377`*^9, 
   3.726857484116231*^9}, {3.726857520876247*^9, 3.726857597705496*^9}, {
   3.7268576490821247`*^9, 3.726857665286269*^9}, {3.726896856919681*^9, 
   3.726896865360489*^9}, {3.726897043655274*^9, 3.72689706577814*^9}, {
   3.726899351343816*^9, 3.726899381328332*^9}, 3.7268997978240433`*^9, {
   3.7275466850188923`*^9, 3.727546685984756*^9}, {3.727596442016464*^9, 
   3.727596443184536*^9}, {3.7275965437672157`*^9, 3.727596576954631*^9}, 
   3.727596651111322*^9, {3.72760374260155*^9, 3.727603759529471*^9}, {
   3.728109774970121*^9, 3.728109880586781*^9}, 3.73441267980902*^9, {
   3.738049815649427*^9, 3.738049826421247*^9}, {3.7391251770910673`*^9, 
   3.739125211688257*^9}, {3.7391256829934187`*^9, 3.739125689976153*^9}, 
   3.762793093738366*^9, 3.786955436572969*^9, 3.786955487113967*^9, {
   3.786955519104815*^9, 3.786955525904479*^9}, {3.78696212378834*^9, 
   3.786962125563382*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[760]:=",ExpressionUUID->"3bf9aa4a-6fc2-47a4-aa22-2b8b39fa6ec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<GetPointSpaceGroupCrystal\>\"", ",", "input_"}], "]"}], ":=", 
  
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"$CrystalDataCombined", ",", "sg"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "space", " ", "group", " ", "number", " ", "is",
       " ", "given"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "input", "\[LessEqual]", "230"}], ")"}],
         "&&", 
        RowBox[{"IntegerQ", "@", "input"}]}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
         RowBox[{"input", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
         "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "If", " ", "actual", " ", "input", " ", "is", " ", "a", " ", 
         "point"}], "-", " ", 
        RowBox[{"or", " ", "space", " ", "group"}]}], ",", " ", 
       RowBox[{"return", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}], ",", 
       RowBox[{"Return", "@", "input"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "MaXrd`Private`$TempCrystalData"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"$CrystalData", ",", "MaXrd`Private`$TempCrystalData"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalDataCombined", "=", "$CrystalData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "@", 
        RowBox[{"$CrystalDataCombined", "[", "input", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "InvalidSymmetryObject"}], ",", 
          "input"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "exists"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalDataCombined", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "InvalidSpaceGroupInCrystal"}], ",", 
          "input", ",", "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.72750620550637*^9, 
   3.727506277082754*^9}, 3.7275065790218277`*^9, 3.72750668943563*^9, {
   3.7275138768842697`*^9, 3.727513877580575*^9}, {3.7276037003393583`*^9, 
   3.7276037005968237`*^9}, {3.727603930848737*^9, 3.727603935750414*^9}, {
   3.734086562493793*^9, 3.734086592174155*^9}, {3.734087081953874*^9, 
   3.734087111656989*^9}, {3.743865456115304*^9, 3.743865456153502*^9}, {
   3.758529973221416*^9, 3.7585299759035673`*^9}, {3.7614238939583063`*^9, 
   3.7614239274759207`*^9}, {3.76142400648403*^9, 3.7614240067298727`*^9}, {
   3.7614240390817547`*^9, 3.7614241404093447`*^9}, {3.7614242479891987`*^9, 
   3.7614242705338163`*^9}, {3.761424370948794*^9, 3.761424372186491*^9}, 
   3.762793093748088*^9, 3.786956278800035*^9, 3.786956318206355*^9, {
   3.786962166771103*^9, 3.7869621682259617`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[761]:=",ExpressionUUID->"09dad2a0-5e95-487a-a21a-bf4537050eb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{
   "\"\<GetReciprocalImageOrientation\>\"", ",", "\[IndentingNewLine]", 
    "latticeInput_", ",", "hklPlane_", ",", "indexLimit_", ",", 
    RowBox[{"{", 
     RowBox[{"width_", ",", "height_"}], "}"}], ",", "directSpaceQ_"}], 
   "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hkl", "=", "hklPlane"}], ",", "\[IndentingNewLine]", 
      "abscissaIndex", ",", "ordinateIndex", ",", "planeConstant", ",", 
      "planeIndex", ",", "\[IndentingNewLine]", 
      RowBox[{"bottomLeft", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], ",", 
      RowBox[{"bottomRight", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], ",", 
      RowBox[{"topRight", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ",", 
      RowBox[{"topLeft", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
      "M", ",", "\[Xi]", ",", "imageOrientation"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "hkl"}], ",", 
       RowBox[{"hkl", "=", 
        RowBox[{"MillerNotationToList", "@", "hkl"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"abscissaIndex", ",", "ordinateIndex", ",", "planeConstant"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", "#2", ",", 
          RowBox[{
          "hkl", "\[LeftDoubleBracket]", "#3", "\[RightDoubleBracket]"}]}], 
         "}"}], "&"}], "@@", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"hkl", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<h\>\"", ",", "\"\<k\>\"", ",", "\"\<l\>\"", ",", "_Integer"}], 
          "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"planeIndex", "=", 
      RowBox[{"First", "@", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "@", "3"}], ",", 
         RowBox[{"{", 
          RowBox[{"abscissaIndex", ",", "ordinateIndex"}], "}"}]}], "]"}]}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", "directSpaceQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Direct"}], " ", "space", " ", "vectors", " ", 
         RowBox[{"(", "uvw", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{"GetCrystalMetric", "[", 
          RowBox[{"latticeInput", ",", 
           RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"2", "*", 
          RowBox[{"indexLimit", "/", 
           RowBox[{"Max", "@", "M"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"abscissaIndex", ",", "ordinateIndex"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"abscissaIndex", ",", "ordinateIndex"}], "}"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"imageOrientation", "=", 
         RowBox[{"\[Xi]", "*", 
          RowBox[{"{", 
           RowBox[{"bottomRight", ",", "topLeft", ",", "topRight"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"imageOrientation", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", ".", "M"}], "&"}], "/@", "imageOrientation"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imageOrientation", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Insert", "[", 
            RowBox[{"#", ",", 
             RowBox[{"N", "@", "planeConstant"}], ",", "planeIndex"}], "]"}], 
           "&"}], "/@", "imageOrientation"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"imageOrientation", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@@", 
          RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"imageOrientation", ",", 
             RowBox[{"{", 
              RowBox[{"width", ",", "height", ",", "1"}], "}"}]}], "}"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"imageOrientation", ",", 
          RowBox[{"imageOrientation", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Corners"}], " ", "in", " ", "reciprocal", 
         " ", "space"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"imageOrientation", "=", 
         RowBox[{"indexLimit", "*", 
          RowBox[{"{", 
           RowBox[{"bottomLeft", ",", "bottomRight", ",", "topLeft"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"imageOrientation", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"N", "@", 
            RowBox[{"Insert", "[", 
             RowBox[{"#", ",", "planeConstant", ",", "planeIndex"}], "]"}]}], 
           "&"}], "/@", "imageOrientation"}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"imageOrientation", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"MapAt", "[", 
         RowBox[{"#", ",", "imageOrientation", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"abscissaIndex", ",", "ordinateIndex"}], "}"}]}], 
           "}"}]}], "]"}], "&"}], "[", 
       RowBox[{
        RowBox[{"DecimalForm", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"7", ",", "4"}], "}"}], ",", 
          RowBox[{"NumberPadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\< \>\"", ",", "\"\<0\>\""}], "}"}]}]}], "]"}], "&"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"imageOrientation", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"ToString", ",", "imageOrientation", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"imageOrientation", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringRiffle", "[", 
         RowBox[{"#", ",", "\"\<,  \>\""}], "]"}], "&"}], "/@", 
       "imageOrientation"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.760948481143589*^9, 3.760948499262701*^9}, {
   3.7609488207683067`*^9, 3.760948841778069*^9}, {3.760948882588552*^9, 
   3.760948883842764*^9}, {3.760948940717063*^9, 3.760948975282666*^9}, {
   3.760949011970159*^9, 3.760949012184416*^9}, 3.760949083736237*^9, {
   3.760949130238394*^9, 3.76094916161519*^9}, 3.760985557982565*^9, {
   3.7611975087352133`*^9, 3.76119751660457*^9}, {3.761474171084214*^9, 
   3.761474174768375*^9}, {3.761474414190099*^9, 3.761474436739811*^9}, {
   3.761474489155945*^9, 3.761474515473364*^9}, {3.761474549322021*^9, 
   3.761474603151936*^9}, {3.761474729429777*^9, 3.761474784036825*^9}, {
   3.761474849276947*^9, 3.7614748512846203`*^9}, 3.7614749412429934`*^9, {
   3.761475075055262*^9, 3.761475111589944*^9}, {3.761475177678194*^9, 
   3.761475208235873*^9}, {3.7614754099022007`*^9, 3.761475460275897*^9}, {
   3.7614755580354347`*^9, 3.7614755584485207`*^9}, {3.761475602255143*^9, 
   3.761475618458747*^9}, {3.761475728303033*^9, 3.7614757291959743`*^9}, {
   3.761475895540306*^9, 3.761475953150948*^9}, {3.7614759877525053`*^9, 
   3.7614760216772137`*^9}, {3.761476346852703*^9, 3.761476436475614*^9}, {
   3.761476501004677*^9, 3.7614765014024887`*^9}, {3.76147653684481*^9, 
   3.7614765625145817`*^9}, {3.7614766027780857`*^9, 3.761476696389943*^9}, {
   3.761476781958541*^9, 3.761476847138636*^9}, {3.761476879235957*^9, 
   3.761476898257463*^9}, {3.7614769388987217`*^9, 3.761476939672125*^9}, {
   3.7617280288811703`*^9, 3.7617280290289*^9}, {3.762062000358593*^9, 
   3.762062002890757*^9}, 3.7622515661086082`*^9, {3.762251817102137*^9, 
   3.762251929165433*^9}, {3.762252005452671*^9, 3.762252005611527*^9}, {
   3.762252046930657*^9, 3.7622520653518887`*^9}, {3.7622521337322073`*^9, 
   3.762252160781577*^9}, {3.762252243669989*^9, 3.762252252382333*^9}, {
   3.7622522870584927`*^9, 3.7622523110998173`*^9}, {3.7622525892905617`*^9, 
   3.762252653190784*^9}, {3.762252687617072*^9, 3.76225268868604*^9}, 
   3.762252720098925*^9, {3.7622602134972677`*^9, 3.762260245781844*^9}, {
   3.7622603606728363`*^9, 3.7622603955795927`*^9}, 3.762260809124468*^9, {
   3.762260920835347*^9, 3.7622609336590014`*^9}, {3.7622611020859957`*^9, 
   3.7622611022128*^9}, {3.762265433988163*^9, 3.762265647951427*^9}, {
   3.762265682974736*^9, 3.762265714676045*^9}, {3.7622657998190107`*^9, 
   3.762265823490719*^9}, {3.762266150777772*^9, 3.762266183714326*^9}, {
   3.762266297442079*^9, 3.762266404084507*^9}, {3.762266503346043*^9, 
   3.7622665058192873`*^9}, {3.762266581522806*^9, 3.762266603588318*^9}, {
   3.762266694495263*^9, 3.762266728238165*^9}, {3.762266789430751*^9, 
   3.76226681293922*^9}, {3.7622668497813883`*^9, 3.762266850066354*^9}, {
   3.762267098742383*^9, 3.762267102028309*^9}, {3.762267643315309*^9, 
   3.7622677082670116`*^9}, {3.762267743017583*^9, 3.762267788543005*^9}, {
   3.7622678343978357`*^9, 3.762267872315877*^9}, {3.762267908117887*^9, 
   3.762267928051405*^9}, 3.762267973773315*^9, {3.762268017780451*^9, 
   3.7622680575155687`*^9}, 3.762793093215591*^9, {3.763796995475988*^9, 
   3.7637970043599586`*^9}, {3.7643154838421183`*^9, 3.764315495506998*^9}, {
   3.764945527167924*^9, 3.764945538174453*^9}, {3.767432814398486*^9, 
   3.767432819483389*^9}, {3.7674328754926987`*^9, 3.767432894311245*^9}, {
   3.7674334785881023`*^9, 3.76743347876075*^9}, {3.783069231678774*^9, 
   3.783069266967184*^9}, 3.7830693020753717`*^9, {3.783087670253394*^9, 
   3.783087692517221*^9}, {3.783087735097041*^9, 3.7830880407310047`*^9}, {
   3.7830896557036057`*^9, 3.783089655981719*^9}, {3.7830960653733*^9, 
   3.783096097330763*^9}, {3.783096177529833*^9, 3.783096217488394*^9}, 
   3.783096403572884*^9, {3.783096499380589*^9, 3.783096678487729*^9}, {
   3.7830967101189957`*^9, 3.7830967683185453`*^9}, {3.783096810245809*^9, 
   3.7830969314424973`*^9}, {3.783157041710597*^9, 3.783157071451893*^9}, 
   3.783158293531158*^9, {3.783158345329475*^9, 3.7831584119283037`*^9}, {
   3.783162888798779*^9, 3.7831629160834846`*^9}, {3.783173913377779*^9, 
   3.783173927301927*^9}, {3.78317468233254*^9, 3.783174731586187*^9}, {
   3.783181333932486*^9, 3.783181355705113*^9}, 3.783182265822321*^9, {
   3.783182316941475*^9, 3.783182383458167*^9}, {3.783182554647244*^9, 
   3.7831825600059423`*^9}, {3.783182822376739*^9, 3.783182853542233*^9}, {
   3.783182889878277*^9, 3.783182934134598*^9}, {3.783182995421097*^9, 
   3.783183036649972*^9}, {3.783183069050721*^9, 3.783183191030245*^9}, {
   3.783183232775155*^9, 3.783183237420909*^9}, {3.78318339958671*^9, 
   3.7831834296081047`*^9}, {3.783183827440568*^9, 3.783183870661778*^9}, {
   3.7831858146833487`*^9, 3.783185820360832*^9}, {3.78318620357759*^9, 
   3.7831863955464983`*^9}, {3.7831864488989487`*^9, 3.783186585983418*^9}, {
   3.783186670150992*^9, 3.783186732816155*^9}, {3.783186772100696*^9, 
   3.7831867922121983`*^9}, {3.783186878850333*^9, 3.783186879920302*^9}, {
   3.7831870216135387`*^9, 3.783187032301166*^9}, {3.783187090181974*^9, 
   3.783187119805009*^9}, {3.783187195209736*^9, 3.783187211600642*^9}, {
   3.783187389227145*^9, 3.7831873956208487`*^9}, {3.7831874423488693`*^9, 
   3.7831874482836246`*^9}, {3.783187498147171*^9, 3.783187519594695*^9}, 
   3.783187549691279*^9, {3.7831875806594877`*^9, 3.7831875942107162`*^9}, 
   3.783187641746428*^9, {3.783187675529022*^9, 3.783187719981183*^9}, {
   3.78318775777507*^9, 3.783187777507882*^9}, {3.783195034318838*^9, 
   3.783195082369486*^9}, {3.783195129176243*^9, 3.783195130654354*^9}, 
   3.783195600430035*^9, {3.783195875568955*^9, 3.783195923116975*^9}, 
   3.7832404866326427`*^9, 3.783240537982945*^9, {3.783241766563958*^9, 
   3.783241770169858*^9}, {3.783242019589055*^9, 3.783242038913435*^9}, {
   3.783242224440885*^9, 3.783242232079968*^9}, {3.783242363414337*^9, 
   3.7832424064301023`*^9}, {3.783242440565166*^9, 3.7832424648026743`*^9}, {
   3.7832425068205843`*^9, 3.7832425069775333`*^9}, {3.7832428495568666`*^9, 
   3.7832428525702267`*^9}, {3.7833542866937017`*^9, 3.783354309444758*^9}, {
   3.783355614593163*^9, 3.783355640838348*^9}, {3.78335833421679*^9, 
   3.783358334758829*^9}, {3.783359693620332*^9, 3.783359721627674*^9}, {
   3.783361653056139*^9, 3.7833616572554417`*^9}, 3.783362194124464*^9, 
   3.78336223465842*^9, {3.783362393368207*^9, 3.78336245282276*^9}, {
   3.7833631602478237`*^9, 3.78336317317529*^9}, {3.783363636844595*^9, 
   3.783363674874811*^9}, {3.7834053675756693`*^9, 3.7834053792610207`*^9}, {
   3.78340583132686*^9, 3.783405831388301*^9}, {3.7834059187574177`*^9, 
   3.783405920434761*^9}, {3.783406753268241*^9, 3.783406758700287*^9}, {
   3.783408564127472*^9, 3.783408564196937*^9}, {3.783409214047086*^9, 
   3.783409220333387*^9}, {3.7834092529907017`*^9, 3.783409266756735*^9}, {
   3.783409308918028*^9, 3.783409328267762*^9}, {3.7834093770844517`*^9, 
   3.783409380945528*^9}, {3.783409474178068*^9, 3.783409480351221*^9}, {
   3.783409516417066*^9, 3.783409528518855*^9}, {3.7834095696870127`*^9, 
   3.783409575533265*^9}, {3.78341403995479*^9, 3.783414061688508*^9}, {
   3.783414179951048*^9, 3.783414199261772*^9}, {3.783415241625046*^9, 
   3.783415258198558*^9}, {3.783415294945393*^9, 3.783415333013176*^9}, {
   3.7834154590669413`*^9, 3.783415468578064*^9}, {3.7834155039130774`*^9, 
   3.783415527368451*^9}, {3.783418581398685*^9, 3.783418664800386*^9}, {
   3.783418723713091*^9, 3.7834187328069143`*^9}, {3.783419129079568*^9, 
   3.783419161050747*^9}, {3.783419483639987*^9, 3.783419490022593*^9}, 
   3.783419546414909*^9, {3.783419624037633*^9, 3.783419629859383*^9}, {
   3.783419691492093*^9, 3.78341970060884*^9}, {3.7834197798175917`*^9, 
   3.783419786526613*^9}, {3.7834198795754337`*^9, 3.783419888324492*^9}, {
   3.783419978237026*^9, 3.783419988274308*^9}, {3.783420066460009*^9, 
   3.783420075168106*^9}, {3.783420141537942*^9, 3.783420151366643*^9}, {
   3.783420438571474*^9, 3.783420446959621*^9}, {3.7834206705259237`*^9, 
   3.7834206829308367`*^9}, {3.7834207424382133`*^9, 3.783420750859206*^9}, {
   3.783421365767969*^9, 3.783421373597426*^9}, {3.783421965333004*^9, 
   3.783422006585594*^9}, {3.783422059923292*^9, 3.783422066422491*^9}, {
   3.783422880213716*^9, 3.783422887304878*^9}, {3.783423017795732*^9, 
   3.783423131788115*^9}, {3.783423170557499*^9, 3.7834231864683104`*^9}, {
   3.783423235235924*^9, 3.783423243065174*^9}, {3.7834232813629103`*^9, 
   3.78342328419268*^9}, {3.783423332465522*^9, 3.783423360958775*^9}, {
   3.7834235748693542`*^9, 3.783423585625668*^9}, {3.783423829774604*^9, 
   3.783423906795795*^9}, {3.7835949976169567`*^9, 3.783595000387117*^9}, {
   3.7835964592279263`*^9, 3.783596465811654*^9}, 3.7835983479689827`*^9, {
   3.783598416461194*^9, 3.78359844209156*^9}, {3.783598587874024*^9, 
   3.783598602712634*^9}, {3.783598980855957*^9, 3.783599040501889*^9}, {
   3.783599096541379*^9, 3.7835991615239563`*^9}, {3.783599196547413*^9, 
   3.7835992406904707`*^9}, {3.783599718079628*^9, 3.783599734270441*^9}, {
   3.783599800285762*^9, 3.783599888379499*^9}, {3.783599919258868*^9, 
   3.783599994201694*^9}, {3.7836001062555923`*^9, 3.783600110126745*^9}, {
   3.783600187447453*^9, 3.78360019428551*^9}, {3.783600246509571*^9, 
   3.783600315930904*^9}, {3.783600361020162*^9, 3.7836003877214746`*^9}, {
   3.783600860773121*^9, 3.7836008702921343`*^9}, {3.783601307850275*^9, 
   3.783601315817883*^9}, {3.783603710860333*^9, 3.7836037455479393`*^9}, 
   3.783603805400714*^9, {3.783611681345581*^9, 3.783611702481873*^9}, {
   3.7836263908296432`*^9, 3.7836264730652323`*^9}, {3.783626658029374*^9, 
   3.783626743539419*^9}, {3.783626786133835*^9, 3.783626855636197*^9}, {
   3.783626905628832*^9, 3.783626908979969*^9}, 3.783628008592647*^9, {
   3.78362806911053*^9, 3.78362808521664*^9}, {3.783628168549728*^9, 
   3.7836281958516827`*^9}, 3.783628228412869*^9, {3.783628262228024*^9, 
   3.783628285290011*^9}, {3.7836283228437138`*^9, 3.783628334856893*^9}, {
   3.783628375585116*^9, 3.783628396601012*^9}, {3.783628437320335*^9, 
   3.783628469613873*^9}, {3.7836285874692783`*^9, 3.78362867828119*^9}, {
   3.7836288838147583`*^9, 3.7836289593630753`*^9}, {3.7836289923480577`*^9, 
   3.7836290057698793`*^9}, 3.783630050494913*^9, {3.7836317844919157`*^9, 
   3.783631784554021*^9}, {3.7836321129729967`*^9, 3.7836321426425447`*^9}, 
   3.783672659872274*^9, {3.7836785454267273`*^9, 3.7836785468074217`*^9}, {
   3.783678581137383*^9, 3.783678581443434*^9}, 3.786967768778201*^9, {
   3.807369528727828*^9, 3.807369546604195*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[762]:=",ExpressionUUID->"a4189197-577d-4d91-a3d7-638f90e78be4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<HandleSpecialLabels\>\"", ",", "input_List"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "specialLabels", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"specialLabels", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<FilterSpecialLabels\>\"", ",", "input"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SynthesiseStructure", "/@", "specialLabels"}], ";", 
     "\[IndentingNewLine]", "specialLabels"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.808022780866338*^9, 3.8080228377542763`*^9}, {
  3.808024183465485*^9, 3.808024203307818*^9}, {3.808024369072907*^9, 
  3.808024404081531*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[763]:=",ExpressionUUID->"4b797d8b-3f83-489e-9f60-9d4036297891"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<InterpretElement\>\"", ",", "input_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"elementsIn", "=", "input"}], ",", "pertiodicTable", ",", 
      "elementsRead", ",", "elementsReadNeutral", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{"elementsIn", ",", "NumberString"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"elementsIn", "=", 
          RowBox[{"ToExpression", "@", "elementsIn"}]}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{"in", " ", "the", " ", "periodic", " ", "table"}], ")"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "elementsIn", "\[LessEqual]", 
            RowBox[{"Length", "@", "$PeriodicTable"}]}], ")"}], "&&", 
          RowBox[{"IntegerQ", "@", "elementsIn"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Keys", "@", "$PeriodicTable"}], ")"}], 
           "\[LeftDoubleBracket]", "elementsIn", "\[RightDoubleBracket]"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "ElementNumber"}], ",", 
            RowBox[{"ToString", "@", "elementsIn"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "single", " ", "string", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Wrap"}], " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", 
       RowBox[{"elementsIn", "=", 
        RowBox[{"{", "elementsIn", "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Process"}], " ", "list", " ", "of", " ", 
       "strings", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "input", " ", "is", 
       " ", "a", " ", "list", " ", "of", " ", "strings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "elementsIn"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"elementsIn", ",", "StringQ"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".2", ".", " ", "Set"}], " ", "of", " ", "valid", " ", 
       "symbols", " ", "from", " ", "the", " ", "periodic", " ", "table"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pertiodicTable", "=", 
      RowBox[{"Keys", "@", "$PeriodicTable"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"C", 
        RowBox[{".3", ".", " ", "Find"}], " ", 
        RowBox[{"(", "possible", ")"}], " ", "matches"}], ",", " ", 
       RowBox[{"and", " ", "establish", " ", "order"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"elementsIn", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StartOfString", "~~", 
          RowBox[{"a", ":", "LetterCharacter"}], "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{"b", ":", "LetterCharacter"}]}], "}"}], "~~", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{
             RowBox[{"n1", ":", 
              RowBox[{"DigitCharacter", "..."}]}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n2", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"ToUpperCase", "[", "a", "]"}], "<>", 
          RowBox[{"ToLowerCase", "[", "b", "]"}], "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n1", "===", "\"\<\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"n2", "===", "\"\<\>\""}], ")"}]}], ",", "\"\<1\>\"", 
            ",", "\"\<\>\""}], "]"}], "<>", "n1", "<>", "n2", "<>", 
          "pm"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "for", " ", "non"}], "-", "elements"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"elementsRead", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsRead", ",", 
               RowBox[{"{", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Separate", " ", "element", " ", "symbol", " ", "and", " ", "charge", 
       " ", 
       RowBox[{"(", 
        RowBox[{"if", " ", "any"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "elementsRead"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"a", ":", 
             RowBox[{"LetterCharacter", ".."}]}], "~~", "b___"}], 
           "\[IndentingNewLine]", "\t", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"b", "===", "\"\<\>\""}], ",", "\"\<&\>\"", ",", "b"}],
               "]"}]}], "}"}]}]}], "]"}], ",", "1"}], "]"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"'", "&"}], "'"}], " ", "should", " ", "be", " ", "deleted", 
       " ", "later"}], " ", "*)"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".4", ".", " ", "Remove"}], " ", "second", " ", "character", 
       " ", "if", " ", "not", " ", "applicable"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{
        RowBox[{"s_String", "/;", "\[IndentingNewLine]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"pertiodicTable", ",", "s"}], "]"}]}]}], "\[RuleDelayed]", 
        
        RowBox[{"StringTake", "[", 
         RowBox[{"s", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", "deuterium"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".5", ".", " ", "Final"}], " ", "validity", " ", "check"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elementsReadNeutral", ",", "pertiodicTable"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsReadNeutral", ",", "\[IndentingNewLine]", 
               RowBox[{"First", "@", "temp"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".6", ".", " ", "Concatenate"}], " ", "elements", " ", "and", 
       " ", "charge"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"elementsRead", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      "elementsReadNeutral"}], ";", "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"elementsRead", "/.", 
       RowBox[{"\"\<1\>\"", "\[Rule]", "\"\<\>\""}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"StringJoin", "/@", "elementsRead"}], ",", "\"\<&\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "chemical", " ", "element"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<ElementFailed\>\""}], ",", 
       RowBox[{"ToString", "@", "input"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"b", ".", " ", "Return"}], " ", "string", " ", 
       RowBox[{"(", 
        RowBox[{"or", " ", "list", " ", "of", " ", "strings"}], ")"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "elementsRead", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        ",", "elementsRead"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278567175089*^9, 
   3.737278609150566*^9}, {3.737278661861796*^9, 3.7372787061104527`*^9}, {
   3.737278786430764*^9, 3.737278815614232*^9}, {3.737278876614931*^9, 
   3.737278894575992*^9}, {3.737279063214642*^9, 3.737279117617867*^9}, {
   3.737279153995288*^9, 3.737279156957521*^9}, {3.737279209224059*^9, 
   3.7372792281945353`*^9}, {3.737279265333662*^9, 3.7372792662517557`*^9}, {
   3.737279499593874*^9, 3.7372795003597097`*^9}, {3.7372795311927958`*^9, 
   3.737279607430427*^9}, {3.737279901036427*^9, 3.737279905187501*^9}, {
   3.73728056780586*^9, 3.737280595834815*^9}, {3.737280731938634*^9, 
   3.7372807824368553`*^9}, {3.737280821275927*^9, 3.737280850048135*^9}, {
   3.7372808982833033`*^9, 3.7372809507817802`*^9}, {3.737281047830305*^9, 
   3.737281064716365*^9}, {3.7372811554403543`*^9, 3.73728118861235*^9}, {
   3.7372812569776163`*^9, 3.737281316071546*^9}, {3.737281653054924*^9, 
   3.737281698062044*^9}, {3.737284237057*^9, 3.737284327083954*^9}, {
   3.7372843590048733`*^9, 3.737284369739956*^9}, {3.7372844386235523`*^9, 
   3.737284484892178*^9}, {3.7372850819056*^9, 3.737285090806818*^9}, {
   3.73728520111075*^9, 3.737285222748335*^9}, {3.737285270111203*^9, 
   3.73728530587646*^9}, {3.737285533840251*^9, 3.737285559292869*^9}, {
   3.7372856101403227`*^9, 3.737285657390164*^9}, {3.737285700136235*^9, 
   3.737285798718968*^9}, {3.7372858357113028`*^9, 3.737285868194257*^9}, {
   3.737285908459991*^9, 3.737286014905347*^9}, 3.737286052837697*^9, {
   3.7372861540618677`*^9, 3.737286154519107*^9}, {3.737286254980082*^9, 
   3.7372863413456507`*^9}, {3.737286380256139*^9, 3.7372864143825283`*^9}, {
   3.737286458977261*^9, 3.737286576079788*^9}, {3.737286623935347*^9, 
   3.737286632869177*^9}, {3.7372866648183327`*^9, 3.737286723584116*^9}, {
   3.737374746359795*^9, 3.737374832079135*^9}, {3.73737499904206*^9, 
   3.737375023959383*^9}, {3.737378138033321*^9, 3.737378164259573*^9}, {
   3.737378225363977*^9, 3.73737825691322*^9}, 3.7373784605339413`*^9, {
   3.737378502252293*^9, 3.73737864023484*^9}, {3.737378704823086*^9, 
   3.737378712047621*^9}, {3.737378750431796*^9, 3.737378752703669*^9}, {
   3.737378898239748*^9, 3.737378990411519*^9}, {3.73737903566635*^9, 
   3.7373791239583397`*^9}, {3.737379162032648*^9, 3.737379164836317*^9}, {
   3.7373792649735928`*^9, 3.7373793244342623`*^9}, {3.737379375913303*^9, 
   3.73737941501803*^9}, {3.737379491076782*^9, 3.737379495461954*^9}, {
   3.737379605763606*^9, 3.7373796928169928`*^9}, {3.73737986755727*^9, 
   3.7373800849030933`*^9}, {3.7373801268150043`*^9, 
   3.7373801843010073`*^9}, {3.737380294292263*^9, 3.737380294698414*^9}, {
   3.737380414361321*^9, 3.737380698358766*^9}, {3.7373807418017273`*^9, 
   3.73738075376825*^9}, {3.7373807854482927`*^9, 3.737380862411724*^9}, {
   3.737381036834449*^9, 3.737381064693281*^9}, {3.737381100937663*^9, 
   3.7373811217752542`*^9}, 3.737381158470895*^9, 3.737381221032393*^9, {
   3.737381678459423*^9, 3.737381805116645*^9}, {3.737381836958056*^9, 
   3.737381881326532*^9}, {3.737381917168672*^9, 3.7373819592222023`*^9}, {
   3.737382007542437*^9, 3.737382116848222*^9}, {3.7373821591203203`*^9, 
   3.737382355002592*^9}, {3.7379744155182457`*^9, 3.737974415670136*^9}, {
   3.7379754153411427`*^9, 3.737975452667324*^9}, {3.73797549962778*^9, 
   3.7379755241789637`*^9}, 3.737975563770276*^9, {3.737975648095365*^9, 
   3.7379756613659477`*^9}, {3.73921005915567*^9, 3.739210067088846*^9}, {
   3.7392103437571*^9, 3.739210372090125*^9}, {3.7392104083569927`*^9, 
   3.739210408785853*^9}, {3.739210561112054*^9, 3.739210658951914*^9}, {
   3.742878249248098*^9, 3.7428782535467987`*^9}, {3.7428782893930473`*^9, 
   3.742878353943668*^9}, {3.742878774060712*^9, 3.7428787793596373`*^9}, {
   3.742878811736623*^9, 3.742878976915493*^9}, {3.7428790184091597`*^9, 
   3.7428790837272663`*^9}, {3.742879158784565*^9, 3.7428791803486032`*^9}, {
   3.742879211104168*^9, 3.742879211738106*^9}, {3.7585299775360603`*^9, 
   3.75853003338778*^9}, 3.7627930937690287`*^9, {3.786967780924135*^9, 
   3.786967783242278*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[764]:=",ExpressionUUID->"8e5e6f2d-f5d4-4483-bc3a-d750a7699d53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<InterpretSpaceGroup\>\"", ",", "input_", ",", 
    RowBox[{"abortQ_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sg", "=", "input"}], ",", "o", ",", "regex", ",", "temp"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{
           RowBox[{"StringTrim", "@", "sg"}], ",", "NumberString"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"sg", "=", 
          RowBox[{"ToExpression", "@", "sg"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{
        "a", " ", "canonical", " ", "space", " ", "group", " ", "number"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "sg", "\[LessEqual]", "230"}], ")"}], 
          "&&", 
          RowBox[{"IntegerQ", "@", "sg"}]}], ",", 
         RowBox[{"Return", "@", 
          RowBox[{"$SpaceGroups", "\[LeftDoubleBracket]", 
           RowBox[{"sg", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
           "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "InvalidSpaceGroupNumber"}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"abortQ", ",", 
            RowBox[{"Abort", "[", "]"}], ",", 
            RowBox[{"Return", "@", "Null"}]}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "string", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "string"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringQ", "@", "sg"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".2", " ", "Process", " ", "any", " ", "annotations"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"sg", ",", "\"\<origin\>\"", ",", 
         RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"regex", "=", 
         RowBox[{
         "RegularExpression", "[", "\"\< \\\\(origin.+(\\\\d)\\\\)\>\"", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"o", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"sg", ",", 
           RowBox[{"regex", "\[Rule]", "\"\<$1\>\""}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"o", "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Manual", " ", "input", " ", "required"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"o", "=", 
            RowBox[{"ChoiceDialog", "[", 
             RowBox[{
              RowBox[{
              "\"\<Information on cell origin detected.\>\"", "<>", 
               "\[IndentingNewLine]", "\"\<\\n\>\"", "<>", 
               "\"\<Please confirm the cell origin.\>\""}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"WindowTitle", "\[Rule]", "\"\<Cell origin\>\""}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"sg", "=", 
            RowBox[{"StringDelete", "[", 
             RowBox[{"sg", ",", 
              RowBox[{
              "Whitespace", "~~", "\"\<(\>\"", "~~", "__", "~~", 
               "\"\<)\>\""}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rebuild", " ", "space", " ", "group", " ", "symbol"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"o", "=", 
            RowBox[{"First", "@", "o"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"sg", "=", 
            RowBox[{"StringReplace", "[", 
             RowBox[{"sg", ",", 
              RowBox[{"regex", "\[Rule]", "\"\<:$1\>\""}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".3", " ", "Tidy", " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "sg", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"B", ".4", 
           RowBox[{".1", ".", " ", "Remove"}], " ", "any", " ", "_enclosing", 
           "_", " ", "quotation", " ", "marks"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Note", ":", " ", 
           RowBox[{
           "Some", " ", "Hall", " ", "symbols", " ", "contain", " ", "double",
             " ", "quotation", " ", "marks"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "main__", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "EndOfString"}], "\[RuleDelayed]", "main"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".2", " ", "Uppercase", " ", "centring", " ", "1"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"first", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<-\>\"", "~~", "_"}], ",", "_"}], "}"}]}], "~~", 
            "rest__", "~~", "EndOfString"}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToUpperCase", "@", "first"}], "~~", 
            RowBox[{"ToLowerCase", "@", "rest"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".3", ".", " ", "Fix"}], " ", "boxes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<overscriptbox\>\"", "\[Rule]", "\"\<OverscriptBox\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<subscriptbox\>\"", "\[Rule]", "\"\<SubscriptBox\>\""}]}], 
           "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".4", " ", "Uppercase", " ", "centring", " ", "2"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<Box[\\(\>\"", "~~", "c_"}], "\[RuleDelayed]", 
           RowBox[{"\"\<Box[\\(\>\"", "<>", 
            RowBox[{"ToUpperCase", "[", "c", "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", ".5", " ", "Screw", " ", "axes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"a", ":", "DigitCharacter"}], "~~", "\"\<(\>\"", "~~", 
            RowBox[{"b", ":", "DigitCharacter"}], "~~", "\"\<)\>\""}], 
           "\[RuleDelayed]", 
           RowBox[{"a", "<>", "b"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".6", ".", " ", "Miscellaneous"}], " ", "replacements"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\"\<;\>\"", "\[Rule]", "\"\< \>\""}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Check"}], " ", "symbol", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "centring", " ", "symbol"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<P\>\"", ",", "\"\<I\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
            ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", 
            "\"\<H\>\"", ",", "\"\<\\!\>\"", ",", "\"\<-\>\""}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringTake", "[", 
           RowBox[{"sg", ",", "1"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", ".2", " ", "Check", " ", "if", " ", "found", " ", 
       RowBox[{"by", " ", "'"}], 
       RowBox[{"$GroupSymbolRedirect", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "sg", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"temp", ",", "\"\<PointGroupNumber\>\""}], "]"}], ",", 
          RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Exception", ":", " ", 
       RowBox[{"Old", " ", 
        RowBox[{"symbols", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "\"\<Fm3m\>\""}], ",", 
       RowBox[{
        RowBox[{"sg", "=", "\"\<Fm-3m\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "\"\<Im3m\>\""}], ",", 
       RowBox[{
        RowBox[{"sg", "=", "\"\<Im-3m\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "C", ".3", " ", "Delete", " ", "whitespace", " ", "and", " ", "check", 
       " ", "again"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"sg", ",", "Whitespace"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "temp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"temp", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "space", " ", "group"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "InvalidSpaceGroup"}], ",", "input"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"abortQ", ",", 
       RowBox[{"Abort", "[", "]"}], ",", 
       RowBox[{"Return", "@", "Null"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"b", ".", " ", "Return"}], " ", "non"}], "-", 
       RowBox[{"ambiguous", " ", "output"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SpaceGroupFound\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ToStandardSetting", "[", "sg", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278689235427*^9, 
   3.737278724291026*^9}, {3.7373828319134293`*^9, 3.737382905583477*^9}, {
   3.7380503409830427`*^9, 3.7380503462202253`*^9}, {3.738050409199875*^9, 
   3.738050410020376*^9}, {3.738050587280776*^9, 3.738050594380994*^9}, {
   3.738050633314591*^9, 3.738050741885346*^9}, 3.738050787226899*^9, {
   3.738050820907621*^9, 3.738050913718038*^9}, {3.738050967336628*^9, 
   3.738051039601925*^9}, {3.738051123094633*^9, 3.7380511685169477`*^9}, {
   3.7380512915012083`*^9, 3.73805131582058*^9}, 3.73805147687253*^9, {
   3.738291406092393*^9, 3.738291463424559*^9}, {3.739251235484573*^9, 
   3.739251259594013*^9}, {3.7392664653604727`*^9, 3.739266516678097*^9}, 
   3.7392665477450542`*^9, {3.739267739894909*^9, 3.739267740037506*^9}, 
   3.73950412920148*^9, {3.742016464322269*^9, 3.742016465840391*^9}, {
   3.742022822926903*^9, 3.742022908512398*^9}, {3.742022978221959*^9, 
   3.74202298550244*^9}, {3.743865456276009*^9, 3.7438654563219023`*^9}, {
   3.7438669045354652`*^9, 3.7438669207895317`*^9}, {3.758530035604117*^9, 
   3.758530048874316*^9}, 3.762793093794232*^9, 3.786956173621265*^9, 
   3.786956233171356*^9, {3.786967829179142*^9, 3.7869678304655848`*^9}, {
   3.808106773681034*^9, 3.8081067834547157`*^9}, {3.808121330745881*^9, 
   3.8081213496836987`*^9}, {3.8081214302480783`*^9, 3.808121445400476*^9}, {
   3.808121978764077*^9, 3.808121990817814*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[765]:=",ExpressionUUID->"601b0ce5-62ac-4686-af66-dc2c8f075b0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "[", 
    RowBox[{"\"\<PadDomain\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"X_", ",", "Y_", ",", "Z_"}], "}"}], ",", "domain_List"}], 
      "}"}], ",", 
     RowBox[{"padding_Integer", ":", "1"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "newSize", ",", "\[IndentingNewLine]", "contentPositions", ",", 
       "contentMap", ",", "\[IndentingNewLine]", "voidPositions", ",", 
       "voidMap", ",", "\[IndentingNewLine]", "joined"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"padding", "\[LessEqual]", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", ",", "Y", ",", "Z"}], "}"}], ",", "domain"}], "}"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newSize", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"padding", "+", "1"}], ")"}], 
         RowBox[{"{", 
          RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], "-", "padding"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"contentPositions", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0.", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"padding", "+", "1"}], ")"}], "*", "X"}], "-", "1"}], 
             ",", 
             RowBox[{"padding", "+", "1"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "0.", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"padding", "+", "1"}], ")"}], "*", "Y"}], "-", "1"}], 
             ",", 
             RowBox[{"padding", "+", "1"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0.", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"padding", "+", "1"}], ")"}], "*", "Z"}], "-", "1"}], 
             ",", 
             RowBox[{"padding", "+", "1"}]}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"contentMap", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"contentPositions", "\[Rule]", "domain"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"voidPositions", "=", 
       RowBox[{"Complement", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"InputCheck", "[", 
          RowBox[{"\"\<GenerateTargetPositions\>\"", ",", "newSize"}], "]"}], 
         ",", "\[IndentingNewLine]", "contentPositions"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"voidMap", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"voidPositions", "\[Rule]", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"joined", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"contentMap", ",", "voidMap"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"newSize", ",", 
        RowBox[{"Values", "@", 
         RowBox[{"KeySortBy", "[", 
          RowBox[{"joined", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "&"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "&"}], ",", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              "&"}]}], "}"}]}], "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQfWPCDM6LcW8c0/se84DonDN/xUC0xeR50iD6y87J
BiD6VoqtIYj+N2vLQ+X4N45Xdr56BKLfpR17A6LrLJu/g+hly5hZVYD0gmx3
HhDddTQkBkRrOO4G01HWBUkgusFzVgeIXtaxeiKI3jd9wjQQXRc0ZyGIPvz4
NZhuEMh6A6KnqW76BqLT/HN/g+hDpnrMqkBanyuIC0TzS+WJgGi1bkVJEM0g
qS4Poq+8zVAG0auSEnRB9InvtwxBtIj9MxMQPW+Kii1Y3dwH3iA69dL3CBCd
yMkbCaIXnFj51QlIf2BZ/Q1EAwC2QZC+
  "],
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[766]:=",ExpressionUUID->"b16b138f-bf65-4fd5-a166-713868445fae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<PointGroupQ\>\"", ",", "input_String"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Check", " ", "if", " ", "valid", " ", "space", " ", "group", " ", 
     "string"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"$PointGroups", ",", "input", ",", "Infinity"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "InvalidPointGroup"}], ",", "input"}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.7136042900817747`*^9}, {
   3.713604322627748*^9, 3.713604324160606*^9}, {3.7136043702641973`*^9, 
   3.713604371101212*^9}, {3.71471126435174*^9, 3.71471126555512*^9}, 
   3.717740897041522*^9, 3.72760353803649*^9, {3.7305444772094812`*^9, 
   3.730544481061934*^9}, {3.786955776603215*^9, 3.786955778865026*^9}, {
   3.7869678550624*^9, 3.7869678568855343`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[767]:=",ExpressionUUID->"e82c3951-f20d-436f-a230-d5fa69f68320"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<PointSpaceGroupQ\>\"", ",", "input_String"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "if", " ", "valid", " ", "point"}], "-", " ", 
    RowBox[{"or", " ", "space", " ", "group", " ", "string"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "InvalidPointOrSpaceGroup"}], ",", 
       "input"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, {
   3.713604296226803*^9, 3.713604299721271*^9}, {3.714710977590053*^9, 
   3.714710979768374*^9}, 3.717740920646922*^9, 3.7276035440759487`*^9, 
   3.743865456393198*^9, 3.786955741867633*^9, {3.786967867925956*^9, 
   3.786967869221291*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[768]:=",ExpressionUUID->"50460ba9-d53a-4a04-8961-e3234d0a529d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<Polarisation\>\"", ",", "type_String", ",", 
    RowBox[{"scatteringAngle_", ":", "0"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"type", "===", "\"\<sigma\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Sigma]\>\""}]}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", "===", "\"\<pi\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Pi]\>\""}]}], ",", 
    RowBox[{"Abs", "@", 
     RowBox[{"Cos", "[", "scatteringAngle", "]"}]}], ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"InputCheck", "::", "InvalidPolarisationSetting"}], "]"}], ";", 
     
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}, {
   3.7869556349496*^9, 3.786955645732377*^9}, {3.7869678798936377`*^9, 
   3.786967882580845*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[769]:=",ExpressionUUID->"6255ceea-ac6e-4b5c-97cb-2470ec8cb6c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{
   "\"\<ProcessWavelength\>\"", ",", "crystal_String", ",", "wavelength_", 
    ",", 
    RowBox[{"abortQ_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[Lambda]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"N", "@", "wavelength"}], "===", 
         RowBox[{"-", "1."}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
         "\"\<GetCrystalWavelength\>\"", ",", "crystal", ",", "abortQ"}], 
         "]"}], ",", "wavelength"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<GetEnergyWavelength\>\"", ",", "\[Lambda]", ",", "False"}],
       "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730395241910015*^9, 3.730395331782501*^9}, 
   3.73039551088382*^9, {3.7391249707350397`*^9, 3.739124986130555*^9}, {
   3.73912511330057*^9, 3.739125114641823*^9}, {3.739125407092436*^9, 
   3.7391254219192133`*^9}, {3.7391254965873337`*^9, 3.739125499857193*^9}, {
   3.739125656582911*^9, 3.739125666230063*^9}, 3.762793093803693*^9, {
   3.78696789325462*^9, 3.78696789750043*^9}, {3.7869685447895184`*^9, 
   3.7869685534921007`*^9}, {3.8054428867805347`*^9, 3.805442905687858*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[770]:=",ExpressionUUID->"5b15bc5b-5261-4877-bbdd-1fb7cf05d318"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<RotationTransformation\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A_Integer", ",", "B_Integer", ",", "C_Integer"}], "}"}], ",", 
      "domains_List"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "AnchorShift_List", ",", "\[IndentingNewLine]", "anchorReference_String",
       ",", "\[IndentingNewLine]", "rotations_", ",", "\[IndentingNewLine]", 
      RowBox[{"rotationAxes_", ":", 
       RowBox[{"IdentityMatrix", "@", "3"}]}]}], "\[IndentingNewLine]", "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"force3Dinterpretation_", ":", "False"}]}], "\[IndentingNewLine]",
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "twoDimensionalQ", ",", "coordinates", ",", "\[IndentingNewLine]", 
      "\[Zeta]", ",", "R", ",", "\[IndentingNewLine]", "uniqueDomains", ",", 
      RowBox[{"anchorShift", "=", "AnchorShift"}], ",", "anchors", ",", 
      "coordinatesGrouped", ",", "\[IndentingNewLine]", "domainAnchors", ",", 
      "zeroRotation", ",", "zeroAnchor"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Preparations", " ", "and", " ", "checks"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "domains"}], "\[NotEqual]", 
        RowBox[{"A", "*", "B", "*", "C"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "DomainSizeError"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"uniqueDomains", "=", 
      RowBox[{"DeleteDuplicates", "@", "domains"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"twoDimensionalQ", "=", 
      RowBox[{"(", 
       RowBox[{"C", "===", "1"}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"force3Dinterpretation", ",", 
       RowBox[{"twoDimensionalQ", "=", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"twoDimensionalQ", ",", 
       RowBox[{"anchorShift", "=", 
        RowBox[{"anchorShift", "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"twoDimensionalQ", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"anchorShift", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "InvalidRotationPoint"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"anchorShift", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "InvalidRotationPoint"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "rotations"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"twoDimensionalQ", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"Values", "@", "rotations"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"NumericQ", "[", "#", "]"}]}], "&"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"InputCheck", "::", "InvalidRotationMap"}], ",", 
              "\"\<2\>\"", ",", "\"\<scalars\>\""}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"Values", "@", "rotations"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{
                   RowBox[{"_", "?", "NumericQ"}], ",", "3"}], "]"}]}], 
                "]"}]}], "&"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"InputCheck", "::", "InvalidRotationMap"}], ",", 
              "\"\<3\>\"", ",", "\"\<lists of three numbers\>\""}], "]"}], 
            ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Host\>\"", ",", "\"\<Domain\>\"", ",", 
            "\"\<DomainCentroid\>\"", ",", "\"\<Unit\>\""}], "}"}], ",", 
          "anchorReference"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "InvalidRotationReference"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Rotation", " ", "anchor", " ", "and", " ", "reference", " ", "for", 
       " ", "domains"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"anchorReference", "===", "\"\<Domain\>\""}], "||", 
        RowBox[{"anchorReference", "===", "\"\<DomainCentroid\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coordinates", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0.", ",", 
               RowBox[{"A", "-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "0.", ",", 
               RowBox[{"B", "-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "0.", ",", 
               RowBox[{"C", "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"twoDimensionalQ", ",", 
          RowBox[{"coordinates", "=", 
           RowBox[{"coordinates", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"coordinatesGrouped", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Pick", "[", 
            RowBox[{"coordinates", ",", "domains", ",", "#"}], "]"}], "&"}], "/@",
           "uniqueDomains"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"domainAnchors", "=", 
         RowBox[{
          RowBox[{"<|", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<Domain\>\"", "\[Rule]", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"TakeSmallestBy", "[", 
                  RowBox[{"#", ",", "Norm", ",", "1"}], "]"}], "&"}], "/@", 
                "coordinatesGrouped"}], ",", "1"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<DomainCentroid\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "+", 
                 RowBox[{"If", "[", 
                  RowBox[{"twoDimensionalQ", ",", 
                   RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "}"}]}], "]"}]}],
                 "\[IndentingNewLine]", "&"}], "/@", 
               RowBox[{"Map", "[", 
                RowBox[{"Mean", ",", 
                 RowBox[{"Transpose", "/@", "coordinatesGrouped"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "|>"}], "@", "anchorReference"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "+", "anchorShift"}], "&"}], "/@", "domainAnchors"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"anchors", "=", 
         RowBox[{"N", "@", 
          RowBox[{"Association", "@", 
           RowBox[{"Thread", "[", 
            RowBox[{"uniqueDomains", "\[Rule]", "domainAnchors"}], 
            "]"}]}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Rotation", " ", "transformation", " ", 
       RowBox[{"function", " ", "'"}], 
       RowBox[{"R", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zeroRotation", ",", "zeroAnchor"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{"twoDimensionalQ", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0."}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Zeta]", "[", "d_", "]"}], ":=", 
      RowBox[{"N", "@", 
       RowBox[{"Lookup", "[", 
        RowBox[{"rotations", ",", "d", ",", "zeroRotation"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"anchorReference", "===", "\"\<Host\>\""}], "&&", 
        "twoDimensionalQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "[", "d_", "]"}], ":=", 
        RowBox[{"Chop", "@", 
         RowBox[{"RotationTransform", "[", 
          RowBox[{
           RowBox[{"\[Zeta]", "@", "d"}], ",", "anchorShift"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"anchorReference", "===", "\"\<Host\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"R", "[", "d_", "]"}], ":=", 
         RowBox[{"Chop", "[", 
          RowBox[{"Composition", "@@", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"RotationTransform", "[", 
               RowBox[{"#1", ",", "#2", ",", "anchorShift"}], "]"}], "&"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Zeta]", "@", "d"}], ",", "rotationAxes"}], "}"}]}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"d_", ",", "p_"}], "]"}], ":=", 
         RowBox[{"Chop", "[", 
          RowBox[{"Composition", "@@", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"RotationTransform", "[", 
               RowBox[{"#1", ",", "#2", ",", "anchorShift"}], "]"}], "&"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"AssociationQ", "@", "rotations"}]}], ",", "d", ",", 
                 RowBox[{"\[Zeta]", "@", "d"}]}], "]"}], ",", 
               "rotationAxes"}], "}"}]}], "]"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"anchorReference", "===", "\"\<Unit\>\""}], "&&", 
        "twoDimensionalQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"d_", ",", "p_"}], "]"}], ":=", 
        RowBox[{"Chop", "@", 
         RowBox[{"RotationTransform", "[", 
          RowBox[{
           RowBox[{"\[Zeta]", "@", "d"}], ",", 
           RowBox[{"p", "+", "anchorShift"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"anchorReference", "===", "\"\<Unit\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"d_", ",", "p_"}], "]"}], ":=", 
        RowBox[{"Chop", "[", 
         RowBox[{"Composition", "@@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RotationTransform", "[", 
              RowBox[{"#1", ",", "#2", ",", 
               RowBox[{"p", "+", "anchorShift"}]}], "]"}], "&"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"AssociationQ", "@", "rotations"}]}], ",", "d", ",", 
                
                RowBox[{"\[Zeta]", "@", "d"}]}], "]"}], ",", "rotationAxes"}],
              "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "twoDimensionalQ", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "[", "d_", "]"}], ":=", 
        RowBox[{"Chop", "@", 
         RowBox[{"RotationTransform", "[", 
          RowBox[{
           RowBox[{"\[Zeta]", "@", "d"}], ",", 
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"anchors", ",", "d", ",", "zeroAnchor"}], "]"}], "+", 
            "anchorShift"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"d_", ",", "p_"}], "]"}], ":=", 
        RowBox[{"Chop", "[", 
         RowBox[{"Composition", "@@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RotationTransform", "[", 
              RowBox[{"#1", ",", "#2", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Lookup", "[", 
                 RowBox[{"anchors", ",", "d", ",", "zeroAnchor"}], "]"}], "+",
                 "anchorShift"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Zeta]", "@", "d"}], ",", "rotationAxes"}], "}"}]}], 
           "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "R"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.7136042900817747`*^9}, {
   3.713604322627748*^9, 3.713604324160606*^9}, {3.7136043702641973`*^9, 
   3.713604371101212*^9}, {3.71471126435174*^9, 3.71471126555512*^9}, 
   3.717740897041522*^9, 3.72760353803649*^9, {3.7305444772094812`*^9, 
   3.730544481061934*^9}, 3.779134743520239*^9, 3.780063496561495*^9, {
   3.7800656334164047`*^9, 3.780065634143066*^9}, {3.781676971089305*^9, 
   3.781677003239027*^9}, {3.781677083550412*^9, 3.781677086541286*^9}, {
   3.781677135821582*^9, 3.781677144397409*^9}, 3.78167728536308*^9, {
   3.781677317834395*^9, 3.781677357288885*^9}, {3.781677912993319*^9, 
   3.781677913016111*^9}, {3.781677951924474*^9, 3.781677970755274*^9}, {
   3.7816781330093927`*^9, 3.78167813523242*^9}, {3.781678179945636*^9, 
   3.781678182943266*^9}, {3.781678272176132*^9, 3.781678319100099*^9}, {
   3.781678450962201*^9, 3.781678544345644*^9}, {3.781678605344584*^9, 
   3.781678606662899*^9}, {3.7816786767994003`*^9, 3.781678719116901*^9}, {
   3.781678758773364*^9, 3.78167878073839*^9}, {3.781685390107336*^9, 
   3.781685392186103*^9}, {3.7816860703813677`*^9, 3.781686073355639*^9}, {
   3.781686104268732*^9, 3.781686125722147*^9}, {3.781859766783502*^9, 
   3.781859790143857*^9}, 3.781859927210102*^9, {3.781860005751935*^9, 
   3.781860014926291*^9}, {3.7818600773703203`*^9, 3.781860205147441*^9}, {
   3.781860678688078*^9, 3.781860714993066*^9}, {3.7818608916803703`*^9, 
   3.781860961832633*^9}, {3.781861001983802*^9, 3.78186100746771*^9}, {
   3.781861062687028*^9, 3.781861068792898*^9}, {3.781861107409748*^9, 
   3.781861121342651*^9}, {3.7818611870840063`*^9, 3.78186125777414*^9}, 
   3.781861320496029*^9, {3.781861456082691*^9, 3.781861457347302*^9}, {
   3.7818620880497913`*^9, 3.781862089119491*^9}, {3.781862316614324*^9, 
   3.781862321067274*^9}, {3.7818623627629642`*^9, 3.781862477258976*^9}, {
   3.78186250728316*^9, 3.781862509610914*^9}, {3.781862557040826*^9, 
   3.781862597989863*^9}, {3.7818628952434883`*^9, 3.781862958581675*^9}, {
   3.781862991979748*^9, 3.781863035339814*^9}, {3.7818630671173*^9, 
   3.7818631148847933`*^9}, {3.781863168853231*^9, 3.781863194625503*^9}, {
   3.781863282165698*^9, 3.781863306630082*^9}, {3.781863786751247*^9, 
   3.781863835253973*^9}, 3.781864117837955*^9, {3.781864452399026*^9, 
   3.781864534765538*^9}, {3.7818645693580523`*^9, 3.7818646157650967`*^9}, {
   3.7818649204638*^9, 3.781864988659213*^9}, 3.781865226270296*^9, {
   3.7818653316106853`*^9, 3.781865334573888*^9}, {3.781865432728101*^9, 
   3.781865433330101*^9}, {3.781865582445928*^9, 3.7818656456516647`*^9}, {
   3.78186580312955*^9, 3.781865934637535*^9}, {3.78186597787962*^9, 
   3.781866010355785*^9}, {3.7818660671345243`*^9, 3.781866073844563*^9}, 
   3.781866144680382*^9, {3.781866206455649*^9, 3.781866246140813*^9}, {
   3.7818663425241127`*^9, 3.781866408362043*^9}, {3.781866538061561*^9, 
   3.781866602320487*^9}, {3.781866639333538*^9, 3.781866776972722*^9}, {
   3.781866810995131*^9, 3.781866889525423*^9}, {3.7818669716290293`*^9, 
   3.781866972156893*^9}, {3.781867150304977*^9, 3.781867221640732*^9}, {
   3.78186733287353*^9, 3.781867387849334*^9}, {3.781867460232662*^9, 
   3.781867520726623*^9}, {3.7818677067076483`*^9, 3.7818677262821007`*^9}, {
   3.781868214394621*^9, 3.7818682891615562`*^9}, {3.781868322616066*^9, 
   3.7818684031821527`*^9}, {3.781889694411968*^9, 3.78188969458493*^9}, {
   3.781889739240889*^9, 3.781889740712171*^9}, {3.781890196352343*^9, 
   3.7818902371128674`*^9}, {3.781890289143393*^9, 3.78189032137424*^9}, {
   3.781890410789217*^9, 3.781890443795897*^9}, {3.781892919894685*^9, 
   3.781893034204027*^9}, {3.781893303486244*^9, 3.781893305435915*^9}, {
   3.781893346475401*^9, 3.78189351213704*^9}, {3.781893557629952*^9, 
   3.7818937715703793`*^9}, {3.7818939351259747`*^9, 3.781893935309183*^9}, {
   3.781894014836615*^9, 3.7818940769861*^9}, {3.78189411661193*^9, 
   3.78189411976928*^9}, {3.781894171991082*^9, 3.781894208461198*^9}, {
   3.7818942845650663`*^9, 3.781894318603527*^9}, {3.781894361666711*^9, 
   3.7818943863602543`*^9}, {3.781894552911063*^9, 3.7818946192692204`*^9}, {
   3.7818946876585083`*^9, 3.781894810174672*^9}, {3.781894850775778*^9, 
   3.7818948516060038`*^9}, {3.781894918453796*^9, 3.781895022738206*^9}, {
   3.7818950815063257`*^9, 3.781895108760641*^9}, 3.781895174264599*^9, {
   3.781895214270892*^9, 3.781895216781312*^9}, {3.781895282366211*^9, 
   3.781895296919551*^9}, {3.781895771330106*^9, 3.7818957718478537`*^9}, {
   3.781895820713109*^9, 3.781895852846292*^9}, 3.78189590437525*^9, {
   3.781897878101182*^9, 3.781897878347925*^9}, {3.781898008898225*^9, 
   3.781898025545211*^9}, {3.7818987559128857`*^9, 3.7818988043597603`*^9}, {
   3.781898889726136*^9, 3.781898917060926*^9}, {3.78189894977267*^9, 
   3.781899034570207*^9}, {3.781900133342412*^9, 3.781900166179182*^9}, {
   3.7819003592874193`*^9, 3.781900366662415*^9}, {3.7819004103174343`*^9, 
   3.781900438125639*^9}, {3.781900473634039*^9, 3.781900486683679*^9}, 
   3.781934475319376*^9, {3.781935513752097*^9, 3.7819355686794977`*^9}, {
   3.7819364839738503`*^9, 3.781936517483794*^9}, {3.781936804381459*^9, 
   3.781936809259944*^9}, {3.7819376951833363`*^9, 3.781937742204927*^9}, 
   3.78193777781341*^9, 3.7819378158524647`*^9, {3.781941487712701*^9, 
   3.781941519519847*^9}, 3.781944858867134*^9, {3.781945029581437*^9, 
   3.78194506416438*^9}, {3.781945161803484*^9, 3.781945170713957*^9}, {
   3.781945346222933*^9, 3.781945376949377*^9}, {3.781945451524371*^9, 
   3.7819454679959173`*^9}, {3.7819459184869757`*^9, 
   3.7819459403865967`*^9}, {3.781946119529872*^9, 3.781946124165254*^9}, {
   3.781946323069056*^9, 3.7819463251708593`*^9}, {3.781946362075447*^9, 
   3.781946368729658*^9}, {3.781946458297504*^9, 3.781946482719144*^9}, {
   3.781946573215612*^9, 3.781946573805176*^9}, {3.781946627278986*^9, 
   3.781946630692567*^9}, {3.781946689916292*^9, 3.781946727557766*^9}, {
   3.781946818928884*^9, 3.781946886575436*^9}, {3.781946926758916*^9, 
   3.781946988316774*^9}, {3.781947031198398*^9, 3.781947089626081*^9}, {
   3.781949514503241*^9, 3.781949514781238*^9}, {3.781949746322733*^9, 
   3.78194974795284*^9}, {3.7819529187155313`*^9, 3.781952924925744*^9}, {
   3.781952964791218*^9, 3.781952968333682*^9}, 3.781953166500196*^9, {
   3.781953272223571*^9, 3.78195327683786*^9}, {3.78195358381081*^9, 
   3.781953612358754*^9}, {3.781958753255175*^9, 3.781958755598172*^9}, {
   3.781958811917259*^9, 3.781958815787437*^9}, {3.781958926196575*^9, 
   3.7819589264739723`*^9}, {3.781959003155731*^9, 3.781959003337261*^9}, {
   3.781959705790758*^9, 3.7819597464613247`*^9}, {3.781959853020249*^9, 
   3.7819598974828367`*^9}, {3.781959935715353*^9, 3.781959968184641*^9}, {
   3.781960453996724*^9, 3.781960458237152*^9}, {3.781960531842887*^9, 
   3.781960532985331*^9}, {3.781960775806774*^9, 3.7819608414743*^9}, {
   3.7819614409500628`*^9, 3.78196147076506*^9}, {3.781961537294071*^9, 
   3.781961541507621*^9}, {3.781961954980846*^9, 3.7819619554823847`*^9}, {
   3.781962013922822*^9, 3.7819620462490177`*^9}, {3.781962095208321*^9, 
   3.7819621321909933`*^9}, 3.781962236076475*^9, {3.781964532305806*^9, 
   3.781964557480507*^9}, {3.781964883638681*^9, 3.7819648861507063`*^9}, {
   3.781964952001689*^9, 3.7819649694449663`*^9}, {3.78196555777743*^9, 
   3.7819655608808823`*^9}, {3.781966208315856*^9, 3.78196623001517*^9}, {
   3.781967177116397*^9, 3.781967190170854*^9}, {3.78196737755392*^9, 
   3.781967378255289*^9}, {3.7819675055336237`*^9, 3.781967539563953*^9}, {
   3.781967730864592*^9, 3.781967743015132*^9}, {3.781967863854004*^9, 
   3.781967869468959*^9}, {3.781967956067936*^9, 3.781967973370903*^9}, {
   3.781968165676216*^9, 3.7819681659058313`*^9}, {3.781968600608985*^9, 
   3.78196860333549*^9}, {3.781968794388797*^9, 3.781968917352791*^9}, {
   3.781969180046114*^9, 3.781969180347095*^9}, {3.7819693081454906`*^9, 
   3.781969338623695*^9}, {3.7819695907383413`*^9, 3.781969605905559*^9}, {
   3.781969876004993*^9, 3.7819698921147757`*^9}, {3.781970719902026*^9, 
   3.781970736139946*^9}, {3.781970995712369*^9, 3.781971000602717*^9}, {
   3.781971436247281*^9, 3.7819714391894627`*^9}, {3.78197156866698*^9, 
   3.7819715721867456`*^9}, {3.781971647010206*^9, 3.7819717135675697`*^9}, {
   3.781971960364111*^9, 3.7819719702659273`*^9}, {3.781972085889913*^9, 
   3.781972089767919*^9}, {3.781972133327896*^9, 3.781972135878091*^9}, {
   3.7819723249393263`*^9, 3.781972357682006*^9}, {3.781972391185626*^9, 
   3.781972491137691*^9}, {3.78197256833368*^9, 3.781972569469337*^9}, {
   3.7819726553569527`*^9, 3.781972700170808*^9}, {3.781973060631158*^9, 
   3.781973085994631*^9}, {3.781973742727879*^9, 3.781973745719202*^9}, {
   3.7819739354184713`*^9, 3.781973964119685*^9}, {3.78197428741045*^9, 
   3.7819742906487627`*^9}, {3.7819752302231293`*^9, 3.78197531573857*^9}, {
   3.781977135613822*^9, 3.781977175483437*^9}, {3.781977206011313*^9, 
   3.781977315767405*^9}, {3.7819776364540462`*^9, 3.781977681794385*^9}, {
   3.7819777276277857`*^9, 3.781977749681239*^9}, {3.7819781258336267`*^9, 
   3.781978143440089*^9}, {3.781978184376182*^9, 3.78197820347164*^9}, {
   3.781983422426529*^9, 3.78198348698288*^9}, {3.781983537639557*^9, 
   3.781983538181918*^9}, {3.781984236747059*^9, 3.7819842372646627`*^9}, {
   3.7819847998936043`*^9, 3.781984829641018*^9}, {3.781985004598303*^9, 
   3.781985011988597*^9}, {3.781985453091732*^9, 3.781985472235598*^9}, {
   3.781985683367032*^9, 3.7819857166117163`*^9}, {3.78198645594973*^9, 
   3.781986510329571*^9}, {3.782021084678976*^9, 3.78202111526972*^9}, {
   3.782021439646668*^9, 3.782021443101561*^9}, {3.782021479644059*^9, 
   3.782021516611198*^9}, 3.782021568739341*^9, 3.7820218601288843`*^9, {
   3.7820225813362627`*^9, 3.782022584144696*^9}, {3.7820228071457977`*^9, 
   3.782022856880221*^9}, {3.782023259526617*^9, 3.7820232641280603`*^9}, {
   3.782023295895897*^9, 3.782023296077599*^9}, {3.782030475743741*^9, 
   3.782030515004929*^9}, {3.782030583078207*^9, 3.782030583571706*^9}, {
   3.782030769280892*^9, 3.782030771743113*^9}, {3.78203240114464*^9, 
   3.782032413374879*^9}, {3.78203418443826*^9, 3.782034185403325*^9}, {
   3.782034495510458*^9, 3.78203451891656*^9}, {3.782034549157374*^9, 
   3.782034558307582*^9}, {3.7820346189475327`*^9, 3.782034651193652*^9}, {
   3.782034704715548*^9, 3.782034705992672*^9}, {3.782061631507958*^9, 
   3.7820616369861393`*^9}, {3.7820616742438307`*^9, 3.782061674409451*^9}, {
   3.782061993203619*^9, 3.7820619960267353`*^9}, 3.7820621344573803`*^9, {
   3.782474725604278*^9, 3.782474745573226*^9}, {3.782474802641457*^9, 
   3.782474902846077*^9}, 3.786961758478681*^9, {3.787056756395897*^9, 
   3.7870567592885857`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[771]:=",ExpressionUUID->"cf602b6b-ef62-40bd-b6aa-c22d051abe8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"\"\<ShallowDisplayCrystal\>\"", ",", "crystal_String"}], "]"}], ":=", 
  RowBox[{"KeyValueMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#1", "===", "\"\<AtomData\>\""}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"\"\<AtomData\>\"", "\[Rule]", 
        RowBox[{"Shallow", "[", 
         RowBox[{"#2", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"#1", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"$CrystalData", "@", "crystal"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.727506566988821*^9, 
   3.7275065675308313`*^9}, {3.7276035560711937`*^9, 3.72760355630114*^9}, {
   3.7276036304674597`*^9, 3.727603631524433*^9}, 3.727676784104806*^9, {
   3.7340864321506767`*^9, 3.7340865206369267`*^9}, 3.743865456049979*^9, 
   3.762793093722595*^9, 3.786956274496245*^9, {3.786962061484593*^9, 
   3.786962063155972*^9}, {3.786968086928224*^9, 3.786968088255666*^9}, {
   3.8079815316299067`*^9, 3.807981553920987*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[772]:=",ExpressionUUID->"2f0b88f9-42b0-4eb9-b902-f5e1c3eb79d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "InputCheck", "[", "\"\<Update$CrystalDataAutoCompletion\>\"", "]"}], ":=", 
  
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FE`Evaluate", "[", 
       RowBox[{"FEPrivate`AddSpecialArgCompletion", "[", "#", "]"}], "]"}], 
      "&"}], "[", "\[IndentingNewLine]", 
     RowBox[{"\"\<$CrystalData\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Keys", "@", "$CrystalData"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<AtomData\>\"", ",", "\"\<ChemicalFormula\>\"", ",", 
          "\"\<FormulaUnits\>\"", ",", "\[IndentingNewLine]", 
          "\"\<LatticeParameters\>\"", ",", "\"\<Notes\>\"", ",", 
          "\"\<SpaceGroup\>\"", ",", "\"\<Wavelength\>\""}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"$CrystalData", "=", 
     RowBox[{"KeySort", "@", "$CrystalData"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Keys", "@", "$CrystalData"}]}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730395241910015*^9, 3.730395331782501*^9}, 
   3.73039551088382*^9, {3.7391249707350397`*^9, 3.739124986130555*^9}, {
   3.73912511330057*^9, 3.739125114641823*^9}, {3.739125407092436*^9, 
   3.7391254219192133`*^9}, {3.7391254965873337`*^9, 3.739125499857193*^9}, {
   3.739125656582911*^9, 3.739125666230063*^9}, 3.762793093803693*^9, {
   3.774162380224619*^9, 3.774162443711708*^9}, {3.774162492160576*^9, 
   3.7741625078046293`*^9}, {3.774163362510076*^9, 3.774163379723818*^9}, 
   3.78791911611233*^9, 3.78791924224485*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[773]:=",ExpressionUUID->"14cd5c76-b1bf-4c46-b65f-d9ef25dcfc49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "[", 
    RowBox[{
    "\"\<Update$CrystalDataFile\>\"", ",", "\[IndentingNewLine]", 
     "dataFile_String", ",", "newStructureLabel_String", ",", "hostCopy_"}], 
    "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "dataFile"}]}], ",", 
       RowBox[{"$CrystalData", "=", 
        RowBox[{"<|", "|>"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"$CrystalData", ",", 
       RowBox[{"newStructureLabel", "\[Rule]", "hostCopy"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "InputCheck", "[", "\"\<Update$CrystalDataAutoCompletion\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"dataFile", ",", "$CrystalData"}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730395241910015*^9, 3.730395331782501*^9}, 
   3.73039551088382*^9, {3.7391249707350397`*^9, 3.739124986130555*^9}, {
   3.73912511330057*^9, 3.739125114641823*^9}, {3.739125407092436*^9, 
   3.7391254219192133`*^9}, {3.7391254965873337`*^9, 3.739125499857193*^9}, {
   3.739125656582911*^9, 3.739125666230063*^9}, 3.762793093803693*^9, {
   3.774162380224619*^9, 3.774162443711708*^9}, {3.774162492160576*^9, 
   3.7741625078046293`*^9}, {3.774163362510076*^9, 3.774163379723818*^9}, {
   3.7879191045774097`*^9, 3.787919188054097*^9}, {3.78791922146912*^9, 
   3.787919240806135*^9}, {3.7879204441162577`*^9, 3.787920445409892*^9}, {
   3.787920567072339*^9, 3.78792056829576*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[774]:=",ExpressionUUID->"d5994e4c-9334-44de-8d3c-fad0df1ab3bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[775]:=",ExpressionUUID->"b5690650-47cc-4f7f-8fd0-79b6194bf59c"]
}, Closed]],

Cell[CellGroupData[{

Cell["InterplanarSpacing", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.715064144253417*^9, 3.71506414748868*^9}, {
   3.715064231136232*^9, 3.715064235741983*^9}, 3.71532668875773*^9, {
   3.756713314303834*^9, 
   3.7567133153914223`*^9}},ExpressionUUID->"f3b3c622-e230-41ee-af97-\
3c1c4245dc22"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[776]:=",ExpressionUUID->"b6907bbc-e623-449b-958e-105e2dd42fce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "InterplanarSpacing"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "InterplanarSpacing"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, 
   3.715064183906497*^9, {3.715078876499865*^9, 3.715078880193625*^9}, {
   3.756713328817588*^9, 3.756713331283366*^9}, 3.756716315067555*^9},
 CellLabel->
  "In[777]:=",ExpressionUUID->"eb867074-36f0-48e8-b827-87d016459f91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[779]:=",ExpressionUUID->"2b191e5f-0c6f-4eb3-a13a-ef07e61f4f22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterplanarSpacing", "[", 
   RowBox[{"input_", ",", "reflections_List", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hkl", ",", "H", ",", "d", ",", "h"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "reflection"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "reflections", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reciprocal", " ", "metric"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"GetCrystalMetric", "[", 
       RowBox[{"input", ",", 
        RowBox[{"\"\<Space\>\"", "\[Rule]", "\"\<Reciprocal\>\""}]}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Interplanar", " ", "distance"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "=", 
            RowBox[{
            "hkl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", "\[IndentingNewLine]", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"h", ".", "H", ".", "h"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "hkl"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Quantity", "[", 
         RowBox[{"d", ",", "\"\<Angstroms\>\""}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "only", " ", "one", " ", "reflection"}], ",", " ", 
       RowBox[{"return", " ", "content"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "d"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"First", "@", "d"}], ",", "d"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.7150641849014177`*^9, 
   3.715064208336918*^9}, 3.715078883076619*^9, {3.715078913508091*^9, 
   3.715078913682675*^9}, {3.715079164837681*^9, 3.7150791802962923`*^9}, {
   3.7150792131352386`*^9, 3.715079215811734*^9}, {3.7150805829910393`*^9, 
   3.715080601633729*^9}, {3.7153143538431253`*^9, 3.715314619337658*^9}, {
   3.71531482604503*^9, 3.715314858601492*^9}, 3.717740920731542*^9, {
   3.730543614674137*^9, 3.730543615290286*^9}, {3.730544530561977*^9, 
   3.730544530964417*^9}, 3.73796846805212*^9, {3.758530050721332*^9, 
   3.758530055222497*^9}, {3.759519490947288*^9, 3.759519493049049*^9}, 
   3.7627930938182793`*^9, {3.763741064865443*^9, 3.7637411062861633`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[780]:=",ExpressionUUID->"14ee5404-c1c8-47a7-a008-3a9ebf18f057"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[781]:=",ExpressionUUID->"d5451137-81d9-457b-8890-1c2a0fd5fe3c"]
}, Closed]],

Cell[CellGroupData[{

Cell["MergeSymmetryEquivalentReflections", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.682754675215427*^9, 3.682754677485675*^9}, {
   3.6827632401424837`*^9, 3.682763247126801*^9}, 3.682763763856205*^9, 
   3.6827638067251377`*^9, 
   3.730106310308416*^9},ExpressionUUID->"f64fec24-f11c-42f8-b8dc-\
d5a31e02a91a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[782]:=",ExpressionUUID->"b3c2eb7e-faeb-4dc6-97bc-6a564728f04a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "MergeSymmetryEquivalentReflections"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<ToStandardSetting\>\"", "\[Rule]", "True"}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "MergeSymmetryEquivalentReflections"}], 
   "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7301063103200483`*^9, {3.756716371852663*^9, 3.756716389629332*^9}},
 CellLabel->
  "In[783]:=",ExpressionUUID->"386da9ef-ba20-4473-8152-bd1bf7ea856c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[785]:=",ExpressionUUID->"41d234c1-6be4-41e0-a580-d6ea481ac266"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MergeSymmetryEquivalentReflections", "[", 
   RowBox[{"group_String", ",", "hkl_List", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"input", ",", "sg", ",", "merged"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"input", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"hkl", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GetPointSpaceGroupCrystal\>\"", ",", "group"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Consider", " ", "duplicate", " ", "if", " ", "they", " ", "generate", 
       " ", "same", " ", "symmetry", " ", "equivalents"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"merged", "=", 
      RowBox[{"DeleteDuplicatesBy", "[", 
       RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Sort", "@", 
          RowBox[{"SymmetryEquivalentReflections", "[", 
           RowBox[{"sg", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Use", " ", "standard", " ", "setting", " ", "on", " ", "indices"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ToStandardSetting\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ToStandardSetting", "[", 
          RowBox[{"sg", ",", "#"}], "]"}], "&"}], "/@", "merged"}], ",", 
       "\[IndentingNewLine]", "\t", "merged"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.682682345535097*^9, 3.682682347997387*^9}, {
   3.682754890045689*^9, 3.682754900136516*^9}, {3.682754952296125*^9, 
   3.682755022164933*^9}, {3.682755115621669*^9, 3.6827551535141687`*^9}, {
   3.682755192899743*^9, 3.682755204616169*^9}, {3.682755483075945*^9, 
   3.682755572184518*^9}, {3.682755620936475*^9, 3.68275570339452*^9}, {
   3.682755785197132*^9, 3.6827558328591137`*^9}, {3.682755872957996*^9, 
   3.682755929888302*^9}, {3.6827560172459*^9, 3.68275608066227*^9}, {
   3.6827561903761797`*^9, 3.682756208255334*^9}, {3.682756341293084*^9, 
   3.682756435807774*^9}, {3.682756481562601*^9, 3.6827566171437607`*^9}, {
   3.6827571356319447`*^9, 3.68275715086217*^9}, {3.682757193154983*^9, 
   3.682757204761051*^9}, {3.682757287045686*^9, 3.6827573748421717`*^9}, {
   3.6827574428815193`*^9, 3.682757463459453*^9}, {3.6827575865280647`*^9, 
   3.682757600041594*^9}, {3.6827576521824217`*^9, 3.682757654103991*^9}, {
   3.682757736488762*^9, 3.68275776848295*^9}, {3.682757872746702*^9, 
   3.682757878996653*^9}, {3.682760893290402*^9, 3.682760919442278*^9}, {
   3.682761050069873*^9, 3.6827610875022707`*^9}, {3.682761344440157*^9, 
   3.6827613948805656`*^9}, {3.682761467533331*^9, 3.6827614906040382`*^9}, {
   3.682761599041744*^9, 3.6827616051249332`*^9}, {3.682761640140191*^9, 
   3.682761640269712*^9}, {3.6827632705416527`*^9, 3.682763272313184*^9}, {
   3.6827634698943243`*^9, 3.682763491297275*^9}, 3.682763560088398*^9, {
   3.682763672646283*^9, 3.682763703768117*^9}, 3.682763765769903*^9, {
   3.6827638097007027`*^9, 3.682763841562532*^9}, {3.682764002267891*^9, 
   3.682764060609202*^9}, {3.682764092437544*^9, 3.682764093948495*^9}, {
   3.682764145109967*^9, 3.682764153463393*^9}, {3.682764193547503*^9, 
   3.682764223520398*^9}, {3.682764299751896*^9, 3.682764385964645*^9}, {
   3.68276443988243*^9, 3.6827644490889807`*^9}, {3.682764497839053*^9, 
   3.68276451442174*^9}, {3.682764590085518*^9, 3.682764666566125*^9}, {
   3.682764709108004*^9, 3.682764713033717*^9}, {3.682764803156188*^9, 
   3.682764805193653*^9}, {3.682764858920453*^9, 3.68276487123205*^9}, {
   3.6827650306638536`*^9, 3.682765032106743*^9}, {3.682765077128017*^9, 
   3.682765114630002*^9}, {3.682765148933024*^9, 3.682765156919944*^9}, {
   3.6827677197030478`*^9, 3.682767720010531*^9}, {3.683604340403654*^9, 
   3.6836043529073563`*^9}, {3.684139656863722*^9, 3.68413966623372*^9}, {
   3.684213591199651*^9, 3.68421359766739*^9}, 3.68423542388873*^9, {
   3.684494231046241*^9, 3.6844942328843927`*^9}, {3.6846687766667967`*^9, 
   3.684668833479196*^9}, {3.6850821810967503`*^9, 3.685082181896227*^9}, 
   3.685084049591119*^9, {3.685301853914551*^9, 3.6853018858709908`*^9}, {
   3.685301957111362*^9, 3.6853019648610888`*^9}, {3.685301997069955*^9, 
   3.68530212067407*^9}, {3.685302176210725*^9, 3.685302185680876*^9}, {
   3.685302454443644*^9, 3.685302484386928*^9}, {3.685302801397314*^9, 
   3.6853028247972393`*^9}, {3.6853028602362013`*^9, 3.685302902395097*^9}, {
   3.685331251904861*^9, 3.6853312646170473`*^9}, {3.6853312960267057`*^9, 
   3.6853313204691477`*^9}, {3.685331539879148*^9, 3.685331677385861*^9}, {
   3.685331889662311*^9, 3.685332001364971*^9}, {3.685332031404345*^9, 
   3.6853320318833237`*^9}, {3.685332097919066*^9, 3.68533210035004*^9}, {
   3.6853321321988993`*^9, 3.685332135240776*^9}, {3.685332208432933*^9, 
   3.685332251093843*^9}, {3.685332353259377*^9, 3.685332354313655*^9}, {
   3.685334186433942*^9, 3.685334188848311*^9}, {3.6853342830532503`*^9, 
   3.685334343176944*^9}, {3.685351973845551*^9, 3.6853519796240673`*^9}, {
   3.6853837611243258`*^9, 3.685383766849927*^9}, {3.685697704820434*^9, 
   3.6856977220768137`*^9}, {3.6856980151258297`*^9, 3.685698042947495*^9}, {
   3.6856981446843*^9, 3.685698153416366*^9}, {3.685770338473489*^9, 
   3.685770340565543*^9}, 3.685777919630587*^9, {3.685784957125655*^9, 
   3.685784959319334*^9}, {3.685785897727392*^9, 3.6857859357454*^9}, 
   3.685786625994659*^9, {3.713078853682228*^9, 3.71307892925729*^9}, {
   3.7130795040128727`*^9, 3.7130795045791473`*^9}, {3.71308394897624*^9, 
   3.713083949446762*^9}, {3.714456574367063*^9, 3.714456601006489*^9}, {
   3.714456780323517*^9, 3.714456781803543*^9}, {3.7144569909110603`*^9, 
   3.7144570019091177`*^9}, {3.714457188425292*^9, 3.714457211242263*^9}, {
   3.717224340099481*^9, 3.717224347072815*^9}, {3.7172244383366337`*^9, 
   3.717224443766733*^9}, {3.717740920803213*^9, 3.717740920811776*^9}, {
   3.7276752143072567`*^9, 3.7276752342186823`*^9}, {3.730106310331801*^9, 
   3.730106310339879*^9}, 3.730209956777421*^9, {3.730544545611946*^9, 
   3.730544546560378*^9}, {3.759519503043082*^9, 3.759519503289688*^9}, 
   3.762793093831913*^9, {3.7869685698779182`*^9, 3.7869685711262827`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[786]:=",ExpressionUUID->"aa7980cb-ddbf-4131-9242-3309a40ad69c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[787]:=",ExpressionUUID->"eae3acf8-df79-4faf-b7c1-4384e9d7a257"]
}, Closed]],

Cell[CellGroupData[{

Cell["MillerNotationToList", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9},ExpressionUUID->"4c3a872b-a347-4ddf-ae84-\
469d58b5aaae"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[788]:=",ExpressionUUID->"01ccc289-a163-423d-8462-61f8362cef7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "MillerNotationToList"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "_", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756716439999579*^9, 3.756716444405992*^9}},
 CellLabel->
  "In[789]:=",ExpressionUUID->"6d95c014-779b-4479-b742-967b04283aff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[790]:=",ExpressionUUID->"ef67a78c-01b7-4a8d-b24a-10dafd97d429"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MillerNotationToList", "[", "input_String", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L", ",", "R", ",", "temp", ",", "split"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Removing", " ", "overbars"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"L", "=", "\"\<\\!\\(\\*OverscriptBox[\\(\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", "\"\<\\), \\(_\\)]\\)\>\""}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"input", ",", 
        RowBox[{
         RowBox[{"L", "~~", 
          RowBox[{"Shortest", "@", "x__"}], "~~", "R"}], "\[RuleDelayed]", 
         RowBox[{
         "\"\<|\>\"", "<>", "\"\<-\>\"", "<>", "x", "<>", "\"\<|\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Separating", " ", "indices"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Sign", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", ":", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "\"\<-\>\"", ",", "\"\<|\>\""}], "}"}]}],
           "~~", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Letters", " ", "are", " ", "not", " ", "joined", " ", "with", 
             " ", "digits"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x", ":", "LetterCharacter"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Digits", " ", "could", " ", "be", " ", "joined"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"d", ":", "DigitCharacter"}], "~~", 
             "\[IndentingNewLine]", 
             RowBox[{"y", ":", 
              RowBox[{"Shortest", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<|\>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"DigitCharacter", ".."}], "~~", 
                  RowBox[{"{", 
                   RowBox[{"\"\<,\>\"", ",", "\"\<|\>\"", ",", "\"\<)\>\""}], 
                   "}"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[RuleDelayed]", 
         RowBox[{
         "\"\<|\>\"", "<>", "s", "<>", "x", "<>", "d", "<>", "y", "<>", 
          "\"\<|\>\""}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"\"\<|\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"temp", ",", "\"\<,\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", 
        RowBox[{"Positive", " ", "single", " ", 
         RowBox[{"digits", "/", "letters"}], " ", "only"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", 
      StyleBox["[", "Code"], 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "temp"}], "<", "3"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"temp", ",", 
           RowBox[{
            RowBox[{"x", ":", "WordCharacter"}], "\[RuleDelayed]", "x"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"{", "}"}]}], "]"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Trimming", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "Null", ",", "\"\<{}\>\""}], "}"}], ",", 
           "x"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "not", " ", "three", " ", "entires"}], ",", " ", 
       RowBox[{"split", " ", "digits"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"split", "[", "x_", "]"}], ":=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
            RowBox[{"p", "~~", "n"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n1", ":", "DigitCharacter"}], "~~", 
             RowBox[{"n2", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2"}], "}"}]}]}], "\[IndentingNewLine]", 
          "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"temp", "/.", 
       RowBox[{
        RowBox[{"x_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "x", "]"}], "<", "3"}]}], "\[RuleDelayed]", 
        RowBox[{"split", "[", "x", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Setting", " ", "numbers", " ", "as", " ", "experssions"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "/.", 
      RowBox[{
       RowBox[{"x_String", "/;", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"x", ",", "DigitCharacter"}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"ToExpression", "[", "x", "]"}]}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.71265181170818*^9, 3.71265184851582*^9}, {
   3.712652095518579*^9, 3.712652257498863*^9}, 3.71265239748778*^9, {
   3.71265244571208*^9, 3.7126524481825333`*^9}, {3.7126526553150253`*^9, 
   3.71265266634685*^9}, {3.7126544272990713`*^9, 3.7126544608744907`*^9}, {
   3.712654491008285*^9, 3.712654513440096*^9}, {3.712654550942759*^9, 
   3.712654670547868*^9}, {3.712654703821003*^9, 3.712654741083172*^9}, {
   3.7126572447956333`*^9, 3.71265724552361*^9}, {3.7126573384427958`*^9, 
   3.712657409919541*^9}, {3.712657442783066*^9, 3.7126575394046917`*^9}, {
   3.712657574141005*^9, 3.712657877853153*^9}, {3.712657916505589*^9, 
   3.712657926412139*^9}, {3.712657958155428*^9, 3.7126580079624166`*^9}, {
   3.712658051969553*^9, 3.712658055873343*^9}, {3.71265910828284*^9, 
   3.712659135617361*^9}, {3.7126592131276484`*^9, 3.71265921347163*^9}, {
   3.712659259014515*^9, 3.7126594153067408`*^9}, {3.7126594508836*^9, 
   3.712659478377791*^9}, {3.7126595314564962`*^9, 3.7126595319043083`*^9}, {
   3.712659580336278*^9, 3.712659593718773*^9}, {3.71265962760645*^9, 
   3.712659696409937*^9}, {3.712659779410568*^9, 3.712659796570158*^9}, {
   3.7127232179121027`*^9, 3.712723229072281*^9}, {3.712723277198616*^9, 
   3.712723280222929*^9}, 3.7127233136458893`*^9, {3.712723486689425*^9, 
   3.7127235463119698`*^9}, {3.712723798706465*^9, 3.7127238719521513`*^9}, {
   3.712723903031745*^9, 3.712724002493475*^9}, {3.712724277432616*^9, 
   3.712724372844721*^9}, {3.7127244033803263`*^9, 3.7127245266898813`*^9}, {
   3.712724809955243*^9, 3.712724840289219*^9}, {3.712724885592177*^9, 
   3.712724888296068*^9}, {3.7127251133317757`*^9, 3.7127251193874807`*^9}, {
   3.712725321551262*^9, 3.7127254430142107`*^9}, {3.712725492618681*^9, 
   3.71272563230217*^9}, {3.712725684446393*^9, 3.712725711940311*^9}, {
   3.7127257433872843`*^9, 3.71272585209263*^9}, {3.712725885065549*^9, 
   3.71272600940621*^9}, {3.712726073572926*^9, 3.712726127066513*^9}, {
   3.712726177392968*^9, 3.712726178104968*^9}, {3.71272621473763*^9, 
   3.712726243943431*^9}, {3.712726332173551*^9, 3.712726360589281*^9}, {
   3.712726422612451*^9, 3.712726423847527*^9}, {3.712726521650385*^9, 
   3.71272659331116*^9}, {3.712726652214963*^9, 3.712726742067371*^9}, {
   3.712727206140136*^9, 3.7127272078411407`*^9}, {3.7127272390958357`*^9, 
   3.712727247711342*^9}, 3.712727323335806*^9, {3.712727411252993*^9, 
   3.7127274113952227`*^9}, {3.712727598072218*^9, 3.712727698157626*^9}, {
   3.712727740709833*^9, 3.7127277633311167`*^9}, {3.712727795986257*^9, 
   3.712727876712543*^9}, {3.7127280099270153`*^9, 3.71272801297314*^9}, {
   3.7172312671661167`*^9, 3.717231282002515*^9}, {3.7172313463954897`*^9, 
   3.717231376033064*^9}, {3.717231406601571*^9, 3.717231452543467*^9}, {
   3.7172316471403503`*^9, 3.7172316547383347`*^9}, {3.717231691578803*^9, 
   3.717231701833466*^9}, {3.7172317522655582`*^9, 3.717231761664892*^9}, {
   3.717231804824963*^9, 3.717231842701837*^9}, {3.71723209703476*^9, 
   3.717232117511814*^9}, {3.717232160832486*^9, 3.7172323308668337`*^9}, {
   3.7172323846671267`*^9, 3.717232387569281*^9}, {3.717232420625662*^9, 
   3.717232442809225*^9}, {3.717232480177041*^9, 3.717232486886738*^9}, {
   3.71723254374341*^9, 3.7172325701171293`*^9}, {3.71723271350712*^9, 
   3.717232736193582*^9}, {3.7172328302000628`*^9, 3.717232858494359*^9}, 
   3.7379684244868317`*^9, 3.76279309385152*^9, {3.7634624088251143`*^9, 
   3.763462410337265*^9}, {3.763462812791168*^9, 3.763462815249075*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[791]:=",ExpressionUUID->"70b818eb-25e5-41bf-94be-d99a44896988"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[792]:=",ExpressionUUID->"a1ffb2b5-15cf-4858-a940-95332ad327f3"]
}, Closed]],

Cell[CellGroupData[{

Cell["MillerNotationToString", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9},ExpressionUUID->"e873f727-ba99-437d-bb17-\
4d9433c08831"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[793]:=",ExpressionUUID->"6188fb4d-e03d-4a5c-8ecb-d45801c05ffb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MillerNotationToString", "::", "inv"}], "=", 
    "\"\<Invalid index input \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "MillerNotationToString"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7452232741050367`*^9, 3.745223276614665*^9}, {
  3.745223451212205*^9, 3.745223460081909*^9}, {3.756716474719448*^9, 
  3.75671649260288*^9}},
 CellLabel->
  "In[794]:=",ExpressionUUID->"c0668719-3ee1-4e67-9973-47c133b40c76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[796]:=",ExpressionUUID->"d92f159f-d7f1-4afd-92c5-4e0d91d15f93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MillerNotationToString", "[", "inputRaw_List", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "L", ",", "R", ",", "quit", ",", "i", ",", "H", ",", "index", ",", 
      RowBox[{"input", "=", "inputRaw"}], ",", "presentation", ",", 
      "output"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"InputCheck", "@", "inputRaw"}], ",", 
       RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Shortcuts", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"L", "=", "\"\<\\!\\(\\*OverscriptBox[\\(\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", "\"\<\\), \\(_\\)]\\)\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"quit", "[", "index_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"MillerNotationToString", "::", "inv"}], ",", "index"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Pre", "-", 
       RowBox[{"processing", " ", "input"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"input", "=", 
      RowBox[{"input", "/.", 
       RowBox[{
        RowBox[{"x_String", "/;", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"x", ",", "\"\<-\>\""}], "]"}]}], "\[RuleDelayed]", 
        "\[IndentingNewLine]", 
        RowBox[{"-", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"x", ",", "\"\<-\>\""}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Converting", " ", "to", " ", "string", " ", "with", " ", "overbar", 
       " ", "if", " ", "negative"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"index", "=", 
         RowBox[{
         "input", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"IntegerQ", "@", "index"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"index", "<", "0"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"H", ",", 
              RowBox[{"L", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"-", "index"}], "]"}], "<>", "R"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"H", ",", 
              RowBox[{"ToString", "@", "index"}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringQ", "@", "index"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "@", "index"}], "\[NotEqual]", "1"}], 
            ",", 
            RowBox[{"quit", "[", "index", "]"}], ",", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"H", ",", "index"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Head", "[", "index", "]"}], "===", "Real"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"H", ",", 
            RowBox[{"ToString", "@", "index"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Head", "[", "index", "]"}], "===", "Times"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "index", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"StringQ", "@", 
               RowBox[{
               "index", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringLength", "@", 
                RowBox[{
                "index", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "\[NotEqual]", "1"}], ",", 
              RowBox[{"quit", "[", "index", "]"}], ",", "\[IndentingNewLine]",
               "\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"H", ",", 
                RowBox[{"L", "<>", 
                 RowBox[{
                 "index", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "<>", "R"}]}], "]"}]}], "]"}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"quit", "[", "index", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"quit", "[", "index", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Presentation", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"presentation", "=", 
      RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"H", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "<>", "\"\<|\>\"", "<>", 
        RowBox[{"H", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "<>", "\"\<|\>\"", "<>", 
        RowBox[{"H", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "<>", "\"\<)\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Only", " ", "remove", " ", "commas", " ", "for", " ", "single", " ", 
       "digit", " ", "integers"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"input", ",", "NumericQ"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Abs", "[", "#", "]"}], "\[LessEqual]", "9"}], ")"}], "&&", 
           RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"StringDelete", "[", 
         RowBox[{"presentation", ",", "\"\<|\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"presentation", ",", 
          RowBox[{"\"\<|\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "input"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, 3.685686496167932*^9, {3.6856944477863503`*^9, 
   3.68569446921675*^9}, {3.685694605238812*^9, 3.6856946062341757`*^9}, {
   3.685695893282233*^9, 3.685695896451762*^9}, {3.6856960214137506`*^9, 
   3.6856960251722317`*^9}, {3.687521359980748*^9, 3.687521435237295*^9}, {
   3.6875214687991743`*^9, 3.687521494623404*^9}, {3.6876768933160543`*^9, 
   3.687676910356525*^9}, {3.712650700261273*^9, 3.7126507027975063`*^9}, {
   3.7126508246994467`*^9, 3.7126508373862047`*^9}, {3.712650880057147*^9, 
   3.71265091066479*^9}, {3.712650944551971*^9, 3.712650951383466*^9}, {
   3.712651061181072*^9, 3.7126510654943533`*^9}, {3.71265113385168*^9, 
   3.712651134019478*^9}, {3.7126512882721786`*^9, 3.712651310583632*^9}, {
   3.712651420262867*^9, 3.712651422476676*^9}, 3.717740919994548*^9, 
   3.737968267347493*^9, {3.745222099337564*^9, 3.7452221260403023`*^9}, {
   3.745222196932884*^9, 3.7452222408157177`*^9}, {3.745222627190054*^9, 
   3.745222770544285*^9}, {3.745222809765418*^9, 3.745222818340452*^9}, {
   3.74522294956068*^9, 3.7452230106142282`*^9}, {3.745223471259536*^9, 
   3.745223526338607*^9}, {3.7452236006883802`*^9, 3.745223608369892*^9}, {
   3.745223642571735*^9, 3.745223665435327*^9}, {3.745223714074592*^9, 
   3.745223864250751*^9}, {3.74522392889231*^9, 3.745223948208666*^9}, {
   3.745223983821549*^9, 3.7452239988039722`*^9}, {3.745224103043028*^9, 
   3.745224128284939*^9}, {3.745224298694689*^9, 3.745224359705023*^9}, {
   3.7452244082811823`*^9, 3.74522441139579*^9}, {3.7452253089840384`*^9, 
   3.745225332402544*^9}, {3.7585300567871923`*^9, 3.7585300843373938`*^9}, 
   3.762793093868976*^9, {3.766126766278082*^9, 3.766126808453929*^9}, {
   3.7661274302733803`*^9, 3.7661274425656853`*^9}, {3.766127480213307*^9, 
   3.76612756937678*^9}, {3.7661277506099787`*^9, 3.766127778797772*^9}, {
   3.7661278101922617`*^9, 3.766127853358006*^9}, {3.766127928407651*^9, 
   3.76612795700607*^9}, {3.766128011852723*^9, 3.766128073596681*^9}, {
   3.7661281136766233`*^9, 3.766128113981777*^9}, {3.774181399949686*^9, 
   3.7741814146601887`*^9}, {3.786968581302431*^9, 3.7869685823729362`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[797]:=",ExpressionUUID->"66b82719-6bd5-4811-a86a-8d22a1b68f6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MillerNotationToString", "[", "input_String", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"MillerNotationToString", "@", 
   RowBox[{"MillerNotationToList", "@", "input"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, 3.685686496167932*^9, {3.6856944477863503`*^9, 
   3.68569446921675*^9}, {3.685694605238812*^9, 3.6856946062341757`*^9}, {
   3.685695893282233*^9, 3.685695896451762*^9}, {3.6856960214137506`*^9, 
   3.6856960251722317`*^9}, {3.687521359980748*^9, 3.687521435237295*^9}, {
   3.6875214687991743`*^9, 3.687521494623404*^9}, {3.6876768933160543`*^9, 
   3.687676910356525*^9}, {3.712650700261273*^9, 3.7126507027975063`*^9}, {
   3.7126508246994467`*^9, 3.7126508373862047`*^9}, {3.712650880057147*^9, 
   3.71265091066479*^9}, {3.712650944551971*^9, 3.712650951383466*^9}, {
   3.712651061181072*^9, 3.7126510654943533`*^9}, {3.71265113385168*^9, 
   3.712651134019478*^9}, {3.7126512882721786`*^9, 3.712651310583632*^9}, {
   3.712651420262867*^9, 3.712651422476676*^9}, 3.717740919994548*^9, 
   3.737968267347493*^9, {3.745222099337564*^9, 3.7452221260403023`*^9}, {
   3.745222196932884*^9, 3.7452222408157177`*^9}, {3.745222627190054*^9, 
   3.745222770544285*^9}, {3.745222809765418*^9, 3.745222818340452*^9}, {
   3.74522294956068*^9, 3.7452230106142282`*^9}, {3.745223471259536*^9, 
   3.745223526338607*^9}, {3.7452236006883802`*^9, 3.745223608369892*^9}, {
   3.745223642571735*^9, 3.745223665435327*^9}, {3.745223714074592*^9, 
   3.745223864250751*^9}, {3.74522392889231*^9, 3.745223948208666*^9}, {
   3.745223983821549*^9, 3.7452239988039722`*^9}, {3.745224103043028*^9, 
   3.745224128284939*^9}, {3.745224298694689*^9, 3.745224359705023*^9}, {
   3.7452244082811823`*^9, 3.74522441139579*^9}, {3.7452253089840384`*^9, 
   3.745225332402544*^9}, {3.7585300567871923`*^9, 3.7585300843373938`*^9}, 
   3.762793093868976*^9, {3.766126227299178*^9, 3.766126249079227*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[798]:=",ExpressionUUID->"deaf7f6b-35b3-43ac-8f87-c138ce27eeb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[799]:=",ExpressionUUID->"32ae7306-3753-41f2-9a1d-315e4e812d95"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReciprocalImageCheck", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.6678188399987793`*^9, 3.667818878319042*^9}, {
   3.667818936985889*^9, 3.667818938625092*^9}, 3.667819218919221*^9, {
   3.668104207926056*^9, 3.668104209242962*^9}, 3.687243315679677*^9, 
   3.6878672655456343`*^9, {3.7138707345449533`*^9, 3.713870750699418*^9}, 
   3.715852050034526*^9},ExpressionUUID->"1b5614bc-f256-4014-8e72-\
a23bdd2c09ad"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[25]:=",ExpressionUUID->"92752548-c592-47a2-b4bf-b148cded7cd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "file"}], "=", 
   "\"\<Input file was not found.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "method"}], "=", 
   "\"\<The method \[LeftGuillemet]`1`\[RightGuillemet] was not recognised.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "system"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid lattice system.\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "angles"}], "=", 
   "\"\<Invalid angle input for the given system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "threshold"}], "=", 
   "\"\<`1` reflection`2` outside the threshold for integer \
determination.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "all"}], "=", 
   "\"\<All reflections were inside the threshold for integer \
determination.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "ambiguous"}], "=", 
   "\"\<Ambiguous image orientation. Use different correspondence \
points.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "data"}], "=", 
   "\"\<At least two data points are required.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "grid"}], "=", 
   "\"\<The option \[LeftGuillemet]ShowLattice\[RightGuillemet] must either \
be set to \[LeftGuillemet]True\[RightGuillemet] or a non-negative \
integer.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "InvalidLatticeOrigin"}], "=", 
   "\"\<Lattice origin must be a list of two integers or \
\\\"Center\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalImageCheck", "::", "InvalidLatticeParameters"}], "=", 
   "\"\<The lattice must be a 2\[Times]2 matrix and the origin coordinates \
numeric.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReciprocalImageCheck", "::", "InvalidPlaneDescriptor"}], "=", 
    "\"\<The plane descriptor must be a vector with two miller indices (\\\"h\
\\\", \\\"k\\\", \\\"l\\\") and one constant; \[LeftGuillemet]`1`\
\[RightGuillemet] was provided.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ReciprocalImageCheck"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"FindPixelClusters", " ", "options"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ClearStatus\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Plot", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"ReciprocalImageCheck", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<BackgroundImage\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Colours\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ColorData", "[", 
         RowBox[{"97", ",", "2"}], "]"}], ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"97", ",", "1"}], "]"}], ",", "LightGray"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<CountNonInteger\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<LatticeOrigin\>\"", "\[Rule]", "\"\<Center\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnLatticeData\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<RoundPixels\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ShowLattice\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<StoreDataTemporarily\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Threshold\>\"", "\[Rule]", "0.15"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<TooltipStyle\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Courier New\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, {3.6678192645731707`*^9, 3.667819270555752*^9}, {
   3.6679268272189693`*^9, 3.667926827530929*^9}, {3.667926865314499*^9, 
   3.667926879234667*^9}, {3.667932793543994*^9, 3.6679327970955763`*^9}, 
   3.667932835740869*^9, {3.667932872004774*^9, 3.667932872923719*^9}, {
   3.667933478854928*^9, 3.6679334921815147`*^9}, {3.667937136249467*^9, 
   3.66793713683991*^9}, {3.667938254326214*^9, 3.667938259486877*^9}, {
   3.667939157392975*^9, 3.6679391759273643`*^9}, {3.6679395892626457`*^9, 
   3.6679396251018553`*^9}, {3.6679396662931337`*^9, 3.66793967041187*^9}, {
   3.667969062724923*^9, 3.6679690866593513`*^9}, {3.667971558545974*^9, 
   3.667971570791375*^9}, {3.66797175965112*^9, 3.667971761018065*^9}, 
   3.667973400059704*^9, 3.667980455575898*^9, 3.667990364351841*^9, 
   3.6679914744706078`*^9, {3.667995091765997*^9, 3.6679950981728687`*^9}, {
   3.667995848573064*^9, 3.667995849419979*^9}, {3.6680190786132174`*^9, 
   3.668019095188184*^9}, {3.668020053716372*^9, 3.668020060218075*^9}, {
   3.6680201410335283`*^9, 3.668020151647107*^9}, {3.668057763273326*^9, 
   3.668057801302511*^9}, {3.668058628257262*^9, 3.6680586519993153`*^9}, 
   3.6680586831987753`*^9, {3.668059310968914*^9, 3.668059345638503*^9}, {
   3.6680593969584103`*^9, 3.66805941238801*^9}, {3.668059512633687*^9, 
   3.6680595196012506`*^9}, {3.6680596063927727`*^9, 3.668059614803205*^9}, {
   3.6680982548367653`*^9, 3.668098258731867*^9}, 3.6681034770498257`*^9, 
   3.6681434966601543`*^9, {3.6695197388121567`*^9, 3.669519739484033*^9}, 
   3.6695198100421457`*^9, {3.6703497772124653`*^9, 3.6703497791230783`*^9}, {
   3.670349812772047*^9, 3.670349826517558*^9}, {3.671389215213585*^9, 
   3.671389249836089*^9}, {3.671389297045927*^9, 3.671389306618927*^9}, {
   3.6719110883031588`*^9, 3.6719110885974483`*^9}, {3.687165575358741*^9, 
   3.687165638515873*^9}, {3.687507491201261*^9, 3.6875075124540987`*^9}, {
   3.687507570577013*^9, 3.68750761179244*^9}, {3.687512071516636*^9, 
   3.687512097815074*^9}, {3.687514871153606*^9, 3.687514874756731*^9}, {
   3.687514973533998*^9, 3.687515013595488*^9}, {3.687520393077942*^9, 
   3.687520407914579*^9}, {3.687521238012498*^9, 3.687521257345623*^9}, {
   3.687865768052176*^9, 3.687865768352976*^9}, {3.6878659560830936`*^9, 
   3.687865975589882*^9}, 3.687866368125998*^9, {3.688100200710231*^9, 
   3.6881002081876507`*^9}, {3.688100604833289*^9, 3.6881006099071083`*^9}, {
   3.688107997969265*^9, 3.6881080214126472`*^9}, {3.688108400184894*^9, 
   3.6881084154348392`*^9}, {3.6881280727953053`*^9, 
   3.6881281273768167`*^9}, {3.688128294183939*^9, 3.688128294543211*^9}, {
   3.688191590995892*^9, 3.688191597523514*^9}, {3.6881975513508463`*^9, 
   3.688197562958654*^9}, 3.688284217856106*^9, {3.688889672275766*^9, 
   3.688889672421276*^9}, {3.714201028367544*^9, 3.714201029342231*^9}, {
   3.7142020649596653`*^9, 3.71420209340727*^9}, {3.714202883384715*^9, 
   3.7142029121766233`*^9}, {3.715336114709093*^9, 3.7153361213929033`*^9}, {
   3.715852050070547*^9, 3.715852050154768*^9}, {3.82082380825673*^9, 
   3.820823814976492*^9}, {3.82082408212925*^9, 3.8208241239645653`*^9}, {
   3.820826061310767*^9, 3.820826070901237*^9}, {3.820826254580243*^9, 
   3.820826260400008*^9}, {3.820829180997444*^9, 3.820829184781599*^9}, {
   3.820835616941091*^9, 3.820835656137171*^9}, {3.820839649843335*^9, 
   3.82083965272034*^9}, {3.820839699034432*^9, 3.820839762770323*^9}, {
   3.820905842567081*^9, 3.820905843098217*^9}, {3.824549686992094*^9, 
   3.824549687332745*^9}, {3.828605029318198*^9, 3.8286050754495487`*^9}, {
   3.828605236471778*^9, 3.828605262219185*^9}, {3.8286053179355307`*^9, 
   3.828605334936307*^9}, {3.8286057349149513`*^9, 3.82860573931429*^9}, {
   3.828765893050706*^9, 3.828765897355976*^9}, {3.828768535028833*^9, 
   3.828768538923512*^9}, {3.8287711552632933`*^9, 3.8287712103523397`*^9}, 
   3.828771941810659*^9, {3.82877504020366*^9, 3.8287750422864122`*^9}, {
   3.8287872102341948`*^9, 3.828787212389699*^9}, {3.828787292296318*^9, 
   3.828787297569257*^9}, 3.82878735620704*^9, {3.82878766374345*^9, 
   3.828787671999587*^9}, {3.828872170816822*^9, 3.8288721725218897`*^9}, {
   3.8288912631274776`*^9, 3.828891269709248*^9}, {3.8291223219028597`*^9, 
   3.829122328495398*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"64edfdaa-f112-4454-830a-86325568e25b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[39]:=",ExpressionUUID->"cb4892db-a39b-4860-8f03-e4ec90d80dba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReciprocalImageCheck", "[", "\[IndentingNewLine]", 
   RowBox[{"image_Image", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", 
      "\[Gamma]_"}], "}"}], ",", "\[IndentingNewLine]", "data_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Optional", "[", 
     RowBox[{"pattern_Condition", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", "False"}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "ReciprocalImageCheck", ",", "FindPixelClusters", ",", "ListPlot"}], 
       "}"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"latticeParameters", "=", 
       RowBox[{"{", 
        RowBox[{
        "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
         "\[Gamma]"}], "}"}]}], ",", "\[IndentingNewLine]", "latticeOrigin", 
      ",", "\[IndentingNewLine]", "hkl", ",", "normalDirection", ",", 
      "normalConstant", ",", "planeSelection", ",", "planeDescriptor", ",", 
      "\[IndentingNewLine]", "data2D", ",", "L", ",", "model", ",", 
      "\[Lambda]1", ",", "\[Lambda]2", ",", "h1", ",", "h2", ",", 
      "\[CapitalLambda]", ",", "latticeData", ",", "\[IndentingNewLine]", 
      "optionKeys"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", "Input"}]}], " ", 
       RowBox[{"check", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "for", " ", "sufficient", " ", "data"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "data"}], "<", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalImageCheck", "::", "data"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Lattice", " ", "origin", " ", "shift"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"latticeOrigin", "=", 
      RowBox[{"OptionValue", "[", "\"\<LatticeOrigin\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"latticeOrigin", "===", "\"\<Center\>\""}], ",", 
       RowBox[{"latticeOrigin", "=", 
        RowBox[{
         RowBox[{"ImageDimensions", "[", "image", "]"}], "/", "2"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"latticeOrigin", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalImageCheck", "::", "InvalidLatticeOrigin"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Preparations"}]}], " ", "for", " ", "extracting", 
        " ", "two", " ", "dimensions", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"image", " ", "plane"}], ")"}], " ", "--"}]}], "-"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Variables", " ", "describing", " ", "the", " ", "plane"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"normalDirection", "=", 
      RowBox[{"Check", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Length", "/@", 
             RowBox[{"DeleteDuplicates", "/@", 
              RowBox[{"Transpose", "@", "hkl"}]}]}], ",", "1"}], "]"}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"ReciprocalImageCheck", "::", "ambiguous"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalConstant", "=", 
      RowBox[{"data", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", 
        RowBox[{"normalDirection", "+", "2"}]}], "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"planeSelection", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "normalDirection"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"planeDescriptor", "=", 
      RowBox[{"planeSelection", "/.", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"1", "\[Rule]", "\"\<h\>\""}], ",", 
         RowBox[{"2", "\[Rule]", "\"\<k\>\""}], ",", 
         RowBox[{"3", "\[Rule]", "\"\<l\>\""}]}], "|>"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"planeDescriptor", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"planeDescriptor", ",", "normalConstant", ",", 
        RowBox[{"{", "normalDirection", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Setting"}]}], " ", "up", " ", 
        RowBox[{"lattice", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"data2D", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", "data"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", "+", "normalDirection"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data2D", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#3", ",", "#4", ",", 
          RowBox[{"N", "@", 
           RowBox[{"Norm", "[", 
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}], "]"}]}]}], "}"}], "&"}], "@@@",
        "data2D"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"GetCrystalMetric", "[", 
       RowBox[{"latticeParameters", ",", 
        RowBox[{"\"\<Space\>\"", "\[Rule]", "\"\<Reciprocal\>\""}], ",", 
        RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"L", "\[LeftDoubleBracket]", 
       RowBox[{"planeSelection", ",", "planeSelection"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"model", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"NonlinearModelFit", "[", "\[IndentingNewLine]", 
        RowBox[{"data2D", ",", "\[IndentingNewLine]", 
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"Plus", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Transpose", "@", "L"}], "*", 
              RowBox[{"{", 
               RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "*", 
              RowBox[{"{", 
               RowBox[{"h1", ",", "h2"}], "}"}]}], ")"}]}], "+", 
           "latticeOrigin"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h2"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], "=", 
      RowBox[{
       RowBox[{"model", "[", "\"\<ParameterTableEntries\>\"", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "L", "]"}], "*", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"latticeData", "=", 
      RowBox[{"{", 
       RowBox[{
       "\[CapitalLambda]", ",", "latticeOrigin", ",", "planeDescriptor"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ReturnLatticeData\>\"", "]"}]}], ",", 
       RowBox[{"Return", "@", "latticeData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ReciprocalImageCheck", "[", 
      RowBox[{"image", ",", "latticeData", ",", "pattern", ",", "options"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820829500415065*^9, 3.820829560737652*^9}, 
   3.820829884591704*^9, {3.820830166539743*^9, 3.820830278003015*^9}, {
   3.8208303504997387`*^9, 3.8208303775972853`*^9}, {3.82083041254207*^9, 
   3.82083053446938*^9}, {3.8208305804351673`*^9, 3.820830623407277*^9}, {
   3.820830658179776*^9, 3.820830690216383*^9}, {3.820834159655278*^9, 
   3.8208341673578777`*^9}, {3.820834208150927*^9, 3.820834210211969*^9}, 
   3.820836585559647*^9, {3.820837379568096*^9, 3.8208374375187187`*^9}, 
   3.820837641682579*^9, {3.820837929112485*^9, 3.820837953744546*^9}, {
   3.8208380000790367`*^9, 3.820838003880342*^9}, {3.820838585158677*^9, 
   3.820838608974784*^9}, {3.820839045816188*^9, 3.820839050217985*^9}, 
   3.820839163407382*^9, 3.8208392368622313`*^9, {3.8208393617961807`*^9, 
   3.820839435284464*^9}, {3.820839467769022*^9, 3.820839508874963*^9}, {
   3.820839959302638*^9, 3.820839963622862*^9}, {3.8208408025466213`*^9, 
   3.8208408026669207`*^9}, {3.820901052453711*^9, 3.820901122749054*^9}, {
   3.820901251445352*^9, 3.820901303250697*^9}, {3.82090134360868*^9, 
   3.820901344135236*^9}, 3.820901889828487*^9, 3.821121852155224*^9, {
   3.8245433414048653`*^9, 3.824543420586817*^9}, {3.824544077289608*^9, 
   3.824544108897049*^9}, {3.824547489136075*^9, 3.824547527206764*^9}, {
   3.824547574829502*^9, 3.8245476048273153`*^9}, {3.8245476398945007`*^9, 
   3.824547643348229*^9}, {3.824547765594721*^9, 3.8245477673436117`*^9}, {
   3.824548634091073*^9, 3.82454864135902*^9}, {3.824548674649252*^9, 
   3.824548725535334*^9}, {3.824548805327441*^9, 3.824548822912619*^9}, {
   3.824548856790264*^9, 3.8245488590984373`*^9}, {3.824548934595339*^9, 
   3.824548935602833*^9}, 3.8245489810427628`*^9, {3.828604454756702*^9, 
   3.8286044581708403`*^9}, {3.828771289424437*^9, 3.8287713358257847`*^9}, {
   3.828782759190617*^9, 3.828782859901142*^9}, {3.828782961694244*^9, 
   3.8287829696667433`*^9}, {3.828783030089678*^9, 3.828783032942514*^9}, {
   3.828783065777866*^9, 3.828783105739519*^9}, {3.82878321876623*^9, 
   3.828783231765267*^9}, {3.828783408818557*^9, 3.8287834278801394`*^9}, {
   3.8287835403342*^9, 3.8287835553984222`*^9}, {3.828785962503964*^9, 
   3.82878601344739*^9}, {3.828787514314526*^9, 3.828787518001274*^9}, 
   3.828881704725924*^9, {3.8288912796713963`*^9, 3.828891306019225*^9}, {
   3.8289618618804092`*^9, 3.828961905261387*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[40]:=",ExpressionUUID->"52866679-2f1e-4d01-8aef-6e618be4153a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReciprocalImageCheck", "[", "\[IndentingNewLine]", 
   RowBox[{"image_Image", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "lattice_List", ",", "origin_List", ",", "planeDescriptor_List"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"Optional", "[", 
     RowBox[{"pattern_Condition", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", "False"}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "ReciprocalImageCheck", ",", "FindPixelClusters", ",", "ListPlot"}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "normalConstant", ",", "planeSelection", ",", "normalDirection", ",", 
      "\[IndentingNewLine]", "\[CapitalLambda]", ",", "tx", ",", "ty", ",", 
      "\[ScriptP]", ",", "latticeData", ",", "\[IndentingNewLine]", 
      "storeDataTemporarily", ",", "gz", ",", 
      RowBox[{"showGrid", "=", "False"}], ",", "\[IndentingNewLine]", 
      "imageHash", ",", "pixelList", ",", "\[IndentingNewLine]", 
      "\[CapitalGamma]", ",", "\[Xi]", ",", "\[Chi]", ",", "convert", ",", 
      "residue", ",", "threshold", ",", "result", ",", "\[IndentingNewLine]", 
      
      RowBox[{"imageDimensions", "=", 
       RowBox[{"ImageDimensions", "@", "image"}]}], ",", 
      "\[IndentingNewLine]", "axisColors", ",", "L1", ",", "L2", ",", "V", 
      ",", "t", ",", "T", ",", "tt", ",", "grids", ",", "u", ",", "grid", ",",
       "\[IndentingNewLine]", "off", ",", "nodes", ",", "hkl", ",", "count", 
      ",", "selection", ",", "selection2D", ",", "pos", ",", "matching", ",", 
      "rest", ",", "\[IndentingNewLine]", "groupfix", ",", "tooltip", ",", 
      "\[IndentingNewLine]", "colorMatch", ",", "colorRest", ",", "colorOff", 
      ",", "optionKeys", ",", "plotOptions", ",", "nodePlot", ",", "plot", 
      ",", "\[IndentingNewLine]", "temp", ",", "temp2"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", "Input"}]}], " ", 
       RowBox[{"check", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Variables", " ", "describing", " ", "the", " ", "plane"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"normalConstant", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"Select", "[", 
          RowBox[{"planeDescriptor", ",", "NumericQ"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ReciprocalImageCheck", "::", "InvalidPlaneDescriptor"}], 
           ",", "planeDescriptor"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"planeSelection", "=", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{"planeDescriptor", ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "]"}], "/.", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<h\>\"", "\[Rule]", "1"}], ",", 
         RowBox[{"\"\<k\>\"", "\[Rule]", "2"}], ",", 
         RowBox[{"\"\<l\>\"", "\[Rule]", "3"}]}], "|>"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"normalDirection", "=", 
      RowBox[{"First", "@", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "planeSelection"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"storeDataTemporarily", "=", 
      RowBox[{"TrueQ", "@", 
       RowBox[{"OptionValue", "[", "\"\<StoreDataTemporarily\>\"", "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"gz", "=", 
      RowBox[{"OptionValue", "[", "\"\<ShowLattice\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"storeDataTemporarily", ",", 
       RowBox[{"gz", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"gz", "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "gz", "]"}], "&&", 
          RowBox[{"NonNegative", "[", "gz", "]"}]}], ")"}]}], ",", 
       RowBox[{"showGrid", "=", "True"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"gz", ",", 
       RowBox[{"gz", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Lattice", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"latticeData", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"{", 
          RowBox[{"tx", ",", "ty"}], "}"}], ",", "\[ScriptP]"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"lattice", ",", "origin", ",", "planeDescriptor"}], "}"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"\[CapitalLambda]", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "#"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"#", ",", "#"}], "}"}]}], "}"}], "&"}], "[", 
            RowBox[{"_", "?", "NumericQ"}], "]"}]}], "]"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "@", "tx"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "@", "ty"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalImageCheck", "::", "InvalidLatticeParameters"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ReturnLatticeData\>\"", "]"}]}], ",", 
       RowBox[{"Return", "@", "latticeData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Image", " ", 
       RowBox[{"check", "/", "treatment"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"pixelList", "=", 
      RowBox[{"FindPixelClusters", "[", "\[IndentingNewLine]", 
       RowBox[{"image", ",", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "options", "}"}], ",", 
          RowBox[{"Options", "@", "FindPixelClusters"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ReturnBinaryImage\>\"", "]"}]}], ",", 
       RowBox[{"Return", "@", "pixelList"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Lattice"}]}], " ", "conversion", " ", 
        RowBox[{"functions", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", "lattice"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalGamma]", "=", 
      RowBox[{"Inverse", "[", "\[CapitalLambda]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
      RowBox[{"\[CapitalGamma]", ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "-", "tx"}], ",", 
         RowBox[{"y", "-", "ty"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{"h_", ",", "k_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"\[CapitalLambda]", ".", 
        RowBox[{"{", 
         RowBox[{"h", ",", "k"}], "}"}]}], "+", 
       RowBox[{"{", 
        RowBox[{"tx", ",", "ty"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Pixel", " ", "to", " ", "node"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Calculation", " ", "and", " ", "discrepancy", " ", "check"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"convert", "=", 
         RowBox[{"\[CapitalGamma]", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "-", "tx"}], ",", 
            RowBox[{"y", "-", "ty"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"residue", "=", 
         RowBox[{"Abs", "/@", 
          RowBox[{"FractionalPart", "/@", 
           RowBox[{"N", "[", "convert", "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Decide", " ", "whether", " ", "to", " ", "round", " ", "to", " ", 
          "integer"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"threshold", "=", 
         RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"residue", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", "threshold"}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"result", ",", 
              RowBox[{"Round", "@", 
               RowBox[{"convert", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"1", "-", 
              RowBox[{"residue", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "\[LessEqual]", 
             "threshold"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"result", ",", 
              RowBox[{"Round", "@", 
               RowBox[{"convert", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"result", ",", 
              RowBox[{"N", "@", 
               RowBox[{"convert", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}], ")"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Node", " ", "to", " ", "pixel"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{"H_", ",", 
        RowBox[{"round_", ":", 
         RowBox[{"OptionValue", "[", "\"\<RoundPixels\>\"", "]"}]}]}], "]"}], 
      ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"convert", "=", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", ".", "H"}], "+", 
          RowBox[{"{", 
           RowBox[{"tx", ",", "ty"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"round", ",", 
          RowBox[{"Round", "@", "convert"}], ",", "convert"}], "]"}]}], 
       "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"-", " ", 
        RowBox[{"Optional", ":", " ", 
         RowBox[{
          RowBox[{"Overlaying", " ", 
           RowBox[{"grid", "/", 
            RowBox[{"lattice", " ", "--"}]}]}], "-"}]}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "showGrid"}], ",", 
       RowBox[{"Goto", "[", "\"\<LatticeDone\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Preparations", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"axisColors", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Green"}], ",", 
          RowBox[{"3", "\[Rule]", "Blue"}]}], "|>"}], ",", "planeSelection"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L1", ",", "L2"}], "}"}], "=", 
      RowBox[{"Transpose", "[", "\[CapitalLambda]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Lattice", " ", "setup"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{"x0_", ",", "y0_"}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "=", 
         RowBox[{"{", 
          RowBox[{"tx", ",", "ty"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"t", "=", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", ".", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "y0"}], "}"}]}], "+", 
          RowBox[{"{", 
           RowBox[{"tx", ",", "ty"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tt", "=", 
         RowBox[{"{", 
          RowBox[{"t", ",", "t"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x0", "\[Equal]", "y0", "\[Equal]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Origin", " ", "arrows"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "axisColors", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"T", ",", 
                 RowBox[{"T", "+", "L1"}]}], "}"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "axisColors", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{"T", ",", 
                 RowBox[{"T", "+", "L2"}]}], "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Translated", " ", "lines"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "axisColors", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", "Dashed", ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", "L1"}], "}"}], "+", 
                "tt"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "axisColors", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", "Dashed", ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", "L2"}], "}"}], "+", 
                "tt"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
         "]"}]}], "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Lattice", " ", "generation"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"grids", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<StartGrid\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "gz"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", "gz"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"-", "gz"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", "gz"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"temp", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"gz", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"temp", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "3", "}"}], ",", 
             RowBox[{"{", "4", "}"}], ",", 
             RowBox[{"{", "5", "}"}], ",", 
             RowBox[{"{", "6", "}"}], ",", 
             RowBox[{"{", "7", "}"}], ",", 
             RowBox[{"{", "8", "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Goto", "[", "\"\<One\>\"", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{
       RowBox[{"4", "gz"}], "+", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"2", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "gz"}], "+", "1"}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "temp2", ",", "u", ",", "temp2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"x1", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"x1", ",", 
        RowBox[{"x_", "\[RuleDelayed]", 
         RowBox[{"{", "x", "}"}]}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"j", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"u", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "gz"}], "+", "1"}], ")"}]}], ",", 
          RowBox[{"u", "-", "1"}], ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"x2", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"x2", ",", 
        RowBox[{"x_", "\[RuleDelayed]", 
         RowBox[{"{", "x", "}"}]}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"DeleteDuplicates", "@", 
         RowBox[{"Join", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<One\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"temp", ",", 
       RowBox[{"Arrowheads", "[", "Medium", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"grid", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"temp", ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Generate", " ", "several", " ", "grids"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"storeDataTemporarily", "&&", 
        RowBox[{"gz", "<", "8"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"grids", ",", "grid"}], "]"}], ";", 
        RowBox[{"gz", "++"}], ";", 
        RowBox[{"Goto", "[", "\"\<StartGrid\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<LatticeDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Consider", " ", "relfections", " ", "outside", " ", "threshold", " ", 
       "to", " ", "be", " ", 
       RowBox[{"wrong", "/", "off"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"off", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"pixelList", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"\[Xi]", "[", "#", "]"}], ",", "IntegerQ"}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Selecting"}]}], " ", "nodes", " ", "that", " ", 
        "match", " ", "the", " ", 
        RowBox[{"pattern", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Setup", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nodes", "=", 
      RowBox[{"\[Xi]", "/@", "pixelList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "@", "nodes"}], ",", "normalConstant", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"normalDirection", ",", 
            RowBox[{"-", "1"}], ",", "3"}], "}"}]}], "]"}], ",", "3"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "for", " ", "non"}], "-", 
       RowBox[{"integer", " ", "cases"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<CountNonInteger\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"hkl", ",", "_Real"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ReciprocalImageCheck", "::", "threshold"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"count", "=", 
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"FreeQ", "[", 
                 RowBox[{"#", ",", "_Real"}], "]"}], "&"}], "/@", "hkl"}], 
              ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"count", ">", "1"}], ",", "\"\<s were\>\"", ",", 
             "\"\< was\>\""}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"ReciprocalImageCheck", "::", "all"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"selection", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{"hkl", ",", "pattern"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Backtracking", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"selection2D", "=", 
      RowBox[{"selection", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "planeSelection"}], "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"nodes", ",", "#"}], "]"}], "&"}], "/@", "selection2D"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"matching", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"pixelList", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Selection", " ", "managment"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"matching", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"matching", ",", "off"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"rest", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"pixelList", ",", "matching", ",", "off"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Tooltip", " ", "styling", " ", "and", " ", "managment"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"groupfix", "[", "x_", "]"}], ":=", 
      RowBox[{"Quiet", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"MillerNotationToString", "@", "\[IndentingNewLine]", 
          RowBox[{"Insert", "[", 
           RowBox[{
            RowBox[{"\[Xi]", "[", "x", "]"}], ",", "normalConstant", ",", 
            RowBox[{"{", "normalDirection", "}"}]}], "]"}]}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tooltip", "=", 
      RowBox[{
       RowBox[{"Tooltip", "[", 
        RowBox[{"#1", ",", "#2", ",", 
         RowBox[{"TooltipStyle", "\[Rule]", "\[IndentingNewLine]", 
          RowBox[{"OptionValue", "[", "\"\<TooltipStyle\>\"", "]"}]}]}], 
        "]"}], "&"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", 
        RowBox[{"Empty", " ", "selections"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"off", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"off", "===", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Null", ",", "Null"}], "}"}], ",", 
        RowBox[{"MapThread", "[", 
         RowBox[{"tooltip", ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"groupfix", "/@", "off"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rest", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rest", "===", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Null", ",", "Null"}], "}"}], ",", 
        RowBox[{"MapThread", "[", 
         RowBox[{"tooltip", ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"groupfix", "/@", "rest"}], "]"}]}], "]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"matching", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"matching", "=", 
         RowBox[{"{", 
          RowBox[{"Null", ",", "Null"}], "}"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Goto", "[", "\"\<SkipMatching\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Adding", " ", "tooltip"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"matching", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"tooltip", ",", "\[IndentingNewLine]", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pixelList", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"MillerNotationToString", "@", 
              RowBox[{
              "hkl", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "}"}], 
           "&"}], "/@", "pos"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SkipMatching\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", 
         RowBox[{"Plot", " ", "--"}]}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"colorMatch", ",", "colorRest", ",", "colorOff"}], "}"}], "=", 
      
      RowBox[{"OptionValue", "[", "\"\<Colours\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Options", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"optionKeys", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Keys", "/@", 
        RowBox[{"Options", "/@", 
         RowBox[{"{", 
          RowBox[{"ReciprocalImageCheck", ",", "ListPlot"}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plotOptions", "=", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", 
          RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
        "optionKeys"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"plotOptions", "[", "AspectRatio", "]"}], "===", 
        RowBox[{"1", "/", "GoldenRatio"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"plotOptions", "[", "AspectRatio", "]"}], "=", 
        RowBox[{"1", "/", 
         RowBox[{"Divide", "@@", "imageDimensions"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"plotOptions", "[", "PlotStyle", "]"}], "===", "Automatic"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"plotOptions", "[", "PlotStyle", "]"}], "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "\[Rule]", 
             RowBox[{"OptionValue", "[", "PointSize", "]"}]}], ",", 
            "Automatic", ",", "colorOff"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "\[Rule]", 
             RowBox[{"OptionValue", "[", "PointSize", "]"}]}], ",", 
            "Automatic", ",", "colorRest"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "\[Rule]", 
             RowBox[{"OptionValue", "[", "PointSize", "]"}]}], ",", 
            "Automatic", ",", "colorMatch"}], "}"}]}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plotOptions", "=", 
      RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Normal", "@", "plotOptions"}], ",", 
        RowBox[{"Options", "@", "ListPlot"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<BackgroundImage\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Put"}], " ", "invisible", " ", "nodes", " ", 
         "on", " ", "top", " ", "of", " ", "image"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"plotOptions", "=", 
         RowBox[{"Normal", "@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Association", "@", "plotOptions"}], ",", 
            RowBox[{"<|", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Transparent", ",", 
                 RowBox[{"PointSize", "\[Rule]", "Large"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "False"}], ",", 
              RowBox[{"Axes", "\[Rule]", "False"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "#1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "#2"}], "}"}]}], "}"}]}], "&"}], "@@", 
               "imageDimensions"}]}], "\[IndentingNewLine]", "|>"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nodePlot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"rest", ",", 
           RowBox[{"Sequence", "@@", "plotOptions"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "@", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{"nodePlot", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"showGrid", ",", "grid", ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Prolog", "\[Rule]", 
            RowBox[{"Inset", "[", 
             RowBox[{"image", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "imageDimensions"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Regular"}], " ", "ListPlot"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"plot", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"off", ",", "rest", ",", "matching"}], "}"}], ",", 
          RowBox[{"Sequence", "@@", "plotOptions"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", 
         RowBox[{"End", " ", "--"}]}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Store", " ", "data", " ", "temporarily"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<StoreDataTemporarily\>\"", "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"<|", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<Image\>\"", "\[Rule]", "image"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<ImageGrayscale\>\"", "\[Rule]", 
           RowBox[{"ColorConvert", "[", 
            RowBox[{"image", ",", "\"\<Grayscale\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<ImageNegative\>\"", "\[Rule]", 
           RowBox[{"ColorNegate", "[", "image", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<ImageGrayscaleNegative\>\"", "\[Rule]", 
           RowBox[{"ColorConvert", "[", 
            RowBox[{
             RowBox[{"ColorNegate", "[", "image", "]"}], ",", 
             "\"\<Grayscale\>\""}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<ImageBinarised\>\"", "\[Rule]", 
           RowBox[{"Binarize", "[", "image", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Lattice\>\"", "\[Rule]", "latticeData"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Plotdata\>\"", "\[Rule]", "rest"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<PlotdataMatch\>\"", "\[Rule]", "matching"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<PlotdataWrong\>\"", "\[Rule]", "off"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Grids\>\"", "\[Rule]", "grids"}]}], 
         "\[IndentingNewLine]", "|>"}], "\[IndentingNewLine]", "]"}]}], "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Plot", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"showGrid", ",", 
       RowBox[{"Show", "[", 
        RowBox[{"grid", ",", "plot", ",", "plotOptions"}], "]"}], ",", 
       "plot"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.66781928258258*^9, {3.667927651314351*^9, 
   3.667927654536632*^9}, {3.667929095288192*^9, 3.6679291258239803`*^9}, {
   3.667929267909597*^9, 3.6679293218335447`*^9}, {3.667929372921582*^9, 
   3.667929415065257*^9}, {3.667929450855839*^9, 3.667929465310821*^9}, {
   3.667929674490491*^9, 3.667929695296151*^9}, {3.667932801543818*^9, 
   3.667932831774096*^9}, {3.667932972267625*^9, 3.667933072145303*^9}, {
   3.6679331209365664`*^9, 3.6679331662069387`*^9}, {3.667933209078788*^9, 
   3.667933227509615*^9}, {3.6679332584155407`*^9, 3.6679334381219397`*^9}, {
   3.667933545119546*^9, 3.667933638124634*^9}, {3.667933670396723*^9, 
   3.6679337557378597`*^9}, {3.667933854434494*^9, 3.6679339195341597`*^9}, {
   3.6679341282991962`*^9, 3.667934134873889*^9}, {3.6679341782737226`*^9, 
   3.6679341840020323`*^9}, {3.6679362918882227`*^9, 3.66793629955867*^9}, 
   3.6679368778672867`*^9, {3.6679369198504763`*^9, 3.667936939064159*^9}, {
   3.6679369707445602`*^9, 3.667937040468952*^9}, {3.667937292923864*^9, 
   3.667937348973225*^9}, {3.6679374182060013`*^9, 3.667937480746695*^9}, {
   3.667937526410141*^9, 3.667937526969555*^9}, {3.667937583425147*^9, 
   3.667937674742606*^9}, {3.6679377238633833`*^9, 3.667937724894253*^9}, {
   3.667937808371294*^9, 3.6679378269471397`*^9}, {3.6679378802105713`*^9, 
   3.6679379711123447`*^9}, {3.667938005718261*^9, 3.6679380215741*^9}, {
   3.6679380570319643`*^9, 3.667938083541068*^9}, 3.6679381599247704`*^9, {
   3.66793820112397*^9, 3.66793823159343*^9}, {3.6679382956572037`*^9, 
   3.667938323449614*^9}, {3.667938366874012*^9, 3.667938389394507*^9}, {
   3.667938438128626*^9, 3.667938482933886*^9}, {3.6679385245828333`*^9, 
   3.667938637513776*^9}, {3.667938678441284*^9, 3.6679386932649508`*^9}, {
   3.667938766302857*^9, 3.667938772390689*^9}, {3.6679388267453012`*^9, 
   3.66793883006816*^9}, {3.667938882518243*^9, 3.6679389128181973`*^9}, {
   3.667938969803068*^9, 3.667939039336431*^9}, {3.667939320219082*^9, 
   3.667939341625779*^9}, 3.6679393770581408`*^9, {3.667939469232902*^9, 
   3.667939497964835*^9}, {3.667939532149186*^9, 3.6679395720840807`*^9}, 
   3.667939642501049*^9, 3.667939694842989*^9, {3.667939989576542*^9, 
   3.6679399917123747`*^9}, {3.6679401365541153`*^9, 
   3.6679401648221617`*^9}, {3.6679692529322023`*^9, 
   3.6679692701706533`*^9}, {3.667969341866721*^9, 3.667969376607637*^9}, {
   3.667970147145928*^9, 3.667970151592761*^9}, {3.667970216297092*^9, 
   3.6679702636391077`*^9}, {3.667970383427594*^9, 3.667970398444811*^9}, {
   3.667970463193151*^9, 3.667970504208695*^9}, {3.667971051562167*^9, 
   3.667971074354063*^9}, {3.667971771279505*^9, 3.667971780398533*^9}, {
   3.667973403161166*^9, 3.667973405361252*^9}, 3.667990367536018*^9, 
   3.6679914757391148`*^9, 3.667992175946229*^9, {3.667995104529952*^9, 
   3.667995106057413*^9}, {3.667995855313924*^9, 3.6679958569938917`*^9}, {
   3.668019108513597*^9, 3.668019128352426*^9}, {3.668019279072505*^9, 
   3.668019279848213*^9}, {3.668021278816801*^9, 3.668021282112631*^9}, {
   3.668021313401822*^9, 3.668021390441625*^9}, {3.6680214213580303`*^9, 
   3.668021451698588*^9}, {3.668021555880783*^9, 3.6680215849273357`*^9}, 
   3.668057813132045*^9, {3.668058136762526*^9, 3.668058164915876*^9}, {
   3.668058379699932*^9, 3.668058399154965*^9}, {3.6680584419942427`*^9, 
   3.668058535166953*^9}, {3.6680585771843357`*^9, 3.668058585352005*^9}, {
   3.668058667869895*^9, 3.668058671764526*^9}, {3.668059350708185*^9, 
   3.668059390641903*^9}, {3.668059561240314*^9, 3.668059570492672*^9}, {
   3.66805963935712*^9, 3.668059696425672*^9}, {3.668098237468328*^9, 
   3.668098249995756*^9}, {3.6681000141884813`*^9, 3.66810004431769*^9}, {
   3.668102295375621*^9, 3.668102328261784*^9}, {3.668143501205806*^9, 
   3.66814352368707*^9}, {3.668149871172584*^9, 3.668149875216461*^9}, {
   3.669519749593667*^9, 3.669519751591695*^9}, {3.6695563106568947`*^9, 
   3.669556316832087*^9}, {3.669556375703582*^9, 3.669556375942615*^9}, {
   3.669556527484511*^9, 3.6695565277148*^9}, {3.671344373430882*^9, 
   3.6713443736693897`*^9}, {3.6713446182723618`*^9, 3.671344618519547*^9}, {
   3.671344657281046*^9, 3.671344657415612*^9}, {3.671346974817726*^9, 
   3.671347016688924*^9}, {3.671347556830886*^9, 3.671347635440847*^9}, {
   3.6713476776843443`*^9, 3.671347679288475*^9}, {3.671347719383917*^9, 
   3.671347795245021*^9}, {3.671347853822792*^9, 3.6713478877165747`*^9}, {
   3.671348259934767*^9, 3.671348271084628*^9}, {3.671348314653845*^9, 
   3.6713483159313307`*^9}, {3.671351806693378*^9, 3.671351808371985*^9}, {
   3.671351925105709*^9, 3.6713519328813066`*^9}, {3.671352042856463*^9, 
   3.6713520444954348`*^9}, {3.671352141564987*^9, 3.6713521418921757`*^9}, {
   3.67135433001543*^9, 3.671354354775991*^9}, {3.6713543903521852`*^9, 
   3.671354407759055*^9}, {3.671354507228725*^9, 3.671354510406054*^9}, {
   3.671354581932342*^9, 3.67135461566549*^9}, {3.671354653643035*^9, 
   3.671354653697824*^9}, {3.6713547964307623`*^9, 3.6713547984468317`*^9}, {
   3.671354832134036*^9, 3.671354833102087*^9}, {3.67135529549364*^9, 
   3.671355302546892*^9}, {3.671355573087512*^9, 3.671355582974106*^9}, {
   3.671356555785466*^9, 3.6713565631134987`*^9}, {3.671356796908342*^9, 
   3.671356807093913*^9}, {3.671356934530822*^9, 3.671356940432358*^9}, {
   3.671356982272311*^9, 3.671357013320292*^9}, {3.6713574599357767`*^9, 
   3.6713574887658043`*^9}, 3.671357559702499*^9, {3.671358859881794*^9, 
   3.6713588975738163`*^9}, {3.6713589308612833`*^9, 3.671358950341908*^9}, 
   3.671359851957679*^9, {3.671360146383136*^9, 3.671360211557448*^9}, {
   3.671361450673636*^9, 3.671361450855844*^9}, {3.671361547079302*^9, 
   3.6713615655118837`*^9}, {3.6713722035701437`*^9, 3.671372204879589*^9}, 
   3.6713885646487226`*^9, {3.6713886420824947`*^9, 3.671388651920701*^9}, {
   3.6713887667366743`*^9, 3.671388767616539*^9}, {3.671389203847748*^9, 
   3.6713892089594584`*^9}, {3.67138931525079*^9, 3.6713893249230957`*^9}, {
   3.671389403263423*^9, 3.671389448584199*^9}, {3.671389482721499*^9, 
   3.671389552266603*^9}, {3.6713895972521553`*^9, 3.671389638503859*^9}, {
   3.671389675267129*^9, 3.6713896774792337`*^9}, 3.6713897131154537`*^9, {
   3.671806709661995*^9, 3.671806728097248*^9}, 3.6718073146802807`*^9, {
   3.671911114402894*^9, 3.671911120386015*^9}, {3.67195946711077*^9, 
   3.671959474991378*^9}, {3.6719595218231688`*^9, 3.67195952199016*^9}, {
   3.674582941255888*^9, 3.674582961526577*^9}, {3.674583042374473*^9, 
   3.674583044373474*^9}, {3.674583075638014*^9, 3.674583124381897*^9}, {
   3.6745831719336767`*^9, 3.674583173804262*^9}, 3.67458324742804*^9, {
   3.687156775422434*^9, 3.687156781933877*^9}, 3.687164508774666*^9, {
   3.6871645394569683`*^9, 3.687164718554234*^9}, {3.687165246225195*^9, 
   3.687165390883108*^9}, {3.687165450522169*^9, 3.6871655616493053`*^9}, {
   3.687165646846031*^9, 3.687165664977735*^9}, {3.687165710844844*^9, 
   3.687165717857222*^9}, {3.6871657857219877`*^9, 3.6871657877356358`*^9}, {
   3.6871658493381023`*^9, 3.687165871669606*^9}, {3.687165904197296*^9, 
   3.687165996079699*^9}, {3.6871660295334883`*^9, 3.687166153093152*^9}, {
   3.687166192079156*^9, 3.687166246078738*^9}, {3.6871668605632353`*^9, 
   3.6871669433889227`*^9}, 3.687166977069869*^9, {3.687167109987769*^9, 
   3.687167208870311*^9}, {3.687167238984859*^9, 3.6871677862844477`*^9}, 
   3.687167881607252*^9, {3.6871679214931793`*^9, 3.687168147685855*^9}, {
   3.6871682126935883`*^9, 3.687168275207411*^9}, {3.687168432381917*^9, 
   3.687168586540969*^9}, 3.687168628404684*^9, {3.687168658442284*^9, 
   3.687168663527091*^9}, 3.687169005717609*^9, 3.687169293454012*^9, {
   3.68750633090869*^9, 3.68750633648623*^9}, {3.6875071841161757`*^9, 
   3.687507184303252*^9}, {3.687507329340541*^9, 3.68750734744081*^9}, {
   3.687507400920726*^9, 3.687507423975339*^9}, {3.6875076419535522`*^9, 
   3.687507642224166*^9}, {3.687507713412353*^9, 3.6875077551581697`*^9}, {
   3.6875078576324587`*^9, 3.6875078877691603`*^9}, {3.687509544613727*^9, 
   3.6875095534866037`*^9}, {3.687509706784939*^9, 3.6875097103088217`*^9}, {
   3.687509833577773*^9, 3.68750989972786*^9}, {3.687509935327718*^9, 
   3.687509937855692*^9}, {3.687510167577135*^9, 3.6875101802065897`*^9}, {
   3.687510280296921*^9, 3.6875103742068367`*^9}, {3.687510514864278*^9, 
   3.687510517693245*^9}, {3.687510833967678*^9, 3.687510836634856*^9}, {
   3.687511073932612*^9, 3.687511074191729*^9}, {3.687512065559246*^9, 
   3.6875120662299633`*^9}, {3.68751234598036*^9, 3.687512347377809*^9}, {
   3.687514748805332*^9, 3.687514762556086*^9}, {3.6875147988089447`*^9, 
   3.687514862911953*^9}, {3.6875150221086493`*^9, 3.687515113015212*^9}, {
   3.687515242879355*^9, 3.6875152576859617`*^9}, {3.6875153755411043`*^9, 
   3.6875153761781673`*^9}, {3.687516002196384*^9, 3.687516030150734*^9}, {
   3.6875165012670918`*^9, 3.6875165247399*^9}, {3.6875165694845133`*^9, 
   3.687516572040914*^9}, {3.687516612818783*^9, 3.687516645184465*^9}, {
   3.687516683884563*^9, 3.687516724914262*^9}, {3.687516944466934*^9, 
   3.687516945219212*^9}, {3.687517002357984*^9, 3.687517023874254*^9}, 
   3.6875171351822653`*^9, {3.6875183237381067`*^9, 3.687518324957768*^9}, {
   3.687518398182641*^9, 3.68751841327169*^9}, {3.6875185644568996`*^9, 
   3.687518565549593*^9}, {3.68751886454458*^9, 3.687518891383182*^9}, {
   3.687519022393402*^9, 3.687519061776618*^9}, {3.6875190956572533`*^9, 
   3.687519182765481*^9}, {3.687519279346684*^9, 3.687519413303564*^9}, {
   3.6875194796623383`*^9, 3.687519523955543*^9}, 3.687519663585091*^9, {
   3.687519806348749*^9, 3.6875199887548847`*^9}, {3.6875200763660994`*^9, 
   3.687520141546947*^9}, {3.687520178418494*^9, 3.687520343242195*^9}, {
   3.687520527435096*^9, 3.6875205422137814`*^9}, {3.687520703883664*^9, 
   3.687520714415331*^9}, {3.687520748045477*^9, 3.6875207525783157`*^9}, {
   3.687521196110949*^9, 3.687521217133346*^9}, {3.6875212614386787`*^9, 
   3.6875212689137173`*^9}, {3.687521699605805*^9, 3.687521728841394*^9}, {
   3.6875217702469683`*^9, 3.687521790955085*^9}, {3.687521965231024*^9, 
   3.68752196773971*^9}, {3.6875220762878723`*^9, 3.68752207955971*^9}, 
   3.6875221341628*^9, {3.687522181579337*^9, 3.6875221857643147`*^9}, {
   3.687522225843388*^9, 3.6875223170336237`*^9}, {3.68752234812294*^9, 
   3.6875223735999107`*^9}, {3.6876686273963747`*^9, 3.687668651273189*^9}, {
   3.687669052317815*^9, 3.687669072963629*^9}, {3.687669221852079*^9, 
   3.687669231600322*^9}, 3.687669412928665*^9, {3.6876694739967422`*^9, 
   3.6876695144406843`*^9}, {3.6876708510183077`*^9, 3.687670879758339*^9}, {
   3.6876719237499723`*^9, 3.687671956628632*^9}, {3.6876719935829067`*^9, 
   3.687672018688109*^9}, {3.687672049692421*^9, 3.687672059143203*^9}, {
   3.687678052571329*^9, 3.687678061479775*^9}, {3.6876815475701523`*^9, 
   3.687681601640286*^9}, {3.687691708586556*^9, 3.6876917119783363`*^9}, {
   3.6876920372162*^9, 3.687692037367296*^9}, {3.687861711022195*^9, 
   3.687861735186718*^9}, {3.6878617699180517`*^9, 3.687861821841461*^9}, {
   3.687861855943221*^9, 3.687861900257381*^9}, 3.6878631121381683`*^9, {
   3.687863166001348*^9, 3.6878632357037086`*^9}, {3.687863297125453*^9, 
   3.6878633093477488`*^9}, {3.6878634144485273`*^9, 3.687863440543641*^9}, {
   3.6878635134405622`*^9, 3.6878635475897827`*^9}, {3.687863656295929*^9, 
   3.687863717150881*^9}, {3.687863768602734*^9, 3.687863813012793*^9}, {
   3.687863891791483*^9, 3.687863892735425*^9}, {3.68786392314459*^9, 
   3.687863938361341*^9}, {3.687864241126114*^9, 3.687864381110055*^9}, {
   3.68786442924084*^9, 3.687864552200337*^9}, {3.687864599173511*^9, 
   3.687864618328858*^9}, {3.687864667932199*^9, 3.687864692086171*^9}, {
   3.687864753006353*^9, 3.687864894596149*^9}, {3.687865192458065*^9, 
   3.687865227041898*^9}, {3.687865400024457*^9, 3.687865406423842*^9}, {
   3.6878659096425047`*^9, 3.687865947266676*^9}, {3.687865981660466*^9, 
   3.687865989851564*^9}, {3.6881267638468*^9, 3.688126781856586*^9}, {
   3.688126813279327*^9, 3.6881271692244463`*^9}, {3.688127225652492*^9, 
   3.688127281666382*^9}, {3.688127439709325*^9, 3.688127480871084*^9}, 
   3.688127512373879*^9, {3.688127553320573*^9, 3.68812755398044*^9}, {
   3.688127650793001*^9, 3.6881278726644087`*^9}, {3.688127919436009*^9, 
   3.688128024792449*^9}, {3.688128064984997*^9, 3.688128065652214*^9}, {
   3.688128133919053*^9, 3.688128219141905*^9}, {3.688128331504766*^9, 
   3.688128348212882*^9}, {3.68812842135893*^9, 3.688128501203792*^9}, {
   3.688128578509428*^9, 3.688128601410139*^9}, {3.688128690322328*^9, 
   3.688128735595336*^9}, {3.688128822364902*^9, 3.688128861848989*^9}, {
   3.688128921153905*^9, 3.6881289463480663`*^9}, {3.688128990765437*^9, 
   3.688129029272183*^9}, {3.688129089255213*^9, 3.688129094279276*^9}, {
   3.688129134305854*^9, 3.6881292730710773`*^9}, {3.6881465195183*^9, 
   3.688146524995182*^9}, {3.68814655619547*^9, 3.688146641081154*^9}, {
   3.688146684212517*^9, 3.688146807271761*^9}, {3.688146962193809*^9, 
   3.688146962567013*^9}, {3.688147017668222*^9, 3.688147052517234*^9}, {
   3.6881471414269114`*^9, 3.688147177803094*^9}, {3.688147247579743*^9, 
   3.688147297679015*^9}, {3.688147346935234*^9, 3.688147354976241*^9}, {
   3.688147391222777*^9, 3.688147395894573*^9}, {3.688147444480929*^9, 
   3.688147499317027*^9}, {3.6881475781337633`*^9, 3.688147610577223*^9}, {
   3.6881476745811653`*^9, 3.6881477683213873`*^9}, {3.688186721038027*^9, 
   3.6881867215562563`*^9}, {3.688186966939413*^9, 3.688186967535561*^9}, {
   3.68819148816154*^9, 3.6881915822168627`*^9}, {3.688191679333376*^9, 
   3.688191715244688*^9}, {3.6881917649517107`*^9, 3.688191766155924*^9}, {
   3.688192180136743*^9, 3.688192192228733*^9}, {3.688192366353334*^9, 
   3.688192439675796*^9}, {3.688192601562984*^9, 3.68819261857239*^9}, {
   3.688192693418126*^9, 3.6881927823590183`*^9}, {3.688192835817779*^9, 
   3.688192837581232*^9}, {3.688192876509275*^9, 3.688192885736589*^9}, {
   3.688192933504092*^9, 3.688192962975136*^9}, {3.688193016864141*^9, 
   3.688193147605221*^9}, {3.688193226631628*^9, 3.688193250588456*^9}, 
   3.6881932871489553`*^9, {3.6881934369086227`*^9, 3.6881934377091017`*^9}, 
   3.688193888436359*^9, {3.68827870320015*^9, 3.688278745786932*^9}, {
   3.688279867027066*^9, 3.688279873328266*^9}, {3.688281310768528*^9, 
   3.6882813540220747`*^9}, {3.688281401439827*^9, 3.688281443632139*^9}, {
   3.688281489159092*^9, 3.688281522219717*^9}, 3.688281585283691*^9, {
   3.688281629377688*^9, 3.6882816382592497`*^9}, {3.688281827595358*^9, 
   3.688281837415002*^9}, {3.688281895131445*^9, 3.688281986560493*^9}, {
   3.6882840199216003`*^9, 3.688284062897357*^9}, 3.688284096387642*^9, {
   3.688284218942671*^9, 3.688284275867519*^9}, {3.688284394168859*^9, 
   3.6882844495841*^9}, {3.688285129326865*^9, 3.6882851308678083`*^9}, {
   3.688288327231152*^9, 3.688288384783165*^9}, {3.688293063190908*^9, 
   3.6882930641267643`*^9}, {3.688297537916748*^9, 3.6882975833392277`*^9}, {
   3.68829801661409*^9, 3.6882980731607018`*^9}, {3.688299551066402*^9, 
   3.688299562144874*^9}, {3.688300900482009*^9, 3.688300910395095*^9}, {
   3.688360492469249*^9, 3.688360511436487*^9}, {3.688360624931951*^9, 
   3.688360627463565*^9}, {3.688880504257531*^9, 3.6888805253276567`*^9}, {
   3.688891789432199*^9, 3.6888917903726683`*^9}, {3.688894187838941*^9, 
   3.688894207337967*^9}, {3.6889003583112717`*^9, 3.688900368289029*^9}, {
   3.688937564965316*^9, 3.688937567425077*^9}, {3.6889376607109337`*^9, 
   3.688937678117669*^9}, {3.68893774692369*^9, 3.688937755983369*^9}, {
   3.6889377924952507`*^9, 3.6889378358089857`*^9}, {3.6889378986873407`*^9, 
   3.688937999505767*^9}, {3.688938099054064*^9, 3.688938168750766*^9}, {
   3.688938233749807*^9, 3.68893824083641*^9}, {3.688938308543055*^9, 
   3.6889383454914627`*^9}, {3.688938390207061*^9, 3.688938390924144*^9}, {
   3.713874107520574*^9, 3.7138741424861526`*^9}, {3.714129943250423*^9, 
   3.714129954600395*^9}, {3.71412999923943*^9, 3.714130005919458*^9}, {
   3.714199796296146*^9, 3.714199797509729*^9}, {3.714201044679081*^9, 
   3.714201053314817*^9}, {3.7142024150579453`*^9, 3.7142024269417686`*^9}, {
   3.715333526187746*^9, 3.715333552478838*^9}, {3.715333596840613*^9, 
   3.7153336189267*^9}, 3.7153347036928*^9, {3.7153347801787357`*^9, 
   3.715334822889534*^9}, {3.715335703580905*^9, 3.715335733109145*^9}, {
   3.715336054049705*^9, 3.7153360541917477`*^9}, {3.715336155641518*^9, 
   3.715336265520912*^9}, {3.715336320107382*^9, 3.715336330751687*^9}, {
   3.715336448177416*^9, 3.7153364577322807`*^9}, {3.7153364956595173`*^9, 
   3.715336495804838*^9}, 3.715336550828467*^9, 3.715336642896287*^9, {
   3.715852050263661*^9, 3.715852050597019*^9}, {3.7177408404502277`*^9, 
   3.717740856188644*^9}, {3.717740897228889*^9, 3.717740915600151*^9}, {
   3.820816439129642*^9, 3.820816448260158*^9}, {3.82081661228085*^9, 
   3.820816727999538*^9}, {3.8208168795714483`*^9, 3.820816895484083*^9}, {
   3.820817282854825*^9, 3.820817307520115*^9}, {3.820817663631792*^9, 
   3.8208176706599903`*^9}, {3.820817762686343*^9, 3.820817789137677*^9}, {
   3.8208178269007883`*^9, 3.820817881426557*^9}, {3.8208179195732*^9, 
   3.820817921740995*^9}, {3.820818063940249*^9, 3.820818162299801*^9}, {
   3.820818238175372*^9, 3.8208185136323442`*^9}, 3.820818624916007*^9, {
   3.8208189530075617`*^9, 3.820818982074903*^9}, {3.8208190321527233`*^9, 
   3.820819040224187*^9}, {3.820819086949225*^9, 3.820819090324049*^9}, {
   3.8208191412222757`*^9, 3.8208191413947763`*^9}, {3.820819244970813*^9, 
   3.8208192558965683`*^9}, {3.8208194037757473`*^9, 3.820819479814685*^9}, {
   3.820819609882004*^9, 3.820819611497902*^9}, {3.820819677229857*^9, 
   3.820819788162737*^9}, {3.820819981595194*^9, 3.8208200963316708`*^9}, {
   3.820820149415616*^9, 3.8208201851377974`*^9}, {3.820820228483614*^9, 
   3.820820289833311*^9}, {3.820820321371773*^9, 3.8208203334040728`*^9}, {
   3.820820373441598*^9, 3.8208203853307333`*^9}, {3.820820491955151*^9, 
   3.820820500640666*^9}, {3.820820605706381*^9, 3.820820608954183*^9}, {
   3.8208237609410677`*^9, 3.820823881983199*^9}, {3.820824129507226*^9, 
   3.820824264100594*^9}, {3.820824392504869*^9, 3.8208244725352507`*^9}, {
   3.820824529120022*^9, 3.82082460373943*^9}, {3.820824638866399*^9, 
   3.820824639417182*^9}, {3.8208246914246798`*^9, 3.8208249264020357`*^9}, {
   3.82082502554049*^9, 3.8208250424194107`*^9}, {3.820825189396172*^9, 
   3.8208251920635843`*^9}, {3.820825258430016*^9, 3.8208252829474907`*^9}, {
   3.820825320189001*^9, 3.8208254031081247`*^9}, {3.820825811793313*^9, 
   3.8208258389947577`*^9}, {3.820825933129706*^9, 3.8208260793413343`*^9}, {
   3.820826221013618*^9, 3.82082623686411*^9}, {3.820828859882246*^9, 
   3.8208289063955107`*^9}, {3.820828985335225*^9, 3.820828990664719*^9}, {
   3.820829042824204*^9, 3.8208290654599657`*^9}, {3.8208291116159687`*^9, 
   3.8208291171133947`*^9}, {3.820829224154605*^9, 3.8208293560878487`*^9}, {
   3.8208294497219963`*^9, 3.820829457146411*^9}, {3.820829712445204*^9, 
   3.820829729791006*^9}, {3.82082977543611*^9, 3.8208297758598824`*^9}, {
   3.82082981836054*^9, 3.820829932381559*^9}, 3.820829969255913*^9, {
   3.820830020915328*^9, 3.820830062349008*^9}, {3.8208305621766043`*^9, 
   3.820830562623288*^9}, {3.820834281584168*^9, 3.82083437291252*^9}, {
   3.820834821265169*^9, 3.820834917323745*^9}, {3.820835226092249*^9, 
   3.820835241343773*^9}, {3.820835330681486*^9, 3.820835332893615*^9}, {
   3.820835595948103*^9, 3.8208356083165007`*^9}, {3.820835660259748*^9, 
   3.8208357678383904`*^9}, {3.820835808412641*^9, 3.820835977700604*^9}, {
   3.820836009943811*^9, 3.8208360367115517`*^9}, {3.8208360928598413`*^9, 
   3.8208361176060867`*^9}, {3.820836165234234*^9, 3.820836249835498*^9}, {
   3.820836299829905*^9, 3.820836450310996*^9}, 3.820836499645288*^9, {
   3.820836544079979*^9, 3.8208365465298758`*^9}, {3.8208366241719103`*^9, 
   3.8208366329982147`*^9}, 3.820837523450768*^9, 3.820838664574773*^9, {
   3.8208387802175694`*^9, 3.820838803815727*^9}, {3.820838990278298*^9, 
   3.8208390293224897`*^9}, {3.820839177242873*^9, 3.820839178099092*^9}, {
   3.8208394814592543`*^9, 3.820839503351983*^9}, {3.820839783367899*^9, 
   3.8208397945270357`*^9}, {3.820839906620771*^9, 3.8208399358239803`*^9}, {
   3.820839985461712*^9, 3.820840035431608*^9}, {3.820840078649364*^9, 
   3.820840143895996*^9}, {3.820840178728733*^9, 3.820840240170094*^9}, {
   3.820840275004263*^9, 3.820840311498041*^9}, {3.820840341676676*^9, 
   3.820840471102854*^9}, {3.820840739959304*^9, 3.820840740094494*^9}, 
   3.820899845185835*^9, {3.820899895771943*^9, 3.820899899620428*^9}, {
   3.8208999471100407`*^9, 3.820899947609631*^9}, {3.820900665047122*^9, 
   3.820900700657632*^9}, {3.82090073115567*^9, 3.82090083767754*^9}, {
   3.820901870702179*^9, 3.8209019094048023`*^9}, {3.820901976450568*^9, 
   3.820902052462585*^9}, {3.820902101303793*^9, 3.8209021410777597`*^9}, 
   3.820902186768868*^9, {3.820902507549582*^9, 3.82090251281756*^9}, 
   3.820903776889921*^9, 3.82090453898112*^9, {3.820905160067148*^9, 
   3.820905162508216*^9}, {3.8209052443766413`*^9, 3.820905260321281*^9}, {
   3.820905514760235*^9, 3.8209057261626577`*^9}, 3.8209057574557047`*^9, {
   3.8209058078276577`*^9, 3.820905828915777*^9}, {3.820905862818915*^9, 
   3.820905889217835*^9}, {3.820905923656955*^9, 3.82090597359378*^9}, {
   3.820906136199646*^9, 3.820906178976849*^9}, {3.820906241401338*^9, 
   3.820906272874901*^9}, {3.820906336725039*^9, 3.820906354502912*^9}, {
   3.828774556361492*^9, 3.82877455985884*^9}, {3.82877459946848*^9, 
   3.8287746056548777`*^9}, {3.828775362563759*^9, 3.8287753776386557`*^9}, {
   3.8287759350941677`*^9, 3.8287759440212793`*^9}, 3.828778943947072*^9, 
   3.8287789889529533`*^9, {3.828780346975152*^9, 3.828780347726708*^9}, {
   3.8287825797881317`*^9, 3.828782592316676*^9}, {3.8287835105774*^9, 
   3.82878351860601*^9}, {3.828783598203972*^9, 3.828783619316854*^9}, 
   3.8287836527957373`*^9, {3.828784507855027*^9, 3.828784510355242*^9}, {
   3.828784560690324*^9, 3.828784600773096*^9}, {3.8287846554958344`*^9, 
   3.8287847187259617`*^9}, {3.828784759089761*^9, 3.828784760892899*^9}, {
   3.8287847953066797`*^9, 3.8287848795121107`*^9}, {3.8287850440316687`*^9, 
   3.828785048537334*^9}, {3.828785084825803*^9, 3.828785115284553*^9}, {
   3.828785151577145*^9, 3.828785195518721*^9}, {3.828785233272724*^9, 
   3.8287853538977737`*^9}, 3.828785504123736*^9, {3.8287855520176277`*^9, 
   3.8287855591591787`*^9}, {3.828785641602606*^9, 3.828785644881051*^9}, 
   3.828786083750683*^9, {3.828787354103963*^9, 3.828787354114955*^9}, {
   3.82878739040856*^9, 3.828787408699991*^9}, {3.828787441339563*^9, 
   3.8287875034652853`*^9}, {3.8288760127260303`*^9, 
   3.8288760243529654`*^9}, {3.8288760556679688`*^9, 3.828876086447459*^9}, {
   3.8288912409907722`*^9, 3.828891250625135*^9}, {3.828891286061058*^9, 
   3.8288913171933327`*^9}, {3.8288915292551928`*^9, 
   3.8288915394072227`*^9}, {3.8288915926841908`*^9, 3.828891621142229*^9}, {
   3.828891665103709*^9, 3.828891725243146*^9}, {3.828891760325245*^9, 
   3.8288917643613663`*^9}, {3.828891826657604*^9, 3.828891855810095*^9}, {
   3.828961911441486*^9, 3.828961915299652*^9}, {3.828962182133666*^9, 
   3.828962284563259*^9}, {3.8289623234769373`*^9, 3.828962341212925*^9}, {
   3.828962402693866*^9, 3.828962425532024*^9}, {3.828962481602736*^9, 
   3.8289625934453278`*^9}, {3.8289626288084793`*^9, 3.828962757638905*^9}, {
   3.828962903695163*^9, 3.8289629060938797`*^9}, 3.828962965751552*^9, {
   3.8289630266636047`*^9, 3.828963028356987*^9}, {3.828963217391173*^9, 
   3.828963302111272*^9}, {3.8291251099626493`*^9, 3.829125176885103*^9}, {
   3.829125246171136*^9, 3.829125248804875*^9}, {3.829125290260521*^9, 
   3.829125307234912*^9}, {3.8291255674274807`*^9, 3.829125591298592*^9}, {
   3.829125889056028*^9, 3.829125925722582*^9}, {3.82912596690632*^9, 
   3.829125974322105*^9}, {3.829126004961693*^9, 3.829126015060864*^9}, {
   3.829126063742012*^9, 3.829126133832161*^9}, {3.829126190240814*^9, 
   3.8291262864084053`*^9}, {3.8291263844234962`*^9, 3.829126401538571*^9}, {
   3.82912647329916*^9, 3.8291264964207487`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[181]:=",ExpressionUUID->"944fd8e5-a0d4-42b2-9e51-42c5172f79ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[42]:=",ExpressionUUID->"c721a251-2cdb-4bac-8642-1c4faf2d06a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReciprocalSpaceSimulation", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.6846465171332808`*^9, 
   3.684646521502282*^9}, 
   3.715855140211611*^9},ExpressionUUID->"04173d4a-07e6-4d09-b958-\
71b7b305b8ea"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[822]:=",ExpressionUUID->"e02c667f-3fbb-4d6b-be2f-f63d4abc0477"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalSpaceSimulation", "::", "invalid"}], "=", 
   "\"\<Invalid input form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReciprocalSpaceSimulation", "::", "dep"}], "=", 
    "\"\<The layer vectors are not linearly independent.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ReciprocalSpaceSimulation"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnData\>\"", "\[Rule]", "False"}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ReciprocalSpaceSimulation"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", "_", ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.75671654112061*^9, 3.756716593957822*^9}, {
  3.7567166574260063`*^9, 3.7567166616419697`*^9}, {3.756716757660915*^9, 
  3.756716833968511*^9}, {3.756716882275446*^9, 3.756716918762795*^9}},
 CellLabel->
  "In[823]:=",ExpressionUUID->"e408e3d3-dc2b-485b-807e-b41e22e4853e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[827]:=",ExpressionUUID->"42dcd6a9-b035-4dec-b52c-1e654b6f2c18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReciprocalSpaceSimulation", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"L1_List", ",", "L2_List"}], "}"}], ",", "origin_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"res_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"NumericQ", "[", "#", "]"}], "&&", 
        RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\[Lambda]", ",", "check", ",", "\[IndentingNewLine]", "G", ",", "Ginv", 
      ",", "B", ",", "CrystalDot", ",", "CrystalCross", ",", 
      "\[IndentingNewLine]", "Hx", ",", "Hy", ",", "Hz", ",", "HCx", ",", 
      "HCy", ",", "HCz", ",", "\[IndentingNewLine]", "U", ",", "UB", ",", "o",
       ",", "ref", ",", "refz", ",", "flip", ",", "condition", ",", "pindex", 
      ",", "\[IndentingNewLine]", "\[Epsilon]", ",", "disk", ",", 
      "\[IndentingNewLine]", "hkl", ",", "xy", ",", "pair", ",", "points"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "Input", " ", "check"}], " ", "**)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<ProcessWavelength\>\"", ",", "crystal", ",", "lambda"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"check", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"L1", ",", "L2", ",", "origin"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "check"}], "\[NotEqual]", "9"}], "||", 
        RowBox[{"!", 
         RowBox[{"AllTrue", "[", 
          RowBox[{"check", ",", "NumericQ"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalSpaceSimulation", "::", "invalid"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "vectors", " ", "are", " ", "linearly", " ", 
       "independent"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"L1", ".", "L1"}], ",", 
             RowBox[{"L1", ".", "L2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"L2", ".", "L1"}], ",", 
             RowBox[{"L2", ".", "L2"}]}], "}"}]}], "}"}], "]"}], "\[Equal]", 
        "0"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalSpaceSimulation", "::", "dep"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Metric", " ", "information"}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"G", "=", 
      RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Ginv", "=", 
      RowBox[{"Inverse", "@", "G"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"B", "=", 
      RowBox[{"CholeskyDecomposition", "@", 
       RowBox[{"Inverse", "@", "G"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"*", " ", "Dot"}], "-", " ", 
       RowBox[{
       "and", " ", "cross", " ", "products", " ", "in", " ", "reciprocal", 
        " ", "space"}]}], " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CrystalDot", "[", 
       RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Ginv", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
            RowBox[{
            "u", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "*", 
            
            RowBox[{
            "v", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CrystalCross", "[", 
       RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Sqrt", "@", 
         RowBox[{"Det", "@", "Ginv"}]}], "*", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"Signature", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "*", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"G", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "t"}], "\[RightDoubleBracket]"}], "*", 
                 RowBox[{
                 "u", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
                 "*", 
                 RowBox[{
                 "v", "\[LeftDoubleBracket]", "k", 
                  "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                "\t", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "3"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"t", ",", "3"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Plane", " ", "of", " ", "projection"}], " ", "**)"}],
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Projection", " ", "plane", " ", "in", " ", "reciprocal", " ", 
       "space"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Hx", "=", "L1"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Hy", "=", 
      RowBox[{"L2", "-", 
       RowBox[{"Hx", "*", 
        RowBox[{
         RowBox[{"CrystalDot", "[", 
          RowBox[{"Hx", ",", "L2"}], "]"}], "/", 
         RowBox[{"CrystalDot", "[", 
          RowBox[{"Hx", ",", "Hx"}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Hz", "=", 
      RowBox[{"CrystalCross", "[", 
       RowBox[{"Hx", ",", "Hy"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Components", " ", "in", " ", "Cartesian", " ", "frame"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"HCx", ",", "HCy", ",", "HCz"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Normalize", "[", 
         RowBox[{"B", ".", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "U", " ", "and", " ", "UB", " ", "matrices", " ", "for", " ", 
       "generation", " ", "of", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"U", "=", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ".", 
       RowBox[{"Inverse", "@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"HCx", ",", "HCy", ",", "HCz"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"UB", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{"U", ".", "B"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Reference", " ", "position", " ", "in", " ", "projection"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"o", "=", "origin"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"ref", "=", 
      RowBox[{"UB", ".", "o"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"refz", "=", 
      RowBox[{"ref", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Chop", "[", "origin", "]"}], "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"o", "=", 
         RowBox[{"L1", "+", "L2"}]}], ";", 
        RowBox[{"flip", "=", "True"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"flip", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"condition", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h_", ",", "k_", ",", "l_"}], "}"}], "/;", 
           RowBox[{"h", "\[Equal]", "#1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h_", ",", "k_", ",", "l_"}], "}"}], "/;", 
           RowBox[{"k", "\[Equal]", "#2"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h_", ",", "k_", ",", "l_"}], "}"}], "/;", 
           RowBox[{"l", "\[Equal]", "#3"}]}]}], "\[IndentingNewLine]", "}"}], 
        "&"}], "@@", "o"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"condition", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"condition", ",", 
        RowBox[{"c_", "/;", "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{"flip", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"!", 
            RowBox[{"Equal", "[", 
             RowBox[{
              RowBox[{"c", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0"}],
              "]"}]}], ",", "\[IndentingNewLine]", "\t   ", 
           RowBox[{"Equal", "[", 
            RowBox[{
             RowBox[{"c", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0"}], 
            "]"}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
       "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Constant", " ", "plane", " ", "index"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"pindex", "=", 
      RowBox[{"condition", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"pindex", "=", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{
        "pindex", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "\[Rule]", 
       RowBox[{
       "pindex", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "condition"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"condition", "=", 
         RowBox[{"condition", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"condition", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h_", ",", "k_", ",", "l_"}], "}"}], "/;", "#"}], "&"}], 
          "[", 
          RowBox[{"And", "@@", "condition"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"condition", "=", 
        RowBox[{"First", "@", "condition"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Building"}], " ", "**)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Label", "[", "\"\<Building\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Resolution", ",", " ", 
       RowBox[{"limits", " ", "and", " ", "background"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Epsilon]", "=", "2.0*^-6"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"disk", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"GrayLevel", "[", "0.95", "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Thickness", "[", "Small", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"1", "/", "res"}]}], "]"}]}], "\[IndentingNewLine]", 
          "\t", "}"}], "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Generating", " ", "reflection"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"ReflectionList", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "crystal", ",", "\[Lambda]", ",", "condition", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<HoldIndex\>\"", "\[Rule]", "pindex"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<SplitEquivalent\>\"", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<ShowProgress\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Generating", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"xy", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"UB", ".", "#"}], "-", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "refz"}], "}"}]}], "&"}], "/@", 
         "hkl"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"pair", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"xy", ",", "hkl"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"pair", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"pair", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"CrystalDot", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "]"}], "]"}], "<", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1.01", "*", "res"}], ")"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Return", " ", "data"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ReturnData\>\"", "]"}], ",", 
       RowBox[{"Return", "@", "pair"}]}], "]"}], ";", "\t", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"pair", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tooltip", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"MillerNotationToString", "[", "#2", "]"}]}], "]"}], 
          "\[IndentingNewLine]", "&"}], "@@", "#"}], "&"}], "/@", "pair"}]}], 
     ";", 
     RowBox[{"(*", " ", 
      RowBox[{"TODO", ":", " ", 
       RowBox[{"Check", " ", 
        RowBox[{"if", " ", "@@@", " ", "OK"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"points", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"pair", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"disk", ",", "points", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "#"}], ",", "#"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "#"}], ",", "#"}], "}"}]}], "}"}]}], "&"}], "[", 
        RowBox[{"1.01", "/", "res"}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "\t", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.684745337599188*^9, 3.68474537980447*^9}, {
   3.684745683328042*^9, 3.6847456907977457`*^9}, {3.6847457891850033`*^9, 
   3.684746061305086*^9}, {3.684746141124728*^9, 3.684746199596496*^9}, {
   3.684746239968897*^9, 3.684746476906747*^9}, 3.684746516183593*^9, {
   3.684746565602297*^9, 3.684746701504117*^9}, {3.684747704997624*^9, 
   3.684747714320107*^9}, {3.6847478257793713`*^9, 3.684747830808964*^9}, {
   3.684747904590282*^9, 3.684747909027731*^9}, {3.684747987584041*^9, 
   3.6847479901077967`*^9}, {3.6847480366430817`*^9, 3.684748399057756*^9}, {
   3.684749405159607*^9, 3.684749488355398*^9}, {3.684749543943878*^9, 
   3.6847496737773943`*^9}, {3.684749730279647*^9, 3.684749913917756*^9}, {
   3.684749985476234*^9, 3.684750039391656*^9}, {3.6847500890619307`*^9, 
   3.68475009107802*^9}, {3.6847503748919067`*^9, 3.684750422744948*^9}, {
   3.6847506849349947`*^9, 3.684750753350258*^9}, {3.684750809214427*^9, 
   3.684750839528977*^9}, {3.684750911740037*^9, 3.684751027853921*^9}, {
   3.6847510958058243`*^9, 3.684751169395117*^9}, {3.684751226987747*^9, 
   3.684751247567849*^9}, {3.684751383586632*^9, 3.684751386819116*^9}, {
   3.68475158838805*^9, 3.684751675188871*^9}, {3.684754099955616*^9, 
   3.684754130897352*^9}, {3.685093713849648*^9, 3.685093714753817*^9}, {
   3.6852517446001863`*^9, 3.6852517477297363`*^9}, {3.685767547708188*^9, 
   3.685767548831842*^9}, {3.687001964745152*^9, 3.6870019744028*^9}, {
   3.688107597786675*^9, 3.688107665612611*^9}, {3.688378866613222*^9, 
   3.6883788763885612`*^9}, {3.715855140322721*^9, 3.715855140347814*^9}, 
   3.716186984442049*^9, {3.716187022749711*^9, 3.716187033352743*^9}, {
   3.716187122464801*^9, 3.7161871414482718`*^9}, {3.716187304963607*^9, 
   3.7161873460413733`*^9}, {3.716187548088441*^9, 3.716187564246188*^9}, {
   3.716192286432003*^9, 3.7161922901024637`*^9}, {3.716194204440352*^9, 
   3.7161942070439672`*^9}, 3.7161943234519157`*^9, {3.71619443593258*^9, 
   3.716194438406436*^9}, {3.7162005215789223`*^9, 3.7162005253123217`*^9}, {
   3.7162007764807167`*^9, 3.716200777692432*^9}, {3.716200810422229*^9, 
   3.71620081852131*^9}, {3.716201248093273*^9, 3.71620125822864*^9}, {
   3.716201307218774*^9, 3.7162014183866568`*^9}, {3.7162014891276207`*^9, 
   3.716201507465034*^9}, {3.71620177112007*^9, 3.716201859847453*^9}, {
   3.7162019012791557`*^9, 3.716201930716146*^9}, {3.716201976973514*^9, 
   3.716201989580621*^9}, {3.7177408972749023`*^9, 3.717740919551998*^9}, 
   3.726561495995541*^9, 3.72767528757977*^9, 3.7303561656883583`*^9, 
   3.737968266806053*^9, 3.73796846818062*^9, {3.7455582069859333`*^9, 
   3.7455582232472267`*^9}, 3.745558723080146*^9, {3.758530086078024*^9, 
   3.7585301466442204`*^9}, {3.759071172946664*^9, 3.759071187063505*^9}, {
   3.7595195516945868`*^9, 3.7595195520278387`*^9}, 3.762793093899535*^9, {
   3.7869685987375402`*^9, 3.7869686029430647`*^9}, {3.824540367747983*^9, 
   3.824540396918668*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[828]:=",ExpressionUUID->"4da015ab-4154-4d32-94a1-ef1213dbd9fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[829]:=",ExpressionUUID->"b9fd5268-71e8-4407-8dba-32fdd0911cf2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReflectionList", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105581487666*^9, 3.668188141932252*^9, 3.682827194448793*^9, 
   3.684214417115694*^9},ExpressionUUID->"827dfe21-7a76-4d9a-8cef-\
894f0f616a34"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[830]:=",ExpressionUUID->"8de50706-0438-4dd3-9dde-752f33069857"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "form"}], "=", 
   "\"\<Some reflections are not on a {\!\(\*StyleBox[\"h\", \"TI\"]\), \
\!\(\*StyleBox[\"k\", \"TI\"]\), \!\(\*StyleBox[\"l\", \"TI\"]\)} \
form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "integer"}], "=", 
   "\"\<Some reflection indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "empty"}], "=", 
   "\"\<No reflections match the conditions.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "keep"}], "=", 
   "\"\<Invalid setting for the \[LeftGuillemet]Keep\[RightGuillemet] option.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "index"}], "=", 
   "\"\<Invalid index setting.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReflectionList", "::", "limit"}], "=", 
    "\"\<Limit must be a natural number.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ReflectionList"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<AngleThreshold\>\"", "\[Rule]", 
       RowBox[{"90.", "*", "Degree"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<CustomReflections\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Keep\>\"", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"\"\<Limit\>\"", "\[Rule]", "30"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"\"\<ShowProgress\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<SplitEquivalent\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<HoldIndex\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"'", 
        RowBox[{"ToStandardSetting", "'"}], " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ToStandardSetting\>\"", "\[Rule]", "True"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ReflectionList"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.730356152266515*^9, {3.742022139935775*^9, 3.742022156094028*^9}, {
   3.747570305997864*^9, 3.74757032094812*^9}, {3.7475703848465242`*^9, 
   3.747570395306778*^9}, {3.756716956796039*^9, 3.7567169620983343`*^9}, {
   3.756717130861485*^9, 3.756717131292181*^9}, {3.787040600017569*^9, 
   3.787040601759708*^9}},
 CellLabel->
  "In[831]:=",ExpressionUUID->"c9b6d924-70b9-4265-bad8-efee0b3604f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[839]:=",ExpressionUUID->"e165de8a-cbd6-45ca-8b39-593db2897dbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReflectionList", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
        RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
    "\[IndentingNewLine]", "condition___Condition", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "opt", ",", "i", ",", "v", ",", "h", ",", "k", ",", "l", ",", "hkl"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Optional", ":", " ", 
      RowBox[{
      "Hold", " ", "an", " ", "index", " ", "at", " ", "same", " ", 
       "value"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"opt", "=", 
      RowBox[{"OptionValue", "[", "\"\<HoldIndex\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{
         RowBox[{"Head", "@", "opt"}], "\[Equal]", "Rule"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "v"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"opt", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"StringTake", "[", 
          RowBox[{"i", ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"i", "=", "\"\<None\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[NotEqual]", "\"\<None\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<h\>\"", ",", "\"\<k\>\"", ",", "\"\<l\>\""}], 
              "}"}], ",", "i"}], "]"}]}], "||", 
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", "v", "]"}]}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ReflectionList", "::", "index"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "\"\<h\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", ",", "k", ",", "l"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"i", "\[Equal]", "\"\<k\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h", ",", "v", ",", "l"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"i", "\[Equal]", "\"\<l\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h", ",", "k", ",", "v"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "n"}], ",", "n"}], "]"}], ",", "3"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Remove", " ", 
       RowBox[{"the", " ", "'"}], 
       RowBox[{"000", "'"}], " ", "reflection"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"hkl", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Sorting", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"hkl", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{"Abs", "[", "#", "]"}]}], "&"}], ",", "Negative"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Checking", " ", "if", " ", "extra", " ", "conditions", " ", "are", " ",
        "present"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "condition", "}"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Filtering", " ", "reflections"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"hkl", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{"hkl", ",", "condition"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "hkl"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.6681063146377697`*^9, {3.6681794881585197`*^9, 
   3.6681794908373833`*^9}, 3.668179945997423*^9, {3.66818814657975*^9, 
   3.668188157307557*^9}, {3.6846634286032257`*^9, 3.684663437628909*^9}, {
   3.684666849371333*^9, 3.684666850027832*^9}, {3.684666967261876*^9, 
   3.6846670086191874`*^9}, {3.6846670396091223`*^9, 
   3.6846671042527514`*^9}, {3.684667154917301*^9, 3.684667166534492*^9}, {
   3.685418587482739*^9, 3.685418600803513*^9}, {3.6854196568824778`*^9, 
   3.685419762523224*^9}, {3.6854198033527*^9, 3.685420025866006*^9}, {
   3.6854209220003233`*^9, 3.685420970517354*^9}, {3.685421010676374*^9, 
   3.685421055071308*^9}, {3.6854211041566896`*^9, 3.685421105555825*^9}, {
   3.685768693396085*^9, 3.685768694755793*^9}, {3.7161940339382677`*^9, 
   3.716194068263068*^9}, 3.7161942428531113`*^9, 3.7161943378126307`*^9, {
   3.716194403563705*^9, 3.716194405470615*^9}, {3.716197549021216*^9, 
   3.7161976731716957`*^9}, {3.716197717712677*^9, 3.71619772022684*^9}, {
   3.7161977595993767`*^9, 3.716197788631216*^9}, {3.716197844708214*^9, 
   3.716197847086852*^9}, {3.7161978772508383`*^9, 3.716197881594894*^9}, {
   3.71619791290978*^9, 3.716197954650558*^9}, {3.716197998443026*^9, 
   3.7161980383758698`*^9}, {3.716198109371828*^9, 3.71619815097666*^9}, {
   3.716198220389483*^9, 3.7161982363282843`*^9}, {3.716198272914839*^9, 
   3.7161982897401857`*^9}, {3.716206052767763*^9, 3.7162060916556883`*^9}, {
   3.7162061573118143`*^9, 3.7162061889322157`*^9}, 3.7185177553887987`*^9, {
   3.718517839124168*^9, 3.7185178837692966`*^9}, {3.71851862637221*^9, 
   3.718518632587442*^9}, {3.71851874344134*^9, 3.718518795246827*^9}, {
   3.718518867183139*^9, 3.718518869398591*^9}, 3.718518962141176*^9, {
   3.718518998347128*^9, 3.7185190920731363`*^9}, {3.718519440795792*^9, 
   3.718519442793964*^9}, {3.7185196193513517`*^9, 3.718519699717318*^9}, {
   3.7595195662034073`*^9, 3.759519566505848*^9}, 3.762793093918374*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[840]:=",ExpressionUUID->"703d938f-46bb-40eb-8b18-c0427e8eb3f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReflectionList", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    "condition___Condition", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\[Lambda]", ",", "limit", ",", "H", ",", "\[Theta]", ",", 
      "checkIfEmpty", ",", "custom", ",", "n", ",", "list", ",", 
      "\[IndentingNewLine]", "G", ",", "Ginv", ",", "CrystalDot", ",", "res", 
      ",", "\[IndentingNewLine]", "keep", ",", "options", ",", 
      "angleThreshold", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Progress", " ", "*)"}], "\[IndentingNewLine]", 
      "progress", ",", "total"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Dynamical", " ", "progress"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\"\<Initialisation\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"total", "=", "11"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ShowProgress\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"ProgressIndicator", "@", 
            RowBox[{"Dynamic", "[", 
             RowBox[{
              RowBox[{
              "progress", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "/", "total"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"Dynamic", "@", 
            RowBox[{
            "progress", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "\t", 
          "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Checking", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\"\<Checking input\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<ProcessWavelength\>\"", ",", "crystal", ",", "lambda"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"limit", "=", 
      RowBox[{"OptionValue", "[", "\"\<Limit\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Positive", "[", "limit", "]"}], "&&", 
          RowBox[{"IntegerQ", "[", "limit", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReflectionList", "::", "limit"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "\"\<Defining variables\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"G", "=", 
      RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Ginv", "=", 
      RowBox[{"Inverse", "@", "G"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"H", "=", 
      RowBox[{"N", "@", 
       RowBox[{"Chop", "@", "Ginv"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "hkl_", "]"}], ":=", 
      RowBox[{"N", "[", 
       RowBox[{"ArcSin", "[", 
        RowBox[{"\[Lambda]", "*", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"hkl", ".", "H", ".", "hkl"}], "]"}], "/", "2"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Empty", " ", "list", " ", "check"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"checkIfEmpty", ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"list", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"ReflectionList", "::", "empty"}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Goto", "[", "\"\<ReturnEmpty\>\"", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Use", " ", "custom", " ", "reflections"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "\"\<Custom input\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<CustomReflections\>\"", "]"}]}], ",",
        "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"custom", "=", 
         RowBox[{"OptionValue", "[", "\"\<CustomReflections\>\"", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "custom", " ", "input"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "@", "custom"}], "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"InputCheck", "::", "hkl"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"InputCheck", "[", 
           RowBox[{
           "custom", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
           "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\t", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"list", "=", "custom"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<ListDone\>\"", "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Generating", " ", "a", " ", "reflection", " ", "list"}], " ",
       "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "\"\<Generating a reflection list\>\""}], "}"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Dot", " ", "product", " ", "in", " ", "reciprocal", " ", "space"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CrystalDot", "[", 
       RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Ginv", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
            RowBox[{
            "u", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "*", 
            
            RowBox[{
            "v", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Coarse", " ", "decision", " ", "on", " ", 
       RowBox[{"which", " ", "'"}], 
       RowBox[{"hkl", "'"}], " ", "values", " ", "to", " ", "generate"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"5", ",", "\"\<Deciding which 'hkl' values to generate\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
       RowBox[{"Keys", "@", 
        RowBox[{"Options", "@", "ReflectionList"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"n", "=", "1"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Im", "@", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n", ",", "n"}], "}"}], "]"}]}], "\[Equal]", 
        "0"}], ",", 
       RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"n", ",", "limit"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"ReflectionList", "[", 
       RowBox[{"n", ",", "condition", ",", "options"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "checkIfEmpty", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Filter", " ", "away", " ", "reflections", " ", "with", " ", "complex", 
       " ", "Bragg", " ", "angle"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"6", ",", "\"\<Checking Bragg angles\>\""}], "}"}]}], " ", ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"list", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", "#", "]"}], "\[LessEqual]", "1"}], "&&", 
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "=!=", "Complex"}]}], "&"}], 
          "[", 
          RowBox[{"\[Theta]", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Truncate", " ", "at", " ", "chosen", " ", "angle", " ", 
        "threshold"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"angleThreshold", "=", 
      RowBox[{"OptionValue", "[", "\"\<AngleThreshold\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"0", "\[LessEqual]", "angleThreshold", "<", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"list", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"list", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Theta]", "[", "#", "]"}], "\[LessEqual]", 
             "angleThreshold"}], ")"}], "&"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Resolution", " ", "filtering"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"7", ",", "\"\<Resolution filtering\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"res", "=", 
      RowBox[{"\[Lambda]", "/", "2"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"list", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"CrystalDot", "[", 
            RowBox[{"#", ",", "#"}], "]"}], "]"}], "<", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1.01", "*", "res"}], ")"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "checkIfEmpty", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Filter", " ", "away", " ", "absent", " ", "reflections"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<ListDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"8", ",", "\"\<Filtering away absent reflections\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"Pick", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"list", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"SystematicAbsentQ", "[", 
         RowBox[{"crystal", ",", "list"}], "]"}], ",", "\[IndentingNewLine]", 
        "\t", "False"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     "checkIfEmpty", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{
         RowBox[{"Merge", " ", "symmetry"}], "-", 
         RowBox[{"equivalent", " ", "reflections"}]}]}]}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"9", ",", "\"\<Merging symmetry equivalent reflections\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<SplitEquivalent\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", "Split", " ", "*)"}], "\[IndentingNewLine]", "\t", 
       "Null", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", "Merge", " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"list", "=", 
        RowBox[{
        "MergeSymmetryEquivalentReflections", "[", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"crystal", ",", "list", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<ToStandardSetting\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<ToStandardSetting\>\"", "]"}]}]}],
          "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Limit", " ", "number", " ", "of", " ", "reflections"}]}]}], 
      " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"10", ",", "\"\<Limiting the number of reflections\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"keep", "=", 
      RowBox[{"OptionValue", "[", "\"\<Keep\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"keep", "\[Equal]", "All"}], ",", 
       RowBox[{"keep", "=", 
        RowBox[{"Length", "@", "list"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "keep", "]"}], "&&", 
          RowBox[{"Positive", "[", "keep", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Message", "[", 
        RowBox[{"ReflectionList", "::", "keep"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"11", ",", "\"\<Reflection list done\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"list", ",", 
        RowBox[{"Min", "[", 
         RowBox[{"keep", ",", 
          RowBox[{"Length", "@", "list"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "End", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "list"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<ReturnEmpty\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106184497395*^9, {3.668179282556993*^9, 
   3.668179291738758*^9}, 3.668180181616701*^9, 3.668188149406043*^9, {
   3.6681881979543457`*^9, 3.6681882467050457`*^9}, {3.668188593440853*^9, 
   3.668188694254387*^9}, 3.6681888088447247`*^9, {3.668188844363966*^9, 
   3.668188871474244*^9}, {3.6681889047538137`*^9, 3.668188922729329*^9}, 
   3.668189128709815*^9, {3.668189166268243*^9, 3.668189431749264*^9}, {
   3.668189645376062*^9, 3.668189649240117*^9}, {3.668189804616765*^9, 
   3.668189807470254*^9}, {3.668189838436864*^9, 3.668189884772358*^9}, {
   3.668189929178705*^9, 3.668190023760564*^9}, {3.6681907997252617`*^9, 
   3.668190858100079*^9}, {3.668191260899456*^9, 3.668191322370517*^9}, {
   3.668194280870161*^9, 3.66819428782981*^9}, {3.668196653374757*^9, 
   3.668196677347934*^9}, {3.679758065507057*^9, 3.6797580749954453`*^9}, {
   3.6797581581250477`*^9, 3.679758229415306*^9}, {3.6797582839727993`*^9, 
   3.679758384682056*^9}, {3.67975842843478*^9, 3.679758450522142*^9}, {
   3.67975848234529*^9, 3.679758538264204*^9}, {3.6797588299927883`*^9, 
   3.679758838151547*^9}, {3.679759573704154*^9, 3.6797595780157013`*^9}, {
   3.6816688605634604`*^9, 3.68166886238643*^9}, 3.682761693212624*^9, {
   3.682761776882873*^9, 3.682761783031293*^9}, {3.682761990469831*^9, 
   3.682762067367221*^9}, {3.682762238569338*^9, 3.682762258037012*^9}, {
   3.682762379145604*^9, 3.682762551599121*^9}, {3.6827625926782722`*^9, 
   3.6827626402047586`*^9}, {3.682763068942165*^9, 3.6827630940933104`*^9}, {
   3.682763158201823*^9, 3.682763165807467*^9}, {3.682764974181076*^9, 
   3.682764993909774*^9}, {3.68276795013719*^9, 3.682767951957551*^9}, {
   3.6827683854796124`*^9, 3.6827684355907583`*^9}, {3.682768727648377*^9, 
   3.682768728286333*^9}, {3.682768829821347*^9, 3.6827688433963747`*^9}, 
   3.682769104334716*^9, {3.682769175661327*^9, 3.682769266066882*^9}, 
   3.6827693004348497`*^9, 3.682769417055482*^9, {3.682769455573188*^9, 
   3.682769458940526*^9}, {3.682769607209363*^9, 3.682769627688966*^9}, {
   3.68276970943268*^9, 3.682769728470189*^9}, {3.682769786086359*^9, 
   3.6827697999006023`*^9}, {3.682769838204773*^9, 3.682769852251082*^9}, {
   3.682792225868579*^9, 3.68279222687479*^9}, {3.6827924002405043`*^9, 
   3.682792402616119*^9}, 3.682792574694977*^9, {3.6828253243024063`*^9, 
   3.682825325886156*^9}, {3.6841397853456163`*^9, 3.6841397897886257`*^9}, {
   3.684139855686323*^9, 3.684139909090061*^9}, {3.684140071281108*^9, 
   3.684140072800102*^9}, {3.684140111834372*^9, 3.6841401375080357`*^9}, {
   3.684140171617261*^9, 3.684140367431093*^9}, 3.684140413002187*^9, {
   3.684140607591*^9, 3.684140719518632*^9}, 3.684145330433218*^9, {
   3.684145367821651*^9, 3.68414536950362*^9}, {3.6842136403446903`*^9, 
   3.684213644869915*^9}, {3.684213781858488*^9, 3.684213842590571*^9}, {
   3.684214341919759*^9, 3.6842143481060534`*^9}, {3.684662946378191*^9, 
   3.684663033222123*^9}, {3.684666733281546*^9, 3.6846667335043497`*^9}, {
   3.684666789312871*^9, 3.6846667918438883`*^9}, {3.684667191356744*^9, 
   3.684667230047998*^9}, {3.684667576777402*^9, 3.684667648184586*^9}, {
   3.6846692069053698`*^9, 3.684669239222193*^9}, {3.684669303503991*^9, 
   3.684669304232194*^9}, {3.684669351718648*^9, 3.68466935801514*^9}, {
   3.6846696540499773`*^9, 3.6846697128700647`*^9}, 3.684669821629673*^9, {
   3.684670188061883*^9, 3.684670339910618*^9}, {3.684741565023261*^9, 
   3.684741565191321*^9}, {3.6847416190109797`*^9, 3.6847416192011423`*^9}, {
   3.6847417135516577`*^9, 3.6847417286424093`*^9}, 3.6847440797217293`*^9, {
   3.684745574688994*^9, 3.684745611189694*^9}, {3.684745671918826*^9, 
   3.684745674267671*^9}, {3.684755103228157*^9, 3.684755108576395*^9}, {
   3.684755171923361*^9, 3.684755187463394*^9}, {3.684755246825118*^9, 
   3.684755283342084*^9}, {3.6847553676610107`*^9, 3.684755431665193*^9}, {
   3.684755486352098*^9, 3.684755527993668*^9}, 3.684755583263332*^9, 
   3.6850821865474253`*^9, 3.6850840533478737`*^9, {3.685252116307905*^9, 
   3.685252130289748*^9}, {3.6852521639931173`*^9, 3.6852522099243727`*^9}, {
   3.6852522696028643`*^9, 3.685252305885971*^9}, {3.685299079213583*^9, 
   3.685299128553773*^9}, {3.685421136843091*^9, 3.6854212005008287`*^9}, {
   3.685421247997067*^9, 3.685421273847663*^9}, {3.685421839983242*^9, 
   3.685421881876747*^9}, {3.6854220306738977`*^9, 3.68542211867824*^9}, 
   3.6857659255735283`*^9, {3.685769388710121*^9, 3.685769443166129*^9}, {
   3.685769502208377*^9, 3.6857695272180357`*^9}, {3.685770126995985*^9, 
   3.685770145533038*^9}, {3.685771239786865*^9, 3.685771240255959*^9}, {
   3.685784051382121*^9, 3.6857841117518797`*^9}, {3.685784265618553*^9, 
   3.685784278519128*^9}, {3.685784409071766*^9, 3.685784411110262*^9}, {
   3.685784529872205*^9, 3.6857845940883636`*^9}, {3.685784803091606*^9, 
   3.685784842772554*^9}, {3.686657600224687*^9, 3.686657671699209*^9}, {
   3.6866577115441504`*^9, 3.686657714636054*^9}, {3.686657747010147*^9, 
   3.686657810681427*^9}, {3.6866579946426067`*^9, 3.6866580360676737`*^9}, {
   3.68665807591435*^9, 3.6866582357264347`*^9}, {3.686658270034141*^9, 
   3.6866585330297403`*^9}, {3.686658564917584*^9, 3.686658673625255*^9}, {
   3.686658755022271*^9, 3.686658766266034*^9}, 3.686894057694735*^9, {
   3.6870713455229473`*^9, 3.687071351352529*^9}, {3.6870739076956863`*^9, 
   3.687073920398181*^9}, {3.7143868107397623`*^9, 3.714386844409388*^9}, {
   3.714387107839142*^9, 3.714387129978853*^9}, {3.714455900836638*^9, 
   3.714455905313134*^9}, {3.714457271188592*^9, 3.714457271361904*^9}, {
   3.714457992952488*^9, 3.7144580362802258`*^9}, {3.714458100647457*^9, 
   3.714458104893808*^9}, {3.714458147871139*^9, 3.714458163404636*^9}, {
   3.714458341305675*^9, 3.7144583420726757`*^9}, {3.7147125204212837`*^9, 
   3.714712552375537*^9}, {3.7147129949496403`*^9, 3.714713045261551*^9}, {
   3.714816168307774*^9, 3.7148161969150953`*^9}, {3.714816284113997*^9, 
   3.7148163393843727`*^9}, {3.714816422375482*^9, 3.714816430294612*^9}, {
   3.716193705872978*^9, 3.7161937589650707`*^9}, {3.716193828675597*^9, 
   3.716193905188253*^9}, 3.716194238592029*^9, 3.7161943343865337`*^9, {
   3.7161944090351143`*^9, 3.716194410957553*^9}, {3.7161944865635023`*^9, 
   3.716194488361787*^9}, {3.716194668670053*^9, 3.7161947824000607`*^9}, {
   3.716194928105888*^9, 3.716194929217705*^9}, {3.716194999576075*^9, 
   3.716195018887147*^9}, {3.71619844966753*^9, 3.716198462293277*^9}, {
   3.7161985275653152`*^9, 3.716198541652034*^9}, {3.717740896524231*^9, 
   3.7177409196071587`*^9}, {3.718520024357975*^9, 3.718520050004541*^9}, {
   3.7185204232425213`*^9, 3.7185204317771883`*^9}, {3.7185263265766277`*^9, 
   3.718526358969618*^9}, {3.718526413551124*^9, 3.718526457381061*^9}, {
   3.718526548948234*^9, 3.718526582995021*^9}, {3.7185268790454483`*^9, 
   3.718526883595771*^9}, {3.718526951469385*^9, 3.7185269516031733`*^9}, 
   3.7265615393313313`*^9, 3.727675288396509*^9, 3.727676784192745*^9, 
   3.7301063103561983`*^9, 3.730356159302247*^9, {3.7303566959053307`*^9, 
   3.73035676505906*^9}, {3.7303568110713243`*^9, 3.730356916108645*^9}, {
   3.730357018258333*^9, 3.7303570472177258`*^9}, {3.730357097713035*^9, 
   3.7303571568866863`*^9}, 3.730357226293139*^9, {3.730357395849288*^9, 
   3.730357427671856*^9}, {3.7303574676640463`*^9, 3.730357484270207*^9}, 
   3.737968468305195*^9, {3.742021962959537*^9, 3.7420220175219803`*^9}, {
   3.742022111944613*^9, 3.7420221299270153`*^9}, {3.7420221739832993`*^9, 
   3.742022177446185*^9}, {3.745556959938291*^9, 3.745557003041051*^9}, {
   3.745558561559464*^9, 3.7455585617245617`*^9}, {3.7455586160430117`*^9, 
   3.745558687739943*^9}, {3.745558768953641*^9, 3.745558769946577*^9}, {
   3.74757041908945*^9, 3.747570424961466*^9}, {3.747573253678172*^9, 
   3.747573254773744*^9}, {3.7475733615763073`*^9, 3.747573367401208*^9}, {
   3.7475734376201572`*^9, 3.7475734697721453`*^9}, {3.7475735670941067`*^9, 
   3.7475735891571836`*^9}, {3.747573637757338*^9, 3.7475736438455067`*^9}, {
   3.747573753413155*^9, 3.747573765362599*^9}, {3.747573802571186*^9, 
   3.7475738560600224`*^9}, {3.758530153426703*^9, 3.758530167186606*^9}, {
   3.7595195697667627`*^9, 3.75951957001995*^9}, 3.762793093945218*^9, {
   3.786968610201569*^9, 3.7869686121507483`*^9}, {3.787040611428647*^9, 
   3.787040619699436*^9}, {3.7870407246897917`*^9, 3.7870407299770803`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[841]:=",ExpressionUUID->"f623d9d6-c0b9-4e37-a903-86ee4abacbfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[842]:=",ExpressionUUID->"4e8ef552-6136-4606-976f-d5d216b993ab"]
}, Closed]],

Cell[CellGroupData[{

Cell["RelatedFunctionsGraph", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, {3.7142997886404963`*^9, 
   3.7142997926945553`*^9}},ExpressionUUID->"3281714d-daef-4315-82eb-\
f731c652ca33"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[843]:=",ExpressionUUID->"29c54e72-086c-4f45-b4e5-c2fe3ef5f771"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "RelatedFunctionsGraph"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Limit\>\"", "\[Rule]", "10"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"\"\<DirectOnly\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ShowDependent\>\"", "\[Rule]", "False"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"RelatedFunctionsGraph", ",", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "RelatedFunctionsGraph"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714300336239785*^9, 3.7143003481828947`*^9}, {
  3.714301392171356*^9, 3.714301396387164*^9}, {3.7143023369906797`*^9, 
  3.714302341243659*^9}, {3.730122907680587*^9, 3.730122942623517*^9}, {
  3.7301241679174767`*^9, 3.7301241685476847`*^9}, {3.7567172014584103`*^9, 
  3.756717239957053*^9}},
 CellLabel->
  "In[844]:=",ExpressionUUID->"2f8f298a-0a6f-412d-b9c0-98a84b2c37b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[847]:=",ExpressionUUID->"a31ca584-0ff2-472e-b19d-64b99e5ec492"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RelatedFunctionsGraph", "[", 
    RowBox[{"function_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "f", ",", "allf", ",", "deffile", ",", "import", ",", 
       "\[IndentingNewLine]", "finddepf", ",", "data", ",", "d", ",", "main", 
       ",", "g", ",", "done", ",", "new", ",", "x", ",", "X", ",", "c", ",", 
       "part"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Loading", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"HoldForm", "@", "function"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allf", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"Cases", "[", 
         RowBox[{"$MaXrdFunctions", ",", "_Hyperlink", ",", "Infinity"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"deffile", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Definitions.m\>\""}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"import", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"deffile", ",", "\"\<Text\>\""}], "]"}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Show", " ", "all", " ", "functions", " ", "depedent", " ", 
         RowBox[{"on", " ", "'"}], 
         RowBox[{"f", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<ShowDependent\>\"", "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"data", "=", 
          RowBox[{"StringCases", "[", 
           RowBox[{"import", ",", 
            RowBox[{
             RowBox[{"Shortest", "[", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"c", ":", 
                RowBox[{"(", "allf", ")"}]}], "~~", 
               RowBox[{"{", 
                RowBox[{"\"\<[\>\"", ",", "\"\<:=\>\""}], "}"}], "~~", "d__", 
               "~~", "\"\<End[];\>\""}], "]"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"c", ",", "d"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"x", "=", 
          RowBox[{"Reap", "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"c", "=", 
               RowBox[{"data", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"d", "=", 
               RowBox[{"Sort", "@", 
                RowBox[{"DeleteDuplicates", "@", 
                 RowBox[{"StringCases", "[", 
                  RowBox[{
                   RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   "allf"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"d", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"d", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"Sow", "[", 
               RowBox[{"c", "\[Rule]", "d"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"x", "=", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"part", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"Position", "[", 
            RowBox[{"x", ",", "f"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"g", "=", 
          RowBox[{"First", "/@", 
           RowBox[{
           "x", "\[LeftDoubleBracket]", "part", "\[RightDoubleBracket]"}]}]}],
          ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"g", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"g", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"If", " ", "none"}], ",", " ", 
           RowBox[{"return", " ", "empty", " ", "list"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"g", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"g", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "\[Rule]", "#"}], "&"}], "/@", "g"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Goto", "[", "\"\<GraphDataGenerated\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Function", " ", "for", " ", "finding", " ", "related", " ", 
        "functions"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"finddepf", "[", "F_", "]"}], ":=", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data", "=", 
          RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
           RowBox[{"import", ",", 
            RowBox[{
             RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<Begin[\\\"`Private`\\\"];\>\"", "~~", "Whitespace", "~~", 
               "\[IndentingNewLine]", 
               "\"\<(* ::Input::Initialization:: *)\\n\>\"", "~~", 
               "\[IndentingNewLine]", "F", "~~", 
               RowBox[{"{", 
                RowBox[{"\"\<[\>\"", ",", "\"\<:=\>\""}], "}"}], "~~", "d__", 
               "~~", "\"\<End[];\>\""}], "]"}], "\[IndentingNewLine]", 
             "\[RuleDelayed]", "d"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Check", " ", "if", " ", "anything", " ", "is", " ", "found"}], " ",
           "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"data", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Sort", "@", 
             RowBox[{"StringCases", "[", 
              RowBox[{
               RowBox[{"First", "@", "data"}], ",", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<\\\"\>\"", "~~", "allf", "~~", "\"\<\\\"\>\""}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"allf", "~~", "\"\<::\>\""}], ",", 
                 "\[IndentingNewLine]", "allf"}], "}"}]}], "]"}]}]}]}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"d", ",", "F"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"d", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\\\"\>\"", ",", "\"\<::\>\""}], "}"}]}], 
              "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Seed", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"main", "=", 
       RowBox[{"finddepf", "@", "f"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"main", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Loop", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"done", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"new", "=", 
       RowBox[{"{", "f", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"new", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"First", "@", "new"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"X", "=", 
          RowBox[{"finddepf", "@", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"g", "=", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Join", "[", 
            RowBox[{"g", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[Rule]", "x"}], "&"}], "/@", "X"}]}], "]"}]}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"done", ",", "x"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"new", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"new", ",", "X"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"new", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"new", ",", "done"}], "]"}]}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Label", "[", "\"\<GraphDataGenerated\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"DeleteDuplicatesBy", "[", 
        RowBox[{"g", ",", "Sort"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Only", " ", "directly", " ", "connected"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<DirectOnly\>\"", "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"g", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"g", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a_", "\[Rule]", "b_"}], ")"}], "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "\[NotEqual]", "f"}], "&&", 
              RowBox[{"b", "\[NotEqual]", "f"}]}], ")"}]}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Limiting", " ", "graph"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"g", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"g", ",", 
         RowBox[{"UpTo", "@", 
          RowBox[{"OptionValue", "[", "\"\<Limit\>\"", "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Plot", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"A", ".", " ", "Older"}], " ", "than", " ", "version", " ", 
        "12"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"$VersionNumber", "<", "12."}], ",", "\[IndentingNewLine]", 
        RowBox[{"GraphPlot", "[", 
         RowBox[{"g", ",", "\[IndentingNewLine]", 
          RowBox[{"DirectedEdges", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MultiedgeStyle", "\[Rule]", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"DirectedEdges", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"SelfLoopStyle", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexLabeling", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexRenderingFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"White", ",", 
               RowBox[{"EdgeForm", "[", "]"}], ",", 
               RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"#", "-", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.02", "*", 
                    RowBox[{"StringLength", "@", "#2"}]}], ",", "0.05"}], 
                   "}"}]}], ",", 
                 RowBox[{"#", "+", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.02", "*", 
                    RowBox[{"StringLength", "@", "#2"}]}], ",", "0.05"}], 
                   "}"}]}]}], "]"}], ",", "Black", ",", "\[IndentingNewLine]", 
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Hyperlink", "[", 
                    RowBox[{"#2", ",", " ", 
                    RowBox[{"\"\<paclet:MaXrd/ref/\>\"", "<>", "#2"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "11", ",", 
                   "\"\<Program\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                 "#1"}], "]"}]}], "\[IndentingNewLine]", "}"}], "&"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", "\"\<RadialDrawing\>\""}]}], "]"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Version"}], " ", "12", " ", "and", " ", 
          "above"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"GraphPlot", "[", 
         RowBox[{"g", ",", "\[IndentingNewLine]", 
          RowBox[{"DirectedEdges", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexLabels", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MultiedgeStyle", "\[Rule]", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"DirectedEdges", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"EdgeShapeFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Arrowheads", "[", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "0.5"}], "}"}], "}"}], "]"}], ",", 
               RowBox[{"Arrow", "[", "#1", "]"}]}], "}"}], "&"}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"SelfLoopStyle", "\[Rule]", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexShapeFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"White", ",", 
               RowBox[{"EdgeForm", "[", "]"}], ",", 
               RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"#", "-", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.02", "*", 
                    RowBox[{"StringLength", "@", "#2"}]}], ",", "0.05"}], 
                   "}"}]}], ",", 
                 RowBox[{"#", "+", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.02", "*", 
                    RowBox[{"StringLength", "@", "#2"}]}], ",", "0.05"}], 
                   "}"}]}]}], "]"}], ",", "Black", ",", "\[IndentingNewLine]", 
               RowBox[{"Text", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Hyperlink", "[", 
                    RowBox[{"#2", ",", " ", 
                    RowBox[{"\"\<paclet:MaXrd/ref/\>\"", "<>", "#2"}]}], 
                    "]"}], ",", "\[IndentingNewLine]", "11", ",", 
                   "\"\<Program\>\""}], "]"}], ",", "\[IndentingNewLine]", 
                 "#1"}], "]"}]}], "\[IndentingNewLine]", "}"}], "&"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", "\"\<RadialDrawing\>\""}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.685292929314414*^9, 3.685292949551355*^9}, {
   3.685292980630427*^9, 3.685293093109366*^9}, {3.6852935686996202`*^9, 
   3.685293592607072*^9}, {3.685294304496677*^9, 3.685294312832938*^9}, {
   3.685294359159436*^9, 3.685294392591338*^9}, 3.685294452156907*^9, {
   3.7125585005216303`*^9, 3.712558599149044*^9}, {3.712558653688374*^9, 
   3.712558706404811*^9}, 3.712558740953339*^9, {3.7125590860901546`*^9, 
   3.712559142612122*^9}, {3.7125592016674137`*^9, 3.7125592063906593`*^9}, {
   3.712559401604739*^9, 3.71255953948845*^9}, {3.714299857191777*^9, 
   3.7142999807555943`*^9}, {3.714300353839711*^9, 3.714300370025322*^9}, {
   3.7143006580073347`*^9, 3.71430073426262*^9}, {3.714300764771763*^9, 
   3.714300765044641*^9}, {3.7143009931156893`*^9, 3.714300999489381*^9}, {
   3.714301113534289*^9, 3.714301113829965*^9}, {3.7143020774421186`*^9, 
   3.7143021118228292`*^9}, {3.71430227439701*^9, 3.714302294510023*^9}, {
   3.714302347836523*^9, 3.7143023831981583`*^9}, 3.714302664964923*^9, {
   3.714302722174418*^9, 3.714302735315815*^9}, {3.714302979671762*^9, 
   3.714303016956828*^9}, {3.7143030469840384`*^9, 3.714303104119825*^9}, {
   3.714303151126802*^9, 3.7143031732439528`*^9}, {3.714310925701439*^9, 
   3.714310932964589*^9}, {3.7143142015143538`*^9, 3.7143142638299913`*^9}, {
   3.714314627190888*^9, 3.714314627357841*^9}, {3.717950017228942*^9, 
   3.717950160656786*^9}, {3.730095724552846*^9, 3.730095727188938*^9}, {
   3.730095768792885*^9, 3.7300957955994368`*^9}, {3.730095872367436*^9, 
   3.7300959720295467`*^9}, {3.730096018757462*^9, 3.730096023821756*^9}, {
   3.730096101254458*^9, 3.730096112884797*^9}, {3.7300967599675837`*^9, 
   3.730096761279415*^9}, {3.730104202662957*^9, 3.730104206917555*^9}, {
   3.730379169007759*^9, 3.73037924742875*^9}, {3.730379446001863*^9, 
   3.730379450823716*^9}, {3.7303794992640257`*^9, 3.7303795127738*^9}, {
   3.742028275962288*^9, 3.742028294205703*^9}, {3.742028329004146*^9, 
   3.7420283507206287`*^9}, 3.74383537227837*^9, 3.743865333765183*^9, 
   3.743865412706151*^9, {3.7585301688581333`*^9, 3.758530188625404*^9}, {
   3.759519602241129*^9, 3.759519602530651*^9}, {3.7595203688037148`*^9, 
   3.759520376673492*^9}, 3.7627930939740047`*^9, {3.7649589363130217`*^9, 
   3.76495912586209*^9}, {3.7649593010903053`*^9, 3.7649593245996313`*^9}, {
   3.7649593872074966`*^9, 3.7649594233680563`*^9}, {3.764959564540421*^9, 
   3.7649596370674343`*^9}, 3.7962796474404917`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[848]:=",ExpressionUUID->"82ad48fa-3fdb-42a7-be2a-922fe52a5383"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[849]:=",ExpressionUUID->"e86b04d9-1495-4847-923f-483dbb909ae9"]
}, Closed]],

Cell[CellGroupData[{

Cell["ResetCrystalData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.7609498283827267`*^9, 3.76094983161379*^9}, {
   3.770459739768036*^9, 3.770459744809925*^9}, {3.780063537050106*^9, 
   3.780063541952429*^9}, {3.7870319331298237`*^9, 
   3.7870319370494747`*^9}},ExpressionUUID->"852fcbad-2f52-4e7d-8950-\
c68d543c7794"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[850]:=",ExpressionUUID->"8788a153-6adf-46c8-a995-29dfb6d2acd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ResetCrystalData", "::", "DemoDataNotFound"}], "=", 
    "\"\<Demo data not found.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ResetCrystalData"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
   3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
   3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
   3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
   3.756710476208014*^9}, {3.76094984995916*^9, 3.760949866421854*^9}, {
   3.762482676390929*^9, 3.762482706347602*^9}, {3.762487787402885*^9, 
   3.762487787935628*^9}, {3.7704597473877983`*^9, 3.77045978202227*^9}, {
   3.770459933601384*^9, 3.770459936167313*^9}, {3.7704666896136217`*^9, 
   3.770466697612974*^9}, {3.7706146521036377`*^9, 3.770614679663534*^9}, {
   3.770616146185195*^9, 3.7706161787997923`*^9}, 3.7706163538198566`*^9, {
   3.770625540633625*^9, 3.770625595637392*^9}, {3.7709815083625593`*^9, 
   3.7709815150338287`*^9}, 3.770981562273196*^9, {3.770981597932929*^9, 
   3.770981604782627*^9}, {3.7709821387767553`*^9, 3.7709821576086407`*^9}, {
   3.770982202460527*^9, 3.770982202767514*^9}, {3.77098268625275*^9, 
   3.770982724146615*^9}, {3.770982893187273*^9, 3.770982895507979*^9}, {
   3.770982949179625*^9, 3.770982949860483*^9}, {3.7711389640232897`*^9, 
   3.771138996795042*^9}, {3.771139678009183*^9, 3.771139681253922*^9}, {
   3.771139711505148*^9, 3.771139718197137*^9}, {3.771140266242723*^9, 
   3.7711402801712523`*^9}, {3.771234573160223*^9, 3.771234576247919*^9}, {
   3.7790453782528954`*^9, 3.779045425619176*^9}, {3.7790763711444902`*^9, 
   3.779076372527687*^9}, {3.779080400658866*^9, 3.779080417177166*^9}, {
   3.779093001463686*^9, 3.779093012877165*^9}, {3.779132451747096*^9, 
   3.779132451903741*^9}, {3.78167905421262*^9, 3.7816790591864758`*^9}, {
   3.781858765887219*^9, 3.781858768500503*^9}, {3.781858893507841*^9, 
   3.7818589180501623`*^9}, 3.781858968592648*^9, {3.781859020439496*^9, 
   3.781859042239254*^9}, 3.7818594429947987`*^9, {3.781864037272621*^9, 
   3.781864044712007*^9}, {3.781969992136195*^9, 3.781969995797161*^9}, {
   3.78202897837047*^9, 3.782028979881863*^9}, {3.782040949317198*^9, 
   3.782040958595056*^9}, 3.782047378521851*^9, {3.782047741561439*^9, 
   3.7820477894554*^9}, {3.782050918112599*^9, 3.782050918255136*^9}, {
   3.782051029102474*^9, 3.7820510312687397`*^9}, {3.7870319541791973`*^9, 
   3.7870319591295424`*^9}, {3.7870330708848333`*^9, 3.787033124745767*^9}},
 CellLabel->
  "In[851]:=",ExpressionUUID->"b13ba222-1c39-48bc-8988-1d3336c1f26c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[853]:=",ExpressionUUID->"0bd3cdd9-8f8f-4bce-94da-34e3342614d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetCrystalData", "[", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"demoFile", ",", "newDataFile"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"demoFile", "=", 
      RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<CrystalDataDemo.m\>\""}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "demoFile"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ResetCrystalData", "::", "DemoDataNotFound"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newDataFile", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<UserData\>\"", ",", "\"\<CrystalData.m\>\""}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CopyFile", "[", 
      RowBox[{"demoFile", ",", "newDataFile", ",", 
       RowBox[{"OverwriteTarget", "\[Rule]", "True"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$CrystalData", "=", 
      RowBox[{"Import", "@", "newDataFile"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Keys", "@", "$CrystalData"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.7609498833793907`*^9, 3.76094989465484*^9}, {
   3.760985435505022*^9, 3.760985472615333*^9}, {3.761044721985759*^9, 
   3.7610447510077763`*^9}, {3.76104481522427*^9, 3.761044820157362*^9}, {
   3.76104492312523*^9, 3.76104492561299*^9}, {3.761045245983004*^9, 
   3.7610452901170893`*^9}, {3.761045366668412*^9, 3.761045378723996*^9}, {
   3.76124639061635*^9, 3.761246410336463*^9}, {3.761246468837595*^9, 
   3.761246470395545*^9}, {3.761246673739036*^9, 3.761246692142757*^9}, {
   3.761246756527741*^9, 3.761246831173169*^9}, {3.7612468685554323`*^9, 
   3.761246869827717*^9}, {3.7612469112124767`*^9, 3.761247051614558*^9}, {
   3.761247130070651*^9, 3.7612471343322563`*^9}, {3.761247190774343*^9, 
   3.761247226696908*^9}, {3.7612472608003902`*^9, 3.761247277095755*^9}, {
   3.7612473349529333`*^9, 3.761247347238995*^9}, {3.761247379119833*^9, 
   3.761247382237371*^9}, {3.761247500765175*^9, 3.761247531645439*^9}, {
   3.761247581531475*^9, 3.761247581665276*^9}, {3.76124761695472*^9, 
   3.761247712374427*^9}, {3.7612478775715733`*^9, 3.7612479024911127`*^9}, {
   3.761248027065674*^9, 3.7612480322790403`*^9}, {3.761248133261649*^9, 
   3.761248133821176*^9}, {3.762483079092483*^9, 3.762483079506445*^9}, {
   3.7624831653076982`*^9, 3.762483255155518*^9}, {3.762483448748105*^9, 
   3.762483459337694*^9}, {3.762484937954467*^9, 3.762484940528129*^9}, {
   3.762485478717585*^9, 3.762485519250081*^9}, {3.762485687785385*^9, 
   3.7624856997759*^9}, {3.762485763767784*^9, 3.7624857909884033`*^9}, {
   3.762485821389303*^9, 3.762485821901321*^9}, {3.762485865116181*^9, 
   3.76248587338028*^9}, {3.7624863035622253`*^9, 3.762486306889323*^9}, 
   3.7624864059931593`*^9, {3.762486451749774*^9, 3.762486453088664*^9}, {
   3.762486658295171*^9, 3.762486679735591*^9}, {3.762486914173285*^9, 
   3.762486976278838*^9}, {3.762487161588236*^9, 3.762487164161865*^9}, {
   3.762582301146738*^9, 3.762582302868475*^9}, {3.7625825420446243`*^9, 
   3.7625825422070208`*^9}, 3.7627930931894283`*^9, {3.763708440950055*^9, 
   3.763708444458358*^9}, {3.763795706131096*^9, 3.76379571208855*^9}, {
   3.763795807464473*^9, 3.763795831454368*^9}, {3.767429560180451*^9, 
   3.767429568446164*^9}, 3.770459731594898*^9, 3.77045978949087*^9, {
   3.7704599395191603`*^9, 3.770459942350878*^9}, {3.770460320192504*^9, 
   3.77046034225856*^9}, {3.770460744443172*^9, 3.770460790673462*^9}, {
   3.770462722783415*^9, 3.770462726522499*^9}, {3.770462870041655*^9, 
   3.770462893092216*^9}, {3.770463235775403*^9, 3.770463354490316*^9}, {
   3.770464803344589*^9, 3.7704649431280527`*^9}, {3.7704649769113207`*^9, 
   3.770464999988723*^9}, {3.7704651173818903`*^9, 3.770465120129682*^9}, {
   3.770465209927898*^9, 3.770465248981803*^9}, {3.7704652797498713`*^9, 
   3.770465415928398*^9}, {3.770465537455702*^9, 3.7704655656201468`*^9}, {
   3.770465641152669*^9, 3.770465644794568*^9}, {3.770466103176922*^9, 
   3.7704661912147818`*^9}, {3.7704662256847267`*^9, 3.770466424544442*^9}, {
   3.77046647576213*^9, 3.77046647708055*^9}, {3.7704666316257477`*^9, 
   3.770466663729806*^9}, {3.770569455033873*^9, 3.77056947362365*^9}, {
   3.770569965186427*^9, 3.770569975517632*^9}, {3.770613455882739*^9, 
   3.7706134615311623`*^9}, {3.7706144368471527`*^9, 3.770614455550804*^9}, {
   3.770614642444923*^9, 3.770614648346962*^9}, {3.7706146872518663`*^9, 
   3.770614706809328*^9}, {3.770615780706581*^9, 3.770615837875382*^9}, {
   3.770616067975326*^9, 3.770616161127016*^9}, {3.770616281788673*^9, 
   3.770616338679316*^9}, {3.770616527688498*^9, 3.770616578229919*^9}, {
   3.770617519347665*^9, 3.770617618502255*^9}, {3.770617715683031*^9, 
   3.770617752463728*^9}, {3.770618116138035*^9, 3.7706181296219597`*^9}, {
   3.770618161047112*^9, 3.770618195582769*^9}, {3.77061840921166*^9, 
   3.770618429996653*^9}, {3.7706188774711227`*^9, 3.770618880463545*^9}, {
   3.77061898635938*^9, 3.7706190570356627`*^9}, {3.7706191262161617`*^9, 
   3.770619143850253*^9}, {3.770620393630209*^9, 3.770620411752057*^9}, {
   3.7706205414208717`*^9, 3.770620595073638*^9}, {3.770620635698071*^9, 
   3.770620694965639*^9}, {3.770621285358365*^9, 3.7706213228053513`*^9}, {
   3.770621746590682*^9, 3.770621913127598*^9}, {3.7706250264948063`*^9, 
   3.7706250284066973`*^9}, {3.770625143129756*^9, 3.770625145122254*^9}, {
   3.770625196698786*^9, 3.770625226825259*^9}, {3.770625271797394*^9, 
   3.770625299948307*^9}, {3.770625340917306*^9, 3.7706253455065393`*^9}, {
   3.770625406711595*^9, 3.770625439263268*^9}, {3.770625484959586*^9, 
   3.7706254896638517`*^9}, {3.7706255324719887`*^9, 3.770625536534584*^9}, {
   3.770625601643078*^9, 3.770625660115859*^9}, {3.7706269748593388`*^9, 
   3.770626983180786*^9}, {3.770978748150028*^9, 3.770978844135597*^9}, {
   3.770981565611477*^9, 3.7709815849544163`*^9}, {3.771139352384213*^9, 
   3.771139435725677*^9}, {3.771141989286028*^9, 3.7711419920245047`*^9}, {
   3.771143011683299*^9, 3.771143018616251*^9}, {3.771143059910726*^9, 
   3.771143079334529*^9}, {3.771143112487186*^9, 3.771143118121806*^9}, {
   3.771143199801591*^9, 3.771143243956092*^9}, {3.771143352696369*^9, 
   3.7711433596184072`*^9}, {3.7742037135564613`*^9, 3.77420371903445*^9}, {
   3.7790460331623583`*^9, 3.779046038683786*^9}, {3.7790465556133432`*^9, 
   3.779046557949313*^9}, {3.7790466210358686`*^9, 3.779046629035347*^9}, {
   3.779076173162829*^9, 3.779076186108962*^9}, {3.779076376706129*^9, 
   3.7790764050721207`*^9}, {3.77907707240198*^9, 3.7790770727759323`*^9}, {
   3.779077116904462*^9, 3.7790771363191557`*^9}, {3.779077222030397*^9, 
   3.7790772451963463`*^9}, {3.779077278292552*^9, 3.779077293810793*^9}, {
   3.779077327756048*^9, 3.7790773461225557`*^9}, {3.779077400971356*^9, 
   3.779077401392465*^9}, {3.779078652836025*^9, 3.779078674233534*^9}, {
   3.7790789366442738`*^9, 3.77907905698431*^9}, {3.779080313783312*^9, 
   3.779080335990597*^9}, {3.7790804083883467`*^9, 3.779080409644253*^9}, {
   3.7790805587124434`*^9, 3.7790805924157047`*^9}, {3.779080668254277*^9, 
   3.779080748955948*^9}, 3.779080921313138*^9, {3.7790812563695297`*^9, 
   3.77908127282437*^9}, {3.779081329711192*^9, 3.779081329862935*^9}, {
   3.779081417629828*^9, 3.779081417885152*^9}, {3.7790815112035303`*^9, 
   3.779081567874836*^9}, {3.77908160297834*^9, 3.779081605410418*^9}, 
   3.779081642634364*^9, {3.779081818726289*^9, 3.779081818836506*^9}, {
   3.779081927827957*^9, 3.779081942290485*^9}, 3.7790819834125433`*^9, {
   3.779082026115778*^9, 3.7790820572111673`*^9}, {3.779082093109037*^9, 
   3.7790820934351387`*^9}, {3.779082505418542*^9, 3.779082582504551*^9}, {
   3.779082618161819*^9, 3.779082631974813*^9}, {3.7790833281717787`*^9, 
   3.7790833468169813`*^9}, {3.77908339321735*^9, 3.779083393359188*^9}, {
   3.779092931617548*^9, 3.779092941695651*^9}, 3.779092984373472*^9, 
   3.779093025471065*^9, {3.779093233015196*^9, 3.779093283089419*^9}, {
   3.779093347114683*^9, 3.779093358570322*^9}, {3.779093403195031*^9, 
   3.7790934294666843`*^9}, {3.779093483226296*^9, 3.779093671972971*^9}, {
   3.7790938415876703`*^9, 3.779093852432088*^9}, {3.7790943233708687`*^9, 
   3.77909436834396*^9}, {3.779132230691679*^9, 3.779132232130753*^9}, {
   3.7791322913529873`*^9, 3.779132328976726*^9}, {3.77913238294314*^9, 
   3.7791323831025457`*^9}, {3.779132416197893*^9, 3.779132481875678*^9}, {
   3.77913259690576*^9, 3.7791325984885693`*^9}, {3.779132633232272*^9, 
   3.7791327488973618`*^9}, {3.7791328356007566`*^9, 3.779132910565886*^9}, {
   3.779133291303643*^9, 3.77913350030802*^9}, {3.779133718247943*^9, 
   3.779133783523141*^9}, {3.779133814469346*^9, 3.779133815579176*^9}, {
   3.7791338790756273`*^9, 3.779133927424109*^9}, {3.779134513294778*^9, 
   3.779134564659233*^9}, {3.779134801244445*^9, 3.7791348453220997`*^9}, {
   3.7794598997260113`*^9, 3.779459946548224*^9}, {3.779459993534259*^9, 
   3.779460003612535*^9}, {3.77946003619566*^9, 3.7794600405698*^9}, {
   3.779460177055881*^9, 3.7794601841982183`*^9}, {3.779465818564105*^9, 
   3.779465837840556*^9}, {3.77946587589717*^9, 3.779465898190446*^9}, {
   3.779465943255336*^9, 3.779466009822507*^9}, {3.77946625854605*^9, 
   3.779466264350567*^9}, {3.7794707100815363`*^9, 3.779470791459454*^9}, {
   3.7794708372044983`*^9, 3.7794708430662127`*^9}, {3.7794708736280003`*^9, 
   3.779470889041346*^9}, {3.779471386472715*^9, 3.779471387758445*^9}, {
   3.7794727024761457`*^9, 3.779472704537242*^9}, {3.7794729380386343`*^9, 
   3.779472947702175*^9}, {3.779473633377185*^9, 3.7794736351008883`*^9}, {
   3.779475306395953*^9, 3.779475308136442*^9}, {3.7795148511524153`*^9, 
   3.7795148554943247`*^9}, {3.7795152637427387`*^9, 3.779515301748084*^9}, {
   3.780041526108283*^9, 3.780041530545414*^9}, 3.780063501754696*^9, 
   3.781596783619473*^9, {3.781596814488657*^9, 3.781596817344576*^9}, {
   3.781597055565585*^9, 3.781597081643642*^9}, {3.781597372942129*^9, 
   3.781597449355983*^9}, 3.781597759959477*^9, {3.7815996008325872`*^9, 
   3.7815996024712973`*^9}, {3.781599723813806*^9, 3.781599730684422*^9}, {
   3.781600289730597*^9, 3.78160029352064*^9}, 3.781600331425515*^9, {
   3.781600542107935*^9, 3.7816005503132753`*^9}, {3.781606643808066*^9, 
   3.781606646222434*^9}, {3.781606763687199*^9, 3.7816067643638144`*^9}, {
   3.7816072419548883`*^9, 3.7816072436566353`*^9}, {3.781607906428276*^9, 
   3.781607907481904*^9}, {3.781607965811386*^9, 3.7816080279750423`*^9}, {
   3.7816080690164967`*^9, 3.781608114413293*^9}, {3.781608198188738*^9, 
   3.781608281394578*^9}, {3.781609293939601*^9, 3.781609309321006*^9}, {
   3.781609476678388*^9, 3.7816094801574097`*^9}, 3.781609556669264*^9, {
   3.781609683361212*^9, 3.781609686256384*^9}, {3.78161226738934*^9, 
   3.78161233215441*^9}, {3.781612442856462*^9, 3.781612470687945*^9}, {
   3.781612593701033*^9, 3.781612631084622*^9}, 3.781614972562765*^9, {
   3.78161524014813*^9, 3.781615240681616*^9}, {3.781615280010507*^9, 
   3.781615290704727*^9}, {3.78161541399857*^9, 3.781615425909526*^9}, {
   3.7816154736611433`*^9, 3.781615539875*^9}, {3.7816155713078127`*^9, 
   3.781615571498477*^9}, {3.781615747215444*^9, 3.781615757366866*^9}, {
   3.781615873272184*^9, 3.7816158734864397`*^9}, {3.7816171015648518`*^9, 
   3.781617130618442*^9}, {3.7816172619773083`*^9, 3.781617263519547*^9}, {
   3.781617481461182*^9, 3.781617482962484*^9}, 3.781617575922841*^9, {
   3.781618101416605*^9, 3.781618102797927*^9}, 3.781618141367907*^9, 
   3.781618245733841*^9, {3.781618387001913*^9, 3.7816183961276197`*^9}, {
   3.7816184695118313`*^9, 3.7816184704617167`*^9}, {3.781618615076729*^9, 
   3.7816186336349707`*^9}, 3.781618678844316*^9, {3.781619582992181*^9, 
   3.7816195836770267`*^9}, {3.7816199327591677`*^9, 3.78161993293364*^9}, {
   3.781619983269676*^9, 3.781619984443877*^9}, {3.781620183776043*^9, 
   3.78162019139979*^9}, {3.781620291456691*^9, 3.781620313028677*^9}, 
   3.781620348773815*^9, 3.781620746029769*^9, {3.78162638436092*^9, 
   3.781626425862638*^9}, {3.781626476431323*^9, 3.781626557691691*^9}, {
   3.781626623884338*^9, 3.781626653401774*^9}, {3.781626729226215*^9, 
   3.781626757215386*^9}, {3.7816268006405373`*^9, 3.7816268463655767`*^9}, 
   3.7816286423998957`*^9, {3.781675057590191*^9, 3.781675076043709*^9}, {
   3.781675556202602*^9, 3.781675642120433*^9}, {3.7816760877603693`*^9, 
   3.781676088950032*^9}, {3.781676158959507*^9, 3.7816762177647467`*^9}, {
   3.781676248133177*^9, 3.781676258405087*^9}, {3.7816790865172863`*^9, 
   3.781679095989188*^9}, {3.7816840064262733`*^9, 3.781684015497168*^9}, {
   3.7816842035970383`*^9, 3.781684203932811*^9}, {3.781684438728621*^9, 
   3.781684441383614*^9}, {3.781684490448798*^9, 3.781684518917966*^9}, {
   3.781684556016069*^9, 3.781684566372897*^9}, {3.781684623556603*^9, 
   3.781684624251807*^9}, {3.7816853526858253`*^9, 3.781685376699265*^9}, {
   3.7816855053767853`*^9, 3.7816855065285807`*^9}, {3.7816855453693533`*^9, 
   3.781685567511063*^9}, {3.781685858875183*^9, 3.78168589982563*^9}, 
   3.781686268609694*^9, {3.781686319248898*^9, 3.7816863194304667`*^9}, {
   3.781686558594583*^9, 3.7816865697534018`*^9}, {3.781859099531748*^9, 
   3.781859156506374*^9}, 3.781859387281911*^9, {3.7818640218257923`*^9, 
   3.781864056813308*^9}, {3.782028552703998*^9, 3.782028587020403*^9}, {
   3.782028941257493*^9, 3.782028942348991*^9}, {3.782029000341112*^9, 
   3.782029035539669*^9}, {3.782029162657709*^9, 3.7820292105949497`*^9}, {
   3.782029266088305*^9, 3.782029294559512*^9}, 3.782030123182132*^9, {
   3.78203020980309*^9, 3.782030213682626*^9}, {3.782030596516942*^9, 
   3.782030597130456*^9}, {3.782030825094961*^9, 3.782030845981477*^9}, {
   3.782032369880467*^9, 3.78203237584664*^9}, {3.782032586572319*^9, 
   3.782032587257971*^9}, {3.782032630824499*^9, 3.782032655001327*^9}, {
   3.7820328091188374`*^9, 3.782032812029166*^9}, {3.782033252832946*^9, 
   3.782033285918296*^9}, {3.7820338684922333`*^9, 3.782033877553089*^9}, {
   3.782033917594111*^9, 3.782033928808517*^9}, {3.782034734097344*^9, 
   3.782034736176887*^9}, {3.782038710823208*^9, 3.782038745308548*^9}, {
   3.7820388946504107`*^9, 3.782038914773587*^9}, {3.782039126909801*^9, 
   3.782039140700597*^9}, {3.782040320476921*^9, 3.7820403474826803`*^9}, {
   3.782040796362956*^9, 3.782040799889357*^9}, {3.7820408459531097`*^9, 
   3.7820408674393263`*^9}, {3.782041161235155*^9, 3.782041162649029*^9}, {
   3.782041636816414*^9, 3.782041637030972*^9}, {3.7820417197994337`*^9, 
   3.78204175356588*^9}, {3.782042230212246*^9, 3.782042234657852*^9}, {
   3.782044974967266*^9, 3.782044975926011*^9}, {3.782045012869179*^9, 
   3.782045015749069*^9}, {3.786968107875774*^9, 3.7869681094012403`*^9}, {
   3.78703196677178*^9, 3.7870320229533157`*^9}, {3.787033001512012*^9, 
   3.787033068131708*^9}, {3.7870331281146812`*^9, 3.787033159201231*^9}, {
   3.787033244400178*^9, 3.787033388885934*^9}, {3.787033443795807*^9, 
   3.787033493938999*^9}, {3.787033541459556*^9, 3.787033541993394*^9}, {
   3.7870580239863243`*^9, 3.7870580252812223`*^9}, {3.787465796973877*^9, 
   3.7874658315161057`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[854]:=",ExpressionUUID->"9a39f10d-7398-423b-992b-4d7e561594f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[855]:=",ExpressionUUID->"7631d709-8fbd-4541-9ced-a8e3836fce5e"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimulateDiffractionPattern", "Subchapter",
 CellChangeTimes->{{3.763444064601392*^9, 3.76344406604885*^9}, {
   3.763444882154315*^9, 3.7634448855357943`*^9}, 3.783097311011979*^9, {
   3.783672514368661*^9, 
   3.78367251967959*^9}},ExpressionUUID->"a2f3384b-da85-4b8b-a764-\
3edf6647d56c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[856]:=",ExpressionUUID->"d00f6130-c156-4e35-a3eb-125f012200ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "InvalidStructureInput"}], 
   "=", "\"\<Structural input must be a crystal label or the path to one or \
more structure files.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "InvalidInputForDIFFUSE"}], 
   "=", "\"\<If not using a crystal label with DIFFUSE, input should be two \
structure files.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "InvalidReciprocalPlane"}], 
   "=", "\"\<Invalid reciprocal plane input.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "SimulateDiffractionPattern", "::", "InvalidReciprocalSpaceLimit"}], "=", 
   "\"\<Invalid setting for \\\"IndicesLimit\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "ZeroIntensity"}], "=", 
   "\"\<No intensity found in data.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "MissingOutputData"}], "=", 
   "\"\<Unable to import the expected output data.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "MissingProgram"}], "=", 
   "\"\<`1` does not appear to be installed.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "InvalidPrint"}], "=", 
   "\"\<Invalid print setting.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "InvalidFormat"}], "=", 
   "\"\<Structure file seems to be invalid.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "UnsupportedProgram"}], "=", 
   "\"\<The program \[LeftGuillemet]`1`\[RightGuillemet] is not \
supported.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "InvalidSubtractionMode"}], 
   "=", "\"\<Invalid scattering subtraction mode.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateDiffractionPattern", "::", "InvalidScalingFactor"}], "=", 
   "\"\<The scaling factor must be a number.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimulateDiffractionPattern", "::", "InvalidImageDimensions"}], 
    "=", "\"\<Image dimension must be a pair of natural numbers.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "SimulateDiffractionPattern"}], "=", 
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"Union", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Association", "@", 
          RowBox[{"Options", "@", "ArrayPlot"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Options", "@", "ListDensityPlot"}]}], ",", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "\"\<BraggScatteringSubtractionMode\>\"", "\[Rule]", "None"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<ImageDimensions\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"500", ",", "500"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<IndicesLimit\>\"", "\[Rule]", "5.5"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<LowerCutoff\>\"", "\[Rule]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<PrintOutput\>\"", "\[Rule]", "\"\<ErrorsOnly\>\""}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<ProgramPaths\>\"", "\[Rule]", 
            RowBox[{"<|", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<MacOSX\>\"", "\[Rule]", 
               RowBox[{"<|", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "\"\<DISCUS\>\"", "\[Rule]", 
                  "\"\</usr/local/bin/discus_suite\>\""}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<DIFFUSE\>\"", "\[Rule]", "\"\</usr/local/bin\>\""}]}], 
                "|>"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<Unix\>\"", "\[Rule]", 
               RowBox[{"<|", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "\"\<DISCUS\>\"", "\[Rule]", 
                  "\"\</usr/local/bin/discus_suite\>\""}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<DIFFUSE\>\"", "\[Rule]", "\"\</usr/local/bin\>\""}]}], 
                "|>"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<Windows\>\"", "\[Rule]", 
               RowBox[{"<|", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "\"\<DISCUS\>\"", "\[Rule]", 
                  "\"\<C:\\\\Program Files \
(x86)\\\\Discus\\\\bin\\\\discus_suite.exe\>\""}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<DIFFUSE\>\"", "\[Rule]", 
                  "\"\<C:\\\\Program Files (x86)\\\\DIFFUSE\>\""}]}], 
                "|>"}]}]}], "\[IndentingNewLine]", "|>"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ReturnData\>\"", "\[Rule]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ScalingFactor\>\"", "\[Rule]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<UseRawInput\>\"", "\[Rule]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "ArrayPlot", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ColorFunction", "\[Rule]", "\"\<Warm\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotLegends", "\[Rule]", "None"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log\>\""}]}], 
          "\[IndentingNewLine]", "|>"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "SimulateDiffractionPattern"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "SimulateDiffractionPattern", ",", "ArrayPlot", ",", 
          "ListDensityPlot"}], "}"}], "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.763445624779664*^9, 3.763445686877882*^9}, {
   3.763446827703247*^9, 3.763446851739916*^9}, {3.763459137812879*^9, 
   3.763459159400999*^9}, {3.763460407156082*^9, 3.7634604270211763`*^9}, {
   3.763460879705531*^9, 3.7634608799177217`*^9}, {3.7634611369362698`*^9, 
   3.763461181849065*^9}, {3.763461802610026*^9, 3.763461814042543*^9}, {
   3.7634620731605463`*^9, 3.763462073250914*^9}, {3.7637272431407347`*^9, 
   3.763727246603532*^9}, {3.7637273354175863`*^9, 3.7637273393120728`*^9}, {
   3.763733822444703*^9, 3.763733848874445*^9}, {3.763733885090323*^9, 
   3.763733910881673*^9}, {3.763741487318953*^9, 3.763741487476125*^9}, {
   3.7639819240078297`*^9, 3.763981933163786*^9}, {3.7639895562481728`*^9, 
   3.763989561727191*^9}, {3.763989644582782*^9, 3.763989667316599*^9}, {
   3.763989717613975*^9, 3.763989734380048*^9}, {3.7640778295344257`*^9, 
   3.764077830860199*^9}, 3.764077899369711*^9, {3.764941311125005*^9, 
   3.76494134525064*^9}, {3.7650176254441147`*^9, 3.7650176646684275`*^9}, {
   3.7650957385106173`*^9, 3.7650957794381866`*^9}, {3.7650962259548445`*^9, 
   3.765096275433786*^9}, {3.765097982746771*^9, 3.765098003458448*^9}, {
   3.7676047864218817`*^9, 3.767604789484498*^9}, {3.7676052202026577`*^9, 
   3.767605222410295*^9}, {3.767690687431369*^9, 3.767690691193523*^9}, {
   3.7679321081231117`*^9, 3.767932108609775*^9}, {3.768038211959003*^9, 
   3.7680382122696533`*^9}, {3.768073165997078*^9, 3.768073187538875*^9}, {
   3.774253347474133*^9, 3.77425335227761*^9}, {3.783097326600726*^9, 
   3.783097330543642*^9}, {3.78309761494254*^9, 3.7830977397909822`*^9}, {
   3.783098013501504*^9, 3.783098032419837*^9}, {3.7830984579709063`*^9, 
   3.78309849056133*^9}, {3.7831086038978024`*^9, 3.783108714645105*^9}, {
   3.783109030423339*^9, 3.783109056635854*^9}, {3.7831128031638536`*^9, 
   3.7831128247051277`*^9}, {3.783115014524211*^9, 3.783115019154235*^9}, {
   3.7833240267789783`*^9, 3.783324041902903*^9}, {3.783324119973378*^9, 
   3.783324120129197*^9}, {3.7833391519615803`*^9, 3.783339156033903*^9}, {
   3.7833417195889797`*^9, 3.783341743280205*^9}, {3.78334191274816*^9, 
   3.783341919728112*^9}, {3.783346693994686*^9, 3.783346694176002*^9}, {
   3.7833578301619997`*^9, 3.783357841799822*^9}, {3.783359442931488*^9, 
   3.783359446154262*^9}, {3.783720429507452*^9, 3.783720455401669*^9}, {
   3.783750435465063*^9, 3.783750436774378*^9}, 3.783785550404735*^9, {
   3.783886521100498*^9, 3.7838865289620523`*^9}, 3.7838865619541397`*^9, {
   3.783886597056396*^9, 3.783886646942761*^9}, {3.783886737078906*^9, 
   3.783886747332979*^9}, 3.783887171717676*^9, {3.7842856467444277`*^9, 
   3.78428564882106*^9}, 3.784289680225245*^9, 3.784289713021159*^9, 
   3.784291393925555*^9, {3.784292148692501*^9, 3.784292154765416*^9}, {
   3.78429231028172*^9, 3.784292313639689*^9}, {3.784452694734292*^9, 
   3.784452698564267*^9}, {3.784454572752162*^9, 3.7844546278990383`*^9}, {
   3.784456349632967*^9, 3.784456364248067*^9}, {3.7844565782339697`*^9, 
   3.7844566266112413`*^9}, {3.7844567600350857`*^9, 3.784456760529859*^9}, {
   3.784457099271151*^9, 3.784457103771862*^9}, {3.7844576408012333`*^9, 
   3.784457665700265*^9}, {3.78764376682495*^9, 3.787643787827125*^9}, {
   3.7876467050904913`*^9, 3.7876467077322483`*^9}, {3.787646754760294*^9, 
   3.787646764641862*^9}, {3.793437043308002*^9, 3.793437046945836*^9}, {
   3.8011567460375*^9, 3.801156755503989*^9}, {3.801383009692658*^9, 
   3.801383011850503*^9}, {3.80138550101849*^9, 3.801385501583123*^9}, {
   3.804233869970583*^9, 3.8042338788114977`*^9}, {3.804234413049245*^9, 
   3.804234416714919*^9}, {3.8073670317519407`*^9, 3.807367041053596*^9}, {
   3.807367285674534*^9, 3.8073673179859047`*^9}},
 CellLabel->
  "In[857]:=",ExpressionUUID->"abec14df-fce9-4c21-a4ef-60075d7e6940"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[872]:=",ExpressionUUID->"970910d7-ea2e-46ef-bfed-827368a795ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulateDiffractionPattern", "[", 
   RowBox[{
   "usingProgram_String", ",", "structureInput_", ",", "ImagePlane_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"imgPlane", "=", "ImagePlane"}], ",", "programPaths", ",", 
      "searchExpression", ",", "options", ",", "inputs"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Common", " ", "driver", " ", "routine", 
      " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Common", " ", "checks"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<DISCUS\>\"", ",", "\"\<DIFFUSE\>\""}], "}"}], ",", 
          "usingProgram"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"SimulateDiffractionPattern", "::", "UnsupportedProgram"}], 
          ",", "usingProgram"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<ErrorsOnly\>\"", ",", "All"}], "}"}], ",", 
          RowBox[{"OptionValue", "[", "\"\<PrintOutput\>\"", "]"}]}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SimulateDiffractionPattern", "::", "InvalidPrint"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "None", ",", "\"\<Biso\>\"", ",", "\"\<ExactAverage\>\"", ",", 
            "\"\<SmallAverage\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "OptionValue", "[", "\"\<BraggScatteringSubtractionMode\>\"", 
           "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
         "SimulateDiffractionPattern", "::", "InvalidSubtractionMode"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<ScalingFactor\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SimulateDiffractionPattern", "::", "InvalidScalingFactor"}],
          "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<ImageDimensions\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "#"}], "}"}], "&"}], "[", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
               RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}], "]"}]}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
         "SimulateDiffractionPattern", "::", "InvalidImageDimensions"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"usingProgram", "===", "\"\<DISCUS\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringQ", "@", "structureInput"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
           "SimulateDiffractionPattern", "::", "InvalidStructureInput"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"usingProgram", "===", "\"\<DIFFUSE\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringQ", "@", "structureInput"}], ",", 
         RowBox[{"InputCheck", "[", 
          RowBox[{"\"\<CrystalQ\>\"", ",", "structureInput"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "structureInput"}], "\[NotEqual]", "2"}], 
            "||", 
            RowBox[{"AnyTrue", "[", 
             RowBox[{"structureInput", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"FileExistsQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
             "SimulateDiffractionPattern", "::", "InvalidInputForDIFFUSE"}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "imgPlane"}], ",", 
       RowBox[{"imgPlane", "=", 
        RowBox[{"MillerNotationToList", "@", "imgPlane"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Sort", "@", "imgPlane"}], ",", 
            RowBox[{"{", 
             RowBox[{"_Integer", ",", "#", ",", "#"}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", "&"}], "[", 
         RowBox[{"\"\<h\>\"", "|", "\"\<k\>\"", "|", "\"\<l\>\""}], "]"}], 
        "\[Nand]", 
        RowBox[{"DuplicateFreeQ", "@", "imgPlane"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
         "SimulateDiffractionPattern", "::", "InvalidReciprocalPlane"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"DirectoryQ", "@", "#"}]}], ",", 
         RowBox[{"CreateDirectory", "@", "#"}]}], "]"}], "&"}], "[", 
      "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$TemporaryDirectory", ",", "\"\<MaXrd\>\""}], "}"}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"programPaths", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<ProgramPaths\>\"", "]"}], "[", 
        "$OperatingSystem", "]"}], "[", "usingProgram", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"programPaths", "===", "\"\<\>\""}], "||", 
        RowBox[{"DirectoryQ", "@", "programPaths"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"searchExpression", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"usingProgram", "===", "\"\<DISCUS\>\""}], ",", 
           RowBox[{"{", "\"\<discus\>\"", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"usingProgram", "===", "\"\<DIFFUSE\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<dzmc\>\"", ",", "\"\<bin2gray\>\""}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"$OperatingSystem", "===", "\"\<Windows\>\""}], ",", 
          RowBox[{"searchExpression", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "<>", "\"\<.exe\>\""}], "&"}], "/@", 
            "searchExpression"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"searchExpression", "=", 
         RowBox[{"\"\<(?i)\>\"", "<>", 
          RowBox[{"StringRiffle", "[", 
           RowBox[{"searchExpression", ",", "\"\<|\>\""}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"programPaths", "=", 
         RowBox[{"Sort", "@", 
          RowBox[{"FileNames", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"RegularExpression", "@", "searchExpression"}], ",", 
            "\[IndentingNewLine]", "programPaths", ",", 
            RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"programPaths", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"List", "@", "programPaths"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"AllTrue", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"List", "@", "programPaths"}]}], ",", "FileExistsQ"}], 
          "]"}]}], "||", 
        RowBox[{"programPaths", "===", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"SimulateDiffractionPattern", "::", "MissingProgram"}], ",",
           "usingProgram"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"usingProgram", "===", "\"\<DISCUS\>\""}], "&&", 
        RowBox[{"ListQ", "@", "programPaths"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"programPaths", "=", 
        RowBox[{"First", "@", "programPaths"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Switch", " ", "flow"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"#", "\[Rule]", 
           RowBox[{"OptionValue", "[", "#", "]"}]}], ",", "String"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"Keys", "@", 
        RowBox[{"Options", "@", "SimulateDiffractionPattern"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inputs", "=", 
      RowBox[{"{", 
       RowBox[{"programPaths", ",", "structureInput", ",", "imgPlane", ",", 
        RowBox[{"Association", "@", "options"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"usingProgram", "===", "\"\<DISCUS\>\""}], ",", 
       RowBox[{"SDP$DISCUS", "@@", "inputs"}], ",", "\[IndentingNewLine]", 
       RowBox[{"usingProgram", "===", "\"\<DIFFUSE\>\""}], ",", 
       RowBox[{"SDP$DIFFUSE", "@@", "inputs"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7649400398004847`*^9, 3.764940061509528*^9}, {
   3.764940370503385*^9, 3.764940372702466*^9}, {3.764940807230566*^9, 
   3.764940811756531*^9}, {3.76494111480615*^9, 3.764941137926849*^9}, {
   3.764941353338676*^9, 3.76494139262535*^9}, {3.764941425657902*^9, 
   3.764941469983696*^9}, {3.764941511520702*^9, 3.764941559230712*^9}, {
   3.764941631494429*^9, 3.764941640140325*^9}, {3.764941830288842*^9, 
   3.7649418566160507`*^9}, {3.764942167188038*^9, 3.764942255630835*^9}, {
   3.764943476742765*^9, 3.7649434872375517`*^9}, {3.764943732801663*^9, 
   3.764943745801167*^9}, {3.764944365603322*^9, 3.7649443995937653`*^9}, {
   3.764944885781499*^9, 3.764944942354*^9}, {3.7649449772658987`*^9, 
   3.7649450458318243`*^9}, {3.764945201832601*^9, 3.764945204132619*^9}, {
   3.7649452552627897`*^9, 3.764945266051773*^9}, 3.764945304708693*^9, {
   3.7649588477285547`*^9, 3.764958860495343*^9}, {3.765015734166045*^9, 
   3.7650157393730974`*^9}, {3.76501579557778*^9, 3.765015841918893*^9}, {
   3.7650158783549128`*^9, 3.765015901454626*^9}, {3.7650159382719603`*^9, 
   3.765015997478104*^9}, {3.765016966395296*^9, 3.7650170119977655`*^9}, {
   3.765018339961006*^9, 3.7650183829610834`*^9}, {3.7650957895451665`*^9, 
   3.7650958064719076`*^9}, {3.7650958580091114`*^9, 
   3.7650958603119555`*^9}, {3.765095909281026*^9, 3.7650959571620007`*^9}, {
   3.7650960385694675`*^9, 3.765096042328964*^9}, {3.7650961871608953`*^9, 
   3.7650962175241995`*^9}, 3.765096289375547*^9, {3.765098014160377*^9, 
   3.765098139903666*^9}, {3.765098193758169*^9, 3.765098231744746*^9}, {
   3.766901617581229*^9, 3.766901637586619*^9}, {3.767604935523774*^9, 
   3.7676049365938463`*^9}, {3.767605187092252*^9, 3.767605212683522*^9}, {
   3.7676907004931993`*^9, 3.7676907038820066`*^9}, 3.768029856856327*^9, {
   3.783097326619275*^9, 3.783097326635767*^9}, 3.783097495701*^9, {
   3.7830981225239153`*^9, 3.783098161160049*^9}, {3.783098331357039*^9, 
   3.783098331548236*^9}, {3.783098398083205*^9, 3.783098401178926*^9}, {
   3.783098508465322*^9, 3.7830985522476683`*^9}, {3.783098599551177*^9, 
   3.7830986928844337`*^9}, {3.783098733076241*^9, 3.7830987339556847`*^9}, {
   3.783098767819359*^9, 3.7830987695474253`*^9}, {3.7830988171465797`*^9, 
   3.783098826778449*^9}, {3.783098871809699*^9, 3.783099003142302*^9}, {
   3.783109111572523*^9, 3.783109144012278*^9}, {3.783109180875496*^9, 
   3.783109187985717*^9}, {3.783109242017837*^9, 3.7831092873581963`*^9}, {
   3.783109345575287*^9, 3.783109353229109*^9}, {3.78310967831068*^9, 
   3.783109730964512*^9}, {3.7831108646193743`*^9, 3.7831109134830837`*^9}, 
   3.7831109889716997`*^9, {3.7831110405941772`*^9, 3.783111106742709*^9}, {
   3.7831112892605467`*^9, 3.783111378385041*^9}, {3.783115413099751*^9, 
   3.783115413370503*^9}, {3.783115596221849*^9, 3.783115642324748*^9}, {
   3.78311625203369*^9, 3.783116256327495*^9}, {3.783337608385498*^9, 
   3.7833376414789343`*^9}, {3.7833376745677757`*^9, 3.783337694628202*^9}, {
   3.7833378969437532`*^9, 3.783337897068543*^9}, {3.78333803353104*^9, 
   3.7833380364844627`*^9}, {3.783338187188561*^9, 3.7833382358885107`*^9}, {
   3.7833383180626183`*^9, 3.783338355472321*^9}, {3.783338385531725*^9, 
   3.7833384418662663`*^9}, {3.783340786784195*^9, 3.783340812263446*^9}, {
   3.783340845396434*^9, 3.7833408615810204`*^9}, {3.783340946255245*^9, 
   3.783340950231752*^9}, {3.783341005638871*^9, 3.7833410938241796`*^9}, {
   3.783341258736619*^9, 3.7833413274918423`*^9}, {3.78334140239892*^9, 
   3.783341403766531*^9}, {3.78334146716856*^9, 3.783341467344337*^9}, {
   3.783341683063673*^9, 3.7833417115493507`*^9}, {3.783341752855939*^9, 
   3.783341885679648*^9}, {3.783346709546966*^9, 3.783346710017149*^9}, {
   3.783357994694215*^9, 3.783358005092649*^9}, {3.783360892205503*^9, 
   3.7833608924840593`*^9}, {3.783612553432205*^9, 3.783612577136348*^9}, {
   3.783614248868984*^9, 3.7836143033384447`*^9}, {3.783709087127396*^9, 
   3.7837091182128963`*^9}, {3.7837092038752728`*^9, 3.783709218242784*^9}, {
   3.783709752207444*^9, 3.783709752692634*^9}, {3.7837593454058666`*^9, 
   3.7837593788863053`*^9}, {3.783759412075528*^9, 3.7837595040744333`*^9}, 
   3.78375957059449*^9, {3.7837596009582653`*^9, 3.7837596262506065`*^9}, {
   3.783886621698482*^9, 3.783886622017268*^9}, {3.783886672882476*^9, 
   3.78388671152738*^9}, {3.7838867552305517`*^9, 3.78388676483762*^9}, {
   3.783886823188491*^9, 3.7838868312760878`*^9}, {3.783886874627864*^9, 
   3.783886881275477*^9}, 3.7838871992951403`*^9, {3.784284167128577*^9, 
   3.7842842107666807`*^9}, {3.784286173378303*^9, 3.784286176424386*^9}, {
   3.784286782932042*^9, 3.7842867856665363`*^9}, {3.7842868691703444`*^9, 
   3.784286908863776*^9}, {3.784287352031933*^9, 3.784287356173946*^9}, {
   3.7842873956787767`*^9, 3.784287395821582*^9}, {3.784287925508532*^9, 
   3.7842879256663933`*^9}, {3.784290299788612*^9, 3.78429032647383*^9}, {
   3.7842904243125153`*^9, 3.7842904256478167`*^9}, {3.784290740477257*^9, 
   3.784290744570949*^9}, {3.7842924712844877`*^9, 3.784292478411233*^9}, 
   3.784454656033927*^9, {3.784454938583867*^9, 3.784454938928164*^9}, {
   3.784454974355301*^9, 3.784455003040173*^9}, {3.7844550952096653`*^9, 
   3.784455113855996*^9}, {3.7844552215653152`*^9, 3.784455343274856*^9}, 
   3.784455456348812*^9, {3.7844554886386833`*^9, 3.784455635030055*^9}, {
   3.78445566894487*^9, 3.784455736347612*^9}, {3.7844557845190496`*^9, 
   3.7844558325245543`*^9}, {3.784456272777088*^9, 3.784456276642325*^9}, {
   3.78445637651057*^9, 3.784456458369499*^9}, {3.7844565028474913`*^9, 
   3.7844565631961317`*^9}, {3.784456648069686*^9, 3.784456784015012*^9}, {
   3.784456945778118*^9, 3.784456972836383*^9}, {3.7844570260795097`*^9, 
   3.784457051070951*^9}, {3.784457117286684*^9, 3.784457270403121*^9}, {
   3.784457448561458*^9, 3.7844574980116568`*^9}, {3.7844575291895037`*^9, 
   3.784457636245844*^9}, {3.784457703010881*^9, 3.784457759447249*^9}, {
   3.784457842338773*^9, 3.784457848346664*^9}, {3.784457887361309*^9, 
   3.784457890755978*^9}, {3.784457948735775*^9, 3.784457954141358*^9}, {
   3.784496347106957*^9, 3.784496347249032*^9}, {3.786968148106531*^9, 
   3.786968149864456*^9}, {3.787391483580476*^9, 3.787391553362548*^9}, {
   3.787392647092391*^9, 3.787392649455531*^9}, {3.7873972746773777`*^9, 
   3.7873972748219547`*^9}, {3.787645192463787*^9, 3.787645213172863*^9}, {
   3.787646695223248*^9, 3.787646701915951*^9}, {3.787646770683798*^9, 
   3.7876467924017143`*^9}, {3.804236934612565*^9, 3.804236969563058*^9}, {
   3.807367245062889*^9, 3.807367273668453*^9}, {3.807367585259679*^9, 
   3.807367587945199*^9}, {3.8073676249077883`*^9, 3.8073676299519987`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[873]:=",ExpressionUUID->"a03b022b-140f-492e-84df-cbe1d4658e2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SDP$DISCUS", "[", 
   RowBox[{
   "programPath_String", ",", "structureInput_", ",", "ImagePlane_", ",", 
    "givenOptions_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"structureFile", "=", "structureInput"}], ",", 
      RowBox[{"options", "=", "givenOptions"}], ",", "workDir", ",", 
      "\[IndentingNewLine]", "i", ",", "stream", ",", "line", ",", 
      "streamData", ",", "\[IndentingNewLine]", 
      RowBox[{"ncell", "=", "\"\<\>\""}], ",", "allCoords", ",", 
      "structureSize", ",", "\[IndentingNewLine]", "latticeParameters", ",", 
      "crystalM", ",", "\[IndentingNewLine]", "hklMax", ",", "abscissaIndex", 
      ",", "ordinateIndex", ",", "\[IndentingNewLine]", "x", ",", 
      "imageOrientation", ",", "commands", ",", 
      RowBox[{"feedback", "=", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
      "cutOffValue", ",", "data", ",", "dataLength", ",", 
      "\[IndentingNewLine]", "xDataSize", ",", "yDataSize", ",", "xMin", ",", 
      "xMax", ",", "yMin", ",", "yMax", ",", "xStep", ",", "yStep", ",", 
      "numbers", ",", "plotData", ",", "\[IndentingNewLine]", "scaleMax", ",",
       "intensities", ",", "maxIntensity", ",", "useRawInputQ", ",", 
      "imageBasis"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Handle", " ", "both", " ", "crystal", " ", "label", " ", "and", " ", 
      "structure", " ", "file", " ", "input"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$CrystalData", ",", "structureInput"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"structureFile", "=", 
        RowBox[{"ExportCrystalData", "[", 
         RowBox[{"\"\<DISCUS\>\"", ",", "structureFile", ",", 
          RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "$TemporaryDirectory", ",", "\"\<MaXrd\>\"", ",", 
             "\"\<TemporaryStructureFile.stru\>\""}], "}"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "structureFile"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
         "SimulateDiffractionPattern", "::", "InvalidStructureInput"}], "]"}],
         ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"structureFile", "=", 
      RowBox[{"AbsoluteFileName", "@", "structureFile"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Determining", " ", "structure", " ", "size"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "stream"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"OpenRead", "@", "structureFile"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"line", "=", 
         RowBox[{"Read", "[", 
          RowBox[{"stream", ",", "String"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"line", ",", 
             RowBox[{";;", "4"}]}], "]"}], "===", "\"\<cell\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"latticeParameters", "=", "line"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"line", ",", 
             RowBox[{";;", "5"}]}], "]"}], "===", "\"\<ncell\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ncell", "=", "line"}], ";", 
           RowBox[{"ReadLine", "@", "stream"}], ";", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"line", ",", 
             RowBox[{";;", "5"}]}], "]"}], "===", "\"\<atoms\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", "10"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"SimulateDiffractionPattern", "::", "InvalidFormat"}], 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"streamData", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"stream", ",", "String"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Close", "@", "stream"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"structureSize", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ncell", "=!=", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"a", ".", " ", "Read"}], " ", "size", " ", "directly"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Max", "@", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"StringCases", "[", 
            RowBox[{"ncell", ",", 
             RowBox[{"DigitCharacter", ".."}]}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{";;", "3"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"b", ".", " ", "Determine"}], " ", "size", " ", "from", " ",
           "coordinate", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"allCoords", "=", 
          RowBox[{"ToExpression", "@", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"StringSplit", "@", "streamData"}], ",", "All", ",", 
             RowBox[{"2", ";;", "4"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Subtract", "@@", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Ceiling", "/@", 
            RowBox[{"MinMax", "@", "allCoords"}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"latticeParameters", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
        RowBox[{"latticeParameters", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"DigitCharacter", ",", "\"\<.\>\""}], "}"}], ".."}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"crystalM", "=", 
      RowBox[{"GetCrystalMetric", "[", 
       RowBox[{"latticeParameters", ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Space\>\"", "\[Rule]", "\"\<Reciprocal\>\""}], ",", 
        RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Preparing", " ", "input", " ", "for", " ", "Fourier", " ", 
       "transform"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"workDir", "=", 
      RowBox[{"DirectoryName", "@", "structureFile"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hklMax", "=", 
      RowBox[{"options", "[", "\"\<IndicesLimit\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NumericQ", "@", "hklMax"}], "\[Nand]", 
        RowBox[{"Positive", "@", "hklMax"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
         "SimulateDiffractionPattern", "::", "InvalidReciprocalSpaceLimit"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"imageOrientation", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "\"\<GetReciprocalImageOrientation\>\"", ",", "\[IndentingNewLine]", 
        "latticeParameters", ",", "ImagePlane", ",", "hklMax", ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "100"}], "}"}], 
        RowBox[{"(*", " ", 
         RowBox[{"Dummy", " ", "width", " ", "and", " ", "height"}], " ", 
         "*)"}], ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"abscissaIndex", ",", "ordinateIndex"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", "#2"}], "}"}], "&"}], "@@", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ImagePlane", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<h\>\"", ",", "\"\<k\>\"", ",", "\"\<l\>\"", ",", "_Integer"}], 
          "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"commands", "=", 
      RowBox[{
      "\"\<\n################################################\n# COMBINED \
BUILD MACRO FOR `SimulateDiffractionPattern`\n\
################################################\ncd \>\"", "<>", "workDir", 
       "<>", "\"\<\ndiscus\n####### Load/build crystal #####################\n\
variable int, sizeX\nsizeX = \>\"", "<>", 
       RowBox[{"ToString", "@", "structureSize"}], "<>", 
       "\"\<\n#\nread\n  stru \>\"", "<>", 
       RowBox[{"FileNameTake", "@", "structureFile"}], "<>", 
       "\"\<\n#\nchem\n  elem\nexit\n####### Fourier transform \
######################\nvariable real, hklMax\nvariable int,  fourierWidth\n\
variable int,  fourierPoints\n#\nhklMax = \>\"", "<>", 
       RowBox[{"ToString", "@", 
        RowBox[{"N", "@", "hklMax"}]}], "<>", 
       "\"\<\nfourierWidth = 2 * hklMax\nfourierPoints = fourierWidth * sizeX \
+ 1\n#\nfourier\n  xray\n  wvle moa1\n#\n  ll   \>\"", "<>", 
       RowBox[{
       "imageOrientation", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "<>", "\"\<\n  lr   \>\"", "<>", 
       RowBox[{
       "imageOrientation", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], "<>", "\"\<\n  ul   \>\"", "<>", 
       RowBox[{
       "imageOrientation", "\[LeftDoubleBracket]", "3", 
        "\[RightDoubleBracket]"}], "<>", 
       "\"\<\n  na   fourierPoints\n  no   fourierPoints\n  abs  \>\"", "<>", 
       
       RowBox[{"(", 
        RowBox[{"abscissaIndex", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "\"\<h\>\""}], ",", 
           RowBox[{"2", "\[Rule]", "\"\<k\>\""}], ",", 
           RowBox[{"3", "\[Rule]", "\"\<l\>\""}]}], "}"}]}], ")"}], "<>", 
       "\"\<\n  ord  \>\"", "<>", 
       RowBox[{"(", 
        RowBox[{"ordinateIndex", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "\"\<h\>\""}], ",", 
           RowBox[{"2", "\[Rule]", "\"\<k\>\""}], ",", 
           RowBox[{"3", "\[Rule]", "\"\<l\>\""}]}], "}"}]}], ")"}], "<>", 
       "\"\<\n#\n  show\n  run\nexit\n#\n#\n#---# Fourier data output #---#\n\
output\n  value intensity\n  format standard\n  outfile fourier_data.dat\n  \
run\nexit\n################################################\nexit\n\>\""}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Run", " ", "DISCUS"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"feedback", "=", 
      RowBox[{"RunProcess", "[", 
       RowBox[{"programPath", ",", "All", ",", "commands"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SDP$EvaluateFeedbackPrint", "[", 
      RowBox[{"commands", ",", "feedback", ",", 
       RowBox[{"options", "[", "\"\<PrintOutput\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", 
        RowBox[{"--", "-"}]}], "*", " ", "Plot", " ", "preparations", " ", 
       "*", 
       RowBox[{"--", 
        RowBox[{"--", "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Importing", " ", 
       RowBox[{"(", 
        RowBox[{"x", ",", "y", ",", "intensity"}], ")"}], " ", "data", " ", 
       "from", " ", "file"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Check", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"workDir", ",", "\"\<fourier_data.dat\>\""}], "}"}], 
           "]"}], ",", "\"\<Table\>\""}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"SimulateDiffractionPattern", "::", "MissingOutputData"}], 
          "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dataLength", "=", 
      RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"data", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "===", 
         RowBox[{"(", "\"\<#\>\"", ")"}]}], "&&", 
        RowBox[{"i", "\[LessEqual]", "dataLength"}]}], ",", 
       RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xDataSize", ",", "yDataSize"}], "}"}], "=", 
        RowBox[{
        "data", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xMin", ",", "xMax", ",", "yMin", ",", "yMax"}], "}"}], "=", 
      RowBox[{"data", "\[LeftDoubleBracket]", 
       RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xStep", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xMax", "-", "xMin"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"xDataSize", "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yStep", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"yMax", "-", "yMin"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"yDataSize", "-", "1"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"numbers", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"data", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"i", "+", "2"}], ";;"}], "\[RightDoubleBracket]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"numbers", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"numbers", ",", "xDataSize"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plotData", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xMin", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", "1"}], ")"}], "*", "xStep"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"yMin", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "-", "1"}], ")"}], "*", "yStep"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"numbers", "\[LeftDoubleBracket]", 
           RowBox[{"y", ",", "x"}], "\[RightDoubleBracket]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"Instead", " ", "of", " ", "transposing"}], " ", "*)"}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "yDataSize"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "xDataSize"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotData", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"plotData", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Scaling", " ", "intensities"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"scaleMax", "=", "100."}], ";", "\[IndentingNewLine]", 
     RowBox[{"intensities", "=", 
      RowBox[{"plotData", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxIntensity", "=", 
      RowBox[{"Max", "@", "intensities"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"maxIntensity", "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SimulateDiffractionPattern", "::", "ZeroIntensity"}], "]"}],
         ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"intensities", "*=", 
      RowBox[{"scaleMax", "/", "maxIntensity"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intensities", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "*", 
         RowBox[{"options", "[", "\"\<ScalingFactor\>\"", "]"}]}], "&"}], "/@",
        "intensities"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intensities", "=", 
      RowBox[{"intensities", "/.", 
       RowBox[{
        RowBox[{"x_", "/;", 
         RowBox[{"x", ">", "scaleMax"}]}], "\[Rule]", "scaleMax"}]}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"16", " ", "bit", " ", "max"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotData", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
      "intensities"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Data", " ", "treatment", " ", "and", " ", "preparation"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"useRawInputQ", "=", 
      RowBox[{"TrueQ", "@", 
       RowBox[{"options", "[", "\"\<UseRawInput\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"useRawInputQ", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Use"}], " ", "data", " ", "\"\<as is\>\""}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"plotData", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"plotData", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"Length", "@", "numbers"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Rescale"}], " ", "intensity", " ", "and", 
         " ", "use", " ", "appropriate", " ", "basis", " ", "for", " ", 
         "image"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cutOffValue", "=", 
         RowBox[{"Power", "[", 
          RowBox[{"10.", ",", 
           RowBox[{"-", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plotData", "=", 
         RowBox[{"plotData", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x_", ",", "y_", ",", "i_"}], "}"}], "/;", 
            RowBox[{"i", "<", "cutOffValue"}]}], "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "cutOffValue"}], "}"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imageBasis", "=", 
         RowBox[{"Normalize", "/@", 
          RowBox[{"crystalM", "[", 
           RowBox[{"[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"abscissaIndex", ",", "ordinateIndex"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"abscissaIndex", ",", "ordinateIndex"}], "}"}]}], "]"}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plotData", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
         
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"imageBasis", ".", "#"}], "&"}], ",", 
           RowBox[{"plotData", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Prepare", " ", "and", " ", "deliver", " ", "plot"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"useRawInputQ", ",", "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"options", ",", 
         RowBox[{"DataRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xMin", ",", "xMax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"yMin", ",", "yMax"}], "}"}]}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"options", ",", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"Divide", "@@", 
           RowBox[{"Total", "@", "imageBasis"}]}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"options", "@", "\"\<ReturnData\>\""}]}], ",", 
       RowBox[{"Return", "@", "plotData"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"plotData", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"Normal", "@", "options"}], ",", 
          RowBox[{"Options", "@", "ListDensityPlot"}]}], "]"}]}]}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.763444067942569*^9, 3.763444076768383*^9}, {
   3.763444140576406*^9, 3.7634441667745733`*^9}, {3.763445452783616*^9, 
   3.7634454621213617`*^9}, {3.763445493266975*^9, 3.763445508234131*^9}, {
   3.763445539650914*^9, 3.763445610896184*^9}, 3.7634456964703503`*^9, {
   3.7634464752731457`*^9, 3.7634465078442793`*^9}, {3.763446627594833*^9, 
   3.763446641914379*^9}, {3.763448625822485*^9, 3.763448688411724*^9}, {
   3.763458682787753*^9, 3.76345871019275*^9}, {3.763458845111693*^9, 
   3.7634588753321953`*^9}, {3.7634589358446207`*^9, 
   3.7634589588844013`*^9}, {3.7634589976316137`*^9, 
   3.7634590135568123`*^9}, {3.763459116912136*^9, 3.763459128706584*^9}, {
   3.76345919692677*^9, 3.7634592004048433`*^9}, {3.7634594865247173`*^9, 
   3.763459493522946*^9}, {3.763460537501679*^9, 3.763460666323038*^9}, {
   3.763460700975492*^9, 3.7634607629214153`*^9}, {3.763460851358536*^9, 
   3.763460874841769*^9}, {3.7634610744721537`*^9, 3.763461126070581*^9}, {
   3.763461188029662*^9, 3.7634612082543488`*^9}, {3.763461260658887*^9, 
   3.763461278586297*^9}, {3.7634613299513073`*^9, 3.763461338568411*^9}, {
   3.763461675410347*^9, 3.7634616926096907`*^9}, {3.763461727022987*^9, 
   3.763461797367605*^9}, {3.763461833817013*^9, 3.763461939975506*^9}, {
   3.763461997628042*^9, 3.763462126272806*^9}, {3.763463236319697*^9, 
   3.763463236982375*^9}, {3.763644760103071*^9, 3.763644763045479*^9}, {
   3.763663345286734*^9, 3.76366334626149*^9}, {3.763663394774551*^9, 
   3.763663395083741*^9}, {3.763663537274515*^9, 3.763663602912895*^9}, {
   3.763663705031168*^9, 3.7636637113715477`*^9}, {3.763699525740419*^9, 
   3.763699530170108*^9}, {3.763709308913062*^9, 3.763709384956674*^9}, {
   3.76370951545251*^9, 3.763709516457502*^9}, {3.763709957752388*^9, 
   3.763709969607113*^9}, 3.7637100242158413`*^9, {3.763711287084588*^9, 
   3.7637114115492268`*^9}, {3.763711446378128*^9, 3.763711451591894*^9}, {
   3.7637248640217133`*^9, 3.7637248673592176`*^9}, {3.7637250700276527`*^9, 
   3.763725252470545*^9}, {3.7637252891028633`*^9, 3.763725291750958*^9}, {
   3.763725325377145*^9, 3.7637254159794188`*^9}, {3.763725448740388*^9, 
   3.763725457393702*^9}, {3.7637256058419323`*^9, 3.7637256062541227`*^9}, {
   3.763727167019824*^9, 3.763727207357723*^9}, {3.7637273492608767`*^9, 
   3.76372736752308*^9}, {3.763727398747064*^9, 3.763727399003045*^9}, {
   3.763729937787966*^9, 3.763729990242918*^9}, {3.763730682104825*^9, 
   3.7637306887751217`*^9}, {3.763730720776968*^9, 3.7637307642057056`*^9}, {
   3.763730964266704*^9, 3.763730996555264*^9}, {3.763731254562909*^9, 
   3.7637312720588284`*^9}, {3.76373166956351*^9, 3.76373168224958*^9}, {
   3.7637317428634777`*^9, 3.763731842307472*^9}, {3.763731901027958*^9, 
   3.763732139517367*^9}, {3.763732177109869*^9, 3.763732187231112*^9}, {
   3.7637322217809343`*^9, 3.763732328681012*^9}, {3.7637323792270327`*^9, 
   3.763732404895233*^9}, {3.7637327015219088`*^9, 3.763732818806758*^9}, {
   3.763733509279573*^9, 3.763733510894072*^9}, {3.763733584038316*^9, 
   3.763733591652254*^9}, {3.7637336345571117`*^9, 3.763733647916411*^9}, {
   3.763733731067355*^9, 3.7637338147191133`*^9}, 3.763733925151909*^9, {
   3.7637340860075607`*^9, 3.7637340875868998`*^9}, {3.763734119349834*^9, 
   3.763734123275475*^9}, {3.763734165572255*^9, 3.76373419627273*^9}, 
   3.7637343170962257`*^9, {3.763734379150639*^9, 3.763734441179873*^9}, {
   3.763734484014461*^9, 3.763734554939769*^9}, {3.763734591314302*^9, 
   3.763734655570017*^9}, {3.763734785430716*^9, 3.763734820506667*^9}, {
   3.7637348592064238`*^9, 3.7637349519399643`*^9}, {3.7637349995957527`*^9, 
   3.7637350003938017`*^9}, {3.763741207053108*^9, 3.763741262191133*^9}, {
   3.763741300489676*^9, 3.7637413617128773`*^9}, 3.763988726929099*^9, {
   3.763988868671323*^9, 3.7639888700052547`*^9}, {3.763989035877824*^9, 
   3.7639890377687902`*^9}, {3.7639897720500593`*^9, 3.763989799433291*^9}, {
   3.763989894259738*^9, 3.763989980196909*^9}, {3.763990011972438*^9, 
   3.76399004879478*^9}, {3.764077848761304*^9, 3.7640778957976913`*^9}, {
   3.764077949597375*^9, 3.764077979203281*^9}, 3.764940091477598*^9, {
   3.764940839938933*^9, 3.76494084532124*^9}, 3.764941505672908*^9, {
   3.76494182510563*^9, 3.7649418528040533`*^9}, {3.764942176639078*^9, 
   3.764942190460372*^9}, {3.764943692079373*^9, 3.764943707349574*^9}, {
   3.7650170879784455`*^9, 3.7650171431850033`*^9}, {3.765017173569789*^9, 
   3.765017174169155*^9}, {3.765017227072736*^9, 3.7650172565579224`*^9}, {
   3.76501729522456*^9, 3.7650173064964266`*^9}, {3.7650173415317774`*^9, 
   3.76501739821924*^9}, {3.7650174716010838`*^9, 3.7650174879723225`*^9}, {
   3.7650175644257464`*^9, 3.7650175709629927`*^9}, {3.7650176138229437`*^9, 
   3.7650176195602193`*^9}, {3.7650176759804263`*^9, 
   3.7650176914098196`*^9}, {3.76501774513188*^9, 3.765017775433133*^9}, {
   3.7650178075357285`*^9, 3.765017813455535*^9}, {3.7650178951946526`*^9, 
   3.765017953225588*^9}, {3.765018091317548*^9, 3.7650181234117374`*^9}, {
   3.7650181844256964`*^9, 3.765018220399535*^9}, {3.7650182770451994`*^9, 
   3.765018318765643*^9}, {3.765095406370245*^9, 3.7650954221728125`*^9}, {
   3.7650955267366333`*^9, 3.7650955270643053`*^9}, {3.765096045929923*^9, 
   3.7650960750951447`*^9}, {3.765098485455556*^9, 3.765098489875266*^9}, {
   3.766901646128586*^9, 3.766901746708198*^9}, {3.767932948932156*^9, 
   3.7679330712401867`*^9}, {3.767933119520987*^9, 3.7679331209667873`*^9}, {
   3.767933377866897*^9, 3.767933378344687*^9}, {3.767933481800856*^9, 
   3.767933496792658*^9}, {3.767934356250738*^9, 3.767934392976789*^9}, 
   3.767934963856374*^9, {3.767935018762374*^9, 3.767935051529188*^9}, {
   3.767941262452351*^9, 3.767941290203662*^9}, {3.767945957460162*^9, 
   3.767945979928673*^9}, {3.767946243371818*^9, 3.767946280289606*^9}, {
   3.76794633801793*^9, 3.7679464018476458`*^9}, 3.768037396579338*^9, {
   3.768038320976747*^9, 3.768038330678945*^9}, {3.768048095128319*^9, 
   3.768048116425613*^9}, {3.768049396663374*^9, 3.7680494549730053`*^9}, {
   3.768049521701342*^9, 3.768049523203978*^9}, {3.76804955330964*^9, 
   3.768049562955158*^9}, {3.768049706185314*^9, 3.768049753735092*^9}, {
   3.7680502787301702`*^9, 3.7680503104237223`*^9}, {3.768050399144342*^9, 
   3.768050425824094*^9}, {3.768050460086996*^9, 3.768050515836998*^9}, {
   3.76805055838245*^9, 3.768050568115727*^9}, {3.7680506080832787`*^9, 
   3.768050713160241*^9}, {3.768050765089644*^9, 3.7680507992324677`*^9}, {
   3.768050832287966*^9, 3.768050859964662*^9}, {3.768050935517522*^9, 
   3.768050972617827*^9}, 3.7680510253716583`*^9, {3.7680510921371307`*^9, 
   3.768051093759262*^9}, {3.768051152072495*^9, 3.768051236574657*^9}, {
   3.768051280149665*^9, 3.768051351697927*^9}, {3.768051381778912*^9, 
   3.7680514243701973`*^9}, {3.7680514627855167`*^9, 3.768051504566792*^9}, {
   3.768051638822077*^9, 3.768051639027533*^9}, {3.768051720723784*^9, 
   3.768051785801979*^9}, {3.76805362313898*^9, 3.7680536390255537`*^9}, 
   3.768069289135805*^9, {3.768071043877576*^9, 3.7680710531962767`*^9}, 
   3.768071114367579*^9, {3.768071148446699*^9, 3.7680711569956913`*^9}, {
   3.768071227780283*^9, 3.768071255228674*^9}, {3.768071746401927*^9, 
   3.768071759959331*^9}, {3.768071827237879*^9, 3.768071859734199*^9}, {
   3.76807204358744*^9, 3.768072085375852*^9}, {3.768072133328083*^9, 
   3.768072280132167*^9}, {3.7680723386931343`*^9, 3.768072356466728*^9}, {
   3.768072412035928*^9, 3.7680724517044163`*^9}, {3.768072492791613*^9, 
   3.7680726525882177`*^9}, {3.768072803082613*^9, 3.768072954581532*^9}, {
   3.768073003719076*^9, 3.768073025062667*^9}, {3.768073059429037*^9, 
   3.7680730637404337`*^9}, {3.768073115268412*^9, 3.768073120338152*^9}, {
   3.768073236488963*^9, 3.7680732455593243`*^9}, 3.7680732974720097`*^9, {
   3.768073387982318*^9, 3.7680733893476677`*^9}, {3.768073449364252*^9, 
   3.768073456309534*^9}, {3.768073569401689*^9, 3.768073729975181*^9}, {
   3.768073787804573*^9, 3.768073799187344*^9}, {3.7680739536733217`*^9, 
   3.76807396220833*^9}, {3.7680741479012213`*^9, 3.768074155723254*^9}, {
   3.768074269601205*^9, 3.768074284385496*^9}, {3.7680745083566647`*^9, 
   3.768074650730132*^9}, {3.7680751063036137`*^9, 3.768075115007234*^9}, {
   3.768075151678876*^9, 3.76807520123811*^9}, {3.768075231926243*^9, 
   3.768075381642386*^9}, {3.768075458793137*^9, 3.768075468736286*^9}, {
   3.7680755215689373`*^9, 3.768075521959115*^9}, {3.768108154597683*^9, 
   3.7681081582489023`*^9}, {3.768108395901738*^9, 3.768108418571369*^9}, {
   3.78309732666306*^9, 3.783097326726473*^9}, {3.783097498186139*^9, 
   3.7830974993139553`*^9}, {3.783109460658391*^9, 3.783109473707341*^9}, 
   3.7831110166497107`*^9, {3.783111495166415*^9, 3.783111505229232*^9}, {
   3.783111538180263*^9, 3.783111575050946*^9}, 3.78311160654972*^9, {
   3.7831116447637444`*^9, 3.783111653722878*^9}, {3.783111694747717*^9, 
   3.783111751920436*^9}, {3.7831118265837793`*^9, 3.783111904332617*^9}, {
   3.783111938806333*^9, 3.783112032113505*^9}, {3.783112064338263*^9, 
   3.783112112315653*^9}, {3.7831121436130867`*^9, 3.783112147831524*^9}, {
   3.783112296478207*^9, 3.783112310844158*^9}, {3.7831128522232313`*^9, 
   3.783112854852365*^9}, {3.783113021302622*^9, 3.783113023045177*^9}, {
   3.78311306053505*^9, 3.78311306073285*^9}, {3.783113186820548*^9, 
   3.783113192081553*^9}, {3.783113226547812*^9, 3.78311328754738*^9}, {
   3.783113372546876*^9, 3.783113373821938*^9}, 3.783113417846919*^9, {
   3.7831135980026417`*^9, 3.783113598312976*^9}, {3.783113671751898*^9, 
   3.7831136785513678`*^9}, {3.783113751741268*^9, 3.783113767421331*^9}, {
   3.783113803077372*^9, 3.7831139499038963`*^9}, {3.783114031937003*^9, 
   3.783114082123698*^9}, {3.783114117256618*^9, 3.783114132070093*^9}, {
   3.783114170333955*^9, 3.783114213075441*^9}, {3.783114676486951*^9, 
   3.783114692600787*^9}, {3.783114760074692*^9, 3.783114760224285*^9}, {
   3.7831148374148006`*^9, 3.783114925475636*^9}, {3.783115042091419*^9, 
   3.783115045460257*^9}, {3.783115421979576*^9, 3.783115422480939*^9}, {
   3.7831157704273148`*^9, 3.7831157768974733`*^9}, {3.783115808504879*^9, 
   3.783115826911056*^9}, {3.7831158579119587`*^9, 3.783115880438168*^9}, {
   3.7831159234399843`*^9, 3.783115932101173*^9}, {3.783117400868526*^9, 
   3.783117422399987*^9}, {3.7833283949732523`*^9, 3.783328410536573*^9}, 
   3.783328449987419*^9, {3.783328524766383*^9, 3.783328532305194*^9}, {
   3.783328630650169*^9, 3.783328725345758*^9}, {3.7833345835972643`*^9, 
   3.78333463106203*^9}, {3.7833359116992188`*^9, 3.783335959751766*^9}, {
   3.783336463227058*^9, 3.783336522513611*^9}, {3.783336813549981*^9, 
   3.783336813992648*^9}, {3.7833368729361773`*^9, 3.783336914441441*^9}, {
   3.7833370006563168`*^9, 3.783337000974504*^9}, {3.783337592986155*^9, 
   3.783337596794948*^9}, {3.78333771724909*^9, 3.783337718194497*^9}, 
   3.783337778501718*^9, 3.783338023826826*^9, {3.783341103728791*^9, 
   3.783341107426939*^9}, {3.783341139290399*^9, 3.783341174383939*^9}, {
   3.783341380697012*^9, 3.783341380892075*^9}, {3.783341499772154*^9, 
   3.783341517285348*^9}, {3.783357856430912*^9, 3.7833578575970297`*^9}, {
   3.78336283770394*^9, 3.783362841414493*^9}, {3.783362915519174*^9, 
   3.783362916084601*^9}, {3.783604867378077*^9, 3.783604871336328*^9}, {
   3.783613147559683*^9, 3.783613159415781*^9}, {3.783613636664125*^9, 
   3.783613659388893*^9}, {3.78361372018087*^9, 3.7836137637967157`*^9}, {
   3.783613796787107*^9, 3.783613848696638*^9}, {3.783613898209344*^9, 
   3.783613986798267*^9}, {3.783614174571293*^9, 3.783614174785803*^9}, {
   3.783614222787857*^9, 3.783614223737668*^9}, {3.783614356142213*^9, 
   3.783614469891111*^9}, {3.783614848318358*^9, 3.78361485033073*^9}, {
   3.783614899649046*^9, 3.783614901929433*^9}, {3.7836149625441093`*^9, 
   3.7836149783593483`*^9}, {3.783615017224038*^9, 3.783615034157983*^9}, {
   3.783615520199209*^9, 3.783615521972344*^9}, {3.783615816189724*^9, 
   3.783615820523663*^9}, {3.783615862222231*^9, 3.783615875914447*^9}, {
   3.783615962809918*^9, 3.7836159885155783`*^9}, {3.783624653731441*^9, 
   3.783624655224182*^9}, {3.78362476797488*^9, 3.7836247717812138`*^9}, {
   3.783628765486774*^9, 3.783628771403905*^9}, {3.783629241114814*^9, 
   3.783629241305222*^9}, {3.783629587107946*^9, 3.7836295879769583`*^9}, {
   3.7836296615131702`*^9, 3.783629665136189*^9}, {3.7836297548416643`*^9, 
   3.783629958596401*^9}, {3.7836300119389067`*^9, 3.783630023066742*^9}, 
   3.7836300569402447`*^9, {3.783630115977049*^9, 3.783630219886464*^9}, {
   3.783630290397908*^9, 3.783630479137067*^9}, {3.783630513018136*^9, 
   3.783630557263152*^9}, {3.783630602879818*^9, 3.7836306490459127`*^9}, {
   3.783630729054495*^9, 3.783630739163272*^9}, {3.783630798468959*^9, 
   3.783630859657835*^9}, {3.7836309140667353`*^9, 3.783630957503161*^9}, {
   3.783630993089965*^9, 3.783631011309614*^9}, {3.7836310619422007`*^9, 
   3.783631073341393*^9}, {3.78363116220453*^9, 3.783631254746131*^9}, {
   3.783631359112261*^9, 3.783631510326388*^9}, {3.783631567299252*^9, 
   3.783631732040578*^9}, {3.783631852151082*^9, 3.783631951163724*^9}, {
   3.78363199755707*^9, 3.783632035018564*^9}, 3.783710044293194*^9, {
   3.7837152032214823`*^9, 3.783715226178082*^9}, {3.783715259820877*^9, 
   3.783715260354506*^9}, {3.783715344009054*^9, 3.7837153442316923`*^9}, {
   3.783715430616659*^9, 3.783715432781747*^9}, {3.783715752786409*^9, 
   3.783715753159808*^9}, {3.783715812025872*^9, 3.7837158269257402`*^9}, {
   3.7837162859252653`*^9, 3.783716288659453*^9}, {3.783717236954341*^9, 
   3.7837172371913223`*^9}, {3.7837192644603243`*^9, 3.783719277106011*^9}, {
   3.783719350203578*^9, 3.783719352047574*^9}, {3.784283648170702*^9, 
   3.784283660206025*^9}, {3.784284157126113*^9, 3.784284160579513*^9}, {
   3.784285650034562*^9, 3.784285692653287*^9}, {3.784285854736127*^9, 
   3.784285914042253*^9}, {3.7842860491356487`*^9, 3.784286082535604*^9}, {
   3.784287157256507*^9, 3.784287199412932*^9}, {3.784287231000111*^9, 
   3.784287263332203*^9}, {3.784287403666904*^9, 3.784287407017149*^9}, {
   3.784287460109083*^9, 3.7842874874319553`*^9}, {3.784287535119169*^9, 
   3.7842876824442263`*^9}, {3.784288386974478*^9, 3.784288405924179*^9}, {
   3.7842884482680197`*^9, 3.7842884484988337`*^9}, 3.784288483844548*^9, {
   3.7842895025725403`*^9, 3.784289514416018*^9}, {3.7842896684556007`*^9, 
   3.7842896685885983`*^9}, {3.7842897139384108`*^9, 
   3.7842897150076227`*^9}, {3.784290265874158*^9, 3.784290276312921*^9}, {
   3.7842909590510263`*^9, 3.7842909607140713`*^9}, {3.784290995922635*^9, 
   3.784291045792091*^9}, {3.784291078689858*^9, 3.784291080184205*^9}, {
   3.784291195798555*^9, 3.784291215070572*^9}, {3.784291259453331*^9, 
   3.7842913280103083`*^9}, {3.784291383257262*^9, 3.784291431185109*^9}, {
   3.784291483625016*^9, 3.78429149504738*^9}, {3.7842915884789877`*^9, 
   3.784291588836627*^9}, {3.784291739522522*^9, 3.784291743576538*^9}, {
   3.7842918709215107`*^9, 3.784291873454399*^9}, {3.784291956205765*^9, 
   3.784292004587178*^9}, {3.784292076731124*^9, 3.784292123656946*^9}, {
   3.7842922135454884`*^9, 3.784292219009714*^9}, {3.784292447874681*^9, 
   3.7842924480097313`*^9}, {3.784451105777274*^9, 3.7844511252905207`*^9}, {
   3.7844525615018187`*^9, 3.784452624077326*^9}, 3.784457340193264*^9, {
   3.787056601059642*^9, 3.7870566108398333`*^9}, {3.787392592166276*^9, 
   3.787392603906456*^9}, {3.787393295179701*^9, 3.787393329236903*^9}, {
   3.787393476480798*^9, 3.7873935294472713`*^9}, {3.787393655594692*^9, 
   3.7873937003940153`*^9}, {3.787395340744359*^9, 3.787395361640883*^9}, {
   3.787395413183097*^9, 3.787395443789719*^9}, {3.7873957482605247`*^9, 
   3.787395758349403*^9}, {3.787395813393757*^9, 3.787395838736964*^9}, {
   3.7873959470367823`*^9, 3.787395983056024*^9}, {3.787396382212681*^9, 
   3.787396434458333*^9}, {3.787396509873732*^9, 3.787396510525701*^9}, {
   3.78739657622808*^9, 3.787396616243271*^9}, {3.787396688050806*^9, 
   3.787396753641857*^9}, {3.7873973670406733`*^9, 3.787397384512487*^9}, {
   3.787661865752124*^9, 3.787661884565776*^9}, {3.787662375675753*^9, 
   3.787662430193327*^9}, {3.787816020080352*^9, 3.787816029707594*^9}, {
   3.7934425781272097`*^9, 3.793442607062539*^9}, 3.793443623513871*^9, {
   3.801382035630847*^9, 3.8013821205685043`*^9}, {3.8013826223611307`*^9, 
   3.801382666889634*^9}, {3.801384065966755*^9, 3.801384068749864*^9}, {
   3.801384194294551*^9, 3.801384195296371*^9}, {3.801384945863626*^9, 
   3.8013849858552837`*^9}, {3.801386068833585*^9, 3.80138606899391*^9}, {
   3.80139820953922*^9, 3.801398249763185*^9}, {3.8013984182005796`*^9, 
   3.801398435435443*^9}, {3.801401672720052*^9, 3.801401673397962*^9}, {
   3.801401720264455*^9, 3.801401758738736*^9}, {3.801401816676979*^9, 
   3.80140192929126*^9}, {3.801402009285768*^9, 3.8014020098274727`*^9}, {
   3.8014021557779293`*^9, 3.8014022250758457`*^9}, {3.801402339259831*^9, 
   3.8014023572582407`*^9}, {3.807368530387784*^9, 3.807368545892251*^9}, {
   3.8073800805531797`*^9, 3.807380082384431*^9}, {3.807380134086454*^9, 
   3.807380149003269*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[874]:=",ExpressionUUID->"be6509cb-c653-4a3d-b853-05a14630c26b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SDP$DIFFUSE", "[", 
   RowBox[{
   "programPaths_List", ",", "structureInput_", ",", "ImagePlane_List", ",", 
    "givenOptions_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"structureFiles", ",", 
      RowBox[{"workDir", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"$TemporaryDirectory", ",", "\"\<MaXrd\>\""}], "}"}], 
        "]"}]}], ",", "\[IndentingNewLine]", "inputFileDZMC", ",", 
      "\[IndentingNewLine]", "subtractionMode", ",", "lowerCutoff", ",", 
      "\[IndentingNewLine]", "width", ",", "height", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"inputFile1", "=", "\"\<diffuse_input1_crystal.txt\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"inputFile2", "=", "\"\<diffuse_input2_setup.txt\>\""}], ",", 
      "\[IndentingNewLine]", "commands", ",", "feedback", ",", "outputFile", 
      ",", "imageData"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Handle", " ", "both", " ", "crystal", " ", "label", " ", "and", " ", 
      "structure", " ", "file", " ", "input"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$CrystalData", ",", "structureInput"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"subtractionMode", "=", 
         RowBox[{
         "givenOptions", "[", "\"\<BraggScatteringSubtractionMode\>\"", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"subtractionMode", "=", 
         RowBox[{"subtractionMode", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"None", "\[Rule]", "\"\<N\>\""}], ",", 
            RowBox[{"\"\<Biso\>\"", "\[Rule]", "\"\<Y\>\""}], ",", 
            RowBox[{"\"\<ExactAverage\>\"", "\[Rule]", "\"\<E\>\""}], ",", 
            RowBox[{"\"\<SmallAverage\>\"", "\[Rule]", "\"\<e\>\""}]}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"width", ",", "height"}], "}"}], "=", 
         RowBox[{"givenOptions", "[", "\"\<ImageDimensions\>\"", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"structureFiles", "=", 
         RowBox[{"ExportCrystalData", "[", 
          RowBox[{
          "\"\<DIFFUSE\>\"", ",", "structureInput", ",", 
           "\[IndentingNewLine]", "workDir", ",", "ImagePlane", ",", 
           RowBox[{"givenOptions", "[", "\"\<IndicesLimit\>\"", "]"}], ",", 
           "subtractionMode", ",", 
           RowBox[{"{", 
            RowBox[{"width", ",", "height"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"CopyFile", "[", 
          RowBox[{"#1", ",", "#2", ",", 
           RowBox[{"OverwriteTarget", "\[Rule]", "True"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"structureInput", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"workDir", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"inputFile1", ",", "inputFile2"}], "}"}]}]}], 
          "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{"structureFiles", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FileExistsQ", "[", "#", "]"}]}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
         "SimulateDiffractionPattern", "::", "InvalidStructureInput"}], "]"}],
         ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"structureFiles", "=", 
      RowBox[{"AbsoluteFileName", "/@", "structureFiles"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"DeleteFile", "@", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<output*\>\"", ",", "workDir"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inputFileDZMC", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"workDir", ",", "\"\<DZMC_inputs.txt\>\""}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Put", "[", 
      RowBox[{
       RowBox[{"OutputForm", "@", "inputFile2"}], ",", 
       RowBox[{"OutputForm", "[", "\"\<output.bin\>\"", "]"}], ",", 
       "inputFileDZMC"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"commands", "=", 
      RowBox[{
       RowBox[{
       "StringTemplate", "[", 
        "\"\<\ncd `workDir`\n\\\"`prog1`\\\" `inp1` < DZMC_inputs.txt\n\
\\\"`prog2`\\\" --quiet=true output.bin\n\>\"", "]"}], "@", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<workDir\>\"", "\[Rule]", "workDir"}], ",", 
         RowBox[{"\"\<inp1\>\"", "\[Rule]", "inputFile1"}], ",", 
         RowBox[{"\"\<prog1\>\"", "\[Rule]", 
          RowBox[{
          "programPaths", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"\"\<prog2\>\"", "\[Rule]", 
          RowBox[{
          "programPaths", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "|>"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Run", " ", "DIFFUSE", " ", "and", " ", "then", " ", "bin2gray"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"feedback", "=", 
      RowBox[{"RunProcess", "[", 
       RowBox[{"$SystemShell", ",", "All", ",", "commands"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SDP$EvaluateFeedbackPrint", "[", 
      RowBox[{"commands", ",", "feedback", ",", 
       RowBox[{"givenOptions", "[", "\"\<PrintOutput\>\"", "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"outputFile", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"workDir", ",", "\"\<output.pgm\>\""}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "outputFile"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SimulateDiffractionPattern", "::", "MissingOutputData"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"lowerCutoff", "=", 
      RowBox[{"givenOptions", "[", "\"\<LowerCutoff\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"givenOptions", "[", "\"\<UseRawInput\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Import", "@", "outputFile"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"imageData", "=", 
         RowBox[{"N", "@", 
          RowBox[{"Import", "[", 
           RowBox[{"outputFile", ",", "\"\<Data\>\""}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imageData", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "*", 
            RowBox[{"givenOptions", "[", "\"\<ScalingFactor\>\"", "]"}]}], 
           "&"}], "/@", "imageData"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"imageData", "=", 
         RowBox[{"imageData", "/.", 
          RowBox[{
           RowBox[{"x_", "/;", 
            RowBox[{"x", ">", "65535"}]}], "\[Rule]", "65535"}]}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"16", " ", "bit", " ", "max"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"imageData", "=", 
         RowBox[{"imageData", "/.", 
          RowBox[{
           RowBox[{"x_", "/;", 
            RowBox[{"x", "<", "lowerCutoff"}]}], "\[Rule]", "0."}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"TrueQ", "@", 
           RowBox[{"givenOptions", "[", "\"\<ReturnData\>\"", "]"}]}], ",", 
          RowBox[{"Return", "@", "imageData"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{"imageData", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"Normal", "@", "givenOptions"}], ",", 
             RowBox[{"Options", "@", "ArrayPlot"}]}], "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.763444067942569*^9, 3.763444076768383*^9}, {
   3.763444140576406*^9, 3.7634441667745733`*^9}, {3.763445452783616*^9, 
   3.7634454621213617`*^9}, {3.763445493266975*^9, 3.763445508234131*^9}, {
   3.763445539650914*^9, 3.763445610896184*^9}, 3.7634456964703503`*^9, {
   3.7634464752731457`*^9, 3.7634465078442793`*^9}, {3.763446627594833*^9, 
   3.763446641914379*^9}, {3.763448625822485*^9, 3.763448688411724*^9}, {
   3.763458682787753*^9, 3.76345871019275*^9}, {3.763458845111693*^9, 
   3.7634588753321953`*^9}, {3.7634589358446207`*^9, 
   3.7634589588844013`*^9}, {3.7634589976316137`*^9, 
   3.7634590135568123`*^9}, {3.763459116912136*^9, 3.763459128706584*^9}, {
   3.76345919692677*^9, 3.7634592004048433`*^9}, {3.7634594865247173`*^9, 
   3.763459493522946*^9}, {3.763460537501679*^9, 3.763460666323038*^9}, {
   3.763460700975492*^9, 3.7634607629214153`*^9}, {3.763460851358536*^9, 
   3.763460874841769*^9}, {3.7634610744721537`*^9, 3.763461126070581*^9}, {
   3.763461188029662*^9, 3.7634612082543488`*^9}, {3.763461260658887*^9, 
   3.763461278586297*^9}, {3.7634613299513073`*^9, 3.763461338568411*^9}, {
   3.763461675410347*^9, 3.7634616926096907`*^9}, {3.763461727022987*^9, 
   3.763461797367605*^9}, {3.763461833817013*^9, 3.763461939975506*^9}, {
   3.763461997628042*^9, 3.763462126272806*^9}, {3.763463236319697*^9, 
   3.763463236982375*^9}, {3.763644760103071*^9, 3.763644763045479*^9}, {
   3.763663345286734*^9, 3.76366334626149*^9}, {3.763663394774551*^9, 
   3.763663395083741*^9}, {3.763663537274515*^9, 3.763663602912895*^9}, {
   3.763663705031168*^9, 3.7636637113715477`*^9}, {3.763699525740419*^9, 
   3.763699530170108*^9}, {3.763709308913062*^9, 3.763709384956674*^9}, {
   3.76370951545251*^9, 3.763709516457502*^9}, {3.763709957752388*^9, 
   3.763709969607113*^9}, 3.7637100242158413`*^9, {3.763711287084588*^9, 
   3.7637114115492268`*^9}, {3.763711446378128*^9, 3.763711451591894*^9}, {
   3.7637248640217133`*^9, 3.7637248673592176`*^9}, {3.7637250700276527`*^9, 
   3.763725252470545*^9}, {3.7637252891028633`*^9, 3.763725291750958*^9}, {
   3.763725325377145*^9, 3.7637254159794188`*^9}, {3.763725448740388*^9, 
   3.763725457393702*^9}, {3.7637256058419323`*^9, 3.7637256062541227`*^9}, {
   3.763727167019824*^9, 3.763727207357723*^9}, {3.7637273492608767`*^9, 
   3.76372736752308*^9}, {3.763727398747064*^9, 3.763727399003045*^9}, {
   3.763729937787966*^9, 3.763729990242918*^9}, {3.763730682104825*^9, 
   3.7637306887751217`*^9}, {3.763730720776968*^9, 3.7637307642057056`*^9}, {
   3.763730964266704*^9, 3.763730996555264*^9}, {3.763731254562909*^9, 
   3.7637312720588284`*^9}, {3.76373166956351*^9, 3.76373168224958*^9}, {
   3.7637317428634777`*^9, 3.763731842307472*^9}, {3.763731901027958*^9, 
   3.763732139517367*^9}, {3.763732177109869*^9, 3.763732187231112*^9}, {
   3.7637322217809343`*^9, 3.763732328681012*^9}, {3.7637323792270327`*^9, 
   3.763732404895233*^9}, {3.7637327015219088`*^9, 3.763732818806758*^9}, {
   3.763733509279573*^9, 3.763733510894072*^9}, {3.763733584038316*^9, 
   3.763733591652254*^9}, {3.7637336345571117`*^9, 3.763733647916411*^9}, {
   3.763733731067355*^9, 3.7637338147191133`*^9}, 3.763733925151909*^9, {
   3.7637340860075607`*^9, 3.7637340875868998`*^9}, {3.763734119349834*^9, 
   3.763734123275475*^9}, {3.763734165572255*^9, 3.76373419627273*^9}, 
   3.7637343170962257`*^9, {3.763734379150639*^9, 3.763734441179873*^9}, {
   3.763734484014461*^9, 3.763734554939769*^9}, {3.763734591314302*^9, 
   3.763734655570017*^9}, {3.763734785430716*^9, 3.763734820506667*^9}, {
   3.7637348592064238`*^9, 3.7637349519399643`*^9}, {3.7637349995957527`*^9, 
   3.7637350003938017`*^9}, {3.763741207053108*^9, 3.763741262191133*^9}, {
   3.763741300489676*^9, 3.7637413617128773`*^9}, 3.763988726929099*^9, {
   3.763988868671323*^9, 3.7639888700052547`*^9}, {3.763989035877824*^9, 
   3.7639890377687902`*^9}, {3.7639897720500593`*^9, 3.763989799433291*^9}, {
   3.763989894259738*^9, 3.763989980196909*^9}, {3.763990011972438*^9, 
   3.76399004879478*^9}, {3.764077848761304*^9, 3.7640778957976913`*^9}, {
   3.764077949597375*^9, 3.764077979203281*^9}, 3.764940091477598*^9, {
   3.764940839938933*^9, 3.76494084532124*^9}, 3.764941505672908*^9, {
   3.76494182510563*^9, 3.7649418528040533`*^9}, {3.764942176639078*^9, 
   3.764942190460372*^9}, {3.764943692079373*^9, 3.764943707349574*^9}, {
   3.7650170879784455`*^9, 3.7650171431850033`*^9}, {3.765017173569789*^9, 
   3.765017174169155*^9}, {3.765017227072736*^9, 3.7650172565579224`*^9}, {
   3.76501729522456*^9, 3.7650173064964266`*^9}, {3.7650173415317774`*^9, 
   3.76501739821924*^9}, {3.7650174716010838`*^9, 3.7650174879723225`*^9}, {
   3.7650175644257464`*^9, 3.7650175709629927`*^9}, {3.7650176138229437`*^9, 
   3.7650176195602193`*^9}, {3.7650176759804263`*^9, 
   3.7650176914098196`*^9}, {3.76501774513188*^9, 3.765017775433133*^9}, {
   3.7650178075357285`*^9, 3.765017813455535*^9}, {3.7650178951946526`*^9, 
   3.765017953225588*^9}, {3.765018091317548*^9, 3.7650181234117374`*^9}, {
   3.7650181844256964`*^9, 3.765018220399535*^9}, {3.7650182770451994`*^9, 
   3.765018318765643*^9}, {3.765095406370245*^9, 3.7650954221728125`*^9}, {
   3.7650955267366333`*^9, 3.7650955270643053`*^9}, {3.765096045929923*^9, 
   3.7650960750951447`*^9}, {3.765098485455556*^9, 3.765098489875266*^9}, {
   3.766901646128586*^9, 3.766901746708198*^9}, {3.767932948932156*^9, 
   3.7679330712401867`*^9}, {3.767933119520987*^9, 3.7679331209667873`*^9}, {
   3.767933377866897*^9, 3.767933378344687*^9}, {3.767933481800856*^9, 
   3.767933496792658*^9}, {3.767934356250738*^9, 3.767934392976789*^9}, 
   3.767934963856374*^9, {3.767935018762374*^9, 3.767935051529188*^9}, {
   3.767941262452351*^9, 3.767941290203662*^9}, {3.767945957460162*^9, 
   3.767945979928673*^9}, {3.767946243371818*^9, 3.767946280289606*^9}, {
   3.76794633801793*^9, 3.7679464018476458`*^9}, 3.768037396579338*^9, {
   3.768038320976747*^9, 3.768038330678945*^9}, {3.768048095128319*^9, 
   3.768048116425613*^9}, {3.768049396663374*^9, 3.7680494549730053`*^9}, {
   3.768049521701342*^9, 3.768049523203978*^9}, {3.76804955330964*^9, 
   3.768049562955158*^9}, {3.768049706185314*^9, 3.768049753735092*^9}, {
   3.7680502787301702`*^9, 3.7680503104237223`*^9}, {3.768050399144342*^9, 
   3.768050425824094*^9}, {3.768050460086996*^9, 3.768050515836998*^9}, {
   3.76805055838245*^9, 3.768050568115727*^9}, {3.7680506080832787`*^9, 
   3.768050713160241*^9}, {3.768050765089644*^9, 3.7680507992324677`*^9}, {
   3.768050832287966*^9, 3.768050859964662*^9}, {3.768050935517522*^9, 
   3.768050972617827*^9}, 3.7680510253716583`*^9, {3.7680510921371307`*^9, 
   3.768051093759262*^9}, {3.768051152072495*^9, 3.768051236574657*^9}, {
   3.768051280149665*^9, 3.768051351697927*^9}, {3.768051381778912*^9, 
   3.7680514243701973`*^9}, {3.7680514627855167`*^9, 3.768051504566792*^9}, {
   3.768051638822077*^9, 3.768051639027533*^9}, {3.768051720723784*^9, 
   3.768051785801979*^9}, {3.76805362313898*^9, 3.7680536390255537`*^9}, 
   3.768069289135805*^9, {3.768071043877576*^9, 3.7680710531962767`*^9}, 
   3.768071114367579*^9, {3.768071148446699*^9, 3.7680711569956913`*^9}, {
   3.768071227780283*^9, 3.768071255228674*^9}, {3.768071746401927*^9, 
   3.768071759959331*^9}, {3.768071827237879*^9, 3.768071859734199*^9}, {
   3.76807204358744*^9, 3.768072085375852*^9}, {3.768072133328083*^9, 
   3.768072280132167*^9}, {3.7680723386931343`*^9, 3.768072356466728*^9}, {
   3.768072412035928*^9, 3.7680724517044163`*^9}, {3.768072492791613*^9, 
   3.7680726525882177`*^9}, {3.768072803082613*^9, 3.768072954581532*^9}, {
   3.768073003719076*^9, 3.768073025062667*^9}, {3.768073059429037*^9, 
   3.7680730637404337`*^9}, {3.768073115268412*^9, 3.768073120338152*^9}, {
   3.768073236488963*^9, 3.7680732455593243`*^9}, 3.7680732974720097`*^9, {
   3.768073387982318*^9, 3.7680733893476677`*^9}, {3.768073449364252*^9, 
   3.768073456309534*^9}, {3.768073569401689*^9, 3.768073729975181*^9}, {
   3.768073787804573*^9, 3.768073799187344*^9}, {3.7680739536733217`*^9, 
   3.76807396220833*^9}, {3.7680741479012213`*^9, 3.768074155723254*^9}, {
   3.768074269601205*^9, 3.768074284385496*^9}, {3.7680745083566647`*^9, 
   3.768074650730132*^9}, {3.7680751063036137`*^9, 3.768075115007234*^9}, {
   3.768075151678876*^9, 3.76807520123811*^9}, {3.768075231926243*^9, 
   3.768075381642386*^9}, {3.768075458793137*^9, 3.768075468736286*^9}, {
   3.7680755215689373`*^9, 3.768075521959115*^9}, {3.768108154597683*^9, 
   3.7681081582489023`*^9}, {3.768108395901738*^9, 3.768108418571369*^9}, {
   3.78309732666306*^9, 3.783097326726473*^9}, {3.783097498186139*^9, 
   3.7830974993139553`*^9}, {3.783109460658391*^9, 3.783109473707341*^9}, 
   3.7831110166497107`*^9, {3.783111495166415*^9, 3.783111505229232*^9}, {
   3.783111538180263*^9, 3.783111575050946*^9}, 3.78311160654972*^9, {
   3.7831116447637444`*^9, 3.783111653722878*^9}, {3.783111694747717*^9, 
   3.783111751920436*^9}, {3.7831118265837793`*^9, 3.783111904332617*^9}, {
   3.783111938806333*^9, 3.783112032113505*^9}, {3.783112064338263*^9, 
   3.783112112315653*^9}, {3.7831121436130867`*^9, 3.783112147831524*^9}, {
   3.783112296478207*^9, 3.783112310844158*^9}, {3.7831128522232313`*^9, 
   3.783112854852365*^9}, {3.783113021302622*^9, 3.783113023045177*^9}, {
   3.78311306053505*^9, 3.78311306073285*^9}, {3.783113186820548*^9, 
   3.783113192081553*^9}, {3.783113226547812*^9, 3.78311328754738*^9}, {
   3.783113372546876*^9, 3.783113373821938*^9}, 3.783113417846919*^9, {
   3.7831135980026417`*^9, 3.783113598312976*^9}, {3.783113671751898*^9, 
   3.7831136785513678`*^9}, {3.783113751741268*^9, 3.783113767421331*^9}, {
   3.783113803077372*^9, 3.7831139499038963`*^9}, {3.783114031937003*^9, 
   3.783114082123698*^9}, {3.783114117256618*^9, 3.783114132070093*^9}, {
   3.783114170333955*^9, 3.783114213075441*^9}, {3.783114676486951*^9, 
   3.783114692600787*^9}, {3.783114760074692*^9, 3.783114760224285*^9}, {
   3.7831148374148006`*^9, 3.783114925475636*^9}, {3.783115042091419*^9, 
   3.783115045460257*^9}, {3.783115421979576*^9, 3.783115422480939*^9}, {
   3.7831157704273148`*^9, 3.7831157768974733`*^9}, {3.783115808504879*^9, 
   3.783115826911056*^9}, {3.7831158579119587`*^9, 3.783115880438168*^9}, {
   3.7831159234399843`*^9, 3.783115932101173*^9}, {3.7831159704289*^9, 
   3.7831161227620687`*^9}, {3.7831161719292*^9, 3.783116172056731*^9}, {
   3.783116203328876*^9, 3.783116282853911*^9}, {3.783116322478731*^9, 
   3.78311638249175*^9}, {3.7831164997952213`*^9, 3.783116521976623*^9}, {
   3.7831166052958813`*^9, 3.783116633606085*^9}, {3.783116676407399*^9, 
   3.78311673023662*^9}, {3.7831167743561993`*^9, 3.7831169275684223`*^9}, {
   3.783117022550683*^9, 3.7831171062442503`*^9}, {3.783117218138493*^9, 
   3.783117377590664*^9}, {3.783117433430766*^9, 3.783117606881391*^9}, {
   3.783117649474691*^9, 3.783117655265864*^9}, {3.783117687511651*^9, 
   3.783117733327178*^9}, {3.783117817407319*^9, 3.783117853140182*^9}, {
   3.783183602291593*^9, 3.783183666935953*^9}, {3.783195535011774*^9, 
   3.783195580512806*^9}, {3.7831960403388157`*^9, 3.783196148029149*^9}, {
   3.783337730399762*^9, 3.783337760467977*^9}, {3.783341479000957*^9, 
   3.783341480013445*^9}, {3.783341586069021*^9, 3.783341586695043*^9}, {
   3.783341630424508*^9, 3.783341635110897*^9}, {3.783357892072654*^9, 
   3.783357950453101*^9}, {3.78335816081747*^9, 3.783358184959188*^9}, {
   3.7833592707117243`*^9, 3.783359273430149*^9}, {3.783359349078877*^9, 
   3.7833593782298822`*^9}, {3.7833597414691687`*^9, 3.783359742163143*^9}, {
   3.7833597766356153`*^9, 3.783359888846952*^9}, 3.783360192993559*^9, {
   3.783360262983646*^9, 3.783360263485585*^9}, {3.7833611484226637`*^9, 
   3.783361200499422*^9}, {3.7833612828672953`*^9, 3.783361317849146*^9}, {
   3.78336142156833*^9, 3.7833614217105007`*^9}, 3.783361612310363*^9, {
   3.783361735971097*^9, 3.783361749385316*^9}, {3.7833617842087317`*^9, 
   3.783361797760233*^9}, {3.78336192403092*^9, 3.783361947141118*^9}, {
   3.7833619988446217`*^9, 3.783362048060721*^9}, {3.783362109931161*^9, 
   3.783362152007947*^9}, {3.7833621875210247`*^9, 3.783362188471751*^9}, {
   3.783362246279718*^9, 3.7833622470780497`*^9}, {3.783362292695167*^9, 
   3.7833623695235*^9}, {3.78336268958251*^9, 3.7833626899002237`*^9}, {
   3.783602994501432*^9, 3.783603024714653*^9}, {3.7836048854444857`*^9, 
   3.7836048882270412`*^9}, {3.7836124881392937`*^9, 3.78361250608764*^9}, {
   3.783612627758553*^9, 3.783612733162237*^9}, {3.7836824691342793`*^9, 
   3.783682622537614*^9}, {3.783682887128449*^9, 3.783682982472754*^9}, {
   3.7836831276135397`*^9, 3.783683163982766*^9}, {3.7836835695456996`*^9, 
   3.783683571866524*^9}, 3.7836839817901707`*^9, 3.7836840500093465`*^9, {
   3.7836841080344934`*^9, 3.7836841633818293`*^9}, {3.7836842245476894`*^9, 
   3.7836842324537106`*^9}, {3.783684279955166*^9, 3.7836843085500402`*^9}, {
   3.7836844312708206`*^9, 3.7836844647929745`*^9}, {3.7836846308760867`*^9, 
   3.7836846690545597`*^9}, {3.7836847221783295`*^9, 3.783684722397772*^9}, {
   3.783684756635277*^9, 3.783684783485943*^9}, {3.78370655767628*^9, 
   3.7837065603145933`*^9}, {3.783707001883498*^9, 3.783707002313046*^9}, {
   3.783707203613359*^9, 3.7837072332764177`*^9}, {3.783707487417384*^9, 
   3.7837074978704853`*^9}, {3.7837091447490797`*^9, 3.78370919003436*^9}, {
   3.783709229169327*^9, 3.783709259072736*^9}, {3.783720037565337*^9, 
   3.7837201409614677`*^9}, {3.783720220553156*^9, 3.783720238350997*^9}, {
   3.783720493683169*^9, 3.783720498833128*^9}, {3.783720533938393*^9, 
   3.7837205607438087`*^9}, {3.7837206137045717`*^9, 
   3.7837206289187107`*^9}, {3.7837206628720293`*^9, 3.783720701535265*^9}, {
   3.783720848027961*^9, 3.783720868993805*^9}, {3.783720904338582*^9, 
   3.783720938490098*^9}, {3.783721077158462*^9, 3.783721099022724*^9}, {
   3.783721332081876*^9, 3.783721333279608*^9}, {3.783751035600183*^9, 
   3.783751048654748*^9}, {3.7837598003005543`*^9, 3.783759809194661*^9}, {
   3.783886976539596*^9, 3.78388708791124*^9}, {3.7838871242467823`*^9, 
   3.783887148693001*^9}, {3.783887366385869*^9, 3.783887415014983*^9}, {
   3.784283714250349*^9, 3.784283718672702*^9}, {3.784283919893018*^9, 
   3.7842839284526663`*^9}, 3.784284117072908*^9, {3.7842900459619093`*^9, 
   3.784290048831985*^9}, {3.784290090992951*^9, 3.784290091359025*^9}, {
   3.784290172548987*^9, 3.784290251035563*^9}, {3.784290501942449*^9, 
   3.784290626904635*^9}, 3.784290675590343*^9, {3.784290773676015*^9, 
   3.7842907838019533`*^9}, {3.784291112011567*^9, 3.784291115594602*^9}, {
   3.78429115593152*^9, 3.784291156089546*^9}, {3.784292404423154*^9, 
   3.7842924526754103`*^9}, {3.784452859789545*^9, 3.7844528616265182`*^9}, 
   3.7844529412190657`*^9, 3.784453125574597*^9, {3.784453198923523*^9, 
   3.78445321829842*^9}, {3.78445328378168*^9, 3.784453313258402*^9}, {
   3.784453354254827*^9, 3.7844534035957603`*^9}, {3.784453436272448*^9, 
   3.784453553988855*^9}, {3.7844536250719643`*^9, 3.784453626156081*^9}, {
   3.7844536626678867`*^9, 3.784453732615019*^9}, {3.784453765085561*^9, 
   3.784453767111725*^9}, {3.7844538035601053`*^9, 3.784453808894943*^9}, {
   3.784454414370914*^9, 3.7844544757405577`*^9}, 3.784454682473584*^9, {
   3.784454720046812*^9, 3.78445472945155*^9}, 3.784455136086439*^9, 
   3.784457343673143*^9, {3.787056664163251*^9, 3.787056665857003*^9}, {
   3.7876468464321413`*^9, 3.7876468660462112`*^9}, {3.787647054323094*^9, 
   3.7876470837537403`*^9}, 3.7876557642426443`*^9, {3.787655854905325*^9, 
   3.787655858128023*^9}, {3.787656185515628*^9, 3.7876561856821413`*^9}, {
   3.787657647182098*^9, 3.787657680803125*^9}, {3.7876578052979183`*^9, 
   3.7876578090874147`*^9}, {3.787658946948803*^9, 3.787658977065421*^9}, {
   3.7876598526288652`*^9, 3.7876598690584383`*^9}, {3.787661371112962*^9, 
   3.787661373030953*^9}, {3.787661411159882*^9, 3.787661441622595*^9}, {
   3.78766147220675*^9, 3.7876614883882236`*^9}, {3.7934370595485*^9, 
   3.793437072883247*^9}, {3.7934424355432*^9, 3.793442436361741*^9}, {
   3.793442592318426*^9, 3.793442595078354*^9}, {3.793443643214522*^9, 
   3.7934436714442463`*^9}, {3.793443771690557*^9, 3.793443786362472*^9}, 
   3.793444060487103*^9, {3.801385031775238*^9, 3.801385033630952*^9}, {
   3.801385374015686*^9, 3.8013853923520393`*^9}, {3.807367835029551*^9, 
   3.8073678717788277`*^9}, {3.8073679074967546`*^9, 3.807367939924692*^9}, {
   3.807368552251698*^9, 3.8073685546822157`*^9}, {3.807368588033163*^9, 
   3.8073686229035788`*^9}, {3.8073692089731407`*^9, 
   3.8073692372713537`*^9}, {3.807370432078446*^9, 3.807370464314968*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[875]:=",ExpressionUUID->"40e7f9df-79b4-42bf-a286-64f6561a5b11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SDP$EvaluateFeedbackPrint", "[", 
   RowBox[{
   "commands_String", ",", "Feedback_Association", ",", "optionSetting_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"feedback", "=", "Feedback"}], ",", "stderr"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"optionSetting", "===", "All"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Print", "@", 
       RowBox[{"Prepend", "[", 
        RowBox[{"feedback", ",", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", "commands"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Removing", " ", "irrelevant", " ", "errors"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stderr", "=", 
        RowBox[{"StringTrim", "@", 
         RowBox[{"StringDelete", "[", 
          RowBox[{
           RowBox[{"feedback", "[", "\"\<StandardError\>\"", "]"}], ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "\"\<Remaining memory\>\"", "~~", "__", "~~", 
              "WhitespaceCharacter"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "WhitespaceCharacter", "~~", "\"\<More segments\>\"", "~~", 
              "__"}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<'\\\\\\\\\>\"", "~~", "__", "~~", "\"\<UNC paths\>\"", "~~",
               "__", "~~", "\"\<Defaulting to Windows directory.\>\""}]}], 
            "\[IndentingNewLine]", "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"stderr", "=!=", "\"\<\>\""}], "||", 
          RowBox[{
           RowBox[{"feedback", "[", "\"\<ErrorCode\>\"", "]"}], "\[Equal]", 
           "2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Print", "@", "stderr"}]}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.763444067942569*^9, 3.763444076768383*^9}, {
   3.763444140576406*^9, 3.7634441667745733`*^9}, {3.763445452783616*^9, 
   3.7634454621213617`*^9}, {3.763445493266975*^9, 3.763445508234131*^9}, {
   3.763445539650914*^9, 3.763445610896184*^9}, 3.7634456964703503`*^9, {
   3.7634464752731457`*^9, 3.7634465078442793`*^9}, {3.763446627594833*^9, 
   3.763446641914379*^9}, {3.763448625822485*^9, 3.763448688411724*^9}, {
   3.763458682787753*^9, 3.76345871019275*^9}, {3.763458845111693*^9, 
   3.7634588753321953`*^9}, {3.7634589358446207`*^9, 
   3.7634589588844013`*^9}, {3.7634589976316137`*^9, 
   3.7634590135568123`*^9}, {3.763459116912136*^9, 3.763459128706584*^9}, {
   3.76345919692677*^9, 3.7634592004048433`*^9}, {3.7634594865247173`*^9, 
   3.763459493522946*^9}, {3.763460537501679*^9, 3.763460666323038*^9}, {
   3.763460700975492*^9, 3.7634607629214153`*^9}, {3.763460851358536*^9, 
   3.763460874841769*^9}, {3.7634610744721537`*^9, 3.763461126070581*^9}, {
   3.763461188029662*^9, 3.7634612082543488`*^9}, {3.763461260658887*^9, 
   3.763461278586297*^9}, {3.7634613299513073`*^9, 3.763461338568411*^9}, {
   3.763461675410347*^9, 3.7634616926096907`*^9}, {3.763461727022987*^9, 
   3.763461797367605*^9}, {3.763461833817013*^9, 3.763461939975506*^9}, {
   3.763461997628042*^9, 3.763462126272806*^9}, {3.763463236319697*^9, 
   3.763463236982375*^9}, {3.763644760103071*^9, 3.763644763045479*^9}, {
   3.763663345286734*^9, 3.76366334626149*^9}, {3.763663394774551*^9, 
   3.763663395083741*^9}, {3.763663537274515*^9, 3.763663602912895*^9}, {
   3.763663705031168*^9, 3.7636637113715477`*^9}, {3.763699525740419*^9, 
   3.763699530170108*^9}, {3.763709308913062*^9, 3.763709384956674*^9}, {
   3.76370951545251*^9, 3.763709516457502*^9}, {3.763709957752388*^9, 
   3.763709969607113*^9}, 3.7637100242158413`*^9, {3.763711287084588*^9, 
   3.7637114115492268`*^9}, {3.763711446378128*^9, 3.763711451591894*^9}, {
   3.7637248640217133`*^9, 3.7637248673592176`*^9}, {3.7637250700276527`*^9, 
   3.763725252470545*^9}, {3.7637252891028633`*^9, 3.763725291750958*^9}, {
   3.763725325377145*^9, 3.7637254159794188`*^9}, {3.763725448740388*^9, 
   3.763725457393702*^9}, {3.7637256058419323`*^9, 3.7637256062541227`*^9}, {
   3.763727167019824*^9, 3.763727207357723*^9}, {3.7637273492608767`*^9, 
   3.76372736752308*^9}, {3.763727398747064*^9, 3.763727399003045*^9}, {
   3.763729937787966*^9, 3.763729990242918*^9}, {3.763730682104825*^9, 
   3.7637306887751217`*^9}, {3.763730720776968*^9, 3.7637307642057056`*^9}, {
   3.763730964266704*^9, 3.763730996555264*^9}, {3.763731254562909*^9, 
   3.7637312720588284`*^9}, {3.76373166956351*^9, 3.76373168224958*^9}, {
   3.7637317428634777`*^9, 3.763731842307472*^9}, {3.763731901027958*^9, 
   3.763732139517367*^9}, {3.763732177109869*^9, 3.763732187231112*^9}, {
   3.7637322217809343`*^9, 3.763732328681012*^9}, {3.7637323792270327`*^9, 
   3.763732404895233*^9}, {3.7637327015219088`*^9, 3.763732818806758*^9}, {
   3.763733509279573*^9, 3.763733510894072*^9}, {3.763733584038316*^9, 
   3.763733591652254*^9}, {3.7637336345571117`*^9, 3.763733647916411*^9}, {
   3.763733731067355*^9, 3.7637338147191133`*^9}, 3.763733925151909*^9, {
   3.7637340860075607`*^9, 3.7637340875868998`*^9}, {3.763734119349834*^9, 
   3.763734123275475*^9}, {3.763734165572255*^9, 3.76373419627273*^9}, 
   3.7637343170962257`*^9, {3.763734379150639*^9, 3.763734441179873*^9}, {
   3.763734484014461*^9, 3.763734554939769*^9}, {3.763734591314302*^9, 
   3.763734655570017*^9}, {3.763734785430716*^9, 3.763734820506667*^9}, {
   3.7637348592064238`*^9, 3.7637349519399643`*^9}, {3.7637349995957527`*^9, 
   3.7637350003938017`*^9}, {3.763741207053108*^9, 3.763741262191133*^9}, {
   3.763741300489676*^9, 3.7637413617128773`*^9}, 3.763988726929099*^9, {
   3.763988868671323*^9, 3.7639888700052547`*^9}, {3.763989035877824*^9, 
   3.7639890377687902`*^9}, {3.7639897720500593`*^9, 3.763989799433291*^9}, {
   3.763989894259738*^9, 3.763989980196909*^9}, {3.763990011972438*^9, 
   3.76399004879478*^9}, {3.764077848761304*^9, 3.7640778957976913`*^9}, {
   3.764077949597375*^9, 3.764077979203281*^9}, 3.764940091477598*^9, {
   3.764940839938933*^9, 3.76494084532124*^9}, 3.764941505672908*^9, {
   3.76494182510563*^9, 3.7649418528040533`*^9}, {3.764942176639078*^9, 
   3.764942190460372*^9}, {3.764943692079373*^9, 3.764943707349574*^9}, {
   3.7650170879784455`*^9, 3.7650171431850033`*^9}, {3.765017173569789*^9, 
   3.765017174169155*^9}, {3.765017227072736*^9, 3.7650172565579224`*^9}, {
   3.76501729522456*^9, 3.7650173064964266`*^9}, {3.7650173415317774`*^9, 
   3.76501739821924*^9}, {3.7650174716010838`*^9, 3.7650174879723225`*^9}, {
   3.7650175644257464`*^9, 3.7650175709629927`*^9}, {3.7650176138229437`*^9, 
   3.7650176195602193`*^9}, {3.7650176759804263`*^9, 
   3.7650176914098196`*^9}, {3.76501774513188*^9, 3.765017775433133*^9}, {
   3.7650178075357285`*^9, 3.765017813455535*^9}, {3.7650178951946526`*^9, 
   3.765017953225588*^9}, {3.765018091317548*^9, 3.7650181234117374`*^9}, {
   3.7650181844256964`*^9, 3.765018220399535*^9}, {3.7650182770451994`*^9, 
   3.765018318765643*^9}, {3.765095406370245*^9, 3.7650954221728125`*^9}, {
   3.7650955267366333`*^9, 3.7650955270643053`*^9}, {3.765096045929923*^9, 
   3.7650960750951447`*^9}, {3.765098485455556*^9, 3.765098489875266*^9}, {
   3.766901646128586*^9, 3.766901746708198*^9}, {3.767932948932156*^9, 
   3.7679330712401867`*^9}, {3.767933119520987*^9, 3.7679331209667873`*^9}, {
   3.767933377866897*^9, 3.767933378344687*^9}, {3.767933481800856*^9, 
   3.767933496792658*^9}, {3.767934356250738*^9, 3.767934392976789*^9}, 
   3.767934963856374*^9, {3.767935018762374*^9, 3.767935051529188*^9}, {
   3.767941262452351*^9, 3.767941290203662*^9}, {3.767945957460162*^9, 
   3.767945979928673*^9}, {3.767946243371818*^9, 3.767946280289606*^9}, {
   3.76794633801793*^9, 3.7679464018476458`*^9}, 3.768037396579338*^9, {
   3.768038320976747*^9, 3.768038330678945*^9}, {3.768048095128319*^9, 
   3.768048116425613*^9}, {3.768049396663374*^9, 3.7680494549730053`*^9}, {
   3.768049521701342*^9, 3.768049523203978*^9}, {3.76804955330964*^9, 
   3.768049562955158*^9}, {3.768049706185314*^9, 3.768049753735092*^9}, {
   3.7680502787301702`*^9, 3.7680503104237223`*^9}, {3.768050399144342*^9, 
   3.768050425824094*^9}, {3.768050460086996*^9, 3.768050515836998*^9}, {
   3.76805055838245*^9, 3.768050568115727*^9}, {3.7680506080832787`*^9, 
   3.768050713160241*^9}, {3.768050765089644*^9, 3.7680507992324677`*^9}, {
   3.768050832287966*^9, 3.768050859964662*^9}, {3.768050935517522*^9, 
   3.768050972617827*^9}, 3.7680510253716583`*^9, {3.7680510921371307`*^9, 
   3.768051093759262*^9}, {3.768051152072495*^9, 3.768051236574657*^9}, {
   3.768051280149665*^9, 3.768051351697927*^9}, {3.768051381778912*^9, 
   3.7680514243701973`*^9}, {3.7680514627855167`*^9, 3.768051504566792*^9}, {
   3.768051638822077*^9, 3.768051639027533*^9}, {3.768051720723784*^9, 
   3.768051785801979*^9}, {3.76805362313898*^9, 3.7680536390255537`*^9}, 
   3.768069289135805*^9, {3.768071043877576*^9, 3.7680710531962767`*^9}, 
   3.768071114367579*^9, {3.768071148446699*^9, 3.7680711569956913`*^9}, {
   3.768071227780283*^9, 3.768071255228674*^9}, {3.768071746401927*^9, 
   3.768071759959331*^9}, {3.768071827237879*^9, 3.768071859734199*^9}, {
   3.76807204358744*^9, 3.768072085375852*^9}, {3.768072133328083*^9, 
   3.768072280132167*^9}, {3.7680723386931343`*^9, 3.768072356466728*^9}, {
   3.768072412035928*^9, 3.7680724517044163`*^9}, {3.768072492791613*^9, 
   3.7680726525882177`*^9}, {3.768072803082613*^9, 3.768072954581532*^9}, {
   3.768073003719076*^9, 3.768073025062667*^9}, {3.768073059429037*^9, 
   3.7680730637404337`*^9}, {3.768073115268412*^9, 3.768073120338152*^9}, {
   3.768073236488963*^9, 3.7680732455593243`*^9}, 3.7680732974720097`*^9, {
   3.768073387982318*^9, 3.7680733893476677`*^9}, {3.768073449364252*^9, 
   3.768073456309534*^9}, {3.768073569401689*^9, 3.768073729975181*^9}, {
   3.768073787804573*^9, 3.768073799187344*^9}, {3.7680739536733217`*^9, 
   3.76807396220833*^9}, {3.7680741479012213`*^9, 3.768074155723254*^9}, {
   3.768074269601205*^9, 3.768074284385496*^9}, {3.7680745083566647`*^9, 
   3.768074650730132*^9}, {3.7680751063036137`*^9, 3.768075115007234*^9}, {
   3.768075151678876*^9, 3.76807520123811*^9}, {3.768075231926243*^9, 
   3.768075381642386*^9}, {3.768075458793137*^9, 3.768075468736286*^9}, {
   3.7680755215689373`*^9, 3.768075521959115*^9}, {3.768108154597683*^9, 
   3.7681081582489023`*^9}, {3.768108395901738*^9, 3.768108418571369*^9}, {
   3.78309732666306*^9, 3.783097326726473*^9}, {3.783097498186139*^9, 
   3.7830974993139553`*^9}, {3.783109460658391*^9, 3.783109473707341*^9}, 
   3.7831110166497107`*^9, {3.783111495166415*^9, 3.783111505229232*^9}, {
   3.783111538180263*^9, 3.783111575050946*^9}, 3.78311160654972*^9, {
   3.7831116447637444`*^9, 3.783111653722878*^9}, {3.783111694747717*^9, 
   3.783111751920436*^9}, {3.7831118265837793`*^9, 3.783111904332617*^9}, {
   3.783111938806333*^9, 3.783112032113505*^9}, {3.783112064338263*^9, 
   3.783112112315653*^9}, {3.7831121436130867`*^9, 3.783112147831524*^9}, {
   3.783112296478207*^9, 3.783112310844158*^9}, {3.7831128522232313`*^9, 
   3.783112854852365*^9}, {3.783113021302622*^9, 3.783113023045177*^9}, {
   3.78311306053505*^9, 3.78311306073285*^9}, {3.783113186820548*^9, 
   3.783113192081553*^9}, {3.783113226547812*^9, 3.78311328754738*^9}, {
   3.783113372546876*^9, 3.783113373821938*^9}, 3.783113417846919*^9, {
   3.7831135980026417`*^9, 3.783113598312976*^9}, {3.783113671751898*^9, 
   3.7831136785513678`*^9}, {3.783113751741268*^9, 3.783113767421331*^9}, {
   3.783113803077372*^9, 3.7831139499038963`*^9}, {3.783114031937003*^9, 
   3.783114082123698*^9}, {3.783114117256618*^9, 3.783114132070093*^9}, {
   3.783114170333955*^9, 3.783114213075441*^9}, {3.783114676486951*^9, 
   3.783114692600787*^9}, {3.783114760074692*^9, 3.783114760224285*^9}, {
   3.7831148374148006`*^9, 3.783114925475636*^9}, {3.783115042091419*^9, 
   3.783115045460257*^9}, {3.783115421979576*^9, 3.783115422480939*^9}, {
   3.7831157704273148`*^9, 3.7831157768974733`*^9}, {3.783115808504879*^9, 
   3.783115826911056*^9}, {3.7831158579119587`*^9, 3.783115880438168*^9}, {
   3.7831159234399843`*^9, 3.783115932101173*^9}, {3.7831159704289*^9, 
   3.7831161227620687`*^9}, {3.7831161719292*^9, 3.783116172056731*^9}, {
   3.783116203328876*^9, 3.783116282853911*^9}, {3.783116322478731*^9, 
   3.78311638249175*^9}, {3.7831164997952213`*^9, 3.783116521976623*^9}, {
   3.7831166052958813`*^9, 3.783116633606085*^9}, {3.783116676407399*^9, 
   3.78311673023662*^9}, {3.7831167743561993`*^9, 3.7831169275684223`*^9}, {
   3.783117022550683*^9, 3.7831171062442503`*^9}, {3.783117218138493*^9, 
   3.783117377590664*^9}, {3.783117433430766*^9, 3.783117606881391*^9}, {
   3.783117649474691*^9, 3.783117655265864*^9}, {3.783117687511651*^9, 
   3.783117733327178*^9}, {3.783117817407319*^9, 3.783117853140182*^9}, {
   3.783183602291593*^9, 3.783183666935953*^9}, {3.783195535011774*^9, 
   3.783195580512806*^9}, {3.7831960403388157`*^9, 3.783196148029149*^9}, {
   3.783337730399762*^9, 3.783337760467977*^9}, {3.783341479000957*^9, 
   3.783341480013445*^9}, {3.783341586069021*^9, 3.783341586695043*^9}, {
   3.783341630424508*^9, 3.783341635110897*^9}, {3.783357892072654*^9, 
   3.783357950453101*^9}, {3.78335816081747*^9, 3.783358184959188*^9}, {
   3.7833592707117243`*^9, 3.783359273430149*^9}, {3.783359349078877*^9, 
   3.7833593782298822`*^9}, {3.7833597414691687`*^9, 3.783359742163143*^9}, {
   3.7833597766356153`*^9, 3.783359888846952*^9}, 3.783360192993559*^9, {
   3.783360262983646*^9, 3.783360263485585*^9}, {3.783360612174872*^9, 
   3.783360702845482*^9}, {3.783360845891427*^9, 3.7833608677382517`*^9}, {
   3.783360904609727*^9, 3.78336113689291*^9}, {3.783361267618582*^9, 
   3.783361308336261*^9}, {3.783361349601725*^9, 3.7833614138794737`*^9}, {
   3.783361566509615*^9, 3.7833615731802883`*^9}, {3.783361626492614*^9, 
   3.7833616427946243`*^9}, {3.783361708795083*^9, 3.783361708984995*^9}, {
   3.7836125136354427`*^9, 3.783612514365996*^9}, {3.783612756243144*^9, 
   3.78361277417703*^9}, {3.783612884936061*^9, 3.783612895550219*^9}, {
   3.783701909345777*^9, 3.783701940064477*^9}, {3.7837020002959223`*^9, 
   3.78370201090267*^9}, {3.783702075197122*^9, 3.783702099317112*^9}, {
   3.78370466169659*^9, 3.783704662998446*^9}, {3.7837047354551897`*^9, 
   3.78370473743661*^9}, {3.783759938649442*^9, 3.7837600840144215`*^9}, {
   3.7837605654944425`*^9, 3.783760567272689*^9}, {3.7873954964167852`*^9, 
   3.78739549698144*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[876]:=",ExpressionUUID->"55fb8114-b9c1-4749-abb0-da905920623f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[877]:=",ExpressionUUID->"37eb05c4-1b8b-422d-8d1a-602e8d850232"]
}, Closed]],

Cell[CellGroupData[{

Cell["StructureFactor", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327322973885*^9, 3.682327330887693*^9}, 3.682607017127143*^9, 
   3.6839701729945917`*^9, 3.6841388311985064`*^9, 3.6908782674206257`*^9, {
   3.7186534034983*^9, 3.718653404817141*^9}, 
   3.7391696076737328`*^9},ExpressionUUID->"52a522f3-3b72-4138-b76b-\
e0e974238324"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[878]:=",ExpressionUUID->"ca35df03-657e-4d91-8d6d-0e50f756b696"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StructureFactor", "::", "invalidsetting"}], "=", 
   "\"\<Invalid setting of the `1` option.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StructureFactor", "::", "extinct"}], "=", 
   "\"\<The reflection `1` is systematically absent for space group \
`2`.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StructureFactor", "::", "mismatch"}], "=", 
    "\"\<Element mismatch detected.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "StructureFactor"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<AbsoluteValue\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<IgnoreSystematicAbsence\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Threshold\>\"", "\[Rule]", 
       RowBox[{"Power", "[", 
        RowBox[{"10.", ",", 
         RowBox[{"-", "6"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Options", " ", 
        RowBox[{"from", " ", "'"}], 
        RowBox[{"GetAtomicScatteringFactors", "'"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<DispersionCorrections\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\[IndentingNewLine]", 
        RowBox[{
        "GetAtomicScatteringFactors", ",", "\"\<DispersionCorrections\>\""}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<f0Source\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\[IndentingNewLine]", 
        RowBox[{"GetAtomicScatteringFactors", ",", "\"\<f0Source\>\""}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<f1f2Source\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\[IndentingNewLine]", 
        RowBox[{"GetAtomicScatteringFactors", ",", "\"\<f1f2Source\>\""}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Options", " ", 
        RowBox[{"from", " ", "'"}], 
        RowBox[{"GetElements", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\"\<IgnoreIonCharge\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\[IndentingNewLine]", 
        RowBox[{"GetElements", ",", "\"\<IgnoreIonCharge\>\""}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "StructureFactor"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7186504887317142`*^9, 3.7186505104123993`*^9}, {
   3.718650833844981*^9, 3.718650860266952*^9}, {3.719071620177432*^9, 
   3.719071653263418*^9}, {3.7238803711167517`*^9, 3.7238803796417437`*^9}, {
   3.723880463384264*^9, 3.7238804927994747`*^9}, {3.724146049028111*^9, 
   3.7241461473154383`*^9}, {3.724147956329715*^9, 3.72414795872057*^9}, {
   3.724150271869894*^9, 3.724150297714615*^9}, {3.7246665076500187`*^9, 
   3.724666508113414*^9}, {3.725173720083654*^9, 3.7251737230739307`*^9}, {
   3.725173864767118*^9, 3.7251738659667597`*^9}, {3.7254483178322573`*^9, 
   3.725448342494196*^9}, {3.7256173921911087`*^9, 3.725617392898306*^9}, {
   3.726907438437258*^9, 3.7269074387588778`*^9}, 3.727244020896077*^9, {
   3.7303807654171133`*^9, 3.73038076676744*^9}, {3.737806839827971*^9, 
   3.737806866175991*^9}, {3.738649503972081*^9, 3.73864950513848*^9}, {
   3.739169640520637*^9, 3.7391696643680573`*^9}, {3.739184520182152*^9, 
   3.739184554187086*^9}, {3.739184633436884*^9, 3.73918463368222*^9}, {
   3.756717283807104*^9, 3.756717287324408*^9}, {3.756717318768586*^9, 
   3.75671732215915*^9}, {3.771141019982139*^9, 3.771141112037796*^9}},
 CellLabel->
  "In[879]:=",ExpressionUUID->"d304a9bc-2afa-4aa7-8581-1684fc0b9ab3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[884]:=",ExpressionUUID->"dde55b4b-87dd-45a1-a2b1-2831b8b6a8ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureFactor", "[", "\[IndentingNewLine]", 
   RowBox[{
   "crystal_String", ",", "\[IndentingNewLine]", "hklInput_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "data", ",", "abs", ",", "ignoreExtinct", ",", "units", ",", "\[Delta]", 
      ",", "hkl", ",", "L0", ",", "L", ",", "\[Lambda]", ",", 
      "\[IndentingNewLine]", "zerotype", ",", "absence", ",", "l", ",", 
      "hklPos", ",", "j", ",", "\[IndentingNewLine]", "sgHM", ",", "H", ",", 
      "d", ",", "sl", ",", "fOptions", ",", "f", ",", "\[IndentingNewLine]", 
      "atomdata", ",", "r", ",", "operators", ",", "type", ",", 
      "\[IndentingNewLine]", "disp", ",", "U", ",", "R", ",", "T", ",", 
      "lattice", ",", "cvecs", ",", "occ", ",", "elements", ",", 
      "\[IndentingNewLine]", "siteSymMxyz", ",", "siteSymO", ",", 
      "\[IndentingNewLine]", "sf", ",", "SF", ",", "F", ",", "\[Phi]"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checking", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Crystal", " ", "and", " ", 
      RowBox[{"wavelength", "/", "energy"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"InputCheck", "[", 
        RowBox[{"\"\<ProcessWavelength\>\"", ",", "crystal", ",", "lambda"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"data", "=", 
       RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", " ", "settings"}], " ", "*)"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"abs", "=", 
      RowBox[{"OptionValue", "[", "\"\<AbsoluteValue\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"ignoreExtinct", "=", 
      RowBox[{"OptionValue", "[", "\"\<IgnoreSystematicAbsence\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"units", "=", 
      RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "\[Delta]"}]}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"StructureFactor", "::", "\"\<invalidsetting\>\""}], ",", 
          "\"\<\\\"Threshold\\\"\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "hklInput", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"L0", "=", 
      RowBox[{"Length", "@", "hkl"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Systematically", " ", "absent", " ", 
       "reflections", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "ignoreExtinct"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Check"}], " ", "for", " ", "systematic", " ",
          "absence"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"zerotype", "=", 
         RowBox[{"If", "[", 
          RowBox[{"abs", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{"units", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Quantity", "[", 
                RowBox[{"0", ",", "\"\<Degrees\>\""}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"absence", "=", 
         RowBox[{"SystematicAbsentQ", "[", 
          RowBox[{"crystal", ",", "hkl"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"l", "=", 
         RowBox[{"Length", "@", "absence"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"hkl", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"hkl", ",", "absence", ",", "False"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"hklPos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"absence", ",", "False"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Return", " ", "if", " ", "only", " ", "extinct", " ", 
          "reflections"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "absence"}], ",", "TrueQ"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"l", "===", "1"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Return", "@", "zerotype"}], ",", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"Return", "@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"zerotype", ",", "l"}], "]"}]}]}], 
           "\[IndentingNewLine]", "\t", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Keep"}], " ", "list", " ", "as", " ", "is"}],
         " ", "*)"}], "\[IndentingNewLine]", "\t", "Null"}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Useful", " ", "variables", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Miscellaneous", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "hkl"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sgHM", "=", 
      RowBox[{"GetSymmetryData", "[", 
       RowBox[{
        RowBox[{
        "data", "\[LeftDoubleBracket]", "\"\<SpaceGroup\>\"", 
         "\[RightDoubleBracket]"}], ",", "\"\<HermannMauguinFull\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", 
         RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"#", ".", "H", ".", "#"}], "]"}], "/", "2"}], "]"}], "&"}],
        "/@", "hkl"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Obtaining", " ", "atomic", " ", "scattering", " ", "factors"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"fOptions", "=", 
      RowBox[{"Keys", "@", 
       RowBox[{"Options", "@", "GetAtomicScatteringFactors"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"fOptions", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"fOptions", ",", "\"\<SeparateCorrections\>\""}], "]"}]}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"fOptions", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
       "fOptions"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"f", "=", 
      RowBox[{"GetAtomicScatteringFactors", "[", 
       RowBox[{"crystal", ",", "hkl", ",", "\[Lambda]", ",", 
        RowBox[{"Sequence", "@@", "fOptions"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Wrap", " ", "'"}], 
       RowBox[{"f", "'"}], " ", "if", " ", "single", " ", "reflection", " ", 
       "input"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "f"}], ",", 
       RowBox[{"f", "=", 
        RowBox[{"{", "f", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"atomdata", "=", 
      RowBox[{"data", "[", "\"\<AtomData\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"r", "=", 
      RowBox[{"atomdata", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "\"\<FractionalCoordinates\>\""}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Variables", " ", "related", " ", "to", " ", "displacement", " ", 
       "parameters"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"d", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Sqrt", "@", 
         RowBox[{"DiagonalMatrix", "@", 
          RowBox[{"Diagonal", "@", "H"}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"disp", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"atomdata", ",", "\"\<DisplacementParameters\>\"", ",", "0."}],
        "]"}]}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Atomic", " ", "displacement", " ", "parameters", " ", "preparation"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"U", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{
           "disp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "\[Equal]", "6"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"U", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{
               "disp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "4", ",", "5", ",", "4", ",", "2", ",", "6", ",", 
                 "5", ",", "6", ",", "3"}], "}"}]}], "]"}], ",", "3"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"U", ",", 
           RowBox[{
           "disp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "]"}]}], "\[IndentingNewLine]", "\t", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "disp"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Symmetry", " ", "operators"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"operators", "=", 
      RowBox[{"GetSymmetryOperations", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "T"}], "}"}], "=", 
      RowBox[{"Transpose", "@", "operators"}]}], ";", "\[IndentingNewLine]", 
     "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"elements", "=", 
      RowBox[{"atomdata", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "\"\<Element\>\""}], "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Remove", " ", 
        RowBox[{"charge", "/", "ions"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IgnoreIonCharge\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"elements", "=", 
        RowBox[{"StringDelete", "[", 
         RowBox[{"elements", ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
           "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "\t\t", "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "if", " ", "elements", " ", 
       RowBox[{"don", "'"}], "t", " ", 
       RowBox[{"match", " ", "'"}], 
       RowBox[{"f", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Keys", "@", 
          RowBox[{"First", "@", "f"}]}]}], "=!=", 
        RowBox[{"Sort", "@", 
         RowBox[{"DeleteDuplicates", "@", "elements"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"StructureFactor", "::", "mismatch"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"type", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"atomdata", ",", "\"\<Type\>\"", ",", "\"\<Uiso\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Centring", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     
     RowBox[{"lattice", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"sgHM", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"cvecs", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"InputCheck", "[", 
        RowBox[{"\"\<GetCentringVectors\>\"", ",", "lattice"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Site", " ", "symmetry", " ", "multiplicity", " ", "and", " ", 
       "order"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Site", " ", "multiplicity", " ", "of", " ", "general", " ", 
       "position"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"siteSymMxyz", "=", 
      RowBox[{"cvecs", "*", 
       RowBox[{"Length", "@", "operators"}]}]}], ";", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Site", " ", "symmetry", " ", 
        RowBox[{"order", ":", " ", "siteSymO"}]}], " ", "=", " ", 
       RowBox[{"siteSymMxyz", " ", "/", " ", "siteSymM"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", 
         RowBox[{"Extract", " ", "'"}]}], 
        RowBox[{"SiteSymmetryOrder", "'"}], " ", "from", " ", 
        "$CrystalData"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"First", "@", "atomdata"}], ",", 
         "\"\<SiteSymmetryOrder\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"siteSymO", "=", 
        RowBox[{"atomdata", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "\"\<SiteSymmetryOrder\>\""}], 
         "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Calculate"}], " ", "order", " ", 
         RowBox[{"from", " ", "'"}], 
         RowBox[{"SiteSymmetryMultiplicity", "'"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"First", "@", "atomdata"}], ",", 
         "\"\<SiteSymmetryMultiplicity\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"siteSymO", "=", 
        RowBox[{"siteSymMxyz", "/", "\[IndentingNewLine]", "\t", 
         RowBox[{"atomdata", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "\"\<SiteSymmetryMultiplicity\>\""}], 
          "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"c", ".", " ", "Calculate"}], " ", "site", " ", "symmetry", 
         " ", "order"}], " ", "*)"}], "\[IndentingNewLine]", "\t", "True", 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"siteSymO", "=", 
        RowBox[{"siteSymMxyz", "/", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "@", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"crystal", ",", 
              RowBox[{
              "r", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"Length", "@", "r"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Occupation", " ", "factor"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<OccupationFactor\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"occ", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"atomdata", ",", "\"\<OccupationFactor\>\"", ",", "1."}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Structure", " ", "factor", " ", 
       "calculation", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Magnitude", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"sf", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"(*", " ", 
        RowBox[{"Table", " ", "for", " ", "each", " ", "reflection"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"1", "\[IndentingNewLine]", "\t", "*", 
           RowBox[{
           "occ", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           RowBox[{"(*", " ", 
            RowBox[{"Occupation", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "*", "cvecs", 
           RowBox[{"(*", " ", 
            RowBox[{"Centring", " ", "vectors"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "*", 
           RowBox[{"1.0", "/", 
            RowBox[{
            "siteSymO", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"Symmetry", " ", "reduction"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "*", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{
             "f", "\[LeftDoubleBracket]", "h", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "elements", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}], "]"}], 
           RowBox[{"(*", " ", 
            RowBox[{"Atomic", " ", "form", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "*", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{"(*", " ", 
                RowBox[{"Atomic", " ", "displacement"}], " ", "*)"}], 
               "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "type", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "\[Equal]", "\"\<Uani\>\""}], 
                ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], 
                  SuperscriptBox["Pi", "2"], "*", 
                  RowBox[{
                   RowBox[{
                   "hkl", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}], ".", "d", ".", 
                   RowBox[{
                   "R", "\[LeftDoubleBracket]", "s", 
                    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", "\t\t", 
                   ".", 
                   RowBox[{
                   "U", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", "\t\t", 
                   ".", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    "R", "\[LeftDoubleBracket]", "s", 
                    "\[RightDoubleBracket]"}], "]"}], "\[IndentingNewLine]", 
                   "\t\t", ".", "d", ".", 
                   RowBox[{
                   "hkl", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                 "type", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "\[Equal]", "\"\<Uiso\>\""}], 
                ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "8"}], 
                  SuperscriptBox["Pi", "2"], "*", 
                  RowBox[{
                  "disp", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "*", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    "sl", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}], ")"}], "2"]}], "]"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                 "type", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "\[Equal]", "\"\<Bani\>\""}], 
                ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "4"}], "*", 
                  RowBox[{
                   RowBox[{
                   "hkl", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}], ".", "d", ".", 
                   RowBox[{
                   "R", "\[LeftDoubleBracket]", "s", 
                    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", "\t\t", 
                   ".", 
                   RowBox[{
                   "U", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "\[IndentingNewLine]", "\t\t", 
                   ".", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    "R", "\[LeftDoubleBracket]", "s", 
                    "\[RightDoubleBracket]"}], "]"}], "\[IndentingNewLine]", 
                   "\t\t", ".", "d", ".", 
                   RowBox[{
                   "hkl", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                 "type", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "\[Equal]", "\"\<Biso\>\""}], 
                ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"Temperature", " ", "factor"}], " ", "*)"}], 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                   "disp", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "*", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    "sl", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}], ")"}], "2"]}], "]"}], ",", 
                "\[IndentingNewLine]", "\t", "True", ",", 
                RowBox[{
                 RowBox[{"Message", "[", 
                  RowBox[{
                   RowBox[{"$CrystalData", "::", "type"}], ",", "type"}], 
                  "]"}], ";", 
                 RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t",
                "]"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"2", "Pi", "*", "I", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "hkl", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                   "R", "\[LeftDoubleBracket]", "s", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                   "r", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{
                   RowBox[{
                   "hkl", "\[LeftDoubleBracket]", "h", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                   "T", "\[LeftDoubleBracket]", "s", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"Length", "@", "R"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "atomdata"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"h", ",", "L"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Phase", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "abs"}], ",", 
       RowBox[{
        RowBox[{"SF", "=", "sf"}], ";", 
        RowBox[{"Goto", "[", "\"\<ComplexNumber\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"SF", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"F", "=", 
            RowBox[{
            "sf", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"a", ".", " ", "Check"}], " ", "threshold"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"Re", "@", "F"}]}], "<", "\[Delta]"}], ",", 
             RowBox[{"Sow", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{"b", ".", " ", "Calculate"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "\[Equal]", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "\[GreaterEqual]", "0"}]}], 
                ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{"F", "=", "0"}], ";", 
                 RowBox[{"\[Phi]", "=", "90"}]}], ",", "\[IndentingNewLine]", 
                "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "\[Equal]", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "<", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "sf", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "=", "0"}], ";", 
                 RowBox[{"\[Phi]", "=", 
                  RowBox[{"-", "90"}]}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "\[GreaterEqual]", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "\[Equal]", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", "90"}], ",", "\[IndentingNewLine]", 
                "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "<", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "\[Equal]", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", "180"}], ",", "\[IndentingNewLine]", 
                "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], ">", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], ">", "0"}]}], ",", "\t", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "F", "]"}], "/", 
                    RowBox[{"Re", "[", "F", "]"}]}], "]"}], "]"}], "/", 
                   "Degree"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], ">", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "<", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"-", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "F", "]"}], "/", 
                    RowBox[{"Re", "[", "F", "]"}]}], "]"}], "]"}], "/", 
                    "Degree"}], "]"}]}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "<", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], ">", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Pi", "-", 
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "F", "]"}], "/", 
                    RowBox[{"Re", "[", "F", "]"}]}], "]"}], "]"}]}], ")"}], 
                   "/", "Degree"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "<", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "<", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "F", "]"}], "/", 
                    RowBox[{"Re", "[", "F", "]"}]}], "]"}], "]"}], "-", 
                    "Pi"}], ")"}], "/", "Degree"}], "]"}]}]}], 
               "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]",
               "\t", 
              RowBox[{"Sow", "[", 
               RowBox[{"{", 
                RowBox[{"F", ",", "\[Phi]"}], "}"}], "]"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "output", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Processing", " ", "units"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"units", ",", 
       RowBox[{"SF", "=", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Quantity", "[", 
            RowBox[{"#", ",", "\"\<Degrees\>\""}], "]"}], "&"}], ",", "SF", 
          ",", 
          RowBox[{"{", 
           RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Organising", " ", "structure", " ", "factors"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Return"}], " ", "absolute", " ", "value", " ", 
       "and", " ", "phase"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"SF", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Abs", ",", "SF", ",", 
        RowBox[{"{", 
         RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"b", ".", " ", "Return"}], " ", "complex", " ", "number"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"Label", "[", "\"\<ComplexNumber\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Putting", " ", "back", " ", "extinct", " ", "reflections"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"L0", ">", "1"}], "&&", 
        RowBox[{"!", "ignoreExtinct"}]}], ",", 
       RowBox[{"SF", "=", 
        RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"zerotype", ",", "l"}], "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Thread", "[", 
           RowBox[{"hklPos", "\[Rule]", "SF"}], "]"}]}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"L0", "===", "1"}], ",", 
       RowBox[{"First", "@", "SF"}], ",", "SF"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.68235021035181*^9, {3.6823554070859623`*^9, 3.682355407653955*^9}, {
   3.682355524419012*^9, 3.682355549058449*^9}, {3.6823559134372807`*^9, 
   3.682356009697699*^9}, {3.682356055121172*^9, 3.682356070174657*^9}, {
   3.682356114759941*^9, 3.682356146109274*^9}, {3.6823561846870003`*^9, 
   3.682356185652179*^9}, {3.682357088441045*^9, 3.682357115407319*^9}, {
   3.682357217406158*^9, 3.6823572183887863`*^9}, {3.6823574922248783`*^9, 
   3.682357553533513*^9}, {3.6823576090602837`*^9, 3.6823576183235407`*^9}, 
   3.68235766925104*^9, {3.682357741160877*^9, 3.682357843894844*^9}, {
   3.682358010140523*^9, 3.6823580520101*^9}, {3.682358086130682*^9, 
   3.682358102765896*^9}, 3.6823582603329163`*^9, 3.6823583250867977`*^9, {
   3.6823583641011267`*^9, 3.682358366674511*^9}, 3.6823584135236263`*^9, {
   3.6823585146473923`*^9, 3.682358560902493*^9}, {3.682358896111889*^9, 
   3.682358919406041*^9}, {3.682359169393344*^9, 3.682359193791843*^9}, {
   3.682359621431341*^9, 3.682359650654871*^9}, {3.682359721501602*^9, 
   3.682359739977715*^9}, {3.682359770331414*^9, 3.682359801225906*^9}, {
   3.682359954534068*^9, 3.682359994741144*^9}, 3.682360035622307*^9, {
   3.682360094717492*^9, 3.682360096227025*^9}, {3.682360593992386*^9, 
   3.682360642439151*^9}, {3.682360697895648*^9, 3.682360723116581*^9}, {
   3.682360759580455*^9, 3.6823608376656218`*^9}, {3.68236087692924*^9, 
   3.682360906264741*^9}, {3.682360980088883*^9, 3.68236098204853*^9}, 
   3.682361022206366*^9, {3.68236117119483*^9, 3.68236124324862*^9}, {
   3.6823613327685347`*^9, 3.682361342998777*^9}, {3.682362037112319*^9, 
   3.6823621240535173`*^9}, {3.682362292506065*^9, 3.6823623050569687`*^9}, {
   3.6823623617369537`*^9, 3.682362430592595*^9}, {3.682362474877223*^9, 
   3.6823624930618887`*^9}, {3.682362531443944*^9, 3.682362642281513*^9}, {
   3.682362672297182*^9, 3.6823627144868517`*^9}, {3.6823628461017427`*^9, 
   3.682362858611738*^9}, {3.682363215924656*^9, 3.682363219444872*^9}, {
   3.6824119473472843`*^9, 3.682411971197215*^9}, {3.682412042218315*^9, 
   3.682412072484001*^9}, {3.6824121240286503`*^9, 3.68241212793725*^9}, {
   3.682413245227405*^9, 3.682413345524603*^9}, {3.6824133869221287`*^9, 
   3.6824134491915197`*^9}, {3.682413745889159*^9, 3.682413760903536*^9}, {
   3.682413862079846*^9, 3.682413954924138*^9}, {3.682414025061961*^9, 
   3.682414115022747*^9}, 3.682414167870982*^9, {3.6824142584617968`*^9, 
   3.6824142703546247`*^9}, {3.682414389750587*^9, 3.682414435535961*^9}, 
   3.682414480952491*^9, 3.682414574850103*^9, {3.682414605378304*^9, 
   3.6824146058413057`*^9}, {3.682428125837381*^9, 3.682428147707459*^9}, {
   3.6824282090186234`*^9, 3.6824282643929358`*^9}, {3.6824287210409727`*^9, 
   3.682428724735961*^9}, {3.6824288917113657`*^9, 3.6824289135955276`*^9}, {
   3.6824289628129463`*^9, 3.6824290142821817`*^9}, {3.682429213286439*^9, 
   3.682429263700617*^9}, {3.6824298109288588`*^9, 3.6824298165448837`*^9}, 
   3.682429903488199*^9, {3.682429948647789*^9, 3.682429951686625*^9}, {
   3.682484251361381*^9, 3.682484254055951*^9}, {3.682484339504552*^9, 
   3.682484346319045*^9}, {3.682484444142501*^9, 3.682484464726788*^9}, {
   3.682484533445196*^9, 3.6824845395306664`*^9}, {3.68248495192418*^9, 
   3.682484984994215*^9}, {3.682485034932179*^9, 3.682485039536675*^9}, {
   3.682485072738564*^9, 3.682485128607079*^9}, {3.682485162046349*^9, 
   3.682485184174527*^9}, 3.68248528949996*^9, {3.682485335322666*^9, 
   3.682485341594153*^9}, {3.682485440834176*^9, 3.68248547227719*^9}, {
   3.682485503250204*^9, 3.682485519345251*^9}, {3.68248611217078*^9, 
   3.68248612407618*^9}, {3.682486191082102*^9, 3.682486205960585*^9}, {
   3.6824868938343887`*^9, 3.682486948103623*^9}, {3.682486987606151*^9, 
   3.68248702309336*^9}, {3.682487080956669*^9, 3.6824871561629333`*^9}, {
   3.682487294730164*^9, 3.682487357158196*^9}, {3.682487389183364*^9, 
   3.682487545816203*^9}, {3.682487583067555*^9, 3.682487612025353*^9}, {
   3.682487644559989*^9, 3.6824876659599133`*^9}, {3.682487805773508*^9, 
   3.682487839939349*^9}, {3.682487870706712*^9, 3.682487979200822*^9}, {
   3.682488013752686*^9, 3.6824880161807623`*^9}, {3.682488270701757*^9, 
   3.6824883620619173`*^9}, {3.6824883990164633`*^9, 3.682488454205749*^9}, {
   3.6824885540999527`*^9, 3.682488565716568*^9}, 3.6824886385539417`*^9, {
   3.68248877476259*^9, 3.68248884726932*^9}, {3.6824889603470716`*^9, 
   3.682489112047206*^9}, {3.682489497857304*^9, 3.682489502943169*^9}, {
   3.682489644092379*^9, 3.682489705833146*^9}, {3.682489832316371*^9, 
   3.682489904553688*^9}, {3.682489959763069*^9, 3.682489961114745*^9}, {
   3.682490364250053*^9, 3.682490368303422*^9}, {3.682492269390111*^9, 
   3.68249227029191*^9}, 3.682492350477738*^9, {3.682492417450835*^9, 
   3.6824924185204363`*^9}, {3.682492455264069*^9, 3.682492470994844*^9}, {
   3.682497385475168*^9, 3.682497405552649*^9}, {3.6824974690732803`*^9, 
   3.6824974699685583`*^9}, {3.682497582542081*^9, 3.682497607428425*^9}, {
   3.6824977498992643`*^9, 3.682497824540435*^9}, {3.682498611628029*^9, 
   3.682498653894286*^9}, {3.682498694599101*^9, 3.682498904660245*^9}, {
   3.68249895176313*^9, 3.6824989619051437`*^9}, {3.682498998603953*^9, 
   3.682499110847574*^9}, {3.682499146079774*^9, 3.6824995046786633`*^9}, {
   3.682499568669202*^9, 3.6824996599651814`*^9}, {3.6825007687644787`*^9, 
   3.682500769314032*^9}, {3.682500887551874*^9, 3.68250096329532*^9}, {
   3.68267724942268*^9, 3.6826772714823112`*^9}, {3.682677483806719*^9, 
   3.682677508083475*^9}, {3.682677614132016*^9, 3.68267766183434*^9}, {
   3.6826777652997847`*^9, 3.6826778130495443`*^9}, {3.682677854747525*^9, 
   3.682677919196094*^9}, {3.682678009905512*^9, 3.68267802035*^9}, 
   3.682681815204053*^9, 3.682742937261579*^9, {3.683603474603673*^9, 
   3.683603498242755*^9}, {3.6836035321491623`*^9, 3.683603532584096*^9}, {
   3.683603923115225*^9, 3.6836039487002163`*^9}, {3.683604007305277*^9, 
   3.683604046313713*^9}, {3.6840603536190157`*^9, 3.684060353915416*^9}, {
   3.6840604628970165`*^9, 3.6840604631154165`*^9}, 3.684126669883862*^9, {
   3.684126842291597*^9, 3.684126927064343*^9}, {3.684129595742449*^9, 
   3.684129617686654*^9}, {3.684129942198956*^9, 3.684129952360091*^9}, {
   3.684130057402573*^9, 3.684130074934708*^9}, {3.684132290063151*^9, 
   3.68413229155823*^9}, {3.6841323224690523`*^9, 3.6841323325558233`*^9}, {
   3.684132377119636*^9, 3.684132461548952*^9}, {3.684132549727417*^9, 
   3.684132556509632*^9}, {3.6841352955964603`*^9, 3.684135296501561*^9}, {
   3.684135427610285*^9, 3.6841354644426413`*^9}, {3.684135499863474*^9, 
   3.6841355772664137`*^9}, {3.684135631694504*^9, 3.684135776024764*^9}, {
   3.6841358249719543`*^9, 3.684135864110319*^9}, {3.684136093200944*^9, 
   3.6841361942922707`*^9}, 3.684138667592083*^9, {3.6842127906103487`*^9, 
   3.684212809772808*^9}, {3.684233496915926*^9, 3.684233501578506*^9}, {
   3.684233577438147*^9, 3.684233581499976*^9}, {3.6842336434194613`*^9, 
   3.684233723759993*^9}, 3.684235428108548*^9, {3.68449189948267*^9, 
   3.684491927666718*^9}, {3.684492216996893*^9, 3.6844922245206547`*^9}, {
   3.6844923574289637`*^9, 3.684492357507423*^9}, {3.685083388121538*^9, 
   3.6850833971122723`*^9}, {3.685245875512651*^9, 3.685245891304591*^9}, {
   3.685268980744462*^9, 3.6852689848592577`*^9}, {3.685269200031828*^9, 
   3.685269235615137*^9}, {3.685269330744046*^9, 3.685269340959529*^9}, {
   3.685269540547988*^9, 3.6852695467179737`*^9}, {3.6852695917983227`*^9, 
   3.685269860087473*^9}, {3.6852699071063232`*^9, 3.685269919626947*^9}, {
   3.6852700164430637`*^9, 3.6852700176511097`*^9}, {3.685270069705021*^9, 
   3.6852701123512917`*^9}, {3.685270274799631*^9, 3.685270278303849*^9}, {
   3.685270524895504*^9, 3.685270525113432*^9}, {3.685271210000054*^9, 
   3.685271213479288*^9}, {3.685271253270619*^9, 3.685271259453857*^9}, {
   3.685271320474208*^9, 3.685271330238566*^9}, {3.685271494959454*^9, 
   3.685271508193318*^9}, {3.6854192725223494`*^9, 3.6854193120892353`*^9}, {
   3.685419436607959*^9, 3.685419460022567*^9}, {3.6854195292524*^9, 
   3.685419535365223*^9}, {3.6856997810572433`*^9, 3.685699801401469*^9}, {
   3.685699852782089*^9, 3.68569986979154*^9}, {3.685699939741787*^9, 
   3.685699974508688*^9}, {3.685700022704438*^9, 3.6857000279545*^9}, {
   3.685700079266445*^9, 3.6857000793941193`*^9}, {3.685700490090118*^9, 
   3.685700522976573*^9}, {3.685700557380581*^9, 3.685700586180781*^9}, 
   3.685700790084831*^9, 3.685765929542613*^9, {3.6865358520581503`*^9, 
   3.686535924995319*^9}, {3.686535956470832*^9, 3.686535958044951*^9}, {
   3.686536001142067*^9, 3.686536008557165*^9}, {3.68653605329885*^9, 
   3.686536114697093*^9}, {3.6865361857271757`*^9, 3.6865362091598787`*^9}, {
   3.6865362441294622`*^9, 3.6865363020134687`*^9}, {3.686536356496814*^9, 
   3.686536395066627*^9}, {3.686536496974524*^9, 3.686536497870997*^9}, {
   3.6865365296306458`*^9, 3.686536543648244*^9}, {3.686536581297986*^9, 
   3.686536707378796*^9}, {3.686536787046989*^9, 3.686536944309525*^9}, {
   3.686536999230639*^9, 3.686537092649219*^9}, {3.686537350092806*^9, 
   3.686537385060277*^9}, {3.686537447065879*^9, 3.6865374674396753`*^9}, {
   3.686537602045158*^9, 3.686537811778129*^9}, {3.686538009664114*^9, 
   3.6865380111820374`*^9}, {3.686639039775693*^9, 3.686639060647485*^9}, {
   3.6866391382128267`*^9, 3.686639162265592*^9}, {3.6866392097794647`*^9, 
   3.68663921588174*^9}, {3.686639249133515*^9, 3.686639262259482*^9}, {
   3.6866393479134808`*^9, 3.6866393492506037`*^9}, {3.686639385739629*^9, 
   3.686639569572411*^9}, {3.6866396649341087`*^9, 3.686639708563305*^9}, {
   3.686639755978696*^9, 3.686639816039085*^9}, {3.686639850559414*^9, 
   3.686640024698845*^9}, {3.6866400993523912`*^9, 3.6866401602993402`*^9}, 
   3.686640288912417*^9, {3.686640398471506*^9, 3.686640616303235*^9}, {
   3.686640702384297*^9, 3.6866407141563168`*^9}, {3.6866414624930353`*^9, 
   3.686641464325823*^9}, {3.6866415662892857`*^9, 3.6866416851473*^9}, {
   3.686641795071535*^9, 3.686641829559442*^9}, {3.6866418730620737`*^9, 
   3.686641878091366*^9}, {3.686643455863309*^9, 3.686643466892089*^9}, {
   3.686643521106599*^9, 3.686643521547914*^9}, {3.6866440864294024`*^9, 
   3.6866441007596893`*^9}, 3.686645469125093*^9, {3.686645594918067*^9, 
   3.686645622694941*^9}, {3.6866463859427032`*^9, 3.6866465064197474`*^9}, {
   3.6866466900184107`*^9, 3.68664670832253*^9}, {3.68664673934373*^9, 
   3.6866470398395348`*^9}, {3.686647116437593*^9, 3.686647153211206*^9}, {
   3.686647195914625*^9, 3.686647309263627*^9}, 3.686647391456807*^9, {
   3.686647441847991*^9, 3.6866474744817743`*^9}, {3.686647510035316*^9, 
   3.686647512242793*^9}, {3.6866475954109488`*^9, 3.686647601952989*^9}, {
   3.686647675718945*^9, 3.6866477037105427`*^9}, {3.686647784299597*^9, 
   3.6866478112634907`*^9}, {3.686648394432047*^9, 3.6866484666379557`*^9}, {
   3.6866534327598658`*^9, 3.6866534399969673`*^9}, {3.686654085150263*^9, 
   3.686654215720572*^9}, {3.6866542960529213`*^9, 3.686654304123146*^9}, {
   3.68665448727005*^9, 3.686654501486758*^9}, {3.686654534112*^9, 
   3.686654570609671*^9}, {3.68665463546408*^9, 3.686654690258994*^9}, {
   3.687072762240677*^9, 3.6870727663856573`*^9}, {3.687072805954468*^9, 
   3.687072817021658*^9}, {3.687072847586732*^9, 3.6870728556852093`*^9}, {
   3.687073510113536*^9, 3.687073516420169*^9}, 3.687073558908938*^9, {
   3.690025779646481*^9, 3.690025802098175*^9}, {3.690878676179409*^9, 
   3.690878760347547*^9}, {3.690879030188471*^9, 3.690879056259705*^9}, {
   3.6908790878566303`*^9, 3.690879090410026*^9}, {3.690898596040187*^9, 
   3.690898626210072*^9}, {3.690900659333523*^9, 3.6909006864432783`*^9}, {
   3.6909008783741493`*^9, 3.6909009191407423`*^9}, {3.6909009572933493`*^9, 
   3.6909009582506323`*^9}, {3.690901005339761*^9, 3.690901216192507*^9}, {
   3.690974764117507*^9, 3.690974788841832*^9}, {3.690975370540357*^9, 
   3.6909753934428263`*^9}, 3.6909754366587133`*^9, {3.69097546880268*^9, 
   3.690975503534981*^9}, {3.6909777141486387`*^9, 3.690977818880795*^9}, {
   3.691126706363833*^9, 3.691126710172639*^9}, 3.6911268598638287`*^9, 
   3.691127163939904*^9, {3.6911277713007917`*^9, 3.6911277772595873`*^9}, {
   3.6911280137962523`*^9, 3.69112801626263*^9}, {3.69112809308037*^9, 
   3.691128147587358*^9}, {3.691144012452911*^9, 3.6911440460355*^9}, {
   3.6911441826017036`*^9, 3.691144195487897*^9}, 3.691144319648478*^9, {
   3.691144650403228*^9, 3.6911446554486*^9}, {3.6911446937913847`*^9, 
   3.691144731983123*^9}, {3.691144793473301*^9, 3.6911447948588867`*^9}, {
   3.69114522436063*^9, 3.691145280419627*^9}, {3.691147570557919*^9, 
   3.6911475707324657`*^9}, {3.691147623558091*^9, 3.691147639037039*^9}, {
   3.691147892444419*^9, 3.691147914367961*^9}, {3.6911479535020123`*^9, 
   3.6911479572053957`*^9}, {3.691155598871255*^9, 3.691155701315138*^9}, {
   3.691157634096757*^9, 3.691157639169035*^9}, {3.691159230710688*^9, 
   3.69115925016014*^9}, {3.6911593915751057`*^9, 3.691159422340479*^9}, {
   3.691159458909935*^9, 3.691159465795944*^9}, {3.691159530402904*^9, 
   3.691159544385497*^9}, {3.691159614584931*^9, 3.691159640968917*^9}, {
   3.691159675032302*^9, 3.6911596983581333`*^9}, {3.691159728646122*^9, 
   3.6911597467513857`*^9}, {3.691159822355818*^9, 3.691159823994444*^9}, 
   3.691159862908317*^9, {3.6911599138036137`*^9, 3.691159919672388*^9}, {
   3.691160353263249*^9, 3.691160375614052*^9}, {3.691160650048457*^9, 
   3.691160678581853*^9}, 3.691165154333824*^9, {3.691165203018216*^9, 
   3.6911653008314257`*^9}, {3.6911655589618797`*^9, 3.691165595582507*^9}, {
   3.691165631520339*^9, 3.6911657492211*^9}, 3.691165787587769*^9, {
   3.691165842434667*^9, 3.6911658431757174`*^9}, {3.691165875609087*^9, 
   3.691165875752102*^9}, {3.706329878752262*^9, 3.706329882460821*^9}, {
   3.706329931666987*^9, 3.70632997324356*^9}, {3.712555006792688*^9, 
   3.712555127255632*^9}, {3.7125576195745*^9, 3.712557630128243*^9}, {
   3.712557758847629*^9, 3.712557759148643*^9}, {3.7125578301475563`*^9, 
   3.712557832388919*^9}, {3.7125578638881493`*^9, 3.712557864068542*^9}, {
   3.712558110447866*^9, 3.712558118436214*^9}, {3.712558826611998*^9, 
   3.712558829610416*^9}, {3.712559993610076*^9, 3.712560018236985*^9}, {
   3.712560082025857*^9, 3.712560195326495*^9}, {3.714462684262381*^9, 
   3.714462716756855*^9}, {3.714710013035928*^9, 3.714710013245159*^9}, 
   3.714710203499085*^9, {3.714711456472847*^9, 3.714711459525902*^9}, {
   3.714711603633684*^9, 3.7147117131108713`*^9}, {3.7147118349390917`*^9, 
   3.7147118443756638`*^9}, {3.7147119053630857`*^9, 3.714711906857216*^9}, {
   3.717740896716333*^9, 3.717740919715315*^9}, 3.7179538850177402`*^9, {
   3.718527677646764*^9, 3.718527691020012*^9}, {3.718527785734352*^9, 
   3.718527871985846*^9}, {3.718527926536118*^9, 3.718527969630934*^9}, 
   3.718531173423358*^9, {3.718531232841338*^9, 3.718531256847206*^9}, {
   3.718533847618675*^9, 3.718533913808114*^9}, {3.718543512776991*^9, 
   3.718543521720064*^9}, {3.7185436324992123`*^9, 3.718543790156437*^9}, {
   3.718543821237425*^9, 3.718543975277853*^9}, {3.7185440221196127`*^9, 
   3.718544051871626*^9}, {3.718544109595942*^9, 3.718544203377638*^9}, {
   3.718544363461361*^9, 3.7185444688688717`*^9}, {3.7185446350043*^9, 
   3.7185447209089746`*^9}, {3.718624865299603*^9, 3.718624870542665*^9}, {
   3.718625967770801*^9, 3.718625978288886*^9}, {3.718626187395894*^9, 
   3.718626202667638*^9}, {3.7186300004551907`*^9, 3.718630046690415*^9}, {
   3.718633919196464*^9, 3.7186339551354723`*^9}, {3.7186340043345833`*^9, 
   3.718634106646303*^9}, {3.718634174587448*^9, 3.718634188715056*^9}, {
   3.718634224096203*^9, 3.718634358249167*^9}, {3.7186344156562243`*^9, 
   3.718634528525507*^9}, {3.718634615958276*^9, 3.71863466855867*^9}, {
   3.718634708217246*^9, 3.718634718184246*^9}, 3.718634796174251*^9, {
   3.718634831746257*^9, 3.7186348409138527`*^9}, {3.718635054467161*^9, 
   3.7186351502490177`*^9}, {3.718635333933066*^9, 3.718635468967456*^9}, {
   3.71863559690244*^9, 3.718635611456811*^9}, {3.718635861273704*^9, 
   3.7186359397615757`*^9}, {3.718636007553063*^9, 3.718636111943492*^9}, {
   3.718636143404682*^9, 3.718636148373069*^9}, {3.718636179277677*^9, 
   3.7186361804361277`*^9}, {3.718636273382629*^9, 3.718636278006249*^9}, {
   3.7186367395660257`*^9, 3.71863674534039*^9}, 3.718636784455512*^9, {
   3.7186368158684483`*^9, 3.718636844927195*^9}, {3.718636900365027*^9, 
   3.718636900634088*^9}, {3.718637483624073*^9, 3.718637515773211*^9}, {
   3.7186375867350693`*^9, 3.7186376848994503`*^9}, {3.7186377716613197`*^9, 
   3.718637834662388*^9}, {3.718637868699911*^9, 3.71863787807069*^9}, {
   3.718637909685691*^9, 3.7186379118664703`*^9}, {3.7186379825622263`*^9, 
   3.71863798441439*^9}, {3.718638501160863*^9, 3.718638582878704*^9}, {
   3.718638729150199*^9, 3.718638734334074*^9}, {3.7186387952057257`*^9, 
   3.718638849484035*^9}, {3.71863888679734*^9, 3.718638901885063*^9}, {
   3.7186393140579863`*^9, 3.718639337008689*^9}, {3.718639631689644*^9, 
   3.718639654798298*^9}, {3.718639901229538*^9, 3.718639935956284*^9}, {
   3.718640442276641*^9, 3.718640470155349*^9}, {3.7186405729607487`*^9, 
   3.718640573481882*^9}, {3.718640619781396*^9, 3.718640657069721*^9}, {
   3.718640752005581*^9, 3.718640755744193*^9}, {3.718640794318283*^9, 
   3.7186408336464787`*^9}, {3.7186409779009237`*^9, 
   3.7186410858105917`*^9}, {3.718641195390216*^9, 3.7186413868269377`*^9}, {
   3.7186414362032557`*^9, 3.718641455242989*^9}, {3.718641624918593*^9, 
   3.718641752821053*^9}, 3.718642019375333*^9, {3.718642085493113*^9, 
   3.718642117001196*^9}, {3.7186421540983353`*^9, 3.718642167577339*^9}, {
   3.718642255504282*^9, 3.71864225765915*^9}, {3.71864230334627*^9, 
   3.718642304834527*^9}, {3.718642356334309*^9, 3.718642403037221*^9}, 
   3.718642485747217*^9, {3.718643273001608*^9, 3.718643292257222*^9}, {
   3.718643338694646*^9, 3.718643340777215*^9}, 3.7186434167582693`*^9, 
   3.71864348557904*^9, {3.718643563362646*^9, 3.718643617814856*^9}, {
   3.718643788342004*^9, 3.718643887699991*^9}, 3.7186439199389467`*^9, {
   3.718643950505294*^9, 3.718644046400427*^9}, {3.718644817480879*^9, 
   3.718644836727697*^9}, 3.7186448928146057`*^9, {3.718644934389924*^9, 
   3.718644971436803*^9}, {3.718645012707621*^9, 3.718645051273069*^9}, {
   3.71864547989636*^9, 3.7186455993205137`*^9}, {3.718645642176772*^9, 
   3.718645642436988*^9}, {3.718650537705412*^9, 3.718650558713146*^9}, {
   3.718650764662345*^9, 3.7186507691931047`*^9}, {3.718650869075322*^9, 
   3.718650906249342*^9}, {3.7186509419131517`*^9, 3.7186511356198063`*^9}, {
   3.7186521820238943`*^9, 3.718652182806731*^9}, {3.7186536873155746`*^9, 
   3.7186537733243523`*^9}, {3.718654210672594*^9, 3.718654219091264*^9}, {
   3.7186545421532507`*^9, 3.718654594263721*^9}, {3.718654635306229*^9, 
   3.718654743331316*^9}, {3.718654792291512*^9, 3.7186548537632027`*^9}, {
   3.718654918842803*^9, 3.71865492006437*^9}, {3.718654994967835*^9, 
   3.718655076720158*^9}, {3.7186551916595*^9, 3.718655230122362*^9}, {
   3.718655267657659*^9, 3.718655295935725*^9}, {3.718696693742841*^9, 
   3.7186966962991734`*^9}, {3.718696887994276*^9, 3.718696888123917*^9}, 
   3.718697227272997*^9, {3.718697432605813*^9, 3.7186974356561937`*^9}, {
   3.718729172707295*^9, 3.718729173264016*^9}, 3.718980534558011*^9, 
   3.719063106966579*^9, {3.719083639537867*^9, 3.719083652615138*^9}, {
   3.719085045623962*^9, 3.719085054454421*^9}, {3.7198363110943737`*^9, 
   3.71983632499797*^9}, {3.7205133135044117`*^9, 3.7205133305445433`*^9}, {
   3.721029191915366*^9, 3.721029210654334*^9}, {3.724145596678763*^9, 
   3.724145665278071*^9}, {3.724145716052232*^9, 3.724145754560947*^9}, {
   3.7241457987595787`*^9, 3.724145808878604*^9}, {3.724146029544669*^9, 
   3.724146043385973*^9}, 3.724146177784893*^9, {3.7241462470878887`*^9, 
   3.7241462484617233`*^9}, {3.724149956284987*^9, 3.724150126674526*^9}, {
   3.724150241948049*^9, 3.724150251788508*^9}, {3.724150316124902*^9, 
   3.724150372508952*^9}, {3.7241504030697803`*^9, 3.724150422705534*^9}, {
   3.724150454761139*^9, 3.7241505509534693`*^9}, {3.724561396305125*^9, 
   3.7245614074142933`*^9}, {3.724561462950499*^9, 3.7245614685083637`*^9}, {
   3.724564716359003*^9, 3.7245647185257883`*^9}, {3.724564821737604*^9, 
   3.7245648349609003`*^9}, {3.724565007327551*^9, 3.724565048525113*^9}, {
   3.724565153339657*^9, 3.724565234033993*^9}, {3.724565285591118*^9, 
   3.724565291733634*^9}, {3.7245661698967247`*^9, 3.724566172491467*^9}, 
   3.724566213869773*^9, {3.724566285155117*^9, 3.7245662852866287`*^9}, 
   3.7245667371712027`*^9, {3.724566829065361*^9, 3.72456684581383*^9}, {
   3.724567754897757*^9, 3.724567755455063*^9}, {3.7246599646753674`*^9, 
   3.724659980266561*^9}, 3.7246602067243958`*^9, {3.724660380657509*^9, 
   3.724660380831779*^9}, {3.724660529975087*^9, 3.724660532246895*^9}, {
   3.7246606924748917`*^9, 3.724660692696698*^9}, {3.72466074515444*^9, 
   3.7246608507133493`*^9}, {3.724662172741002*^9, 3.7246621826189013`*^9}, {
   3.724664927225902*^9, 3.724664927355006*^9}, {3.724666740678011*^9, 
   3.7246667428391943`*^9}, {3.724666792196143*^9, 3.724666846319498*^9}, {
   3.724666925596292*^9, 3.7246669792437363`*^9}, {3.724667056539875*^9, 
   3.7246671524311733`*^9}, {3.7246672252443247`*^9, 3.724667304673367*^9}, {
   3.724667386650441*^9, 3.724667442348775*^9}, {3.724667476202106*^9, 
   3.724667476376495*^9}, {3.724667553628648*^9, 3.7246676140870657`*^9}, {
   3.724667648123928*^9, 3.724667658400072*^9}, {3.7246676952833548`*^9, 
   3.7246677045603952`*^9}, {3.724667777470542*^9, 3.7246677990469913`*^9}, {
   3.72466810007837*^9, 3.724668111950631*^9}, {3.7251737272906017`*^9, 
   3.7251737544247017`*^9}, {3.725173803673904*^9, 3.725173842893956*^9}, {
   3.7254484797431593`*^9, 3.725448493902485*^9}, {3.72544865519354*^9, 
   3.725448669537215*^9}, {3.725448729379508*^9, 3.72544875027493*^9}, {
   3.725449385771718*^9, 3.725449402761017*^9}, {3.7256153916179028`*^9, 
   3.725615415821506*^9}, {3.725615793658289*^9, 3.725615803225354*^9}, {
   3.725615924191431*^9, 3.725615928959609*^9}, {3.725616111095373*^9, 
   3.725616180249893*^9}, {3.725616238939508*^9, 3.72561624355674*^9}, {
   3.725616597859741*^9, 3.7256166302901917`*^9}, {3.725616698082979*^9, 
   3.725616720264295*^9}, {3.72561675735168*^9, 3.725616788826537*^9}, {
   3.725617156235186*^9, 3.725617212844368*^9}, {3.7256172509664288`*^9, 
   3.725617275440839*^9}, {3.725617343412187*^9, 3.7256174043866463`*^9}, {
   3.726470343029024*^9, 3.726470354794454*^9}, {3.726488984815798*^9, 
   3.7264889956705837`*^9}, 3.726505019837242*^9, {3.726505073088929*^9, 
   3.726505073253257*^9}, 3.726561564710672*^9, {3.726859417371212*^9, 
   3.726859418211994*^9}, {3.7268594505225*^9, 3.726859456882266*^9}, {
   3.726898188060453*^9, 3.726898191349244*^9}, {3.7268982742787848`*^9, 
   3.726898274512164*^9}, {3.726906121043355*^9, 3.726906164203*^9}, {
   3.726906245933783*^9, 3.726906253890044*^9}, {3.7269062845618477`*^9, 
   3.726906287749412*^9}, {3.726906384258444*^9, 3.726906384407981*^9}, {
   3.7269064225643873`*^9, 3.726906479191285*^9}, {3.726906511289557*^9, 
   3.726906573390658*^9}, {3.726906641720665*^9, 3.7269066502617292`*^9}, {
   3.726907060816388*^9, 3.726907060935128*^9}, {3.726907170176078*^9, 
   3.726907175143551*^9}, {3.726907233159137*^9, 3.72690729131479*^9}, {
   3.726907414626561*^9, 3.726907490687174*^9}, 3.726907553753632*^9, {
   3.726907595838131*^9, 3.7269077819136543`*^9}, {3.726907856045974*^9, 
   3.726907887744969*^9}, {3.726908115416163*^9, 3.726908159121975*^9}, {
   3.72690821376005*^9, 3.7269082286738234`*^9}, {3.726908379256392*^9, 
   3.726908420098743*^9}, {3.726908458536557*^9, 3.726908490530883*^9}, {
   3.726908640594524*^9, 3.726908641942788*^9}, {3.726908679072648*^9, 
   3.726908700410343*^9}, {3.726908834480789*^9, 3.726908855775869*^9}, {
   3.726908990038205*^9, 3.726909009666183*^9}, {3.726909280590005*^9, 
   3.726909456449881*^9}, {3.726909497736565*^9, 3.7269095024249363`*^9}, {
   3.726909704084219*^9, 3.726909722436139*^9}, {3.7269100986810093`*^9, 
   3.726910098953269*^9}, {3.7269102807815933`*^9, 3.726910282602582*^9}, {
   3.7269103203256207`*^9, 3.726910320447009*^9}, {3.726910849369268*^9, 
   3.726910852647759*^9}, {3.726910911233726*^9, 3.726910921874176*^9}, 
   3.726911041337955*^9, {3.7269111967711287`*^9, 3.726911214304221*^9}, {
   3.727158576396359*^9, 3.7271585773463593`*^9}, {3.7271586690500107`*^9, 
   3.727158705202383*^9}, 3.7271587527614393`*^9, {3.727158786160768*^9, 
   3.727158786358838*^9}, {3.7271588173530893`*^9, 3.727158817558272*^9}, {
   3.7271591290315933`*^9, 3.7271591527508993`*^9}, {3.727159658108057*^9, 
   3.727159665553772*^9}, {3.727159724290596*^9, 3.727159727241869*^9}, {
   3.727159818392055*^9, 3.72715982167978*^9}, {3.727159882888464*^9, 
   3.727160002094442*^9}, {3.727160217166821*^9, 3.727160226301404*^9}, {
   3.7271629721608343`*^9, 3.72716297458897*^9}, {3.727163088029752*^9, 
   3.7271631820820713`*^9}, {3.727163282161408*^9, 3.727163305401881*^9}, {
   3.727163384932481*^9, 3.7271633954768343`*^9}, {3.727189928903273*^9, 
   3.727189932748803*^9}, {3.7271899868128433`*^9, 3.7271900150142393`*^9}, 
   3.7271900520660963`*^9, 3.7272440209161787`*^9, 3.7276752890194387`*^9, 
   3.727676624853285*^9, 3.727676784261179*^9, 3.7300971411738863`*^9, {
   3.73036627987351*^9, 3.730366282672369*^9}, {3.730366412962906*^9, 
   3.730366442510378*^9}, 3.730366508313837*^9, 3.730366582786269*^9, 
   3.730366625930894*^9, {3.730367787307919*^9, 3.730367811199376*^9}, {
   3.730367842739057*^9, 3.730367845788413*^9}, 3.730367896970634*^9, 
   3.730368028710956*^9, 3.730368343205833*^9, 3.730368388949328*^9, {
   3.730368622748129*^9, 3.730368769962433*^9}, {3.730368804494926*^9, 
   3.7303688066872063`*^9}, {3.730368859719089*^9, 3.730368861259066*^9}, {
   3.730368892630349*^9, 3.730368892874979*^9}, {3.7303746119665833`*^9, 
   3.730374612060484*^9}, {3.730374663683868*^9, 3.730374729814693*^9}, {
   3.730374782631168*^9, 3.73037478495109*^9}, {3.730374853841782*^9, 
   3.730374854789981*^9}, {3.730374917246572*^9, 3.730374924781241*^9}, {
   3.730374958522914*^9, 3.73037498874479*^9}, {3.730375027846882*^9, 
   3.7303750428413067`*^9}, {3.730375942014379*^9, 3.730376019987307*^9}, {
   3.7303760500387287`*^9, 3.730376050980377*^9}, {3.730376084988002*^9, 
   3.730376099444498*^9}, {3.73037617781859*^9, 3.730376196168026*^9}, {
   3.73037623941689*^9, 3.7303763277846947`*^9}, 3.730376375352146*^9, {
   3.730376448387857*^9, 3.730376491667026*^9}, {3.730376530931423*^9, 
   3.730376566801742*^9}, {3.730376685878744*^9, 3.730376718608508*^9}, {
   3.7303774254052143`*^9, 3.730377425923779*^9}, {3.7303872514850407`*^9, 
   3.730387275452536*^9}, {3.730398135670518*^9, 3.730398153697288*^9}, {
   3.730544556973566*^9, 3.730544565333839*^9}, {3.7331706929503317`*^9, 
   3.7331706965380173`*^9}, {3.735032469440843*^9, 3.735032484729834*^9}, {
   3.735032517859907*^9, 3.735032601394354*^9}, {3.7350326346892223`*^9, 
   3.735032635034664*^9}, {3.735033496785925*^9, 3.7350335281258993`*^9}, {
   3.7350335603081903`*^9, 3.735033663437683*^9}, {3.735033904013899*^9, 
   3.7350339075891523`*^9}, {3.735033984637506*^9, 3.735034093197612*^9}, {
   3.73503413980792*^9, 3.735034140092969*^9}, {3.737806352728956*^9, 
   3.737806367811644*^9}, {3.737806433894595*^9, 3.737806435967967*^9}, {
   3.737806476532917*^9, 3.737806574063101*^9}, {3.7378067551073437`*^9, 
   3.737806828981542*^9}, 3.737806878644868*^9, {3.737968444470468*^9, 
   3.737968468464669*^9}, 3.737968545067499*^9, 3.737968575390418*^9, {
   3.739029626888796*^9, 3.739029633847821*^9}, {3.739030429186804*^9, 
   3.739030431008545*^9}, {3.7391695345754766`*^9, 3.739169536334717*^9}, {
   3.739169727221682*^9, 3.739169737715694*^9}, {3.7391698678374557`*^9, 
   3.739169951171378*^9}, {3.7391702356395273`*^9, 3.739170236908888*^9}, 
   3.739170291692564*^9, {3.739184573008953*^9, 3.739184596252761*^9}, {
   3.739187730290718*^9, 3.7391877776088867`*^9}, {3.73921225861617*^9, 
   3.739212281452911*^9}, {3.7392123593828087`*^9, 3.7392124850476933`*^9}, 
   3.7392125327555513`*^9, {3.739212659381495*^9, 3.739212661404315*^9}, 
   3.7392128537150297`*^9, {3.7438658514596167`*^9, 3.743865851515725*^9}, {
   3.758530190309626*^9, 3.758530364608316*^9}, {3.759520395991775*^9, 
   3.759520396244904*^9}, 3.7627930940292997`*^9, {3.786968103497732*^9, 
   3.786968104775231*^9}, {3.78696816396778*^9, 3.78696816649361*^9}, {
   3.786968627627324*^9, 3.786968628793837*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[885]:=",ExpressionUUID->"2b5baeab-c31b-4449-b2bd-20c9351f4d22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[886]:=",ExpressionUUID->"7283590c-9db9-4b75-921e-e4eb1c9698e3"]
}, Closed]],

Cell[CellGroupData[{

Cell["StructureFactorTable", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.6681055844957*^9, {3.66810585066947*^9, 3.668105858356221*^9}, 
   3.682827196585244*^9, 
   3.6844879863598137`*^9},ExpressionUUID->"d5814520-4e20-4aba-b31d-\
c0755ea35357"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[887]:=",ExpressionUUID->"d3b33f4a-9583-4ed4-bcdf-c39f22a033fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StructureFactorTable", "::", "invcustom"}], "=", 
   "\"\<Invalid setting for the \[LeftGuillemet]CustomReflections\
\[RightGuillemet] option.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StructureFactorTable", "::", "sort"}], "=", 
    "\"\<Invalid \[LeftGuillemet]Sort\[RightGuillemet] option.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "StructureFactorTable", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "DarwinWidth", " ", "and", " ", "ExtinctionLength", " ", "options"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "\"\<\[Pi]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"StructureFactor", " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Threshold\>\"", "\[Rule]", 
       RowBox[{"Power", "[", 
        RowBox[{"10.", ",", 
         RowBox[{"-", "6"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"ReflectionList", " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<SplitEquivalent\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<CustomReflections\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ReflectionListKeep\>\"", "\[Rule]", "50"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"StructureFactorTable", " ", "options"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Keep\>\"", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"\"\<Sort\>\"", "\[Rule]", 
       RowBox[{"-", "2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<TitleStyle\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Baskerville\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "15"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<SubtitleStyle\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "13"}], ",", "Gray"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<NumberStyle\>\"", "\[Rule]", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Background", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "None", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", 
           RowBox[{"{", 
            RowBox[{"None", ",", "LightGray"}], "}"}]}], "}"}]}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Dividers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"None", ",", 
           RowBox[{"{", "True", "}"}], ",", "None"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None", ",", "True"}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "StructureFactorTable"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.668105730347047*^9, {3.6681057635034733`*^9, 
   3.668105770743743*^9}, {3.668105863188552*^9, 3.6681058655778723`*^9}, {
   3.668194174710959*^9, 3.668194200997211*^9}, {3.679749057336968*^9, 
   3.679749065727788*^9}, {3.6797491392317333`*^9, 3.679749188325144*^9}, {
   3.679749469999255*^9, 3.679749477094261*^9}, {3.679752707933913*^9, 
   3.679752720990613*^9}, {3.679755885846201*^9, 3.679755887076858*^9}, {
   3.6797559482689734`*^9, 3.679755950347142*^9}, {3.681633881405313*^9, 
   3.681633882428932*^9}, {3.681633921173172*^9, 3.681634041501145*^9}, {
   3.681634191462041*^9, 3.681634194092729*^9}, {3.681634316204688*^9, 
   3.6816343331267242`*^9}, {3.681634485786175*^9, 3.681634488746072*^9}, {
   3.685266410723361*^9, 3.685266411087372*^9}, {3.685419621265628*^9, 
   3.685419621340851*^9}, {3.68542135881497*^9, 3.68542136123435*^9}, {
   3.685421972498349*^9, 3.685421973457191*^9}, {3.6854220084304543`*^9, 
   3.685422008728126*^9}, {3.6857080176285677`*^9, 3.685708046018064*^9}, {
   3.685777331857526*^9, 3.685777354965396*^9}, {3.685779053854518*^9, 
   3.68577905613339*^9}, {3.685779091629904*^9, 3.685779103410666*^9}, {
   3.685779834029439*^9, 3.685779834082477*^9}, {3.686534688749203*^9, 
   3.6865346889520035`*^9}, {3.7303848395375853`*^9, 
   3.7303848578650017`*^9}, {3.7303852705109243`*^9, 3.730385288030526*^9}, 
   3.730385333695622*^9, {3.730385382941999*^9, 3.730385452826951*^9}, {
   3.7303855440435553`*^9, 3.730385550850548*^9}, {3.756717554120699*^9, 
   3.756717568915251*^9}},
 CellLabel->
  "In[888]:=",ExpressionUUID->"20b9832e-ba69-49db-b982-617401ce44f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[892]:=",ExpressionUUID->"aaa921d7-04ea-4b1e-83f2-fd0b2e134a65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureFactorTable", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    "condition___Condition", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\[Lambda]", ",", "hkl", ",", "H", ",", "sl", ",", "bragg", ",", 
      "\[IndentingNewLine]", "column1", ",", "column2", ",", "column3", ",", 
      "column4", ",", "column5", ",", "column6", ",", "\[IndentingNewLine]", 
      "V", ",", "\[IndentingNewLine]", "zeros", ",", "\[IndentingNewLine]", 
      "R", ",", "\[Theta]", ",", "Fh", ",", "FhBar", ",", "\[CapitalLambda]o",
       ",", "\[Delta]os", ",", "\[IndentingNewLine]", "temp", ",", "temp1", 
      ",", "temp2", ",", "temp3", ",", "temp4", ",", "temp5", ",", "temp6", 
      ",", "\[IndentingNewLine]", "sort", ",", "keep", ",", "polarisation", 
      ",", "threshold"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Preparations", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "wavelength"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<ProcessWavelength\>\"", ",", "crystal", ",", "lambda"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "list", " ", "of", " ", "reflections"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"ReflectionList", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
         "crystal", ",", "\[Lambda]", ",", "condition", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<SplitEquivalent\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<SplitEquivalent\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<CustomReflections\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<CustomReflections\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Keep\>\"", "\[Rule]", 
           RowBox[{
           "OptionValue", "[", "\"\<ReflectionListKeep\>\"", "]"}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", 
         RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Using", " ", "inner", " ", "product", " ", "and", " ", 
       RowBox[{"Bragg", "'"}], "s", " ", "law"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"sl", "[", "h_", "]"}], ":=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"h", ".", "H", ".", "h"}], "]"}], "/", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"bragg", "[", "h_", "]"}], ":=", 
      RowBox[{"N", "[", 
       RowBox[{"ArcSin", "[", 
        RowBox[{
         RowBox[{"sl", "[", "h", "]"}], "*", 
         RowBox[{"QuantityMagnitude", "@", "\[Lambda]"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Miscellaneous", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"polarisation", "=", 
      RowBox[{"OptionValue", "[", "\"\<Polarisation\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"threshold", "=", 
      RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Miller", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"column1", "=", 
      RowBox[{"MillerNotationToString", "/@", "hkl"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Structure", " ", "factors"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"StructureFactor", "[", 
         RowBox[{"crystal", ",", "hkl", ",", "\[Lambda]", ",", 
          RowBox[{"\"\<Threshold\>\"", "\[Rule]", "threshold"}]}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"column2", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"temp", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Structure", " ", "factor", " ", "zero", " ", "positions"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"zeros", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"column2", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Phase", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"column3", "=", 
      RowBox[{"QuantityMagnitude", "@", 
       RowBox[{"temp", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"column3", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"column3", ",", 
        RowBox[{"zeros", "\[Rule]", "\"\<\[Dash]\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Bragg", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"column4", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"bragg", "/@", "hkl"}], ")"}], "/", "Degree"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Unit", " ", "cell", " ", "volume"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"V", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extinction", " ", "length", " ", 
       RowBox[{"(", 
        RowBox[{"Pendell\[ODoubleDot]sung", " ", "distance"}], ")"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"R", "=", 
      RowBox[{"QuantityMagnitude", "@", 
       RowBox[{"UnitConvert", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Quantity", "[", "\"\<ClassicalElectronRadius\>\"", "]"}], 
         ",", "\"\<Angstroms\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"column4", "*", "Degree"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"Fh", "=", "column2"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"FhBar", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"StructureFactor", "[", 
         RowBox[{"crystal", ",", 
          RowBox[{"-", "hkl"}], ",", "\[Lambda]"}], "]"}], ")"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"ExtinctionLength", "[", 
        RowBox[{
        "crystal", ",", "\[Lambda]", ",", "hkl", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}], ",", 
         RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "polarisation"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"\[CapitalLambda]o", ",", 
        RowBox[{"zeros", "\[Rule]", "\"\<\[Dash]\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Darwin", " ", "width"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"\[Delta]os", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"DarwinWidth", "[", 
        RowBox[{
        "crystal", ",", "\[Lambda]", ",", "hkl", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}], ",", 
         RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "polarisation"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]os", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"\[Delta]os", ",", 
        RowBox[{"zeros", "\[Rule]", "\"\<\[Dash]\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"column5", ",", "column6"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"\[CapitalLambda]o", ",", "\[Delta]os"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "output", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp1", "=", 
      RowBox[{"{", 
       RowBox[{
       "column1", ",", "column2", ",", "column3", ",", "column4", ",", 
        "column5", ",", "column6"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Sorting", " ", "option"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"sort", "=", 
      RowBox[{"OptionValue", "[", "\"\<Sort\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "sort", " ", "setting"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Range", "[", "6", "]"}], ",", 
          RowBox[{"Abs", "@", "sort"}]}], "]"}]}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"StructureFactorTable", "::", "sort"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Sorting", " ", "by", " ", "a", " ", "specific", " ", "column"}], " ", 
      "*)"}], "\t\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp2", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Transpose", "@", "temp1"}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"Abs", "@", "sort"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"Abs", "@", "sort"}], "\[RightDoubleBracket]"}]}], "&"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Reversing", " ", "if", " ", "negative"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sort", "<", "0"}], ",", 
       RowBox[{"temp2", "=", 
        RowBox[{"Reverse", "@", "temp2"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Truncate", " ", "the", " ", "list", " ", "of", " ", "reflections"}]}],
       " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"keep", "=", 
      RowBox[{"OptionValue", "[", "\"\<Keep\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"keep", "\[Equal]", "All"}], ",", 
       RowBox[{"keep", "=", 
        RowBox[{"Length", "@", "hkl"}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"IntegerQ", "[", "keep", "]"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"Positive", "[", "keep", "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"StructureFactorTable", "::", "invkeep"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp2", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"temp2", ",", 
        RowBox[{"Min", "[", 
         RowBox[{"keep", ",", 
          RowBox[{"Length", "@", "hkl"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Rounding", " ", "off", " ", "numbers"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp3", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NumberForm", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "3"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"DigitBlock", "\[Rule]", "3"}], ",", 
          RowBox[{"NumberSeparator", "\[Rule]", "\"\<,\>\""}]}], "]"}], "&"}],
        "/@", 
       RowBox[{"(", 
        RowBox[{"Flatten", "@", "temp2"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp4", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"temp3", ",", 
        RowBox[{"Last", "@", 
         RowBox[{"Dimensions", "@", "temp2"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Table", " ", "construction", " ", "*", 
       
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp5", "=", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"temp4", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "\"\<(hkl)\>\"", ",", 
          "\"\<|\!\(\*SubscriptBox[\(F\), \(hkl\)]\)|\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(\[Phi]\), \(hkl\)]\) [\[Degree]]\>\"", 
          ",", "\[IndentingNewLine]", "\t", 
          "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(B\)]\) [\[Degree]]\>\"", 
          ",", "\"\<\!\(\*SubscriptBox[\(\[CapitalLambda]\), \(0\)]\) [\
\[Micro]m]\>\"", ",", 
          "\"\<2\!\(\*SubscriptBox[\(\[Delta]\), \(os\)]\) \
[\[Micro]rad]\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp6", "=", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"temp5", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "Null", ",", "\"\<Structure factor\>\"", ",", "\"\<Phase\>\"", ",", 
          "\[IndentingNewLine]", "\t", "\"\<Bragg angle\>\"", ",", 
          "\"\<Extinction length\>\"", ",", "\[IndentingNewLine]", "\t", 
          "\"\<Darwin width\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Grid", "[", 
      RowBox[{"temp6", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Dividers", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Dividers", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Background", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Background", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Alignment", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"2", "\[Rule]", "0.5"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"ItemStyle", "\[Rule]", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "Automatic", ",", "\[IndentingNewLine]", "\t", "Automatic", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"First", "@", 
                  RowBox[{"Dimensions", "@", "temp1"}]}]}], "}"}]}], "}"}], 
             "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<TitleStyle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"First", "@", 
                  RowBox[{"Dimensions", "@", "temp1"}]}]}], "}"}]}], "}"}], 
             "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<SubtitleStyle\>\"", "]"}]}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"Dimensions", "@", "temp2"}]}], "+", "2"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"First", "@", 
                  RowBox[{"Dimensions", "@", "temp1"}]}]}], "}"}]}], "}"}], 
             "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<NumberStyle\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "\t", "}"}]}], "\[IndentingNewLine]", "\t", 
         "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.6681059041705027`*^9, {3.668106026194642*^9, 
   3.668106055503222*^9}, 3.668192910799576*^9, {3.6681941224670277`*^9, 
   3.668194126738676*^9}, {3.668194161897127*^9, 3.6681941659530773`*^9}, {
   3.668194225695754*^9, 3.6681943053267803`*^9}, {3.668194339678026*^9, 
   3.668194344188929*^9}, {3.6681944039575644`*^9, 3.668194466586141*^9}, {
   3.6681945564479427`*^9, 3.6681945658649063`*^9}, {3.668194622790612*^9, 
   3.668194759771111*^9}, {3.66819490548871*^9, 3.668195027229073*^9}, {
   3.6681951039560843`*^9, 3.66819510554707*^9}, {3.66819513761075*^9, 
   3.668195162577676*^9}, {3.668195214651011*^9, 3.668195218113638*^9}, 
   3.6681952494025793`*^9, 3.6681954247493143`*^9, 3.66824401430801*^9, 
   3.6684058731849527`*^9, {3.668405944769766*^9, 3.668405951720669*^9}, {
   3.6736853314815063`*^9, 3.673685355082993*^9}, {3.6736944025692043`*^9, 
   3.673694463026792*^9}, {3.679749111284326*^9, 3.679749119529436*^9}, {
   3.679749272848419*^9, 3.679749286046275*^9}, 3.6797493496599827`*^9, {
   3.679749406699519*^9, 3.6797494299138737`*^9}, {3.679752731081196*^9, 
   3.679752735159561*^9}, {3.679755957575972*^9, 3.679755974526786*^9}, {
   3.679757886760714*^9, 3.679757915049499*^9}, {3.679757952809022*^9, 
   3.67975795343259*^9}, {3.6797580074154797`*^9, 3.6797580077028008`*^9}, {
   3.6816343573203783`*^9, 3.681634369229891*^9}, {3.6816344032239857`*^9, 
   3.681634446203055*^9}, {3.681634504934698*^9, 3.681634520684157*^9}, {
   3.681668871102579*^9, 3.681668878253851*^9}, {3.684485120925991*^9, 
   3.684485135297613*^9}, {3.684485165928299*^9, 3.684485198270612*^9}, {
   3.684485246037017*^9, 3.684485436633341*^9}, {3.6844854724040728`*^9, 
   3.6844855337764053`*^9}, {3.6844856008386497`*^9, 
   3.6844857691632633`*^9}, {3.684485809188869*^9, 3.6844858205229397`*^9}, {
   3.6844858510434237`*^9, 3.684485911259457*^9}, {3.6844859442451973`*^9, 
   3.684486072812007*^9}, {3.6844861149482327`*^9, 3.6844862603708687`*^9}, {
   3.68448629383969*^9, 3.684486347931925*^9}, {3.684486396878598*^9, 
   3.6844864256933117`*^9}, {3.6844865317020893`*^9, 
   3.6844865929976273`*^9}, {3.6844866482327633`*^9, 3.684486740721855*^9}, {
   3.684487045709893*^9, 3.684487070636261*^9}, 3.684487103167721*^9, {
   3.684487880088442*^9, 3.6844879170825977`*^9}, {3.6850834290776587`*^9, 
   3.685083453530726*^9}, {3.685083491735672*^9, 3.685083493793859*^9}, {
   3.685084511620009*^9, 3.685084534377172*^9}, {3.6852513095226097`*^9, 
   3.685251331509769*^9}, {3.685265793853511*^9, 3.685265803975073*^9}, {
   3.685265839556972*^9, 3.68526596218845*^9}, {3.685266073088797*^9, 
   3.685266093823522*^9}, {3.685266220826173*^9, 3.685266238271948*^9}, {
   3.685266275245944*^9, 3.685266340576406*^9}, {3.685267063973906*^9, 
   3.68526709334811*^9}, {3.685270774115447*^9, 3.6852709228653717`*^9}, {
   3.685300321882452*^9, 3.685300335601007*^9}, {3.685421443505704*^9, 
   3.685421463958482*^9}, {3.685422156442091*^9, 3.685422172609242*^9}, {
   3.685699369585546*^9, 3.685699369868608*^9}, {3.685707914475984*^9, 
   3.6857079249369507`*^9}, {3.6857080309963493`*^9, 3.685708055487095*^9}, 
   3.685765931784999*^9, {3.685776663041807*^9, 3.685776681732292*^9}, {
   3.685777377256502*^9, 3.685777405662352*^9}, 3.685777524891036*^9, {
   3.6857787731275463`*^9, 3.68577877339953*^9}, {3.685778916829303*^9, 
   3.68577891751688*^9}, {3.685779003826284*^9, 3.6857790040668373`*^9}, {
   3.685779111530941*^9, 3.6857791390455627`*^9}, {3.6857791829251223`*^9, 
   3.685779226673965*^9}, {3.685779257568705*^9, 3.685779324132321*^9}, {
   3.685863811228397*^9, 3.685863888812524*^9}, {3.6858639418180532`*^9, 
   3.685864030534474*^9}, {3.685864068109055*^9, 3.6858640728944902`*^9}, {
   3.685864320620183*^9, 3.685864364665761*^9}, {3.685881483399377*^9, 
   3.685881483983437*^9}, {3.6865346936788034`*^9, 3.686534729215604*^9}, {
   3.6865348797712045`*^9, 3.6865349111896048`*^9}, {3.6865351710388064`*^9, 
   3.6865351905388064`*^9}, {3.6865354148980083`*^9, 
   3.6865354271440077`*^9}, {3.6866574967551813`*^9, 3.68665754350769*^9}, {
   3.7147128016475286`*^9, 3.7147128052312393`*^9}, {3.714712861943325*^9, 
   3.7147128669009533`*^9}, {3.714712922756605*^9, 3.714712927633663*^9}, {
   3.714713663696129*^9, 3.7147136882868347`*^9}, {3.7147164475537777`*^9, 
   3.7147164612558727`*^9}, {3.715330575007782*^9, 3.71533060055259*^9}, {
   3.71533063423807*^9, 3.7153306667473297`*^9}, {3.717740896749968*^9, 
   3.717740919759727*^9}, {3.719080061839922*^9, 3.7190800635580177`*^9}, {
   3.719080096107452*^9, 3.71908013681688*^9}, 3.726561582555664*^9, 
   3.727675289752404*^9, {3.730379987198442*^9, 3.7303800426667137`*^9}, {
   3.730380220134783*^9, 3.730380225254434*^9}, 3.7303802840384197`*^9, {
   3.7303805113333607`*^9, 3.730380531762488*^9}, {3.7303805650160418`*^9, 
   3.730380592271204*^9}, {3.730380624520441*^9, 3.7303806444062567`*^9}, {
   3.730383886626964*^9, 3.7303838976804667`*^9}, {3.7303841186379232`*^9, 
   3.730384121147691*^9}, {3.730384175596126*^9, 3.730384297453144*^9}, {
   3.730384401122053*^9, 3.7303844100839863`*^9}, {3.730384791008588*^9, 
   3.730384825634898*^9}, {3.730398391122581*^9, 3.730398403439115*^9}, {
   3.7303989641138067`*^9, 3.730399035992712*^9}, {3.730399129245757*^9, 
   3.730399157067222*^9}, 3.737968267054536*^9, {3.737968468576823*^9, 
   3.7379684686723223`*^9}, {3.7391703649281387`*^9, 3.739170378745417*^9}, {
   3.758530366383757*^9, 3.758530384916501*^9}, {3.759520405940363*^9, 
   3.759520406161471*^9}, 3.7627930940643167`*^9, {3.786968634449304*^9, 
   3.786968636350594*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[893]:=",ExpressionUUID->"eccb4381-c65c-4a33-94ff-b58c47aa19ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[894]:=",ExpressionUUID->"928033bc-42e5-4194-91b6-268230252f25"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetryEquivalentPositions", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.684667958524547*^9, 3.684667960120316*^9}, {3.6846686457735453`*^9, 
   3.6846686463667*^9}, {3.684836784425963*^9, 3.684836788963016*^9}, 
   3.6850744452466288`*^9, 3.6850823153301153`*^9, {3.6854348821014957`*^9, 
   3.685434894095244*^9}, 
   3.737968626349929*^9},ExpressionUUID->"80f54f80-7287-4132-bd9f-\
1e3ee4d4b674"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[895]:=",ExpressionUUID->"511165f0-fae1-4647-a1bb-ccc03cfa1f69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymmetryEquivalentPositions", "::", "threshold"}], "=", 
    "\"\<Tolerance specification must be a non-negative number.\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "SymmetryEquivalentPositions"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<IncludeSymmetryOperations\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<UseCentring\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RationaliseThreshold\>\"", "\[Rule]", "0.001"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "SymmetryEquivalentPositions"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713499594264703*^9, 3.713499600791645*^9}, {
   3.7134997559003563`*^9, 3.713499760848817*^9}, {3.713500682715701*^9, 
   3.713500701729546*^9}, {3.718704905455051*^9, 3.718704929765172*^9}, {
   3.724146707499155*^9, 3.724146707702059*^9}, {3.724146878698964*^9, 
   3.72414690422395*^9}, {3.724147745195922*^9, 3.724147746304405*^9}, {
   3.724148051662944*^9, 3.724148105663968*^9}, {3.725178522395805*^9, 
   3.725178523035316*^9}, {3.7263875589391527`*^9, 3.726387575167107*^9}, {
   3.7263876327996063`*^9, 3.726387668868034*^9}, {3.72638806060953*^9, 
   3.726388104569353*^9}, 3.72638820342171*^9, {3.726908811296638*^9, 
   3.7269088127070007`*^9}, {3.734077581412663*^9, 3.734077582179674*^9}, {
   3.756717605666575*^9, 3.756717631302971*^9}, 3.759479704593539*^9, {
   3.830438984223919*^9, 
   3.830438992992569*^9}},ExpressionUUID->"3296319c-0e0d-4ede-8f8b-\
94d9cb2967c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[899]:=",ExpressionUUID->"ea588cb4-ec03-4ee5-8634-2c2352cd24e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryEquivalentPositions", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"xyzInput_List", ":", 
     RowBox[{"{", 
      RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"group", ",", 
      RowBox[{"\[Delta]", "=", 
       RowBox[{"OptionValue", "[", "\"\<RationaliseThreshold\>\"", "]"}]}], 
      ",", "recognizedFractions", ",", "r", ",", "xyz", ",", 
      "\[IndentingNewLine]", "centeringVectors", ",", "\[IndentingNewLine]", 
      "s", ",", "R", ",", "T", ",", "equiv", ",", 
      "RationalizeRecognizedFractions", ",", "mod", ",", "generate", ",", 
      "gather", ",", "centring", ",", "final", ",", "t", ",", "sym", ",", "c",
       ",", "add", ",", "pos", ",", "temp"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Checks", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"NumericQ", "@", "\[Delta]"}]}], "||", 
        RowBox[{"Negative", "@", "\[Delta]"}]}], ",", 
       RowBox[{"Message", "@", 
        RowBox[{"SymmetryEquivalentPositions", "::", "threshold"}]}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"group", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GetPointSpaceGroupCrystal\>\"", ",", "input"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"xyzInput", ",", "\"\<WrapSingle\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Auxiliary", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"recognizedFractions", "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "12"], ",", 
        FractionBox["1", "8"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "3"], ",", 
        FractionBox["3", "8"], ",", 
        FractionBox["5", "12"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["7", "12"], ",", 
        FractionBox["5", "8"], ",", 
        FractionBox["2", "3"], ",", 
        FractionBox["3", "4"], ",", 
        FractionBox["5", "6"], ",", 
        FractionBox["7", "8"], ",", 
        FractionBox["11", "12"]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RationalizeRecognizedFractions", "[", "coordinates_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Sow", "@", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"recognizedFractions", ",", 
               RowBox[{"r", "=", 
                RowBox[{"Rationalize", "[", 
                 RowBox[{
                  RowBox[{"i", "/.", 
                   RowBox[{"{", 
                    RowBox[{"0.", "\[Rule]", "0"}], "}"}]}], ",", 
                  "\[Delta]"}], "]"}]}]}], "]"}], ",", "r", ",", "i"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "coordinates"}], "}"}]}], "]"}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mod", "[", "X_", "]"}], ":=", 
      RowBox[{"Switch", "[", 
       RowBox[{"X", ",", "\[IndentingNewLine]", 
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"X", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", "_Plus", 
        ",", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"X", ",", "NumericQ"}], "]"}]}], ";", 
         RowBox[{"sym", "=", 
          RowBox[{"X", "-", "t"}]}], ";", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "1"}], "]"}], "+", "sym"}]}], ",", 
        "\[IndentingNewLine]", "_", ",", "X"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Generate", " ", "equivalent", " ", "positions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"GetSymmetryOperations", "[", 
       RowBox[{"group", ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<AugmentedMatrix\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<UseCentring\>\"", "\[Rule]", 
         RowBox[{"OptionValue", "[", "\"\<UseCentring\>\"", "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", "xyz"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Outer", "[", 
        RowBox[{"Dot", ",", "s", ",", "xyz", ",", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Most", ",", "xyz", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"mod", ",", "xyz", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"xyz", "/.", 
       RowBox[{"x_Real", "\[RuleDelayed]", 
        RowBox[{"Round", "[", 
         RowBox[{"x", ",", 
          RowBox[{"10.", "^", 
           RowBox[{"(", 
            RowBox[{"-", "6"}], ")"}]}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"DeleteDuplicates", "/@", "xyz"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"xyzInput", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "ListQ"}], 
            "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"First", "@", "xyz"}], ",", "xyz"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, 
   3.684837418146798*^9, {3.685081765462866*^9, 3.685081784523337*^9}, {
   3.685118924669243*^9, 3.685118964383156*^9}, {3.685119054695488*^9, 
   3.685119066377532*^9}, {3.685119112037159*^9, 3.6851191612366247`*^9}, {
   3.6851222233997707`*^9, 3.685122323624399*^9}, {3.685122416923841*^9, 
   3.685122647957561*^9}, {3.685122869265139*^9, 3.685122929853465*^9}, {
   3.68512305683995*^9, 3.685123057632986*^9}, {3.685123097397284*^9, 
   3.6851231341679573`*^9}, {3.6851232087492*^9, 3.685123290233316*^9}, {
   3.6851233206586733`*^9, 3.685123472518133*^9}, {3.685124768846352*^9, 
   3.685124788413164*^9}, 3.685124827498146*^9, {3.685124922417843*^9, 
   3.685124934839531*^9}, {3.6851249687289753`*^9, 3.685124990060795*^9}, {
   3.6851253439768457`*^9, 3.685125361990635*^9}, {3.685125398349538*^9, 
   3.68512542023664*^9}, {3.6851254611798267`*^9, 3.6851254618843307`*^9}, {
   3.685125539762597*^9, 3.685125544444332*^9}, {3.685125577885902*^9, 
   3.685125578465879*^9}, {3.685125849690433*^9, 3.685125882844267*^9}, 
   3.6851260251970587`*^9, {3.6851260882802267`*^9, 3.685126100928886*^9}, 
   3.6851261506388273`*^9, 3.685158949332796*^9, {3.685159842828394*^9, 
   3.6851598471301613`*^9}, {3.685183225218504*^9, 3.685183274544767*^9}, {
   3.685183644991259*^9, 3.685183651371249*^9}, {3.685183769606805*^9, 
   3.685183925611478*^9}, {3.685184067941053*^9, 3.6851842703513117`*^9}, {
   3.685184421759241*^9, 3.6851844684094353`*^9}, {3.685184503184823*^9, 
   3.685184553229735*^9}, {3.685184708178369*^9, 3.68518473788163*^9}, {
   3.68518479378185*^9, 3.685184816728256*^9}, {3.685184887217552*^9, 
   3.685184904730365*^9}, {3.685184963595149*^9, 3.685184963842359*^9}, {
   3.685185169679628*^9, 3.685185173609806*^9}, {3.685185206615876*^9, 
   3.685185211544053*^9}, {3.685186054699051*^9, 3.685186105224084*^9}, {
   3.685186171361231*^9, 3.68518622835814*^9}, {3.6851864968530817`*^9, 
   3.6851864977507257`*^9}, {3.685188226992251*^9, 3.6851882855032883`*^9}, {
   3.685188338677219*^9, 3.685188389925318*^9}, {3.6851884225533133`*^9, 
   3.6851884778853292`*^9}, {3.6851886397627687`*^9, 
   3.6851886404914837`*^9}, {3.685188736921248*^9, 3.6851887716553507`*^9}, {
   3.6851888382458267`*^9, 3.685188843807993*^9}, {3.685188901531807*^9, 
   3.685188958942677*^9}, {3.6852030136406918`*^9, 3.6852030203402653`*^9}, {
   3.685203332714066*^9, 3.6852034664310293`*^9}, {3.68520357949958*^9, 
   3.685203583579488*^9}, {3.685203631691106*^9, 3.6852038238427153`*^9}, {
   3.685204014818913*^9, 3.685204018641644*^9}, {3.6852046948378363`*^9, 
   3.685204701530817*^9}, 3.685205189266966*^9, {3.685205251120021*^9, 
   3.685205258984681*^9}, {3.685205294199864*^9, 3.685205323967197*^9}, {
   3.685205382261896*^9, 3.6852053942304697`*^9}, {3.685205539665709*^9, 
   3.685205582735384*^9}, {3.685205749293621*^9, 3.685205767326249*^9}, 
   3.685205870955637*^9, {3.685205939497405*^9, 3.685205952679864*^9}, {
   3.685206060213029*^9, 3.685206145011127*^9}, {3.68520619674656*^9, 
   3.68520619707379*^9}, {3.685206227123476*^9, 3.6852062339549627`*^9}, {
   3.685206272608488*^9, 3.685206275168111*^9}, {3.6852064304145*^9, 
   3.685206469262385*^9}, {3.685206550603971*^9, 3.6852066279924726`*^9}, {
   3.6852066849438343`*^9, 3.6852067411658983`*^9}, {3.685206788680094*^9, 
   3.6852068067724953`*^9}, 3.685206882845697*^9, {3.685206965809578*^9, 
   3.6852069758419437`*^9}, {3.6852070473454227`*^9, 3.685207057519327*^9}, {
   3.6852452311009398`*^9, 3.685245232029594*^9}, {3.685245304014555*^9, 
   3.685245306103737*^9}, {3.68533315360011*^9, 3.685333158638859*^9}, {
   3.685333288226824*^9, 3.685333412181869*^9}, {3.685333489406932*^9, 
   3.685333527621323*^9}, {3.685334009710787*^9, 3.6853340615531063`*^9}, {
   3.685683948109357*^9, 3.685683969066854*^9}, {3.685684173378677*^9, 
   3.685684179360407*^9}, {3.685684219351754*^9, 3.685684242026422*^9}, {
   3.685684329113531*^9, 3.685684344552244*^9}, 3.685684490792983*^9, {
   3.685684963453862*^9, 3.685684972318191*^9}, {3.685685202118141*^9, 
   3.685685202722992*^9}, {3.6856983764665422`*^9, 3.685698384472649*^9}, {
   3.685698414521661*^9, 3.685698453912359*^9}, {3.6856986280000772`*^9, 
   3.685698635822954*^9}, {3.6856989018480177`*^9, 3.685698902841278*^9}, {
   3.685700719109725*^9, 3.685700720110365*^9}, {3.713083751718377*^9, 
   3.713083768413437*^9}, {3.713168273264307*^9, 3.713168277563582*^9}, {
   3.713168352903799*^9, 3.713168405861792*^9}, {3.713169589471793*^9, 
   3.713169608606256*^9}, 3.713170013682741*^9, 3.7131700575141897`*^9, {
   3.713170088986618*^9, 3.713170095603582*^9}, {3.713499526158893*^9, 
   3.713499560588848*^9}, {3.713499770664796*^9, 3.71349982766545*^9}, {
   3.713500050118387*^9, 3.713500061879233*^9}, {3.713500101567704*^9, 
   3.7135001351390047`*^9}, {3.7135003662897367`*^9, 3.713500366952792*^9}, {
   3.7135004654799128`*^9, 3.713500473607541*^9}, {3.713500510785741*^9, 
   3.713500548924837*^9}, {3.7135006099457817`*^9, 3.713500636869567*^9}, {
   3.7135006877885723`*^9, 3.713500703153545*^9}, {3.713501023263645*^9, 
   3.713501030131527*^9}, {3.713501167584064*^9, 3.713501170406444*^9}, {
   3.713501223155225*^9, 3.71350124856561*^9}, {3.713501362594186*^9, 
   3.7135013680528383`*^9}, {3.7135029931867867`*^9, 3.71350304465942*^9}, {
   3.713503129290868*^9, 3.7135031834803953`*^9}, {3.7135032444088163`*^9, 
   3.713503287944261*^9}, {3.713503370502891*^9, 3.713503374958488*^9}, {
   3.713503975546476*^9, 3.71350397576543*^9}, {3.713504684810058*^9, 
   3.71350471149022*^9}, {3.713504821673073*^9, 3.713504847051462*^9}, {
   3.713506770792006*^9, 3.7135067710357733`*^9}, {3.7177409035310583`*^9, 
   3.7177409198199987`*^9}, {3.718702267905682*^9, 3.718702270984975*^9}, {
   3.718702546513485*^9, 3.71870255542673*^9}, {3.718702587256318*^9, 
   3.718702592924734*^9}, {3.718702790866989*^9, 3.718702840811036*^9}, {
   3.7187029420200768`*^9, 3.71870295733777*^9}, {3.7187033042637167`*^9, 
   3.718703324477955*^9}, {3.718703557410552*^9, 3.718703580861421*^9}, {
   3.718703721969316*^9, 3.7187037670065403`*^9}, {3.718703810648787*^9, 
   3.718703819606621*^9}, {3.7187042484751873`*^9, 3.718704276325185*^9}, {
   3.718704359572277*^9, 3.718704403538443*^9}, {3.718704579618905*^9, 
   3.718704584453946*^9}, {3.718704649134219*^9, 3.7187046773772163`*^9}, {
   3.718704772052511*^9, 3.718704803326536*^9}, {3.718704861649938*^9, 
   3.718704861758614*^9}, {3.71870489875311*^9, 3.718704902109955*^9}, {
   3.718704935516982*^9, 3.7187050089972143`*^9}, {3.7187050974002247`*^9, 
   3.718705143963745*^9}, {3.7187051797426157`*^9, 3.71870518179688*^9}, {
   3.7187052496216383`*^9, 3.718705309113635*^9}, {3.718705342961183*^9, 
   3.718705486696869*^9}, {3.71870558241322*^9, 3.718705631663995*^9}, {
   3.718705669496666*^9, 3.718705693622848*^9}, {3.7187057832542257`*^9, 
   3.7187057844852753`*^9}, {3.718943604887106*^9, 3.718943605567745*^9}, {
   3.718957331435055*^9, 3.718957332253023*^9}, {3.7189581197219467`*^9, 
   3.718958126536869*^9}, {3.718958262990077*^9, 3.7189583030322647`*^9}, {
   3.718958341354164*^9, 3.718958395057558*^9}, {3.718958902658646*^9, 
   3.7189589330848703`*^9}, {3.7189595972869463`*^9, 
   3.7189595999236383`*^9}, {3.718959645726413*^9, 3.718959645938561*^9}, {
   3.718959723445923*^9, 3.718959731129519*^9}, {3.718959855847272*^9, 
   3.7189598628644333`*^9}, {3.718959928416421*^9, 3.718960092214171*^9}, {
   3.7189603590826797`*^9, 3.7189603675865917`*^9}, {3.718960430355897*^9, 
   3.718960476213838*^9}, {3.718960506946436*^9, 3.718960531167076*^9}, {
   3.718960569668892*^9, 3.7189605967364483`*^9}, {3.718960716944191*^9, 
   3.718960719223394*^9}, {3.7189607746680527`*^9, 3.718960822713955*^9}, {
   3.718960862042358*^9, 3.7189608891031923`*^9}, {3.718960954685461*^9, 
   3.718960996746277*^9}, {3.718961138055512*^9, 3.718961142984647*^9}, {
   3.718961176445119*^9, 3.718961207844944*^9}, {3.718961519200281*^9, 
   3.718961529170055*^9}, 3.718961804790731*^9, {3.71896185591358*^9, 
   3.718961881823591*^9}, {3.718961997669425*^9, 3.718961997860964*^9}, {
   3.718962067462232*^9, 3.718962191140209*^9}, {3.718962245560566*^9, 
   3.7189622458724203`*^9}, {3.7189623145675488`*^9, 3.718962343842904*^9}, {
   3.718962426989458*^9, 3.718962428820262*^9}, {3.718974001878937*^9, 
   3.718974004349689*^9}, {3.718974122257966*^9, 3.718974134597761*^9}, {
   3.718974283762995*^9, 3.718974286577139*^9}, {3.718974370343102*^9, 
   3.718974373886902*^9}, {3.718974407984931*^9, 3.718974408640705*^9}, {
   3.7189755121327887`*^9, 3.7189756028499804`*^9}, {3.718975782558567*^9, 
   3.7189757829743357`*^9}, {3.7189759875925694`*^9, 3.71897600053087*^9}, {
   3.718976113763732*^9, 3.7189761554244003`*^9}, {3.718976199097856*^9, 
   3.718976218167144*^9}, {3.718976858317809*^9, 3.718977011610354*^9}, {
   3.718977219894305*^9, 3.718977230977405*^9}, {3.718977403251737*^9, 
   3.718977438577445*^9}, {3.718977547318542*^9, 3.7189776158462963`*^9}, {
   3.718977661438077*^9, 3.7189777150195827`*^9}, {3.718979971407103*^9, 
   3.718980029709015*^9}, {3.718980144339252*^9, 3.7189802286591253`*^9}, {
   3.721029130761808*^9, 3.721029164831861*^9}, {3.7241476371690207`*^9, 
   3.724147798167531*^9}, {3.724148002937152*^9, 3.7241480436785307`*^9}, {
   3.724148181215764*^9, 3.7241481911749477`*^9}, {3.724148305769567*^9, 
   3.7241483067806177`*^9}, {3.724148653838604*^9, 3.7241486699696617`*^9}, {
   3.724149039524035*^9, 3.724149059360086*^9}, {3.724149101482971*^9, 
   3.724149143000737*^9}, {3.7241491768592052`*^9, 3.724149177006098*^9}, {
   3.724149213842347*^9, 3.724149230497789*^9}, {3.72456240877332*^9, 
   3.724562437241872*^9}, {3.724562691949194*^9, 3.724562705074954*^9}, {
   3.724562738986405*^9, 3.724562744786539*^9}, {3.7245627838992968`*^9, 
   3.724562806177045*^9}, {3.7245628474439163`*^9, 3.724562980600527*^9}, {
   3.724563014640937*^9, 3.724563063724536*^9}, 3.724563137901832*^9, {
   3.724563852516762*^9, 3.724563900159609*^9}, {3.724563966154461*^9, 
   3.724563968696681*^9}, {3.724563999155751*^9, 3.72456400504391*^9}, {
   3.7245642420808363`*^9, 3.7245642459234447`*^9}, 3.724564353346133*^9, {
   3.725178421835697*^9, 3.7251785155592957`*^9}, {3.726387588253851*^9, 
   3.726387595167289*^9}, {3.7263876411446466`*^9, 3.7263876432217493`*^9}, {
   3.7263879719181004`*^9, 3.726388017726527*^9}, {3.7263880512764597`*^9, 
   3.726388052385066*^9}, {3.726388106877531*^9, 3.726388112017288*^9}, {
   3.72638820775865*^9, 3.726388217097714*^9}, {3.726388261414641*^9, 
   3.726388271841373*^9}, {3.726388305339175*^9, 3.726388334413658*^9}, {
   3.726388825085866*^9, 3.726389001368773*^9}, {3.726389032049206*^9, 
   3.726389066652157*^9}, {3.7263891317997007`*^9, 3.7263891487172613`*^9}, {
   3.726389221087077*^9, 3.726389223956566*^9}, {3.7264151648398333`*^9, 
   3.726415208707095*^9}, {3.726489400555379*^9, 3.726489429073037*^9}, {
   3.726489732160439*^9, 3.7264897372408533`*^9}, {3.7264899125900087`*^9, 
   3.7264899127440157`*^9}, {3.72648998651215*^9, 3.7264899891958923`*^9}, {
   3.726504530915469*^9, 3.7265045395905123`*^9}, {3.726504825852056*^9, 
   3.726504840043426*^9}, {3.7265077848728437`*^9, 3.726507787550996*^9}, {
   3.7265078438964777`*^9, 3.7265078594780807`*^9}, 3.7265079119767237`*^9, {
   3.727676991582205*^9, 3.727677039008367*^9}, {3.727677095868355*^9, 
   3.7276771258869543`*^9}, {3.727677467171747*^9, 3.727677514204391*^9}, {
   3.7276775832617702`*^9, 3.7276775836411533`*^9}, {3.730544578740963*^9, 
   3.730544579232334*^9}, {3.7340777597422867`*^9, 3.734077772304899*^9}, {
   3.73486098583354*^9, 3.734861021506486*^9}, {3.734861433872726*^9, 
   3.734861465045043*^9}, {3.734861565527253*^9, 3.734861622205986*^9}, {
   3.7348620902371817`*^9, 3.734862091319553*^9}, {3.7348621617054987`*^9, 
   3.734862204718985*^9}, {3.734862323475853*^9, 3.734862411200985*^9}, {
   3.734862583790059*^9, 3.7348625925288677`*^9}, {3.734862625049259*^9, 
   3.734862692372064*^9}, {3.7348627243620567`*^9, 3.734862752835022*^9}, {
   3.73486279054207*^9, 3.734862829270259*^9}, {3.7348628679178543`*^9, 
   3.734863013197206*^9}, {3.734863123296424*^9, 3.73486318018404*^9}, 
   3.73486333229845*^9, {3.734863390870963*^9, 3.7348634050096817`*^9}, {
   3.734863474190488*^9, 3.734863601336433*^9}, {3.73486363259906*^9, 
   3.734863648144658*^9}, {3.734863702739545*^9, 3.734863738886001*^9}, {
   3.734863772657653*^9, 3.734863969922078*^9}, {3.734864004365635*^9, 
   3.734864006345433*^9}, {3.734864077884124*^9, 3.7348641062215242`*^9}, {
   3.734864142277185*^9, 3.734864185780414*^9}, {3.734864247463869*^9, 
   3.7348642530248213`*^9}, {3.73486431505219*^9, 3.7348643207831917`*^9}, {
   3.734864360592111*^9, 3.7348645503844547`*^9}, {3.734864605516275*^9, 
   3.734864620872447*^9}, {3.7348647600644484`*^9, 3.7348647900575533`*^9}, {
   3.73486482234233*^9, 3.734864906273492*^9}, {3.734865238259924*^9, 
   3.73486530354867*^9}, {3.734865482500976*^9, 3.734865649645473*^9}, {
   3.734865774304893*^9, 3.734865788269722*^9}, {3.734865852967577*^9, 
   3.734865871728486*^9}, {3.734865920520743*^9, 3.7348661142347593`*^9}, {
   3.734866190179076*^9, 3.734866193345695*^9}, {3.7373839264276752`*^9, 
   3.737383930316886*^9}, 3.7373844586748533`*^9, {3.7379685458872004`*^9, 
   3.737968575584436*^9}, {3.758530387012121*^9, 3.758530428305229*^9}, {
   3.759520420649715*^9, 3.7595204208876247`*^9}, 3.762793094095827*^9, {
   3.7869686439758863`*^9, 3.786968658395196*^9}, {3.8304177368167763`*^9, 
   3.830417741505583*^9}, {3.8304258700990667`*^9, 3.8304258730445147`*^9}, {
   3.830425943381843*^9, 3.830426026438287*^9}, {3.8304261236234503`*^9, 
   3.830426135762637*^9}, 3.8304261844669933`*^9, {3.830426278454235*^9, 
   3.8304262882155743`*^9}, {3.8304263571366043`*^9, 
   3.8304265193490334`*^9}, {3.8304265689522953`*^9, 
   3.8304266158865013`*^9}, {3.830426764963306*^9, 3.8304268216913967`*^9}, {
   3.830426982795641*^9, 3.83042698958372*^9}, {3.830427584448202*^9, 
   3.830427586718484*^9}, {3.8304278043657217`*^9, 3.830427805866591*^9}, {
   3.830427858535883*^9, 3.830427966330267*^9}, {3.830428052833576*^9, 
   3.830428069332018*^9}, {3.830428106882503*^9, 3.830428109552227*^9}, {
   3.830428332035082*^9, 3.830428362171259*^9}, {3.830428700554624*^9, 
   3.8304287124079514`*^9}, {3.8304287842884073`*^9, 3.83042880242452*^9}, {
   3.83042886536992*^9, 3.830428892843904*^9}, {3.8304290113976183`*^9, 
   3.830429024390853*^9}, {3.830429130248191*^9, 3.830429134981422*^9}, {
   3.830431065033575*^9, 3.8304310844485483`*^9}, {3.830431141979969*^9, 
   3.830431168272952*^9}, {3.8304315805404463`*^9, 3.830431624278265*^9}, {
   3.8304319204082003`*^9, 3.830431959537521*^9}, {3.830431999521676*^9, 
   3.830432015452428*^9}, {3.83043211031011*^9, 3.8304321378051662`*^9}, {
   3.830432175707218*^9, 3.8304321804945087`*^9}, {3.830432239605625*^9, 
   3.830432334577413*^9}, {3.830432514331699*^9, 3.830432517160643*^9}, {
   3.830432550636825*^9, 3.8304325831442327`*^9}, {3.830433134627632*^9, 
   3.830433148874991*^9}, {3.830433254547612*^9, 3.830433254614232*^9}, {
   3.830433580038054*^9, 3.8304335934610786`*^9}, {3.830437015630322*^9, 
   3.8304370985698643`*^9}, {3.8304373988901167`*^9, 3.830437489741053*^9}, {
   3.83043791072191*^9, 3.8304379123550797`*^9}, {3.83043806727111*^9, 
   3.830438068681179*^9}, {3.8304381728880463`*^9, 3.830438192860918*^9}, {
   3.830438252449795*^9, 3.830438335476022*^9}, {3.830438370673218*^9, 
   3.83043837456575*^9}, {3.830438494744349*^9, 3.830438498960928*^9}, {
   3.83043853284204*^9, 3.8304386000124693`*^9}, {3.830438733763357*^9, 
   3.8304387629511423`*^9}, {3.830440009631531*^9, 3.830440011245377*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"379c8c9d-0dc0-42c7-b6a8-1f2ba45339aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[901]:=",ExpressionUUID->"c68a7379-a098-419b-b298-a25392a1a36d"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetryEquivalentReflections", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.684667958524547*^9, 3.684667960120316*^9}, {3.6846686457735453`*^9, 
   3.6846686463667*^9}, {3.684836784425963*^9, 3.684836788963016*^9}, 
   3.6850744452466288`*^9, 3.6850823153301153`*^9, {3.6854348821014957`*^9, 
   3.6854349197447567`*^9}},ExpressionUUID->"864a65b4-974d-493c-a749-\
41208d360989"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[902]:=",ExpressionUUID->"b3f981a2-3b7e-4ce9-baf7-a86b4e426d42"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "SymmetryEquivalentReflections"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_."}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.756717684084676*^9, {3.756717799066216*^9, 3.75671779919331*^9}},
 CellLabel->
  "In[903]:=",ExpressionUUID->"bf6032a7-0e18-4c5e-802e-ff878d9ace84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[904]:=",ExpressionUUID->"da61c416-4c57-46f2-bea3-49409cde2070"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryEquivalentReflections", "[", 
   RowBox[{"group_String", ",", 
    RowBox[{"hkl_List", ":", 
     RowBox[{"{", 
      RowBox[{"\"\<h\>\"", ",", "\"\<k\>\"", ",", "\"\<l\>\""}], "}"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"$GroupSymbolRedirect", ",", "group"}], "]"}]}], "&&", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"!", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"$CrystalData", ",", "group"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetSymmetryOperations", "::", "missing"}], ",", "group"}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"hkl", ",", "\"\<1hkl\>\"", ",", "\"\<StringSymbol\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Symmetry", " ", "equivalent", " ", "reflections"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "@", "$PointGroups"}], ",", "group"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"s", "=", 
        RowBox[{"GetSymmetryOperations", "@", "group"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"s", "=", 
        RowBox[{"GetSymmetryOperations", "@", 
         RowBox[{"GetLaueClass", "@", "group"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"DeleteDuplicates", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "]"}], ".", "hkl"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "s"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, 
   3.684837418146798*^9, {3.685081765462866*^9, 3.685081784523337*^9}, {
   3.685118924669243*^9, 3.685118964383156*^9}, {3.685119054695488*^9, 
   3.685119066377532*^9}, {3.685119112037159*^9, 3.6851191612366247`*^9}, {
   3.6851222233997707`*^9, 3.685122323624399*^9}, {3.685122416923841*^9, 
   3.685122647957561*^9}, {3.685122869265139*^9, 3.685122929853465*^9}, {
   3.68512305683995*^9, 3.685123057632986*^9}, {3.685123097397284*^9, 
   3.6851231341679573`*^9}, {3.6851232087492*^9, 3.685123290233316*^9}, {
   3.6851233206586733`*^9, 3.685123472518133*^9}, {3.685124768846352*^9, 
   3.685124788413164*^9}, 3.685124827498146*^9, {3.685124922417843*^9, 
   3.685124934839531*^9}, {3.6851249687289753`*^9, 3.685124990060795*^9}, {
   3.6851253439768457`*^9, 3.685125361990635*^9}, {3.685125398349538*^9, 
   3.68512542023664*^9}, {3.6851254611798267`*^9, 3.6851254618843307`*^9}, {
   3.685125539762597*^9, 3.685125544444332*^9}, {3.685125577885902*^9, 
   3.685125578465879*^9}, {3.685125849690433*^9, 3.685125882844267*^9}, 
   3.6851260251970587`*^9, {3.6851260882802267`*^9, 3.685126100928886*^9}, 
   3.6851261506388273`*^9, 3.685158949332796*^9, {3.685159842828394*^9, 
   3.6851598471301613`*^9}, {3.685183225218504*^9, 3.685183274544767*^9}, {
   3.685183644991259*^9, 3.685183651371249*^9}, {3.685183769606805*^9, 
   3.685183925611478*^9}, {3.685184067941053*^9, 3.6851842703513117`*^9}, {
   3.685184421759241*^9, 3.6851844684094353`*^9}, {3.685184503184823*^9, 
   3.685184553229735*^9}, {3.685184708178369*^9, 3.68518473788163*^9}, {
   3.68518479378185*^9, 3.685184816728256*^9}, {3.685184887217552*^9, 
   3.685184904730365*^9}, {3.685184963595149*^9, 3.685184963842359*^9}, {
   3.685185169679628*^9, 3.685185173609806*^9}, {3.685185206615876*^9, 
   3.685185211544053*^9}, {3.685186054699051*^9, 3.685186105224084*^9}, {
   3.685186171361231*^9, 3.68518622835814*^9}, {3.6851864968530817`*^9, 
   3.6851864977507257`*^9}, {3.685188226992251*^9, 3.6851882855032883`*^9}, {
   3.685188338677219*^9, 3.685188389925318*^9}, {3.6851884225533133`*^9, 
   3.6851884778853292`*^9}, {3.6851886397627687`*^9, 
   3.6851886404914837`*^9}, {3.685188736921248*^9, 3.6851887716553507`*^9}, {
   3.6851888382458267`*^9, 3.685188843807993*^9}, {3.685188901531807*^9, 
   3.685188958942677*^9}, {3.6852030136406918`*^9, 3.6852030203402653`*^9}, {
   3.685203332714066*^9, 3.6852034664310293`*^9}, {3.68520357949958*^9, 
   3.685203583579488*^9}, {3.685203631691106*^9, 3.6852038238427153`*^9}, {
   3.685204014818913*^9, 3.685204018641644*^9}, {3.6852046948378363`*^9, 
   3.685204701530817*^9}, 3.685205189266966*^9, {3.685205251120021*^9, 
   3.685205258984681*^9}, {3.685205294199864*^9, 3.685205323967197*^9}, {
   3.685205382261896*^9, 3.6852053942304697`*^9}, {3.685205539665709*^9, 
   3.685205582735384*^9}, {3.685205749293621*^9, 3.685205767326249*^9}, 
   3.685205870955637*^9, {3.685205939497405*^9, 3.685205952679864*^9}, {
   3.685206060213029*^9, 3.685206145011127*^9}, {3.68520619674656*^9, 
   3.68520619707379*^9}, {3.685206227123476*^9, 3.6852062339549627`*^9}, {
   3.685206272608488*^9, 3.685206275168111*^9}, {3.6852064304145*^9, 
   3.685206469262385*^9}, {3.685206550603971*^9, 3.6852066279924726`*^9}, {
   3.6852066849438343`*^9, 3.6852067411658983`*^9}, {3.685206788680094*^9, 
   3.6852068067724953`*^9}, 3.685206882845697*^9, {3.685206965809578*^9, 
   3.6852069758419437`*^9}, {3.6852070473454227`*^9, 3.685207057519327*^9}, {
   3.6852452311009398`*^9, 3.685245232029594*^9}, {3.685245304014555*^9, 
   3.685245306103737*^9}, {3.68533315360011*^9, 3.685333158638859*^9}, {
   3.685333288226824*^9, 3.685333412181869*^9}, {3.685333489406932*^9, 
   3.685333527621323*^9}, {3.685334009710787*^9, 3.6853340615531063`*^9}, {
   3.685434951893444*^9, 3.68543495645269*^9}, {3.685679308302184*^9, 
   3.685679366541724*^9}, {3.685681362973937*^9, 3.685681390985156*^9}, {
   3.685681541848689*^9, 3.685681548849369*^9}, {3.685681624159025*^9, 
   3.6856817248245993`*^9}, {3.685682375085328*^9, 3.6856824096829777`*^9}, {
   3.685682706970652*^9, 3.6856827361419764`*^9}, {3.685682780500025*^9, 
   3.685682793326985*^9}, {3.6856834020300283`*^9, 3.6856834023318663`*^9}, {
   3.685683541715803*^9, 3.685683546893722*^9}, {3.685683742811008*^9, 
   3.685683769887274*^9}, {3.685684019680534*^9, 3.685684021685522*^9}, {
   3.685694740553224*^9, 3.685694766829873*^9}, {3.685694805066313*^9, 
   3.685694808781307*^9}, {3.685694869054508*^9, 3.6856948787401648`*^9}, {
   3.685695112301713*^9, 3.6856951137454853`*^9}, 3.685695291215526*^9, 
   3.685695949981629*^9, {3.6856960570805883`*^9, 3.685696063351282*^9}, {
   3.68569622489463*^9, 3.685696229856901*^9}, {3.685696435911221*^9, 
   3.685696442965283*^9}, {3.6857006845375023`*^9, 3.685700715242507*^9}, {
   3.712991278892541*^9, 3.712991280175083*^9}, {3.712991603345912*^9, 
   3.71299160388553*^9}, {3.712991641984169*^9, 3.712991644925946*^9}, {
   3.713082611111361*^9, 3.713082648830266*^9}, {3.713082711733365*^9, 
   3.713082738595105*^9}, {3.713508632168604*^9, 3.7135086477071753`*^9}, {
   3.713508700392296*^9, 3.713508705070444*^9}, {3.7135090149047403`*^9, 
   3.713509014983123*^9}, {3.71350904912803*^9, 3.713509071140704*^9}, {
   3.713509218835183*^9, 3.7135092234542313`*^9}, {3.717216931454473*^9, 
   3.7172169366602583`*^9}, {3.717740903605912*^9, 3.7177409198879843`*^9}, 
   3.73796852100904*^9, {3.737968575699355*^9, 3.737968575897303*^9}, 
   3.7438654566376657`*^9, {3.7585304308805733`*^9, 3.7585304323212833`*^9}, 
   3.7627930941118183`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[905]:=",ExpressionUUID->"d2a85b2d-7952-442e-b8b0-a27019f6b47d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[906]:=",ExpressionUUID->"5fe3ee9a-00cc-4ea2-806f-d057d8e0adee"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetryEquivalentReflectionsQ", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.682754675215427*^9, 3.682754677485675*^9}, {
   3.728589882633176*^9, 
   3.728589884007854*^9}},ExpressionUUID->"c31ec3e7-af3a-405a-aff8-\
61970a1e2db1"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[907]:=",ExpressionUUID->"b56be4d2-5790-441c-9d97-2257fcee5fda"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "SymmetryEquivalentReflectionsQ"}], "=", 
   
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7567181293502903`*^9, 3.756718141676044*^9}},
 CellLabel->
  "In[908]:=",ExpressionUUID->"47a9516b-0dcd-46ee-9df6-9b124dba4ba3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[909]:=",ExpressionUUID->"d8faaa2d-a87c-4252-9da2-832fe2c8e706"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryEquivalentReflectionsQ", "[", 
   RowBox[{"group_String", ",", "hkl_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "equiv", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"InputCheck", "[", 
        RowBox[{"hkl", ",", "\"\<Multiple\>\""}], "]"}], ",", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Listing", " ", "all", " ", "symmetry"}], "-", 
       RowBox[{
       "equivalents", " ", "of", " ", "the", " ", "first", " ", 
        "reflection"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"equiv", "=", 
      RowBox[{"SymmetryEquivalentReflections", "[", 
       RowBox[{"group", ",", 
        RowBox[{"First", "@", "hkl"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Checking", " ", "if", " ", "all", " ", "given", " ", "reflections", 
       " ", "are", " ", "symmetry", " ", "equivalent"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"AllTrue", "[", 
      RowBox[{"hkl", ",", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"equiv", ",", "#"}], "]"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.682682345535097*^9, 3.682682347997387*^9}, {
   3.682754890045689*^9, 3.682754900136516*^9}, {3.682754952296125*^9, 
   3.682755022164933*^9}, {3.682755115621669*^9, 3.6827551535141687`*^9}, {
   3.682755192899743*^9, 3.682755204616169*^9}, {3.682755483075945*^9, 
   3.682755572184518*^9}, {3.682755620936475*^9, 3.68275570339452*^9}, {
   3.682755785197132*^9, 3.6827558328591137`*^9}, {3.682755872957996*^9, 
   3.682755929888302*^9}, {3.6827560172459*^9, 3.68275608066227*^9}, {
   3.6827561903761797`*^9, 3.682756208255334*^9}, {3.682756341293084*^9, 
   3.682756435807774*^9}, {3.682756481562601*^9, 3.6827566171437607`*^9}, {
   3.6827571356319447`*^9, 3.68275715086217*^9}, {3.682757193154983*^9, 
   3.682757204761051*^9}, {3.682757287045686*^9, 3.6827573748421717`*^9}, {
   3.6827574428815193`*^9, 3.682757463459453*^9}, {3.6827575865280647`*^9, 
   3.682757600041594*^9}, {3.6827576521824217`*^9, 3.682757654103991*^9}, {
   3.682757736488762*^9, 3.68275776848295*^9}, {3.682757872746702*^9, 
   3.682757878996653*^9}, {3.682760893290402*^9, 3.682760919442278*^9}, {
   3.682761050069873*^9, 3.6827610875022707`*^9}, {3.682761344440157*^9, 
   3.6827613948805656`*^9}, {3.682761467533331*^9, 3.6827614906040382`*^9}, {
   3.682761599041744*^9, 3.6827616051249332`*^9}, {3.682761640140191*^9, 
   3.682761640269712*^9}, 3.6827639426904078`*^9, {3.6836041069697723`*^9, 
   3.6836041112112017`*^9}, 3.6836042162385483`*^9, {3.683604258086424*^9, 
   3.683604264748822*^9}, {3.68413887737684*^9, 3.684138878448064*^9}, {
   3.684138967042678*^9, 3.6841389692184362`*^9}, {3.684139303146071*^9, 
   3.6841393351275997`*^9}, {3.684139441296114*^9, 3.684139473944319*^9}, {
   3.684140980548189*^9, 3.6841409843885393`*^9}, {3.684148295094286*^9, 
   3.6841482963032303`*^9}, 3.6842129856849403`*^9, {3.684213283716967*^9, 
   3.6842133828533163`*^9}, 3.684235428926165*^9, {3.684492634022192*^9, 
   3.684492635098358*^9}, {3.684669134566234*^9, 3.6846691376529293`*^9}, {
   3.685082157159202*^9, 3.685082158064439*^9}, 3.685084042458507*^9, {
   3.685351440985919*^9, 3.68535144830571*^9}, {3.685351631494957*^9, 
   3.685351726668476*^9}, 3.685352008158111*^9, {3.685686126515623*^9, 
   3.685686128329524*^9}, {3.68568617716809*^9, 3.685686214633534*^9}, {
   3.6856966918105917`*^9, 3.685696730149053*^9}, {3.685696768458043*^9, 
   3.685696768931511*^9}, {3.685699116303381*^9, 3.685699129690091*^9}, {
   3.717218478566028*^9, 3.7172184794036493`*^9}, 3.717740919858317*^9, 
   3.728589900907535*^9, {3.728621424723817*^9, 3.7286214272083683`*^9}, 
   3.7416291419918423`*^9, 3.7627930941242437`*^9, {3.786968676611054*^9, 
   3.786968685016528*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[910]:=",ExpressionUUID->"482ec450-6504-4a22-b242-e92d697fe6cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[911]:=",ExpressionUUID->"775c4a72-9ae1-4d5e-a8a6-f730bdcb0685"]
}, Closed]],

Cell[CellGroupData[{

Cell["SynthesiseStructure", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.7609498283827267`*^9, 3.76094983161379*^9}, {
   3.770459739768036*^9, 3.770459744809925*^9}, {3.780063537050106*^9, 
   3.780063541952429*^9}},ExpressionUUID->"6c97c546-662b-4336-a8d8-\
002086c39206"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[912]:=",ExpressionUUID->"db6c67c9-2e0b-48da-aed1-0ca075da3e4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SynthesiseStructure", "::", "SizeError"}], "=", 
   "\"\<Size discrepancy in domain input.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SynthesiseStructure", "::", "DifferentBlockSizes"}], "=", 
   "\"\<The blocks must have the same size.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SynthesiseStructure", "::", "InvalidOutputSize"}], "=", 
   "\"\<Output size must be a list of three positive integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SynthesiseStructure", "::", "IncompatibleOutputSize"}], "=", 
   "\"\<Output size must be compatible with block sizes.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SynthesiseStructure", "::", "InvalidSelectionMethod"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid selection method.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SynthesiseStructure", "::", "ExpectedSpecialLabel"}], "=", 
   "\"\<Chemical element or \\\"Void\\\" expected; got \[LeftGuillemet]`1`\
\[RightGuillemet] instead.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SynthesiseStructure", "::", "InvalidLatticeParameters"}], "=", 
   "\"\<Lattice parameters should be a list of six numbers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SynthesiseStructure", "::", "NothingToBuild"}], "=", 
    "\"\<No units in construction list.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "SynthesiseStructure"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Padding\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "\"\<RotationAnchorReference\>\"", "\[Rule]", 
       "\"\<DomainCentroid\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAnchorShift\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAxes\>\"", "\[Rule]", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationMap\>\"", "\[Rule]", 
       RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<SelectionMethod\>\"", "\[Rule]", "\"\<Sequential\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "SynthesiseStructure"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_.", ",", "_.", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
   3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
   3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
   3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
   3.756710476208014*^9}, {3.76094984995916*^9, 3.760949866421854*^9}, {
   3.762482676390929*^9, 3.762482706347602*^9}, {3.762487787402885*^9, 
   3.762487787935628*^9}, {3.7704597473877983`*^9, 3.77045978202227*^9}, {
   3.770459933601384*^9, 3.770459936167313*^9}, {3.7704666896136217`*^9, 
   3.770466697612974*^9}, {3.7706146521036377`*^9, 3.770614679663534*^9}, {
   3.770616146185195*^9, 3.7706161787997923`*^9}, 3.7706163538198566`*^9, {
   3.770625540633625*^9, 3.770625595637392*^9}, {3.7709815083625593`*^9, 
   3.7709815150338287`*^9}, 3.770981562273196*^9, {3.770981597932929*^9, 
   3.770981604782627*^9}, {3.7709821387767553`*^9, 3.7709821576086407`*^9}, {
   3.770982202460527*^9, 3.770982202767514*^9}, {3.77098268625275*^9, 
   3.770982724146615*^9}, {3.770982893187273*^9, 3.770982895507979*^9}, {
   3.770982949179625*^9, 3.770982949860483*^9}, {3.7711389640232897`*^9, 
   3.771138996795042*^9}, {3.771139678009183*^9, 3.771139681253922*^9}, {
   3.771139711505148*^9, 3.771139718197137*^9}, {3.771140266242723*^9, 
   3.7711402801712523`*^9}, {3.771234573160223*^9, 3.771234576247919*^9}, {
   3.7790453782528954`*^9, 3.779045425619176*^9}, {3.7790763711444902`*^9, 
   3.779076372527687*^9}, {3.779080400658866*^9, 3.779080417177166*^9}, {
   3.779093001463686*^9, 3.779093012877165*^9}, {3.779132451747096*^9, 
   3.779132451903741*^9}, {3.78167905421262*^9, 3.7816790591864758`*^9}, {
   3.781858765887219*^9, 3.781858768500503*^9}, {3.781858893507841*^9, 
   3.7818589180501623`*^9}, 3.781858968592648*^9, {3.781859020439496*^9, 
   3.781859042239254*^9}, 3.7818594429947987`*^9, {3.781864037272621*^9, 
   3.781864044712007*^9}, {3.781969992136195*^9, 3.781969995797161*^9}, {
   3.78202897837047*^9, 3.782028979881863*^9}, {3.782040949317198*^9, 
   3.782040958595056*^9}, 3.782047378521851*^9, {3.782047741561439*^9, 
   3.7820477894554*^9}, {3.782050918112599*^9, 3.782050918255136*^9}, {
   3.782051029102474*^9, 3.7820510312687397`*^9}, {3.791314083525609*^9, 
   3.7913140836592817`*^9}, {3.8075559880198317`*^9, 3.80755599285363*^9}, {
   3.8077945286288652`*^9, 3.807794528884687*^9}, 3.8079808829000273`*^9, 
   3.8079809464984694`*^9, {3.807985114930189*^9, 3.8079851150776443`*^9}, 
   3.8079851605194893`*^9, {3.80798604159761*^9, 3.807986062394533*^9}, {
   3.807986123384762*^9, 3.80798612962399*^9}, {3.808022204803491*^9, 
   3.808022238975625*^9}, {3.808022340944427*^9, 3.808022341087328*^9}, {
   3.808028051709012*^9, 3.808028052087212*^9}, {3.8080387454139853`*^9, 
   3.808038749009458*^9}, {3.808038928309635*^9, 3.8080389292046947`*^9}, {
   3.808124213406165*^9, 3.8081242645581207`*^9}, {3.808124294874939*^9, 
   3.8081242985778847`*^9}},
 CellLabel->
  "In[913]:=",ExpressionUUID->"92ecd498-fb65-4f5c-bc2e-593cc692964a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[923]:=",ExpressionUUID->"56cb3994-f76b-4794-9e5b-318901f6a005"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SynthesiseStructure", "[", 
   RowBox[{"blocks_List", ",", 
    RowBox[{"{", 
     RowBox[{"A_Integer", ",", "B_Integer", ",", "C_Integer"}], "}"}], ",", 
    "outputName_String", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"selectionMethod", "=", 
       RowBox[{"OptionValue", "[", "\"\<SelectionMethod\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "domains", ",", "mapping", ",", "options"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"InputCheck", "[", 
           RowBox[{"\"\<CrystalEntityQ\>\"", ",", "#"}], "]"}], "&"}], ",", 
         RowBox[{"DeleteDuplicates", "@", "blocks"}]}], "]"}], ",", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "domain", " ", "representation"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"domains", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"selectionMethod", "===", "\"\<Random\>\""}], ",", 
          RowBox[{"RandomChoice", "[", 
           RowBox[{"blocks", ",", 
            RowBox[{"A", "*", "B", "*", "C"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"selectionMethod", "===", "\"\<Sequential\>\""}], ",", "#", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"selectionMethod", "===", "\"\<Shuffled\>\""}], ",", 
          RowBox[{"RandomSample", "@", "#"}], ",", "\[IndentingNewLine]", 
          "True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"SynthesiseStructure", "::", "InvalidSelectionMethod"}], 
             ",", "selectionMethod"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "@", 
       RowBox[{"PadRight", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"A", "*", "B", "*", "C"}], ",", "blocks"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"mapping", "=", 
      RowBox[{"AssociationThread", "[", 
       RowBox[{
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "blocks"}]}], "\[Rule]", "blocks"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Relaying", " ", "data", " ", "to", " ", "separate", " ", "procedure"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"#", "\[Rule]", 
           RowBox[{"OptionValue", "[", "#", "]"}]}], ",", "String"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"First", "/@", 
         RowBox[{"Options", "@", "SynthesiseStructure"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SynthesiseStructure", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", "domains"}], "}"}], 
       ",", "outputName", ",", "mapping", ",", 
       RowBox[{"Sequence", "@@", "options"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.7609498833793907`*^9, 3.76094989465484*^9}, {
   3.760985435505022*^9, 3.760985472615333*^9}, {3.761044721985759*^9, 
   3.7610447510077763`*^9}, {3.76104481522427*^9, 3.761044820157362*^9}, {
   3.76104492312523*^9, 3.76104492561299*^9}, {3.761045245983004*^9, 
   3.7610452901170893`*^9}, {3.761045366668412*^9, 3.761045378723996*^9}, {
   3.76124639061635*^9, 3.761246410336463*^9}, {3.761246468837595*^9, 
   3.761246470395545*^9}, {3.761246673739036*^9, 3.761246692142757*^9}, {
   3.761246756527741*^9, 3.761246831173169*^9}, {3.7612468685554323`*^9, 
   3.761246869827717*^9}, {3.7612469112124767`*^9, 3.761247051614558*^9}, {
   3.761247130070651*^9, 3.7612471343322563`*^9}, {3.761247190774343*^9, 
   3.761247226696908*^9}, {3.7612472608003902`*^9, 3.761247277095755*^9}, {
   3.7612473349529333`*^9, 3.761247347238995*^9}, {3.761247379119833*^9, 
   3.761247382237371*^9}, {3.761247500765175*^9, 3.761247531645439*^9}, {
   3.761247581531475*^9, 3.761247581665276*^9}, {3.76124761695472*^9, 
   3.761247712374427*^9}, {3.7612478775715733`*^9, 3.7612479024911127`*^9}, {
   3.761248027065674*^9, 3.7612480322790403`*^9}, {3.761248133261649*^9, 
   3.761248133821176*^9}, {3.762483079092483*^9, 3.762483079506445*^9}, {
   3.7624831653076982`*^9, 3.762483255155518*^9}, {3.762483448748105*^9, 
   3.762483459337694*^9}, {3.762484937954467*^9, 3.762484940528129*^9}, {
   3.762485478717585*^9, 3.762485519250081*^9}, {3.762485687785385*^9, 
   3.7624856997759*^9}, {3.762485763767784*^9, 3.7624857909884033`*^9}, {
   3.762485821389303*^9, 3.762485821901321*^9}, {3.762485865116181*^9, 
   3.76248587338028*^9}, {3.7624863035622253`*^9, 3.762486306889323*^9}, 
   3.7624864059931593`*^9, {3.762486451749774*^9, 3.762486453088664*^9}, {
   3.762486658295171*^9, 3.762486679735591*^9}, {3.762486914173285*^9, 
   3.762486976278838*^9}, {3.762487161588236*^9, 3.762487164161865*^9}, {
   3.762582301146738*^9, 3.762582302868475*^9}, {3.7625825420446243`*^9, 
   3.7625825422070208`*^9}, 3.7627930931894283`*^9, {3.763708440950055*^9, 
   3.763708444458358*^9}, {3.763795706131096*^9, 3.76379571208855*^9}, {
   3.763795807464473*^9, 3.763795831454368*^9}, {3.767429560180451*^9, 
   3.767429568446164*^9}, 3.770459731594898*^9, 3.77045978949087*^9, {
   3.7704599395191603`*^9, 3.770459942350878*^9}, {3.770460320192504*^9, 
   3.77046034225856*^9}, {3.770460744443172*^9, 3.770460790673462*^9}, {
   3.770462722783415*^9, 3.770462726522499*^9}, {3.770462870041655*^9, 
   3.770462893092216*^9}, {3.770463235775403*^9, 3.770463354490316*^9}, {
   3.770464803344589*^9, 3.7704649431280527`*^9}, {3.7704649769113207`*^9, 
   3.770464999988723*^9}, {3.7704651173818903`*^9, 3.770465120129682*^9}, {
   3.770465209927898*^9, 3.770465248981803*^9}, {3.7704652797498713`*^9, 
   3.770465415928398*^9}, {3.770465537455702*^9, 3.7704655656201468`*^9}, {
   3.770465641152669*^9, 3.770465644794568*^9}, {3.770466103176922*^9, 
   3.7704661912147818`*^9}, {3.7704662256847267`*^9, 3.770466424544442*^9}, {
   3.77046647576213*^9, 3.77046647708055*^9}, {3.7704666316257477`*^9, 
   3.770466663729806*^9}, {3.770569455033873*^9, 3.77056947362365*^9}, {
   3.770569965186427*^9, 3.770569975517632*^9}, {3.770613455882739*^9, 
   3.7706134615311623`*^9}, {3.7706144368471527`*^9, 3.770614455550804*^9}, {
   3.770614642444923*^9, 3.770614648346962*^9}, {3.7706146872518663`*^9, 
   3.770614706809328*^9}, {3.770615780706581*^9, 3.770615837875382*^9}, {
   3.770616067975326*^9, 3.770616161127016*^9}, {3.770616281788673*^9, 
   3.770616338679316*^9}, {3.770616527688498*^9, 3.770616578229919*^9}, {
   3.770617519347665*^9, 3.770617618502255*^9}, {3.770617715683031*^9, 
   3.770617752463728*^9}, {3.770618116138035*^9, 3.7706181296219597`*^9}, {
   3.770618161047112*^9, 3.770618195582769*^9}, {3.77061840921166*^9, 
   3.770618429996653*^9}, {3.7706188774711227`*^9, 3.770618880463545*^9}, {
   3.77061898635938*^9, 3.7706190570356627`*^9}, {3.7706191262161617`*^9, 
   3.770619143850253*^9}, {3.770620393630209*^9, 3.770620411752057*^9}, {
   3.7706205414208717`*^9, 3.770620595073638*^9}, {3.770620635698071*^9, 
   3.770620694965639*^9}, {3.770621285358365*^9, 3.7706213228053513`*^9}, {
   3.770621746590682*^9, 3.770621913127598*^9}, {3.7706250264948063`*^9, 
   3.7706250284066973`*^9}, {3.770625143129756*^9, 3.770625145122254*^9}, {
   3.770625196698786*^9, 3.770625226825259*^9}, {3.770625271797394*^9, 
   3.770625299948307*^9}, {3.770625340917306*^9, 3.7706253455065393`*^9}, {
   3.770625406711595*^9, 3.770625439263268*^9}, {3.770625484959586*^9, 
   3.7706254896638517`*^9}, {3.7706255324719887`*^9, 3.770625536534584*^9}, {
   3.770625601643078*^9, 3.770625660115859*^9}, {3.7706269748593388`*^9, 
   3.770626983180786*^9}, {3.770978748150028*^9, 3.770978844135597*^9}, {
   3.770981565611477*^9, 3.7709815849544163`*^9}, {3.771139352384213*^9, 
   3.771139435725677*^9}, {3.771141989286028*^9, 3.7711419920245047`*^9}, {
   3.771143011683299*^9, 3.771143018616251*^9}, {3.771143059910726*^9, 
   3.771143079334529*^9}, {3.771143112487186*^9, 3.771143118121806*^9}, {
   3.771143199801591*^9, 3.771143243956092*^9}, {3.771143352696369*^9, 
   3.7711433596184072`*^9}, {3.7742037135564613`*^9, 3.77420371903445*^9}, {
   3.7790460331623583`*^9, 3.779046038683786*^9}, {3.7790465556133432`*^9, 
   3.779046557949313*^9}, {3.7790466210358686`*^9, 3.779046629035347*^9}, {
   3.779076173162829*^9, 3.779076186108962*^9}, {3.779076376706129*^9, 
   3.7790764050721207`*^9}, {3.77907707240198*^9, 3.7790770727759323`*^9}, {
   3.779077116904462*^9, 3.7790771363191557`*^9}, {3.779077222030397*^9, 
   3.7790772451963463`*^9}, {3.779077278292552*^9, 3.779077293810793*^9}, {
   3.779077327756048*^9, 3.7790773461225557`*^9}, {3.779077400971356*^9, 
   3.779077401392465*^9}, {3.779078652836025*^9, 3.779078674233534*^9}, {
   3.7790789366442738`*^9, 3.77907905698431*^9}, {3.779080313783312*^9, 
   3.779080335990597*^9}, {3.7790804083883467`*^9, 3.779080409644253*^9}, {
   3.7790805587124434`*^9, 3.7790805924157047`*^9}, {3.779080668254277*^9, 
   3.779080748955948*^9}, 3.779080921313138*^9, {3.7790812563695297`*^9, 
   3.77908127282437*^9}, {3.779081329711192*^9, 3.779081329862935*^9}, {
   3.779081417629828*^9, 3.779081417885152*^9}, {3.7790815112035303`*^9, 
   3.779081567874836*^9}, {3.77908160297834*^9, 3.779081605410418*^9}, 
   3.779081642634364*^9, {3.779081818726289*^9, 3.779081818836506*^9}, {
   3.779081927827957*^9, 3.779081942290485*^9}, 3.7790819834125433`*^9, {
   3.779082026115778*^9, 3.7790820572111673`*^9}, {3.779082093109037*^9, 
   3.7790820934351387`*^9}, {3.779082505418542*^9, 3.779082582504551*^9}, {
   3.779082618161819*^9, 3.779082631974813*^9}, {3.7790833281717787`*^9, 
   3.7790833468169813`*^9}, {3.77908339321735*^9, 3.779083393359188*^9}, {
   3.779092931617548*^9, 3.779092941695651*^9}, 3.779092984373472*^9, 
   3.779093025471065*^9, {3.779093233015196*^9, 3.779093283089419*^9}, {
   3.779093347114683*^9, 3.779093358570322*^9}, {3.779093403195031*^9, 
   3.7790934294666843`*^9}, {3.779093483226296*^9, 3.779093671972971*^9}, {
   3.7790938415876703`*^9, 3.779093852432088*^9}, {3.7790943233708687`*^9, 
   3.77909436834396*^9}, {3.779132230691679*^9, 3.779132232130753*^9}, {
   3.7791322913529873`*^9, 3.779132328976726*^9}, {3.77913238294314*^9, 
   3.7791323831025457`*^9}, {3.779132416197893*^9, 3.779132481875678*^9}, {
   3.77913259690576*^9, 3.7791325984885693`*^9}, {3.779132633232272*^9, 
   3.7791327488973618`*^9}, {3.7791328356007566`*^9, 3.779132910565886*^9}, {
   3.779133291303643*^9, 3.77913350030802*^9}, {3.779133718247943*^9, 
   3.779133783523141*^9}, {3.779133814469346*^9, 3.779133815579176*^9}, {
   3.7791338790756273`*^9, 3.779133927424109*^9}, {3.779134513294778*^9, 
   3.779134564659233*^9}, {3.779134801244445*^9, 3.7791348453220997`*^9}, {
   3.7794598997260113`*^9, 3.779459946548224*^9}, {3.779459993534259*^9, 
   3.779460003612535*^9}, {3.77946003619566*^9, 3.7794600405698*^9}, {
   3.779460177055881*^9, 3.7794601841982183`*^9}, {3.779465818564105*^9, 
   3.779465837840556*^9}, {3.77946587589717*^9, 3.779465898190446*^9}, {
   3.779465943255336*^9, 3.779466009822507*^9}, {3.77946625854605*^9, 
   3.779466264350567*^9}, {3.7794707100815363`*^9, 3.779470791459454*^9}, {
   3.7794708372044983`*^9, 3.7794708430662127`*^9}, {3.7794708736280003`*^9, 
   3.779470889041346*^9}, {3.779471386472715*^9, 3.779471387758445*^9}, {
   3.7794727024761457`*^9, 3.779472704537242*^9}, {3.7794729380386343`*^9, 
   3.779472947702175*^9}, {3.779473633377185*^9, 3.7794736351008883`*^9}, {
   3.779475306395953*^9, 3.779475308136442*^9}, {3.7795148511524153`*^9, 
   3.7795148554943247`*^9}, {3.7795152637427387`*^9, 3.779515301748084*^9}, {
   3.780041526108283*^9, 3.780041530545414*^9}, 3.780063501754696*^9, 
   3.781596783619473*^9, {3.781596814488657*^9, 3.781596817344576*^9}, {
   3.781597055565585*^9, 3.781597081643642*^9}, {3.781597372942129*^9, 
   3.781597449355983*^9}, 3.781597759959477*^9, {3.7815996008325872`*^9, 
   3.7815996024712973`*^9}, {3.781599723813806*^9, 3.781599730684422*^9}, {
   3.781600289730597*^9, 3.78160029352064*^9}, 3.781600331425515*^9, {
   3.781600542107935*^9, 3.7816005503132753`*^9}, {3.781606643808066*^9, 
   3.781606646222434*^9}, {3.781606763687199*^9, 3.7816067643638144`*^9}, {
   3.7816072419548883`*^9, 3.7816072436566353`*^9}, {3.781607906428276*^9, 
   3.781607907481904*^9}, {3.781607965811386*^9, 3.7816080279750423`*^9}, {
   3.7816080690164967`*^9, 3.781608114413293*^9}, {3.781608198188738*^9, 
   3.781608281394578*^9}, {3.781609293939601*^9, 3.781609309321006*^9}, {
   3.781609476678388*^9, 3.7816094801574097`*^9}, 3.781609556669264*^9, {
   3.781609683361212*^9, 3.781609686256384*^9}, {3.78161226738934*^9, 
   3.78161233215441*^9}, {3.781612442856462*^9, 3.781612470687945*^9}, {
   3.781612593701033*^9, 3.781612631084622*^9}, 3.781614972562765*^9, {
   3.78161524014813*^9, 3.781615240681616*^9}, {3.781615280010507*^9, 
   3.781615290704727*^9}, {3.78161541399857*^9, 3.781615425909526*^9}, {
   3.7816154736611433`*^9, 3.781615539875*^9}, {3.7816155713078127`*^9, 
   3.781615571498477*^9}, {3.781615747215444*^9, 3.781615757366866*^9}, {
   3.781615873272184*^9, 3.7816158734864397`*^9}, {3.7816171015648518`*^9, 
   3.781617130618442*^9}, {3.7816172619773083`*^9, 3.781617263519547*^9}, {
   3.781617481461182*^9, 3.781617482962484*^9}, 3.781617575922841*^9, {
   3.781618101416605*^9, 3.781618102797927*^9}, 3.781618141367907*^9, 
   3.781618245733841*^9, {3.781618387001913*^9, 3.7816183961276197`*^9}, {
   3.7816184695118313`*^9, 3.7816184704617167`*^9}, {3.781618615076729*^9, 
   3.7816186336349707`*^9}, 3.781618678844316*^9, {3.781619582992181*^9, 
   3.7816195836770267`*^9}, {3.7816199327591677`*^9, 3.78161993293364*^9}, {
   3.781619983269676*^9, 3.781619984443877*^9}, {3.781620183776043*^9, 
   3.78162019139979*^9}, {3.781620291456691*^9, 3.781620313028677*^9}, 
   3.781620348773815*^9, 3.781620746029769*^9, {3.78162638436092*^9, 
   3.781626425862638*^9}, {3.781626476431323*^9, 3.781626557691691*^9}, {
   3.781626623884338*^9, 3.781626653401774*^9}, {3.781626729226215*^9, 
   3.781626757215386*^9}, {3.7816268006405373`*^9, 3.7816268463655767`*^9}, 
   3.7816286423998957`*^9, {3.781675057590191*^9, 3.781675076043709*^9}, {
   3.781675556202602*^9, 3.781675642120433*^9}, {3.7816760877603693`*^9, 
   3.781676088950032*^9}, {3.781676158959507*^9, 3.7816762177647467`*^9}, {
   3.781676248133177*^9, 3.781676258405087*^9}, {3.7816790865172863`*^9, 
   3.781679095989188*^9}, {3.7816840064262733`*^9, 3.781684015497168*^9}, {
   3.7816842035970383`*^9, 3.781684203932811*^9}, {3.781684438728621*^9, 
   3.781684441383614*^9}, {3.781684490448798*^9, 3.781684518917966*^9}, {
   3.781684556016069*^9, 3.781684566372897*^9}, {3.781684623556603*^9, 
   3.781684624251807*^9}, {3.7816853526858253`*^9, 3.781685376699265*^9}, {
   3.7816855053767853`*^9, 3.7816855065285807`*^9}, {3.7816855453693533`*^9, 
   3.781685567511063*^9}, {3.781685858875183*^9, 3.78168589982563*^9}, 
   3.781686268609694*^9, {3.781686319248898*^9, 3.7816863194304667`*^9}, {
   3.781686558594583*^9, 3.7816865697534018`*^9}, {3.781859099531748*^9, 
   3.781859156506374*^9}, 3.781859387281911*^9, {3.7818640218257923`*^9, 
   3.781864056813308*^9}, {3.782028552703998*^9, 3.782028587020403*^9}, {
   3.782028941257493*^9, 3.782028942348991*^9}, {3.782029000341112*^9, 
   3.782029035539669*^9}, {3.782029162657709*^9, 3.7820292105949497`*^9}, {
   3.782029266088305*^9, 3.782029294559512*^9}, 3.782030123182132*^9, {
   3.78203020980309*^9, 3.782030213682626*^9}, {3.782030596516942*^9, 
   3.782030597130456*^9}, {3.782030825094961*^9, 3.782030845981477*^9}, {
   3.782032369880467*^9, 3.78203237584664*^9}, {3.782032586572319*^9, 
   3.782032587257971*^9}, {3.782032630824499*^9, 3.782032655001327*^9}, {
   3.7820328091188374`*^9, 3.782032812029166*^9}, {3.782033252832946*^9, 
   3.782033285918296*^9}, {3.7820338684922333`*^9, 3.782033877553089*^9}, {
   3.782033917594111*^9, 3.782033928808517*^9}, {3.782034734097344*^9, 
   3.782034736176887*^9}, {3.782038710823208*^9, 3.782038745308548*^9}, {
   3.7820388946504107`*^9, 3.782038914773587*^9}, {3.782039126909801*^9, 
   3.782039140700597*^9}, {3.782040320476921*^9, 3.7820403474826803`*^9}, {
   3.782040796362956*^9, 3.782040799889357*^9}, {3.7820408459531097`*^9, 
   3.7820408674393263`*^9}, {3.782041161235155*^9, 3.782041162649029*^9}, {
   3.782041636816414*^9, 3.782041637030972*^9}, {3.7820417197994337`*^9, 
   3.78204175356588*^9}, {3.782042230212246*^9, 3.782042234657852*^9}, {
   3.782044974967266*^9, 3.782044975926011*^9}, {3.782045012869179*^9, 
   3.782045015749069*^9}, {3.786968107875774*^9, 3.7869681094012403`*^9}, {
   3.787056554199849*^9, 3.787056555523633*^9}, {3.788609407354669*^9, 
   3.788609407494788*^9}, {3.791142727552059*^9, 3.791142766541518*^9}, {
   3.802424609083229*^9, 3.80242461574144*^9}, {3.802435083623476*^9, 
   3.8024350866046457`*^9}, {3.802435137201668*^9, 3.802435329055068*^9}, {
   3.807556036653221*^9, 3.807556036798704*^9}, {3.807785837797971*^9, 
   3.807785854932773*^9}, {3.807795029663434*^9, 3.807795064523724*^9}, {
   3.8079883171453457`*^9, 3.807988362932564*^9}, 3.807988393366549*^9, {
   3.807988525964985*^9, 3.807988526581459*^9}, 3.808025545928755*^9, {
   3.808028003520382*^9, 3.808028003631009*^9}, {3.8080287474877768`*^9, 
   3.8080287492778187`*^9}, {3.808029375738481*^9, 3.808029397473055*^9}, {
   3.808029834119051*^9, 3.80802986472153*^9}, {3.808030307912801*^9, 
   3.808030311874086*^9}, {3.8080305707834787`*^9, 3.808030577901491*^9}, {
   3.808030682715707*^9, 3.808030741296678*^9}, {3.8080308063442297`*^9, 
   3.8080308323947277`*^9}, {3.8080308751910477`*^9, 
   3.8080309783627243`*^9}, {3.808031094868038*^9, 3.8080311304696074`*^9}, {
   3.80803116398137*^9, 3.808031164129162*^9}, {3.808031198780347*^9, 
   3.8080312134544563`*^9}, {3.808031266380938*^9, 3.808031268932006*^9}, {
   3.808031413992852*^9, 3.808031429931551*^9}, {3.808031769073473*^9, 
   3.80803183225016*^9}, {3.808031886416011*^9, 3.8080319621551027`*^9}, {
   3.808032579993999*^9, 3.8080325827953587`*^9}, {3.808032616111496*^9, 
   3.808032676212798*^9}, {3.80803291810262*^9, 3.80803299199509*^9}, {
   3.808033024919505*^9, 3.808033028458866*^9}, {3.808033342184329*^9, 
   3.808033370858501*^9}, {3.808033480912395*^9, 3.8080334897420177`*^9}, {
   3.8080389381032124`*^9, 3.808038947389132*^9}, {3.808039747357609*^9, 
   3.808039748852303*^9}, 3.8080398499230127`*^9, {3.8081252193013906`*^9, 
   3.808125241058667*^9}, {3.808157664841095*^9, 3.8081576650067673`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[924]:=",ExpressionUUID->"f390dd4d-4a23-4d7a-82b8-85a4cfecbc7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SynthesiseStructure", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "inputA_Integer", ",", "inputB_Integer", ",", "inputC_Integer"}], 
       "}"}], ",", "inputDomains_List"}], "}"}], ",", "\[IndentingNewLine]", 
    "outputName_String", ",", "\[IndentingNewLine]", 
    RowBox[{"integerToLabelMap_Association", ":", 
     RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"domains", "=", "inputDomains"}], ",", "\[IndentingNewLine]", 
      RowBox[{"A", "=", "inputA"}], ",", 
      RowBox[{"B", "=", "inputB"}], ",", 
      RowBox[{"C", "=", "inputC"}], ",", "\[IndentingNewLine]", "blocks", ",",
       "nonVoidRange", ",", "normalBlocks", ",", "\[IndentingNewLine]", 
      "blockSizes", ",", "\[IndentingNewLine]", "outputSize", ",", 
      "targetPositions", ",", "blockPositionsMap", ",", "blockCopy", ",", 
      "blockCopies", ",", "\[IndentingNewLine]", "coordinatesCrystal", ",", 
      "coordinatesCartesian", ",", "coordinatesCrystalEmbedded", ",", 
      "newCoordinates", ",", "\[IndentingNewLine]", "hostM", ",", 
      "hostMinverse", ",", "targetPositionsCartesian", ",", "M", ",", "T", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"anchorShift", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAnchorShift\>\"", "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"anchorReference", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAnchorReference\>\"", "]"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"rotationAxes", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAxes\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rotationMap", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationMap\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "R", ",", "twist"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<Padding\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", "domains"}], "}"}], 
        "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<PadDomain\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", "inputDomains"}], 
           "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"blocks", "=", 
      RowBox[{"domains", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", "\"\<Void\>\""}], "}"}], ",", 
         RowBox[{"Normal", "@", "integerToLabelMap"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"blocks", "=", 
      RowBox[{"blocks", "/.", 
       RowBox[{"_Integer", "\[Rule]", "\"\<Void\>\""}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"InputCheck", "[", 
           RowBox[{"\"\<CrystalEntityQ\>\"", ",", "#"}], "]"}], "&"}], ",", 
         RowBox[{"DeleteDuplicates", "@", "blocks"}]}], "]"}], ",", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Handling", " ", "special", " ", "labels", " ", 
       RowBox[{"(", 
        RowBox[{"chemcial", " ", "elements", " ", "or", " ", "void"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<HandleSpecialLabels\>\"", ",", "blocks"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nonVoidRange", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"A", "*", "B", "*", "C"}], "]"}], ",", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", 
          RowBox[{"blocks", ",", "\"\<Void\>\""}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"normalBlocks", "=", 
      RowBox[{"Part", "[", 
       RowBox[{"blocks", ",", "nonVoidRange"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"normalBlocks", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SynthesiseStructure", "::", "NothingToBuild"}], "]"}], ";", 
        
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Checking", " ", "if", " ", "all", " ", "blocks", " ", "have", " ", 
       "same", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"blockSizes", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"$CrystalData", "[", 
           RowBox[{"#", ",", "\"\<Notes\>\"", ",", "\"\<StructureSize\>\""}], 
           "]"}], "\[IndentingNewLine]", "/.", 
          RowBox[{"_Missing", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], ")"}], "&"}], "/@", 
       "blocks"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"SameQ", "@@", "blockSizes"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SynthesiseStructure", "::", "DifferentBlockSizes"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"blockSizes", "=", 
      RowBox[{"First", "@", "blockSizes"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Checking", " ", "if", " ", "output", " ", "size", " ", "is", " ", 
       "valid"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"outputSize", "=", 
      RowBox[{"{", 
       RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "*", "B", "*", "C"}], "\[NotEqual]", 
        RowBox[{"Length", "@", "domains"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SynthesiseStructure", "::", "SizeError"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "@", "outputSize"}], "\[NotEqual]", "3"}], ")"}], 
        "||", 
        RowBox[{"(", 
         RowBox[{"AnyTrue", "[", 
          RowBox[{"outputSize", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Positive", "[", "#", "]"}], "\[Nand]", 
             RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}]}], "]"}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SynthesiseStructure", "::", "InvalidOutputSize"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "@", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Mod", ",", 
           RowBox[{"{", 
            RowBox[{"outputSize", ",", "blockSizes"}], "}"}]}], "]"}]}], "=!=",
         "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SynthesiseStructure", "::", "IncompatibleOutputSize"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Final", " ", "preparations", " ", "before", " ", "synthesis"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"targetPositions", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GenerateTargetPositions\>\"", ",", "outputSize"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"blockPositionsMap", "=", 
      RowBox[{"AssociationThread", "[", 
       RowBox[{"targetPositions", "\[Rule]", "blocks"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"$CrystalData", ",", 
       RowBox[{"outputName", "\[Rule]", 
        RowBox[{"$CrystalData", "@", 
         RowBox[{"First", "@", "normalBlocks"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hostM", "=", 
      RowBox[{"GetCrystalMetric", "[", 
       RowBox[{"outputName", ",", 
        RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hostMinverse", "=", 
      RowBox[{"Inverse", "@", "hostM"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"targetPositionsCartesian", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"hostM", ".", "#"}], "&"}], "/@", "targetPositions"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rotationMap", "=!=", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<RotationTransformation\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"outputSize", ",", "domains"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "anchorShift", ",", "anchorReference", ",", "rotationMap", ",", 
            "rotationAxes"}], "}"}], ",", "True"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"blockCopies", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "=", 
            RowBox[{"GetCrystalMetric", "[", 
             RowBox[{
              RowBox[{
              "blocks", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"T", "=", 
            RowBox[{"TranslationTransform", "[", 
             RowBox[{
             "targetPositions", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"blockCopy", "=", 
            RowBox[{"$CrystalData", "[", 
             RowBox[{
             "blocks", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"coordinatesCrystal", "=", 
            RowBox[{"blockCopy", "\[LeftDoubleBracket]", 
             RowBox[{
             "\"\<AtomData\>\"", ",", "All", ",", 
              "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"coordinatesCartesian", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"M", ".", "#"}], "&"}], "/@", "coordinatesCrystal"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"coordinatesCrystalEmbedded", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"hostMinverse", ".", "#"}], "&"}], "/@", 
             "coordinatesCartesian"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"newCoordinates", "=", 
            RowBox[{"T", "/@", "coordinatesCrystalEmbedded"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rotationMap", "=!=", 
              RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"twist", "=", 
               RowBox[{"R", "[", 
                RowBox[{
                 RowBox[{
                 "domains", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "targetPositionsCartesian", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"coordinatesCartesian", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"hostM", ".", "#"}], "&"}], "/@", 
                "newCoordinates"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"coordinatesCartesian", "=", 
               RowBox[{"twist", "@", "coordinatesCartesian"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newCoordinates", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"hostMinverse", ".", "#"}], "&"}], "/@", 
                "coordinatesCartesian"}]}]}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"blockCopy", "\[LeftDoubleBracket]", 
             RowBox[{
             "\"\<AtomData\>\"", ",", "All", ",", 
              "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}], 
            "=", "newCoordinates"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Sow", "@", "blockCopy"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nonVoidRange"}], "}"}]}], "\[IndentingNewLine]",
          "]"}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"$CrystalData", "[", 
       RowBox[{"outputName", ",", "\"\<AtomData\>\""}], "]"}], "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"blockCopies", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "\"\<AtomData\>\""}], 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{
          RowBox[{"$CrystalData", "[", "outputName", "]"}], ",", 
          "\"\<Notes\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "outputName", "]"}], ",", 
         RowBox[{"\"\<Notes\>\"", "\[Rule]", 
          RowBox[{"<|", "|>"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"$CrystalData", "[", 
       RowBox[{
       "outputName", ",", "\"\<Notes\>\"", ",", "\"\<StructureSize\>\""}], 
       "]"}], "=", "outputSize"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "outputName"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9, {3.7455680832964697`*^9, 
   3.745568119889543*^9}, {3.747569432494769*^9, 3.747569442874075*^9}, {
   3.74756949426586*^9, 3.747569500574552*^9}, {3.7475695377399282`*^9, 
   3.7475695465343924`*^9}, {3.7475699175021257`*^9, 3.747569978808453*^9}, {
   3.747570081604307*^9, 3.7475700987875013`*^9}, {3.747570851329288*^9, 
   3.747570860993803*^9}, {3.747570941533657*^9, 3.747570947293482*^9}, {
   3.747570979528742*^9, 3.747570979833435*^9}, {3.7475710460233097`*^9, 
   3.747571047925109*^9}, {3.747571084476077*^9, 3.747571086328722*^9}, {
   3.747571371903867*^9, 3.7475713729193487`*^9}, {3.747571561267179*^9, 
   3.747571562589777*^9}, {3.747572757880087*^9, 3.747572827753377*^9}, {
   3.747572862364382*^9, 3.747572879792859*^9}, {3.759519240146062*^9, 
   3.759519241328768*^9}, {3.7609498833793907`*^9, 3.76094989465484*^9}, {
   3.760985435505022*^9, 3.760985472615333*^9}, {3.761044721985759*^9, 
   3.7610447510077763`*^9}, {3.76104481522427*^9, 3.761044820157362*^9}, {
   3.76104492312523*^9, 3.76104492561299*^9}, {3.761045245983004*^9, 
   3.7610452901170893`*^9}, {3.761045366668412*^9, 3.761045378723996*^9}, {
   3.76124639061635*^9, 3.761246410336463*^9}, {3.761246468837595*^9, 
   3.761246470395545*^9}, {3.761246673739036*^9, 3.761246692142757*^9}, {
   3.761246756527741*^9, 3.761246831173169*^9}, {3.7612468685554323`*^9, 
   3.761246869827717*^9}, {3.7612469112124767`*^9, 3.761247051614558*^9}, {
   3.761247130070651*^9, 3.7612471343322563`*^9}, {3.761247190774343*^9, 
   3.761247226696908*^9}, {3.7612472608003902`*^9, 3.761247277095755*^9}, {
   3.7612473349529333`*^9, 3.761247347238995*^9}, {3.761247379119833*^9, 
   3.761247382237371*^9}, {3.761247500765175*^9, 3.761247531645439*^9}, {
   3.761247581531475*^9, 3.761247581665276*^9}, {3.76124761695472*^9, 
   3.761247712374427*^9}, {3.7612478775715733`*^9, 3.7612479024911127`*^9}, {
   3.761248027065674*^9, 3.7612480322790403`*^9}, {3.761248133261649*^9, 
   3.761248133821176*^9}, {3.762483079092483*^9, 3.762483079506445*^9}, {
   3.7624831653076982`*^9, 3.762483255155518*^9}, {3.762483448748105*^9, 
   3.762483459337694*^9}, {3.762484937954467*^9, 3.762484940528129*^9}, {
   3.762485478717585*^9, 3.762485519250081*^9}, {3.762485687785385*^9, 
   3.7624856997759*^9}, {3.762485763767784*^9, 3.7624857909884033`*^9}, {
   3.762485821389303*^9, 3.762485821901321*^9}, {3.762485865116181*^9, 
   3.76248587338028*^9}, {3.7624863035622253`*^9, 3.762486306889323*^9}, 
   3.7624864059931593`*^9, {3.762486451749774*^9, 3.762486453088664*^9}, {
   3.762486658295171*^9, 3.762486679735591*^9}, {3.762486914173285*^9, 
   3.762486976278838*^9}, {3.762487161588236*^9, 3.762487164161865*^9}, {
   3.762582301146738*^9, 3.762582302868475*^9}, {3.7625825420446243`*^9, 
   3.7625825422070208`*^9}, 3.7627930931894283`*^9, {3.763708440950055*^9, 
   3.763708444458358*^9}, {3.763795706131096*^9, 3.76379571208855*^9}, {
   3.763795807464473*^9, 3.763795831454368*^9}, {3.767429560180451*^9, 
   3.767429568446164*^9}, 3.770459731594898*^9, 3.77045978949087*^9, {
   3.7704599395191603`*^9, 3.770459942350878*^9}, {3.770460320192504*^9, 
   3.77046034225856*^9}, {3.770460744443172*^9, 3.770460790673462*^9}, {
   3.770462722783415*^9, 3.770462726522499*^9}, {3.770462870041655*^9, 
   3.770462893092216*^9}, {3.770463235775403*^9, 3.770463354490316*^9}, {
   3.770464803344589*^9, 3.7704649431280527`*^9}, {3.7704649769113207`*^9, 
   3.770464999988723*^9}, {3.7704651173818903`*^9, 3.770465120129682*^9}, {
   3.770465209927898*^9, 3.770465248981803*^9}, {3.7704652797498713`*^9, 
   3.770465415928398*^9}, {3.770465537455702*^9, 3.7704655656201468`*^9}, {
   3.770465641152669*^9, 3.770465644794568*^9}, {3.770466103176922*^9, 
   3.7704661912147818`*^9}, {3.7704662256847267`*^9, 3.770466424544442*^9}, {
   3.77046647576213*^9, 3.77046647708055*^9}, {3.7704666316257477`*^9, 
   3.770466663729806*^9}, {3.770569455033873*^9, 3.77056947362365*^9}, {
   3.770569965186427*^9, 3.770569975517632*^9}, {3.770613455882739*^9, 
   3.7706134615311623`*^9}, {3.7706144368471527`*^9, 3.770614455550804*^9}, {
   3.770614642444923*^9, 3.770614648346962*^9}, {3.7706146872518663`*^9, 
   3.770614706809328*^9}, {3.770615780706581*^9, 3.770615837875382*^9}, {
   3.770616067975326*^9, 3.770616161127016*^9}, {3.770616281788673*^9, 
   3.770616338679316*^9}, {3.770616527688498*^9, 3.770616578229919*^9}, {
   3.770617519347665*^9, 3.770617618502255*^9}, {3.770617715683031*^9, 
   3.770617752463728*^9}, {3.770618116138035*^9, 3.7706181296219597`*^9}, {
   3.770618161047112*^9, 3.770618195582769*^9}, {3.77061840921166*^9, 
   3.770618429996653*^9}, {3.7706188774711227`*^9, 3.770618880463545*^9}, {
   3.77061898635938*^9, 3.7706190570356627`*^9}, {3.7706191262161617`*^9, 
   3.770619143850253*^9}, {3.770620393630209*^9, 3.770620411752057*^9}, {
   3.7706205414208717`*^9, 3.770620595073638*^9}, {3.770620635698071*^9, 
   3.770620694965639*^9}, {3.770621285358365*^9, 3.7706213228053513`*^9}, {
   3.770621746590682*^9, 3.770621913127598*^9}, {3.7706250264948063`*^9, 
   3.7706250284066973`*^9}, {3.770625143129756*^9, 3.770625145122254*^9}, {
   3.770625196698786*^9, 3.770625226825259*^9}, {3.770625271797394*^9, 
   3.770625299948307*^9}, {3.770625340917306*^9, 3.7706253455065393`*^9}, {
   3.770625406711595*^9, 3.770625439263268*^9}, {3.770625484959586*^9, 
   3.7706254896638517`*^9}, {3.7706255324719887`*^9, 3.770625536534584*^9}, {
   3.770625601643078*^9, 3.770625660115859*^9}, {3.7706269748593388`*^9, 
   3.770626983180786*^9}, {3.770978748150028*^9, 3.770978844135597*^9}, {
   3.770981565611477*^9, 3.7709815849544163`*^9}, {3.771139352384213*^9, 
   3.771139435725677*^9}, {3.771141989286028*^9, 3.7711419920245047`*^9}, {
   3.771143011683299*^9, 3.771143018616251*^9}, {3.771143059910726*^9, 
   3.771143079334529*^9}, {3.771143112487186*^9, 3.771143118121806*^9}, {
   3.771143199801591*^9, 3.771143243956092*^9}, {3.771143352696369*^9, 
   3.7711433596184072`*^9}, {3.7742037135564613`*^9, 3.77420371903445*^9}, {
   3.7790460331623583`*^9, 3.779046038683786*^9}, {3.7790465556133432`*^9, 
   3.779046557949313*^9}, {3.7790466210358686`*^9, 3.779046629035347*^9}, {
   3.779076173162829*^9, 3.779076186108962*^9}, {3.779076376706129*^9, 
   3.7790764050721207`*^9}, {3.77907707240198*^9, 3.7790770727759323`*^9}, {
   3.779077116904462*^9, 3.7790771363191557`*^9}, {3.779077222030397*^9, 
   3.7790772451963463`*^9}, {3.779077278292552*^9, 3.779077293810793*^9}, {
   3.779077327756048*^9, 3.7790773461225557`*^9}, {3.779077400971356*^9, 
   3.779077401392465*^9}, {3.779078652836025*^9, 3.779078674233534*^9}, {
   3.7790789366442738`*^9, 3.77907905698431*^9}, {3.779080313783312*^9, 
   3.779080335990597*^9}, {3.7790804083883467`*^9, 3.779080409644253*^9}, {
   3.7790805587124434`*^9, 3.7790805924157047`*^9}, {3.779080668254277*^9, 
   3.779080748955948*^9}, 3.779080921313138*^9, {3.7790812563695297`*^9, 
   3.77908127282437*^9}, {3.779081329711192*^9, 3.779081329862935*^9}, {
   3.779081417629828*^9, 3.779081417885152*^9}, {3.7790815112035303`*^9, 
   3.779081567874836*^9}, {3.77908160297834*^9, 3.779081605410418*^9}, 
   3.779081642634364*^9, {3.779081818726289*^9, 3.779081818836506*^9}, {
   3.779081927827957*^9, 3.779081942290485*^9}, 3.7790819834125433`*^9, {
   3.779082026115778*^9, 3.7790820572111673`*^9}, {3.779082093109037*^9, 
   3.7790820934351387`*^9}, {3.779082505418542*^9, 3.779082582504551*^9}, {
   3.779082618161819*^9, 3.779082631974813*^9}, {3.7790833281717787`*^9, 
   3.7790833468169813`*^9}, {3.77908339321735*^9, 3.779083393359188*^9}, {
   3.779092931617548*^9, 3.779092941695651*^9}, 3.779092984373472*^9, 
   3.779093025471065*^9, {3.779093233015196*^9, 3.779093283089419*^9}, {
   3.779093347114683*^9, 3.779093358570322*^9}, {3.779093403195031*^9, 
   3.7790934294666843`*^9}, {3.779093483226296*^9, 3.779093671972971*^9}, {
   3.7790938415876703`*^9, 3.779093852432088*^9}, {3.7790943233708687`*^9, 
   3.77909436834396*^9}, {3.779132230691679*^9, 3.779132232130753*^9}, {
   3.7791322913529873`*^9, 3.779132328976726*^9}, {3.77913238294314*^9, 
   3.7791323831025457`*^9}, {3.779132416197893*^9, 3.779132481875678*^9}, {
   3.77913259690576*^9, 3.7791325984885693`*^9}, {3.779132633232272*^9, 
   3.7791327488973618`*^9}, {3.7791328356007566`*^9, 3.779132910565886*^9}, {
   3.779133291303643*^9, 3.77913350030802*^9}, {3.779133718247943*^9, 
   3.779133783523141*^9}, {3.779133814469346*^9, 3.779133815579176*^9}, {
   3.7791338790756273`*^9, 3.779133927424109*^9}, {3.779134513294778*^9, 
   3.779134564659233*^9}, {3.779134801244445*^9, 3.7791348453220997`*^9}, {
   3.7794598997260113`*^9, 3.779459946548224*^9}, {3.779459993534259*^9, 
   3.779460003612535*^9}, {3.77946003619566*^9, 3.7794600405698*^9}, {
   3.779460177055881*^9, 3.7794601841982183`*^9}, {3.779465818564105*^9, 
   3.779465837840556*^9}, {3.77946587589717*^9, 3.779465898190446*^9}, {
   3.779465943255336*^9, 3.779466009822507*^9}, {3.77946625854605*^9, 
   3.779466264350567*^9}, {3.7794707100815363`*^9, 3.779470791459454*^9}, {
   3.7794708372044983`*^9, 3.7794708430662127`*^9}, {3.7794708736280003`*^9, 
   3.779470889041346*^9}, {3.779471386472715*^9, 3.779471387758445*^9}, {
   3.7794727024761457`*^9, 3.779472704537242*^9}, {3.7794729380386343`*^9, 
   3.779472947702175*^9}, {3.779473633377185*^9, 3.7794736351008883`*^9}, {
   3.779475306395953*^9, 3.779475308136442*^9}, {3.7795148511524153`*^9, 
   3.7795148554943247`*^9}, {3.7795152637427387`*^9, 3.779515301748084*^9}, {
   3.780041526108283*^9, 3.780041530545414*^9}, 3.780063501754696*^9, 
   3.781596783619473*^9, {3.781596814488657*^9, 3.781596817344576*^9}, {
   3.781597055565585*^9, 3.781597081643642*^9}, {3.781597372942129*^9, 
   3.781597449355983*^9}, 3.781597759959477*^9, {3.7815996008325872`*^9, 
   3.7815996024712973`*^9}, {3.781599723813806*^9, 3.781599730684422*^9}, {
   3.781600289730597*^9, 3.78160029352064*^9}, 3.781600331425515*^9, {
   3.781600542107935*^9, 3.7816005503132753`*^9}, {3.781606643808066*^9, 
   3.781606646222434*^9}, {3.781606763687199*^9, 3.7816067643638144`*^9}, {
   3.7816072419548883`*^9, 3.7816072436566353`*^9}, {3.781607906428276*^9, 
   3.781607907481904*^9}, {3.781607965811386*^9, 3.7816080279750423`*^9}, {
   3.7816080690164967`*^9, 3.781608114413293*^9}, {3.781608198188738*^9, 
   3.781608281394578*^9}, {3.781609293939601*^9, 3.781609309321006*^9}, {
   3.781609476678388*^9, 3.7816094801574097`*^9}, 3.781609556669264*^9, {
   3.781609683361212*^9, 3.781609686256384*^9}, {3.78161226738934*^9, 
   3.78161233215441*^9}, {3.781612442856462*^9, 3.781612470687945*^9}, {
   3.781612593701033*^9, 3.781612631084622*^9}, 3.781614972562765*^9, {
   3.78161524014813*^9, 3.781615240681616*^9}, {3.781615280010507*^9, 
   3.781615290704727*^9}, {3.78161541399857*^9, 3.781615425909526*^9}, {
   3.7816154736611433`*^9, 3.781615539875*^9}, {3.7816155713078127`*^9, 
   3.781615571498477*^9}, {3.781615747215444*^9, 3.781615757366866*^9}, {
   3.781615873272184*^9, 3.7816158734864397`*^9}, {3.7816171015648518`*^9, 
   3.781617130618442*^9}, {3.7816172619773083`*^9, 3.781617263519547*^9}, {
   3.781617481461182*^9, 3.781617482962484*^9}, 3.781617575922841*^9, {
   3.781618101416605*^9, 3.781618102797927*^9}, 3.781618141367907*^9, 
   3.781618245733841*^9, {3.781618387001913*^9, 3.7816183961276197`*^9}, {
   3.7816184695118313`*^9, 3.7816184704617167`*^9}, {3.781618615076729*^9, 
   3.7816186336349707`*^9}, 3.781618678844316*^9, {3.781619582992181*^9, 
   3.7816195836770267`*^9}, {3.7816199327591677`*^9, 3.78161993293364*^9}, {
   3.781619983269676*^9, 3.781619984443877*^9}, {3.781620183776043*^9, 
   3.78162019139979*^9}, {3.781620291456691*^9, 3.781620313028677*^9}, 
   3.781620348773815*^9, 3.781620746029769*^9, {3.78162638436092*^9, 
   3.781626425862638*^9}, {3.781626476431323*^9, 3.781626557691691*^9}, {
   3.781626623884338*^9, 3.781626653401774*^9}, {3.781626729226215*^9, 
   3.781626757215386*^9}, {3.7816268006405373`*^9, 3.7816268463655767`*^9}, 
   3.7816286423998957`*^9, {3.781675057590191*^9, 3.781675076043709*^9}, {
   3.781675556202602*^9, 3.781675642120433*^9}, {3.7816760877603693`*^9, 
   3.781676088950032*^9}, {3.781676158959507*^9, 3.7816762177647467`*^9}, {
   3.781676248133177*^9, 3.781676258405087*^9}, {3.7816790865172863`*^9, 
   3.781679095989188*^9}, {3.7816840064262733`*^9, 3.781684015497168*^9}, {
   3.7816842035970383`*^9, 3.781684203932811*^9}, {3.781684438728621*^9, 
   3.781684441383614*^9}, {3.781684490448798*^9, 3.781684518917966*^9}, {
   3.781684556016069*^9, 3.781684566372897*^9}, {3.781684623556603*^9, 
   3.781684624251807*^9}, {3.7816853526858253`*^9, 3.781685376699265*^9}, {
   3.7816855053767853`*^9, 3.7816855065285807`*^9}, {3.7816855453693533`*^9, 
   3.781685567511063*^9}, {3.781685858875183*^9, 3.78168589982563*^9}, 
   3.781686268609694*^9, {3.781686319248898*^9, 3.7816863194304667`*^9}, {
   3.781686558594583*^9, 3.7816865697534018`*^9}, {3.781859099531748*^9, 
   3.781859156506374*^9}, 3.781859387281911*^9, {3.7818640218257923`*^9, 
   3.781864056813308*^9}, {3.782028552703998*^9, 3.782028587020403*^9}, {
   3.782028941257493*^9, 3.782028942348991*^9}, {3.782029000341112*^9, 
   3.782029035539669*^9}, {3.782029162657709*^9, 3.7820292105949497`*^9}, {
   3.782029266088305*^9, 3.782029294559512*^9}, 3.782030123182132*^9, {
   3.78203020980309*^9, 3.782030213682626*^9}, {3.782030596516942*^9, 
   3.782030597130456*^9}, {3.782030825094961*^9, 3.782030845981477*^9}, {
   3.782032369880467*^9, 3.78203237584664*^9}, {3.782032586572319*^9, 
   3.782032587257971*^9}, {3.782032630824499*^9, 3.782032655001327*^9}, {
   3.7820328091188374`*^9, 3.782032812029166*^9}, {3.782033252832946*^9, 
   3.782033285918296*^9}, {3.7820338684922333`*^9, 3.782033877553089*^9}, {
   3.782033917594111*^9, 3.782033928808517*^9}, {3.782034734097344*^9, 
   3.782034736176887*^9}, {3.782038710823208*^9, 3.782038745308548*^9}, {
   3.7820388946504107`*^9, 3.782038914773587*^9}, {3.782039126909801*^9, 
   3.782039140700597*^9}, {3.782040320476921*^9, 3.7820403474826803`*^9}, {
   3.782040796362956*^9, 3.782040799889357*^9}, {3.7820408459531097`*^9, 
   3.7820408674393263`*^9}, {3.782041161235155*^9, 3.782041162649029*^9}, {
   3.782041636816414*^9, 3.782041637030972*^9}, {3.7820417197994337`*^9, 
   3.78204175356588*^9}, {3.7820421697004538`*^9, 3.7820422139376907`*^9}, 
   3.782045008709709*^9, {3.7820456806005793`*^9, 3.7820457037026443`*^9}, {
   3.782046562755872*^9, 3.782046563643471*^9}, {3.782046618914783*^9, 
   3.782046753279845*^9}, {3.782046797175049*^9, 3.782046797623851*^9}, {
   3.782046830806437*^9, 3.782046855629388*^9}, {3.782047057329648*^9, 
   3.782047095695794*^9}, {3.78204713704733*^9, 3.782047151927642*^9}, {
   3.782047259957144*^9, 3.7820472619653482`*^9}, {3.782047342659054*^9, 
   3.782047365978188*^9}, {3.782047397747666*^9, 3.782047436824929*^9}, {
   3.78204752438588*^9, 3.782047553905918*^9}, {3.782047700221315*^9, 
   3.782047729418625*^9}, 3.7820478025536013`*^9, {3.782047937032391*^9, 
   3.782048009748714*^9}, {3.7820480614532013`*^9, 3.782048119090255*^9}, {
   3.7820484207082987`*^9, 3.782048560169928*^9}, {3.7820486666478653`*^9, 
   3.782048712358963*^9}, {3.782049437895391*^9, 3.782049452206506*^9}, {
   3.782049688145772*^9, 3.782049716032612*^9}, 3.782049864768108*^9, {
   3.7820498989341087`*^9, 3.7820499263003798`*^9}, {3.782049981595697*^9, 
   3.782050392028247*^9}, {3.782050425117622*^9, 3.782050451020184*^9}, {
   3.7820505042191*^9, 3.782050523779109*^9}, {3.782050561522791*^9, 
   3.7820505762090893`*^9}, {3.7820506103791533`*^9, 3.782050663535224*^9}, {
   3.782050770224032*^9, 3.7820508194839487`*^9}, {3.782050851780014*^9, 
   3.782050899963357*^9}, {3.782050932578496*^9, 3.782050940169877*^9}, {
   3.782050988627522*^9, 3.78205101265306*^9}, {3.782051070026618*^9, 
   3.782051117438787*^9}, {3.782051332316132*^9, 3.782051353904725*^9}, {
   3.782070812680416*^9, 3.782070825534471*^9}, {3.78207380916749*^9, 
   3.782073819557263*^9}, {3.78247502660347*^9, 3.782475028009947*^9}, {
   3.7824756597218018`*^9, 3.78247568067133*^9}, {3.78247594907412*^9, 
   3.782475949370171*^9}, {3.782475980265849*^9, 3.7824759886969967`*^9}, {
   3.7869681125322447`*^9, 3.786968113809771*^9}, {3.7886118148808813`*^9, 
   3.78861181513523*^9}, {3.791276972943698*^9, 3.791276984446171*^9}, 
   3.791314091938156*^9, {3.799688680486678*^9, 3.7996886890605392`*^9}, {
   3.804503290037033*^9, 3.804503306068128*^9}, {3.807555851972546*^9, 
   3.8075558931276693`*^9}, {3.807556016256991*^9, 3.807556025376852*^9}, {
   3.807790994132876*^9, 3.8077910030746803`*^9}, 3.8077914041472588`*^9, {
   3.8077914545434732`*^9, 3.807791459163561*^9}, {3.807795312414534*^9, 
   3.8077953247852182`*^9}, {3.807795379519248*^9, 3.807795379902728*^9}, {
   3.8077954907149887`*^9, 3.80779552254173*^9}, 3.807795642345224*^9, {
   3.8077964361070013`*^9, 3.8077964363069773`*^9}, {3.8079891781543818`*^9, 
   3.807989217671966*^9}, {3.8079892963567953`*^9, 3.807989336755649*^9}, {
   3.80798952638216*^9, 3.807989561255074*^9}, {3.808021582324835*^9, 
   3.8080215883531713`*^9}, {3.808021628034669*^9, 3.808021631862545*^9}, {
   3.80802182777042*^9, 3.8080218395344067`*^9}, 3.808021908364155*^9, {
   3.8080219555321417`*^9, 3.808021960037487*^9}, {3.808022009584671*^9, 
   3.808022019515335*^9}, {3.808022106558207*^9, 3.80802212234518*^9}, {
   3.80802217177052*^9, 3.808022174758156*^9}, {3.808022271692985*^9, 
   3.80802229150075*^9}, {3.808022345019279*^9, 3.808022405607725*^9}, {
   3.808022448623294*^9, 3.808022459815276*^9}, {3.808022668602972*^9, 
   3.808022671812945*^9}, {3.8080227601894073`*^9, 3.808022764420519*^9}, {
   3.808022865703629*^9, 3.808022872880707*^9}, 3.80802343456922*^9, {
   3.808023538605517*^9, 3.808023541444477*^9}, {3.808023821293998*^9, 
   3.808023835028672*^9}, {3.808023987758006*^9, 3.808023990726025*^9}, {
   3.808024425523251*^9, 3.808024433897904*^9}, 3.8080244851582813`*^9, 
   3.808024593818079*^9, {3.80802473331213*^9, 3.808024794888248*^9}, 
   3.8080249359648447`*^9, {3.808024991389629*^9, 3.808024998831979*^9}, {
   3.80802504836539*^9, 3.80802511978537*^9}, {3.808025165260144*^9, 
   3.8080251852817574`*^9}, {3.8080252209259253`*^9, 3.808025253511598*^9}, {
   3.8080255842529907`*^9, 3.808025619097109*^9}, {3.808025739155336*^9, 
   3.808025761384656*^9}, {3.808025797849238*^9, 3.808025846854966*^9}, {
   3.808025936333851*^9, 3.808025970721442*^9}, {3.808026017042315*^9, 
   3.80802603242558*^9}, {3.808026233786542*^9, 3.8080262408028107`*^9}, {
   3.808026422369768*^9, 3.808026437050736*^9}, {3.808026472731584*^9, 
   3.808026513955029*^9}, {3.8080266892786303`*^9, 3.8080267129080057`*^9}, {
   3.80802681352383*^9, 3.808026814427116*^9}, {3.808027050005349*^9, 
   3.808027068955285*^9}, 3.80802795613111*^9, {3.808032215799267*^9, 
   3.8080322244223824`*^9}, {3.808032348875668*^9, 3.808032361953579*^9}, {
   3.8080324025681763`*^9, 3.808032402672739*^9}, {3.808032507574267*^9, 
   3.808032516523342*^9}, {3.808032573573634*^9, 3.808032573732428*^9}, {
   3.808032696542942*^9, 3.808032697166769*^9}, {3.8080334593639402`*^9, 
   3.808033461017*^9}, {3.808033492742763*^9, 3.8080335880661573`*^9}, {
   3.8080390077988033`*^9, 3.808039092186884*^9}, {3.808039129837578*^9, 
   3.808039130021324*^9}, {3.8080393779269953`*^9, 3.8080394019618587`*^9}, {
   3.808039448545657*^9, 3.808039471175304*^9}, {3.808039537599853*^9, 
   3.808039554405596*^9}, {3.8080396753716507`*^9, 3.808039677329537*^9}, {
   3.80803970896284*^9, 3.808039709082038*^9}, {3.8080397593886433`*^9, 
   3.808039762302925*^9}, {3.8080398535207443`*^9, 3.8080398607511377`*^9}, {
   3.808039926540456*^9, 3.808040005036828*^9}, {3.808040042309388*^9, 
   3.8080401579587317`*^9}, {3.80805697436684*^9, 3.808057006994482*^9}, {
   3.8080653474275293`*^9, 3.808065352625061*^9}, {3.8080658385224867`*^9, 
   3.8080658572336206`*^9}, {3.80806604513962*^9, 3.808066047339387*^9}, {
   3.808066199536165*^9, 3.808066199846139*^9}, {3.80806627557448*^9, 
   3.80806627625419*^9}, {3.808123736223749*^9, 3.8081237426405697`*^9}, {
   3.8081238137180643`*^9, 3.808123884146598*^9}, {3.8081240898367367`*^9, 
   3.808124197121252*^9}, 3.8081243105619783`*^9, {3.8081251424694223`*^9, 
   3.8081251452914553`*^9}, {3.8081251812215977`*^9, 3.808125199994409*^9}, {
   3.80815757690044*^9, 3.808157599145936*^9}, {3.808573677011475*^9, 
   3.808573677977982*^9}, {3.808573776833617*^9, 3.808573799744008*^9}, 
   3.8085739566312027`*^9, {3.826944248082589*^9, 3.826944251117289*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"8c7bdbbc-e28b-4666-9785-32ce5fa9b3c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SynthesiseStructure", "[", 
   RowBox[{"element_String", ",", "\[IndentingNewLine]", 
    RowBox[{"latticeParameters_List", ":", 
     RowBox[{"{", 
      RowBox[{
      "5.", ",", "5.", ",", "5.", ",", "90.", ",", "90.", ",", "90."}], 
      "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"spaceGroup_", ":", "\"\<P1\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"inputLabel_String", ":", "\"\<\>\""}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"label", "=", "inputLabel"}], ",", "sg", ",", "chemicalFormula",
       ",", "atomData"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Checks", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<FilterSpecialLabels\>\"", ",", 
          RowBox[{"{", "element", "}"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"SynthesiseStructure", "::", "ExpectedSpecialLabel"}], ",", 
          "element"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"latticeParameters", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "#", ",", "#", ",", "#", ",", "#", ",", "#"}], 
             "}"}], "&"}], "[", 
           RowBox[{"_", "?", "NumericQ"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"SynthesiseStructure", "::", "InvalidLatticeParameters"}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<InterpretSpaceGroup\>\"", ",", "spaceGroup"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Prepare", " ", "crystal", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"element", "===", "\"\<Void\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chemicalFormula", "=", "\"\<\>\""}], ";", 
        RowBox[{"atomData", "=", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chemicalFormula", "=", "element"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"atomData", "=", 
         RowBox[{"{", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Element\>\"", "\[Rule]", "element"}], ",", 
            RowBox[{"\"\<FractionalCoordinates\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "|>"}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Add", " ", "to", " ", "crystal", " ", "database"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "===", "\"\<\>\""}], ",", 
       RowBox[{"label", "=", "element"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ImportCrystalData", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "label", ",", "chemicalFormula", ",", "0", ",", "spaceGroup", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "latticeParameters", ",", "\[IndentingNewLine]", "atomData", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<OverwriteWarning\>\"", "\[Rule]", "False"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739877426691807*^9, 3.739877512185233*^9}, {
   3.739877546275635*^9, 3.7398776229190817`*^9}, {3.739877703000132*^9, 
   3.739877749709647*^9}, {3.739877809507863*^9, 3.739877812473098*^9}, {
   3.73988326754291*^9, 3.7398833299152517`*^9}, 3.739883389420485*^9, {
   3.739883430701161*^9, 3.7398834730901318`*^9}, {3.7407211261529217`*^9, 
   3.740721187584734*^9}, 3.740721261813945*^9, {3.740721315715322*^9, 
   3.740721315988946*^9}, {3.740721861127396*^9, 3.7407218680373373`*^9}, {
   3.7407225108236713`*^9, 3.740722544404612*^9}, {3.740722575666327*^9, 
   3.740722581820733*^9}, {3.7407266695846148`*^9, 3.7407266704084167`*^9}, {
   3.7416719890224524`*^9, 3.74167199814979*^9}, {3.741672032958386*^9, 
   3.741672045595846*^9}, {3.743835351755103*^9, 3.7438353571302423`*^9}, {
   3.758529957439567*^9, 3.7585299679328337`*^9}, 3.762793093672283*^9, {
   3.787461129238645*^9, 3.7874611307007437`*^9}, {3.8079812302397213`*^9, 
   3.807981297420555*^9}, {3.8079814194100943`*^9, 3.807981442248311*^9}, {
   3.8079820022566338`*^9, 3.807982035005279*^9}, {3.807982396251148*^9, 
   3.807982396979968*^9}, {3.8079824994875097`*^9, 3.807982531630505*^9}, {
   3.8079826888508177`*^9, 3.807982690978077*^9}, {3.807982777415156*^9, 
   3.807982806831277*^9}, 3.807982857394144*^9, {3.807983077583373*^9, 
   3.807983078014022*^9}, {3.8079831578769484`*^9, 3.807983158283577*^9}, {
   3.807983189540309*^9, 3.80798319024284*^9}, {3.807983336688171*^9, 
   3.807983339550063*^9}, {3.8079833910220633`*^9, 3.807983391932358*^9}, {
   3.807984052641316*^9, 3.807984105974668*^9}, {3.807984263067987*^9, 
   3.8079842636504927`*^9}, 3.807985099365746*^9, {3.807985180630662*^9, 
   3.807985322106089*^9}, {3.807985665896266*^9, 3.807985904218112*^9}, {
   3.80798602505409*^9, 3.80798602982215*^9}, 3.8079861384614058`*^9, {
   3.807986168943478*^9, 3.807986194344778*^9}, 3.808041478503819*^9, {
   3.80805762158608*^9, 3.808057621842572*^9}, {3.808057705422927*^9, 
   3.808057844033559*^9}, {3.8080578786007023`*^9, 3.808057921289896*^9}, {
   3.8080580089574738`*^9, 3.8080580116437607`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[926]:=",ExpressionUUID->"2f5e4398-d764-431f-87cc-293426ee70dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[927]:=",ExpressionUUID->"81173583-30cf-4e23-9511-5dd70ba1f933"]
}, Closed]],

Cell[CellGroupData[{

Cell["SystematicAbsentQ", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, 
   3.684152664923592*^9, 3.684212717826067*^9, {3.684235367542338*^9, 
   3.684235368959896*^9}, {3.7348608567219887`*^9, 
   3.7348608578805103`*^9}},ExpressionUUID->"2d3ef5ab-8aaa-4443-9857-\
a028cd8182f1"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[928]:=",ExpressionUUID->"fda0f098-6502-410b-aba1-ed510a206892"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "SystematicAbsentQ"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Options", " ", 
       RowBox[{"from", " ", "'"}], 
       RowBox[{"StructureFactor", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\"\<Threshold\>\"", "\[Rule]", "0"}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "SystematicAbsentQ"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717953990950385*^9, 3.7179540186608152`*^9}, {
   3.717955286881834*^9, 3.71795528908066*^9}, 3.7185275807475443`*^9, {
   3.7185288952692947`*^9, 3.7185289042447977`*^9}, {3.718528971946641*^9, 
   3.718528972505208*^9}, {3.7186524404557343`*^9, 3.7186524494142714`*^9}, {
   3.718652492038546*^9, 3.7186524992533197`*^9}, 3.718655947266296*^9, {
   3.756718173211508*^9, 3.756718197889163*^9}},
 CellLabel->
  "In[929]:=",ExpressionUUID->"8cf0b019-7756-4312-95f1-e253a9fc7df4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[931]:=",ExpressionUUID->"46bf4d52-f37d-4bc9-85e9-3b9bc42a9edd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SystematicAbsentQ", "[", 
   RowBox[{"group_String", ",", "hkl_List", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sgHM", ",", "centring", ",", "symop", ",", "r", ",", "t", ",", 
      "\[Delta]", ",", "crystalQ", ",", "\[Lambda]", ",", "check"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checking", " ", "and", " ", 
      "processing", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$CrystalData", ",", "group"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"sgHM", "=", 
        RowBox[{"$CrystalData", "[", 
         RowBox[{"group", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"sgHM", "=", "group"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sgHM", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<InterpretSpaceGroup\>\"", ",", "sgHM"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"hkl", ",", "\"\<Integer\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Loading", " ", "lattice", " ", "centring", " ", "vectors", " ", "and", 
       " ", "symmetry", " ", "operations"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sgHM", "=", 
      RowBox[{"GetSymmetryData", "[", 
       RowBox[{"sgHM", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"centring", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<GetCentringVectors\>\"", ",", 
        RowBox[{"StringTake", "[", 
         RowBox[{"sgHM", ",", "1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"symop", "=", 
      RowBox[{"GetSymmetryOperations", "[", "sgHM", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Procedure", " ", "for", " ", 
       "checking", " ", "systematic", " ", "absence", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"crystalQ", "=", 
      RowBox[{"KeyExistsQ", "[", 
       RowBox[{"$CrystalData", ",", "group"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Ony", " ", "check", " ", "structure", " ", "factor", " ", "if", " ", 
       "\[Delta]", " ", "is", " ", "numeric"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NumericQ", "@", "\[Delta]"}], "&&", 
        RowBox[{"\[Delta]", ">", "0"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       
       RowBox[{
        RowBox[{"\[Lambda]", "=", 
         RowBox[{"$CrystalData", "[", 
          RowBox[{"group", ",", "\"\<Wavelength\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "@", "\[Lambda]"}], ",", 
          RowBox[{"\[Lambda]", "=", "1.0"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"crystalQ", "=", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"check", "[", "input_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"General", " ", "absence", " ", 
         RowBox[{"(", "centring", ")"}]}], " ", "*)"}], "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"input", ",", "#"}], "]"}], "&"}], "/@", "centring"}],
              ",", "IntegerQ"}], "]"}]}], ",", 
          RowBox[{"Return", "@", "True"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Special", " ", "absence", " ", 
          RowBox[{"(", "translation", ")"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"r", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Equal", "[", 
            RowBox[{"input", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", 
             RowBox[{"symop", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ".", 
            "input"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"t", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", 
            RowBox[{"input", ".", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"symop", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"r", ",", "t"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Return", "@", "True"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Structure", " ", "factor", " ", "below", " ", "threshold"}],
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"crystalQ", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"First", "@", "\[IndentingNewLine]", 
               RowBox[{"StructureFactor", "[", 
                RowBox[{
                "group", ",", "input", ",", "\[Lambda]", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<IgnoreSystematicAbsence\>\"", "\[Rule]", "True"}]}], 
                "]"}]}], "]"}], "<", "\[Delta]"}], ",", "\[IndentingNewLine]",
             "\t", 
            RowBox[{"Return", "@", "True"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Not", " ", "systematically", " ", "absent", " ", "reflection"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", "False"}], 
       "\[IndentingNewLine]", "\t", ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Checking", " ", "one", " ", "or", " ", 
       "more", " ", "reflections", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatrixQ", "@", "hkl"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Multiple", " ", "reflections"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Sow", "[", 
            RowBox[{"check", "@", 
             RowBox[{
             "hkl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "hkl"}]}], "}"}]}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Single", " ", "reflection", " ", "input"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"check", "[", "hkl", "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, {
   3.682414147181966*^9, 3.6824141504193163`*^9}, {3.682422054610866*^9, 
   3.682422058841216*^9}, {3.68248889321034*^9, 3.6824889312093363`*^9}, {
   3.682497870103613*^9, 3.682497870838962*^9}, {3.682498439949175*^9, 
   3.682498473226802*^9}, {3.682498545616006*^9, 3.682498583222694*^9}, {
   3.682652463274819*^9, 3.6826524633856573`*^9}, {3.6826525226633253`*^9, 
   3.682652528176805*^9}, {3.682652588129519*^9, 3.682652647587326*^9}, {
   3.682652732220833*^9, 3.682652759824765*^9}, 3.682652789955687*^9, {
   3.682652885565811*^9, 3.682652898414853*^9}, {3.682652934435927*^9, 
   3.682653039668708*^9}, {3.682653269191456*^9, 3.6826532707753983`*^9}, {
   3.6826767635081587`*^9, 3.682676763842099*^9}, {3.6826768070865793`*^9, 
   3.682676845830226*^9}, 3.682742965166976*^9, {3.682769742543735*^9, 
   3.6827697571522007`*^9}, {3.6828236360002527`*^9, 3.682823671982461*^9}, {
   3.6836006968597813`*^9, 3.6836006973216457`*^9}, {3.684060484643417*^9, 
   3.6840604848150167`*^9}, {3.68412495791751*^9, 3.684124960014814*^9}, {
   3.6841250363069344`*^9, 3.6841250440786533`*^9}, {3.684125292582508*^9, 
   3.684125320225617*^9}, {3.68412538876647*^9, 3.6841254623463984`*^9}, {
   3.6841304713418827`*^9, 3.684130478389627*^9}, {3.6841306699315777`*^9, 
   3.684130724975029*^9}, 3.68413089413463*^9, {3.684131204505745*^9, 
   3.6841312582019*^9}, {3.6841313634646997`*^9, 3.684131393356784*^9}, {
   3.6841498342496643`*^9, 3.684149837987958*^9}, {3.684150149112711*^9, 
   3.684150240284457*^9}, {3.684150362867743*^9, 3.684150386986066*^9}, {
   3.684150541179953*^9, 3.6841505423276777`*^9}, {3.6841506380119553`*^9, 
   3.684150651459449*^9}, {3.684151021257702*^9, 3.684151032817149*^9}, {
   3.684151182764062*^9, 3.684151185275826*^9}, {3.684212476920885*^9, 
   3.684212511750373*^9}, {3.684212647039875*^9, 3.684212651448751*^9}, 
   3.6842126863927193`*^9, {3.684233783894244*^9, 3.684233817065721*^9}, {
   3.684233916907439*^9, 3.6842339411075363`*^9}, {3.684234821167623*^9, 
   3.6842348230804157`*^9}, {3.684234886376019*^9, 3.68423497922346*^9}, {
   3.6842353860797777`*^9, 3.6842353905422564`*^9}, {3.6846668654727983`*^9, 
   3.684666891492681*^9}, {3.685082222817321*^9, 3.685082226317616*^9}, 
   3.685084031481782*^9, {3.685350925968895*^9, 3.68535100680781*^9}, {
   3.685351038989582*^9, 3.685351047812945*^9}, {3.685351078290902*^9, 
   3.685351108504094*^9}, {3.685694584031888*^9, 3.685694653828217*^9}, 
   3.685695925701322*^9, {3.68569711141499*^9, 3.685697134185396*^9}, 
   3.685700713456634*^9, {3.685704829547666*^9, 3.685704830086855*^9}, {
   3.685705075633955*^9, 3.685705079583547*^9}, {3.685706365866496*^9, 
   3.685706368934197*^9}, 3.713602168106978*^9, {3.713602392449037*^9, 
   3.713602410077929*^9}, {3.713602464998026*^9, 3.713602530509159*^9}, {
   3.713603876670116*^9, 3.7136038840449266`*^9}, 3.713603942045004*^9, {
   3.7136040206666107`*^9, 3.713604020825574*^9}, {3.713604931237699*^9, 
   3.713604935186516*^9}, {3.713605001324107*^9, 3.713605128920559*^9}, {
   3.713605172705031*^9, 3.713605173103353*^9}, {3.713605233679226*^9, 
   3.7136052559896107`*^9}, {3.713605301141511*^9, 3.713605614517179*^9}, {
   3.713605649172325*^9, 3.7136056930135727`*^9}, {3.713605763281867*^9, 
   3.71360577276626*^9}, {3.7136077822162323`*^9, 3.713607843717113*^9}, {
   3.713607914690593*^9, 3.713607919186142*^9}, {3.713607950954817*^9, 
   3.713607988512763*^9}, {3.7136081182553368`*^9, 3.7136081193341618`*^9}, {
   3.713608165309813*^9, 3.713608212131865*^9}, {3.713608491703147*^9, 
   3.713608597826982*^9}, 3.713608669427478*^9, {3.714457514532886*^9, 
   3.7144575569858093`*^9}, {3.714457667858124*^9, 3.714457669215103*^9}, {
   3.717740903699132*^9, 3.7177409199751043`*^9}, {3.717954022464028*^9, 
   3.717954117702723*^9}, {3.7179541502456493`*^9, 3.717954151084145*^9}, {
   3.7179541877469873`*^9, 3.717954200013671*^9}, {3.717954240531042*^9, 
   3.717954310601891*^9}, {3.717954534557487*^9, 3.717954567347104*^9}, {
   3.7179546616498013`*^9, 3.717954701520533*^9}, 3.717955292653183*^9, {
   3.717955363875353*^9, 3.717955382178829*^9}, {3.717955462743301*^9, 
   3.7179554822550488`*^9}, {3.7179555253191767`*^9, 3.71795554901346*^9}, {
   3.717955579894808*^9, 3.7179556017012653`*^9}, {3.718520157118865*^9, 
   3.71852016386948*^9}, {3.7185266339210453`*^9, 3.718526647279551*^9}, {
   3.718526718817865*^9, 3.7185267198307457`*^9}, {3.718526958506631*^9, 
   3.718526978097324*^9}, {3.71852707035251*^9, 3.718527110758883*^9}, {
   3.7185272311573143`*^9, 3.718527233715704*^9}, {3.718527274972436*^9, 
   3.7185273330257473`*^9}, 3.718527396194458*^9, {3.718527453279973*^9, 
   3.718527477222574*^9}, {3.71852751867883*^9, 3.718527563899838*^9}, {
   3.718527600238863*^9, 3.718527617234693*^9}, 3.718527655228056*^9, {
   3.718528013163574*^9, 3.718528024201454*^9}, {3.7186525272007*^9, 
   3.718652527959489*^9}, {3.718652565120645*^9, 3.718652566214712*^9}, {
   3.718652832245657*^9, 3.7186528407286243`*^9}, {3.718653288762394*^9, 
   3.718653314743916*^9}, {3.7186538005244913`*^9, 3.718653936992763*^9}, {
   3.718654029831277*^9, 3.71865403138211*^9}, {3.7186540805920153`*^9, 
   3.7186540965122004`*^9}, {3.718654395807845*^9, 3.7186544596309137`*^9}, {
   3.718655975082776*^9, 3.718655992074871*^9}, 3.730401919641734*^9, {
   3.7305445959573927`*^9, 3.730544596119605*^9}, {3.734670078980603*^9, 
   3.734670088906211*^9}, {3.734670130909657*^9, 3.7346702172628927`*^9}, {
   3.7346714423800507`*^9, 3.734671497162018*^9}, {3.735032658265091*^9, 
   3.735032660215802*^9}, {3.735033384792354*^9, 3.735033389780846*^9}, 
   3.737968546032345*^9, 3.737968576313637*^9, {3.739170399037306*^9, 
   3.7391704006911793`*^9}, {3.7585304342482452`*^9, 3.758530447238894*^9}, {
   3.759520442791551*^9, 3.759520443045328*^9}, 3.762793094145043*^9, {
   3.786968694444613*^9, 3.786968706778517*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[932]:=",ExpressionUUID->"49457090-88ad-449a-a61e-4a8a04863ddc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[933]:=",ExpressionUUID->"ea5bb8fe-e1a9-4bca-b758-84214e26835e"]
}, Closed]],

Cell[CellGroupData[{

Cell["ToStandardSetting", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105579311858*^9, {3.6827596700257883`*^9, 
   3.6827596859071627`*^9}},ExpressionUUID->"03ea9153-1874-4d1b-a19a-\
f95c20a25429"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[934]:=",ExpressionUUID->"4135459a-fb14-4273-820b-f1918ea5dbe1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToStandardSetting", "::", "ext"}], "=", 
    "\"\<Invalid extension \[LeftGuillemet]`1`\[RightGuillemet] for this \
space group.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "ToStandardSetting"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_."}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.66810571214802*^9, {3.6681867516522207`*^9, 
   3.668186778354513*^9}, {3.6681868394172163`*^9, 3.6681868614325943`*^9}, {
   3.668187374101748*^9, 3.6681874104278383`*^9}, {3.668187695125526*^9, 
   3.668187730468417*^9}, {3.668188056044814*^9, 3.668188056876872*^9}, {
   3.6681926250344687`*^9, 3.668192625250432*^9}, {3.682755004772629*^9, 
   3.682755006380539*^9}, {3.6827550880482693`*^9, 3.6827550883851967`*^9}, {
   3.682757166386887*^9, 3.682757187609177*^9}, {3.682760997892744*^9, 
   3.6827610174084167`*^9}, {3.682763962473707*^9, 3.682763962814755*^9}, {
   3.684140977908526*^9, 3.6841409783589582`*^9}, {3.684148290703258*^9, 
   3.684148309867588*^9}, {3.684148479444276*^9, 3.684148481151258*^9}, {
   3.685686180336005*^9, 3.6856861809425592`*^9}, {3.7124803378635798`*^9, 
   3.712480360617807*^9}, {3.725962849323039*^9, 3.725962853881053*^9}, {
   3.756718225776058*^9, 3.7567182298258867`*^9}, {3.756718306310713*^9, 
   3.756718306471794*^9}},
 CellLabel->
  "In[935]:=",ExpressionUUID->"10462ba0-0d08-4703-94fa-c2fbdc78efc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[937]:=",ExpressionUUID->"ed7f9208-8fb7-4223-b52a-0dddaffcf886"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToStandardSetting", "[", 
   RowBox[{"group_String", ",", "hkl_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "operators", ",", "equivalents", ",", "nonnegative", ",", "list"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"hkl", ",", "\"\<1hkl\>\"", ",", "\"\<Integer\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<PointSpaceGroupQ\>\"", ",", "group"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Listing", " ", "all", " ", "symmetry"}], "-", "equivalents"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"operators", "=", 
      RowBox[{"GetSymmetryOperations", "@", 
       RowBox[{"GetLaueClass", "@", "group"}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "@", "operators"}], "\[Equal]", "5"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"operators", "=", 
        RowBox[{"operators", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"equivalents", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "#", "]"}], ".", "hkl"}], "&"}], "/@", 
       "operators"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Selection", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"nonnegative", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"equivalents", ",", 
        RowBox[{
         RowBox[{"AllTrue", "[", 
          RowBox[{"#", ",", "NonNegative"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nonnegative", "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"list", "=", "nonnegative"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"list", "=", "equivalents"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Last", "@", 
      RowBox[{"SortBy", "[", 
       RowBox[{"list", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "&"}],
           ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           ",", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "&"}]}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106433667647*^9, {3.6827597597787027`*^9, 
   3.682759834796783*^9}, {3.682759891973723*^9, 3.6827599381135283`*^9}, {
   3.6827599744510717`*^9, 3.682760059158255*^9}, 3.682760089218005*^9, 
   3.682760175235159*^9, {3.682760273255459*^9, 3.682760273401188*^9}, {
   3.682760309150391*^9, 3.682760330431353*^9}, {3.682760623312214*^9, 
   3.682760634074464*^9}, {3.6827607536729813`*^9, 3.682760780680396*^9}, 
   3.6827639524031057`*^9, {3.682766856819317*^9, 3.6827668581203957`*^9}, {
   3.682767574024981*^9, 3.6827676450236273`*^9}, {3.683604297716032*^9, 
   3.683604323859149*^9}, {3.6841396193294077`*^9, 3.684139624630027*^9}, {
   3.684213538234778*^9, 3.684213555949724*^9}, 3.684235429735504*^9, {
   3.684493396540483*^9, 3.684493397210763*^9}, {3.684669115218993*^9, 
   3.6846691192528687`*^9}, {3.684669432088505*^9, 3.684669457777866*^9}, {
   3.684669489122911*^9, 3.684669518670082*^9}, {3.684669609081485*^9, 
   3.6846696230904016`*^9}, {3.685082164662752*^9, 3.685082172057521*^9}, 
   3.6850840466699457`*^9, {3.685247146490287*^9, 3.685247154770102*^9}, {
   3.685247286241943*^9, 3.685247305372675*^9}, {3.685247348944471*^9, 
   3.685247396744459*^9}, {3.6852474395342817`*^9, 3.68524751248363*^9}, {
   3.685247568575778*^9, 3.685247596178206*^9}, {3.6852491993387747`*^9, 
   3.685249199534231*^9}, {3.685697524120323*^9, 3.685697526389267*^9}, {
   3.685697566427183*^9, 3.685697604683166*^9}, 3.685700685716364*^9, 
   3.685700721712253*^9, {3.714370012740911*^9, 3.714370023123824*^9}, {
   3.7177409200144033`*^9, 3.717740920023315*^9}, {3.725954106003827*^9, 
   3.72595410715429*^9}, 3.7259582915662403`*^9, {3.725958525342989*^9, 
   3.725958533777025*^9}, 3.725958679383768*^9, {3.727675215252287*^9, 
   3.727675231692677*^9}, {3.727680799461162*^9, 3.727680801984366*^9}, 
   3.7379685211198072`*^9, 3.737968576457651*^9, {3.7585304488073587`*^9, 
   3.7585304608850737`*^9}, 3.76279309415876*^9, {3.786968712322731*^9, 
   3.786968713233395*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[938]:=",ExpressionUUID->"b01c4de8-33e1-441c-97a3-e16e8b8f2476"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToStandardSetting", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"extension_", ":", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "sg", ",", "fullHM", ",", "SG", ",", "\[IndentingNewLine]", 
      "mainTargetQ", ",", "uniqueInSgQ", ",", "mainSetting", ",", 
      "\[IndentingNewLine]", "output", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Prepartaion", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "=", "input"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "if", " ", "valid", " ", "input", " ", "symbol"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<PointSpaceGroupQ\>\"", ",", "input"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "input", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"fullHM", "=", 
      RowBox[{"sg", "[", 
       RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"$SpaceGroups", ",", "fullHM"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"SG", "=", 
      RowBox[{"$SpaceGroups", "[", 
       RowBox[{"temp", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Is", " ", "target", " ", "space", " ", "group", " ", "main", " ", 
       RowBox[{"setting", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mainTargetQ", "=", 
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"First", "@", "temp"}]}], "\[LessEqual]", "3"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Is", " ", "target", " ", "symbol", " ", "unique", " ", "among", " ", 
       "all", " ", "space", " ", 
       RowBox[{"groups", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"$SpaceGroups", ",", 
        RowBox[{"sg", "[", 
         RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"temp", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1"}], 
            "\[RightDoubleBracket]"}]}]}], "===", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "fullHM"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Is", " ", "target", " ", "symbol", " ", "unique", " ", "in", " ", 
       "its", " ", "space", " ", 
       RowBox[{"group", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"uniqueInSgQ", "=", 
      RowBox[{
       RowBox[{"Length", "@", "temp"}], "===", "1"}]}], ";", "\t", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"With", " ", "cell", " ", "origin", " ", 
        RowBox[{"tag", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"extension", "=!=", "1"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"output", "=", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}], "<>", 
          "\"\<:\>\"", "<>", 
          RowBox[{"ToString", "@", "extension"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"$GroupSymbolRedirect", ",", "output"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"ToStandardSetting", "::", "ext"}], ",", "extension"}], 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Is", " ", "target", " ", "\"\<best candidate\>\"", " ", "for", " ", 
          "non"}], "-", 
         RowBox[{"main", " ", 
          RowBox[{"symbol", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"!", "uniqueInSgQ"}], "&&", 
        RowBox[{"!", "mainTargetQ"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"mainSetting", "=", 
         RowBox[{"First", "@", 
          RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"sg", "[", "\"\<Setting\>\"", "]"}]}], "===", 
           "mainSetting"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"output", "=", 
           RowBox[{"sg", "[", 
            RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"output", "=", "fullHM"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Uniquely", " ", "formatted", " ", "symbol", " ", "OR", " ", 
         RowBox[{"\"\<main symbol\>\"", "?"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"uniqueInSgQ", "||", "mainTargetQ"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"output", "=", 
        RowBox[{
         RowBox[{"$GroupSymbolRedirect", "[", "output", "]"}], "[", 
         RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "ambiguous"}], ",", " ", 
         RowBox[{"use", " ", "full", " ", 
          RowBox[{"Hermman", "--"}], "Mauguin"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"output", "=", "fullHM"}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106433667647*^9, {3.6827597597787027`*^9, 
   3.682759834796783*^9}, {3.682759891973723*^9, 3.6827599381135283`*^9}, {
   3.6827599744510717`*^9, 3.682760059158255*^9}, 3.682760089218005*^9, 
   3.682760175235159*^9, {3.682760273255459*^9, 3.682760273401188*^9}, {
   3.682760309150391*^9, 3.682760330431353*^9}, {3.682760623312214*^9, 
   3.682760634074464*^9}, {3.6827607536729813`*^9, 3.682760780680396*^9}, 
   3.6827639524031057`*^9, {3.682766856819317*^9, 3.6827668581203957`*^9}, {
   3.682767574024981*^9, 3.6827676450236273`*^9}, {3.683604297716032*^9, 
   3.683604323859149*^9}, {3.6841396193294077`*^9, 3.684139624630027*^9}, {
   3.684213538234778*^9, 3.684213555949724*^9}, 3.684235429735504*^9, {
   3.684493396540483*^9, 3.684493397210763*^9}, {3.684669115218993*^9, 
   3.6846691192528687`*^9}, {3.684669432088505*^9, 3.684669457777866*^9}, {
   3.684669489122911*^9, 3.684669518670082*^9}, {3.684669609081485*^9, 
   3.6846696230904016`*^9}, {3.685082164662752*^9, 3.685082172057521*^9}, 
   3.6850840466699457`*^9, {3.685247146490287*^9, 3.685247154770102*^9}, {
   3.685247286241943*^9, 3.685247305372675*^9}, {3.685247348944471*^9, 
   3.685247396744459*^9}, {3.6852474395342817`*^9, 3.68524751248363*^9}, {
   3.685247568575778*^9, 3.685247596178206*^9}, {3.6852491993387747`*^9, 
   3.685249199534231*^9}, {3.685697524120323*^9, 3.685697526389267*^9}, {
   3.685697566427183*^9, 3.685697604683166*^9}, 3.685700685716364*^9, 
   3.685700721712253*^9, {3.712472174195052*^9, 3.712472177692658*^9}, {
   3.7124722215936527`*^9, 3.712472222125225*^9}, {3.7124726596033487`*^9, 
   3.712472831548615*^9}, 3.712472876359597*^9, {3.7124729225976963`*^9, 
   3.712472933328292*^9}, {3.712473065774521*^9, 3.712473085606015*^9}, {
   3.7124732297432747`*^9, 3.712473420166718*^9}, {3.7124737265129843`*^9, 
   3.712473738810995*^9}, {3.712473783794465*^9, 3.712473809180954*^9}, {
   3.7124738405360813`*^9, 3.7124739622882833`*^9}, {3.7124740164607363`*^9, 
   3.7124740355848503`*^9}, {3.712474526311514*^9, 3.71247454749196*^9}, {
   3.712474580437092*^9, 3.712474582276721*^9}, {3.7124748834875793`*^9, 
   3.712474934322382*^9}, {3.712474972745503*^9, 3.71247497289651*^9}, {
   3.7124750051489697`*^9, 3.712475018976412*^9}, {3.71248021179641*^9, 
   3.7124802412684507`*^9}, {3.712480291485821*^9, 3.712480313250639*^9}, 
   3.712480368500133*^9, {3.712480407676384*^9, 3.712480415123426*^9}, {
   3.712480531005803*^9, 3.7124806041575623`*^9}, {3.7124806490537233`*^9, 
   3.712480670116323*^9}, {3.712481025893857*^9, 3.712481064923984*^9}, {
   3.7143700581623793`*^9, 3.714370126083304*^9}, {3.714917865649086*^9, 
   3.7149179313574133`*^9}, {3.7149179630125713`*^9, 3.714917969850429*^9}, {
   3.714917999909767*^9, 3.714918043458394*^9}, {3.71491808323484*^9, 
   3.7149180863296623`*^9}, {3.7149181163613*^9, 3.714918121665152*^9}, 
   3.716618459915923*^9, {3.716618497717318*^9, 3.716618500665338*^9}, {
   3.716618556633456*^9, 3.7166185688222218`*^9}, 3.7166186120507097`*^9, {
   3.716623449771859*^9, 3.716623453353243*^9}, {3.716623558778885*^9, 
   3.716623579014586*^9}, {3.716623611307054*^9, 3.7166236149186153`*^9}, {
   3.716623666697957*^9, 3.716623666886039*^9}, {3.7166245086791477`*^9, 
   3.716624512246523*^9}, {3.716626230555719*^9, 3.7166262307671556`*^9}, {
   3.716626362872368*^9, 3.716626366478477*^9}, {3.716626401845291*^9, 
   3.716626410580432*^9}, {3.716626461873996*^9, 3.7166265694576187`*^9}, {
   3.7177409200415707`*^9, 3.717740920085593*^9}, {3.725954168642559*^9, 
   3.725954174585816*^9}, {3.7259544475654078`*^9, 3.725954453397047*^9}, {
   3.725954529596027*^9, 3.725954536170638*^9}, {3.725954897275111*^9, 
   3.7259549057293167`*^9}, {3.725955820678866*^9, 3.7259558389101562`*^9}, {
   3.725956228516712*^9, 3.7259562736346397`*^9}, {3.72595638572224*^9, 
   3.725956390152341*^9}, {3.725956444608553*^9, 3.7259565050163183`*^9}, {
   3.725956540351451*^9, 3.725956552420847*^9}, {3.7259566391886063`*^9, 
   3.725956744409425*^9}, {3.7259568065361633`*^9, 3.725956853631604*^9}, {
   3.725957068004551*^9, 3.7259571342078733`*^9}, {3.7259575859913692`*^9, 
   3.725957588447097*^9}, 3.725957938529029*^9, {3.725957985144517*^9, 
   3.725957988807857*^9}, {3.725958295593363*^9, 3.725958310575184*^9}, 
   3.725958500965064*^9, {3.7259585374199533`*^9, 3.725958540370281*^9}, 
   3.725958624258267*^9, {3.725958658665193*^9, 3.725958661783428*^9}, {
   3.725958708575451*^9, 3.7259587087667017`*^9}, {3.725960536390708*^9, 
   3.725960556380581*^9}, {3.725962451509495*^9, 3.725962508178426*^9}, {
   3.725962544908064*^9, 3.725962545122154*^9}, {3.725962621129652*^9, 
   3.725962629171185*^9}, {3.7259626800164413`*^9, 3.7259627547331057`*^9}, {
   3.725962864044545*^9, 3.725962864194646*^9}, {3.727675216158976*^9, 
   3.7276752323227167`*^9}, 3.727682066238936*^9, {3.728674616539852*^9, 
   3.728674623693241*^9}, {3.728674704063981*^9, 3.7286747063174458`*^9}, {
   3.7286747572315702`*^9, 3.728674771781168*^9}, {3.728674827973637*^9, 
   3.728674830483848*^9}, {3.728674895642453*^9, 3.7286749553686237`*^9}, {
   3.728675135911109*^9, 3.7286751520763397`*^9}, {3.7286752731619453`*^9, 
   3.728675273385056*^9}, {3.730544614406321*^9, 3.7305446146093597`*^9}, {
   3.7438654567386503`*^9, 3.7438654568231373`*^9}, {3.758530462743428*^9, 
   3.758530470145256*^9}, 3.7627930941740522`*^9, {3.78696872134781*^9, 
   3.7869687223053207`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[939]:=",ExpressionUUID->"d76a5e68-10c7-4ae1-bac9-99869eff2312"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[940]:=",ExpressionUUID->"dd952d1a-9089-44ef-bbd4-df7c39e6fdaa"]
}, Closed]],

Cell[CellGroupData[{

Cell["TransformAtomicDisplacementParameters", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, 3.7609476409800777`*^9, {3.829192913469079*^9, 
   3.8291929242211514`*^9}},ExpressionUUID->"c062acd7-6bc9-4c44-9461-\
22c1986eeee3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[31]:=",ExpressionUUID->"3a76e772-0399-4e23-874f-da30631a6553"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "TransformAtomicDisplacementParameters", "::", "InvalidTransformation"}], 
    "=", "\"\<The transformation input \[LeftGuillemet]`1`\[RightGuillemet] \
is invalid.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "SyntaxInformation", "@", "TransformAtomicDisplacementParameters"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_."}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
   3.7281068862853603`*^9, 3.728106924475239*^9}, {3.747569567860682*^9, 
   3.747569567914845*^9}, {3.747569839486174*^9, 3.747569852127593*^9}, {
   3.756710428101788*^9, 3.756710432840755*^9}, {3.7567104759439573`*^9, 
   3.756710476208014*^9}, {3.760947644803529*^9, 3.760947651026847*^9}, {
   3.760948534996868*^9, 3.760948535383339*^9}, {3.760948688241331*^9, 
   3.7609486934259567`*^9}, {3.829192944752901*^9, 3.8291929739838133`*^9}, 
   3.8291931960616703`*^9, {3.8291935156204033`*^9, 3.829193516054253*^9}, 
   3.830509410967754*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"d6407d5d-7058-4147-bf5c-def65786583c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[34]:=",ExpressionUUID->"031b6b92-05d6-44d9-8a53-888120898fc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformAtomicDisplacementParameters", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_", ",", 
    RowBox[{"transformation_", ":", "\"\<EquivalentIsotropic\>\""}]}], "]"}], 
  ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"ADPs", ",", "cartesianConverter", ",", "cartesianADPs"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<CrystalQ\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<CartesianConverter\>\"", ",", "\"\<EquivalentIsotropic\>\""}],
            "}"}], ",", "transformation"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{
          "TransformAtomicDisplacementParameters", "::", 
           "InvalidTransformation"}], ",", "transformation"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"cartesianConverter", "=", 
      RowBox[{"$CartesianConverterMaker", "@", "crystal"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"transformation", "===", "\"\<CartesianConverter\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Transform"}], " ", "ADPs", " ", "to", " ", 
         "Cartesian", " ", 
         RowBox[{"basis", " ", "--"}], " ", "returns", " ", "function"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "cartesianConverter"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"transformation", "===", "\"\<EquivalentIsotropic\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Calculate"}], " ", "equivalent", " ", 
         "isotropic", " ", "ADPs"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ADPs", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{
           RowBox[{"$CrystalData", "[", 
            RowBox[{"crystal", ",", "\"\<AtomData\>\""}], "]"}], ",", 
           "\"\<DisplacementParameters\>\"", ",", "0."}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cartesianADPs", "=", 
         RowBox[{"cartesianConverter", "/@", "ADPs"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Mean", "/@", 
         RowBox[{"Diagonal", "/@", "cartesianADPs"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829184198061955*^9, 3.829184226700406*^9}, {
   3.829184376259454*^9, 3.829184491578188*^9}, {3.829184787389494*^9, 
   3.829184795272541*^9}, {3.829184827428151*^9, 3.829184923719652*^9}, {
   3.829186100891223*^9, 3.829186251802293*^9}, {3.82918764283396*^9, 
   3.829187688219592*^9}, {3.82918807544389*^9, 3.829188122623342*^9}, {
   3.8291882087232656`*^9, 3.829188236735798*^9}, {3.829188295647006*^9, 
   3.8291883303576803`*^9}, {3.8291883807951107`*^9, 3.829188602388384*^9}, {
   3.82918863447173*^9, 3.8291886568786373`*^9}, {3.829188997335999*^9, 
   3.829189162477283*^9}, {3.829189205639606*^9, 3.8291893127502813`*^9}, {
   3.829189534711296*^9, 3.8291895401364326`*^9}, {3.829189619047159*^9, 
   3.8291896458539658`*^9}, {3.829189716025845*^9, 3.829189717818325*^9}, {
   3.829189863223939*^9, 3.8291899133639927`*^9}, {3.829190020706479*^9, 
   3.829190074696517*^9}, {3.8291901070204067`*^9, 3.82919011627852*^9}, {
   3.829190226743421*^9, 3.829190227905734*^9}, {3.829190417387986*^9, 
   3.829190610180591*^9}, {3.8291906455662518`*^9, 3.8291908030937233`*^9}, {
   3.829190861777896*^9, 3.829190975132978*^9}, {3.829191007958313*^9, 
   3.829191021604381*^9}, 3.829191111057131*^9, {3.829191179241659*^9, 
   3.829191247965128*^9}, {3.829191520098508*^9, 3.8291915203379383`*^9}, 
   3.8291930068761587`*^9, {3.829193039367896*^9, 3.829193054951746*^9}, {
   3.82919317981912*^9, 3.829193197930464*^9}, {3.829193390596085*^9, 
   3.829193401159976*^9}, {3.829193435889729*^9, 3.829193436302945*^9}, {
   3.82921176298703*^9, 3.829211766240624*^9}, {3.829211808700335*^9, 
   3.829211809489278*^9}, {3.829213484653706*^9, 3.829213502858512*^9}, {
   3.829213557061294*^9, 3.829213583359236*^9}, {3.8292138142974977`*^9, 
   3.82921393197998*^9}, {3.8292139634196367`*^9, 3.829213967971208*^9}, {
   3.8292141026978703`*^9, 3.8292141389921017`*^9}, {3.829214175330181*^9, 
   3.829214179054513*^9}, {3.829214240627615*^9, 3.82921428384227*^9}, {
   3.829214363491982*^9, 3.8292143644957447`*^9}, {3.829214438186982*^9, 
   3.829214441020886*^9}, {3.8292144926356707`*^9, 3.829214497267435*^9}, {
   3.829214529525316*^9, 3.829214530796063*^9}, {3.829214565585042*^9, 
   3.829214567780775*^9}, {3.829214618774063*^9, 3.829214642645145*^9}, {
   3.829214685213092*^9, 3.829214843541054*^9}, {3.829214893386845*^9, 
   3.829214966524095*^9}, 3.829235863899364*^9, {3.829274018056748*^9, 
   3.829274094057171*^9}, {3.8292743349547977`*^9, 3.829274335795267*^9}, {
   3.829279351630677*^9, 3.829279358153017*^9}, {3.8292846502566757`*^9, 
   3.829284653080298*^9}, {3.8292860058126173`*^9, 3.8292860337683496`*^9}, 
   3.8292901967657757`*^9, {3.8303427440141172`*^9, 3.830342775076763*^9}, {
   3.830343266988573*^9, 3.8303432671548033`*^9}, {3.8303434936677647`*^9, 
   3.830343506877412*^9}, {3.830343854928014*^9, 3.830343855105515*^9}, {
   3.830345241368556*^9, 3.830345245496496*^9}, {3.830407167299664*^9, 
   3.830407167609539*^9}, {3.830412306103778*^9, 3.830412308047678*^9}, {
   3.830412351402504*^9, 3.83041235163509*^9}, {3.830507982842206*^9, 
   3.830507998270607*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[10]:=",ExpressionUUID->"d5ddc15e-18e4-418d-aec6-1b0754ba1061"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CartesianConverterMaker", "[", "crystal_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "latticeReciprocal", ",", "toCartesian", ",", "n", ",", "U", ",", 
      "dimensionlessU", ",", "CartesianConverter"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Reference", ":", " ", "https", ":"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"doi", ".", "org"}], "/", "10.1107"}], "/", 
       "S0021889802008580"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"latticeReciprocal", "=", 
      RowBox[{"GetCrystalMetric", "[", 
       RowBox[{"crystal", ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Category\>\"", "\[Rule]", "\"\<LatticeParameters\>\""}], 
        ",", 
        RowBox[{"\"\<Space\>\"", "\[Rule]", "\"\<Reciprocal\>\""}], ",", 
        RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toCartesian", "=", 
      RowBox[{"GetCrystalMetric", "[", 
       RowBox[{"crystal", ",", 
        RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"DiagonalMatrix", "@", 
       RowBox[{"latticeReciprocal", "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CartesianConverter", "[", "ADPs_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", "ADPs"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Return", "@", 
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#", ",", "#"}], "}"}], "]"}]}], "&"}], "@", 
           "ADPs"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Alternatively", ":", " ", 
           RowBox[{
            RowBox[{"see", " ", "'"}], 
            RowBox[{"_cell", ".", "convert_Uiso"}], "_to", 
            RowBox[{"_Uij", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"ADPs", "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "#3", ",", "#2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"#3", ",", "1", ",", "#1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"#2", ",", "#1", ",", "1"}], "}"}]}], "}"}]}], "&"}], 
           "@@", 
           RowBox[{"Cos", "@", 
            RowBox[{"latticeReciprocal", "\[LeftDoubleBracket]", 
             RowBox[{"4", ";;", "6"}], "\[RightDoubleBracket]"}]}]}], "*)"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"U", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#4", ",", "#5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"#4", ",", "#2", ",", "#6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"#5", ",", "#6", ",", "#3"}], "}"}]}], "}"}], "&"}], "@@",
           "ADPs"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dimensionlessU", "=", 
         RowBox[{"n", ".", "U", ".", "n"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"toCartesian", ".", "dimensionlessU", ".", 
         RowBox[{"Transpose", "@", "toCartesian"}]}]}], "\[IndentingNewLine]",
        ")"}]}], ";", "\[IndentingNewLine]", "CartesianConverter"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829184198061955*^9, 3.829184226700406*^9}, {
   3.829184376259454*^9, 3.829184491578188*^9}, {3.829184787389494*^9, 
   3.829184795272541*^9}, {3.829184827428151*^9, 3.829184923719652*^9}, {
   3.829186100891223*^9, 3.829186251802293*^9}, {3.82918764283396*^9, 
   3.829187688219592*^9}, {3.82918807544389*^9, 3.829188122623342*^9}, {
   3.8291882087232656`*^9, 3.829188236735798*^9}, {3.829188295647006*^9, 
   3.8291883303576803`*^9}, {3.8291883807951107`*^9, 3.829188602388384*^9}, {
   3.82918863447173*^9, 3.8291886568786373`*^9}, {3.829188687891183*^9, 
   3.829188694512341*^9}, {3.8291888190036173`*^9, 3.8291888775242577`*^9}, {
   3.829188936515583*^9, 3.8291889745530853`*^9}, {3.829189667441236*^9, 
   3.829189691813526*^9}, {3.829189755784315*^9, 3.829189851544544*^9}, {
   3.829189961704298*^9, 3.829189986294052*^9}, {3.829190081120151*^9, 
   3.829190085041135*^9}, {3.829190155545385*^9, 3.829190215185402*^9}, {
   3.829190978687825*^9, 3.829191013188892*^9}, {3.829191127521902*^9, 
   3.829191127669506*^9}, {3.829193044269602*^9, 3.8291930485138283`*^9}, {
   3.829209312594348*^9, 3.8292093304582644`*^9}, {3.829210557165062*^9, 
   3.8292105613759108`*^9}, {3.829210635097641*^9, 3.829210719814127*^9}, {
   3.829211072201126*^9, 3.829211133641951*^9}, {3.8292113611023703`*^9, 
   3.829211455735973*^9}, {3.829211493509009*^9, 3.8292115139774942`*^9}, {
   3.8292115682109947`*^9, 3.829211569182487*^9}, {3.829211700554669*^9, 
   3.829211701628358*^9}, {3.8292117459974194`*^9, 3.829211748721677*^9}, {
   3.8292117884198914`*^9, 3.82921178952822*^9}, {3.829211831703381*^9, 
   3.8292118324497137`*^9}, {3.8292121034648733`*^9, 
   3.8292121179907217`*^9}, {3.829212183425845*^9, 3.8292121915968723`*^9}, {
   3.829212359472188*^9, 3.8292123716068277`*^9}, {3.82921245205455*^9, 
   3.829212685342106*^9}, {3.829212728421213*^9, 3.829212729717373*^9}, {
   3.829212772501532*^9, 3.829212822208354*^9}, {3.829212865638917*^9, 
   3.8292128683953733`*^9}, {3.829212906043516*^9, 3.829212926034223*^9}, {
   3.829213005403788*^9, 3.829213038070896*^9}, {3.8292130685296907`*^9, 
   3.82921307611861*^9}, {3.829213141493738*^9, 3.829213141882269*^9}, {
   3.8292133612734537`*^9, 3.8292134673159*^9}, {3.8292358292776337`*^9, 
   3.829235832321804*^9}, {3.829236454182959*^9, 3.829236468281887*^9}, {
   3.8292708899635487`*^9, 3.8292708968016872`*^9}, {3.8292715006538353`*^9, 
   3.829271508191411*^9}, {3.82927191742234*^9, 3.829271919590246*^9}, {
   3.8292724723009863`*^9, 3.82927247393266*^9}, {3.8292725355394297`*^9, 
   3.829272536927219*^9}, {3.829276634070806*^9, 3.829276636874837*^9}, {
   3.829277528841876*^9, 3.829277529099279*^9}, {3.829277797127964*^9, 
   3.829277800564314*^9}, {3.829277830630001*^9, 3.829277859164447*^9}, {
   3.829278153108815*^9, 3.829278172895858*^9}, 3.829278204420892*^9, {
   3.829278238590056*^9, 3.829278239811181*^9}, {3.829278716051639*^9, 
   3.829278724712969*^9}, {3.8292790221388607`*^9, 3.8292790375690823`*^9}, {
   3.829279233706752*^9, 3.829279238950967*^9}, {3.829279310322844*^9, 
   3.829279313016513*^9}, 3.829279362872725*^9, {3.829284668263756*^9, 
   3.829284709434142*^9}, {3.8292856910881233`*^9, 3.829285752472136*^9}, {
   3.8292858688458643`*^9, 3.82928586929587*^9}, 3.829285981018235*^9, {
   3.8292862490744267`*^9, 3.829286271924766*^9}, {3.82928672598269*^9, 
   3.829286740905793*^9}, {3.8292868534489517`*^9, 3.8292868537152863`*^9}, {
   3.829286918663834*^9, 3.829286975254181*^9}, {3.829289983152665*^9, 
   3.829289983520143*^9}, {3.829290142003605*^9, 3.8292901578124113`*^9}, {
   3.8303428667215767`*^9, 3.8303428761053543`*^9}, {3.830343550021036*^9, 
   3.830343576796157*^9}, {3.830343646504657*^9, 3.830343666024791*^9}, {
   3.830343813976272*^9, 3.830343814145944*^9}, {3.8303445044876347`*^9, 
   3.830344506107218*^9}, {3.830344967889894*^9, 3.830344968082122*^9}, {
   3.8303450122697906`*^9, 3.830345013950061*^9}, {3.830345898543051*^9, 
   3.830345898708181*^9}, {3.830408947536983*^9, 3.8304089613248243`*^9}, {
   3.8304089939683733`*^9, 3.8304090004129677`*^9}, {3.830409134598523*^9, 
   3.8304091411357737`*^9}, {3.830409783910499*^9, 3.830409792916946*^9}, {
   3.830411985845771*^9, 3.830411998914673*^9}, {3.8304120789794807`*^9, 
   3.830412105275779*^9}, {3.83041226322742*^9, 3.830412263356388*^9}, {
   3.8304126540741653`*^9, 3.8304127487611322`*^9}, {3.8304140788804617`*^9, 
   3.8304140812861013`*^9}, {3.830507915424748*^9, 3.830507932502892*^9}, {
   3.830508293726501*^9, 3.830508293941991*^9}, {3.830508605653181*^9, 
   3.830508617785378*^9}, {3.830508758058529*^9, 3.830508763882864*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[22]:=",ExpressionUUID->"086ed5e8-711c-4a7c-9190-9da92dbb7212"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[37]:=",ExpressionUUID->"66cd0628-7597-4511-9da4-192ece13a4d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["UnitCellTransformation", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.682754675215427*^9, 3.682754677485675*^9}, {
   3.6827632401424837`*^9, 3.682763247126801*^9}, 3.682763763856205*^9, 
   3.6827638067251377`*^9, {3.704436680457919*^9, 3.70443668392809*^9}, 
   3.7044395288318233`*^9},ExpressionUUID->"59b525eb-abd7-459d-9833-\
a14f176abe0a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[108]:=",ExpressionUUID->"a07d65f6-9023-4ebe-85ee-72a744fdfc75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "command"}], "=", 
   "\"\<Transformation command \[LeftGuillemet]`1`\[RightGuillemet] not \
recognised.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "invalid"}], "=", 
   "\"\<The setting \[LeftGuillemet]`1`\[RightGuillemet] is invalid.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "invalidSG"}], "=", 
   "\"\<The setting \[LeftGuillemet]`1`\[RightGuillemet] is invalid for this \
particular space group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "na"}], "=", 
   "\"\<Input not applicable for the `1` system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "diffset"}], "=", 
   "\"\<Setting mismatch between source, `1`, and target, `2`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "sg"}], "=", 
   "\"\<Could not interpret \[LeftGuillemet]`1`\[RightGuillemet] as a space \
group symbol.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "differentsg"}], "=", 
   "\"\<The source space group, \[LeftGuillemet]`1`\[RightGuillemet] \
(no.`2`), and the target space group, \[LeftGuillemet]`3`\[RightGuillemet] \
(no. `4`), are not the same.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "support"}], "=", 
   "\"\<Transformation of the input is not supported.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "target"}], "=", 
   "\"\<Could not determine target space group.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnitCellTransformation", "::", "one"}], "=", 
    "\"\<This space group, \[LeftGuillemet]`1`\[RightGuillemet] (no. `2`), \
has no alternative representations.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "UnitCellTransformation"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<CustomP\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReturnP\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<MoveIfCellEmpty\>\"", "\[Rule]", "True"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719819749369479*^9, 3.719819754436316*^9}, {
   3.719821718288604*^9, 3.719821721509223*^9}, {3.726153764130487*^9, 
   3.726153765873062*^9}, {3.756718324721581*^9, 3.756718347237896*^9}, {
   3.75671840599605*^9, 3.756718427251422*^9}, {3.756718478824583*^9, 
   3.756718621292338*^9}, {3.756719109075198*^9, 3.756719187154882*^9}, {
   3.756719485390335*^9, 3.756719569354444*^9}, {3.7567196451848793`*^9, 
   3.756719688894866*^9}, {3.7567200659782133`*^9, 3.756720107115233*^9}, {
   3.756720140266678*^9, 3.756720140393688*^9}, {3.756720286306657*^9, 
   3.7567203169908*^9}, {3.756720417369433*^9, 3.756720522664116*^9}, {
   3.756720574367663*^9, 3.756720608133807*^9}, {3.7567206506537733`*^9, 
   3.7567206691053762`*^9}, {3.756720777871066*^9, 3.75672077866041*^9}, {
   3.756721056190452*^9, 3.756721056574387*^9}, {3.828374262494665*^9, 
   3.828374288953616*^9}, 3.828374483066886*^9, {3.8284291271886053`*^9, 
   3.828429128466775*^9}, {3.830520330744956*^9, 3.830520337769804*^9}, {
   3.830520376138039*^9, 3.8305203978001966`*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"002b8d67-3227-4e39-859d-634fd603ec5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[120]:=",ExpressionUUID->"8c17ea4f-38f5-4482-9697-1c5923a70d6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnitCellTransformation", "[", 
   RowBox[{"crystal_String", ",", "userinput___"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "1.", " ", "Input", " ", "check", " ", 
       "and", " ", "preparation", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"1.", 
        RowBox[{"A", ".", " ", "Load"}], " ", "crystal", " ", "metric"}], ",",
        " ", 
       RowBox[{
       "space", " ", "group", " ", "and", " ", "crystal", " ", "system"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "G", ",", "G0", ",", "sg", ",", "sg0", ",", "sourceSG", ",", "fullHM", 
      ",", "posSG", ",", "SG", ",", "fullHMs", ",", "sourceSGnumber", ",", 
      "system", ",", "mainSourceQ", ",", "\[IndentingNewLine]", "P", ",", 
      "P1", ",", "P2", ",", "p", ",", "\[IndentingNewLine]", "centList", ",", 
      "axpList", ",", "tetList", ",", "hex3List", ",", "hexList", ",", 
      "monoList", ",", "\[IndentingNewLine]", "sourceSetting", ",", 
      "targetSetting", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"B", ".", " ", "Process"}], " ", "input", " ", "syntax", " ", 
        "and", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
      "inputRules", ",", "inputString", ",", "returnP", ",", "customP", ",", 
      "moveNegativeQ", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", "C", " ", "Process", " ", "source", " ", "setting"}], 
       " ", "*)"}], "\[IndentingNewLine]", "sourceCentring", ",", 
      "sourceCell", ",", "notes", ",", "relevantNotes", ",", "sourceO", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"D", ".", " ", "Interpret"}], " ", "space", " ", "group", " ",
         "from", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
      "targetSG", ",", "needtargetSG", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", "E", " ", "Process", " ", "target", " ", "setting"}], 
       " ", "*)"}], "\[IndentingNewLine]", "allowed", ",", "cmds", ",", "na", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"F", ".", " ", "Validating"}], " ", "input", " ", "values"}], 
       " ", "*)"}], "\[IndentingNewLine]", "targetCentring", ",", 
      "targetAxis", ",", "targetCC", ",", "targetAP", ",", "targetCell", ",", 
      "targetRS", ",", "\[IndentingNewLine]", "targetO", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"G", ".", " ", "Check"}], " ", "setting", " ", "constraints", 
        " ", "on", " ", "certain", " ", "space", " ", "groups"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"H", ".", " ", "Determining"}], " ", "new", " ", "space", " ",
         "group", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", 
      "targetSGnumber", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"I", ".", " ", "Common"}], " ", "transformation", " ", 
        "procedures"}], " ", "*)"}], "\[IndentingNewLine]", 
      "procedureCellCentring", ",", "procedureCellOrigin", ",", "shift", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "2.", " ", "Determining", " ", 
        "correct", " ", "transformation", " ", "matrices", " ", "*", 
        RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"A", ".", " ", "Triclinic"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"B", ".", " ", "Monoclinic"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "cmd", ",", "Q", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"C", ".", " ", "Orthorhombic"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"D", ".", " ", "Tetragonal"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"E", ".", " ", "Hexagonal"}], " ", "crystal", " ", "family"}],
        " ", "*)"}], "\[IndentingNewLine]", "sourceRS", ",", "M", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"F", ".", " ", "Cubic"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "3.", " ", "Carrying", " ", "out", " ",
         "transformations", " ", "*", 
        RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"3.", 
        RowBox[{"A", ".", " ", "Preparations"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "q", ",", "newlattice", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"3.", 
        RowBox[{"B", ".", " ", "Transforming"}], " ", "coordinates", " ", 
        "and", " ", "ADPs"}], " ", "*)"}], "\[IndentingNewLine]", "xyz", ",", 
      "newxyz", ",", "AnyInsideUnitCellQ", ",", "adps", ",", "U", ",", "n0", 
      ",", "n", ",", "newU", ",", "u", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "4.", " ", "Overwriting", " ", "entry",
         " ", "in", " ", "$CrystalData", " ", "*", 
        RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "targetFullHM", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "5.", " ", "Display", " ", "*", 
        RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Dummy", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", "temp", ",", "x", ",", "y", ",", "i"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "1.", " ", "Input", " ", "check", " ", 
      "and", " ", "preparation", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"1.", 
       RowBox[{"A", ".", " ", "Load"}], " ", "crystal", " ", "metric"}], ",", 
      " ", 
      RowBox[{
      "space", " ", "group", " ", "and", " ", "crystal", " ", "system"}]}], 
     " ", "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<GetCrystalSpaceGroup\>\"", ",", "crystal"}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"G", "=", 
      RowBox[{"G0", "=", 
       RowBox[{"GetCrystalMetric", "@", "crystal"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"sg0", "=", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"crystal", ",", "\"\<SpaceGroup\>\""}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "sg", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sourceSG", "=", 
      RowBox[{"fullHM", "=", 
       RowBox[{"sg", "[", 
        RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"posSG", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"$SpaceGroups", ",", "fullHM"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"SG", "=", 
      RowBox[{"$SpaceGroups", "[", 
       RowBox[{"posSG", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"fullHMs", "=", 
      RowBox[{"SG", "[", 
       RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sourceSGnumber", "=", 
      RowBox[{"SG", "[", "\"\<SpaceGroupNumber\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"system", "=", 
      RowBox[{"SG", "[", "\"\<CrystalSystem\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"mainSourceQ", "=", 
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"First", "@", "posSG"}]}], "\[LessEqual]", "3"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Default", " ", "transformation", " ", "matrices", " ", "and", " ", 
       "origin", " ", "shift"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"P", "=", 
      RowBox[{"P1", "=", 
       RowBox[{"P2", "=", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"p", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Frequently", " ", "used", " ", "lists"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"centList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<P\>\"", ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", 
        ",", "\"\<F\>\"", ",", "\"\<I\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"axpList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<abc\>\"", ",", "\"\<ba-c\>\"", ",", "\"\<cab\>\"", ",", 
        "\"\<-cba\>\"", ",", "\"\<bca\>\"", ",", "\"\<a-cb\>\""}], "}"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"tetList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<P\>\"", ",", "\"\<I\>\"", ",", "\"\<C1\>\"", ",", "\"\<F1\>\"", 
        ",", "\"\<C2\>\"", ",", "\"\<F2\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hex3List", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{"\"\<R1\>\"", ",", "\"\<R2\>\"", ",", "\"\<R3\>\""}], "}"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"hexList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<C1\>\"", ",", "\"\<C2\>\"", ",", "\"\<C3\>\"", ",", "\"\<H1\>\"", 
        ",", "\"\<H2\>\"", ",", "\"\<H3\>\"", ",", "\"\<D1\>\"", ",", 
        "\"\<D2\>\""}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"monoList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<Cb1\>\"", ",", "\"\<Cb2\>\"", ",", "\"\<Cb3\>\"", ",", 
        "\"\<Ac1\>\"", ",", "\"\<Ac2\>\"", ",", "\"\<Ac3\>\""}], "}"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Miscellaneous", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"sourceSetting", "=", 
      RowBox[{"targetSetting", "=", 
       RowBox[{"<|", "|>"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"B", ".", " ", "Process"}], " ", "input", " ", "syntax", " ", 
       "and", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"inputRules", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "userinput", "}"}], ",", "_Rule"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"inputString", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"{", "userinput", "}"}], ",", "_String"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"#", "===", "0"}], ",", "Null", ",", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"#", "===", "1"}], ",", 
         RowBox[{"inputString", "=", 
          RowBox[{"First", "@", "inputString"}]}], ",", "\[IndentingNewLine]",
          "\t\t", "True", ",", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
            "inputString"}], "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t\t", 
        "]"}], "&"}], "@", 
      RowBox[{"Length", "@", "inputString"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Save", " ", "option", " ", "settings"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"returnP", "=", 
      RowBox[{"inputRules", "[", "\"\<ReturnP\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"customP", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"inputRules", ",", "\"\<CustomP\>\"", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"moveNegativeQ", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"inputRules", ",", "\"\<MoveIfCellEmpty\>\"", ",", "True"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Remove", " ", "options", " ", "from", " ", "other", " ", "settings"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"KeyDropFrom", "[", 
      RowBox[{"inputRules", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ReturnP\>\"", ",", "\"\<CustomP\>\"", ",", 
         "\"\<CustomSymbol\>\""}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", "C", " ", "Process", " ", "source", " ", "setting"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "Load"}], " ", "source", " ", "setting", " ", 
       "from", " ", "source", " ", "space", " ", "group"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sourceSetting", "=", 
      RowBox[{
       RowBox[{"$GroupSymbolRedirect", "[", "sourceSG", "]"}], "[", 
       "\"\<Setting\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "Check"}], " ", "if", " ", "space", " ", 
       "group", " ", "has", " ", "alternative", " ", "settings"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sourceSetting", "===", 
         RowBox[{"<|", "|>"}]}], "&&", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Exception", ":", " ", 
          RowBox[{"Special", " ", "multiple", " ", "cells"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Tetragonal\>\"", ",", "\"\<Hexagonal\>\""}], "}"}], 
           ",", "system"}], "]"}]}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnitCellTransformation", "::", "one"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"GetSymmetryData", "[", 
           RowBox[{"sourceSG", ",", "\"\<Symbol\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", "sourceSGnumber"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "Check"}], " ", "cell", " ", "origin", " ", 
       "from", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"sg0", ",", 
        RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"temp", "===", "\"\<:2\>\""}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"sourceSetting", ",", 
         RowBox[{"\"\<CellOrigin\>\"", "\[Rule]", "2"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iv", ".", " ", 
        RowBox[{"Checking", " ", "'"}]}], 
       RowBox[{"Notes", "'"}], " ", "for", " ", "info", " ", "on", " ", 
       "input", " ", "setting"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"notes", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"$CrystalData", "@", "crystal"}], ",", "\"\<Notes\>\"", ",", 
        RowBox[{"<|", "|>"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"relevantNotes", "=", 
      RowBox[{"notes", "\[LeftDoubleBracket]", 
       RowBox[{"{", "\[IndentingNewLine]", "\t", 
        RowBox[{
        "\"\<RhombohedralSetting\>\"", ",", "\"\<MultipleCell\>\"", ",", 
         "\"\<CellCentring\>\"", ",", "\"\<CellOrigin\>\""}], "}"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sourceRS", ",", "sourceCell", ",", "sourceCentring", ",", "sourceO"}],
        "}"}], "=", 
      RowBox[{"Values", "@", "relevantNotes"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"sourceSetting", ",", 
       RowBox[{"DeleteMissing", "@", "relevantNotes"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"D", ".", " ", "Interpret"}], " ", "space", " ", "group", " ", 
       "from", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "No"}], " ", "input", " ", 
       RowBox[{"commands", " ", "--"}], " ", "prompt", " ", 
       RowBox[{"dialogue", "/", "UI"}], " ", 
       RowBox[{"(", "TODO", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "Custom"}], " ", "transformation", " ", 
       "matrix"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"customP", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"P1", "=", "customP"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MatrixQ", "@", "P1"}]}], ",", 
          RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", "P1"}],
             "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"targetSG", "=", "sourceSG"}], 
        RowBox[{"(*", " ", 
         RowBox[{"Use", " ", "same", " ", "space", " ", "group"}], " ", 
         "*)"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}]}]}], "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "Interpret"}], " ", "string", " ", "as", " ", 
       "target", " ", "space", " ", "group"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inputString", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "if", " ", "valid", " ", "space", " ", "group", " ", 
         "symbol"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "@", 
           RowBox[{"$GroupSymbolRedirect", "[", "inputString", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "sg"}], ",", 
             "inputString"}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"targetSG", "=", "inputString"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iv", ".", " ", "Parse"}], " ", "input", " ", "as", " ", 
       "setting", " ", "commands"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inputRules", "=!=", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"needtargetSG", "=", "True"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "whether", " ", "Hall", " ", "symbol", " ", "has", " ", 
         "been", " ", "used"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"$SpaceGroups", ",", "targetSG"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"temp", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
             "===", "\"\<HallString\>\""}], ",", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{"targetSG", "=", 
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"$SpaceGroups", "@@@", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Most", "@", 
                 RowBox[{"First", "@", "temp"}]}]}], "]"}], "[", 
              RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}]}], 
           "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", "E", " ", "Process", " ", "target", " ", "setting"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inputRules", "=!=", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Setting"}], " ", "commands", " ", "given", 
         " ", "in", " ", "association"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"targetSetting", "=", "inputRules"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Checking", " ", "commands"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"allowed", "=", 
         RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
          "\"\<UniqueAxis\>\"", ",", "\"\<CellChoice\>\"", ",", 
           "\"\<AxisPermutation\>\"", ",", "\[IndentingNewLine]", "\t\t\t", 
           "\"\<CellCentring\>\"", ",", "\"\<MultipleCell\>\"", ",", 
           "\[IndentingNewLine]", "\t\t\t", "\"\<RhombohedralSetting\>\"", 
           ",", "\"\<CellOrigin\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\t\t\t", 
        RowBox[{"cmds", "=", 
         RowBox[{"Keys", "@", "targetSetting"}]}], ";", "\[IndentingNewLine]",
         "\t\t\t", 
        RowBox[{"na", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"cmds", ",", "allowed"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"na", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "command"}], ",", 
             RowBox[{"First", "@", "na"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Checking", " ", "usefullness", " ", "of", " ", "commands"}],
          " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"system", "===", "\"\<Triclinic\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", "\"\<CellCentring\>\"", "}"}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"system", "===", "\"\<Monoclinic\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"\"\<UniqueAxis\>\"", ",", "\"\<CellChoice\>\""}], "}"}], 
           ",", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"system", "===", "\"\<Orthorhombic\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
            "\"\<AxisPermutation\>\"", ",", "\"\<CellCentring\>\"", ",", 
             "\"\<CellOrigin\>\""}], "}"}], ",", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"system", "===", "\"\<Tetragonal\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
            "\"\<CellCentring\>\"", ",", "\"\<MultipleCell\>\"", ",", 
             "\"\<CellOrigin\>\""}], "}"}], ",", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"system", "===", "\"\<Trigonal\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
            "\"\<MultipleCell\>\"", ",", "\"\<RhombohedralSetting\>\""}], 
            "}"}], ",", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"system", "===", "\"\<Hexagonal\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", "\"\<MultipleCell\>\"", "}"}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"system", "===", "\"\<Cubic\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"\"\<CellCentring\>\"", ",", "\"\<CellOrigin\>\""}], 
            "}"}]}], "\[IndentingNewLine]", "\t\t\t", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"targetSetting", "=", 
         RowBox[{"DeleteMissing", "@", 
          RowBox[{
          "targetSetting", "\[LeftDoubleBracket]", "temp", 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"targetSetting", "===", 
           RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "na"}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"ToLowerCase", "@", "system"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Setting"}], " ", "extracted", " ", "from", 
         " ", "target", " ", "space", " ", "group"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"ValueQ", "@", "targetSG"}]}], ",", 
          RowBox[{"targetSG", "=", "sourceSG"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"targetSetting", "=", 
         RowBox[{
          RowBox[{"$GroupSymbolRedirect", "[", "targetSG", "]"}], "[", 
          "\"\<Setting\>\"", "]"}]}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Supply", " ", "with", " ", "current", " ", "settings", " ", "if", " ", 
       "unspecified", " ", "in", " ", "input"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"targetSetting", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"sourceSetting", ",", "targetSetting"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Exception", ":", " ", 
       RowBox[{
        RowBox[{"No", " ", "'"}], 
        RowBox[{"RhombohedralSetting", "'"}], " ", 
        RowBox[{"for", " ", "'"}], 
        RowBox[{"R", "'"}], " ", "cell"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"targetSetting", "[", "\"\<MultipleCell\>\"", "]"}], "===", 
        "\"\<R\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{"targetSetting", ",", "\"\<RhombohedralSetting\>\""}], 
        "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"F", ".", " ", "Validating"}], " ", "input", " ", "values"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetCentring", "=", 
      RowBox[{"targetSetting", "[", "\"\<CellCentring\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetCentring"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
           "centList", ",", "\[IndentingNewLine]", "\t", "targetCentring"}], 
           "]"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
            "\[IndentingNewLine]", "\t", "targetCentring"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"UniqueAxis", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetAxis", "=", 
      RowBox[{"targetSetting", "[", "\"\<UniqueAxis\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetAxis"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\""}], 
              "}"}], ",", "targetAxis"}], "]"}]}], ",", "\[IndentingNewLine]",
           "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
             "\[IndentingNewLine]", "\t", "targetAxis"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"targetAxis", "=", 
         RowBox[{"ToLowerCase", "@", "targetAxis"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "'"}], 
       RowBox[{"CellChoice", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetCC", "=", 
      RowBox[{"targetSetting", "[", "\"\<CellChoice\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetCC"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "targetCC"}], 
           "]"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
            "\[IndentingNewLine]", "\t", "targetCC"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iv", ".", " ", "'"}], 
       RowBox[{"AxisPermutation", "'"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"targetAP", "=", 
      RowBox[{"targetSetting", "[", "\"\<AxisPermutation\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetAP"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "if", " ", "string"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringQ", "@", "targetAP"}]}], ",", "\[IndentingNewLine]",
           "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
             "\[IndentingNewLine]", "\t", "targetAP"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Support", " ", "for", " ", "various", " ", "input", " ", "forms"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"targetAP", "=", 
         RowBox[{"ToLowerCase", "@", 
          RowBox[{"StringReplace", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{"targetAP", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\"\<\!\(\*OverscriptBox[\(c\), \(_\)]\)\>\"", "\[Rule]", 
               "\"\<-c\>\""}], ",", 
              RowBox[{
              "\"\<\!\(\*OverscriptBox[\(C\), \(_\)]\)\>\"", "\[Rule]", 
               "\"\<-C\>\""}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "setting", " ", "value"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"axpList", ",", "targetAP"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"targetSetting", "[", "\"\<AxisPermutation\>\"", "]"}]}],
             "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Update", " ", "'"}], 
          RowBox[{"targetSetting", "'"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"targetSetting", "[", "\"\<AxisPermutation\>\"", "]"}], "=", 
         "targetAP"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"v", ".", " ", "'"}], 
       RowBox[{"MultipleCell", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetCell", "=", 
      RowBox[{"targetSetting", "[", "\"\<MultipleCell\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetCell"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Depending", " ", "on", " ", "crystal", " ", "system"}], 
         "..."}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"system", "===", "\"\<Tetragonal\>\""}], ",", "tetList", 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"system", "===", "\"\<Trigonal\>\""}], "||", 
            RowBox[{"system", "===", "\"\<Hexagonal\>\""}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<P\>\"", ",", "\"\<R\>\""}], "}"}], ",", 
              "hex3List", ",", "hexList", ",", "monoList"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"UnitCellTransformation", "::", "na"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"ToLowerCase", "@", "system"}]}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "setting", " ", "value"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"temp", ",", "targetCell"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalidSG"}], ",", 
             "\[IndentingNewLine]", "\t", "targetCell"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"vi", ".", " ", "'"}], 
       RowBox[{"RhombohedralSetting", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"targetRS", "=", 
      RowBox[{"inputRules", "[", "\"\<RhombohedralSetting\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetRS"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"targetRS", "=", 
         RowBox[{"ToLowerCase", "@", "targetRS"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "setting", " ", "value"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<obverse\>\"", ",", "\"\<reverse\>\""}], "}"}], ",",
              "targetRS"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "targetSetting", "[", "\"\<RhombohedralSetting\>\"", "]"}]}], 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Update", " ", "'"}], 
          RowBox[{"targetSetting", "'"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"targetSetting", "[", "\"\<RhombohedralSetting\>\"", "]"}], 
         "=", "targetRS"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"vii", ".", " ", "'"}], 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetO", "=", 
      RowBox[{"targetSetting", "[", "\"\<CellOrigin\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetO"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], ",", "targetO"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
            "\[IndentingNewLine]", "\t", "targetO"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"G", ".", " ", "Check"}], " ", "setting", " ", "constraints", 
       " ", "on", " ", "certain", " ", "space", " ", "groups"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "Target"}], " ", "setting", " ", "must", " ", 
       "be", " ", "a", " ", "subset", " ", "of", " ", "space", " ", "group", 
       " ", "settings"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"SubsetQ", "@@", 
          RowBox[{"Keys", "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Which", "[", 
              RowBox[{"(*", " ", 
               RowBox[{"Exceptions", ":", " ", 
                RowBox[{
                "Cell", " ", "centring", " ", "and", " ", "special", " ", 
                 "multiple", " ", "cells"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<Tetragonal\>\"", ",", "\"\<Hexagonal\>\""}], 
                  "}"}], ",", "system"}], "]"}], ",", "\[IndentingNewLine]", 
               "\t", 
               RowBox[{"KeyDrop", "[", 
                RowBox[{"targetSetting", ",", "\"\<MultipleCell\>\""}], "]"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Monoclinic\>\"", ",", "\"\<Orthorhombic\>\"", ",", 
                   "\"\<Tetragonal\>\"", ",", "\"\<Cubic\>\""}], "}"}], ",", 
                 "system"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"KeyDrop", "[", 
                RowBox[{"targetSetting", ",", "\"\<CellCentring\>\""}], "]"}],
                ",", "\[IndentingNewLine]", "True", ",", 
               "\[IndentingNewLine]", "\t", "targetSetting"}], "]"}]}], 
            "}"}]}]}], "\[IndentingNewLine]", "\t", ")"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnitCellTransformation", "::", "diffset"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Keys", "@", "sourceSetting"}], ",", 
          RowBox[{"Keys", "@", "targetSetting"}]}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"H", ".", " ", "Determining"}], " ", "new", " ", "space", " ", 
       "group", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "Determine"}], " ", "the", " ", "target", " ", 
       "space", " ", "group", " ", "from", " ", "setting", " ", "if", " ", 
       "needed"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"needtargetSG", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Main", " ", 
         RowBox[{"entry", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "@", 
           RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}]}], "===", 
          RowBox[{"Sort", "@", "targetSetting"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"targetSG", "=", 
          RowBox[{"SG", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], 
           "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Special", " ", "multiple", " ", 
           RowBox[{"cell", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"{", 
                 RowBox[{"tetList", ",", 
                  RowBox[{"{", "\"\<R\>\"", "}"}], ",", "hex3List", ",", 
                  "hexList", ",", "monoList"}], "}"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t\t\t", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"targetSG", "=", "sourceSG"}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"targetSGnumber", "=", "sourceSGnumber"}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"Goto", "[", "\"\<CheckSGformat\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "\t\t\t", "]"}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Check", " ", "alternatives"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"temp", "=", 
           RowBox[{
           "SG", "\[LeftDoubleBracket]", "\"\<AlternativeSettings\>\"", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"While", "[", 
           RowBox[{"True", ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", ">", 
                RowBox[{"Length", "@", "temp"}]}], ",", "\[IndentingNewLine]",
                "\t\t", 
               RowBox[{
                RowBox[{"Message", "[", 
                 RowBox[{"UnitCellTransformation", "::", "target"}], "]"}], 
                ";", 
                RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sort", "@", 
                 RowBox[{"temp", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "\"\<Setting\>\""}], 
                  "\[RightDoubleBracket]"}]}], "===", 
                RowBox[{"Sort", "@", "targetSetting"}]}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{"targetSG", "=", 
                 RowBox[{"temp", "\[LeftDoubleBracket]", 
                  RowBox[{
                  "i", ",", "\"\<Name\>\"", ",", 
                   "\"\<HermannMauguinFull\>\""}], 
                  "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                "\t\t", 
                RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"i", "++"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
        "\t\t", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "Check"}], " ", "if", " ", "source", " ", 
       "and", " ", "target", " ", "are", " ", "same", " ", "space", " ", 
       "group"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"targetSGnumber", "=", 
      RowBox[{"GetSymmetryData", "[", 
       RowBox[{"targetSG", ",", "\"\<SpaceGroupNumber\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sourceSGnumber", "\[NotEqual]", "targetSGnumber"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnitCellTransformation", "::", "differentsg"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"GetSymmetryData", "[", 
           RowBox[{"sourceSG", ",", "\"\<Symbol\>\""}], "]"}], ",", 
          "sourceSGnumber", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"GetSymmetryData", "[", 
           RowBox[{"targetSG", ",", "\"\<Symbol\>\""}], "]"}], ",", 
          "targetSGnumber"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "Check"}], " ", "whether", " ", "to", " ", 
       "use", " ", "formatted", " ", "symbol"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<CheckSGformat\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"targetSG", "=", 
      RowBox[{"ToStandardSetting", "@", "targetSG"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"I", ".", " ", "Common"}], " ", "transformation", " ", 
       "procedures"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"'", 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"procedureCellCentring", ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MissingQ", "@", "targetCentring"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MissingQ", "@", "sourceCentring"}], "||", 
             RowBox[{"!", 
              RowBox[{"ValueQ", "@", "sourceCentring"}]}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"sourceCentring", "=", 
             RowBox[{"StringTake", "[", 
              RowBox[{"fullHM", ",", "1"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"No", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
            "\t", 
           RowBox[{
            RowBox[{"sourceCentring", "===", "targetCentring"}], ",", 
            "\[IndentingNewLine]", "\t", "Null", ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Transformation", " ", 
              RowBox[{"from", " ", "'"}], 
              RowBox[{"P", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
            
            RowBox[{"sourceCentring", "===", "\"\<P\>\""}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"P1", "=", 
             RowBox[{"Inverse", "@", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{"targetCentring", "<>", "\"\<_to_P\>\""}], "]"}]}]}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Transformation", " ", 
              RowBox[{"to", " ", "'"}], 
              RowBox[{"P", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
            
            RowBox[{"targetCentring", "===", "\"\<P\>\""}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"P1", "=", 
             RowBox[{"$TransformationMatrices", "[", 
              RowBox[{"sourceCentring", "<>", "\"\<_to_P\>\""}], "]"}]}], ",",
             "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Transformation", " ", 
              RowBox[{"via", " ", "'"}], 
              RowBox[{"P", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
            "True", ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"P1", "=", 
              RowBox[{"$TransformationMatrices", "[", 
               RowBox[{"sourceCentring", "<>", "\"\<_to_P\>\""}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t", 
             RowBox[{"P2", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{"$TransformationMatrices", "[", 
                RowBox[{"targetCentring", "<>", "\"\<_to_P\>\""}], 
                "]"}]}]}]}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"'", 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"procedureCellOrigin", ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"targetSetting", ",", "\"\<CellOrigin\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sourceSetting", "[", "\"\<CellOrigin\>\"", "]"}], ",", 
             "targetO"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"shift", "=", 
           RowBox[{"SG", "\[LeftDoubleBracket]", 
            RowBox[{
            "\"\<AlternativeSettings\>\"", ",", "1", ",", 
             "\"\<OriginShift\>\""}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MissingQ", "@", "targetO"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Get", " ", "space", " ", "group", " ", "origin", " ", "shift", 
              " ", 
              RowBox[{"(", 
               RowBox[{"shift", " ", "vector"}], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"temp", "===", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], ",", "Null", ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"temp", "===", 
               RowBox[{"{", 
                RowBox[{"2", ",", "2"}], "}"}]}], ",", "Null", ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"temp", "===", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], ",", 
              RowBox[{"p", "=", "shift"}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"temp", "===", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}]}], ",", 
              RowBox[{"p", "=", 
               RowBox[{"-", "shift"}]}]}], "]"}]}], "\[IndentingNewLine]", 
           "\t", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "2.", " ", "Determining", " ", 
       "correct", " ", "transformation", " ", "matrices", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "system", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"A", ".", " ", 
        RowBox[{"Triclinic", " ", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Triclinic\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellCentring", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"B", ".", " ", 
        RowBox[{"Monoclinic", " ", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"Label", "[", "\"\<Monoclinic\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Prepartations", " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "target", " ", "axis", " ", "not", " ", "given"}], 
       ",", " ", 
       RowBox[{"use", " ", "same", " ", "axis", " ", "as", " ", "source"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "targetAxis"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "targetAxis"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"targetAxis", "=", 
        RowBox[{"sourceSetting", "[", "\"\<UniqueAxis\>\"", "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"UniqueAxis", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Target", " ", "unique", " ", "axis", " ", "transformation"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"allowed", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
       "\"\<UniqueAxisB_to_C\>\"", ",", "\[IndentingNewLine]", "\t\t", 
        "\"\<UniqueAxisB_to_A\>\"", ",", "\[IndentingNewLine]", "\t\t", 
        "\"\<UniqueAxisC_to_A\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"ToUpperCase", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sourceSetting", "[", "\"\<UniqueAxis\>\"", "]"}], ",", 
         "targetAxis"}], "}"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "whether", " ", "P", " ", "or", " ", "Q", " ", 
       RowBox[{"(", "inverse", ")"}], " ", "is", " ", "needed"}], " ", "*)"}],
      "\[IndentingNewLine]", "\t\t", 
     RowBox[{"cmd", "=", 
      RowBox[{"\"\<UniqueAxis\>\"", "<>", 
       RowBox[{"temp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "<>", "\"\<_to_\>\"", "<>", 
       RowBox[{
       "temp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"allowed", ",", "cmd"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Q", "=", "False"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Q", "=", "True"}], ";", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"cmd", "=", 
         RowBox[{"\"\<UniqueAxis\>\"", "<>", 
          RowBox[{
          "temp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "<>", "\"\<_to_\>\"", "<>", 
          RowBox[{
          "temp", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}]}]}], "\[IndentingNewLine]", "\t\t", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Target", " ", "unique", " ", "axis", " ", "transformation"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"SameQ", "@@", "temp"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"P1", "=", 
         RowBox[{"$TransformationMatrices", "[", "cmd", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"Q", ",", 
          RowBox[{"P1", "=", 
           RowBox[{"Inverse", "@", "P1"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"CellChoice", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "cell", " ", "choice", " ", "is", " ", "an", 
       " ", "available", " ", "setting"}], " ", "*)"}], "\t\t", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{
           RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}], ",", 
           "\"\<CellChoice\>\""}], "]"}]}], "\[IndentingNewLine]", "\t\t", "&&", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"targetSetting", ",", "\"\<CellChoice\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnitCellTransformation", "::", "command"}], ",", 
          "\"\<CellChoice\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MissingQ", "@", "targetCC"}]}], ",", "\[IndentingNewLine]",
          "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Matrix", " ", "for", " ", "checking", " ", "transformation", " ", 
           "signature"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"temp", "=", 
           RowBox[{"temp", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"sg", "[", 
              RowBox[{"\"\<Setting\>\"", ",", "\"\<CellChoice\>\""}], "]"}], 
             ",", "targetCC"}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Use", " ", "regular"}], ",", " ", "none", ",", " ", 
            RowBox[{"or", " ", "inverse", " ", "transformation"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"temp", "===", 
             RowBox[{"-", "1"}]}], ",", 
            RowBox[{"Q", "=", "True"}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"temp", "===", "0"}], ",", 
            RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"temp", "===", "1"}], ",", 
            RowBox[{"Q", "=", "False"}]}], "\[IndentingNewLine]", "\t\t", 
           "]"}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"cmd", "=", 
           RowBox[{"\"\<UniqueAxis\>\"", "<>", 
            RowBox[{"ToUpperCase", "@", "targetAxis"}], "\[IndentingNewLine]",
             "\t\t", "<>", "\"\<_CellChoice+1\>\""}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"P2", "=", 
           RowBox[{"$TransformationMatrices", "[", "cmd", "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{"Q", ",", 
            RowBox[{"P2", "=", 
             RowBox[{"Inverse", "@", "P2"}]}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\t\t", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"C", ".", " ", 
        RowBox[{"Orthorhombic", " ", "--"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Orthorhombic\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"AxisPermutation", "'"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetAP"}]}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "which", " ", "matrices", " ", "are", " ", "needed"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"ToUpperCase", "/@", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sourceSetting", "[", "\"\<AxisPermutation\>\"", "]"}], 
            ",", "targetAP"}], "}"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "@@", "temp"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Same", " ", "axis", " ", 
            RowBox[{"permutation", " ", "--"}], " ", "no", " ", "transform", 
            " ", "required"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          "Null", ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"temp", ",", "\"\<DEF\>\""}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Chain", " ", 
              RowBox[{"through", " ", "'"}], 
              RowBox[{"abc", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{"x", "=", 
              RowBox[{
               RowBox[{
               "temp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "<>", "\"\<_to_DEF\>\""}]}], ";", "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"y", "=", 
              RowBox[{
               RowBox[{
               "temp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                "<>", "\"\<_to_DEF\>\""}]}], ";", "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"$TransformationMatrices", "[", "x", "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{"$TransformationMatrices", "[", "y", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "OR", " ", "use", " ", "one", " ", "of", " ", "the", " ", "six", 
              " ", "transformations"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{"cmd", "=", 
              RowBox[{
               RowBox[{
               "temp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "<>", "\"\<_to_\>\"", "<>", 
               RowBox[{
               "temp", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"KeyExistsQ", "[", 
                RowBox[{"$TransformationMatrices", ",", "cmd"}], "]"}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"P1", "=", 
                RowBox[{"$TransformationMatrices", "[", "cmd", "]"}]}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"P1", "=", 
                RowBox[{"Inverse", "@", 
                 RowBox[{
                 "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t", 
                  
                  RowBox[{
                   RowBox[{
                   "temp", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "<>", "\"\<_to_\>\"", "<>", 
                   RowBox[{
                   "temp", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}]}]}], 
              "\[IndentingNewLine]", "\t\t", "]"}]}]}], "\[IndentingNewLine]",
            "\t\t", "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellOrigin", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"D", ".", " ", 
        RowBox[{"Tetragonal", " ", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"Label", "[", "\"\<Tetragonal\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Checks", " ", "and", " ", "updates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "sourceCentring"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "sourceCentring"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"sourceCentring", "=", 
        RowBox[{"StringTake", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinShort\>\""}], 
           "]"}], ",", "1"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "targetCentring"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "targetCentring"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"targetCentring", "=", 
        RowBox[{"StringTake", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"SG", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinShort\>\""}], 
           "]"}], ",", "1"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellCentring", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"MultipleCell", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"targetSetting", ",", "\"\<MultipleCell\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "already", " ", "transformed"}], ",", " ", 
         RowBox[{"transform", " ", 
          RowBox[{"to", " ", "'"}], 
          RowBox[{"P", "'"}], " ", 
          RowBox[{"or", " ", "'"}], 
          RowBox[{"I", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"tetList", ",", "sourceCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"P1", "=", 
           RowBox[{"Inverse", "@", 
            RowBox[{
            "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<TetragonalProjection\>\"", "<>", 
              RowBox[{"StringTake", "[", 
               RowBox[{"sourceCell", ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Transforming", " ", "to", " ", "target", " ", "cell"}], " ",
          "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<P\>\"", ",", "\"\<I\>\""}], "}"}], ",", 
             "targetCell"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"P2", "=", 
           RowBox[{
           "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<TetragonalProjection\>\"", "<>", 
             RowBox[{"StringTake", "[", 
              RowBox[{"targetCell", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}]}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "'"}], 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellOrigin", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"E", ".", " ", "Hexagonal"}], " ", "crystal", " ", 
       RowBox[{"family", " ", "--"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Trigonal\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Hexagonal\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Checks", " ", "and", " ", "updates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Reinstate", " ", "'"}], 
       RowBox[{"MultipleCell", "'"}], " ", "label"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "sourceCell"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "sourceCell"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"sourceCell", "=", 
        RowBox[{"sourceSetting", "[", "\"\<MultipleCell\>\"", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "rhombohedral", " ", "source", " ", "setting"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "sourceRS"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "sourceRS"}]}]}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Assume", " ", "main", " ", "space", " ", "group", " ", "setting"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"sourceRS", "=", "\"\<obverse\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "rhombohedral", " ", "target", " ", "setting"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "targetRS"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"hex3List", ",", "targetCell"}], "]"}]}], ",", 
       RowBox[{"targetRS", "=", "\"\<obverse\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MissingQ", "@", "targetRS"}]}], "&&", 
        RowBox[{"targetCell", "===", "\"\<R\>\""}]}], ",", 
       RowBox[{"targetCell", "=", "\"\<R1\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"A", ".", " ", "Rhombohedral"}], " ", "space", " ", "group"}],
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "146", ",", "148", ",", "155", ",", "160", ",", "161", ",", "166", 
           ",", "167"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"sourceSGnumber", ",", "targetSGnumber"}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "target", " ", "command"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "\"\<R\>\"", "}"}], ",", "hex3List", ",", 
                 "monoList"}], "}"}], "]"}]}], ",", "targetCell"}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalidSG"}], ",", 
             "\[IndentingNewLine]", "\t\t\t", "targetCell"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"a", ".", " ", "Rhombohedral"}], " ", "source"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"sourceCell", "===", "\"\<R\>\""}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"a", 
             RowBox[{".1", ".", " ", "Rhombohedral"}], " ", "target"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"targetCell", "===", "\"\<R\>\""}], "&&", 
             RowBox[{"MissingQ", "@", "targetRS"}]}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"a", 
              RowBox[{".2", ".", " ", "Triple"}], " ", "hexagonal", " ", 
              "target"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hex3List", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"P1", "=", 
             RowBox[{
             "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
              "\"\<Rhombohedral_to_\>\"", "<>", "targetCell", "<>", 
               "\"\<_\>\"", "<>", "targetRS"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"a", 
              RowBox[{".3", ".", " ", "Monoclinic"}], " ", "target"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t\t", "True", ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"P1", "=", 
             RowBox[{
             "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
              "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "targetCell"}], 
              "]"}]}]}], "\[IndentingNewLine]", "\t\t", "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"b", ".", " ", "Regular"}], " ", "hexagonal", " ", 
            RowBox[{"(", 
             RowBox[{"R1", ",", " ", "R2", ",", " ", "R3"}], ")"}], " ", 
            "source"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"hex3List", ",", "sourceCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"b", 
             RowBox[{".1", ".", " ", "Rhombohedral"}], " ", "target"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"targetCell", "===", "\"\<R\>\""}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"P1", "=", 
             RowBox[{"Inverse", "@", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_\>\"", "<>", "sourceCell", "<>", 
                "\"\<_\>\"", "<>", "sourceRS"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"b", 
              RowBox[{".2", ".", " ", "Triple"}], " ", "hexagonal", " ", 
              "target"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hex3List", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"sourceCell", "===", "targetCell"}], "&&", 
                RowBox[{"sourceRS", "===", "targetRS"}]}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{
               "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                
                RowBox[{
                "\"\<Rhombohedral_to_\>\"", "<>", "sourceCell", "<>", 
                 "\"\<_\>\"", "<>", "sourceRS"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_\>\"", "<>", "targetCell", "<>", 
                "\"\<_\>\"", "<>", "targetRS"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"b", 
              RowBox[{".3", ".", " ", "Monoclinic"}], " ", "target"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t\t", "True", ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sourceCell", "===", "\"\<R1\>\""}], "&&", 
               RowBox[{"sourceRS", "===", "\"\<obverse\>\""}]}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"P1", "=", 
               RowBox[{
               "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                
                RowBox[{
                "\"\<TripleHexagonal_to_Monoclinic_\>\"", "<>", 
                 "targetCell"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
              
              RowBox[{
               RowBox[{"P1", "=", 
                RowBox[{"Inverse", "@", 
                 RowBox[{
                 "$TransformationMatrices", "[", "\[IndentingNewLine]", 
                  "\t\t", 
                  RowBox[{"\"\<Rhombohedral_to_\>\"", 
                   RowBox[{
                   "sourceCell", "<>", "\"\<_\>\"", "<>", "sourceRS"}]}], 
                  "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"P2", "=", 
                RowBox[{
                "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                 RowBox[{
                 "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "targetCell"}], 
                 "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"c", ".", " ", "Monoclinic"}], " ", "source"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"monoList", ",", "sourceCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"c", 
             RowBox[{".1", ".", " ", "Rhombohedral"}], " ", "target"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"targetCell", "===", "\"\<R\>\""}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"P1", "=", 
             RowBox[{"Inverse", "@", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "sourceCell"}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"c", 
              RowBox[{".2", ".", " ", "Regular"}], " ", "hexagonal", " ", 
              RowBox[{"(", 
               RowBox[{"R1", ",", " ", "R2", ",", " ", "R3"}], ")"}], "l", 
              " ", "target"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hex3List", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"P1", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{
               "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                
                RowBox[{
                "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "sourceCell"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_\>\"", "<>", "targetCell", "<>", 
                "\"\<_\>\"", "<>", "targetRS"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"c", 
              RowBox[{".3", ".", " ", "Monoclinic"}], " ", "target"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t\t", "True", ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"sourceCell", "===", "targetCell"}], ",", 
               RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{
               "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                
                RowBox[{
                "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "sourceCell"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "targetCell"}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}]}], ",", "\[IndentingNewLine]", 
       "\t", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"B", ".", " ", "Transformation"}], " ", "of", " ", "the", 
         " ", "hexagonal", " ", "lattice"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", "\t", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "if", " ", "target", " ", "is", " ", "valid"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "\"\<P\>\"", "}"}], ",", "hexList", ",", 
                 "monoList"}], "}"}], "]"}]}], ",", "targetCell"}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalidSG"}], ",", 
             "\[IndentingNewLine]", "\t\t\t", "targetCell"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"StringCases", "[", 
             RowBox[{
              RowBox[{"Keys", "@", "$TransformationMatrices"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "StartOfString", "~~", "\"\<Hexagonal\>\"", "~~", "__"}]}], 
             "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "@", "sourceCell"}], ",", 
          RowBox[{"sourceCell", "=", "\"\<P\>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"a", ".", " ", "Primitive"}], " ", "hexagonal", " ", 
           "source"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"sourceCell", "===", "\"\<P\>\""}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"a", 
             RowBox[{".1", ".", " ", "No"}], " ", "change"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"targetCell", "===", "\"\<P\>\""}], ",", 
            RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"a", 
              RowBox[{".2", ".", " ", "Special"}], " ", "hexagonal", " ", 
              "target"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hexList", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"M", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "targetCell"}], "]"}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"$TransformationMatrices", "@@", "temp"}]}]}]}], 
           "\[IndentingNewLine]", "\t\t", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"b", ".", " ", "Special"}], " ", "hexagonal", " ", 
            "source"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"hexList", ",", "sourceCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"b", 
             RowBox[{".1", ".", " ", "To"}], " ", "primitive", " ", 
             "hexagonal", " ", "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{
            RowBox[{"targetCell", "===", "\"\<P\>\""}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"M", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "targetCell"}], "]"}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{
               RowBox[{"Inverse", "@", "$TransformationMatrices"}], "@@", 
               "temp"}]}]}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"b", 
              RowBox[{".2", ".", " ", "To"}], " ", "special", " ", 
              "hexagonal", " ", "target"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hexList", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"sourceCell", "===", "targetCell"}], ",", 
               RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"M", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "sourceCell"}], "]"}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"Inverse", "[", 
               RowBox[{"$TransformationMatrices", "@@", "temp"}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"M", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "targetCell"}], "]"}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{"$TransformationMatrices", "@@", "temp"}]}]}]}], 
           "\[IndentingNewLine]", "\t\t", "]"}]}], "\[IndentingNewLine]", 
         "\t\t", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<MatricesDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"F", ".", " ", 
        RowBox[{"Cubic", " ", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Cubic\>\"", "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], " ", 
     "\[IndentingNewLine]", "\t", "procedureCellCentring", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellOrigin", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "3.", " ", "Carrying", " ", "out", " ", 
       "transformations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"3.", 
       RowBox[{"A", ".", " ", "Preparations"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"P", "=", 
      RowBox[{"P1", ".", "P2"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"returnP", "===", "All"}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"{", 
         RowBox[{"P1", ",", "P2"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"returnP", ",", 
       RowBox[{"Return", "@", "P"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Q", "=", 
      RowBox[{"Inverse", "@", "P"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"q", "=", 
      RowBox[{"-", 
       RowBox[{"Q", ".", "p"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"G", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "P", "]"}], ".", "G", ".", "P"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"newlattice", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", 
           "\"\<\[Alpha]\>\"", ",", "\"\<\[Beta]\>\"", ",", 
           "\"\<\[Gamma]\>\""}], "}"}], "\[IndentingNewLine]", "\[Rule]", 
         RowBox[{"GetLatticeParameters", "[", 
          RowBox[{"G", ",", 
           RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}]}], "]"}]}], "]"}]}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"3.", 
       RowBox[{"B", ".", " ", "Transforming"}], " ", "coordinates", " ", 
       "and", " ", "ADPs"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Fractional", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"$CrystalData", "\[LeftDoubleBracket]", 
       RowBox[{
       "crystal", ",", "\[IndentingNewLine]", "\"\<AtomData\>\"", ",", "All", 
        ",", "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newxyz", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FractionalPart", "[", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{"Q", ",", "#"}], "]"}], "+", "q"}], "]"}], "&"}], "/@", 
        "xyz"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Move", " ", "content", " ", "to", " ", "unit", " ", "cell", " ", "if",
         " ", "empty"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", "moveNegativeQ"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"AnyInsideUnitCellQ", "[", "allCoordinates_", "]"}], ":=", 
         RowBox[{"Or", "@@", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"0", "\[LessEqual]", "#", "\[LessEqual]", "1"}], 
                "&"}]}], "]"}], "&"}], ",", "allCoordinates"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "newxyz"}], "\[LessEqual]", "100"}], "&&", 
           
           RowBox[{"!", 
            RowBox[{"AnyInsideUnitCellQ", "@", "newxyz"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"newxyz", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", "newxyz"}], "-", 
             RowBox[{"First", "@", 
              RowBox[{"Sort", "@", 
               RowBox[{"Floor", "@", "newxyz"}]}]}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Atomic", " ", "displacement", " ", "parameters"}], " ", "*)"}],
      "\t", 
     RowBox[{"adps", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"$CrystalData", "[", 
         RowBox[{"crystal", ",", "\"\<AtomData\>\""}], "]"}], ",", 
        "\"\<DisplacementParameters\>\"", ",", "0."}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"U", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", "#4", ",", "#5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"#4", ",", "#2", ",", "#6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"#5", ",", "#6", ",", "#3"}], "}"}]}], "}"}], "&"}], "@@",
          "#"}], "&"}], "/@", "adps"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", 
       RowBox[{"diagonal", " ", "'"}], 
       RowBox[{"N", "'"}], " ", "matrices"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"References", ":", "\[IndentingNewLine]", "https", ":"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"doi", ".", "org"}], "/", "10.1107"}], "/", 
          "S0108767311018216"}], "\[IndentingNewLine]", 
         RowBox[{"https", ":"}]}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{"doi", ".", "org"}], "/", "10.1107"}], "/", 
        "S0021889802008580"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"n0", "=", 
      RowBox[{"DiagonalMatrix", "@", 
       RowBox[{"Sqrt", "@", 
        RowBox[{"Diagonal", "@", 
         RowBox[{"Inverse", "@", "G0"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Inverse", "@", 
       RowBox[{"DiagonalMatrix", "@", 
        RowBox[{"Sqrt", "@", 
         RowBox[{"Diagonal", "@", 
          RowBox[{"Inverse", "@", "G"}]}]}]}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Transforming", " ", "ADPs"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newU", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "=", 
         RowBox[{
         "U", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "u", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"temp", "=", 
            RowBox[{"n0", ".", "u", ".", 
             RowBox[{"Transpose", "[", "n0", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"temp", "=", 
            RowBox[{"Q", ".", "temp", ".", 
             RowBox[{"Transpose", "[", "Q", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"temp", "=", 
            RowBox[{"Chop", "[", 
             RowBox[{"n", ".", "temp", ".", 
              RowBox[{"Transpose", "[", "n", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"temp", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"temp", ",", 
                RowBox[{"#", "/.", 
                 RowBox[{"List", "\[Rule]", "Sequence"}]}]}], "]"}], "&"}], "/@",
              "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"temp", "=", "u"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newU", ",", "temp"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "adps"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "4.", " ", "Overwriting", " ", "entry", 
       " ", "in", " ", "$CrystalData", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Determine", " ", "new", " ", "space", " ", "group", " ", "symbol", " ",
        "automatically"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Remove", " ", "old", " ", "cell", " ", "tag"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"targetSG", ",", 
          RowBox[{"{", 
           RowBox[{"-", "2"}], "}"}]}], "]"}], "===", "\"\<:\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"targetSG", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"targetSG", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "3"}]}], "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Update", " ", "space", " ", "group", " ", "symbol"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"targetO", "===", "2"}], "||", 
          RowBox[{
           RowBox[{"targetSetting", "[", "\"\<CellOrigin\>\"", "]"}], "===", 
           "2"}]}], ")"}], "&&", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"targetSG", ",", "\"\<:2\>\""}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"targetSG", "=", 
        RowBox[{"targetSG", "<>", "\"\<:2\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Get", " ", "full", " ", "Hermann"}], "\[Dash]", 
       RowBox[{"Mauguin", " ", "symbol"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"targetFullHM", "=", 
      RowBox[{"GetSymmetryData", "[", 
       RowBox[{"targetSG", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Set", " ", "new", " ", "symbol"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"$CrystalData", "[", 
       RowBox[{"crystal", ",", "\"\<SpaceGroup\>\""}], "]"}], "=", 
      "targetSG"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"New", " ", "lattice", " ", "parameters"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"$CrystalData", "[", 
        RowBox[{
        "crystal", ",", "\[IndentingNewLine]", "\t", 
         "\"\<LatticeParameters\>\""}], "]"}], ",", "newlattice"}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"New", " ", "fractional", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"$CrystalData", "\[LeftDoubleBracket]", 
       RowBox[{
       "crystal", ",", "\"\<AtomData\>\"", ",", "All", ",", 
        "\[IndentingNewLine]", "\t", "\"\<FractionalCoordinates\>\""}], 
       "\[RightDoubleBracket]"}], "=", "newxyz"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"New", " ", "ADPs"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"N", "@", "newU"}], ",", 
          RowBox[{
           RowBox[{"#", "\[Equal]", "0."}], "&"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"$CrystalData", "\[LeftDoubleBracket]", 
         RowBox[{
         "crystal", ",", "\"\<AtomData\>\"", ",", "All", ",", 
          "\[IndentingNewLine]", "\t", "\"\<DisplacementParameters\>\""}], 
         "\[RightDoubleBracket]"}], "=", "newU"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Updating", " ", "'"}], 
       RowBox[{"Notes", "'"}], " ", "and", " ", "adding", " ", "space", " ", 
       "group", " ", "notes", " ", "if", " ", "needed"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"a", ".", " ", 
        RowBox[{"Exception", ":", " ", 
         RowBox[{"default", " ", "space", " ", "group", " ", "setting"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Values", "@", 
          RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}]}]}], "===", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Sort", "@", 
         RowBox[{"DeleteMissing", "@", 
          RowBox[{"{", 
           RowBox[{"targetCell", ",", "targetRS", ",", "targetCentring"}], 
           "}"}]}]}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{"notes", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<MultipleCell\>\"", ",", "\"\<RhombohedralSetting\>\"", ",", 
           "\"\<CellCentring\>\""}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Write"}], " ", "both", " ", "multiple", " ", 
         "cell", " ", "and", " ", "rhombohedral", " ", "setting"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"targetSetting", ",", "\"\<MultipleCell\>\""}], "]"}], "&&",
            "\[IndentingNewLine]", "\t", 
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<P\>\"", ",", "\"\<I\>\""}], "}"}], ",", 
              "targetCell"}], "]"}]}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notes", ",", 
            RowBox[{"\"\<MultipleCell\>\"", "\[Rule]", "targetCell"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"hex3List", ",", "targetCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notes", ",", 
            RowBox[{"\"\<RhombohedralSetting\>\"", "\[Rule]", "targetRS"}]}], 
           "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"KeyDropFrom", "[", 
           RowBox[{"notes", ",", "\"\<RhombohedralSetting\>\""}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MissingQ", "@", "targetCentring"}]}], "&&", 
           RowBox[{"ValueQ", "@", "targetCentring"}], "&&", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "No", " ", "need", " ", "if", " ", "centring", " ", "is", " ", 
             "in", " ", "space", " ", "group", " ", "symbol"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"targetFullHM", ",", "1"}], "]"}], "\[NotEqual]", 
            "targetCentring"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notes", ",", 
            RowBox[{"\"\<CellCentring\>\"", "\[Rule]", "targetCentring"}]}], 
           "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Writing", " ", 
       RowBox[{"over", " ", "'"}], 
       RowBox[{"Notes", "'"}], " ", "or", " ", "removing", " ", "if", " ", 
       "empty"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"notes", "=!=", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"$CrystalData", "[", 
         RowBox[{"crystal", ",", "\"\<Notes\>\""}], "]"}], "=", 
        RowBox[{"Sort", "@", "notes"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "crystal", "]"}], ",", 
         "\"\<Notes\>\""}], "]"}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "5.", " ", "Display", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\"\<ShallowDisplayCrystal\>\"", ",", "crystal"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.761652384926148*^9, 3.7616523863182783`*^9}, {
   3.761652501261352*^9, 3.761652505333606*^9}, 3.7627930943264647`*^9, {
   3.78011729838146*^9, 3.780117327859271*^9}, {3.780119006161199*^9, 
   3.780119008331439*^9}, {3.780119063591*^9, 3.780119073849944*^9}, {
   3.7801194423151493`*^9, 3.780119442821135*^9}, {3.780119849545116*^9, 
   3.780119925444474*^9}, {3.780120042088119*^9, 3.780120073059046*^9}, {
   3.780120118377701*^9, 3.780120118582106*^9}, {3.7801209002648973`*^9, 
   3.780120901295123*^9}, {3.780120946545774*^9, 3.780121001302227*^9}, {
   3.7801213344858503`*^9, 3.78012134048417*^9}, {3.7801215867393312`*^9, 
   3.780121586874241*^9}, {3.780123138803892*^9, 3.780123159065637*^9}, {
   3.780123276268249*^9, 3.7801233645501337`*^9}, {3.7801234304595127`*^9, 
   3.780123456756074*^9}, {3.78012348866334*^9, 3.7801234890526867`*^9}, {
   3.780123674412871*^9, 3.780123792511475*^9}, {3.780123838562603*^9, 
   3.7801239843231697`*^9}, {3.7801241361874857`*^9, 3.780124138114052*^9}, {
   3.78012418250989*^9, 3.780124312361519*^9}, {3.780124350946904*^9, 
   3.780124352858677*^9}, {3.78012440254611*^9, 3.780124403317322*^9}, {
   3.780124438359673*^9, 3.780124493451413*^9}, {3.7801245475582867`*^9, 
   3.780124594888576*^9}, {3.780125169059753*^9, 3.780125173946314*^9}, 
   3.7801252225281143`*^9, {3.7801255423203993`*^9, 3.7801255537217703`*^9}, {
   3.780125601910986*^9, 3.780125718299121*^9}, {3.780125748712925*^9, 
   3.780125803540703*^9}, {3.780125925749563*^9, 3.780125970562964*^9}, {
   3.780126007281138*^9, 3.780126042629672*^9}, {3.780126119836372*^9, 
   3.780126120258316*^9}, {3.780126167751857*^9, 3.780126227715029*^9}, {
   3.780126310831773*^9, 3.780126473065201*^9}, {3.780126509406781*^9, 
   3.780126549474765*^9}, {3.780126580451379*^9, 3.780126580791086*^9}, {
   3.780126631667992*^9, 3.780126684644767*^9}, 3.7801268061744957`*^9, {
   3.780127041732708*^9, 3.780127163368679*^9}, {3.780127204691481*^9, 
   3.780127212193478*^9}, {3.780127257343275*^9, 3.78012729452597*^9}, {
   3.7801273250863657`*^9, 3.780127393432397*^9}, {3.780136714530459*^9, 
   3.780136717652457*^9}, {3.786968732176543*^9, 3.7869687332192173`*^9}, {
   3.7916966093215322`*^9, 3.791696629261942*^9}, {3.80798177624828*^9, 
   3.807981782094791*^9}, {3.828373398683319*^9, 3.828373404282134*^9}, {
   3.828373453604198*^9, 3.828373485111*^9}, {3.828373687931286*^9, 
   3.828373689080722*^9}, 3.8283741945906353`*^9, {3.8283743342814417`*^9, 
   3.82837439485105*^9}, {3.828374454261076*^9, 3.828374477783244*^9}, {
   3.828429171563862*^9, 3.8284291719540653`*^9}, {3.830520477278492*^9, 
   3.830520503635295*^9}, {3.830520651254993*^9, 3.830520690584463*^9}, {
   3.830520858443737*^9, 3.830520884545114*^9}, {3.830521075821329*^9, 
   3.830521099848713*^9}, {3.830521185228622*^9, 3.830521185350196*^9}, {
   3.8305212480336237`*^9, 3.830521252558981*^9}, {3.830521361125311*^9, 
   3.830521420371934*^9}, {3.830521519830009*^9, 3.8305215774341087`*^9}, {
   3.830521617009082*^9, 3.8305216752479753`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[253]:=",
 CellID->24626837,ExpressionUUID->"ade9cd56-742e-4abe-b629-b108f832e0e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}, {3.704963743924171*^9, 3.70496374747575*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[122]:=",ExpressionUUID->"17c8cc51-e5d7-4d46-958e-16766b1d3a8d"]
}, Closed]],

Cell[CellGroupData[{

Cell["$CrystalData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105586847556*^9, {3.682241958663896*^9, 
   3.682241959378373*^9}},ExpressionUUID->"add68b39-fb64-4b80-a0c4-\
919ece50dbaa"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[956]:=",ExpressionUUID->"2dd49249-807f-4381-99d0-72670c1d9bf6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$CrystalData", "::", "type"}], "=", 
   "\"\<The atomic displacement type \[LeftGuillemet]`1`\[RightGuillemet] is \
not recognised.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$CrystalData", "::", "missing"}], "=", 
   "\"\<Could not find \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.6827638542963467`*^9, 
  3.682763915713602*^9}, {3.684127075557765*^9, 3.684127078014738*^9}, {
  3.686643559763439*^9, 3.686643568230299*^9}, {3.687071196515999*^9, 
  3.687071197034121*^9}, {3.6870742005298843`*^9, 3.6870742032175207`*^9}, {
  3.704639240714119*^9, 3.7046392573277903`*^9}, {3.70463928912825*^9, 
  3.704639290872594*^9}, {3.7567210074119587`*^9, 3.756721035518736*^9}, {
  3.756721861661763*^9, 3.756721861852038*^9}},
 CellLabel->
  "In[957]:=",ExpressionUUID->"b016d6cd-095b-4c26-ade9-c6bfdc5047d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[959]:=",ExpressionUUID->"0752d111-0cb8-4137-ba4e-d26d52f3cf8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CrystalData", ":=", 
   RowBox[{"$CrystalData", "=", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<UserData\>\"", ",", "\"\<CrystalData.m\>\""}],
         "}"}], "]"}], ",", "\"\<Package\>\""}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106475250269*^9, {3.6681967313149557`*^9, 
   3.668196733689879*^9}, {3.6822419646436443`*^9, 3.68224201227671*^9}, {
   3.683952010557645*^9, 3.683952016431329*^9}, {3.683961792986683*^9, 
   3.683961793311263*^9}, {3.683963496892716*^9, 3.6839635022396917`*^9}, {
   3.683964204041622*^9, 3.68396420579144*^9}, {3.685074117426893*^9, 
   3.685074118118947*^9}, {3.685087550914459*^9, 3.6850875516532784`*^9}, {
   3.685088292962201*^9, 3.6850882971592493`*^9}, {3.717735641959559*^9, 
   3.717735646517908*^9}, {3.7177401759152184`*^9, 3.717740183511532*^9}, {
   3.717740453355052*^9, 3.7177404568146343`*^9}, 3.7190621124925756`*^9, {
   3.719062147618576*^9, 3.7190621487295322`*^9}, 3.743865412920252*^9, {
   3.7870349054622383`*^9, 3.787034942726324*^9}, {3.7870350285297403`*^9, 
   3.787035096824231*^9}, {3.787035126840096*^9, 3.787035151582593*^9}, {
   3.787035181830802*^9, 3.787035185821926*^9}, {3.7870362711991777`*^9, 
   3.78703627245366*^9}, {3.787036486681343*^9, 3.787036497478454*^9}, {
   3.787056692688287*^9, 3.7870567207335253`*^9}, {3.787057953693668*^9, 
   3.787057979275473*^9}, {3.787465737008095*^9, 3.787465743886174*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[960]:=",ExpressionUUID->"f8212125-a2ca-4094-8884-833f678b9dc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[961]:=",ExpressionUUID->"87bd7bb4-6c20-4ea7-94d6-1a70b1cfc7cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["$GroupSymbolRedirect", "Subchapter",
 CellChangeTimes->{{3.667913451914239*^9, 3.6679134538492537`*^9}, {
  3.684163933759*^9, 
  3.6841639348934793`*^9}},ExpressionUUID->"7b854d2f-6184-406f-ae48-\
d6e45f49627b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[962]:=",ExpressionUUID->"fe1d8a71-614b-4b76-9971-ab8ac37e2ba7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$GroupSymbolRedirect", "::", "missing"}], "=", 
   "\"\<Could not find \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.743865457526416*^9},
 CellLabel->
  "In[963]:=",ExpressionUUID->"15426d9b-19ef-4b09-9501-308bf71d3d1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[964]:=",ExpressionUUID->"b0a6635c-f7a5-44fc-b454-0077c438005f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$GroupSymbolRedirect", ":=", 
   RowBox[{"$GroupSymbolRedirect", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<GroupSymbolRedirect.m\>\""}], "}"}], "]"}], ",", 
      "\"\<Package\>\""}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810603792123*^9, {3.6679134762424593`*^9, 3.667913479353848*^9}, {
   3.667913525824753*^9, 3.667913566815895*^9}, 3.667922449570759*^9, {
   3.6841639593346243`*^9, 3.684163962012776*^9}, {3.6842110127827377`*^9, 
   3.684211025479542*^9}, {3.717735294206521*^9, 3.717735298759973*^9}, 
   3.7177407296502457`*^9, 3.743865413427245*^9, 3.743865457564193*^9, {
   3.743866819119553*^9, 3.7438668271551237`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[965]:=",ExpressionUUID->"e1c423fe-b62e-43fe-927a-065a9aeacc42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[966]:=",ExpressionUUID->"612c253e-24fe-4b72-814a-7d3c2d7b7d3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["$LaueClasses", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, {3.682653951735921*^9, 
   3.682653956328863*^9}, {3.682654662784809*^9, 3.682654665448794*^9}, {
   3.682682388932765*^9, 3.682682393482984*^9}, 
   3.6827484886268806`*^9},ExpressionUUID->"06b5fb2f-000f-4a6a-b2f4-\
9e3ae327d4e0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[967]:=",ExpressionUUID->"7efeb3e4-248a-4e2e-aac9-a27e4b647062"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$LaueClasses", "::", "notLaue"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid Laue \
class.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
  3.682673965137134*^9}, {3.682748313468276*^9, 3.682748314787609*^9}, {
  3.6827550362995253`*^9, 3.6827550568881807`*^9}},
 CellLabel->
  "In[968]:=",ExpressionUUID->"ea238091-872e-463a-b525-f1fc51e04df7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[969]:=",ExpressionUUID->"a24d3083-c179-43bf-809a-1a56fa0cebf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$LaueClasses", ":=", 
   RowBox[{"$LaueClasses", "=", 
    RowBox[{"$PointGroups", "\[LeftDoubleBracket]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<-1\>\"", ",", "\"\<2/m\>\"", ",", "\"\<mmm\>\"", ",", 
       "\"\<4/m\>\"", ",", "\"\<4/mmm\>\"", ",", "\"\<-3\>\"", ",", 
       "\"\<-3m\>\"", ",", "\"\<6/m\>\"", ",", "\"\<6/mmm\>\"", ",", 
       "\"\<m-3\>\"", ",", "\"\<m-3m\>\""}], "}"}], 
     "\[RightDoubleBracket]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.682653967735579*^9, 3.682653986558272*^9}, 
   3.68267392867793*^9, {3.682674020022552*^9, 3.6826740225343513`*^9}, {
   3.6826741539192142`*^9, 3.682674156130925*^9}, {3.682748319844285*^9, 
   3.682748354898033*^9}, {3.682748401076961*^9, 3.682748460879797*^9}, {
   3.682753925716236*^9, 3.68275392829173*^9}, {3.683964155468678*^9, 
   3.6839641888501*^9}, {3.683964347600403*^9, 3.683964350017806*^9}, {
   3.71774020225284*^9, 3.71774021766649*^9}, {3.756721109918017*^9, 
   3.756721135945716*^9}, {3.758530565590005*^9, 3.758530568582108*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[970]:=",ExpressionUUID->"3b95f838-c51f-43a1-a5c0-bd6a147544cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[971]:=",ExpressionUUID->"3c229f2c-7475-4287-84a4-1926e3a2e150"]
}, Closed]],

Cell[CellGroupData[{

Cell["$MaXrdChangelog", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9, {3.6856909140644207`*^9, 3.6856909161285*^9}, {
   3.6856955548132*^9, 3.685695556654903*^9}, {3.6858508531390133`*^9, 
   3.685850855128764*^9}, {3.6858530128919897`*^9, 
   3.6858530141106453`*^9}},ExpressionUUID->"fc57d0ce-f8d4-43a4-922b-\
9aee960d915b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[972]:=",ExpressionUUID->"4f4ea584-26e0-4abf-b60e-e61474c6a8d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$MaXrdChangelog", "::", "fileMissing"}], "=", 
   "\"\<Cannot find the `1` file (`2`).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.744701964988227*^9, 3.7447019775276012`*^9}, {
  3.744705774667625*^9, 3.74470577651867*^9}},
 CellLabel->
  "In[973]:=",ExpressionUUID->"aa4a05bd-c885-4545-a0c1-96b0aa571ab1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[974]:=",ExpressionUUID->"bd1b9cb3-7eae-4635-8916-46ac261a3de0"],

Cell[BoxData[
 RowBox[{"$MaXrdChangelog", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dir", "=", "$MaXrdPath"}], ",", "\[IndentingNewLine]", 
      "pacletFile", ",", "packletVersion", ",", "\[IndentingNewLine]", 
      "packageSymbols", ",", "\[IndentingNewLine]", "changelogFile", ",", 
      "log", ",", "current", ",", "content", ",", "new", ",", "t", ",", 
      "title", ",", "post", ",", "\[IndentingNewLine]", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Load", " ", "current", " ", 
      RowBox[{"version", " ", "--"}], " ", "could", " ", "be", " ", 
      "undeployed"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"pacletFile", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<PacletInfo.m\>\"", ",", 
          RowBox[{"{", "#", "}"}]}], "]"}], "\[IndentingNewLine]", "\t", 
        "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"dir", ",", 
         RowBox[{"ParentDirectory", "@", "dir"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"pacletFile", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"pacletFile", ",", "_String", ",", "2", ",", "1"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pacletFile", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"$MaXrdChangelog", "::", "fileMissing"}], ",", 
          "\"\<paclet\>\"", ",", "pacletFile"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"pacletFile", "=", 
        RowBox[{
        "pacletFile", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"packletVersion", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Association", "@@", 
         RowBox[{"Import", "@", "pacletFile"}]}], ")"}], "[", "Version", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Latest", " ", "entry", " ", "in", " ", "the", " ", "changelog"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"changelogFile", "=", 
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<Changelog.md\>\"", ",", 
         RowBox[{"{", "dir", "}"}], ",", "2"}], "]"}], "\[LeftDoubleBracket]",
        "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "changelogFile"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"$MaXrdChangelog", "::", "fileMissing"}], ",", 
          "\"\<changelog\>\"", ",", "changelogFile"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"log", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"changelogFile", ",", "\"\<Text\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"current", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{"log", ",", 
          RowBox[{
           RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<## Version \>\"", "~~", "packletVersion", "~~", 
             "\"\<\\n\>\"", "~~", "news__", "~~", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<\\n\\n\\n##\>\"", ",", "EndOfString"}], "}"}]}], 
            "]"}], "\[RuleDelayed]", "news"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Content", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"content", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"First", "@", "current"}], ",", 
        RowBox[{"\"\<\\n\>\"", ".."}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"content", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringDrop", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "content"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"content", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TextCell", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", "#", "}"}], "]"}], ",", "\"\<Item\>\""}], "]"}], 
        "&"}], "/@", "content"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Format", " ", "function", " ", "names"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"packageSymbols", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Cases", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"First", "@", "$MaXrdFunctions"}]}], ",", "_Hyperlink"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"new", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"content", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1", ",", "1"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"t", "=", 
         RowBox[{"{", 
          RowBox[{
          "StartOfString", ",", "\"\<\>\"", ",", "\"\<.\>\"", ",", 
           "\"\<,\>\"", ",", "\"\<!\>\""}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"new", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Row", "@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{"temp", ",", 
             RowBox[{"{", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{
                  RowBox[{"a", ":", "t"}], "~~", "\"\<**\>\"", "~~", "x__", 
                  "~~", "\"\<**\>\"", "~~", 
                  RowBox[{"b", ":", "t"}]}], "]"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"a", "<>", "x", "<>", "b"}], ",", "Bold"}], "]"}]}],
                ",", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{
                  RowBox[{"a", ":", "t"}], "~~", "\"\<_\>\"", "~~", "x__", 
                  "~~", "\"\<_\>\"", "~~", 
                  RowBox[{"b", ":", "t"}]}], "]"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"a", "<>", "x", "<>", "b"}], ",", "Italic"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{
                  RowBox[{"a", ":", "t"}], "~~", "\"\<*\>\"", "~~", "x__", 
                  "~~", "\"\<*\>\"", "~~", 
                  RowBox[{"b", ":", "t"}]}], "]"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"a", "<>", "x", "<>", "b"}], ",", "Italic"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{
                  RowBox[{"a", ":", "t"}], "~~", "\"\<`\>\"", "~~", "x__", 
                  "~~", "\"\<`\>\"", "~~", 
                  RowBox[{"b", ":", "t"}]}], "]"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"packageSymbols", ",", "x"}], "]"}], ",", 
                  "\[IndentingNewLine]", "\t", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"\"\<paclet:/MaXrd/Ref/\>\"", "<>", "x"}]}], 
                   "]"}], ",", "\[IndentingNewLine]", "\t", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"a", "<>", "x", "<>", "b"}], ",", 
                    "\"\<Program\>\""}], "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "\t", "}"}]}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "content"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"new", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"first", "=", 
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringQ", "@", "first"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"first", ",", "2"}], "]"}], "===", "\"\<# \>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"TextCell", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                 RowBox[{"StringDrop", "[", 
                  RowBox[{"first", ",", "2"}], "]"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\"\<Subsubsection\>\""}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"TextCell", "[", 
             RowBox[{"#", ",", "\"\<Item\>\""}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], "/@", "new"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Title", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"title", "=", 
      RowBox[{"TextCell", "@", 
       RowBox[{"Row", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "\"\<Text\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"FontSize", "\[Rule]", "24"}], ",", "\[IndentingNewLine]", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Source Sans Pro\>\""}], ",",
             "\[IndentingNewLine]", "Italic"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Changelog for the MaXrd\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{
           "\"\< package \[LongDash] version \>\"", "<>", 
            "packletVersion"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Log", " ", "file", " ", "link"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"MaXrd`Private`$changelogFile", "=", "changelogFile"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"post", "=", 
      RowBox[{"TextCell", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mouseover", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Click here\>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"SystemOpen", "@", "MaXrd`Private`$changelogFile"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"BaseStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<GenericButton\>\"", ",", "#"}], "}"}]}]}], 
                "]"}], "&"}], "/@", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.269993", ",", "0.308507", ",", "0.6"}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.823529411764706", ",", "0.490196078431373", ",", 
                  "0.133333333333333"}], "]"}]}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           "\"\< to see the complete changelog of all versions.\>\""}], 
          "\[IndentingNewLine]", "\t", "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", "\"\<Item\>\""}], "\[IndentingNewLine]", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Print", " ", "all", " ", "cells"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"CreateDocument", "[", 
      RowBox[{
       RowBox[{"CellGroup", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "title", "}"}], ",", "new", ",", 
          RowBox[{"{", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "}"}], "]"}], "}"}], ",", 
          RowBox[{"{", "post", "}"}]}], "]"}]}], ",", 
       RowBox[{"CellGrouping", "\[Rule]", "Manual"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.6858508794369802`*^9, 3.685851146037546*^9}, {
   3.68585121114992*^9, 3.685851280289015*^9}, 3.6858513574491*^9, {
   3.685851389819318*^9, 3.685851393199477*^9}, {3.685851448013804*^9, 
   3.685851468479097*^9}, {3.68585162634411*^9, 3.685851699951235*^9}, {
   3.685851732892767*^9, 3.685851756809786*^9}, {3.685851807362144*^9, 
   3.685851815772572*^9}, {3.68585196618266*^9, 3.685852138263727*^9}, {
   3.685852235750094*^9, 3.6858522365276747`*^9}, {3.6858522750473747`*^9, 
   3.685852332014473*^9}, {3.6858524195245256`*^9, 3.685852420498811*^9}, {
   3.685852504804266*^9, 3.685852554664555*^9}, {3.685852817998569*^9, 
   3.685852820146702*^9}, 3.685852952188924*^9, {3.685852994526354*^9, 
   3.685852995475964*^9}, {3.68585543783108*^9, 3.68585544060902*^9}, {
   3.685855488558816*^9, 3.6858555385610723`*^9}, {3.685855573250226*^9, 
   3.685855763700778*^9}, {3.685855851657669*^9, 3.685855852734428*^9}, {
   3.6858559139304743`*^9, 3.685855914258336*^9}, {3.685856239900159*^9, 
   3.685856262844842*^9}, {3.685856527496449*^9, 3.685856568389841*^9}, {
   3.6858568891698923`*^9, 3.685856933036331*^9}, {3.6858570617305326`*^9, 
   3.685857110952784*^9}, {3.68585731285113*^9, 3.6858573298197603`*^9}, {
   3.711090388381749*^9, 3.7110904197704077`*^9}, {3.711090477790125*^9, 
   3.711090484369767*^9}, {3.711090518594022*^9, 3.7110905852935963`*^9}, {
   3.711090653000636*^9, 3.711090655741624*^9}, {3.7110907671426897`*^9, 
   3.711090782835785*^9}, {3.711090860971977*^9, 3.71109086259262*^9}, {
   3.711090959745782*^9, 3.711090967053129*^9}, {3.711091009998396*^9, 
   3.711091039295238*^9}, {3.711091080387536*^9, 3.7110911470464497`*^9}, {
   3.711091200639996*^9, 3.7110912044568157`*^9}, {3.711091292152358*^9, 
   3.711091313206541*^9}, {3.711091353732622*^9, 3.711091403647649*^9}, {
   3.711091481462607*^9, 3.71109151894308*^9}, {3.711091632624161*^9, 
   3.711091717389189*^9}, {3.71109185872059*^9, 3.711091861967021*^9}, {
   3.711091946652444*^9, 3.711091971071022*^9}, {3.711092276474365*^9, 
   3.7110922822364807`*^9}, {3.7110923266602297`*^9, 3.711092418136904*^9}, {
   3.7110926600546913`*^9, 3.711092679060191*^9}, {3.711092967628902*^9, 
   3.711092990557047*^9}, {3.711093092232058*^9, 3.7110931032927217`*^9}, {
   3.7110941766360893`*^9, 3.711094222225339*^9}, {3.7111001051898737`*^9, 
   3.7111001231017036`*^9}, {3.7111001905784187`*^9, 
   3.7111001919174843`*^9}, {3.711100229611718*^9, 3.71110028989635*^9}, {
   3.7111003990242023`*^9, 3.711100410534198*^9}, {3.7111009526865053`*^9, 
   3.711101001463057*^9}, {3.711101154332079*^9, 3.711101224050899*^9}, {
   3.711101261074651*^9, 3.711101261490097*^9}, {3.711111309005494*^9, 
   3.7111113149567223`*^9}, {3.711111584397849*^9, 3.7111116137395678`*^9}, {
   3.711111668826914*^9, 3.711111671154889*^9}, {3.717740557990252*^9, 
   3.717740559718543*^9}, {3.717844834750647*^9, 3.717844842990161*^9}, {
   3.717844911097979*^9, 3.7178449798351316`*^9}, 3.7178450671949778`*^9, {
   3.717847515018527*^9, 3.717847531681776*^9}, {3.717847570289398*^9, 
   3.7178475709838257`*^9}, {3.717847630871354*^9, 3.717847673934496*^9}, {
   3.717847707390752*^9, 3.717847733479759*^9}, {3.7178478013992147`*^9, 
   3.7178478197700977`*^9}, {3.7178479374742823`*^9, 
   3.7178479508794403`*^9}, {3.7178479916090937`*^9, 
   3.7178479933046007`*^9}, {3.717848077188743*^9, 3.717848116387651*^9}, {
   3.717848162123921*^9, 3.717848199714807*^9}, {3.7305446425674753`*^9, 
   3.7305446426937847`*^9}, {3.74197755323807*^9, 3.741977565044792*^9}, {
   3.7419776011222754`*^9, 3.74197762060358*^9}, {3.741977704704419*^9, 
   3.7419777458066597`*^9}, {3.7419777822095003`*^9, 3.741977799016658*^9}, {
   3.7419778726158953`*^9, 3.741977882831718*^9}, {3.741977943825979*^9, 
   3.741978014505892*^9}, {3.7419780466003513`*^9, 3.741978048695863*^9}, {
   3.741978251009742*^9, 3.741978276564124*^9}, {3.7419783071577873`*^9, 
   3.741978397435583*^9}, {3.741978450625723*^9, 3.741978453351595*^9}, 
   3.741978496441799*^9, {3.741978679692935*^9, 3.7419786962586*^9}, {
   3.741978797178348*^9, 3.741978920621462*^9}, {3.741978955743288*^9, 
   3.741979013493878*^9}, {3.742013150776678*^9, 3.742013152291946*^9}, {
   3.742013347683981*^9, 3.742013352250639*^9}, {3.742014249296727*^9, 
   3.7420142824916067`*^9}, {3.7420143691466217`*^9, 3.742014515511938*^9}, {
   3.7438353898690853`*^9, 3.743835395364455*^9}, {3.743865386171597*^9, 
   3.743865413246286*^9}, {3.74417212296462*^9, 3.7441721237795973`*^9}, {
   3.744576257675291*^9, 3.744576282172411*^9}, {3.744576398538041*^9, 
   3.7445764081597443`*^9}, {3.744576446129293*^9, 3.7445764807339487`*^9}, {
   3.74457658296546*^9, 3.744576598243783*^9}, {3.74457669197841*^9, 
   3.744576694202406*^9}, {3.744576775409717*^9, 3.744576806279276*^9}, {
   3.744576859880999*^9, 3.744576872278058*^9}, {3.744576907494125*^9, 
   3.7445769468362703`*^9}, {3.74457698567721*^9, 3.744576990803774*^9}, {
   3.7445770673632307`*^9, 3.744577073644486*^9}, {3.7445771966446743`*^9, 
   3.744577218774494*^9}, {3.744577252448473*^9, 3.744577378922546*^9}, {
   3.744577429875523*^9, 3.744577444145987*^9}, {3.744577569560322*^9, 
   3.7445775698946447`*^9}, {3.744577627391795*^9, 3.7445776534131937`*^9}, {
   3.744577962863385*^9, 3.744577964670371*^9}, {3.744578028421026*^9, 
   3.744578034458921*^9}, {3.744578086419478*^9, 3.7445782015445337`*^9}, {
   3.744579363627138*^9, 3.744579366047567*^9}, {3.7445793966834707`*^9, 
   3.7445794602820272`*^9}, {3.7445798194976*^9, 3.744579819795539*^9}, {
   3.744605225995677*^9, 3.744605282984518*^9}, {3.744605813565586*^9, 
   3.744605838101604*^9}, {3.7446058755895576`*^9, 3.744605895091887*^9}, {
   3.744605947275201*^9, 3.744606002331894*^9}, {3.7446060414592*^9, 
   3.744606170816766*^9}, {3.744606251519023*^9, 3.7446062639967318`*^9}, {
   3.744606918007711*^9, 3.74460703306057*^9}, {3.7446070772604437`*^9, 
   3.7446070793948593`*^9}, {3.7446071406200447`*^9, 3.744607169161171*^9}, {
   3.7446072927074757`*^9, 3.7446073334952717`*^9}, {3.7446073849840727`*^9, 
   3.744607428380995*^9}, {3.744608522173952*^9, 3.7446085940257807`*^9}, {
   3.7446086774832983`*^9, 3.7446086791437397`*^9}, {3.744656227749956*^9, 
   3.7446562401250668`*^9}, {3.7446953726839323`*^9, 3.744695395671322*^9}, {
   3.744697365813425*^9, 3.744697378756146*^9}, {3.744698338800084*^9, 
   3.744698371143552*^9}, {3.744698432073358*^9, 3.744698448525362*^9}, {
   3.74469849476709*^9, 3.744698495528509*^9}, {3.74470073310918*^9, 
   3.744700733572353*^9}, {3.7447011996844273`*^9, 3.74470124217128*^9}, {
   3.7447014704449*^9, 3.7447014711855288`*^9}, {3.744701515798829*^9, 
   3.744701537101858*^9}, {3.744701776455665*^9, 3.744701793522031*^9}, {
   3.744701928156464*^9, 3.744701953311462*^9}, {3.744701987002932*^9, 
   3.744701998531692*^9}, {3.744702052084428*^9, 3.744702126412898*^9}, {
   3.7447022419471893`*^9, 3.744702251821184*^9}, {3.744702566437923*^9, 
   3.744702566809853*^9}, {3.744702674913261*^9, 3.744702677439649*^9}, {
   3.744702843378893*^9, 3.7447028535709352`*^9}, {3.744703434795974*^9, 
   3.7447034563581877`*^9}, {3.7447057851762037`*^9, 3.744705809609007*^9}, {
   3.744706191004787*^9, 3.74470620026297*^9}, {3.7447075276752357`*^9, 
   3.744707527939266*^9}, {3.745228305744067*^9, 3.745228305889896*^9}, {
   3.758530570836678*^9, 3.758530577492134*^9}, 3.762793094388019*^9, {
   3.774164029554824*^9, 3.774164050495023*^9}, {3.774164110464476*^9, 
   3.774164140352367*^9}, {3.774164208622939*^9, 3.7741642103634033`*^9}, {
   3.7741642420285473`*^9, 3.774164244183579*^9}, {3.774164303194777*^9, 
   3.774164305293841*^9}, {3.7741643483953543`*^9, 3.7741643500408287`*^9}, {
   3.77416441989038*^9, 3.774164450064631*^9}, {3.7741644922440443`*^9, 
   3.7741645644850473`*^9}, {3.774164640790614*^9, 3.774164642768549*^9}, {
   3.774164713470037*^9, 3.774164986801591*^9}, {3.774165028122813*^9, 
   3.774165031693864*^9}, {3.77416522820056*^9, 3.774165270646071*^9}, {
   3.7741653212877617`*^9, 3.774165354824238*^9}, {3.77416545109302*^9, 
   3.774165490214654*^9}, {3.774166084040082*^9, 3.774166121421043*^9}, {
   3.774166614224572*^9, 3.774166643769486*^9}, {3.774166713817071*^9, 
   3.7741667225631*^9}, {3.774166786436904*^9, 3.774166837859783*^9}, {
   3.7741669116485777`*^9, 3.774167112622373*^9}, {3.774167143481319*^9, 
   3.774167213442287*^9}, 3.774167612132515*^9, {3.774167669917344*^9, 
   3.774167707928784*^9}, {3.774167819124415*^9, 3.774167922194045*^9}, {
   3.774168084398872*^9, 3.7741681111870203`*^9}, {3.774168158776019*^9, 
   3.774168231044503*^9}, {3.774230945366987*^9, 3.77423095261309*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[975]:=",ExpressionUUID->"650931f9-b3fc-4a98-89fc-e51ae248dab1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[976]:=",ExpressionUUID->"2d3d6400-40dd-4757-ba5a-87c877cc0bd1"]
}, Closed]],

Cell[CellGroupData[{

Cell["$MaXrdFunctions", "Subchapter",
 CellChangeTimes->{{3.668244759916127*^9, 3.668244763731201*^9}, {
  3.713626366980631*^9, 
  3.713626369530772*^9}},ExpressionUUID->"61da682c-70e7-4e25-8dd4-\
c23887544663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[977]:=",ExpressionUUID->"29523b3f-2d1a-4e89-991e-006ef1c51b64"],

Cell[BoxData[
 RowBox[{"$MaXrdFunctions", ":=", 
  RowBox[{"$MaXrdFunctions", "=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "subContexts", ",", "packagefunctions", ",", "packagef", ",", 
       "hyperlinks"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subContexts", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Contexts", "[", "\"\<MaXrd`*\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<Private\>\""}], "]"}]}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"packagefunctions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", 
          RowBox[{"Names", "[", 
           RowBox[{"#", "<>", "\"\<*\>\""}], "]"}]}], "&"}], "/@", 
        "subContexts"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"packagef", "=", 
       RowBox[{"Sort", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"packagefunctions", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hyperlinks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Hyperlink", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\"\<paclet:/MaXrd/Ref/\>\"", "<>", "#"}]}], "]"}], "&"}], 
        "/@", "packagef"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Multicolumn", "[", 
       RowBox[{"hyperlinks", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713623088872505*^9, 3.713623106119204*^9}, {
   3.713623186734174*^9, 3.7136232132815657`*^9}, {3.713623366346613*^9, 
   3.713623368970223*^9}, {3.713626122233032*^9, 3.7136261850235577`*^9}, {
   3.713626220800157*^9, 3.713626291053178*^9}, 3.713626339101788*^9, {
   3.713626877829962*^9, 3.7136268851354218`*^9}, {3.727504132324382*^9, 
   3.727504137418166*^9}, {3.727504218377234*^9, 3.7275042185729313`*^9}, {
   3.730379717502055*^9, 3.730379732426323*^9}, {3.7303798043568077`*^9, 
   3.7303798185246687`*^9}, 3.740979502729867*^9, 3.743835409169471*^9, 
   3.743865334511272*^9, {3.7438667194945087`*^9, 3.743866739385027*^9}, {
   3.758530579040091*^9, 3.758530581366087*^9}, 3.7627930943994513`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[978]:=",ExpressionUUID->"900599e2-2862-4bae-bf30-609b69c8b89a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[979]:=",ExpressionUUID->"b4386782-d2d6-4437-9f11-27c196be6f41"]
}, Closed]],

Cell[CellGroupData[{

Cell["$MaXrdPath", "Subchapter",
 CellChangeTimes->{{3.667913451914239*^9, 3.6679134538492537`*^9}, {
   3.717738980592308*^9, 3.717738983802504*^9}, 
   3.717742520174604*^9},ExpressionUUID->"c52e0155-7a5e-4dff-868b-\
a6ca2cc52357"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[980]:=",ExpressionUUID->"87cba174-8eb9-48c7-9795-79d128fe1f93"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$MaXrdPath", "::", "MissingDefinitionsFile"}], "=", 
   "\"\<Unable to locate the package definition file.\>\""}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
  3.682673965137134*^9}, {3.6836256108304625`*^9, 3.683625616992581*^9}, {
  3.774169807898777*^9, 3.7741698336860647`*^9}},
 CellLabel->
  "In[981]:=",ExpressionUUID->"3d368b6a-f4c1-4842-b9c1-aa4d4c878e6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[982]:=",ExpressionUUID->"1c67f76e-59bf-432c-80a1-1abe7e448eec"],

Cell[BoxData[
 RowBox[{"$MaXrdPath", ":=", 
  RowBox[{"$MaXrdPath", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"files", ",", "prioritisedFile", ",", "definitionFile"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"files", "=", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<MaXrd/Core/Definitions.m\>\"", ",", "$Path"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"files", "===", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"$MaXrdPath", "::", "MissingDefinitionsFile"}], "]"}], ";", 
         
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"prioritisedFile", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"files", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Mathematica\>\"", ",", "\"\<Applications\>\"", ",", 
               "\"\<MaXrd\>\"", ",", "\"\<Core\>\"", ",", 
               "\"\<Definitions.m\>\""}], "}"}], "]"}]}], "]"}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"definitionFile", "=", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"prioritisedFile", "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          "prioritisedFile", ",", "files"}], "]"}], "\[LeftDoubleBracket]", 
        "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DirectoryName", "[", 
       RowBox[{"definitionFile", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810603792123*^9, {3.6679134762424593`*^9, 3.667913479353848*^9}, {
   3.667913525824753*^9, 3.667913566815895*^9}, 3.667922449570759*^9, {
   3.685082755359603*^9, 3.685082756664475*^9}, {3.717739409772593*^9, 
   3.717739416678906*^9}, 3.74383541548083*^9, 3.7438654133513536`*^9, {
   3.744604981977673*^9, 3.744604984510038*^9}, {3.758530583329006*^9, 
   3.758530584853346*^9}, {3.774169583907053*^9, 3.7741696922906923`*^9}, {
   3.7741697729745293`*^9, 3.774169792171378*^9}, {3.7741698389416847`*^9, 
   3.7741699046577473`*^9}, 3.787465993242594*^9, {3.78746657325975*^9, 
   3.7874665909712267`*^9}, 3.7874666411461067`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[983]:=",ExpressionUUID->"e73f3768-2bad-4d03-a8d1-a29f34e62e74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[984]:=",ExpressionUUID->"057e9184-8caa-42ee-aecd-8d66dcfa47a8"]
}, Closed]],

Cell[CellGroupData[{

Cell["$MaXrdVersion", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9, {3.6856909140644207`*^9, 3.6856909161285*^9}, {
   3.6856955548132*^9, 3.685695556654903*^9}, {3.6858508531390133`*^9, 
   3.685850855128764*^9}},ExpressionUUID->"f4d98b8b-16cb-4306-ab78-\
20631d01a235"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[985]:=",ExpressionUUID->"ba77561c-c6b4-493b-95db-7a135e29f3d3"],

Cell[BoxData[
 RowBox[{"$MaXrdVersion", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dir", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Load", " ", "current", " ", "version"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"dir", "=", "$MaXrdPath"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"p", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dir", ",", "\"\<PacletInfo.m\>\""}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"First", "@", 
      RowBox[{"StringCases", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"p", ",", "\"\<String\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "Whitespace", "~~", "\"\<Version -> \\\"\>\"", "~~", "v__", "~~", 
           "\"\<\\\"\>\""}], "]"}], "\[RuleDelayed]", "v"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.6858508794369802`*^9, 3.685851146037546*^9}, {
   3.68585121114992*^9, 3.685851280289015*^9}, 3.6858513574491*^9, {
   3.685851389819318*^9, 3.685851393199477*^9}, {3.685851448013804*^9, 
   3.685851468479097*^9}, {3.68585162634411*^9, 3.685851699951235*^9}, {
   3.685851732892767*^9, 3.685851756809786*^9}, {3.685851807362144*^9, 
   3.685851815772572*^9}, {3.68585196618266*^9, 3.685852138263727*^9}, {
   3.685852235750094*^9, 3.6858522365276747`*^9}, {3.6858522750473747`*^9, 
   3.685852332014473*^9}, {3.6858524195245256`*^9, 3.685852420498811*^9}, {
   3.685852504804266*^9, 3.685852554664555*^9}, {3.685852817998569*^9, 
   3.6858528943497467`*^9}, {3.717740744855871*^9, 3.717740749249337*^9}, 
   3.74386541348313*^9, 3.743865651851873*^9, {3.744656582709256*^9, 
   3.7446565885912313`*^9}, {3.744656669791733*^9, 3.744656671621607*^9}, 
   3.762793094420011*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[986]:=",ExpressionUUID->"2a8e05c7-c234-4fbf-adc9-a186b57ae625"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[987]:=",ExpressionUUID->"8dd327d8-90d5-488a-a928-69ba85e1ba87"]
}, Closed]],

Cell[CellGroupData[{

Cell["$PeriodicTable", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105586847556*^9, {3.682241958663896*^9, 3.682241959378373*^9}, {
   3.684837792510861*^9, 3.6848377965834007`*^9}, {3.716871395312171*^9, 
   3.71687139746762*^9}, {3.716875096229806*^9, 
   3.71687509881006*^9}},ExpressionUUID->"ff40e9a0-dee2-405e-9fc8-\
76e17471f08b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[988]:=",ExpressionUUID->"3ebe5dd7-a89d-4422-9486-b4dd81d7c77c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$PeriodicTable", "::", "data"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.716875468133792*^9},
 CellLabel->
  "In[989]:=",ExpressionUUID->"fd308505-8dc3-426e-bced-871ffd7618e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[990]:=",ExpressionUUID->"d5b1edd6-3db6-49f6-8436-bce28ab4e52c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$PeriodicTable", ":=", 
   RowBox[{"$PeriodicTable", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<PeriodicTable.m\>\""}], "}"}], "]"}], ",", "\"\<Package\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106475250269*^9, {3.6681967313149557`*^9, 
   3.668196733689879*^9}, {3.6822419646436443`*^9, 3.68224201227671*^9}, {
   3.683952010557645*^9, 3.683952016431329*^9}, {3.683961792986683*^9, 
   3.683961793311263*^9}, {3.683963496892716*^9, 3.6839635022396917`*^9}, {
   3.683964204041622*^9, 3.68396420579144*^9}, {3.684837841202917*^9, 
   3.6848378571558647`*^9}, {3.7168715395254583`*^9, 3.716871544624135*^9}, {
   3.716875466491188*^9, 3.716875471562603*^9}, {3.7177356550597057`*^9, 
   3.717735658940343*^9}, {3.71774022412532*^9, 3.7177402275061703`*^9}, {
   3.717740292420858*^9, 3.717740296349738*^9}, 3.743865412979974*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[991]:=",ExpressionUUID->"96c9f1d0-6daa-4c40-bae4-dac8053a1e69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[992]:=",ExpressionUUID->"98e78ab4-7c6f-427f-bf5e-d07d3d78818c"]
}, Closed]],

Cell[CellGroupData[{

Cell["$PointGroups", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, {3.682653951735921*^9, 
   3.682653956328863*^9}, {3.682654662784809*^9, 3.682654665448794*^9}, {
   3.682682396844181*^9, 3.682682399130838*^9}, 
   3.683540068227051*^9},ExpressionUUID->"7830a492-2526-4392-a221-\
4683dc92f50e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[993]:=",ExpressionUUID->"a04577a1-abe3-4b79-b321-27b4f6390a30"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$PointGroups", "::", "symbol"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
   3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
   3.682673965137134*^9}, {3.6827448103688383`*^9, 3.682744814802577*^9}, 
   3.6835400730631437`*^9, 3.683962753616817*^9, 3.683962930309997*^9},
 CellLabel->
  "In[994]:=",ExpressionUUID->"bdbaefd0-2f69-49ba-baa7-24386f521d67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[995]:=",ExpressionUUID->"09cbb547-ba1f-4673-b32b-bb7b4bd5525a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$PointGroups", ":=", 
   RowBox[{"$PointGroups", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<PointGroups.m\>\""}], "}"}], "]"}], ",", "\"\<Package\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.682653967735579*^9, 3.682653986558272*^9}, 
   3.68267392867793*^9, {3.682674020022552*^9, 3.6826740225343513`*^9}, {
   3.6826741539192142`*^9, 3.682674156130925*^9}, {3.68274481796653*^9, 
   3.6827448258026237`*^9}, 3.683540074217566*^9, {3.683951936766644*^9, 
   3.683951973478841*^9}, {3.683956166711895*^9, 3.683956184411542*^9}, {
   3.683956417196473*^9, 3.683956418066112*^9}, {3.683961462919252*^9, 
   3.68396154474839*^9}, {3.683961661862376*^9, 3.6839616629603977`*^9}, {
   3.683961724218606*^9, 3.683961724688292*^9}, 3.683962755396636*^9, {
   3.6839629325079536`*^9, 3.683962946272767*^9}, 3.683963808604355*^9, {
   3.6839638719964027`*^9, 3.683963874849616*^9}, {3.683964121228015*^9, 
   3.683964133461834*^9}, {3.68507416316628*^9, 3.6850741636682453`*^9}, {
   3.717735248551661*^9, 3.717735254555373*^9}, {3.717740411085682*^9, 
   3.717740418544074*^9}, 3.743865413035719*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[996]:=",ExpressionUUID->"010fcd9c-6221-4cec-81cd-e4aa1d885fbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[997]:=",ExpressionUUID->"6f1ac2bb-7b28-4432-98a0-af06d8a8191f"]
}, Closed]],

Cell[CellGroupData[{

Cell["$SpaceGroups", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, {3.682653951735921*^9, 
   3.682653956328863*^9}, {3.682654662784809*^9, 
   3.682654665448794*^9}},ExpressionUUID->"e765e096-6642-4149-a0e5-\
6643c19a91fc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[998]:=",ExpressionUUID->"516c34e4-8034-4d37-9884-a7bda84da711"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$SpaceGroups", "::", "symbol"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
  3.682673965137134*^9}, {3.6836256108304625`*^9, 3.683625616992581*^9}},
 CellLabel->
  "In[999]:=",ExpressionUUID->"7288c4c2-08be-47b4-b86d-750cd76401a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[1000]:=",ExpressionUUID->"a389fa81-eb07-4155-a8a4-f3bde9024235"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$SpaceGroups", ":=", 
   RowBox[{"$SpaceGroups", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<SpaceGroups.m\>\""}], "}"}], "]"}], ",", "\"\<Package\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.682653967735579*^9, 3.682653986558272*^9}, 
   3.68267392867793*^9, {3.682674020022552*^9, 3.6826740225343513`*^9}, {
   3.6826741539192142`*^9, 3.682674156130925*^9}, {3.68362561327971*^9, 
   3.6836256181626034`*^9}, {3.683951992468999*^9, 3.683951997388053*^9}, 
   3.6839617760181627`*^9, {3.6839634791727533`*^9, 3.683963485387003*^9}, {
   3.683964172298621*^9, 3.683964173046796*^9}, {3.68507417341897*^9, 
   3.685074173905542*^9}, {3.717735270644731*^9, 3.717735275889902*^9}, 
   3.7177404443170958`*^9, 3.743865413098959*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[1001]:=",ExpressionUUID->"4dd2fffa-249f-4f7c-9c82-f5e2041ef301"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[1002]:=",ExpressionUUID->"ff6d02c1-b4cf-4e87-8bf4-534378e78d2d"]
}, Closed]],

Cell[CellGroupData[{

Cell["$TransformationMatrices", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105586847556*^9, {3.682241958663896*^9, 3.682241959378373*^9}, {
   3.6823261988097973`*^9, 3.68232620251079*^9}, {3.6823262335807447`*^9, 
   3.6823262349234543`*^9}, 3.683968853065186*^9, {3.704529586053939*^9, 
   3.70452958946212*^9}},ExpressionUUID->"2d02966a-4407-43d5-9748-\
e6fb30c8d747"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[1003]:=",ExpressionUUID->"8824f6b8-e5c5-45bc-85f7-af61a0ab0133"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$TransformationMatrices", "::", "incompatible"}], "=", 
   "\"\<Incompatible transformation request.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
  3.682673965137134*^9}, {3.6836256108304625`*^9, 3.683625616992581*^9}, {
  3.704605089218741*^9, 3.704605090581002*^9}, {3.704605126799118*^9, 
  3.704605145762704*^9}},
 CellLabel->
  "In[1004]:=",ExpressionUUID->"f32ace2b-4e71-48c5-bfa0-5916f5dca6d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[1005]:=",ExpressionUUID->"c5abf466-942d-44a8-b229-45ddf915b38b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TransformationMatrices", ":=", 
   RowBox[{"$TransformationMatrices", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<TransformationMatrices.m\>\""}], "}"}], "]"}], ",", 
      "\"\<Package\>\""}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.682653967735579*^9, 3.682653986558272*^9}, 
   3.68267392867793*^9, {3.682674020022552*^9, 3.6826740225343513`*^9}, {
   3.6826741539192142`*^9, 3.682674156130925*^9}, {3.68362561327971*^9, 
   3.6836256181626034`*^9}, {3.683951992468999*^9, 3.683951997388053*^9}, 
   3.6839617760181627`*^9, {3.6839634791727533`*^9, 3.683963485387003*^9}, {
   3.683964172298621*^9, 3.683964173046796*^9}, {3.68507417341897*^9, 
   3.685074173905542*^9}, {3.704605096591127*^9, 3.7046051029972353`*^9}, 
   3.704962715541875*^9, {3.71774051631643*^9, 3.7177405247020407`*^9}, 
   3.743865413160309*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[1006]:=",ExpressionUUID->"b51af76a-2005-45cd-af30-335cb8b4c520"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[1007]:=",ExpressionUUID->"a18b9dac-f211-45a6-9ba0-e7484a6c036f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package finalisation", "Chapter",
 CellChangeTimes->{{3.667810135289062*^9, 3.667810137240119*^9}, {
  3.717738383999324*^9, 
  3.7177383921610823`*^9}},ExpressionUUID->"b72d0a28-4fbc-4bdf-9cff-\
1ade661ab141"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650291995903159*^9, 3.650291999656385*^9}, {
  3.655794914392253*^9, 3.655794915028521*^9}, {3.6570168680070057`*^9, 
  3.657016910052175*^9}, {3.657182226988536*^9, 3.657182262339521*^9}, {
  3.6571965249075317`*^9, 3.657196529083351*^9}, {3.657222486965454*^9, 
  3.6572224883724937`*^9}, {3.6572225935629787`*^9, 3.657222623281169*^9}, {
  3.667732206857939*^9, 3.667732209689768*^9}, {3.667810145961068*^9, 
  3.66781016027987*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[1008]:=",ExpressionUUID->"361671c5-ddec-43ca-9329-375b9664a064"]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->{},
InitializationCellWarning->False,
WindowSize->{840, 931},
WindowMargins->{{420, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"55c2302a-eccf-411f-9e15-4997501fc36e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 129, 3, 29, "Input",ExpressionUUID->"717bc492-8b71-4cb4-912b-e06415e6c835"],
Cell[CellGroupData[{
Cell[712, 27, 626, 13, 98, "Title",ExpressionUUID->"8ae99ef7-4796-40a0-8315-c09dd1887448"],
Cell[CellGroupData[{
Cell[1363, 44, 355, 6, 69, "Chapter",ExpressionUUID->"aac40e3d-1e33-41a0-92be-c5785be8619f"],
Cell[1721, 52, 5097, 86, 316, "Input",ExpressionUUID->"19f648e6-3db9-4a0b-a8e4-df365c8a9759"],
Cell[6821, 140, 1085, 29, 131, "Input",ExpressionUUID->"f1765770-b59d-4699-a23c-fcf12cb9f26c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[7943, 174, 252, 4, 58, "Chapter",ExpressionUUID->"6d7fc55f-b1c0-4e10-b031-7816175be8be"],
Cell[CellGroupData[{
Cell[8220, 182, 473, 7, 64, "Subchapter",ExpressionUUID->"c41cb460-4373-45c5-bb69-a9a10140c89a"],
Cell[8696, 191, 624, 12, 46, "Input",ExpressionUUID->"c699d47a-52db-414c-84e1-23f2cab35bf3",
 InitializationCell->True],
Cell[9323, 205, 4427, 84, 446, "Input",ExpressionUUID->"ca57549c-ac09-4526-958f-ff373aaafc57",
 InitializationCell->True],
Cell[13753, 291, 1219, 20, 49, "Input",ExpressionUUID->"ffc0a3df-ec8f-4f45-ba45-7a1411d47cb7",
 InitializationCell->True],
Cell[14975, 313, 30664, 553, 2210, "Input",ExpressionUUID->"9efca070-debe-4ee4-afe4-a79f70e6c480",
 InitializationCell->True],
Cell[45642, 868, 1142, 19, 46, "Input",ExpressionUUID->"dab4db01-5156-4ede-8605-c500a591c019",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46821, 892, 463, 7, 48, "Subchapter",ExpressionUUID->"77412c77-a615-40d2-af30-4a1af2d05756"],
Cell[47287, 901, 624, 12, 45, "Input",ExpressionUUID->"602f3b46-faf4-43c9-a94c-47ed02be07df",
 InitializationCell->True],
Cell[47914, 915, 1468, 34, 259, "Input",ExpressionUUID->"3ef5e913-88ad-40ec-ba4a-85d36ad7ee94",
 InitializationCell->True],
Cell[49385, 951, 1219, 20, 49, "Input",ExpressionUUID->"45a3af02-dcf5-482d-beb8-8271513cc2eb",
 InitializationCell->True],
Cell[50607, 973, 12570, 240, 1024, "Input",ExpressionUUID->"d82dc607-3bbe-4a04-846a-00b5bcfdf75d",
 InitializationCell->True],
Cell[63180, 1215, 1142, 19, 45, "Input",ExpressionUUID->"942809d9-27ea-497d-bb0c-f9629fac2430",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[64359, 1239, 519, 8, 48, "Subchapter",ExpressionUUID->"fefc468f-3f9f-47e1-b37c-dc9bfd50ce7d"],
Cell[64881, 1249, 624, 12, 46, "Input",ExpressionUUID->"01a0f71e-6182-4164-a95e-e6be8e908aa2",
 InitializationCell->True],
Cell[65508, 1263, 3051, 65, 404, "Input",ExpressionUUID->"310e0981-68bb-4525-966f-219eff6c468c",
 InitializationCell->True],
Cell[68562, 1330, 1219, 20, 46, "Input",ExpressionUUID->"958eb401-0d70-48d4-9aab-c422c9b3ad19",
 InitializationCell->True],
Cell[69784, 1352, 14430, 264, 1181, "Input",ExpressionUUID->"40d83617-8b8e-43d1-86a1-c7b205a902c3",
 InitializationCell->True],
Cell[84217, 1618, 14970, 294, 1202, "Input",ExpressionUUID->"e275ae56-164b-4a6f-82e8-c673f2de99f3",
 InitializationCell->True],
Cell[99190, 1914, 1142, 19, 46, "Input",ExpressionUUID->"a80f1595-10dc-4121-bda8-48d0b94566e9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[100369, 1938, 441, 7, 48, "Subchapter",ExpressionUUID->"1f58df03-5f77-463a-a880-6ffa2d42f38c"],
Cell[100813, 1947, 624, 12, 45, "Input",ExpressionUUID->"55c12aef-1898-4cc0-a959-7cba7bb718d1",
 InitializationCell->True],
Cell[101440, 1961, 1094, 24, 179, "Input",ExpressionUUID->"b51278f0-0770-4dc6-82a6-c7b87c11a43b",
 InitializationCell->True],
Cell[102537, 1987, 1219, 20, 49, "Input",ExpressionUUID->"31e40fc0-6437-4b8f-897d-af9bfed7eac0",
 InitializationCell->True],
Cell[103759, 2009, 18724, 371, 1550, "Input",ExpressionUUID->"fda2eaaf-64ce-437e-8d85-548684f68546",
 InitializationCell->True],
Cell[122486, 2382, 1142, 19, 45, "Input",ExpressionUUID->"20daf76c-312c-4261-99ee-b0325325673b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[123665, 2406, 494, 7, 48, "Subchapter",ExpressionUUID->"57293870-c474-4350-b77d-ef6b4817b285"],
Cell[124162, 2415, 624, 12, 45, "Input",ExpressionUUID->"27054959-8bb7-4f18-b798-a7b950108569",
 InitializationCell->True],
Cell[124789, 2429, 1111, 29, 215, "Input",ExpressionUUID->"6dddff0d-92f3-4b86-b95a-ab7004ed1dc8",
 InitializationCell->True],
Cell[125903, 2460, 1219, 20, 49, "Input",ExpressionUUID->"ab42411b-6dc9-4385-a0ee-07ea0255034c",
 InitializationCell->True],
Cell[127125, 2482, 23626, 461, 1765, "Input",ExpressionUUID->"edca1e99-40e2-4982-a6ab-6324cec7bcb5",
 InitializationCell->True],
Cell[150754, 2945, 1142, 19, 45, "Input",ExpressionUUID->"ff193bcc-6cba-46ee-9c07-9c80cf2790a2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[151933, 2969, 460, 7, 48, "Subchapter",ExpressionUUID->"8f03f773-2569-442d-9a0e-f2c89bcd6ff7"],
Cell[152396, 2978, 620, 11, 45, "Input",ExpressionUUID->"27776e0b-3bc2-43a1-bbad-65ae8fb04ff4",
 InitializationCell->True],
Cell[153019, 2991, 5491, 111, 639, "Input",ExpressionUUID->"b511f743-2f0d-469c-9e90-0e3127b45ea6",
 InitializationCell->True],
Cell[158513, 3104, 1215, 19, 49, "Input",ExpressionUUID->"0d7d8ec3-6e8b-482f-ac3f-dc13540748d9",
 InitializationCell->True],
Cell[159731, 3125, 39298, 733, 3238, "Input",ExpressionUUID->"f8b5fc7e-7257-4572-aaaa-93bb1c290404",
 InitializationCell->True],
Cell[199032, 3860, 34328, 551, 1298, "Input",ExpressionUUID->"af7b2561-9d58-4eca-97c0-9b4c0051e944",
 InitializationCell->True],
Cell[233363, 4413, 1138, 18, 45, "Input",ExpressionUUID->"0efa7a17-876a-4d2e-b049-ddc81c2e90c7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[234538, 4436, 531, 8, 48, "Subchapter",ExpressionUUID->"40e4bfb9-1629-447f-849d-c3237fd14ed7"],
Cell[235072, 4446, 624, 12, 45, "Input",ExpressionUUID->"693b2688-6b0f-4b7c-8c03-c7de2a644c6a",
 InitializationCell->True],
Cell[235699, 4460, 1263, 29, 219, "Input",ExpressionUUID->"805b346e-cd1d-4919-b5f9-b8a55270bf38",
 InitializationCell->True],
Cell[236965, 4491, 1219, 20, 49, "Input",ExpressionUUID->"3f7814b8-c82e-4a33-9f01-5f69745da6e9",
 InitializationCell->True],
Cell[238187, 4513, 9517, 177, 717, "Input",ExpressionUUID->"62f963aa-8c56-42e3-88b4-add2a17efea4",
 InitializationCell->True],
Cell[247707, 4692, 1142, 19, 45, "Input",ExpressionUUID->"a40837a6-412e-4a23-ae32-883ce4b7fc1f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[248886, 4716, 260, 4, 48, "Subchapter",ExpressionUUID->"1c408095-8000-4ba2-be7c-d547fe9c754f"],
Cell[249149, 4722, 624, 12, 46, "Input",ExpressionUUID->"f5a8c2ae-9705-48a2-b6a9-856d85122463",
 InitializationCell->True],
Cell[249776, 4736, 2152, 50, 362, "Input",ExpressionUUID->"15d6ce42-ae27-45d0-a98e-c672d7ca75eb",
 InitializationCell->True],
Cell[251931, 4788, 1219, 20, 49, "Input",ExpressionUUID->"b251b819-438b-453f-a549-c286f6f7f667",
 InitializationCell->True],
Cell[253153, 4810, 9080, 187, 1038, "Input",ExpressionUUID->"7515078e-96bb-4d8d-9ed6-1cc2b1009ac2",
 InitializationCell->True],
Cell[262236, 4999, 1142, 19, 46, "Input",ExpressionUUID->"5d901a36-c86b-47b9-b670-a1045587b260",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[263415, 5023, 461, 7, 48, "Subchapter",ExpressionUUID->"fa3b1e28-6287-43a3-a048-475bb2a1f590"],
Cell[263879, 5032, 624, 12, 46, "Input",ExpressionUUID->"9c40b441-47d5-4fa7-9935-2c0163e20878",
 InitializationCell->True],
Cell[264506, 5046, 4009, 80, 404, "Input",ExpressionUUID->"4aa6d0f4-0165-4591-8676-a5f7dc7f5ee9",
 InitializationCell->True],
Cell[268518, 5128, 1219, 20, 49, "Input",ExpressionUUID->"364f8ddc-26c6-4eb1-a280-d8a4a14fb4b4",
 InitializationCell->True],
Cell[269740, 5150, 29791, 520, 1643, "Input",ExpressionUUID->"0a23fef8-a5e5-457a-8385-358a1637ce28",
 InitializationCell->True],
Cell[299534, 5672, 1142, 19, 46, "Input",ExpressionUUID->"29c961dc-1405-49b6-9ef8-68b160183866",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[300713, 5696, 585, 9, 48, "Subchapter",ExpressionUUID->"5494cdfd-bf88-4eb7-9470-ccaa5447a242"],
Cell[301301, 5707, 624, 12, 45, "Input",ExpressionUUID->"93aa1d40-13a5-4db7-a12a-e193c3641339",
 InitializationCell->True],
Cell[301928, 5721, 8428, 159, 739, "Input",ExpressionUUID->"72f4076a-4b75-4b70-b7fc-b9626ec21a01",
 InitializationCell->True],
Cell[310359, 5882, 1219, 20, 49, "Input",ExpressionUUID->"7d729f40-b95b-4df8-b18e-1585c325c35b",
 InitializationCell->True],
Cell[311581, 5904, 100253, 1872, 7439, "Input",ExpressionUUID->"5bf4a945-2832-4ded-bd46-b2a2c36cb644",
 InitializationCell->True],
Cell[411837, 7778, 1142, 19, 46, "Input",ExpressionUUID->"df4ff8bf-a235-4fa3-891e-260aed6f45df",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[413016, 7802, 463, 7, 48, "Subchapter",ExpressionUUID->"d8be70f0-5abd-4408-aff5-7a8cb4ec6342"],
Cell[413482, 7811, 624, 12, 46, "Input",ExpressionUUID->"76155d8f-62c9-4b40-9727-17b64ac2a814",
 InitializationCell->True],
Cell[414109, 7825, 2486, 57, 383, "Input",ExpressionUUID->"b48e0bd8-0193-45cd-a2cc-4be751b57aa2",
 InitializationCell->True],
Cell[416598, 7884, 1219, 20, 49, "Input",ExpressionUUID->"f1b20d08-e6a9-43f7-ab52-fb334a364cd5",
 InitializationCell->True],
Cell[417820, 7906, 21956, 426, 2134, "Input",ExpressionUUID->"69ae2f53-5d24-4c53-aae5-f53221459a2f",
 InitializationCell->True],
Cell[439779, 8334, 1142, 19, 46, "Input",ExpressionUUID->"c94c2bf3-84c7-42e2-8b09-c242a0d20754",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[440958, 8358, 492, 7, 48, "Subchapter",ExpressionUUID->"f7a8ab5e-bed2-4065-9968-ed763bd03f9c"],
Cell[441453, 8367, 624, 12, 45, "Input",ExpressionUUID->"5571c796-7697-4606-870e-cb6667435c26",
 InitializationCell->True],
Cell[442080, 8381, 3536, 70, 359, "Input",ExpressionUUID->"6ceb2ccc-2625-4f56-bc27-d58b0808cf26",
 InitializationCell->True],
Cell[445619, 8453, 1219, 20, 49, "Input",ExpressionUUID->"b9a0c610-6a60-491a-9387-586588077ba9",
 InitializationCell->True],
Cell[446841, 8475, 22176, 421, 1778, "Input",ExpressionUUID->"a4cd486d-bc96-4d05-b50a-fa58a9049e19",
 InitializationCell->True],
Cell[469020, 8898, 34335, 629, 2691, "Input",ExpressionUUID->"0502aef3-99ab-4176-9f64-f6e697b1f164",
 InitializationCell->True],
Cell[503358, 9529, 11695, 185, 312, "Input",ExpressionUUID->"5eff56b2-6e4a-495c-9b9c-28771d7f6b2c",
 InitializationCell->True],
Cell[515056, 9716, 10379, 152, 159, "Input",ExpressionUUID->"ec65ff9d-dcc3-4c62-8fcd-ffe5e2dc8b23",
 InitializationCell->True],
Cell[525438, 9870, 1142, 19, 45, "Input",ExpressionUUID->"263cc96a-cdbd-41b2-b127-3422100f2606",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[526617, 9894, 532, 8, 48, "Subchapter",ExpressionUUID->"064698d7-07ee-4271-a0fb-5fe392638921"],
Cell[527152, 9904, 624, 12, 46, "Input",ExpressionUUID->"0535ff75-a812-46ee-9080-8106546d401b",
 InitializationCell->True],
Cell[527779, 9918, 1442, 30, 194, "Input",ExpressionUUID->"61475c29-6689-4673-9c6a-46c789db1be2",
 InitializationCell->True],
Cell[529224, 9950, 1219, 20, 46, "Input",ExpressionUUID->"5fc9123d-2dc6-493b-bb3e-c3f12a741bcd",
 InitializationCell->True],
Cell[530446, 9972, 16636, 319, 1324, "Input",ExpressionUUID->"fdc9d81f-59dc-4973-9d53-1e4a7e533f55",
 InitializationCell->True],
Cell[547085, 10293, 1142, 19, 46, "Input",ExpressionUUID->"2922f8f5-f28e-4855-93c0-a2013bea323b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[548264, 10317, 339, 5, 48, "Subchapter",ExpressionUUID->"d69b5591-dd13-4ce5-9222-6adec15759cd"],
Cell[548606, 10324, 619, 11, 45, "Input",ExpressionUUID->"b8ee57d8-6851-497e-8cbb-118c83b20113",
 InitializationCell->True],
Cell[549228, 10337, 3995, 75, 293, "Input",ExpressionUUID->"1be478aa-d26a-46dd-b092-2a2a7c168a73",
 InitializationCell->True],
Cell[553226, 10414, 1214, 19, 49, "Input",ExpressionUUID->"758c0ae7-002b-47eb-a0e6-93d136d7a167",
 InitializationCell->True],
Cell[554443, 10435, 9139, 139, 183, "Input",ExpressionUUID->"d3789866-1f12-44e7-b3c8-386355b1b418",
 InitializationCell->True],
Cell[563585, 10576, 447, 10, 49, "Input",ExpressionUUID->"6653b959-0d3d-4b5b-8ac2-a0c8cde07b00",
 InitializationCell->True],
Cell[564035, 10588, 8856, 130, 131, "Input",ExpressionUUID->"50f8361f-3362-4fab-bfa1-157ce544b980",
 InitializationCell->True],
Cell[572894, 10720, 9040, 135, 196, "Input",ExpressionUUID->"d7af6261-0147-4143-8899-1313b88b7dfd",
 InitializationCell->True],
Cell[581937, 10857, 22515, 451, 2545, "Input",ExpressionUUID->"37237089-a0e0-47d7-ae1f-86dd3fc96880",
 InitializationCell->True],
Cell[604455, 11310, 10951, 179, 435, "Input",ExpressionUUID->"157713f5-80da-424a-9ebd-52c81fdb2a5a",
 InitializationCell->True],
Cell[615409, 11491, 7404, 151, 1038, "Input",ExpressionUUID->"33f91451-5120-47e8-8980-08202e39725e",
 InitializationCell->True],
Cell[622816, 11644, 1138, 18, 45, "Input",ExpressionUUID->"a10cd45d-e7d8-4bae-8b09-f89839768f2a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[623991, 11667, 452, 7, 48, "Subchapter",ExpressionUUID->"ce497608-7634-4ce0-a45a-40d4d78da363"],
Cell[624446, 11676, 624, 12, 45, "Input",ExpressionUUID->"21c8d12d-acdd-4752-9cf1-4afe2050dc5c",
 InitializationCell->True],
Cell[625073, 11690, 3727, 73, 421, "Input",ExpressionUUID->"f854cfaa-8501-47af-8ffd-b06d678f0a87",
 InitializationCell->True],
Cell[628803, 11765, 1219, 20, 49, "Input",ExpressionUUID->"28ff112b-882b-47b9-94a8-87906b3e98ae",
 InitializationCell->True],
Cell[630025, 11787, 6044, 129, 713, "Input",ExpressionUUID->"47f9540e-562f-452c-94b8-8640462c63b9",
 InitializationCell->True],
Cell[636072, 11918, 46191, 911, 4212, "Input",ExpressionUUID->"4967cd28-6976-4128-b0ee-9285d067ed54",
 InitializationCell->True],
Cell[682266, 12831, 1142, 19, 46, "Input",ExpressionUUID->"274cc24d-fecb-44ab-9c25-feed4dd03b30",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[683445, 12855, 514, 8, 48, "Subchapter",ExpressionUUID->"04a41a43-bab0-42c7-ba0a-06efd718cf2f"],
Cell[683962, 12865, 624, 12, 45, "Input",ExpressionUUID->"cf5243ac-5c96-469c-8154-ab804479f35f",
 InitializationCell->True],
Cell[684589, 12879, 3664, 78, 499, "Input",ExpressionUUID->"5cce676a-3156-49d4-9a2b-deaf43477133",
 InitializationCell->True],
Cell[688256, 12959, 1219, 20, 49, "Input",ExpressionUUID->"4b4d4455-ea40-4cf6-add6-6459371a2e98",
 InitializationCell->True],
Cell[689478, 12981, 15069, 251, 695, "Input",ExpressionUUID->"4ff8e84c-d336-4703-90e9-a8703717e4e4",
 InitializationCell->True],
Cell[704550, 13234, 1337, 25, 136, "Input",ExpressionUUID->"4b771d54-16ad-40c9-a9ea-0eee964ff0c1",
 InitializationCell->True],
Cell[705890, 13261, 2435, 56, 248, "Input",ExpressionUUID->"7364ab7e-4944-4fb6-abc9-3684f9fa3d52",
 InitializationCell->True],
Cell[708328, 13319, 2362, 54, 248, "Input",ExpressionUUID->"ab40b46e-dec9-4537-9d5d-01e287a1d6cd",
 InitializationCell->True],
Cell[710693, 13375, 3980, 92, 534, "Input",ExpressionUUID->"98325794-a260-4f2e-b78b-d84c46481ea5",
 InitializationCell->True],
Cell[714676, 13469, 8642, 142, 233, "Input",ExpressionUUID->"d22c44cc-5906-4635-b87a-10c034555f85",
 InitializationCell->True],
Cell[723321, 13613, 8495, 140, 179, "Input",ExpressionUUID->"887a4611-b492-424c-9198-3e0e94dda306",
 InitializationCell->True],
Cell[731819, 13755, 9193, 153, 244, "Input",ExpressionUUID->"3142ba3c-df4e-4e15-be42-795ead41a1a7",
 InitializationCell->True],
Cell[741015, 13910, 1640, 44, 160, "Input",ExpressionUUID->"42588147-1750-4b0a-8ace-79ccc603dee5",
 InitializationCell->True],
Cell[742658, 13956, 1298, 34, 95, "Input",ExpressionUUID->"7b16ec35-71d8-4484-92cf-821053ec4be6",
 InitializationCell->True],
Cell[743959, 13992, 1129, 25, 72, "Input",ExpressionUUID->"d418a3ce-62f7-43c7-a910-378b29c2afb3",
 InitializationCell->True],
Cell[745091, 14019, 975, 21, 111, "Input",ExpressionUUID->"f1a7bdf4-7aa8-4de3-b51f-efc578c88659",
 InitializationCell->True],
Cell[746069, 14042, 1142, 19, 45, "Input",ExpressionUUID->"a6653335-459e-4d11-adf7-d20c0acaeb7e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[747248, 14066, 382, 6, 48, "Subchapter",ExpressionUUID->"88c4de5a-4949-4b68-97ca-4759909bd9bf"],
Cell[747633, 14074, 624, 12, 46, "Input",ExpressionUUID->"38c1c577-79e2-4841-b88b-708f6fd6e513",
 InitializationCell->True],
Cell[748260, 14088, 1748, 43, 299, "Input",ExpressionUUID->"88fadf1d-ba42-4f8e-af1c-b209a884eebf",
 InitializationCell->True],
Cell[750011, 14133, 1219, 20, 49, "Input",ExpressionUUID->"b175460b-c6b9-41d7-aa11-cd8f2602c4de",
 InitializationCell->True],
Cell[751233, 14155, 22028, 465, 2084, "Input",ExpressionUUID->"1347a758-df44-4a37-811e-a5f71f856ecc",
 InitializationCell->True],
Cell[773264, 14622, 1142, 19, 46, "Input",ExpressionUUID->"88892b1f-2c9d-4af4-90e3-325b656413cd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[774443, 14646, 369, 6, 48, "Subchapter",ExpressionUUID->"83c266d6-504a-4004-b6a7-b06bafe5c55a"],
Cell[774815, 14654, 624, 12, 45, "Input",ExpressionUUID->"a8a0970e-2413-44ef-b0c2-44f83abdd4a0",
 InitializationCell->True],
Cell[775442, 14668, 856, 19, 95, "Input",ExpressionUUID->"512ac662-5267-466d-b67c-a97e353b16bd",
 InitializationCell->True],
Cell[776301, 14689, 1219, 20, 49, "Input",ExpressionUUID->"fca868db-efc7-45c2-887f-8c77a8ed85ba",
 InitializationCell->True],
Cell[777523, 14711, 6506, 94, 95, "Input",ExpressionUUID->"1f6f1972-6af8-4c70-97ae-982f951c724e",
 InitializationCell->True],
Cell[784032, 14807, 1142, 19, 45, "Input",ExpressionUUID->"025da413-f892-46d5-b527-d2a5e50c4768",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[785211, 14831, 653, 10, 48, "Subchapter",ExpressionUUID->"898cafc9-ecd9-4aba-8e7d-9a05e3db7235"],
Cell[785867, 14843, 624, 12, 46, "Input",ExpressionUUID->"66d71e77-4ab7-478d-84fe-59fd855cb3af",
 InitializationCell->True],
Cell[786494, 14857, 743, 19, 131, "Input",ExpressionUUID->"f25998bc-df47-499a-8b0a-9c97ae5497bc",
 InitializationCell->True],
Cell[787240, 14878, 1219, 20, 49, "Input",ExpressionUUID->"79ea042e-a351-4320-bd3f-aedef5fe4bbd",
 InitializationCell->True],
Cell[788462, 14900, 12949, 221, 690, "Input",ExpressionUUID->"15a6dfdb-c115-405c-b0e9-dd98448c8011",
 InitializationCell->True],
Cell[801414, 15123, 1142, 19, 46, "Input",ExpressionUUID->"74663297-5820-4131-8c01-782e637c78f3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[802593, 15147, 447, 7, 48, "Subchapter",ExpressionUUID->"feafbab9-d59a-4ca9-94ed-3ac0157ec3a6"],
Cell[803043, 15156, 624, 12, 46, "Input",ExpressionUUID->"1efaff58-21c3-441d-b94d-b681e0d368ad",
 InitializationCell->True],
Cell[803670, 15170, 2728, 56, 383, "Input",ExpressionUUID->"4b14ee0a-1324-48de-9d66-7c4ab7b7fc16",
 InitializationCell->True],
Cell[806401, 15228, 1219, 20, 49, "Input",ExpressionUUID->"f714e5a1-512c-4505-a27e-115a7be13ab0",
 InitializationCell->True],
Cell[807623, 15250, 15377, 297, 1223, "Input",ExpressionUUID->"84427fe3-bf97-4c7b-abed-513b77389f90",
 InitializationCell->True],
Cell[823003, 15549, 1142, 19, 46, "Input",ExpressionUUID->"acb916b9-adf5-4e95-8aba-68fa65ad15d3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[824182, 15573, 260, 4, 48, "Subchapter",ExpressionUUID->"ec3234e6-9ccb-40af-a7f8-b85486276271"],
Cell[824445, 15579, 624, 12, 46, "Input",ExpressionUUID->"71425781-fcfc-4379-a882-1c1575233aad",
 InitializationCell->True],
Cell[825072, 15593, 1881, 43, 257, "Input",ExpressionUUID->"e740b5bc-96f8-46d7-8a8a-0912dbc9684a",
 InitializationCell->True],
Cell[826956, 15638, 1219, 20, 49, "Input",ExpressionUUID->"a2dbefa0-179a-42ec-aa6d-46cb75f01c77",
 InitializationCell->True],
Cell[828178, 15660, 15580, 305, 1538, "Input",ExpressionUUID->"fbc1dde7-d186-4c38-8c08-58bc8d674121",
 InitializationCell->True],
Cell[843761, 15967, 1142, 19, 46, "Input",ExpressionUUID->"568bc022-84ce-464d-861d-64f0650057f5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[844940, 15991, 756, 11, 48, "Subchapter",ExpressionUUID->"6513d779-508b-4c9d-8863-2646b2054565"],
Cell[845699, 16004, 624, 12, 45, "Input",ExpressionUUID->"22e4ea95-b932-4347-bc71-ab4c6527bfdc",
 InitializationCell->True],
Cell[846326, 16018, 1361, 33, 239, "Input",ExpressionUUID->"f19c32b8-1de4-4bb4-8a27-bb84902a2cdf",
 InitializationCell->True],
Cell[847690, 16053, 1219, 20, 49, "Input",ExpressionUUID->"b73e844e-1d6f-4680-bf5d-23fc04d7828e",
 InitializationCell->True],
Cell[848912, 16075, 14780, 237, 470, "Input",ExpressionUUID->"aeb99971-88fd-4f00-8e59-31cf01b4b0a5",
 InitializationCell->True],
Cell[863695, 16314, 11276, 164, 72, "Input",ExpressionUUID->"937f2180-c24e-4b56-a1ce-18a923f8d867",
 InitializationCell->True],
Cell[874974, 16480, 1142, 19, 45, "Input",ExpressionUUID->"73966252-1630-4cea-b0a8-cb4299d45836",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[876153, 16504, 463, 7, 48, "Subchapter",ExpressionUUID->"5037ea76-deeb-4152-a2c1-0e470ff06c4f"],
Cell[876619, 16513, 624, 12, 46, "Input",ExpressionUUID->"e92e519b-0ea3-4f22-b776-30b8e5bbb859",
 InitializationCell->True],
Cell[877246, 16527, 6093, 123, 656, "Input",ExpressionUUID->"f22ad440-d639-405c-ace0-7115c9febf3a",
 InitializationCell->True],
Cell[883342, 16652, 1219, 20, 49, "Input",ExpressionUUID->"a01f8dab-f887-4343-8669-820d33ddcd7c",
 InitializationCell->True],
Cell[884564, 16674, 31862, 606, 2861, "Input",ExpressionUUID->"8bec8f45-67ff-4553-bdc8-a2a53ef217d6",
 InitializationCell->True],
Cell[916429, 17282, 99641, 1943, 8027, "Input",ExpressionUUID->"8d559df2-20f3-4e6d-818e-906d6986e2f4",
 InitializationCell->True],
Cell[1016073, 19227, 87943, 1726, 9752, "Input",ExpressionUUID->"f213a4cc-ad69-490a-86c7-33eb3e706dcf",
 InitializationCell->True,
 CellID->737696194],
Cell[1104019, 20955, 3503, 73, 437, "Input",ExpressionUUID->"10e950f1-eac3-4f49-8a35-c93f6b81a050",
 InitializationCell->True],
Cell[1107525, 21030, 1142, 19, 46, "Input",ExpressionUUID->"03553b0d-e275-46a6-8bf3-3a190fe1a871",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1108704, 21054, 326, 5, 48, "Subchapter",ExpressionUUID->"a26e7007-56fc-4489-b3ba-83810c05b931"],
Cell[1109033, 21061, 624, 12, 45, "Input",ExpressionUUID->"8d040ff4-f96a-456a-823d-e6502cfc9655",
 InitializationCell->True],
Cell[1109660, 21075, 10646, 223, 1066, "Input",ExpressionUUID->"12339070-6b6d-47ba-9792-4624b8624d60",
 InitializationCell->True],
Cell[1120309, 21300, 1219, 20, 49, "Input",ExpressionUUID->"06378c21-bc9e-4d0d-af64-2f372bd701d3",
 InitializationCell->True],
Cell[1121531, 21322, 15641, 327, 1601, "Input",ExpressionUUID->"240f0fac-1c34-413b-8694-abceef82f9b6",
 InitializationCell->True],
Cell[1137175, 21651, 1409, 33, 163, "Input",ExpressionUUID->"2d098b1d-1c2c-4d0d-a597-fba43ec40962",
 InitializationCell->True],
Cell[1138587, 21686, 1816, 37, 136, "Input",ExpressionUUID->"c99eba25-1a28-4e97-a48c-1d15d35b1e1d",
 InitializationCell->True],
Cell[1140406, 21725, 647, 16, 72, "Input",ExpressionUUID->"5e288eee-940f-4f30-988b-b40c92a7c3ef",
 InitializationCell->True],
Cell[1141056, 21743, 1151, 31, 72, "Input",ExpressionUUID->"9e3b7ad9-3861-4f3f-b9d6-e4d375fe2e18",
 InitializationCell->True],
Cell[1142210, 21776, 5942, 141, 411, "Input",ExpressionUUID->"815767a5-cd86-49be-90ad-9b56bee85a05",
 InitializationCell->True],
Cell[1148155, 21919, 13125, 254, 921, "Input",ExpressionUUID->"341f1e6a-cb61-4a48-9864-0f6230eca215",
 InitializationCell->True],
Cell[1161283, 22175, 3793, 76, 352, "Input",ExpressionUUID->"53366e63-f7c5-4eb1-bf5b-d2edbccd440b",
 InitializationCell->True],
Cell[1165079, 22253, 2907, 59, 225, "Input",ExpressionUUID->"7d18bb11-07b6-427b-807e-6acd176385fb",
 InitializationCell->True],
Cell[1167989, 22314, 2912, 61, 309, "Input",ExpressionUUID->"d1af9d99-a7b4-4ac8-b525-f714105fdc7c",
 InitializationCell->True],
Cell[1170904, 22377, 8943, 176, 1045, "Input",ExpressionUUID->"3bf9aa4a-6fc2-47a4-aa22-2b8b39fa6ec5",
 InitializationCell->True],
Cell[1179850, 22555, 5362, 114, 447, "Input",ExpressionUUID->"09dad2a0-5e95-487a-a21a-bf4537050eb6",
 InitializationCell->True],
Cell[1185215, 22671, 23149, 395, 844, "Input",ExpressionUUID->"a4189197-577d-4d91-a3d7-638f90e78be4",
 InitializationCell->True],
Cell[1208367, 23068, 905, 21, 134, "Input",ExpressionUUID->"4b797d8b-3f83-489e-9f60-9d4036297891",
 InitializationCell->True],
Cell[1209275, 23091, 20055, 411, 1615, "Input",ExpressionUUID->"8e5e6f2d-f5d4-4483-bc3a-d750a7699d53",
 InitializationCell->True],
Cell[1229333, 23504, 18996, 408, 1976, "Input",ExpressionUUID->"601b0ce5-62ac-4686-af66-dc2c8f075b0e",
 InitializationCell->True],
Cell[1248332, 23914, 4789, 123, 572, "Input",ExpressionUUID->"b16b138f-bf65-4fd5-a166-713868445fae",
 InitializationCell->True],
Cell[1253124, 24039, 1551, 34, 137, "Input",ExpressionUUID->"e82c3951-f20d-436f-a230-d5fa69f68320",
 InitializationCell->True],
Cell[1254678, 24075, 1272, 31, 137, "Input",ExpressionUUID->"50460ba9-d53a-4a04-8961-e3234d0a529d",
 InitializationCell->True],
Cell[1255953, 24108, 2090, 42, 160, "Input",ExpressionUUID->"6255ceea-ac6e-4b5c-97cb-2470ec8cb6c6",
 InitializationCell->True],
Cell[1258046, 24152, 1538, 34, 128, "Input",ExpressionUUID->"5b15bc5b-5261-4877-bbdd-1fb7cf05d318",
 InitializationCell->True],
Cell[1259587, 24188, 27016, 533, 2101, "Input",ExpressionUUID->"cf602b6b-ef62-40bd-b6aa-c22d051abe8a",
 InitializationCell->True],
Cell[1286606, 24723, 2161, 39, 131, "Input",ExpressionUUID->"2f0b88f9-42b0-4eb9-b902-f5e1c3eb79d0",
 InitializationCell->True],
Cell[1288770, 24764, 1800, 38, 221, "Input",ExpressionUUID->"14cd5c76-b1bf-4c46-b65f-d9ef25dcfc49",
 InitializationCell->True],
Cell[1290573, 24804, 1822, 39, 173, "Input",ExpressionUUID->"d5994e4c-9334-44de-8d3c-fad0df1ab3bd",
 InitializationCell->True],
Cell[1292398, 24845, 1142, 19, 46, "Input",ExpressionUUID->"b5690650-47cc-4f7f-8fd0-79b6194bf59c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1293577, 24869, 589, 9, 48, "Subchapter",ExpressionUUID->"f3b3c622-e230-41ee-af97-3c1c4245dc22"],
Cell[1294169, 24880, 624, 12, 46, "Input",ExpressionUUID->"b6907bbc-e623-449b-958e-105e2dd42fce",
 InitializationCell->True],
Cell[1294796, 24894, 956, 22, 173, "Input",ExpressionUUID->"eb867074-36f0-48e8-b827-87d016459f91",
 InitializationCell->True],
Cell[1295755, 24918, 1219, 20, 49, "Input",ExpressionUUID->"2b191e5f-0c6f-4eb3-a13a-ef07e61f4f22",
 InitializationCell->True],
Cell[1296977, 24940, 6988, 129, 572, "Input",ExpressionUUID->"14ee5404-c1c8-47a7-a008-3a9ebf18f057",
 InitializationCell->True],
Cell[1303968, 25071, 1142, 19, 46, "Input",ExpressionUUID->"d5451137-81d9-457b-8890-1c2a0fd5fe3c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1305147, 25095, 528, 8, 48, "Subchapter",ExpressionUUID->"f64fec24-f11c-42f8-b8dc-d5a31e02a91a"],
Cell[1305678, 25105, 624, 12, 46, "Input",ExpressionUUID->"b3c2eb7e-faeb-4dc6-97bc-6a564728f04a",
 InitializationCell->True],
Cell[1306305, 25119, 890, 23, 173, "Input",ExpressionUUID->"386da9ef-ba20-4473-8152-bd1bf7ea856c",
 InitializationCell->True],
Cell[1307198, 25144, 1219, 20, 49, "Input",ExpressionUUID->"41d234c1-6be4-41e0-a580-d6ea481ac266",
 InitializationCell->True],
Cell[1308420, 25166, 7733, 129, 383, "Input",ExpressionUUID->"aa7980cb-ddbf-4131-9242-3309a40ad69c",
 InitializationCell->True],
Cell[1316156, 25297, 1142, 19, 46, "Input",ExpressionUUID->"eae3acf8-df79-4faf-b7c1-4384e9d7a257",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1317335, 25321, 193, 3, 48, "Subchapter",ExpressionUUID->"4c3a872b-a347-4ddf-ae84-469d58b5aaae"],
Cell[1317531, 25326, 624, 12, 46, "Input",ExpressionUUID->"01ccc289-a163-423d-8462-61f8362cef7c",
 InitializationCell->True],
Cell[1318158, 25340, 455, 11, 89, "Input",ExpressionUUID->"6d95c014-779b-4479-b742-967b04283aff",
 InitializationCell->True],
Cell[1318616, 25353, 1219, 20, 46, "Input",ExpressionUUID->"ef67a78c-01b7-4a8d-b24a-10dafd97d429",
 InitializationCell->True],
Cell[1319838, 25375, 10261, 210, 971, "Input",ExpressionUUID->"70b818eb-25e5-41bf-94be-d99a44896988",
 InitializationCell->True],
Cell[1330102, 25587, 1142, 19, 46, "Input",ExpressionUUID->"a1ffb2b5-15cf-4858-a940-95332ad327f3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1331281, 25611, 195, 3, 48, "Subchapter",ExpressionUUID->"e873f727-ba99-437d-bb17-4d9433c08831"],
Cell[1331479, 25616, 624, 12, 46, "Input",ExpressionUUID->"6188fb4d-e03d-4a5c-8ecb-d45801c05ffb",
 InitializationCell->True],
Cell[1332106, 25630, 852, 21, 131, "Input",ExpressionUUID->"c0668719-3ee1-4e67-9973-47c133b40c76",
 InitializationCell->True],
Cell[1332961, 25653, 1219, 20, 49, "Input",ExpressionUUID->"d92f159f-d7f1-4afd-92c5-4e0d91d15f93",
 InitializationCell->True],
Cell[1334183, 25675, 10026, 212, 1139, "Input",ExpressionUUID->"66b82719-6bd5-4811-a86a-8d22a1b68f6f",
 InitializationCell->True],
Cell[1344212, 25889, 2230, 34, 68, "Input",ExpressionUUID->"deaf7f6b-35b3-43ac-8f87-c138ce27eeb9",
 InitializationCell->True],
Cell[1346445, 25925, 1142, 19, 46, "Input",ExpressionUUID->"32ae7306-3753-41f2-9a1d-315e4e812d95",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1347624, 25949, 562, 8, 48, "Subchapter",ExpressionUUID->"1b5614bc-f256-4014-8e72-a23bdd2c09ad"],
Cell[1348189, 25959, 620, 11, 45, "Input",ExpressionUUID->"92752548-c592-47a2-b4bf-b148cded7cd1",
 InitializationCell->True],
Cell[1348812, 25972, 9256, 175, 896, "Input",ExpressionUUID->"64edfdaa-f112-4454-830a-86325568e25b",
 InitializationCell->True],
Cell[1358071, 26149, 1215, 19, 49, "Input",ExpressionUUID->"cb4892db-a39b-4860-8f03-e4ec90d80dba",
 InitializationCell->True],
Cell[1359289, 26170, 11862, 266, 1243, "Input",ExpressionUUID->"52866679-2f1e-4d01-8aef-6e618be4153a",
 InitializationCell->True],
Cell[1371154, 26438, 61520, 1224, 5403, "Input",ExpressionUUID->"944fd8e5-a0d4-42b2-9e51-42c5172f79ad",
 InitializationCell->True],
Cell[1432677, 27664, 1138, 18, 45, "Input",ExpressionUUID->"c721a251-2cdb-4bac-8642-1c4faf2d06a4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1433852, 27687, 373, 6, 48, "Subchapter",ExpressionUUID->"04173d4a-07e6-4d09-b958-71b7b305b8ea"],
Cell[1434228, 27695, 624, 12, 45, "Input",ExpressionUUID->"e02c667f-3fbb-4d6b-be2f-f63d4abc0477",
 InitializationCell->True],
Cell[1434855, 27709, 1452, 35, 235, "Input",ExpressionUUID->"e408e3d3-dc2b-485b-807e-b41e22e4853e",
 InitializationCell->True],
Cell[1436310, 27746, 1219, 20, 49, "Input",ExpressionUUID->"42dcd6a9-b035-4dec-b52c-1e654b6f2c18",
 InitializationCell->True],
Cell[1437532, 27768, 21568, 490, 2722, "Input",ExpressionUUID->"4da015ab-4154-4d32-94a1-ef1213dbd9fe",
 InitializationCell->True],
Cell[1459103, 28260, 1142, 19, 45, "Input",ExpressionUUID->"b9fd5268-71e8-4407-8dba-32fdd0911cf2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1460282, 28284, 404, 6, 48, "Subchapter",ExpressionUUID->"827dfe21-7a76-4d9a-8cef-894f0f616a34"],
Cell[1460689, 28292, 624, 12, 46, "Input",ExpressionUUID->"8de50706-0438-4dd3-9dde-752f33069857",
 InitializationCell->True],
Cell[1461316, 28306, 3071, 76, 488, "Input",ExpressionUUID->"c9b6d924-70b9-4265-bad8-efee0b3604f0",
 InitializationCell->True],
Cell[1464390, 28384, 1219, 20, 49, "Input",ExpressionUUID->"e165de8a-cbd6-45ca-8b39-593db2897dbe",
 InitializationCell->True],
Cell[1465612, 28406, 8631, 197, 992, "Input",ExpressionUUID->"703d938f-46bb-40eb-8b18-c0427e8eb3f1",
 InitializationCell->True],
Cell[1474246, 28605, 25737, 518, 2903, "Input",ExpressionUUID->"f623d9d6-c0b9-4e37-a903-86ee4abacbfc",
 InitializationCell->True],
Cell[1499986, 29125, 1142, 19, 46, "Input",ExpressionUUID->"4e8ef552-6136-4606-976f-d5d216b993ab",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1501165, 29149, 420, 6, 48, "Subchapter",ExpressionUUID->"3281714d-daef-4315-82eb-f731c652ca33"],
Cell[1501588, 29157, 624, 12, 45, "Input",ExpressionUUID->"29c54e72-086c-4f45-b4e5-c2fe3ef5f771",
 InitializationCell->True],
Cell[1502215, 29171, 1447, 35, 261, "Input",ExpressionUUID->"2f8f298a-0a6f-412d-b9c0-98a84b2c37b5",
 InitializationCell->True],
Cell[1503665, 29208, 1219, 20, 49, "Input",ExpressionUUID->"a31ca584-0ff2-472e-b19d-64b99e5ec492",
 InitializationCell->True],
Cell[1504887, 29230, 21584, 448, 2522, "Input",ExpressionUUID->"82ad48fa-3fdb-42a7-be2a-922fe52a5383",
 InitializationCell->True],
Cell[1526474, 29680, 1142, 19, 45, "Input",ExpressionUUID->"e86b04d9-1495-4847-923f-483dbb909ae9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1527653, 29704, 616, 9, 48, "Subchapter",ExpressionUUID->"852fcbad-2f52-4e7d-8950-c68d543c7794"],
Cell[1528272, 29715, 624, 12, 45, "Input",ExpressionUUID->"8788a153-6adf-46c8-a995-29dfb6d2acd0",
 InitializationCell->True],
Cell[1528899, 29729, 2936, 47, 126, "Input",ExpressionUUID->"b13ba222-1c39-48bc-8988-1d3336c1f26c",
 InitializationCell->True],
Cell[1531838, 29778, 1219, 20, 49, "Input",ExpressionUUID->"0bd3cdd9-8f8f-4bce-94da-34e3342614d2",
 InitializationCell->True],
Cell[1533060, 29800, 21085, 305, 238, "Input",ExpressionUUID->"9a39f10d-7398-423b-992b-4d7e561594f4",
 InitializationCell->True],
Cell[1554148, 30107, 1142, 19, 45, "Input",ExpressionUUID->"7631d709-8fbd-4541-9ced-a8e3836fce5e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1555327, 30131, 297, 5, 48, "Subchapter",ExpressionUUID->"a2f3384b-da85-4b8b-a764-3edf6647d56c"],
Cell[1555627, 30138, 624, 12, 45, "Input",ExpressionUUID->"d00f6130-c156-4e35-a3eb-125f012200ac",
 InitializationCell->True],
Cell[1556254, 30152, 10970, 218, 1182, "Input",ExpressionUUID->"abec14df-fce9-4c21-a4ef-60075d7e6940",
 InitializationCell->True],
Cell[1567227, 30372, 1219, 20, 49, "Input",ExpressionUUID->"970910d7-ea2e-46ef-bfed-827368a795ed",
 InitializationCell->True],
Cell[1568449, 30394, 18498, 384, 1689, "Input",ExpressionUUID->"a03b022b-140f-492e-84df-cbe1d4658e2b",
 InitializationCell->True],
Cell[1586950, 30780, 39854, 763, 3854, "Input",ExpressionUUID->"be6509cb-c653-4a3d-b853-05a14630c26b",
 InitializationCell->True],
Cell[1626807, 31545, 25827, 442, 1359, "Input",ExpressionUUID->"40e7f9df-79b4-42bf-a286-64f6561a5b11",
 InitializationCell->True],
Cell[1652637, 31989, 14937, 227, 341, "Input",ExpressionUUID->"55fb8114-b9c1-4749-abb0-da905920623f",
 InitializationCell->True],
Cell[1667577, 32218, 1142, 19, 46, "Input",ExpressionUUID->"37eb05c4-1b8b-422d-8d1a-602e8d850232",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1668756, 32242, 460, 7, 48, "Subchapter",ExpressionUUID->"52a522f3-3b72-4138-b76b-e0e974238324"],
Cell[1669219, 32251, 624, 12, 46, "Input",ExpressionUUID->"ca35df03-657e-4d91-8d6d-0e50f756b696",
 InitializationCell->True],
Cell[1669846, 32265, 4185, 87, 551, "Input",ExpressionUUID->"d304a9bc-2afa-4aa7-8581-1684fc0b9ab3",
 InitializationCell->True],
Cell[1674034, 32354, 1219, 20, 49, "Input",ExpressionUUID->"dde55b4b-87dd-45a1-a2b1-2831b8b6a8ca",
 InitializationCell->True],
Cell[1675256, 32376, 66704, 1246, 4590, "Input",ExpressionUUID->"2b5baeab-c31b-4449-b2bd-20c9351f4d22",
 InitializationCell->True],
Cell[1741963, 33624, 1142, 19, 46, "Input",ExpressionUUID->"7283590c-9db9-4b75-921e-e4eb1c9698e3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1743142, 33648, 437, 7, 48, "Subchapter",ExpressionUUID->"d5814520-4e20-4aba-b31d-c0755ea35357"],
Cell[1743582, 33657, 624, 12, 46, "Input",ExpressionUUID->"d3b33f4a-9583-4ed4-bcdf-c39f22a033fd",
 InitializationCell->True],
Cell[1744209, 33671, 5320, 115, 593, "Input",ExpressionUUID->"20b9832e-ba69-49db-b982-617401ce44f4",
 InitializationCell->True],
Cell[1749532, 33788, 1219, 20, 49, "Input",ExpressionUUID->"aaa921d7-04ea-4b1e-83f2-fd0b2e134a65",
 InitializationCell->True],
Cell[1750754, 33810, 24444, 512, 2861, "Input",ExpressionUUID->"eccb4381-c65c-4a33-94ff-b58c47aa19ea",
 InitializationCell->True],
Cell[1775201, 34324, 1142, 19, 46, "Input",ExpressionUUID->"928033bc-42e5-4194-91b6-268230252f25",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1776380, 34348, 819, 12, 48, "Subchapter",ExpressionUUID->"80f54f80-7287-4132-bd9f-1e3ee4d4b674"],
Cell[1777202, 34362, 624, 12, 45, "Input",ExpressionUUID->"511165f0-fae1-4647-a1bb-ccc03cfa1f69",
 InitializationCell->True],
Cell[1777829, 34376, 2065, 43, 279, "Input",ExpressionUUID->"3296319c-0e0d-4ede-8f8b-94d9cb2967c6",
 InitializationCell->True],
Cell[1779897, 34421, 1219, 20, 49, "Input",ExpressionUUID->"ea588cb4-ec03-4ee5-8634-2c2352cd24e6",
 InitializationCell->True],
Cell[1781119, 34443, 29565, 472, 826, "Input",ExpressionUUID->"379c8c9d-0dc0-42c7-b6a8-1f2ba45339aa",
 InitializationCell->True],
Cell[1810687, 34917, 1142, 19, 45, "Input",ExpressionUUID->"c68a7379-a098-419b-b298-a25392a1a36d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1811866, 34941, 797, 11, 48, "Subchapter",ExpressionUUID->"864a65b4-974d-493c-a749-41208d360989"],
Cell[1812666, 34954, 624, 12, 46, "Input",ExpressionUUID->"b3f981a2-3b7e-4ce9-baf7-a86b4e426d42",
 InitializationCell->True],
Cell[1813293, 34968, 516, 13, 89, "Input",ExpressionUUID->"bf6032a7-0e18-4c5e-802e-ff878d9ace84",
 InitializationCell->True],
Cell[1813812, 34983, 1219, 20, 49, "Input",ExpressionUUID->"da61c416-4c57-46f2-bea3-49409cde2070",
 InitializationCell->True],
Cell[1815034, 35005, 15383, 240, 404, "Input",ExpressionUUID->"d2a85b2d-7952-442e-b8b0-a27019f6b47d",
 InitializationCell->True],
Cell[1830420, 35247, 1142, 19, 46, "Input",ExpressionUUID->"5fe3ee9a-00cc-4ea2-806f-d057d8e0adee",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1831599, 35271, 450, 7, 48, "Subchapter",ExpressionUUID->"c31ec3e7-af3a-405a-aff8-61970a1e2db1"],
Cell[1832052, 35280, 624, 12, 46, "Input",ExpressionUUID->"b56be4d2-5790-441c-9d97-2257fcee5fda",
 InitializationCell->True],
Cell[1832679, 35294, 498, 13, 89, "Input",ExpressionUUID->"47a9516b-0dcd-46ee-9df6-9b124dba4ba3",
 InitializationCell->True],
Cell[1833180, 35309, 1219, 20, 49, "Input",ExpressionUUID->"d8faaa2d-a87c-4252-9da2-832fe2c8e706",
 InitializationCell->True],
Cell[1834402, 35331, 5046, 89, 257, "Input",ExpressionUUID->"482ec450-6504-4a22-b242-e92d697fe6cf",
 InitializationCell->True],
Cell[1839451, 35422, 1142, 19, 46, "Input",ExpressionUUID->"775c4a72-9ae1-4d5e-a8a6-f730bdcb0685",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1840630, 35446, 565, 8, 48, "Subchapter",ExpressionUUID->"6c97c546-662b-4336-a8d8-002086c39206"],
Cell[1841198, 35456, 624, 12, 45, "Input",ExpressionUUID->"db6c67c9-2e0b-48da-aed1-0ca075da3e4b",
 InitializationCell->True],
Cell[1841825, 35470, 6010, 117, 539, "Input",ExpressionUUID->"92ecd498-fb65-4f5c-bc2e-593cc692964a",
 InitializationCell->True],
Cell[1847838, 35589, 1219, 20, 49, "Input",ExpressionUUID->"56cb3994-f76b-4794-9e5b-318901f6a005",
 InitializationCell->True],
Cell[1849060, 35611, 24776, 376, 556, "Input",ExpressionUUID->"f390dd4d-4a23-4d7a-82b8-85a4cfecbc7b",
 InitializationCell->True],
Cell[1873839, 35989, 40279, 694, 2041, "Input",ExpressionUUID->"8c7bdbbc-e28b-4666-9785-32ce5fa9b3c6",
 InitializationCell->True],
Cell[1914121, 36685, 6244, 127, 661, "Input",ExpressionUUID->"2f5e4398-d764-431f-87cc-293426ee70dd",
 InitializationCell->True],
Cell[1920368, 36814, 1142, 19, 45, "Input",ExpressionUUID->"81173583-30cf-4e23-9511-5dd70ba1f933",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1921547, 36838, 390, 6, 48, "Subchapter",ExpressionUUID->"2d3ef5ab-8aaa-4443-9857-a028cd8182f1"],
Cell[1921940, 36846, 624, 12, 46, "Input",ExpressionUUID->"fda0f098-6502-410b-aba1-ed510a206892",
 InitializationCell->True],
Cell[1922567, 36860, 1336, 29, 194, "Input",ExpressionUUID->"8cf0b019-7756-4312-95f1-e253a9fc7df4",
 InitializationCell->True],
Cell[1923906, 36891, 1219, 20, 49, "Input",ExpressionUUID->"46bf4d52-f37d-4bc9-85e9-3b9bc42a9edd",
 InitializationCell->True],
Cell[1925128, 36913, 16557, 315, 1265, "Input",ExpressionUUID->"49457090-88ad-449a-a61e-4a8a04863ddc",
 InitializationCell->True],
Cell[1941688, 37230, 1142, 19, 46, "Input",ExpressionUUID->"ea5bb8fe-e1a9-4bca-b758-84214e26835e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1942867, 37254, 391, 6, 48, "Subchapter",ExpressionUUID->"03ea9153-1874-4d1b-a19a-f95c20a25429"],
Cell[1943261, 37262, 624, 12, 46, "Input",ExpressionUUID->"4135459a-fb14-4273-820b-f1918ea5dbe1",
 InitializationCell->True],
Cell[1943888, 37276, 1671, 32, 131, "Input",ExpressionUUID->"10462ba0-0d08-4703-94fa-c2fbdc78efc4",
 InitializationCell->True],
Cell[1945562, 37310, 1219, 20, 49, "Input",ExpressionUUID->"ed7f9208-8fb7-4223-b52a-0dddaffcf886",
 InitializationCell->True],
Cell[1946784, 37332, 5234, 109, 509, "Input",ExpressionUUID->"b01c4de8-33e1-441c-97a3-e16e8b8f2476",
 InitializationCell->True],
Cell[1952021, 37443, 12419, 235, 1160, "Input",ExpressionUUID->"d76a5e68-10c7-4ae1-bac9-99869eff2312",
 InitializationCell->True],
Cell[1964443, 37680, 1142, 19, 46, "Input",ExpressionUUID->"dd952d1a-9089-44ef-bbd4-df7c39e6fdaa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1965622, 37704, 512, 7, 48, "Subchapter",ExpressionUUID->"c062acd7-6bc9-4c44-9461-22c1986eeee3"],
Cell[1966137, 37713, 620, 11, 45, "Input",ExpressionUUID->"3a76e772-0399-4e23-874f-da30631a6553",
 InitializationCell->True],
Cell[1966760, 37726, 1329, 27, 146, "Input",ExpressionUUID->"d6407d5d-7058-4147-bf5c-def65786583c",
 InitializationCell->True],
Cell[1968092, 37755, 1215, 19, 49, "Input",ExpressionUUID->"031b6b92-05d6-44d9-8a53-888120898fc5",
 InitializationCell->True],
Cell[1969310, 37776, 6172, 117, 495, "Input",ExpressionUUID->"d5ddc15e-18e4-418d-aec6-1b0754ba1061",
 InitializationCell->True],
Cell[1975485, 37895, 8573, 156, 414, "Input",ExpressionUUID->"086ed5e8-711c-4a7c-9190-9da92dbb7212",
 InitializationCell->True],
Cell[1984061, 38053, 1138, 18, 45, "Input",ExpressionUUID->"66cd0628-7597-4511-9da4-192ece13a4d7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1985236, 38076, 563, 8, 48, "Subchapter",ExpressionUUID->"59b525eb-abd7-459d-9833-a14f176abe0a"],
Cell[1985802, 38086, 624, 12, 45, "Input",ExpressionUUID->"a07d65f6-9023-4ebe-85ee-72a744fdfc75",
 InitializationCell->True],
Cell[1986429, 38100, 3748, 82, 446, "Input",ExpressionUUID->"002b8d67-3227-4e39-859d-634fd603ec5a",
 InitializationCell->True],
Cell[1990180, 38184, 1219, 20, 49, "Input",ExpressionUUID->"8c17ea4f-38f5-4482-9697-1c5923a70d6f",
 InitializationCell->True],
Cell[1991402, 38206, 120019, 2696, 17298, "Input",ExpressionUUID->"ade9cd56-742e-4abe-b629-b108f832e0e3",
 InitializationCell->True,
 CellID->24626837],
Cell[2111424, 40904, 1241, 20, 45, "Input",ExpressionUUID->"17c8cc51-e5d7-4d46-958e-16766b1d3a8d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2112702, 40929, 382, 6, 48, "Subchapter",ExpressionUUID->"add68b39-fb64-4b80-a0c4-919ece50dbaa"],
Cell[2113087, 40937, 624, 12, 45, "Input",ExpressionUUID->"2dd49249-807f-4381-99d0-72670c1d9bf6",
 InitializationCell->True],
Cell[2113714, 40951, 1047, 21, 86, "Input",ExpressionUUID->"b016d6cd-095b-4c26-ade9-c6bfdc5047d8",
 InitializationCell->True],
Cell[2114764, 40974, 1219, 20, 49, "Input",ExpressionUUID->"0752d111-0cb8-4137-ba4e-d26d52f3cf8f",
 InitializationCell->True],
Cell[2115986, 40996, 1743, 31, 72, "Input",ExpressionUUID->"f8212125-a2ca-4094-8884-833f678b9dc9",
 InitializationCell->True],
Cell[2117732, 41029, 1142, 19, 45, "Input",ExpressionUUID->"87bd7bb4-6c20-4ea7-94d6-1a70b1cfc7cb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2118911, 41053, 218, 4, 48, "Subchapter",ExpressionUUID->"7b854d2f-6184-406f-ae48-d6e45f49627b"],
Cell[2119132, 41059, 624, 12, 46, "Input",ExpressionUUID->"fe1d8a71-614b-4b76-9971-ab8ac37e2ba7",
 InitializationCell->True],
Cell[2119759, 41073, 335, 9, 46, "Input",ExpressionUUID->"15426d9b-19ef-4b09-9501-308bf71d3d1d",
 InitializationCell->True],
Cell[2120097, 41084, 1115, 18, 49, "Input",ExpressionUUID->"b0a6635c-f7a5-44fc-b454-0077c438005f",
 InitializationCell->True],
Cell[2121215, 41104, 1047, 22, 110, "Input",ExpressionUUID->"e1c423fe-b62e-43fe-927a-065a9aeacc42",
 InitializationCell->True],
Cell[2122265, 41128, 1142, 19, 46, "Input",ExpressionUUID->"612c253e-24fe-4b72-814a-7d3c2d7b7d3f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2123444, 41152, 531, 8, 48, "Subchapter",ExpressionUUID->"06b5fb2f-000f-4a6a-b2f4-9e3ae327d4e0"],
Cell[2123978, 41162, 624, 12, 46, "Input",ExpressionUUID->"7efeb3e4-248a-4e2e-aac9-a27e4b647062",
 InitializationCell->True],
Cell[2124605, 41176, 558, 12, 46, "Input",ExpressionUUID->"ea238091-872e-463a-b525-f1fc51e04df7",
 InitializationCell->True],
Cell[2125166, 41190, 1219, 20, 49, "Input",ExpressionUUID->"a24d3083-c179-43bf-809a-1a56fa0cebf8",
 InitializationCell->True],
Cell[2126388, 41212, 3068, 48, 110, "Input",ExpressionUUID->"3b95f838-c51f-43a1-a5c0-bd6a147544cc",
 InitializationCell->True],
Cell[2129459, 41262, 1142, 19, 46, "Input",ExpressionUUID->"3c229f2c-7475-4287-84a4-1926e3a2e150",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2130638, 41286, 388, 6, 48, "Subchapter",ExpressionUUID->"fc57d0ce-f8d4-43a4-922b-9aee960d915b"],
Cell[2131029, 41294, 624, 12, 46, "Input",ExpressionUUID->"4f4ea584-26e0-4abf-b60e-e61474c6a8d7",
 InitializationCell->True],
Cell[2131656, 41308, 384, 9, 46, "Input",ExpressionUUID->"aa4a05bd-c885-4545-a0c1-96b0aa571ab1",
 InitializationCell->True],
Cell[2132043, 41319, 1219, 20, 49, "Input",ExpressionUUID->"bd1b9cb3-7eae-4635-8916-46ac261a3de0",
 InitializationCell->True],
Cell[2133265, 41341, 25557, 476, 2072, "Input",ExpressionUUID->"650931f9-b3fc-4a98-89fc-e51ae248dab1",
 InitializationCell->True],
Cell[2158825, 41819, 1142, 19, 46, "Input",ExpressionUUID->"2d3d6400-40dd-4757-ba5a-87c877cc0bd1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2160004, 41843, 212, 4, 48, "Subchapter",ExpressionUUID->"61da682c-70e7-4e25-8dd4-c23887544663"],
Cell[2160219, 41849, 1115, 18, 49, "Input",ExpressionUUID->"29523b3f-2d1a-4e89-991e-006ef1c51b64",
 InitializationCell->True],
Cell[2161337, 41869, 2487, 55, 200, "Input",ExpressionUUID->"900599e2-2862-4bae-bf30-609b69c8b89a",
 InitializationCell->True],
Cell[2163827, 41926, 1142, 19, 46, "Input",ExpressionUUID->"b4386782-d2d6-4437-9f11-27c196be6f41",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2165006, 41950, 233, 4, 48, "Subchapter",ExpressionUUID->"c52e0155-7a5e-4dff-868b-a6ca2cc52357"],
Cell[2165242, 41956, 624, 12, 45, "Input",ExpressionUUID->"87cba174-8eb9-48c7-9795-79d128fe1f93",
 InitializationCell->True],
Cell[2165869, 41970, 553, 12, 66, "Input",ExpressionUUID->"3d368b6a-f4c1-4842-b9c1-aa4d4c878e6b",
 InitializationCell->True],
Cell[2166425, 41984, 1115, 18, 49, "Input",ExpressionUUID->"1c67f76e-59bf-432c-80a1-1abe7e448eec",
 InitializationCell->True],
Cell[2167543, 42004, 2703, 59, 256, "Input",ExpressionUUID->"e73f3768-2bad-4d03-a8d1-a29f34e62e74",
 InitializationCell->True],
Cell[2170249, 42065, 1142, 19, 45, "Input",ExpressionUUID->"057e9184-8caa-42ee-aecd-8d66dcfa47a8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2171428, 42089, 332, 5, 48, "Subchapter",ExpressionUUID->"f4d98b8b-16cb-4306-ab78-20631d01a235"],
Cell[2171763, 42096, 1219, 20, 49, "Input",ExpressionUUID->"ba77561c-c6b4-493b-95db-7a135e29f3d3",
 InitializationCell->True],
Cell[2172985, 42118, 4922, 82, 173, "Input",ExpressionUUID->"2a8e05c7-c234-4fbf-adc9-a186b57ae625",
 InitializationCell->True],
Cell[2177910, 42202, 1142, 19, 46, "Input",ExpressionUUID->"8dd327d8-90d5-488a-a928-69ba85e1ba87",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2179089, 42226, 530, 8, 48, "Subchapter",ExpressionUUID->"ff40e9a0-dee2-405e-9fc8-76e17471f08b"],
Cell[2179622, 42236, 624, 12, 46, "Input",ExpressionUUID->"3ebe5dd7-a89d-4422-9486-b4dd81d7c77c",
 InitializationCell->True],
Cell[2180249, 42250, 328, 9, 46, "Input",ExpressionUUID->"fd308505-8dc3-426e-bced-871ffd7618e7",
 InitializationCell->True],
Cell[2180580, 42261, 1219, 20, 49, "Input",ExpressionUUID->"d5b1edd6-3db6-49f6-8436-bce28ab4e52c",
 InitializationCell->True],
Cell[2181802, 42283, 1228, 25, 89, "Input",ExpressionUUID->"96c9f1d0-6daa-4c40-bae4-dac8053a1e69",
 InitializationCell->True],
Cell[2183033, 42310, 1142, 19, 46, "Input",ExpressionUUID->"98e78ab4-7c6f-427f-bf5e-d07d3d78818c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2184212, 42334, 529, 8, 48, "Subchapter",ExpressionUUID->"7830a492-2526-4392-a221-4683dc92f50e"],
Cell[2184744, 42344, 624, 12, 46, "Input",ExpressionUUID->"a04577a1-abe3-4b79-b321-27b4f6390a30",
 InitializationCell->True],
Cell[2185371, 42358, 572, 12, 46, "Input",ExpressionUUID->"bdbaefd0-2f69-49ba-baa7-24386f521d67",
 InitializationCell->True],
Cell[2185946, 42372, 1219, 20, 49, "Input",ExpressionUUID->"09cbb547-ba1f-4673-b32b-bb7b4bd5525a",
 InitializationCell->True],
Cell[2187168, 42394, 3316, 53, 89, "Input",ExpressionUUID->"010fcd9c-6221-4cec-81cd-e4aa1d885fbb",
 InitializationCell->True],
Cell[2190487, 42449, 1142, 19, 46, "Input",ExpressionUUID->"6f1ac2bb-7b28-4432-98a0-af06d8a8191f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2191666, 42473, 457, 7, 48, "Subchapter",ExpressionUUID->"e765e096-6642-4149-a0e5-6643c19a91fc"],
Cell[2192126, 42482, 624, 12, 46, "Input",ExpressionUUID->"516c34e4-8034-4d37-9884-a7bda84da711",
 InitializationCell->True],
Cell[2192753, 42496, 498, 11, 46, "Input",ExpressionUUID->"7288c4c2-08be-47b4-b86d-750cd76401a5",
 InitializationCell->True],
Cell[2193254, 42509, 1220, 20, 49, "Input",ExpressionUUID->"a389fa81-eb07-4155-a8a4-f3bde9024235",
 InitializationCell->True],
Cell[2194477, 42531, 2952, 48, 110, "Input",ExpressionUUID->"4dd2fffa-249f-4f7c-9c82-f5e2041ef301",
 InitializationCell->True],
Cell[2197432, 42581, 1143, 19, 46, "Input",ExpressionUUID->"ff6d02c1-b4cf-4e87-8bf4-534378e78d2d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2198612, 42605, 565, 8, 48, "Subchapter",ExpressionUUID->"2d02966a-4407-43d5-9748-e6fb30c8d747"],
Cell[2199180, 42615, 625, 12, 46, "Input",ExpressionUUID->"8824f6b8-e5c5-45bc-85f7-af61a0ab0133",
 InitializationCell->True],
Cell[2199808, 42629, 593, 12, 46, "Input",ExpressionUUID->"f32ace2b-4e71-48c5-bfa0-5916f5dca6d3",
 InitializationCell->True],
Cell[2200404, 42643, 1220, 20, 49, "Input",ExpressionUUID->"c5abf466-942d-44a8-b229-45ddf915b38b",
 InitializationCell->True],
Cell[2201627, 42665, 3037, 49, 110, "Input",ExpressionUUID->"b51af76a-2005-45cd-af30-335cb8b4c520",
 InitializationCell->True],
Cell[2204667, 42716, 1143, 19, 46, "Input",ExpressionUUID->"a18b9dac-f211-45a6-9ba0-e7484a6c036f",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2205859, 42741, 216, 4, 69, "Chapter",ExpressionUUID->"b72d0a28-4fbc-4bdf-9cff-1ade661ab141"],
Cell[2206078, 42747, 681, 13, 46, "Input",ExpressionUUID->"361671c5-ddec-43ca-9329-375b9664a064",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}
]
*)

