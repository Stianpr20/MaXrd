(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1373808,      27093]
NotebookOptionsPosition[   1337466,      26461]
NotebookOutlinePosition[   1337905,      26480]
CellTagsIndexPosition[   1337862,      26477]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions in the MaXrd package", "Title",
 CellChangeTimes->{{3.6325088204434223`*^9, 3.632508823522456*^9}, {
   3.655742119951337*^9, 3.655742125247018*^9}, {3.657176107171741*^9, 
   3.657176113595751*^9}, {3.6571965175177727`*^9, 3.657196518139456*^9}, {
   3.667811374858439*^9, 3.667811377601095*^9}, {3.667900351656826*^9, 
   3.667900356531871*^9}, 3.6816319306073236`*^9, {3.717737911452742*^9, 
   3.717737917345298*^9}, 3.717739389878994*^9, {3.743835282827827*^9, 
   3.743835301322831*^9}},ExpressionUUID->"a2b17ac0-0b66-4dfa-8a18-\
4f838e9b1548"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Package setup",
 FontSlant->"Italic"]], "Chapter",
 CellChangeTimes->{{3.667809710340659*^9, 3.667809727338533*^9}, {
  3.6678099238942623`*^9, 3.667809924822213*^9}, {3.717738378985339*^9, 
  3.7177383803355417`*^9}, {3.717742309399435*^9, 
  3.717742310034616*^9}},ExpressionUUID->"05130d30-5922-4440-bc61-\
28d6093f6784"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Export", " ", "usage", " ", "messages"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Needs", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"NeatUsage", "'"}], " ", "function", " ", "for", " ", 
     "extracting", " ", "formatted", " ", "usage", " ", "text"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "Stians`"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"packagename", "=", "\"\<MaXrd\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"messagefile", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Messages.txt\>\""}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "$CrystalData", ",", "$LaueClasses", ",", "$PeriodicTable", ",", 
      "$PointGroups", ",", "$SpaceGroups", ",", "$TransformationMatrices", 
      ",", "$MaXrdChangelog", ",", "$MaXrdFunctions", ",", "$MaXrdPath", ",", 
      "$GroupSymbolRedirect", ",", "$MaXrdVersion"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"functions", "=", 
     RowBox[{"NotebookImport", "[", 
      RowBox[{
       RowBox[{"NotebookFileName", "[", "]"}], ",", "\"\<Subchapter\>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"notebooks", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ParentDirectory", "@", 
           RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
          "\[IndentingNewLine]", "\"\<Documentation\>\"", ",", 
          "\[IndentingNewLine]", "\"\<English\>\"", ",", 
          "\[IndentingNewLine]", "\"\<ReferencePages\>\"", ",", 
          "\[IndentingNewLine]", "\"\<Symbols\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"#", "<>", "\"\<.nb\>\""}]}], "}"}], "]"}], "&"}], "/@", 
      "functions"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"found", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"notebooks", ",", "FileExistsQ"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"notebooks", ",", "found"}], "]"}], "\[NotEqual]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Missing documentation pages:\>\"", "]"}], 
       ";", 
       RowBox[{"Print", "@", 
        RowBox[{"Column", "[", 
         RowBox[{"FileNameTake", "/@", 
          RowBox[{"Complement", "[", 
           RowBox[{"notebooks", ",", "found"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<----------\>\"", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "@", 
     RowBox[{"Dynamic", "@", 
      RowBox[{"Multicolumn", "[", 
       RowBox[{"list", ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", "3"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"found", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"list", ",", 
         RowBox[{"FileBaseName", "@", "x"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Check", "[", 
        RowBox[{
         RowBox[{"NeatUsage", "[", 
          RowBox[{"x", ",", "messagefile"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"list", ",", "\"\<(error in previous)\>\""}], "]"}]}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "found"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.660662612972769*^9, 3.660662615331635*^9}, {
   3.6678996421176853`*^9, 3.66789969462072*^9}, {3.667899845913467*^9, 
   3.667899850423938*^9}, {3.667899984372815*^9, 3.6678999940522842`*^9}, {
   3.667900034828264*^9, 3.667900089209947*^9}, {3.667900334078722*^9, 
   3.6679003638145247`*^9}, {3.667903245172576*^9, 3.6679032454925957`*^9}, {
   3.667903509806757*^9, 3.6679035140052967`*^9}, {3.675758442867031*^9, 
   3.675758481993051*^9}, {3.6757585443694277`*^9, 3.6757585456885557`*^9}, {
   3.6757585983182087`*^9, 3.675758704140443*^9}, {3.675758754211491*^9, 
   3.675758772678719*^9}, {3.675759204709443*^9, 3.6757592307473087`*^9}, {
   3.675759379117465*^9, 3.6757594378723717`*^9}, {3.675759500854343*^9, 
   3.675759530220367*^9}, {3.675759709648603*^9, 3.675759710360009*^9}, {
   3.675759767239332*^9, 3.675759808110104*^9}, {3.675760218477907*^9, 
   3.6757602205561533`*^9}, {3.675762009516317*^9, 3.675762010034891*^9}, {
   3.675762172552596*^9, 3.675762176643489*^9}, {3.6757694543401737`*^9, 
   3.675769455794608*^9}, {3.67576953993613*^9, 3.6757695580553617`*^9}, {
   3.6757710214550257`*^9, 3.6757710272949677`*^9}, 3.675771150291032*^9, {
   3.675856100530809*^9, 3.675856100753621*^9}, {3.675856527195032*^9, 
   3.675856540089183*^9}, 3.679727001698728*^9, 3.679727049088442*^9, 
   3.679727711425622*^9, {3.6839690810772543`*^9, 3.683969113087332*^9}, {
   3.7177379328989363`*^9, 3.717737933586039*^9}, {3.717738014422647*^9, 
   3.717738015614521*^9}, {3.7177409978788757`*^9, 3.7177410384803667`*^9}, {
   3.7177413378554688`*^9, 3.717741379077037*^9}, {3.7177414825292664`*^9, 
   3.7177415538374147`*^9}, {3.7177420992113*^9, 3.717742100443009*^9}, 
   3.717742370382308*^9, {3.717743709288949*^9, 3.717743727768016*^9}, {
   3.717743977639468*^9, 3.7177440116306677`*^9}, 3.717744050452475*^9, {
   3.7177440818214197`*^9, 3.717744184730303*^9}, {3.717744236083075*^9, 
   3.717744256948084*^9}, {3.717744312128818*^9, 3.717744331826899*^9}, {
   3.717744425895924*^9, 3.717744448975348*^9}, {3.717744506311816*^9, 
   3.717744540670703*^9}, {3.7177446038680487`*^9, 3.7177446062959003`*^9}, 
   3.71774468810388*^9, {3.717744763574163*^9, 3.717744827259562*^9}, {
   3.717744978946293*^9, 3.717744983144945*^9}, {3.7179286885787992`*^9, 
   3.717928693591135*^9}, 3.7190622887730703`*^9, {3.719070068458487*^9, 
   3.719070068912201*^9}, {3.719087441980075*^9, 3.719087442132564*^9}, {
   3.730012522682797*^9, 3.730012523250532*^9}, {3.730108424097702*^9, 
   3.730108427107399*^9}, {3.730116731369512*^9, 3.730116753664315*^9}, {
   3.7301168078184347`*^9, 3.730116814398196*^9}, {3.730120663483899*^9, 
   3.7301206868656397`*^9}, {3.7307227278396273`*^9, 3.730722728041614*^9}, 
   3.735309531237376*^9, 3.73917234479235*^9, 3.743835305126947*^9, 
   3.743865332915565*^9, {3.743865384964581*^9, 3.743865411582386*^9}, 
   3.743865455251375*^9, 3.7438656510644197`*^9},
 Background->RGBColor[
  1, 1, 0.85],ExpressionUUID->"4642b0d8-b794-43f2-9cbf-961df8cb40e0"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Multicolumn[$CellContext`Private`list, {20, 3}], StandardForm],
  ImageSizeCache->{287., {4.546875, 10.716796875}}]], "Print",
 CellChangeTimes->{
  3.7428789787499847`*^9, 3.742879065322919*^9, 3.743867071668827*^9, 
   3.744047324420471*^9, {3.7440473845198183`*^9, 3.744047397882662*^9}, 
   3.744047457624264*^9, {3.74411639612432*^9, 
   3.744116411324873*^9}},ExpressionUUID->"eae2ba74-0452-405b-873b-\
1273efce6198"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Start", " ", "package"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BeginPackage", "[", "\"\<MaXrd`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Import", " ", "usage", " ", "messages", " ", "from", " ", "file"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"<<", " ", "\"\<MaXrd/Core/Messages.txt\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7190633903591433`*^9, 3.719063390750228*^9}, {
  3.743835321690852*^9, 3.743835323490286*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[1]:=",ExpressionUUID->"ecc58a3f-999d-484d-995b-bd5a9a076acf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.71773858505546*^9, 3.717738589008402*^9}, {
  3.717743878763125*^9, 3.7177438810008383`*^9}, {3.717743962064261*^9, 
  3.717743963517083*^9}},ExpressionUUID->"98bb91af-3017-44d0-bd38-\
3fb1dc5b7446"],

Cell[CellGroupData[{

Cell["AttenuationCoefficient", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.6823273339048023`*^9, 3.6823273376015463`*^9}, 3.6823289774394608`*^9, 
   3.683970210830709*^9, 3.6841265886995287`*^9, {3.687070410274006*^9, 
   3.687070414339764*^9}, {3.714279228356523*^9, 
   3.7142792321304007`*^9}},ExpressionUUID->"8a04012e-1857-4974-9c60-\
50e1690c7e5d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[3]:=",ExpressionUUID->"a84c80f5-4eaa-406d-a3b0-0590482d106d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AttenuationCoefficient", "::", "invalidSource"}], "=", 
   "\"\<The source \[LeftGuillemet]`1`\[RightGuillemet] is invalid.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AttenuationCoefficient", "::", "invcoeff"}], "=", 
   "\"\<The \[LeftGuillemet]`1`\[RightGuillemet] coefficient is not \
recognised.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AttenuationCoefficient", "::", "peOnly"}], "=", 
   "\"\<Only the photoelectric cross section is related to \
\!\(\*StyleBox[FormBox[SuperscriptBox[\"f\", \
\"\[Prime]\[Prime]\",MultilineFunction->None],TraditionalForm], \
\"TI\"]\).\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AttenuationCoefficient", "::", "asfLambda"}], "=", 
    "\"\<The wavelength, `1` \[CapitalARing], must be smaller than 2.5 \
\[CapitalARing] when using \!\(TraditionalForm\`\*SuperscriptBox[\(f\), \(\
\[DoublePrime]\)]\).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "AttenuationCoefficient"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Coefficient\>\"", "\[Rule]", "\"\<LinearAttenuation\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<MassCoefficientMethod\>\"", "\[Rule]", "\"\<DivideByDensity\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "GetScatteringCrossSections", " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PhysicalProcess\>\"", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Source\>\"", "\[Rule]", "\"\<xraylib\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7142771011593227`*^9, 3.714277116878936*^9}, 
   3.7142792426781883`*^9, {3.7187206630465183`*^9, 3.718720685173999*^9}, {
   3.725268806700364*^9, 3.725268823148202*^9}, {3.7252688760752687`*^9, 
   3.725268877026887*^9}, {3.725269156893145*^9, 3.725269165035409*^9}, {
   3.725269227570182*^9, 3.725269229209899*^9}, {3.725272373947567*^9, 
   3.7252723989784527`*^9}, {3.725273241918964*^9, 3.725273247278687*^9}, {
   3.725444185323474*^9, 3.7254441948992*^9}, {3.725444226978861*^9, 
   3.725444235801064*^9}, {3.725609418848913*^9, 3.7256094244180517`*^9}, 
   3.725617503769556*^9, {3.727595094743976*^9, 3.7275951525304117`*^9}, {
   3.727596157278677*^9, 3.727596157411038*^9}, {3.7275963376552258`*^9, 
   3.727596371990885*^9}, 3.727597556269699*^9, {3.72759862336992*^9, 
   3.7275986692757177`*^9}, {3.7275987211595488`*^9, 3.72759872414962*^9}, {
   3.727599661240222*^9, 3.7275997536656923`*^9}, {3.727600590765911*^9, 
   3.727600631635717*^9}, 3.72760107018398*^9, {3.7276011005221157`*^9, 
   3.727601101075252*^9}, {3.727605678373506*^9, 3.727605689480281*^9}, {
   3.72760572636793*^9, 3.727605726971096*^9}, {3.727606714090279*^9, 
   3.7276067407994757`*^9}, {3.733805766964224*^9, 3.733805852064715*^9}, {
   3.7338059500071087`*^9, 3.733805954223672*^9}, {3.733806093987896*^9, 
   3.733806159446396*^9}, {3.733807125176491*^9, 3.733807130300021*^9}, {
   3.733807422507615*^9, 3.733807432858644*^9}, {3.733807474026002*^9, 
   3.733807477003118*^9}, {3.735291796312076*^9, 3.735291797423252*^9}, {
   3.7352957155995493`*^9, 3.735295716462904*^9}, {3.735306109963554*^9, 
   3.7353061671057653`*^9}, {3.735306212768219*^9, 3.735306214246963*^9}, {
   3.7353065010127687`*^9, 3.735306503736622*^9}, {3.7373969463413887`*^9, 
   3.737396955499552*^9}, 3.737397728880765*^9, {3.738304012487692*^9, 
   3.738304052969688*^9}, 3.743865880198998*^9, 3.7441722690718527`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"a0d806b2-fbfa-4444-8360-46244684d06b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[9]:=",ExpressionUUID->"2d6fba52-f8ed-4fb9-a942-88b90c5ed568"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AttenuationCoefficient", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "AttenuationCoefficient"}]}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", ",", 
      RowBox[{"unitsQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"coeff", "=", 
       RowBox[{"OptionValue", "[", "\"\<Coefficient\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mcMethod", "=", 
       RowBox[{"OptionValue", "[", "\"\<MassCoefficientMethod\>\"", "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"source", "=", 
       RowBox[{"OptionValue", "[", "\"\<Source\>\"", "]"}]}], ",", 
      RowBox[{"pp", "=", 
       RowBox[{"OptionValue", "[", "\"\<PhysicalProcess\>\"", "]"}]}], ",", 
      "csDir", ",", "asfFile", ",", "\[IndentingNewLine]", "V", ",", 
      "\[Sigma]", ",", "\[CapitalSigma]", ",", "column", ",", "atomdata", ",",
       "r", ",", "siteM", ",", "\[IndentingNewLine]", "fpp", ",", "re", ",", 
      "\[Mu]", ",", "\[Rho]"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checking", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"crystal", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"crystal", ",", "lambda", ",", "\"\<ProcessWavelength\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"csDir", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\t", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<CrossSections\>\"", ",", "source"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"asfFile", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\[IndentingNewLine]", "\t", "\"\<AtomicScatteringFactor\>\"", ",", 
         "\"\<AnomalousCorrections\>\"", ",", 
         RowBox[{"source", "<>", "\"\<.m\>\""}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DirectoryQ", "[", "csDir", "]"}], "\[Nor]", 
        RowBox[{"FileExistsQ", "[", "asfFile", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"AttenuationCoefficient", "::", "invalidSource"}], ",", 
          "source"}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Processing", " ", "cross", " ", "section", " ", "type"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", 
         RowBox[{"Select", " ", "'"}]}], 
        RowBox[{"PhysicalProcess", "'"}], " ", "manually"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"pp", "=!=", "\"\<\>\""}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"column", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<Photoelectric\>\"", ",", "\"\<Photoionisation\>\""}], "}"}],
             ",", "pp"}], "]"}], ",", "2", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<Coherent\>\"", ",", "\"\<Rayleigh\>\"", ",", 
              "\"\<Thompson\>\"", ",", "\[IndentingNewLine]", "\t", 
              "\"\<Classical\>\"", ",", "\"\<Elastic\>\""}], "}"}], ",", 
            "pp"}], "]"}], ",", "3", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<Incoherent\>\"", ",", "\"\<Compton\>\"", ",", 
              "\"\<Inelastic\>\""}], "\[IndentingNewLine]", "\t", "}"}], ",", 
            "pp"}], "]"}], ",", "4", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"pp", "===", "\"\<Total\>\""}], ",", "5", ",", 
          "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"AttenuationCoefficient", "::", "invproc"}], ",", "pp"}],
             "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Select"}], " ", "automatically", " ", 
         "based", " ", "on", " ", "coefficient", " ", "type"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"column", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MemberQ", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<LinearAttenuation\>\"", ",", "\"\<MassAbsorption\>\""}], 
             "}"}], ",", "\[IndentingNewLine]", "\t", "coeff"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", "5", ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Total", " ", "=", " ", 
            RowBox[{"ph", ".", "el", ".", " ", 
             RowBox[{"+", " ", 
              RowBox[{"Ray", ".", " ", 
               RowBox[{"+", " ", 
                RowBox[{"Comp", "."}]}]}]}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"AttenuationCoefficient", "::", "invcoeff"}], ",", 
             "coeff"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Auxiliary", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"V", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"GetCrystalMetric", "@", "crystal"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Calculation", " ", "method"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DirectoryQ", "@", "csDir"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Using"}], " ", "cross", " ", "sections"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\[Sigma]", "=", 
         RowBox[{"Normal", "@", 
          RowBox[{"GetScatteringCrossSections", "[", 
           RowBox[{
           "crystal", ",", "\[Lambda]", ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<PhysicalProcess\>\"", "\[Rule]", "pp"}], ",", 
            RowBox[{"\"\<Source\>\"", "\[Rule]", "source"}], ",", 
            RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Is", " ", 
           RowBox[{"\[Mu]", "/", "\[Rho]"}], " ", "is", " ", "to", " ", "be", 
           " ", "calculated", " ", 
           RowBox[{"by", " ", "'"}], 
           RowBox[{"AtomicMass", "'"}], " ", 
           RowBox[{
            RowBox[{"method", "?", " ", "\[IndentingNewLine]", "\t\t", "If"}],
             "[", 
            RowBox[{
             RowBox[{
              RowBox[{"coeff", "===", "\"\<MassAbsorption\>\""}], "&&", 
              RowBox[{"mcMethod", "===", "\"\<AtomicMass\>\""}]}], ",", 
             "\[IndentingNewLine]", "\t\t", "\"\<TODO\>\""}], "]"}]}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Multiplying", " ", "atoms", " ", "with", " ", "corresponding", " ", 
          "cross", " ", "sections"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"atomdata", "=", 
         RowBox[{"Values", "@", 
          RowBox[{"$CrystalData", "[", 
           RowBox[{"[", 
            RowBox[{
            "crystal", ",", "\"\<AtomData\>\"", ",", "All", ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Element\>\"", ",", "\"\<FractionalCoordinates\>\"", ",", 
               "\"\<OccupationFactor\>\""}], "}"}]}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"atomdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"StringDelete", "[", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"atomdata", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<+\>\"", ",", "\"\<-\>\"", ",", "DigitCharacter"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"atomdata", "=", 
         RowBox[{"atomdata", "/.", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\[Sigma]", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Missing", "[", 
               RowBox[{"\"\<KeyAbsent\>\"", ",", "\"\<OccupationFactor\>\""}],
                "]"}], "\[Rule]", "1"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"r", "=", 
         RowBox[{"atomdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"siteM", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{
            "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"crystal", ",", 
              RowBox[{"r", "[", 
               RowBox[{"[", "a", "]"}], "]"}], ",", 
              RowBox[{"\"\<UseCentring\>\"", "\[Rule]", "True"}]}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"Length", "@", "r"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"atomdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", "siteM"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[CapitalSigma]", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"Times", "@@@", "atomdata"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[Mu]", "=", 
         RowBox[{"\[CapitalSigma]", "/", "V"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"b", ".", " ", "Using"}], " ", "f"}], "-", "double", "-", 
         "prime"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "wavelength"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Lambda]", ">", "2.5"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"AttenuationCoefficient", "::", "asfLambda"}], ",", 
             RowBox[{"ToString", "@", "\[Lambda]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"column", "=", "3"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"Force", " ", 
          RowBox[{"p", ".", "e", ".", " ", "cross"}], " ", "section", " ", 
          "only"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"re", "=", "2.81794032*^-15"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"fpp", "=", 
         RowBox[{"Im", "@", 
          RowBox[{"StructureFactor", "[", 
           RowBox[{"crystal", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[Lambda]", ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"\"\<AbsoluteValue\>\"", "\[Rule]", "False"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"\"\<f1f2Source\>\"", "\[Rule]", "source"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"(", 
          RowBox[{
          "See", " ", "formula", " ", "in", " ", "documentation", " ", "page",
            " ", "details"}], ")"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"\[Mu]", "=", 
         RowBox[{"2", "*", "re", "*", 
          RowBox[{"\[Lambda]", "/", "V"}], "*", 
          RowBox[{"Abs", "[", "fpp", "]"}], "*", 
          RowBox[{"Power", "[", 
           RowBox[{"10", ",", "18"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Normalise", " ", "by", " ", "mass", " ", 
       RowBox[{"density", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"coeff", "===", "\"\<MassAbsorption\>\""}], "&&", 
        RowBox[{"mcMethod", "===", "\"\<DivideByDensity\>\""}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\[Rho]", "=", 
         RowBox[{"CrystalDensity", "[", 
          RowBox[{"crystal", ",", 
           RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Return", "@", 
           RowBox[{"Quantity", "[", 
            RowBox[{
             RowBox[{"\[Mu]", "/", "\[Rho]"}], ",", 
             RowBox[{
              RowBox[{"\"\<Centimeters\>\"", "^", "2"}], "/", 
              "\"\<Grams\>\""}]}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          
          RowBox[{"Return", "[", 
           RowBox[{"\[Mu]", "/", "\[Rho]"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Output", " ", "linear", " ", "coefficient"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"unitsQ", ",", 
       RowBox[{"Quantity", "[", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"\"\<Centimeters\>\"", "^", 
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}]}]}], "]"}], ",", "\[Mu]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327825752265*^9, {3.682327891309991*^9, 3.682327908905006*^9}, {
   3.682328462663025*^9, 3.682328464594318*^9}, {3.6823288379476137`*^9, 
   3.682328840375494*^9}, {3.6823289450420847`*^9, 3.682328948786008*^9}, 
   3.682329021553924*^9, {3.682329649608305*^9, 3.682329652832589*^9}, 
   3.6823298080835743`*^9, {3.682350312716905*^9, 3.682350378410404*^9}, 
   3.6823504635691757`*^9, {3.6823505010243587`*^9, 3.682350503583688*^9}, {
   3.68235624088593*^9, 3.68235624215532*^9}, {3.6824154065363083`*^9, 
   3.682415411290797*^9}, {3.6824949312809687`*^9, 3.682494933923278*^9}, {
   3.682494968776065*^9, 3.6824950015362787`*^9}, {3.682495062367214*^9, 
   3.6824950649247932`*^9}, {3.682495113046337*^9, 3.6824951159073544`*^9}, {
   3.68249526412218*^9, 3.682495265376318*^9}, {3.68249545065454*^9, 
   3.682495470163967*^9}, {3.682495512292554*^9, 3.682495515202944*^9}, {
   3.682495556347404*^9, 3.682495579369482*^9}, {3.6824958395091257`*^9, 
   3.682495843227323*^9}, {3.6824961499028397`*^9, 3.682496152773938*^9}, {
   3.682496263451882*^9, 3.682496267049795*^9}, {3.682496312064939*^9, 
   3.6824963159122458`*^9}, {3.682496526788476*^9, 3.682496526940209*^9}, {
   3.682496864685812*^9, 3.682496866861273*^9}, {3.682496942171248*^9, 
   3.68249696514644*^9}, 3.682497201839513*^9, {3.6824972729799232`*^9, 
   3.682497296643372*^9}, {3.6824973270838213`*^9, 3.68249734521832*^9}, 
   3.68268180724885*^9, {3.684128291025429*^9, 3.684128389624958*^9}, {
   3.68412845933915*^9, 3.684128486385932*^9}, {3.684128529353738*^9, 
   3.6841285582182617`*^9}, {3.6841288206899014`*^9, 3.684128901287672*^9}, {
   3.684128968928697*^9, 3.68412900913936*^9}, {3.6841292785084352`*^9, 
   3.684129357017983*^9}, {3.684129890723934*^9, 3.684129917971912*^9}, {
   3.6841300831135187`*^9, 3.684130083432626*^9}, {3.684138321122032*^9, 
   3.684138354809764*^9}, {3.684138494851803*^9, 3.6841385035605307`*^9}, {
   3.684138540043199*^9, 3.6841385752075777`*^9}, {3.685245928608788*^9, 
   3.685245936564748*^9}, {3.685292498644186*^9, 3.685292547209746*^9}, {
   3.685293229629302*^9, 3.685293257980389*^9}, {3.6852936989464273`*^9, 
   3.685293705920918*^9}, {3.685418988387327*^9, 3.6854191059404497`*^9}, 
   3.685765928283773*^9, {3.686654834485551*^9, 3.686654890223186*^9}, {
   3.68707046283397*^9, 3.687070498302699*^9}, {3.6870706403942127`*^9, 
   3.687070645183961*^9}, {3.687074314093583*^9, 3.687074317994583*^9}, {
   3.687074374371909*^9, 3.687074570760933*^9}, {3.687074652127841*^9, 
   3.687074670820685*^9}, {3.687074709674035*^9, 3.687074745552079*^9}, 
   3.6870747762370996`*^9, {3.687075134103478*^9, 3.687075190017233*^9}, {
   3.687075227136788*^9, 3.6870752283386497`*^9}, {3.687084433842494*^9, 
   3.687084434540505*^9}, {3.687252674715548*^9, 3.6872527537030087`*^9}, {
   3.6872530883472633`*^9, 3.687253099104884*^9}, {3.6872531543581467`*^9, 
   3.687253322775559*^9}, {3.7142771196500397`*^9, 3.714277178441402*^9}, {
   3.7142792444078503`*^9, 3.7142792456383257`*^9}, {3.7142796797387342`*^9, 
   3.714279682473756*^9}, 3.7142797831707277`*^9, {3.714279814324584*^9, 
   3.714279838321075*^9}, {3.717740904453494*^9, 3.717740920456429*^9}, {
   3.718696577274802*^9, 3.718696627861423*^9}, {3.7186967142424183`*^9, 
   3.7186967147340813`*^9}, {3.718696792968584*^9, 3.71869679321145*^9}, {
   3.718696906307351*^9, 3.7186969091161127`*^9}, {3.718696991305678*^9, 
   3.718697052988871*^9}, {3.7187172800606413`*^9, 3.7187173470382023`*^9}, {
   3.718717379383102*^9, 3.7187174148204517`*^9}, {3.718717488228198*^9, 
   3.718717491026578*^9}, {3.718720070887845*^9, 3.718720085142127*^9}, {
   3.7187201586451893`*^9, 3.718720352039188*^9}, {3.718720394463822*^9, 
   3.718720396278257*^9}, {3.718720543700461*^9, 3.7187206606961927`*^9}, {
   3.7187206908647337`*^9, 3.718720767621423*^9}, {3.718720836716254*^9, 
   3.7187208891380653`*^9}, {3.7187209291227837`*^9, 3.718720948201191*^9}, {
   3.718729205281302*^9, 3.718729248975091*^9}, {3.718814337621928*^9, 
   3.71881435191628*^9}, {3.718814945192078*^9, 3.718815025636673*^9}, {
   3.718815447675469*^9, 3.7188154905358686`*^9}, {3.718815868726829*^9, 
   3.7188159045504293`*^9}, {3.718816345921665*^9, 3.718816383590927*^9}, {
   3.7188164578149977`*^9, 3.718816470836544*^9}, {3.719060981858221*^9, 
   3.7190609882613688`*^9}, {3.719061020869276*^9, 3.719061069506462*^9}, {
   3.7252697943207827`*^9, 3.7252699678916187`*^9}, {3.725270603409759*^9, 
   3.7252706042367573`*^9}, {3.725270841256734*^9, 3.725270867576191*^9}, {
   3.725271247568046*^9, 3.725271324259781*^9}, {3.725271452850932*^9, 
   3.725271454009354*^9}, {3.725271492634151*^9, 3.72527151962381*^9}, {
   3.725271638847114*^9, 3.72527164350896*^9}, {3.7252719083608723`*^9, 
   3.725271923558984*^9}, {3.725272298431737*^9, 3.725272350421612*^9}, {
   3.725272402205048*^9, 3.72527244417188*^9}, {3.725272631784109*^9, 
   3.725272641227659*^9}, {3.72527267485524*^9, 3.725272691237422*^9}, {
   3.72527311647713*^9, 3.725273165306882*^9}, {3.725273206193162*^9, 
   3.7252732719148207`*^9}, {3.725273308513805*^9, 3.725273320479816*^9}, {
   3.725273448694283*^9, 3.725273484590317*^9}, {3.7252739664192963`*^9, 
   3.725273981306225*^9}, {3.7253735568340893`*^9, 3.7253735688323936`*^9}, {
   3.725373908459175*^9, 3.7253739128492823`*^9}, {3.725374117071377*^9, 
   3.725374122918681*^9}, 3.725374225021799*^9, {3.725374283442111*^9, 
   3.725374307704977*^9}, {3.725374666409811*^9, 3.72537471971462*^9}, {
   3.725374832313146*^9, 3.725374868301381*^9}, {3.7253749321418447`*^9, 
   3.725374952949141*^9}, {3.7253762167569838`*^9, 3.725376375167273*^9}, {
   3.725376414760065*^9, 3.725376424262648*^9}, {3.72537713590405*^9, 
   3.7253771382141247`*^9}, {3.72537720593338*^9, 3.725377241394939*^9}, 
   3.725431095469984*^9, {3.725431152356546*^9, 3.72543125425383*^9}, 
   3.725431405022188*^9, {3.72543144959653*^9, 3.725431458188115*^9}, {
   3.725431519565583*^9, 3.725431546084051*^9}, {3.725433607711245*^9, 
   3.725433607875033*^9}, {3.7254389561187887`*^9, 3.725439004963586*^9}, {
   3.725439035746935*^9, 3.725439142872712*^9}, {3.725440248570176*^9, 
   3.725440261217514*^9}, {3.72544031558554*^9, 3.725440322201033*^9}, {
   3.7254403689262133`*^9, 3.725440379566348*^9}, {3.725440948075251*^9, 
   3.725440951724298*^9}, {3.725441021544433*^9, 3.725441075693317*^9}, {
   3.725441121132326*^9, 3.725441256056897*^9}, {3.725441576763502*^9, 
   3.725441598666348*^9}, {3.725441629370322*^9, 3.725441648856089*^9}, {
   3.725441741502282*^9, 3.7254417720922337`*^9}, {3.725441859557227*^9, 
   3.725441915273739*^9}, {3.7254419624824533`*^9, 3.725442055527149*^9}, {
   3.725442090121353*^9, 3.725442108603052*^9}, {3.725442242651855*^9, 
   3.725442288329866*^9}, {3.725442363906097*^9, 3.7254423660232687`*^9}, {
   3.725442396985964*^9, 3.725442537300845*^9}, {3.725442783290227*^9, 
   3.725442789423853*^9}, {3.725443105257683*^9, 3.72544314562961*^9}, {
   3.725443620133412*^9, 3.7254436220111933`*^9}, {3.72544484502874*^9, 
   3.725444846177541*^9}, {3.725445506324738*^9, 3.725445603873625*^9}, {
   3.725445652876431*^9, 3.725445687655731*^9}, {3.7254457322718782`*^9, 
   3.725445739556692*^9}, {3.7254458126392517`*^9, 3.7254459732397957`*^9}, {
   3.72544600673927*^9, 3.7254460409294643`*^9}, {3.725446082440621*^9, 
   3.7254461459020844`*^9}, {3.725446176623804*^9, 3.725446194796921*^9}, {
   3.72544672485463*^9, 3.725446835458315*^9}, 3.7254468786986027`*^9, {
   3.725448207127932*^9, 3.7254482213255663`*^9}, {3.725448268045261*^9, 
   3.725448275798976*^9}, {3.725609594471175*^9, 3.725609595133806*^9}, {
   3.725609758182316*^9, 3.725609761577835*^9}, {3.72560987803113*^9, 
   3.725609878269611*^9}, {3.725609957261696*^9, 3.7256099612974873`*^9}, {
   3.725609993915262*^9, 3.725610016290868*^9}, {3.72561013470751*^9, 
   3.725610148319676*^9}, {3.7256101845660963`*^9, 3.725610184693945*^9}, {
   3.725610370045615*^9, 3.725610371249484*^9}, {3.725617536512475*^9, 
   3.725617639843293*^9}, {3.7256177173098183`*^9, 3.725617773224988*^9}, {
   3.726223688910334*^9, 3.726223779764642*^9}, {3.726223815839501*^9, 
   3.726223866310741*^9}, {3.7262241728333263`*^9, 3.726224173048872*^9}, {
   3.7263905219435463`*^9, 3.7263906120946083`*^9}, {3.726561290259503*^9, 
   3.726561293777958*^9}, {3.726857773261689*^9, 3.7268577967058907`*^9}, {
   3.726857833969409*^9, 3.7268578477674437`*^9}, {3.726857892679901*^9, 
   3.726857896783546*^9}, {3.726857955565792*^9, 3.726858019275367*^9}, {
   3.7268581230812817`*^9, 3.726858126855783*^9}, 3.726858172112897*^9, 
   3.726858344500679*^9, {3.7268585027128572`*^9, 3.726858514030747*^9}, {
   3.7268585488475924`*^9, 3.7268585522808332`*^9}, {3.726858598110031*^9, 
   3.726858617990168*^9}, {3.726858768474002*^9, 3.7268587977914457`*^9}, {
   3.7268588328870707`*^9, 3.726858856302162*^9}, {3.726858887679934*^9, 
   3.726858893773878*^9}, {3.726858966886116*^9, 3.7268589888202543`*^9}, 
   3.726859141635659*^9, {3.726859174188146*^9, 3.726859184593952*^9}, {
   3.726859228843294*^9, 3.726859278769764*^9}, {3.727596670713231*^9, 
   3.7275967212226667`*^9}, {3.727596790831655*^9, 3.7275967926392813`*^9}, 
   3.7275968328738327`*^9, {3.727596958300494*^9, 3.727596958786277*^9}, {
   3.727596992251334*^9, 3.72759700324319*^9}, {3.7275970345633163`*^9, 
   3.7275970574623632`*^9}, {3.7275985206670017`*^9, 3.7275986102626*^9}, {
   3.72759867778411*^9, 3.7275988954864492`*^9}, 3.727598942256852*^9, {
   3.72759897750863*^9, 3.727599013855448*^9}, {3.727599088736693*^9, 
   3.727599104855103*^9}, {3.7275992674093943`*^9, 3.727599269636272*^9}, {
   3.727599364485498*^9, 3.7275993811005487`*^9}, {3.727599481226458*^9, 
   3.727599654265373*^9}, {3.727599779038115*^9, 3.727599841389889*^9}, {
   3.727599892695681*^9, 3.727599892973947*^9}, {3.727600638814896*^9, 
   3.7276006514193687`*^9}, {3.727600731345932*^9, 3.72760074339881*^9}, {
   3.7276009822570972`*^9, 3.7276010181153183`*^9}, 3.727601077966126*^9, {
   3.727603141129677*^9, 3.7276032589689503`*^9}, {3.727603433788258*^9, 
   3.7276034759418287`*^9}, {3.7276045771758823`*^9, 3.727604794750452*^9}, {
   3.727604829108159*^9, 3.72760485079314*^9}, {3.727604918516605*^9, 
   3.727604969390821*^9}, {3.727605026307961*^9, 3.7276050292851267`*^9}, {
   3.727605065999736*^9, 3.727605180288286*^9}, {3.727605427264027*^9, 
   3.7276054278434753`*^9}, {3.727605927425639*^9, 3.727606184324828*^9}, {
   3.727606663389245*^9, 3.727606702607633*^9}, {3.727606753027483*^9, 
   3.7276067964221487`*^9}, {3.727607248788731*^9, 3.727607566831222*^9}, 
   3.727607635936228*^9, 3.727675292623402*^9, 3.7276766297925587`*^9, 
   3.7276767844661827`*^9, {3.72767684001958*^9, 3.727676885072239*^9}, {
   3.7277093097659683`*^9, 3.7277093347667027`*^9}, {3.727709430606303*^9, 
   3.727709469547093*^9}, {3.72780913314751*^9, 3.7278091900229177`*^9}, {
   3.727850767511487*^9, 3.7278507686851273`*^9}, {3.7303979306301003`*^9, 
   3.730397942962326*^9}, {3.730543777621201*^9, 3.7305437777754107`*^9}, {
   3.730544115579426*^9, 3.730544115737665*^9}, {3.7305441832318296`*^9, 
   3.730544209081943*^9}, {3.730622837829286*^9, 3.730622853681568*^9}, {
   3.730623110374165*^9, 3.730623130027525*^9}, {3.733170306280711*^9, 
   3.73317033309278*^9}, {3.7331710008147717`*^9, 3.7331710251738367`*^9}, {
   3.7331711000446978`*^9, 3.7331711361705*^9}, {3.733171473981695*^9, 
   3.733171578192926*^9}, {3.73317163623409*^9, 3.733171651943324*^9}, 
   3.733202970819314*^9, 3.733804172513041*^9, {3.733805704590872*^9, 
   3.733805760174259*^9}, {3.73380587632876*^9, 3.7338058814714823`*^9}, {
   3.733805933078506*^9, 3.733805933504356*^9}, {3.733805977388275*^9, 
   3.733806007688088*^9}, 3.7338072718163424`*^9, {3.73380732023398*^9, 
   3.7338074010980377`*^9}, {3.7350320858541594`*^9, 3.735032132405632*^9}, {
   3.7353065300461683`*^9, 3.735306694608877*^9}, {3.7353067342337008`*^9, 
   3.7353067586461554`*^9}, {3.735306793406844*^9, 3.735306880284782*^9}, {
   3.735307344890975*^9, 3.735307345154111*^9}, {3.735307447075685*^9, 
   3.735307455994753*^9}, {3.7373670527127934`*^9, 3.737367053341886*^9}, {
   3.737396039501148*^9, 3.737396089467263*^9}, {3.7373962440651417`*^9, 
   3.737396255360158*^9}, {3.7373962939034023`*^9, 3.737396313525474*^9}, {
   3.737396980671*^9, 3.737397015363579*^9}, {3.737397170086678*^9, 
   3.737397278098724*^9}, {3.737397338659171*^9, 3.737397347537478*^9}, {
   3.737397598268832*^9, 3.737397645663148*^9}, 3.737397735046486*^9, 
   3.737397767184107*^9, 3.737968466882496*^9, {3.738303813108982*^9, 
   3.7383038170508738`*^9}, {3.738304066063772*^9, 3.738304071176364*^9}, {
   3.739170316786953*^9, 3.7391703198315573`*^9}, {3.743865411764411*^9, 
   3.743865411809656*^9}, 3.7438658804015923`*^9, {3.744034697052298*^9, 
   3.744034710978043*^9}, {3.7440349179223413`*^9, 3.744034918150834*^9}, {
   3.7441701135312233`*^9, 3.744170114030244*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[10]:=",ExpressionUUID->"b0a2a8cc-c36f-49d9-8a11-86ed858d9f6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[11]:=",ExpressionUUID->"d4e32fdb-6588-45e7-a1c1-4bdd400a5566"]
}, Closed]],

Cell[CellGroupData[{

Cell["BraggAngle", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}},ExpressionUUID->"0ee2c50e-7674-48eb-8c98-\
b6af3ffdf4dc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[12]:=",ExpressionUUID->"29b92492-8d32-4b08-8101-c199daec3ab4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BraggAngle", "::", "invinput"}], "=", 
    "\"\<Input must either be the name of a crystal or a metric \
matrix.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "BraggAngle"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, {
  3.7281068862853603`*^9, 3.728106924475239*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"cb38fd25-8e9c-4ba7-8884-4a2db0a04021"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[15]:=",ExpressionUUID->"49cbf4c3-8aa1-4f57-b411-bd0623a85246"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BraggAngle", "[", "\[IndentingNewLine]", 
   RowBox[{"input_", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "reflections_List", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "BraggAngle"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hkl", ",", "G", ",", "H", ",", "\[Lambda]", ",", "sl", ",", "bragg", 
      ",", "angle"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "crystal", " ", 
      RowBox[{"(", 
       RowBox[{"or", " ", "metric"}], ")"}], " ", "and", " ", "reflection", 
      RowBox[{"(", "s", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"InputCheck", "[", 
         RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"G", "=", 
         RowBox[{"GetCrystalMetric", "[", "input", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MatrixQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"G", "=", "input"}], ",", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"BraggAngle", "::", "invinput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "reflections", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reciprocal", " ", "metric"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", "G"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Wavelength", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lambda", "=!=", 
         RowBox[{"-", "1"}]}], "||", 
        RowBox[{"MatrixQ", "@", "input"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", "lambda"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{"input", ",", "\"\<GetCrystalWavelength\>\""}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "\[Lambda]", ",", "\"\<GetEnergyWavelength\>\"", ",", "False"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Sin", "/", "lambda"}], ",", " ", 
       RowBox[{"from", " ", 
        RowBox[{"Bragg", "'"}], "s", " ", "law", " ", "and", " ", "inner", 
        " ", "product"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sl", "[", "h_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"h", ".", "H", ".", "h"}], "]"}], "/", "2."}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bragg", "[", "h_", "]"}], ":=", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ArcSin", "[", 
          RowBox[{
           RowBox[{"sl", "[", "h", "]"}], "*", "\[Lambda]"}], "]"}], "/", 
         "Degree"}], "]"}], "/.", 
       RowBox[{"x_Complex", "\[Rule]", "Undefined"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Bragg", "'"}], "s", " ", "law"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Sow", "[", "\[IndentingNewLine]", 
           RowBox[{"bragg", "@", 
            RowBox[{"hkl", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "hkl"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"angle", "=", 
        RowBox[{"angle", "/.", 
         RowBox[{"x_Real", "\[RuleDelayed]", 
          RowBox[{"Quantity", "[", 
           RowBox[{"x", ",", "\"\<Degrees\>\""}], "]"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "only", " ", "one", " ", "reflection"}], ",", " ", 
       RowBox[{"return", " ", "content"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "angle"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"First", "@", "angle"}], ",", "angle"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.715064942408142*^9, 
   3.715064943132308*^9}, {3.7153145414034758`*^9, 3.7153145467616673`*^9}, 
   3.715327856633502*^9, {3.7154051731829433`*^9, 3.7154051929183903`*^9}, {
   3.7154052332773438`*^9, 3.715405253294734*^9}, {3.715405360310897*^9, 
   3.7154054069587708`*^9}, {3.717222403726162*^9, 3.717222415552843*^9}, {
   3.717222474077138*^9, 3.717222480379856*^9}, {3.7172225774835167`*^9, 
   3.717222584585285*^9}, {3.717740920496456*^9, 3.71774092050616*^9}, {
   3.7220727239925957`*^9, 3.722072731381322*^9}, {3.722072809534255*^9, 
   3.722072832036512*^9}, {3.722072863802107*^9, 3.722072898519074*^9}, 
   3.726561391058339*^9, 3.727675293483314*^9, 3.727676783958682*^9, {
   3.728106031257224*^9, 3.7281060589380007`*^9}, {3.728106180011772*^9, 
   3.728106202173979*^9}, {3.728106287634863*^9, 3.728106301113369*^9}, {
   3.7281063321779118`*^9, 3.728106374799776*^9}, {3.7281065875793667`*^9, 
   3.728106596424721*^9}, {3.728106935268379*^9, 3.728106947051586*^9}, {
   3.728107085050242*^9, 3.728107225807564*^9}, {3.7281087296199503`*^9, 
   3.7281087417638607`*^9}, {3.728108952031921*^9, 3.728108953406122*^9}, 
   3.728109068830366*^9, {3.728109140732355*^9, 3.728109162684065*^9}, 
   3.7281092259390078`*^9, 3.737968467010312*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[16]:=",ExpressionUUID->"aefbd779-58d1-479c-b676-e2fbebcb8648"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[17]:=",ExpressionUUID->"d4cd2fe1-70b6-4dbf-b03e-7940c9130a92"]
}, Closed]],

Cell[CellGroupData[{

Cell["CrystalDensity", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.7168206455457077`*^9, 
   3.7168206470560017`*^9}, 
   3.728623897643963*^9},ExpressionUUID->"e0f41726-5334-435d-82da-\
422b46d89104"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[18]:=",ExpressionUUID->"8bc62f37-199d-4660-a1b2-19bec291d425"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "CrystalDensity"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716830555691573*^9, 3.716830573285467*^9}, {
  3.727178675184021*^9, 3.727178689821534*^9}, {3.7271789775270367`*^9, 
  3.727178977979187*^9}, {3.7348564037912083`*^9, 3.7348564042430964`*^9}, {
  3.735021939129917*^9, 3.7350219394007053`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c0c3ec31-e8fd-4948-a4eb-105f83b6821c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[20]:=",ExpressionUUID->"692524e7-dc2a-4755-a8b7-b224777f0b5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrystalDensity", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "CrystalDensity"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "unitsQ", ",", "Z", ",", "\[IndentingNewLine]", "f", ",", 
      "m", ",", "V", ",", "NA", ",", "\[IndentingNewLine]", "X", ",", "o", 
      ",", "xyz", ",", "M", ",", "mass", ",", "\[IndentingNewLine]", "temp"}],
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Input", " ", "check", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"crystal", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"data", "=", 
      RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"unitsQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Return", " ", "density", " ", "if", " ", "contained", " ", 
       RowBox[{"in", " ", "'"}], 
       RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"data", "[", "\"\<MassDensity\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "[", "temp", "]"}]}], ",", 
       RowBox[{"Return", "@", "temp"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Lookup", " ", "formula", " ", "units"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Z", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"data", ",", "\"\<FormulaUnits\>\"", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"*", " ", "Common", " ", "variables", " ", "*", "--"}]}], 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Volume", ",", " ", 
       RowBox[{"converted", " ", "to", " ", 
        SuperscriptBox["cm", "3"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"V", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"GetCrystalMetric", "@", "crystal"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"unitsQ", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"V", "=", 
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"V", "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "24"}], ")"}]}]}], ",", 
          RowBox[{"\"\<Centimeters\>\"", "^", "3"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"V", "=", 
        RowBox[{"V", "*", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "24"}], ")"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Chemical", " ", "formula"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"f", "=", 
      RowBox[{"Sort", "@", 
       RowBox[{"GetElements", "[", 
        RowBox[{"crystal", ",", 
         RowBox[{"\"\<Tally\>\"", "\[Rule]", "True"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Positive", "@", "Z"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"*", " ", 
          RowBox[{"A", ".", " ", "Calculate"}], " ", "\[Rho]", " ", "from", 
          " ", "Z", " ", "*", "--"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Atomic", " ", "mass", " ", "of", " ", "one", " ", "unit"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"MapAt", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"$PeriodicTable", "[", 
             RowBox[{"#", ",", "\"\<AtomicMass\>\""}], "]"}], "&"}], ",", "f",
            ",", 
           RowBox[{"{", 
            RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"m", "=", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Times", "@@", "#"}], "&"}], "/@", "m"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", 
          RowBox[{"m", "=", 
           RowBox[{"Quantity", "[", 
            RowBox[{"m", ",", 
             RowBox[{"\"\<Grams\>\"", "/", "\"\<Moles\>\""}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Avogadro", "'"}], "s", " ", "constant"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"NA", "=", 
           RowBox[{"UnitConvert", "[", 
            RowBox[{
             RowBox[{"Quantity", "[", "\"\<AvogadroConstant\>\"", "]"}], ",", 
             
             RowBox[{"\"\<Moles\>\"", "^", 
              RowBox[{"-", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"NA", "=", "6.022140857*^23"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculating", " ", "\[Rho]"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Z", "*", "m"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"V", "*", "NA"}], ")"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"*", " ", 
           RowBox[{"B", ".", " ", "Calculate"}], " ", "\[Rho]", " ", "from", 
           " ", "atom", " ", "data"}]}], ",", " ", 
         RowBox[{
         "symmetry", " ", "and", " ", "occupation", " ", "*", "--"}]}], 
        "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Elements", ",", " ", 
         RowBox[{
         "occupation", " ", "factors", " ", "and", " ", "coordinates"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "o", ",", "xyz"}], "}"}], "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Values", "@", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
             "\"\<AtomData\>\"", ",", "All", ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Element\>\"", ",", "\"\<OccupationFactor\>\"", ",", 
                "\"\<FractionalCoordinates\>\""}], "}"}]}], "]"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"X", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"X", ",", 
           RowBox[{"{", 
            RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"o", "=", 
         RowBox[{"o", "/.", 
          RowBox[{"_Missing", "\[Rule]", "1."}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Site", " ", "multiplicities"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"o", "*", 
          RowBox[{"(", 
           RowBox[{"Length", "/@", 
            RowBox[{"(", 
             RowBox[{
             "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"data", "[", "\"\<SpaceGroup\>\"", "]"}], ",", "xyz"}],
               "]"}], ")"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Counting", " ", "*)"}], "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Transpose", "/@", 
          RowBox[{"GatherBy", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "M"}], "}"}], "]"}], ",", "First"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"temp", "/.", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_List", ",", "m_List"}], "}"}], "/;", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Depth", "[", "x", "]"}], "===", "2"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", "x"}], ",", 
              RowBox[{"Total", "@", "m"}]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Total", " ", "atom", " ", "mass"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"mass", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"temp", "/.", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"f", "*", 
             RowBox[{"$PeriodicTable", "[", 
              RowBox[{"X", ",", "\"\<AtomicMass\>\""}], "]"}]}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"mass", "=", 
           RowBox[{"UnitConvert", "[", 
            RowBox[{
             RowBox[{"Quantity", "[", 
              RowBox[{"mass", ",", "\"\<AtomicMassUnit\>\""}], "]"}], ",", 
             "\"\<Grams\>\""}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"mass", "=", 
           RowBox[{"mass", "*", 
            RowBox[{"(", "1.6605390*^-24", ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculated", " ", "density"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", 
         RowBox[{"mass", "/", "V"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.716820660442363*^9, 
   3.716820685815736*^9}, {3.7168211039685993`*^9, 3.716821109006166*^9}, {
   3.716830615633079*^9, 3.716830618327636*^9}, {3.7168723525405407`*^9, 
   3.716872411915575*^9}, {3.716872455943388*^9, 3.7168724908148003`*^9}, {
   3.716872521843114*^9, 3.71687252385538*^9}, {3.716872577629528*^9, 
   3.716872657249303*^9}, {3.716873424383333*^9, 3.7168734253238173`*^9}, {
   3.716875831066147*^9, 3.7168758403345203`*^9}, {3.71687598845652*^9, 
   3.716876188212364*^9}, {3.7168762240798187`*^9, 3.7168762555551567`*^9}, {
   3.716876313371727*^9, 3.716876342141617*^9}, 3.716876387653263*^9, 
   3.716876502535068*^9, {3.716882273100884*^9, 3.716882302398086*^9}, {
   3.716882337123905*^9, 3.716882390906062*^9}, {3.716882612027913*^9, 
   3.7168826456643744`*^9}, {3.7168828190363073`*^9, 3.7168828245346737`*^9}, 
   3.716882856215295*^9, {3.7168828890295563`*^9, 3.716882933256938*^9}, {
   3.716882972687499*^9, 3.716883032260762*^9}, {3.71688311198413*^9, 
   3.716883264778429*^9}, {3.716883308679512*^9, 3.7168835749552794`*^9}, {
   3.716883632940834*^9, 3.7168840031145144`*^9}, {3.716884210520874*^9, 
   3.716884210652163*^9}, {3.717740920524342*^9, 3.717740920535383*^9}, 
   3.718802985939166*^9, {3.718803060838787*^9, 3.718803063559782*^9}, {
   3.718803405559519*^9, 3.7188034070203238`*^9}, {3.718803492139349*^9, 
   3.718803535440364*^9}, {3.718803581847631*^9, 3.7188036505416613`*^9}, {
   3.7188038013472958`*^9, 3.71880383502754*^9}, {3.718803880514141*^9, 
   3.718803890530003*^9}, {3.718813986629037*^9, 3.7188140133657503`*^9}, 
   3.71881405037298*^9, {3.718814127635518*^9, 3.7188141303137074`*^9}, {
   3.727183475234785*^9, 3.727183488999466*^9}, {3.727183544971184*^9, 
   3.7271835698504457`*^9}, {3.727183693593145*^9, 3.7271837314572287`*^9}, {
   3.7271839650112953`*^9, 3.727183970889502*^9}, {3.727601443857336*^9, 
   3.727601458561569*^9}, {3.727602392050802*^9, 3.727602394273776*^9}, {
   3.727602692519127*^9, 3.7276026948129663`*^9}, {3.727602995780644*^9, 
   3.727602996062334*^9}, {3.727675178716289*^9, 3.727675193108197*^9}, {
   3.727684023346468*^9, 3.727684073022949*^9}, {3.727684186645553*^9, 
   3.727684202766356*^9}, {3.7276844252746143`*^9, 3.72768450670531*^9}, {
   3.727684548973167*^9, 3.7276845839085617`*^9}, 3.727684876953658*^9, 
   3.727685350413744*^9, {3.72768540865455*^9, 3.727685435652676*^9}, {
   3.727685480661285*^9, 3.727685542117436*^9}, {3.7276856594542713`*^9, 
   3.7276856884172983`*^9}, {3.727692698149169*^9, 3.727692707306315*^9}, {
   3.727692834250257*^9, 3.727692906376815*^9}, {3.7276929786492853`*^9, 
   3.727692980203782*^9}, {3.7276930221399384`*^9, 3.727693046129095*^9}, {
   3.727693148918601*^9, 3.727693149211893*^9}, {3.728621778539184*^9, 
   3.728621782924053*^9}, {3.728622186113776*^9, 3.728622271893846*^9}, {
   3.72862235223105*^9, 3.7286224157269497`*^9}, {3.728622453339553*^9, 
   3.728622466177504*^9}, {3.728622506850314*^9, 3.728622522978869*^9}, {
   3.728622645073794*^9, 3.728622645599676*^9}, {3.7348563059328127`*^9, 
   3.7348563062980633`*^9}, {3.7348564089570417`*^9, 3.734856437378439*^9}, {
   3.7348565671615143`*^9, 3.734856757173696*^9}, {3.734856876619206*^9, 
   3.73485688172554*^9}, {3.7348571854573812`*^9, 3.734857202421248*^9}, {
   3.734857270457114*^9, 3.7348572948255177`*^9}, {3.734857353640752*^9, 
   3.734857369807686*^9}, {3.734857408151463*^9, 3.734857479130187*^9}, {
   3.734857547078599*^9, 3.734857552801969*^9}, {3.734858177353456*^9, 
   3.734858181956397*^9}, {3.734858239776766*^9, 3.734858241200975*^9}, {
   3.7348582725413446`*^9, 3.734858305971013*^9}, {3.734858338759254*^9, 
   3.734858341795685*^9}, 3.7348586238125353`*^9, {3.73485878448272*^9, 
   3.734858803584711*^9}, {3.734858863989711*^9, 3.734858897972817*^9}, {
   3.734858964998155*^9, 3.734859089189684*^9}, {3.7348591351432734`*^9, 
   3.7348592847685947`*^9}, {3.73485936145327*^9, 3.734859387056665*^9}, 
   3.7348594871559563`*^9, {3.734859535356381*^9, 3.734859552972501*^9}, {
   3.734861188424234*^9, 3.734861190526681*^9}, {3.7348612878515387`*^9, 
   3.734861360990584*^9}, {3.734864976814739*^9, 3.734864978427362*^9}, {
   3.734865010957749*^9, 3.734865018886321*^9}, {3.734866146927218*^9, 
   3.734866171017847*^9}, {3.734866292861107*^9, 3.734866294405472*^9}, {
   3.7349803030876837`*^9, 3.734980336750393*^9}, {3.734980386742298*^9, 
   3.734980389327104*^9}, {3.734980500442094*^9, 3.734980502952849*^9}, {
   3.734980691567004*^9, 3.734980733377968*^9}, {3.735021942077931*^9, 
   3.735021954390654*^9}, {3.735022261648856*^9, 3.735022271967949*^9}, {
   3.7350261439854383`*^9, 3.7350261538299723`*^9}, {3.7350321738180323`*^9, 
   3.735032236267974*^9}, 3.73796846710369*^9, {3.743992566993113*^9, 
   3.743992567160983*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[21]:=",ExpressionUUID->"fb9d67e4-079c-476d-a668-56855ae001a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[22]:=",ExpressionUUID->"6b9eb01a-7fdb-4eff-b637-a2b94405be8c"]
}, Closed]],

Cell[CellGroupData[{

Cell["CrystalFormulaUnits", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.7168206455457077`*^9, 
   3.7168206470560017`*^9}, 3.728623897643963*^9, {3.7346870945420523`*^9, 
   3.734687096227003*^9}},ExpressionUUID->"e0265c6d-f29c-498a-88b0-\
ebfd910bd62e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[23]:=",ExpressionUUID->"b4e7a0c7-42f8-4b82-8265-37a9d8b18008"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CrystalFormulaUnits", "::", "mismatch"}], "=", 
    "\"\<Element mismatch detected.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "CrystalFormulaUnits"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<IgnoreHydrogen\>\"", "\[Rule]", "True"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.737805885604123*^9, 3.737805925525569*^9}, {
  3.741975040331805*^9, 3.741975055618403*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0c79069b-687a-4889-980e-daa4e9ff40c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[26]:=",ExpressionUUID->"35ab7d49-1e1f-43d0-86a8-f6df8b2357a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrystalFormulaUnits", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", 
    RowBox[{"OptionsPattern", "@", "CrystalFormulaUnits"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "\[IndentingNewLine]", "\[Rho]", ",", "f", ",", "fWithoutH",
       ",", "m", ",", "V", ",", "NA", ",", "\[IndentingNewLine]", "X", ",", 
      "XwithoutH", ",", "o", ",", "xyz", ",", "M", ",", "Z", ",", 
      "\[IndentingNewLine]", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Input", " ", "check", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"crystal", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"data", "=", 
      RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Return", " ", "Z", " ", "if", " ", "contained", " ", 
       RowBox[{"in", " ", "'"}], 
       RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"data", "[", "\"\<FormulaUnits\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "[", "temp", "]"}]}], ",", 
       RowBox[{"Return", "@", "temp"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Lookup", " ", "density"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"data", ",", "\"\<MassDensity\>\"", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Chemical", " ", "formula"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"f", "=", 
      RowBox[{"Sort", "@", 
       RowBox[{"GetElements", "[", 
        RowBox[{"crystal", ",", 
         RowBox[{"\"\<Tally\>\"", "\[Rule]", "True"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Atomic", " ", "mass", " ", "of", " ", "one", " ", "unit"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"m", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"$PeriodicTable", "[", 
          RowBox[{"#", ",", "\"\<AtomicMass\>\""}], "]"}], "&"}], ",", "f", 
        ",", 
        RowBox[{"{", 
         RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"m", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Times", "@@", "#"}], "&"}], "/@", "m"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Volume", " ", "[", 
        RowBox[{"cubic", " ", "centimeters"}], "]"}], " ", "and", " ", 
       RowBox[{"Avogadro", "'"}], "s", " ", "constant"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{"Sqrt", "@", 
        RowBox[{"Det", "@", 
         RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}], "*", 
       RowBox[{"Power", "[", 
        RowBox[{"10", ",", 
         RowBox[{"-", "24"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"NA", "=", "6.022140857*^23"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Positive", "@", "\[Rho]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"*", " ", 
          RowBox[{"A", ".", " ", "Calculate"}], " ", "Z", " ", "from", " ", 
          "mass", " ", "denisty", " ", "*", "--"}]}], "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Calculate", " ", "formula", " ", "units", " ", "from", " ", 
         "density"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"QuantityQ", "@", "\[Rho]"}], ",", 
          RowBox[{"\[Rho]", "=", 
           RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", "\t", 
            RowBox[{"UnitConvert", "[", 
             RowBox[{"\[Rho]", ",", 
              RowBox[{"\"\<Grams\>\"", "/", 
               RowBox[{"\"\<Centimeters\>\"", "^", "3"}]}]}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Calculate", " ", "formula", " ", "units", " ", "from", " ", 
          "density"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "[", 
         RowBox[{"\[Rho]", "*", "V", "*", 
          RowBox[{"NA", "/", "m"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"*", " ", 
           RowBox[{"B", ".", " ", "Calculate"}], " ", "Z", " ", "by", " ", 
           "counting", " ", "symmetry"}]}], "-", 
         RowBox[{"generated", " ", "atoms", " ", "*", "--"}]}], "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Elements", ",", " ", 
         RowBox[{
         "occupation", " ", "factors", " ", "and", " ", "coordinates"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "o", ",", "xyz"}], "}"}], "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Values", "@", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
             "\"\<AtomData\>\"", ",", "All", ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Element\>\"", ",", "\"\<OccupationFactor\>\"", ",", 
                "\"\<FractionalCoordinates\>\""}], "}"}]}], "]"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"X", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"X", ",", 
           RowBox[{"{", 
            RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"XwithoutH", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"X", ",", "\"\<H\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"o", "=", 
         RowBox[{"o", "/.", 
          RowBox[{"_Missing", "\[Rule]", "1."}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"fWithoutH", "=", 
         RowBox[{"Sort", "@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "\"\<H\>\""}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", ":", " ", 
          RowBox[{
          "Compare", " ", "formula", " ", "and", " ", "atom", " ", "data"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"TrueQ", "@", 
            RowBox[{"OptionValue", "[", "\"\<IgnoreHydrogen\>\"", "]"}]}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"fWithoutH", "=", "f"}], ";", 
           RowBox[{"XwithoutH", "=", "X"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "@", 
            RowBox[{"DeleteDuplicates", "@", "XwithoutH"}]}], "=!=", 
           "fWithoutH"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"CrystalFormulaUnits", "::", "mismatch"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Site", " ", "multiplicities"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"o", "*", 
          RowBox[{"(", 
           RowBox[{"Length", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
               "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"data", "[", "\"\<SpaceGroup\>\"", "]"}], ",", "#"}],
                 "]"}], "&"}], "/@", "xyz"}], ")"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", "Counting", " ", "*)"}], "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Transpose", "/@", 
          RowBox[{"GatherBy", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"X", ",", "M"}], "}"}], "]"}], ",", "First"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"temp", "/.", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_List", ",", "m_List"}], "}"}], "/;", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Depth", "[", "x", "]"}], "===", "2"}]}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", "x"}], ",", 
              RowBox[{"Round", "@", 
               RowBox[{"Total", "@", "m"}]}]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Check", " ", "if", " ", "hydrogen", " ", "is", " ", "ignored"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"f", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<H\>\"", ",", "_"}], "}"}]}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"temp", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<H\>\"", ",", "_"}], "}"}]}], "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"f", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"f", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<H\>\"", ",", "_"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"temp", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"temp", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<H\>\"", ",", "_"}], "}"}]}], "]"}]}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "agreement", " ", 
          RowBox[{"of", " ", "'"}], 
          RowBox[{"Z", "'"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", "\t", 
        RowBox[{"Z", "=", 
         RowBox[{
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", 
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"a", ".", " ", "Common"}], " ", "integer", " ", "factor"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicates", "@", "Z"}], ",", 
            RowBox[{"{", "_Integer", "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Return", "@", 
           RowBox[{"First", "@", "Z"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"b", ".", " ", "Calculate"}], " ", "density"}], ",", " ", 
            RowBox[{"then", " ", "find", " ", "Z"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"\[Rho]", "=", 
            RowBox[{"CrystalDensity", "[", 
             RowBox[{"crystal", ",", 
              RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Z", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Rho]", "*", "V", "*", "NA"}], ")"}], "/", 
             RowBox[{"(", "m", ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
           
           RowBox[{"Return", "@", "Z"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.716820660442363*^9, 
   3.716820685815736*^9}, {3.7168211039685993`*^9, 3.716821109006166*^9}, {
   3.716830615633079*^9, 3.716830618327636*^9}, {3.7168723525405407`*^9, 
   3.716872411915575*^9}, {3.716872455943388*^9, 3.7168724908148003`*^9}, {
   3.716872521843114*^9, 3.71687252385538*^9}, {3.716872577629528*^9, 
   3.716872657249303*^9}, {3.716873424383333*^9, 3.7168734253238173`*^9}, {
   3.716875831066147*^9, 3.7168758403345203`*^9}, {3.71687598845652*^9, 
   3.716876188212364*^9}, {3.7168762240798187`*^9, 3.7168762555551567`*^9}, {
   3.716876313371727*^9, 3.716876342141617*^9}, 3.716876387653263*^9, 
   3.716876502535068*^9, {3.716882273100884*^9, 3.716882302398086*^9}, {
   3.716882337123905*^9, 3.716882390906062*^9}, {3.716882612027913*^9, 
   3.7168826456643744`*^9}, {3.7168828190363073`*^9, 3.7168828245346737`*^9}, 
   3.716882856215295*^9, {3.7168828890295563`*^9, 3.716882933256938*^9}, {
   3.716882972687499*^9, 3.716883032260762*^9}, {3.71688311198413*^9, 
   3.716883264778429*^9}, {3.716883308679512*^9, 3.7168835749552794`*^9}, {
   3.716883632940834*^9, 3.7168840031145144`*^9}, {3.716884210520874*^9, 
   3.716884210652163*^9}, {3.717740920524342*^9, 3.717740920535383*^9}, 
   3.718802985939166*^9, {3.718803060838787*^9, 3.718803063559782*^9}, {
   3.718803405559519*^9, 3.7188034070203238`*^9}, {3.718803492139349*^9, 
   3.718803535440364*^9}, {3.718803581847631*^9, 3.7188036505416613`*^9}, {
   3.7188038013472958`*^9, 3.71880383502754*^9}, {3.718803880514141*^9, 
   3.718803890530003*^9}, {3.718813986629037*^9, 3.7188140133657503`*^9}, 
   3.71881405037298*^9, {3.718814127635518*^9, 3.7188141303137074`*^9}, {
   3.727183475234785*^9, 3.727183488999466*^9}, {3.727183544971184*^9, 
   3.7271835698504457`*^9}, {3.727183693593145*^9, 3.7271837314572287`*^9}, {
   3.7271839650112953`*^9, 3.727183970889502*^9}, {3.727601443857336*^9, 
   3.727601458561569*^9}, {3.727602392050802*^9, 3.727602394273776*^9}, {
   3.727602692519127*^9, 3.7276026948129663`*^9}, {3.727602995780644*^9, 
   3.727602996062334*^9}, {3.727675178716289*^9, 3.727675193108197*^9}, {
   3.727684023346468*^9, 3.727684073022949*^9}, {3.727684186645553*^9, 
   3.727684202766356*^9}, {3.7276844252746143`*^9, 3.72768450670531*^9}, {
   3.727684548973167*^9, 3.7276845839085617`*^9}, 3.727684876953658*^9, 
   3.727685350413744*^9, {3.72768540865455*^9, 3.727685435652676*^9}, {
   3.727685480661285*^9, 3.727685542117436*^9}, {3.7276856594542713`*^9, 
   3.7276856884172983`*^9}, {3.727692698149169*^9, 3.727692707306315*^9}, {
   3.727692834250257*^9, 3.727692906376815*^9}, {3.7276929786492853`*^9, 
   3.727692980203782*^9}, {3.7276930221399384`*^9, 3.727693046129095*^9}, {
   3.727693148918601*^9, 3.727693149211893*^9}, {3.728621778539184*^9, 
   3.728621782924053*^9}, {3.728622186113776*^9, 3.728622271893846*^9}, {
   3.72862235223105*^9, 3.7286224157269497`*^9}, {3.728622453339553*^9, 
   3.728622466177504*^9}, {3.728622506850314*^9, 3.728622522978869*^9}, {
   3.728622645073794*^9, 3.728622645599676*^9}, {3.734687161906055*^9, 
   3.734687217425891*^9}, {3.734687257890682*^9, 3.734687269073254*^9}, {
   3.7346873666232443`*^9, 3.734687378098473*^9}, {3.734687514276444*^9, 
   3.734687542244218*^9}, {3.7346875859643993`*^9, 3.734687637851782*^9}, {
   3.7346878058770742`*^9, 3.7346878739433107`*^9}, {3.7346880727092648`*^9, 
   3.734688101082307*^9}, {3.734688520984953*^9, 3.734688557609003*^9}, {
   3.734688994670887*^9, 3.734689087888377*^9}, {3.734689126226308*^9, 
   3.7346892507199697`*^9}, {3.734689482004064*^9, 3.734689498298815*^9}, {
   3.73468958503522*^9, 3.734689615402967*^9}, {3.7346934629159603`*^9, 
   3.734693524738729*^9}, {3.734693563412406*^9, 3.734693711618286*^9}, {
   3.73469376053473*^9, 3.734693773730814*^9}, {3.7346938276192007`*^9, 
   3.734693886766075*^9}, {3.734693984030326*^9, 3.73469399856791*^9}, 
   3.734694087288121*^9, {3.734694142746725*^9, 3.734694154890108*^9}, {
   3.734769499710103*^9, 3.734769500083959*^9}, {3.734769540613845*^9, 
   3.734769554408991*^9}, {3.734769586464767*^9, 3.734769589151436*^9}, {
   3.734769629663395*^9, 3.73476965169698*^9}, {3.734769715671834*^9, 
   3.734769846125445*^9}, {3.734769933213776*^9, 3.734770014852292*^9}, {
   3.734770102155918*^9, 3.734770330015541*^9}, {3.734770363793829*^9, 
   3.734770376119488*^9}, {3.734770460743085*^9, 3.7347705412786007`*^9}, 
   3.734770833364869*^9, {3.734771295662282*^9, 3.734771298905621*^9}, {
   3.734771355342614*^9, 3.734771376951448*^9}, {3.734771416643319*^9, 
   3.7347714201074123`*^9}, {3.734771462129858*^9, 3.734771549654381*^9}, {
   3.7347921822384567`*^9, 3.734792256849484*^9}, {3.73479232636942*^9, 
   3.734792382382332*^9}, {3.7347926123147697`*^9, 3.7347926579128036`*^9}, {
   3.734792978195539*^9, 3.734792979801667*^9}, {3.734793537514904*^9, 
   3.734793562490337*^9}, {3.734793597033834*^9, 3.734793623362172*^9}, 
   3.734858146264872*^9, {3.735011928068985*^9, 3.735011929283972*^9}, {
   3.735022129174734*^9, 3.735022193859498*^9}, {3.735022236294388*^9, 
   3.7350222386909637`*^9}, {3.735022362318347*^9, 3.73502236523523*^9}, {
   3.735022411408517*^9, 3.7350224189611883`*^9}, {3.735022465054412*^9, 
   3.735022467889464*^9}, {3.735022502700996*^9, 3.735022530643366*^9}, {
   3.735023050990794*^9, 3.735023091343*^9}, {3.735023520292654*^9, 
   3.735023551142185*^9}, {3.735023593525428*^9, 3.735023619244958*^9}, {
   3.735024057638631*^9, 3.735024068726115*^9}, {3.735024959957273*^9, 
   3.735025120448887*^9}, {3.735025150867716*^9, 3.735025174485404*^9}, {
   3.735025282361462*^9, 3.735025311210437*^9}, {3.7350259055999126`*^9, 
   3.735026063672041*^9}, {3.735029542639955*^9, 3.7350295980897417`*^9}, {
   3.735029676721942*^9, 3.735029698911381*^9}, {3.735029756566386*^9, 
   3.7350297728322973`*^9}, {3.735029888413373*^9, 3.735029907658907*^9}, {
   3.7350300564679127`*^9, 3.7350300717479057`*^9}, 3.735030153130424*^9, {
   3.735032196089965*^9, 3.735032196711657*^9}, {3.737383693857211*^9, 
   3.737383756273583*^9}, {3.737383807902457*^9, 3.737383870451847*^9}, 
   3.737383909310376*^9, {3.7373845299832*^9, 3.73738466988605*^9}, {
   3.73738525214216*^9, 3.7373853094049673`*^9}, {3.737385357710146*^9, 
   3.737385373731523*^9}, 3.7373854098122387`*^9, {3.737805750049411*^9, 
   3.737805752159295*^9}, {3.737805783541308*^9, 3.737805878479924*^9}, {
   3.737806032042493*^9, 3.737806059430818*^9}, {3.737806185170886*^9, 
   3.737806240375677*^9}, {3.737806924291636*^9, 3.737806930594109*^9}, 
   3.7379684672079782`*^9, {3.74197308608463*^9, 3.7419730888570223`*^9}, 
   3.741973119779772*^9, {3.741973154475752*^9, 3.7419731547844553`*^9}, {
   3.7419732476803417`*^9, 3.741973283222967*^9}, {3.741973874439253*^9, 
   3.741973884643847*^9}, {3.74197406937014*^9, 3.741974070396022*^9}, {
   3.741974163219123*^9, 3.741974184939254*^9}, {3.7419743811728487`*^9, 
   3.741974383613929*^9}, {3.741974888452097*^9, 3.74197489089786*^9}, {
   3.741974952634684*^9, 3.741975000939262*^9}, {3.7419750698089027`*^9, 
   3.741975096285943*^9}, {3.741975128647184*^9, 3.7419751773726797`*^9}, {
   3.74197521584503*^9, 3.7419752326027412`*^9}, {3.7419752682037497`*^9, 
   3.7419752722415667`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[27]:=",ExpressionUUID->"4287df34-0941-4a79-ab8f-35309f3c1671"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[28]:=",ExpressionUUID->"9359d8ce-1ebe-4dab-85d0-1e57860858dc"]
}, Closed]],

Cell[CellGroupData[{

Cell["DarwinWidth", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.715064144253417*^9, 3.71506414748868*^9}, {
   3.715064220267487*^9, 3.715064227041099*^9}, 
   3.715067274120924*^9},ExpressionUUID->"01123944-a651-4f62-8364-\
b32f86728dfb"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[29]:=",ExpressionUUID->"b3ea2c7a-9cf8-4174-beb3-39e61847591f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "DarwinWidth"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], ",", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"(*", " ", "ExtinctionLength", " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "\"\<\[Pi]\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, 
   3.715064183906497*^9, {3.715066714738761*^9, 3.71506671898242*^9}, {
   3.728766841930744*^9, 3.728766893633369*^9}, 3.728770289709626*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"5b795a32-8265-4059-921e-2f5f092ed18f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[31]:=",ExpressionUUID->"95cff54f-a56a-4a20-b8db-afa2d863b171"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DarwinWidth", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "hklInput_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]o", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "1.0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]h", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "1.0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "DarwinWidth"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "hkl", ",", "L", ",", "\[Lambda]", ",", "\[Theta]", ",", 
      "\[CapitalLambda]o", ",", "\[Delta]os"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"crystal", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "hklInput", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "hkl"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"crystal", ",", "lambda", ",", "\"\<ProcessWavelength\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Miscellaneous", " ", "preparations"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{
       RowBox[{"BraggAngle", "[", 
        RowBox[{"crystal", ",", "\[Lambda]", ",", "hkl", ",", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}], "*", 
       "Degree"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{"ExtinctionLength", "[", 
       RowBox[{
       "crystal", ",", "\[Lambda]", ",", "hkl", ",", "\[Gamma]o", ",", 
        "\[Gamma]h", ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Polarisation\>\"", "\[Rule]", 
         RowBox[{"OptionValue", "[", "\"\<Polarisation\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Darwin", " ", "width"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Delta]os", "=", 
      RowBox[{"2", "*", 
       FractionBox["\[Lambda]", "\[CapitalLambda]o"], "*", 
       FractionBox["\[Gamma]h", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "\[Theta]"}], "]"}]], "*", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"1", " ", 
          RowBox[{"(*", " ", "\[Mu]m", " ", "*)"}]}], 
         RowBox[{
          SuperscriptBox["10", "4"], " ", 
          RowBox[{"(*", " ", "\[CapitalARing]", " ", "*)"}]}]], ")"}], "*", 
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SuperscriptBox["10", "6"], " ", 
          RowBox[{"(*", " ", "\[Mu]rad", " ", "*)"}]}], 
         RowBox[{"1", " ", 
          RowBox[{"(*", " ", "rad", " ", "*)"}]}]], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]os", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"Chop", "@", "\[Delta]os"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Delta]os", "=", 
        RowBox[{"\[Delta]os", "/.", 
         RowBox[{
          RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
          RowBox[{"Quantity", "[", 
           RowBox[{"x", ",", "\"\<Microradians\>\""}], "]"}]}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"L", "===", "1"}], ",", 
       RowBox[{"First", "@", "\[Delta]os"}], ",", "\[Delta]os"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.7150641849014177`*^9, 
   3.715064208336918*^9}, {3.715066724458549*^9, 3.715066727346246*^9}, {
   3.7150668733949633`*^9, 3.7150669069213676`*^9}, {3.715066957743388*^9, 
   3.7150670945197363`*^9}, {3.7150671517826033`*^9, 3.71506716730866*^9}, {
   3.7150674555066233`*^9, 3.7150674630550756`*^9}, 3.715327866692709*^9, {
   3.71774092056946*^9, 3.717740920587577*^9}, 3.7265614331647253`*^9, 
   3.7276752941593733`*^9, 3.7276767839805813`*^9, {3.728760781864067*^9, 
   3.7287607828225946`*^9}, {3.728766803061042*^9, 3.7287668218759413`*^9}, 
   3.728770283214877*^9, {3.730054697782065*^9, 3.730054698221176*^9}, {
   3.7300574692575827`*^9, 3.7300574868412457`*^9}, {3.730058435643704*^9, 
   3.730058435802568*^9}, {3.730058620360833*^9, 3.73005864540763*^9}, {
   3.7300587067907143`*^9, 3.730058724598506*^9}, {3.7300592235157948`*^9, 
   3.730059224427006*^9}, {3.730059279835189*^9, 3.730059284459189*^9}, {
   3.7300608042174263`*^9, 3.730060805888069*^9}, {3.7303831895898027`*^9, 
   3.7303831963897038`*^9}, {3.730395176711034*^9, 3.730395202212804*^9}, {
   3.730395349800102*^9, 3.730395368486767*^9}, {3.730395422453882*^9, 
   3.7303954240069523`*^9}, 3.7303958767970943`*^9, {3.7303960517966127`*^9, 
   3.7303960599069977`*^9}, {3.7303961470191793`*^9, 
   3.7303961694098387`*^9}, {3.730396435147455*^9, 3.730396462049367*^9}, {
   3.7303965227290487`*^9, 3.730396600446106*^9}, {3.7303967029735813`*^9, 
   3.730396703099786*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[32]:=",ExpressionUUID->"30b4dacd-4df2-42f5-bc88-e910a7afa72f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[33]:=",ExpressionUUID->"07b41cf6-96a4-4ebb-93b8-170ecc7e45c5"]
}, Closed]],

Cell[CellGroupData[{

Cell["DeleteCrystalData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.681877554281225*^9, 3.68187756023109*^9}, 
   3.717942263772325*^9},ExpressionUUID->"535ee6ae-9e32-42fd-a8be-\
bff9d29502a7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[34]:=",ExpressionUUID->"62f5e9a5-4ff9-417b-b2b2-df88de8ae8e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeleteCrystalData", "::", "noitem"}], "=", 
   "\"\<No compound with the name \[LeftGuillemet]`1`\[RightGuillemet] was \
found.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.66810571214802*^9, {3.6681867516522207`*^9, 
   3.668186778354513*^9}, {3.6681868394172163`*^9, 3.6681868614325943`*^9}, {
   3.668187374101748*^9, 3.6681874104278383`*^9}, {3.668187695125526*^9, 
   3.668187730468417*^9}, {3.668188056044814*^9, 3.668188056876872*^9}, {
   3.6681926250344687`*^9, 3.668192625250432*^9}, 3.68166923708845*^9, {
   3.6817064191712627`*^9, 3.68170642414537*^9}, {3.6817239114596*^9, 
   3.681723955601696*^9}, {3.681724223652172*^9, 3.681724224172266*^9}, {
   3.6818128705108147`*^9, 3.681812886108671*^9}, {3.681819874858591*^9, 
   3.681819895264824*^9}, {3.681835709479094*^9, 3.681835743293057*^9}, 
   3.6818778800239573`*^9, {3.681879107934513*^9, 3.681879148355654*^9}, {
   3.682081361022294*^9, 3.682081375516576*^9}, {3.714386091391912*^9, 
   3.714386091512733*^9}, 3.717942263807654*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"79878c94-f590-47e2-94be-d5a8533ea601"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[36]:=",ExpressionUUID->"b97ff313-206b-4087-951d-6c9983b0d06e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteCrystalData", "[", 
   RowBox[{"name_String", ",", 
    RowBox[{"OptionsPattern", "@", "ImportCrystalData"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"datafile", ",", "import", ",", "updated"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datafile", "=", 
      RowBox[{"OptionValue", "[", "\"\<DataFile\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"import", "=", 
      RowBox[{"Import", "@", "datafile"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "if", " ", "item", " ", "exists"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"import", ",", "name"}], "]"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"DeleteCrystalData", "::", "noitem"}], ",", "name"}], "]"}],
         ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Remove", " ", "item"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"updated", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"import", ",", "name"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"File", " ", "operations"}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"Export", "[", 
      RowBox[{"datafile", ",", "updated"}], "]"}], ";", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"$CrystalData", "=", "updated"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Update", " ", "auto", " ", "completion"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"FE`Evaluate", "[", 
        RowBox[{"FEPrivate`AddSpecialArgCompletion", "[", "#", "]"}], "]"}], 
       "&"}], "\[IndentingNewLine]", "\t", "[", 
      RowBox[{"\"\<$CrystalData\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Keys", "@", "$CrystalData"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"{", 
          RowBox[{
          "\"\<ChemicalFormula\>\"", ",", "\"\<SpaceGroup\>\"", ",", 
           "\[IndentingNewLine]", "\"\<LatticeParameters\>\"", ",", 
           "\"\<AtomData\>\"", ",", "\"\<Notes\>\""}], "}"}]}], 
        "\[IndentingNewLine]", "\t", "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[LeftGuillemet]\>\"", "<>", "name", "<>", 
       "\"\<\[RightGuillemet] was removed from $CrystalData.\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681877885008997*^9, 3.681877929884859*^9}, {3.681877980827692*^9, 
   3.681877985154667*^9}, {3.681878280277299*^9, 3.6818782910517817`*^9}, {
   3.68187859017274*^9, 3.681878590315352*^9}, {3.681878714824627*^9, 
   3.681878719543935*^9}, {3.681878881277033*^9, 3.681878987934103*^9}, {
   3.68187905315202*^9, 3.6818791046136007`*^9}, {3.6818791582696466`*^9, 
   3.681879261712825*^9}, {3.6818793865102987`*^9, 3.681879409132988*^9}, {
   3.681879472468985*^9, 3.681879499115823*^9}, {3.6818795475830097`*^9, 
   3.6818796325175877`*^9}, {3.681879686182065*^9, 3.681879707203885*^9}, {
   3.682081348806728*^9, 3.682081357006584*^9}, {3.682081390606442*^9, 
   3.682081392164741*^9}, {3.682082107743656*^9, 3.682082112127297*^9}, {
   3.685083307913372*^9, 3.685083308782468*^9}, {3.714386095026664*^9, 
   3.7143861062538643`*^9}, 3.717942210397461*^9, {3.717942263821899*^9, 
   3.717942263827141*^9}, {3.7184456174306097`*^9, 3.7184456306157923`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[37]:=",ExpressionUUID->"2e6e5f9f-b015-4447-b0cc-11624db7324d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[38]:=",ExpressionUUID->"179b5a81-4b15-4730-83e5-4c4a24bd57f2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtinctionLength", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.715064144253417*^9, 3.71506414748868*^9}, 
   3.7150666427337*^9, 3.728770283393445*^9, 
   3.730386833829701*^9},ExpressionUUID->"795b55de-8d76-4646-955a-\
8cf25fc4994e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[39]:=",ExpressionUUID->"49bd8dd6-7e28-4159-ab3e-05c45e2fd615"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ExtinctionLength"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "\"\<\[Pi]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, 
   3.715064183906497*^9, {3.715064323351753*^9, 3.715064331811014*^9}, {
   3.717137410052381*^9, 3.717137423793882*^9}, {3.7171375187693367`*^9, 
   3.7171375311190987`*^9}, {3.7171379767179403`*^9, 
   3.7171379940600653`*^9}, {3.71713832618981*^9, 3.7171383388679*^9}, {
   3.71907160441745*^9, 3.719071610599937*^9}, {3.726561450330326*^9, 
   3.72656145245828*^9}, {3.728765825984562*^9, 3.728765826319784*^9}, 
   3.728770283404731*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"9ad62447-5617-4e29-be46-e4f54d2fc4dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[41]:=",ExpressionUUID->"a2a2c8fb-1917-4979-aef9-964f093ddc3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtinctionLength", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "hklInput_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]o", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]h", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "ExtinctionLength"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "sg", ",", "hkl", ",", "L", ",", "\[IndentingNewLine]", "\[Lambda]", ",",
       "V", ",", "\[Theta]", ",", "R", ",", "C", ",", "FhFhbar", ",", "g", 
      ",", "\[CapitalLambda]o", ",", "\[IndentingNewLine]", "temp"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"crystal", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"crystal", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "hklInput", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "hkl"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Wavelength", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"crystal", ",", "lambda", ",", "\"\<ProcessWavelength\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Unit", " ", "cell", " ", "volume"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Classical", " ", "electron", " ", "radius"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"QuantityMagnitude", "@", 
         RowBox[{"UnitConvert", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Quantity", "[", "\"\<ClassicalElectronRadius\>\"", "]"}], 
           ",", "\"\<Angstroms\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"2.81794032", "*", 
         RowBox[{"Power", "[", 
          RowBox[{"10", ",", 
           RowBox[{"-", "5"}]}], "]"}]}]}], 
       RowBox[{"(*", " ", "\[ARing]ngstr\[ODoubleDot]ms", " ", "*)"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Bragg", " ", "angle", " ", "and", " ", "polarisation"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{
       RowBox[{"BraggAngle", "[", 
        RowBox[{"crystal", ",", "\[Lambda]", ",", "hkl", ",", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}], "*", 
       "Degree"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"C", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Polarisation\>\"", "]"}], ",", 
          RowBox[{"2", "\[Theta]"}], ",", "\"\<Polarisation\>\""}], "]"}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Structure", " ", "factors"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StructureFactor", "[", 
         RowBox[{"crystal", ",", "#", ",", "\[Lambda]", ",", 
          RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"hkl", ",", 
         RowBox[{"-", "hkl"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"temp", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F_", "?", "NumericQ"}], ",", 
           RowBox[{"\[Phi]_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
         "F"}], ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FhFhbar", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"temp", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "L"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Message", " ", "about", " ", "extinction"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FhFhbar", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"StructureFactor", "::", "extinct"}], ",", 
           RowBox[{"hkl", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "sg"}], "]"}]}], 
        "\[IndentingNewLine]", "\t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "L"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extinction", " ", 
       RowBox[{"(", "Pendell\[ODoubleDot]sung", ")"}], " ", "distance"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Gamma]o", "===", "\[Gamma]h", "===", "1"}], ",", 
       RowBox[{"g", "=", "1"}], ",", 
       RowBox[{"g", "=", 
        RowBox[{"\[Pi]", "*", 
         SqrtBox[
          RowBox[{"\[Gamma]o", "*", 
           RowBox[{"Abs", "[", "\[Gamma]h", "]"}]}]]}]}]}], "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"geometrical", " ", "factor"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Quiet", "@", 
           RowBox[{"Sow", "[", "\[IndentingNewLine]", 
            RowBox[{
             FractionBox[
              RowBox[{"V", " ", "*", "g"}], 
              RowBox[{"R", "*", "\[Lambda]", "*", 
               RowBox[{"C", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"Sqrt", "@", 
                RowBox[{"FhFhbar", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}]], "*", 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"1", " ", 
                RowBox[{"(*", " ", "\[Mu]m", " ", "*)"}]}], 
               RowBox[{
                SuperscriptBox["10", "4"], " ", 
                RowBox[{"(*", " ", "\[CapitalARing]", " ", "*)"}]}]], ")"}]}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{"\[CapitalLambda]o", "/.", 
       RowBox[{"ComplexInfinity", "\[Rule]", "Undefined"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]o", "=", 
        RowBox[{"\[CapitalLambda]o", "/.", 
         RowBox[{
          RowBox[{"x_", "?", "NumericQ"}], "\[RuleDelayed]", 
          RowBox[{"Quantity", "[", 
           RowBox[{"x", ",", "\"\<Micrometers\>\""}], "]"}]}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"L", "===", "1"}], ",", 
       RowBox[{"First", "@", "\[CapitalLambda]o"}], ",", 
       "\[CapitalLambda]o"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.7150641849014177`*^9, 
   3.715064208336918*^9}, {3.715064336668919*^9, 3.715064336823771*^9}, {
   3.7150644336583357`*^9, 3.71506443498072*^9}, {3.715064599313464*^9, 
   3.7150646079814262`*^9}, {3.7150648325136347`*^9, 3.715064858683421*^9}, {
   3.715064959383336*^9, 3.71506497243955*^9}, {3.715065015991144*^9, 
   3.7150650391032743`*^9}, 3.7150652844595957`*^9, {3.7150653189201393`*^9, 
   3.715065425962084*^9}, {3.715065469844347*^9, 3.7150655302803*^9}, {
   3.7150655873892384`*^9, 3.715065652967656*^9}, {3.715065689624295*^9, 
   3.7150656959385242`*^9}, {3.715065775044579*^9, 3.7150657795680733`*^9}, {
   3.715065865470538*^9, 3.7150658691411257`*^9}, {3.715066032083479*^9, 
   3.7150662475735207`*^9}, {3.71506629896938*^9, 3.715066312996698*^9}, {
   3.71506637443011*^9, 3.715066441209529*^9}, 3.715067144046503*^9, 
   3.715327875529291*^9, {3.717137869706513*^9, 3.71713797227919*^9}, 
   3.7171380204468603`*^9, {3.717138085667194*^9, 3.717138099861533*^9}, {
   3.717138257794202*^9, 3.717138300046898*^9}, {3.717740904476035*^9, 
   3.717740920625993*^9}, {3.719071295169293*^9, 3.719071306145207*^9}, {
   3.7190713453679743`*^9, 3.7190713498706007`*^9}, {3.719071570331616*^9, 
   3.719071600316853*^9}, {3.719071682617531*^9, 3.719071716415783*^9}, 
   3.726561454928636*^9, 3.727675294974962*^9, 3.727676784058449*^9, {
   3.728625084281598*^9, 3.7286250868079367`*^9}, {3.7287655420810003`*^9, 
   3.72876556364753*^9}, 3.728765689062871*^9, {3.7287659418637114`*^9, 
   3.728765973270775*^9}, {3.7287702834174*^9, 3.728770283426715*^9}, {
   3.7295875960614223`*^9, 3.7295876066718073`*^9}, {3.7295880419212914`*^9, 
   3.729588045870008*^9}, 3.729588317886677*^9, {3.730016054914228*^9, 
   3.73001609916604*^9}, {3.7300162031051483`*^9, 3.7300162210708637`*^9}, {
   3.730016402805884*^9, 3.730016434946889*^9}, {3.7300169223225613`*^9, 
   3.730016931871814*^9}, {3.730016980487012*^9, 3.730016988414926*^9}, {
   3.730017058262102*^9, 3.73001713016367*^9}, {3.730017389367407*^9, 
   3.730017393031343*^9}, {3.730017910923271*^9, 3.730017911905787*^9}, {
   3.7300179421231947`*^9, 3.730017942425879*^9}, {3.730053508967078*^9, 
   3.7300535115130463`*^9}, {3.730053588041451*^9, 3.7300536135897427`*^9}, {
   3.730053685134899*^9, 3.730053747427683*^9}, {3.7303807975703983`*^9, 
   3.73038082949577*^9}, {3.7303808808461246`*^9, 3.730380883510571*^9}, {
   3.730382682670476*^9, 3.730382722798382*^9}, {3.730382907061781*^9, 
   3.730382914851068*^9}, {3.730382972130056*^9, 3.7303829955933104`*^9}, {
   3.7303868622474203`*^9, 3.730386862802196*^9}, 3.730386912351308*^9, {
   3.7303872993762083`*^9, 3.7303873037725277`*^9}, {3.730388758219499*^9, 
   3.7303887933365726`*^9}, {3.7303890223980083`*^9, 3.730389028347728*^9}, {
   3.7303891190410757`*^9, 3.730389120834405*^9}, {3.730389164680416*^9, 
   3.730389217974998*^9}, {3.730389325933663*^9, 3.7303893344932623`*^9}, {
   3.730389642846589*^9, 3.730389655727233*^9}, {3.730389688718611*^9, 
   3.730389705765634*^9}, {3.73038984820268*^9, 3.73038984832907*^9}, {
   3.730389887448902*^9, 3.7303899156151333`*^9}, 3.730389960327202*^9, {
   3.7303900446145487`*^9, 3.73039005030311*^9}, {3.7303900846210203`*^9, 
   3.7303901525709753`*^9}, {3.730390218609873*^9, 3.730390291473195*^9}, {
   3.730390334190436*^9, 3.730390535722308*^9}, {3.7303905678253393`*^9, 
   3.7303905815937366`*^9}, {3.730390637143609*^9, 3.730390642919252*^9}, {
   3.730390688143659*^9, 3.7303906887496223`*^9}, {3.7303907485088778`*^9, 
   3.730390781341004*^9}, {3.7303908537158613`*^9, 3.730390889281506*^9}, {
   3.730390963086314*^9, 3.7303910164482117`*^9}, {3.730392295188819*^9, 
   3.7303923353288403`*^9}, {3.730392372387158*^9, 3.730392380323042*^9}, {
   3.730392429994944*^9, 3.73039254936828*^9}, {3.7303925800948*^9, 
   3.7303926065978394`*^9}, {3.730392641925551*^9, 3.730392715523513*^9}, {
   3.730396806995736*^9, 3.730396938711412*^9}, {3.730397029158411*^9, 
   3.730397057216755*^9}, {3.730397227802558*^9, 3.730397239752108*^9}, {
   3.730544224646261*^9, 3.730544224758662*^9}, 3.737968467860733*^9, {
   3.739170328108973*^9, 3.7391703389556093`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[42]:=",ExpressionUUID->"f9920ab3-4b93-4b6a-9d78-19921f9b5430"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[43]:=",ExpressionUUID->"02070aa5-ce13-4df1-bda3-a5b0f6597b98"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetAtomicScatteringFactors", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.6823273339048023`*^9, 3.6823273376015463`*^9}, 3.6823289774394608`*^9, 
   3.683970210830709*^9, 3.6841265886995287`*^9, 3.719063106743903*^9, {
   3.74287932850016*^9, 
   3.7428793293897877`*^9}},ExpressionUUID->"24919f78-ba9d-4485-8017-\
d361873c0764"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[44]:=",ExpressionUUID->"beece8e6-0b82-4b32-95b3-a146b40278fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetAtomicScatteringFactors", "::", "source"}], "=", 
   "\"\<Invalid data source option.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAtomicScatteringFactors", "::", "missing"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is missing in data source for \
the `2`.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAtomicScatteringFactors", "::", "slRequired"}], "=", 
   "\"\<Crystal name or Sin[\[Theta]]/\[Lambda] values required.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetAtomicScatteringFactors", "::", "slRange"}], "=", 
    "\"\<The value `1` \!\(\*SuperscriptBox[\(\[CapitalARing]\), \(-1\)]\) is \
out of range for the f0 source `2`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GetAtomicScatteringFactors"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<DispersionCorrections\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<f0Source\>\"", "\[Rule]", "\"\<WaasmaierKirfel\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<f1f2Source\>\"", "\[Rule]", "\"\<CromerLiberman\>\""}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<IgnoreIonCharge\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SeparateCorrections\>\"", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685419009402873*^9, 3.685419029744906*^9}, {
   3.7125579359845037`*^9, 3.7125579398401833`*^9}, {3.712558012825982*^9, 
   3.712558016365078*^9}, {3.712558329822263*^9, 3.712558336510482*^9}, 
   3.7190631067759323`*^9, {3.7190632013232603`*^9, 3.719063246833488*^9}, {
   3.719063683402504*^9, 3.719063702743443*^9}, 3.719064421775221*^9, {
   3.719064571481073*^9, 3.7190645880804996`*^9}, 3.719081603083643*^9, {
   3.721116109499786*^9, 3.721116109669585*^9}, {3.721116270843298*^9, 
   3.721116293378092*^9}, {3.721118253561348*^9, 3.721118283400021*^9}, {
   3.7219790998464947`*^9, 3.721979108957181*^9}, {3.721979808508971*^9, 
   3.721979808678824*^9}, {3.7220628094983597`*^9, 3.722062820951103*^9}, {
   3.727243953544322*^9, 3.7272439559577703`*^9}, 3.72724401051222*^9, {
   3.7275499818549232`*^9, 3.727549987372429*^9}, {3.73530062366187*^9, 
   3.735300624212389*^9}, {3.737968443951145*^9, 3.737968443986042*^9}, {
   3.738033298568212*^9, 3.738033315017757*^9}, {3.7380336856293583`*^9, 
   3.738033688741171*^9}, {3.738033775094706*^9, 3.738033896732421*^9}, 
   3.738044095733487*^9, 3.73837483731066*^9, {3.738377190650757*^9, 
   3.738377219040332*^9}, {3.7389895484485607`*^9, 3.7389895490286427`*^9}, {
   3.73912287327794*^9, 3.739122879307662*^9}, {3.739123332751502*^9, 
   3.739123336915341*^9}, {3.742836431091338*^9, 3.742836481639064*^9}, {
   3.74283683011233*^9, 3.742836833782606*^9}, {3.742837103929655*^9, 
   3.742837111560454*^9}, {3.742837486368683*^9, 3.742837490095265*^9}, {
   3.743865850503646*^9, 3.743865850653304*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"39e11137-e623-4e80-90e1-91a535aa0570"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[50]:=",ExpressionUUID->"58741668-ae31-4b68-8c96-a28c47036b75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAtomicScatteringFactors", "[", "\[IndentingNewLine]", 
   RowBox[{
   "crystal_String", ",", "\[IndentingNewLine]", "hklInput_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"input\[Lambda]", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "GetAtomicScatteringFactors"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", "input\[Lambda]"}], ",", "hkl", ",", 
      "elements", ",", "sl", ",", "options"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Basic", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Crystal", " ", "and", " ", 
      RowBox[{"wavelength", "/", "energy"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "crystal", ",", "\[Lambda]", ",", "\"\<ProcessWavelength\>\"", ",", 
        "False"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reflection", 
       RowBox[{"(", "s", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "hklInput", ",", "\"\<WrapSingle\>\"", ",", "\"\<Integer\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Processing", " ", "elements"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"GetElements", "[", 
       RowBox[{"crystal", ",", 
        RowBox[{"\"\<Tally\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Remove", " ", "charge", " ", "of", " ", "ions"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IgnoreIonCharge\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"elements", "=", 
        RowBox[{"DeleteDuplicates", "@", "\[IndentingNewLine]", "\t", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"elements", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
            "}"}]}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "\[Lambda]"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", 
         RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"#", ".", "H", ".", "#"}], "]"}], "/", "2."}], "&"}], "/@", 
       "hkl"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Relaying", " ", "data", " ", "to", " ",
        "main", " ", "function", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
       "\[IndentingNewLine]", 
       RowBox[{"Keys", "@", 
        RowBox[{"Options", "@", "GetAtomicScatteringFactors"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"GetAtomicScatteringFactors", "[", 
      RowBox[{"elements", ",", "sl", ",", "\[Lambda]", ",", 
       RowBox[{"Sequence", "@@", "options"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.738989411700222*^9, 3.7389894703928623`*^9}, 
   3.7389895343950033`*^9, {3.739029454453026*^9, 3.739029456444997*^9}, {
   3.7390294877647667`*^9, 3.7390294956530647`*^9}, {3.739029646544499*^9, 
   3.739029646943084*^9}, {3.7390298191600237`*^9, 3.739029819507209*^9}, {
   3.7390298759303627`*^9, 3.739029876202117*^9}, {3.739029943482131*^9, 
   3.739029944952951*^9}, {3.7390304120579443`*^9, 3.739030416064248*^9}, {
   3.7390305372605953`*^9, 3.7390305987622757`*^9}, {3.739030733247385*^9, 
   3.739030855731241*^9}, {3.739067582047143*^9, 3.73906758245932*^9}, {
   3.739067624590288*^9, 3.7390676362436237`*^9}, {3.739067930645776*^9, 
   3.739067952733529*^9}, {3.739068052660912*^9, 3.739068131969618*^9}, {
   3.7390686573589497`*^9, 3.7390686762449627`*^9}, {3.739070614123968*^9, 
   3.7390706179920053`*^9}, {3.739070671409206*^9, 3.739070709350171*^9}, {
   3.7390915530140953`*^9, 3.739091562318021*^9}, {3.7390917410760517`*^9, 
   3.739091742376841*^9}, {3.73909183390029*^9, 3.739091834556602*^9}, {
   3.739092703120399*^9, 3.739092717995928*^9}, {3.739092892829237*^9, 
   3.73909291572052*^9}, {3.739093000100039*^9, 3.739093000439804*^9}, {
   3.739093050480298*^9, 3.7390930522227297`*^9}, {3.739122449036809*^9, 
   3.73912245066613*^9}, {3.739124954088542*^9, 3.739124955982615*^9}, {
   3.739126141134688*^9, 3.739126155128496*^9}, {3.7428354928371267`*^9, 
   3.742835505521462*^9}, {3.742837884031802*^9, 3.742837886711232*^9}, {
   3.7438658506946383`*^9, 3.7438658507734423`*^9}, 3.744034734712717*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[51]:=",ExpressionUUID->"746859a9-dce8-4dec-8e2f-6c51a30e76d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAtomicScatteringFactors", "[", "\[IndentingNewLine]", 
   RowBox[{
   "inputElements_List", ",", "\[IndentingNewLine]", "inputSL_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"input\[Lambda]", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "GetAtomicScatteringFactors"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", "input\[Lambda]"}], ",", 
      RowBox[{"elements", "=", "inputElements"}], ",", 
      RowBox[{"sl", "=", "inputSL"}], ",", "\[IndentingNewLine]", "f0Source", 
      ",", "f1f2Source", ",", "$f0Local", ",", "$f1f2Local", ",", 
      "\[IndentingNewLine]", "upperLimit", ",", "ignore", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"addCorrectionsQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{
        "OptionValue", "[", "\"\<DispersionCorrections\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"separateQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<SeparateCorrections\>\"", "]"}]}]}], 
      ",", "\[IndentingNewLine]", "ipfQ", ",", "\[IndentingNewLine]", 
      "coefficients", ",", "akeys", ",", "bkeys", ",", "a", ",", "b", ",", 
      "c", ",", "\[IndentingNewLine]", "f0", ",", "corrections", ",", 
      "output", ",", "\[IndentingNewLine]", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checking", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Elements", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"elements", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "elements", "}"}], "]"}], ",", 
        "\"\<InterpretElement\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "\[Lambda]"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"sl", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "sl", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"sl", ",", 
          RowBox[{
           RowBox[{"TrueQ", "@", 
            RowBox[{"Not", "@", 
             RowBox[{"Negative", "[", "#", "]"}]}]}], "&"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetAtomicScatteringFactors", "::", "slRequired"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Wavelength", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Lambda]", "\[NotEqual]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", 
         RowBox[{"InputCheck", "[", 
          RowBox[{"\[Lambda]", ",", "\"\<GetEnergyWavelength\>\""}], 
          "]"}]}]}]}], "]"}], ";", "\t", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Data", " ", "sources"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"f0Source", "=", 
      RowBox[{"OptionValue", "[", "\"\<f0Source\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f1f2Source", "=", 
      RowBox[{"OptionValue", "[", "\"\<f1f2Source\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ignore", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<H\>\"", ",", "\"\<He\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Validating", " ", "sources"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"FileBaseName", "/@", 
            RowBox[{"FileNames", "[", 
             RowBox[{"\"\<*.m\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
                 "\[IndentingNewLine]", "\"\<AtomicScatteringFactor\>\""}], 
                "}"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           "f0Source"}], "]"}]}], "||", "\[IndentingNewLine]", "\t", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"FileBaseName", "/@", 
            RowBox[{"FileNames", "[", 
             RowBox[{"\"\<*.m\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
                 "\[IndentingNewLine]", "\"\<AtomicScatteringFactor\>\"", 
                 ",", "\"\<AnomalousCorrections\>\""}], "}"}], "]"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", "f1f2Source"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetAtomicScatteringFactors", "::", "source"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Useful", " ", "variables", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "specific", " ", "range", " ", "limits"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"upperLimit", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f0Source", "===", "\"\<CromerMann\>\""}], ",", "1.5", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"f0Source", "===", "\"\<InternationalTablesC(3rd)\>\""}], ",",
         "2.0", ",", "\[IndentingNewLine]", 
        RowBox[{"f0Source", "===", "\"\<WaasmaierKirfel\>\""}], ",", "6.0", 
        ",", "\[IndentingNewLine]", "True", ",", "2.5"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"sl", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", ">", "upperLimit"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"GetAtomicScatteringFactors", "::", "slRange"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ToString", "@", "temp"}], ",", "f0Source"}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "sl"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Loading", " ", "source", " ", "for", " ", "calculating", " ", "f0"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Setup", " ", "accumulative", " ", "variable", " ", "for", " ", "the", 
       " ", "session"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AssociationQ", "@", "$f0"}]}], ",", 
       RowBox[{"$f0", "=", 
        RowBox[{"<|", "|>"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", "Check"}], " ", "if", " ", "same", " ", 
        "source", " ", "is", " ", "imported", " ", "already"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$f0", ",", "f0Source"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"$f0Local", "=", 
        RowBox[{"$f0", "[", "f0Source", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Import"}], " ", "specified", " ", "data"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"$f0Local", "=", 
         RowBox[{"Import", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
             "\[IndentingNewLine]", "\t", "\"\<AtomicScatteringFactor\>\"", 
             ",", 
             RowBox[{"f0Source", "<>", "\"\<.m\>\""}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Update", " ", "the", " ", "accumulative", " ", "variable"}],
          " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"$f0", ",", 
          RowBox[{"f0Source", "\[Rule]", "$f0Local"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "atom", " ", "types", " ", "are", " ", "found",
        " ", "in", " ", "$f0", " ", "source"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elements", ",", 
        RowBox[{"Keys", "@", "$f0Local"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetAtomicScatteringFactors", "::", "missing"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"First", "@", "temp"}], ",", 
          "\"\<non-dispersive part \
(\!\(TraditionalForm\`\*SubscriptBox[\(f\), \(0\)]\))\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculating", " ", "form", " ", 
       "factor", " ", 
       RowBox[{"(", "f0", ")"}], " ", "from", " ", "tabulated", " ", "data", 
       " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ipfQ", "=", 
      RowBox[{
       RowBox[{"Head", "@", 
        RowBox[{"First", "@", "$f0Local"}]}], "===", 
       "InterpolatingFunction"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", "Interpolation"}], " ", "data"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"sin", 
        RowBox[{
         RowBox[{"(", "\[Theta]", ")"}], "/", "\[Lambda]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ipfQ", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Non", "-", 
         RowBox[{
         "dispersive", " ", "part", " ", "of", " ", "form", " ", "factor"}]}],
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"f0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", ",", 
            RowBox[{
             RowBox[{"$f0Local", "[", "X", "]"}], "[", "s", "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"s", ",", "sl"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"X", ",", "elements"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"b", ".", " ", "Coefficients"}], " ", "*)"}], 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Stored", " ", "with", " ", 
         RowBox[{"alternating", " ", "'"}], 
         RowBox[{"a", "'"}], " ", 
         RowBox[{"and", " ", "'"}], 
         RowBox[{"b", "'"}], "\[IndentingNewLine]", "\t", 
         RowBox[{"and", " ", "'"}], 
         RowBox[{"c", "'"}], " ", "last"}], " ", "*)"}], "\t\t", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"coefficients", "=", 
         RowBox[{"$f0Local", "[", 
          RowBox[{"[", "elements", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"akeys", ",", "bkeys"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Keys", "@", 
               RowBox[{"First", "@", "coefficients"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "~~", 
               RowBox[{"DigitCharacter", ".."}]}]}], "]"}]}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"\"\<a\>\"", ",", "\"\<b\>\""}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Values", "/@", 
            RowBox[{"coefficients", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "akeys"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Values", "/@", 
            RowBox[{"coefficients", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "bkeys"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Values", "@", 
            RowBox[{"coefficients", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "\"\<c\>\""}], "]"}], "]"}]}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Non", "-", 
          RowBox[{
          "dispersive", " ", "part", " ", "of", " ", "form", " ", 
           "factor"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"f0", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "coefficients", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"b", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "*", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"sl", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ")"}], "2"]}], "]"}]}], 
               "]"}], "+", 
              RowBox[{"c", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "@", "sl"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "elements"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", ":", " ", 
       RowBox[{
       "Correct", " ", "normalisation", " ", "by", " ", "electrons"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"ipfQ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"$f0Local", "[", "\"\<C\>\"", "]"}], "[", "0", "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Total", "@", 
              RowBox[{"Values", "@", 
               RowBox[{"$f0Local", "[", 
                RowBox[{"[", 
                 RowBox[{"\"\<C\>\"", ",", "akeys"}], "]"}], "]"}]}]}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{"$f0Local", "[", 
              RowBox[{"\"\<C\>\"", ",", "\"\<c\>\""}], "]"}]}]}], "]"}], "-", 
          "6"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Carbon", ":", " ", "Z"}], "=", "6"}], " ", "*)"}], "]"}], 
        ">", "0.5"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f0", "=", 
        RowBox[{"f0", "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X_String", ",", 
            RowBox[{"f_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"X", ",", 
            RowBox[{"f", "*", 
             RowBox[{"$PeriodicTable", "[", 
              RowBox[{"X", ",", "\"\<AtomicNumber\>\""}], "]"}]}]}], 
           "}"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Dispersion", " ", "corrections", " ", 
       RowBox[{"(", 
        RowBox[{"f1", " ", "+", " ", "f2"}], ")"}], " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"No", " ", "dispersion", " ", "corrections"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Lambda]", "===", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"addCorrectionsQ", "=", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "addCorrectionsQ"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Prepare", " ", "output"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"output", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Association", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"Transpose", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
            "f0"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Loading", " ", "source", " ", "for", " ", "calculating", " ", 
        RowBox[{"f", "'"}]}], " ", "+", " ", 
       RowBox[{"f", "''"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Setup", " ", "global", " ", "variable", " ", "for", " ", "the", " ", 
       "session"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AssociationQ", "@", "$f1f2"}]}], ",", 
       RowBox[{"$f1f2", "=", 
        RowBox[{"<|", "|>"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", "Check"}], " ", "if", " ", "same", " ", 
        "source", " ", "is", " ", "imported", " ", "already"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$f1f2", ",", "f1f2Source"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"$f1f2Local", "=", 
        RowBox[{"$f1f2", "[", "f1f2Source", "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Import"}], " ", "specified", " ", "data"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"$f1f2Local", "=", 
         RowBox[{"Import", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
             "\[IndentingNewLine]", "\t", "\"\<AtomicScatteringFactor\>\"", 
             ",", "\"\<AnomalousCorrections\>\"", ",", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"f1f2Source", "<>", "\"\<.m\>\""}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Update", " ", "the", " ", 
          RowBox[{"session", "'"}], "s", " ", "global", " ", "variable"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"$f1f2", ",", 
          RowBox[{"f1f2Source", "\[Rule]", "$f1f2Local"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "atom", " ", "types", " ", "are", " ", "found",
        " ", "in", " ", "$f1f2", " ", "source"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elements", ",", 
        RowBox[{"Keys", "@", "$f1f2Local"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"temp", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{"ignore", "\[Rule]", "Nothing"}], "]"}]}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"ignored", " ", "elements"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetAtomicScatteringFactors", "::", "missing"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"First", "@", "temp"}], ",", 
          "\"\<dispersion corrections \
(\!\(\*FormBox[RowBox[{SuperscriptBox[\"f\", \
\"\[Prime]\",MultilineFunction->None], \"+\", SuperscriptBox[\"f\", \
\"\[Prime]\[Prime]\",MultilineFunction->None]}],TraditionalForm]\))\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Procedure", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"ignore", ",", 
            RowBox[{"elements", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"corrections", "=", 
         RowBox[{
          RowBox[{"$f1f2Local", "[", 
           RowBox[{"elements", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "[", "\[Lambda]", "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"f0", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "corrections"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "sl"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "@", "elements"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "and", " ", 
       "returning", " ", "association", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"separateQ", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Return"}], " ", "f0", " ", "and", " ", 
         "f1f2", " ", "separated"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f0", "=", 
        RowBox[{"f0", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Elements", " ", "with", " ", "corrections"}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f0_", "?", "NumericQ"}], ",", 
              RowBox[{"f1f2_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"X", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<f0\>\"", "\[Rule]", "f0"}], ",", 
                RowBox[{"\"\<f1f2\>\"", "\[Rule]", "f1f2"}]}], "|>"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Without", " ", "corrections", " ", 
             RowBox[{"(", 
              RowBox[{"ignored", " ", "elements"}], ")"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f0_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"X", "\[Rule]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<f0\>\"", "\[Rule]", "f0"}], ",", 
                RowBox[{"\"\<f1f2\>\"", "\[Rule]", "0."}]}], "|>"}]}], 
             ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Return"}], " ", "f0", " ", "and", " ", 
         "f1f2", " ", "combined"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f0", "=", 
        RowBox[{"f0", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Elements", " ", "with", " ", "corrections"}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f0_", "?", "NumericQ"}], ",", 
              RowBox[{"f1f2_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"X", "\[Rule]", 
              RowBox[{"f0", "+", "f1f2"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Without", " ", "corections", " ", 
             RowBox[{"(", 
              RowBox[{"ignored", " ", "elements"}], ")"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"X_String", ",", 
              RowBox[{"f0_", "?", "NumericQ"}]}], "}"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"X", "\[Rule]", "f0"}], ")"}]}]}], "\[IndentingNewLine]",
           "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"Association", "/@", "f0"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "output"}], "\[Equal]", "1"}], ",", 
       RowBox[{"First", "@", "output"}], ",", "output"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327825752265*^9, {3.682327891309991*^9, 3.682327908905006*^9}, {
   3.682328462663025*^9, 3.682328464594318*^9}, {3.6823288379476137`*^9, 
   3.682328840375494*^9}, {3.6823289450420847`*^9, 3.682328948786008*^9}, 
   3.682329021553924*^9, {3.682329649608305*^9, 3.682329652832589*^9}, 
   3.6823298080835743`*^9, {3.682350312716905*^9, 3.682350378410404*^9}, 
   3.6823504635691757`*^9, {3.6823505010243587`*^9, 3.682350503583688*^9}, {
   3.68235624088593*^9, 3.68235624215532*^9}, {3.6824154065363083`*^9, 
   3.682415411290797*^9}, {3.6824949312809687`*^9, 3.682494933923278*^9}, {
   3.682494968776065*^9, 3.6824950015362787`*^9}, {3.682495062367214*^9, 
   3.6824950649247932`*^9}, {3.682495113046337*^9, 3.6824951159073544`*^9}, {
   3.68249526412218*^9, 3.682495265376318*^9}, {3.68249545065454*^9, 
   3.682495470163967*^9}, {3.682495512292554*^9, 3.682495515202944*^9}, {
   3.682495556347404*^9, 3.682495579369482*^9}, {3.6824958395091257`*^9, 
   3.682495843227323*^9}, {3.6824961499028397`*^9, 3.682496152773938*^9}, {
   3.682496263451882*^9, 3.682496267049795*^9}, {3.682496312064939*^9, 
   3.6824963159122458`*^9}, {3.682496526788476*^9, 3.682496526940209*^9}, {
   3.682496864685812*^9, 3.682496866861273*^9}, {3.682496942171248*^9, 
   3.68249696514644*^9}, 3.682497201839513*^9, {3.6824972729799232`*^9, 
   3.682497296643372*^9}, {3.6824973270838213`*^9, 3.68249734521832*^9}, 
   3.68268180724885*^9, {3.684128291025429*^9, 3.684128389624958*^9}, {
   3.68412845933915*^9, 3.684128486385932*^9}, {3.684128529353738*^9, 
   3.6841285582182617`*^9}, {3.6841288206899014`*^9, 3.684128901287672*^9}, {
   3.684128968928697*^9, 3.68412900913936*^9}, {3.6841292785084352`*^9, 
   3.684129357017983*^9}, {3.684129890723934*^9, 3.684129917971912*^9}, {
   3.6841300831135187`*^9, 3.684130083432626*^9}, {3.684138321122032*^9, 
   3.684138354809764*^9}, {3.684138494851803*^9, 3.6841385035605307`*^9}, {
   3.684138540043199*^9, 3.6841385752075777`*^9}, {3.685245928608788*^9, 
   3.685245936564748*^9}, {3.685292498644186*^9, 3.685292547209746*^9}, {
   3.685293229629302*^9, 3.685293257980389*^9}, {3.6852936989464273`*^9, 
   3.685293705920918*^9}, {3.685418988387327*^9, 3.6854191059404497`*^9}, 
   3.685765928283773*^9, {3.686654834485551*^9, 3.686654890223186*^9}, {
   3.6870719114095488`*^9, 3.687071942441597*^9}, {3.687073759256621*^9, 
   3.687073768483142*^9}, {3.7125582963506203`*^9, 3.712558305396607*^9}, {
   3.712559925957469*^9, 3.712559958639057*^9}, {3.7144624028419037`*^9, 
   3.71446242110505*^9}, {3.714462795136908*^9, 3.714462796079183*^9}, {
   3.7144629484210367`*^9, 3.714462949924136*^9}, {3.7147117501417923`*^9, 
   3.714711761681143*^9}, {3.714816107140924*^9, 3.714816126138484*^9}, {
   3.717740896691929*^9, 3.7177409196728354`*^9}, {3.717952009923753*^9, 
   3.7179520150663*^9}, {3.7179522469270687`*^9, 3.717952248741308*^9}, {
   3.7179527562586317`*^9, 3.7179527571544733`*^9}, {3.718544518737887*^9, 
   3.7185445547663393`*^9}, {3.718544588671667*^9, 3.718544588764153*^9}, {
   3.7185446206531773`*^9, 3.718544630189608*^9}, {3.718544762313016*^9, 
   3.718544814550006*^9}, {3.718544854669929*^9, 3.718544932380745*^9}, {
   3.718544962436681*^9, 3.718545027673493*^9}, {3.71854509931327*^9, 
   3.718545153141809*^9}, {3.7185453205399714`*^9, 3.718545412007901*^9}, {
   3.718545450896759*^9, 3.718545474214239*^9}, {3.718545507359365*^9, 
   3.718545544238356*^9}, {3.718616920438265*^9, 3.7186169486191177`*^9}, {
   3.718618101945353*^9, 3.718618175014943*^9}, {3.71861823134766*^9, 
   3.718618233851248*^9}, {3.718618432192004*^9, 3.71861847096095*^9}, {
   3.71861933868747*^9, 3.7186193433759203`*^9}, {3.718619375509334*^9, 
   3.718619496235456*^9}, {3.718619532771413*^9, 3.718619580864337*^9}, 
   3.718619728829987*^9, {3.718630103558402*^9, 3.7186301187980003`*^9}, {
   3.7186366955384483`*^9, 3.718636713785058*^9}, {3.7186374428406067`*^9, 
   3.7186374662234697`*^9}, {3.718656479247999*^9, 3.7186564858851337`*^9}, {
   3.718983804226858*^9, 3.71898380604974*^9}, 3.719062288435821*^9, {
   3.71906310678584*^9, 3.719063106792266*^9}, {3.719064122833111*^9, 
   3.719064129919709*^9}, {3.71906420106341*^9, 3.719064259852654*^9}, {
   3.719064297563863*^9, 3.719064496821637*^9}, {3.719064545749486*^9, 
   3.719064592700036*^9}, {3.719064642354143*^9, 3.71906476771029*^9}, {
   3.719064823557804*^9, 3.719065238482019*^9}, {3.719065277135886*^9, 
   3.719065303399061*^9}, {3.719065395813827*^9, 3.719065399308429*^9}, {
   3.719065437323184*^9, 3.7190654511549473`*^9}, {3.719065561170032*^9, 
   3.719065627343844*^9}, {3.719065670965363*^9, 3.719065959082838*^9}, {
   3.719065992179327*^9, 3.719066064234557*^9}, {3.719066151894588*^9, 
   3.719066207283177*^9}, {3.719066242019342*^9, 3.719066304096162*^9}, {
   3.719066351920788*^9, 3.719066359399228*^9}, {3.71906641432609*^9, 
   3.719066542108021*^9}, {3.719066589433022*^9, 3.7190665954992647`*^9}, {
   3.719067892506781*^9, 3.71906802254603*^9}, {3.719068084604827*^9, 
   3.719068291842124*^9}, {3.719068376944273*^9, 3.71906849841955*^9}, {
   3.719069206288807*^9, 3.719069218336574*^9}, {3.71906933199855*^9, 
   3.7190693337006483`*^9}, 3.719069638219943*^9, {3.719069709698402*^9, 
   3.719069710945162*^9}, {3.719070447671543*^9, 3.719070461169828*^9}, {
   3.7190705162010508`*^9, 3.719070528918353*^9}, 3.719081605979241*^9, {
   3.721111484659971*^9, 3.721111498639818*^9}, {3.721114454508944*^9, 
   3.721114476380396*^9}, {3.721116073710249*^9, 3.721116105096229*^9}, {
   3.721116139165756*^9, 3.7211161755548077`*^9}, {3.7211162447180643`*^9, 
   3.7211162652677107`*^9}, {3.721116304117589*^9, 3.721116355056438*^9}, {
   3.721116452754876*^9, 3.721116467221505*^9}, {3.7211169325691433`*^9, 
   3.7211170058057423`*^9}, {3.721117041112558*^9, 3.7211170477626753`*^9}, {
   3.721117332499308*^9, 3.7211173675329247`*^9}, {3.7211179516387444`*^9, 
   3.721117953257985*^9}, {3.7211180826882343`*^9, 3.721118171815936*^9}, {
   3.721118217999258*^9, 3.721118247833887*^9}, 3.7211182947294817`*^9, {
   3.72111835817647*^9, 3.721118370282798*^9}, 3.721118417964911*^9, {
   3.721118679807076*^9, 3.7211188691654882`*^9}, {3.721119001756874*^9, 
   3.721119004843071*^9}, {3.7213695267756367`*^9, 3.72136952711127*^9}, {
   3.7213696067684183`*^9, 3.721369607060883*^9}, 3.721369689533557*^9, {
   3.721369757784193*^9, 3.7213698829506197`*^9}, {3.721371083758843*^9, 
   3.7213710990474377`*^9}, {3.72137113797754*^9, 3.7213711507631893`*^9}, {
   3.7213711847212*^9, 3.721371188174782*^9}, {3.721371685952198*^9, 
   3.7213717065716248`*^9}, {3.721371766390019*^9, 3.7213719755300817`*^9}, {
   3.721372756009329*^9, 3.721372949382916*^9}, {3.721470172812934*^9, 
   3.721470178730687*^9}, {3.7214702679556103`*^9, 3.72147034954385*^9}, {
   3.7216675361871223`*^9, 3.721667588792684*^9}, {3.7217381025032473`*^9, 
   3.721738163898419*^9}, {3.7217381946470137`*^9, 3.721738227941464*^9}, {
   3.721738503929742*^9, 3.721738506861105*^9}, {3.721738837218*^9, 
   3.721738838966873*^9}, {3.721738890429645*^9, 3.721738905286234*^9}, {
   3.721738943252236*^9, 3.721738999644347*^9}, {3.721739033683166*^9, 
   3.7217390375656013`*^9}, {3.72173907096627*^9, 3.721739079289625*^9}, {
   3.721739320598371*^9, 3.721739348557314*^9}, {3.721739402271968*^9, 
   3.721739404192616*^9}, {3.7217394351329517`*^9, 3.7217394636473303`*^9}, 
   3.721978061389715*^9, 3.721978138688751*^9, {3.721978206640265*^9, 
   3.721978208092898*^9}, {3.7219785079842653`*^9, 3.721978509914443*^9}, {
   3.7219785635057592`*^9, 3.721978563662822*^9}, {3.721978732407447*^9, 
   3.7219787397994967`*^9}, {3.721978918989682*^9, 3.721978976909795*^9}, {
   3.721979165739716*^9, 3.721979210741995*^9}, 3.721979597187673*^9, {
   3.7219796310100183`*^9, 3.7219796891672897`*^9}, {3.7219798180589237`*^9, 
   3.721979818654977*^9}, {3.721979861140045*^9, 3.721979863917323*^9}, {
   3.721982886145628*^9, 3.721982890654036*^9}, 3.721983004540848*^9, 
   3.7219833873520203`*^9, {3.7220628751118727`*^9, 3.722062879005816*^9}, {
   3.722062917283605*^9, 3.7220629634710503`*^9}, {3.7220630332216253`*^9, 
   3.722063111337685*^9}, {3.7220631494555893`*^9, 3.7220631950136127`*^9}, {
   3.722063245677351*^9, 3.722063245754569*^9}, {3.7220632861497726`*^9, 
   3.722063298693756*^9}, {3.722063614430664*^9, 3.7220636503987513`*^9}, {
   3.722063724542623*^9, 3.7220638054642982`*^9}, {3.722063847312479*^9, 
   3.722063959471467*^9}, {3.722064007036425*^9, 3.722064008040326*^9}, {
   3.722064091453974*^9, 3.722064098537808*^9}, {3.7220642034603243`*^9, 
   3.722064223013564*^9}, {3.7220648781494017`*^9, 3.722064899648937*^9}, {
   3.722064959884466*^9, 3.722064997021698*^9}, {3.722070723902894*^9, 
   3.7220708235593147`*^9}, {3.7220710632953033`*^9, 
   3.7220710658061457`*^9}, {3.722071129589094*^9, 3.722071146534827*^9}, {
   3.722071669280542*^9, 3.722071765901602*^9}, {3.722071822272051*^9, 
   3.722071845683749*^9}, {3.722072164516849*^9, 3.722072167780717*^9}, {
   3.722073655169406*^9, 3.7220736617514887`*^9}, 3.722073805452601*^9, {
   3.72207386943486*^9, 3.722073870941247*^9}, {3.7220740869677896`*^9, 
   3.722074234766919*^9}, {3.722074642509527*^9, 3.722074668862341*^9}, {
   3.722074757686634*^9, 3.7220747595372257`*^9}, {3.72207490374716*^9, 
   3.7220749274001503`*^9}, {3.722074961839517*^9, 3.722074971593493*^9}, {
   3.722075008921195*^9, 3.722075018780717*^9}, {3.722075215353648*^9, 
   3.7220753120849047`*^9}, {3.722076994991275*^9, 3.722077069678069*^9}, {
   3.722077195062983*^9, 3.722077243822541*^9}, 3.7220772743854513`*^9, {
   3.722243649938464*^9, 3.7222437148647757`*^9}, 3.722243761880186*^9, {
   3.72224401456736*^9, 3.7222440921223297`*^9}, {3.7222441629239063`*^9, 
   3.722244206882749*^9}, {3.72224429108885*^9, 3.722244297037649*^9}, {
   3.722244469565585*^9, 3.722244493083477*^9}, {3.722244742617938*^9, 
   3.722244829576676*^9}, {3.722244864913772*^9, 3.722244865438043*^9}, {
   3.722244904946373*^9, 3.7222449065887117`*^9}, {3.7222449569000607`*^9, 
   3.722244985152135*^9}, {3.7222450326142883`*^9, 3.722245087078844*^9}, {
   3.722245211235154*^9, 3.722245324219537*^9}, {3.722245388354319*^9, 
   3.72224546123627*^9}, {3.722245564764122*^9, 3.722245602990396*^9}, {
   3.722245650062417*^9, 3.7222458427141237`*^9}, {3.7222459236619883`*^9, 
   3.722245925999093*^9}, {3.7222459577587442`*^9, 3.722246038452992*^9}, {
   3.722246068729703*^9, 3.7222461134808683`*^9}, 3.722246197289178*^9, {
   3.722246227722828*^9, 3.722246233988699*^9}, {3.722246466996821*^9, 
   3.722246489019541*^9}, {3.7222465272614803`*^9, 3.72224653182295*^9}, {
   3.722246623496787*^9, 3.7222466492769814`*^9}, {3.722246684608173*^9, 
   3.7222467872720537`*^9}, {3.722246865247857*^9, 3.722246897929769*^9}, {
   3.725450303231864*^9, 3.725450375874055*^9}, {3.7254506754329567`*^9, 
   3.7254506760393887`*^9}, {3.725617035799721*^9, 3.725617090660178*^9}, {
   3.726561272575226*^9, 3.726561274880137*^9}, {3.727190754853161*^9, 
   3.727190758466567*^9}, 3.7272440207193537`*^9, {3.727244062854665*^9, 
   3.7272440720571413`*^9}, {3.7272441062895412`*^9, 3.7272441219715643`*^9}, 
   3.727675291335369*^9, 3.727676784440756*^9, {3.727677723074018*^9, 
   3.7276777305774937`*^9}, {3.727677842605393*^9, 3.727677842848339*^9}, 
   3.7303792902468443`*^9, 3.7303795870483294`*^9, 3.730544161219339*^9, {
   3.735300592767964*^9, 3.735300700450007*^9}, {3.7353007716396646`*^9, 
   3.735300799957919*^9}, {3.73780662301538*^9, 3.737806623155034*^9}, {
   3.73780665691374*^9, 3.737806661938918*^9}, {3.737968444012001*^9, 
   3.737968466742126*^9}, {3.738033394156886*^9, 3.738033405133856*^9}, {
   3.738033463353322*^9, 3.738033466796254*^9}, {3.7380336179612617`*^9, 
   3.738033675235551*^9}, {3.738033907923669*^9, 3.7380339474822598`*^9}, {
   3.738034499039502*^9, 3.738034829837838*^9}, {3.738042804020746*^9, 
   3.7380428243889933`*^9}, 3.738042869407331*^9, {3.738044069175473*^9, 
   3.738044075665268*^9}, {3.738044587915038*^9, 3.738044609408504*^9}, {
   3.738374849526939*^9, 3.73837486611399*^9}, {3.738375561949725*^9, 
   3.7383755788616657`*^9}, {3.738376351336351*^9, 3.73837636721344*^9}, {
   3.73837648700519*^9, 3.738376504603709*^9}, {3.7383765957531567`*^9, 
   3.738376597048367*^9}, {3.738377383380872*^9, 3.7383774119624166`*^9}, {
   3.738377483068665*^9, 3.7383775471710443`*^9}, {3.738989535573518*^9, 
   3.738989564467999*^9}, {3.7390294441931458`*^9, 3.739029452581423*^9}, 
   3.73902948487638*^9, {3.7390305195750637`*^9, 3.7390305356373043`*^9}, {
   3.739030588203383*^9, 3.739030612183899*^9}, {3.739067426454228*^9, 
   3.739067431611511*^9}, {3.739067543213336*^9, 3.73906755042027*^9}, {
   3.7390677181533937`*^9, 3.739067809999744*^9}, {3.739068246421269*^9, 
   3.739068367918603*^9}, {3.73906846077668*^9, 3.73906848789557*^9}, {
   3.7390692568568907`*^9, 3.739069262310021*^9}, {3.73907016157126*^9, 
   3.739070228128346*^9}, {3.739070266641101*^9, 3.7390703796683273`*^9}, {
   3.73907043147178*^9, 3.739070482013937*^9}, {3.739070549748425*^9, 
   3.739070581456558*^9}, 3.739070651144397*^9, {3.7390707171014223`*^9, 
   3.739070888355019*^9}, {3.739070920225849*^9, 3.7390709932279167`*^9}, {
   3.739071046423064*^9, 3.739071106867024*^9}, {3.739071139516616*^9, 
   3.739071139644754*^9}, {3.7390712048593607`*^9, 3.739071214027072*^9}, {
   3.739091844973487*^9, 3.739091848421885*^9}, {3.739118949258746*^9, 
   3.73911895237396*^9}, {3.739122084305634*^9, 3.739122107394026*^9}, {
   3.739122175929167*^9, 3.739122197093604*^9}, {3.739122277093368*^9, 
   3.7391223277430763`*^9}, {3.7391223601992397`*^9, 3.739122427148471*^9}, {
   3.739122494574834*^9, 3.739122547036766*^9}, {3.7391225967208633`*^9, 
   3.739122868703513*^9}, {3.739122942628067*^9, 3.739122960537838*^9}, {
   3.739122996377776*^9, 3.739123025222269*^9}, {3.7391232755617447`*^9, 
   3.739123311458004*^9}, {3.739123345161305*^9, 3.7391234203204117`*^9}, {
   3.739123471040163*^9, 3.7391234988332644`*^9}, {3.739123583213578*^9, 
   3.7391236164442587`*^9}, {3.739123707773747*^9, 3.739123716331357*^9}, {
   3.739123838903887*^9, 3.73912390812017*^9}, {3.7391239656894083`*^9, 
   3.7391239800613203`*^9}, {3.739124013732561*^9, 3.7391240438900843`*^9}, {
   3.739124092146432*^9, 3.739124101163595*^9}, {3.7391242703740892`*^9, 
   3.7391243138881083`*^9}, {3.7391243821879387`*^9, 3.739124431664143*^9}, {
   3.739124645162651*^9, 3.7391246482649107`*^9}, 3.742836771505156*^9, {
   3.742836807056857*^9, 3.742836816961413*^9}, {3.742836880541464*^9, 
   3.742836967507223*^9}, {3.742837040956266*^9, 3.742837078243389*^9}, {
   3.742837238855632*^9, 3.742837258821867*^9}, {3.7428373668286657`*^9, 
   3.742837429504389*^9}, {3.7428374630660954`*^9, 3.742837470649785*^9}, {
   3.7428375176544447`*^9, 3.742837519601564*^9}, {3.7428376441124363`*^9, 
   3.7428376444445887`*^9}, {3.742839789437457*^9, 3.74283982100668*^9}, {
   3.742839878580009*^9, 3.7428398869376783`*^9}, {3.7428400477123137`*^9, 
   3.742840079988522*^9}, {3.7428793564906693`*^9, 3.742879357265019*^9}, {
   3.7438654119933443`*^9, 3.743865412153145*^9}, {3.743865850854823*^9, 
   3.7438658511023407`*^9}, 3.7440347878671427`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[52]:=",ExpressionUUID->"0d23a345-98fa-4437-be4e-5f73556fc832"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[53]:=",ExpressionUUID->"734fba65-e4f7-40ce-9781-45bf41a9bf17"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetCrystalMetric", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 
   3.7050304802794743`*^9}},ExpressionUUID->"5102ffa4-909c-4b6c-b671-\
c469e803a525"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[54]:=",ExpressionUUID->"1da26f4b-d93c-451e-abb1-71b5fd30066a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetCrystalMetric", "::", "input"}], "=", 
   "\"\<Invalid input.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.737968467400035*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"6377ed0e-4ead-442a-8b47-7cd302c131aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[56]:=",ExpressionUUID->"7f84ccba-b3fa-4f68-9d54-9558d4ac43a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCrystalMetric", "[", "cell_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
      "\[Gamma]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"AllTrue", "[", 
          RowBox[{"cell", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"QuantityQ", "[", "#", "]"}], "||", 
             RowBox[{"NumericQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], "||", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Flatten", "@", "cell"}]}], "\[NotEqual]", "6"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetCrystalMetric", "::", "input"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
        "\[Gamma]"}], "}"}], "=", "cell"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Converting", " ", "to", " ", "\[ARing]ngstr\[ODoubleDot]ms", " ", 
       "and", " ", "degrees"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{"cell", ",", "QuantityQ"}], "]"}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
         RowBox[{"QuantityMagnitude", "@", 
          RowBox[{"UnitConvert", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
            "\"\<Angstroms\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], "=", 
         RowBox[{"QuantityMagnitude", "@", 
          RowBox[{"UnitConvert", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], 
            ",", "\"\<Degrees\>\""}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Use", " ", "degrees", " ", "if", " ", "any", " ", "angle", " ", "is", 
       " ", "greater", " ", "than", " ", "2", " ", "pi"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], ",", 
         RowBox[{
          RowBox[{"#", ">", 
           RowBox[{"2", "\[Pi]"}]}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], "*", 
         "Degree"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Metric", " ", "tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Chop", "@", 
      RowBox[{"N", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["a", "2"], ",", 
           RowBox[{"a", "*", "b", "*", 
            RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], ",", 
           RowBox[{"a", "*", "c", "*", 
            RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "*", "b", "*", 
            RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], ",", 
           SuperscriptBox["b", "2"], ",", 
           RowBox[{"b", "*", "c", "*", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "*", "c", "*", 
            RowBox[{"Cos", "[", "\[Beta]", "]"}]}], ",", 
           RowBox[{"b", "*", "c", "*", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
           SuperscriptBox["c", "2"]}], "}"}]}], "}"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.73796846746421*^9, 
   3.737968467560033*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[57]:=",ExpressionUUID->"3fda4c77-57a9-4bfb-9bd7-1a1c5bb91dd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCrystalMetric", "[", "crystal_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "cell", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", "crystal", "]"}], ";", "\[IndentingNewLine]", 
     "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "crystal", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"Values", "@", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"crystal", ",", "\"\<LatticeParameters\>\""}], "]"}]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Send", " ", "to", " ", "main", " ", "function"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"GetCrystalMetric", "[", "cell", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.686645696885454*^9, 3.6866457898006983`*^9}, 3.6866462014189377`*^9, {
   3.6866462339766903`*^9, 3.6866462728638067`*^9}, {3.686655099410577*^9, 
   3.686655107244615*^9}, {3.686655139554606*^9, 3.6866551405555973`*^9}, {
   3.686655247894999*^9, 3.6866552845727777`*^9}, {3.686655778710911*^9, 
   3.686655795708418*^9}, {3.687071225215375*^9, 3.687071234708887*^9}, 
   3.717740920552018*^9, {3.73796846764878*^9, 3.737968467759383*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[58]:=",ExpressionUUID->"c85c15d8-67dc-4f48-8cfa-69313f144ced"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[59]:=",ExpressionUUID->"7199359a-d5d5-45a5-9448-4740413ccbf5"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetElements", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, 
   3.717739586397138*^9},ExpressionUUID->"10d7dc86-bb0d-4ff7-97bc-\
09d46e0c3900"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[60]:=",ExpressionUUID->"45c26c74-0a62-4901-80d7-ed48eb93c5e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetElements", "::", "formula"}], "=", 
   "\"\<Invalid chemical formula.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetElements", "::", "invalid"}], "=", 
    "\"\<Invalid elements detected: `1`.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GetElements"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<IgnoreIonCharge\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Tally\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719174557698147*^9, 3.719174575089182*^9}, 
   3.7272440207601767`*^9, {3.735028184066166*^9, 3.735028195898958*^9}, {
   3.735028314418393*^9, 3.7350283221953506`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"4c7714ac-5c79-43ef-b154-444c18ade0f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"GetElements", ",", "Listable"}], "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7300961670423326`*^9, 3.7300961708125143`*^9}, {
  3.730096698004781*^9, 3.730096704220503*^9}, {3.735299593238161*^9, 
  3.735299597043624*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"588d7476-19e3-4be4-b875-678843f212af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[65]:=",ExpressionUUID->"20e54942-edc7-4d8b-b52e-5260280dc9bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetElements", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"OptionsPattern", "@", "GetElements"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"formula", "=", "input"}], ",", "patternX", ",", "groupX", ",", 
      
      RowBox[{"tallyQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<Tally\>\"", "]"}]}]}], ",", 
      "elements", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Check", " ", "input", " ", "string", 
      " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"--", 
      RowBox[{"*", " ", 
       RowBox[{"A", ".", " ", "Crystal"}], " ", "name", " ", "input", " ", 
       "*", "--"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "@", "$CrystalData"}], ",", "input"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Use"}], " ", "chemical", " ", "formula"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"$CrystalData", "@", "input"}], ",", 
          "\"\<ChemicalFormula\>\"", ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"b", ".", " ", "Return"}], " ", "elements", " ", 
            "contained", " ", 
            RowBox[{"in", " ", "'"}], 
            RowBox[{"AtomData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"elements", "=", 
            RowBox[{"$CrystalData", "[", 
             RowBox[{"[", 
              RowBox[{
              "input", ",", "\"\<AtomData\>\"", ",", "All", ",", 
               "\"\<Element\>\""}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"tallyQ", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Return", " ", "tally"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "@", 
              RowBox[{"Tally", "@", "elements"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Return", " ", "elements", " ", "only"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "@", 
              RowBox[{"DeleteDuplicates", "@", "elements"}]}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"*", " ", 
        RowBox[{"B", ".", " ", "Chemical"}], " ", "formula", " ", "string", 
        " ", "*", "--"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"FullForm", "@", "formula"}]}], ",", "\"\<!\>\""}], "]"}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Formatted"}], " ", "string"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Considering", " ", "the", " ", "full", " ", "form"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"elements", "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"FullForm", "@", "formula"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Marking", " ", "subscripts", " ", 
            RowBox[{"with", " ", "'"}], 
            RowBox[{"$", "'"}], " ", "\[IndentingNewLine]", "\t\t", 
            "elements"}], "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"elements", ",", 
             RowBox[{"\"\<\\\\), \\\\(\>\"", "\[Rule]", "\"\<$\>\""}]}], 
            "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Cleaning", " ", "the", " ", "full", " ", "form"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"elements", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"elements", ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\\\\!\\\\(\\\\*SubscriptBox[\\\\(\>\"", ",", 
             "\[IndentingNewLine]", "\t\t", "\"\<[\\\\(\>\"", ",", 
             "\"\<\\\\)]\\\\)\>\"", ",", "\"\<\\\\), \\\\(\>\""}], "}"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Plain"}], " ", "string"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"elements", "=", "formula"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Useful", " ", "local", " ", 
       "variables", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"patternX", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"_", "?", "UpperCaseQ"}], "~~", 
         RowBox[{"_", "?", "LowerCaseQ"}]}], ",", 
        RowBox[{"_", "?", "UpperCaseQ"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"groupX", "[", "S_", "]"}], ":=", 
      RowBox[{
       RowBox[{"StringCases", "[", 
        RowBox[{"S", ",", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", "patternX"}], "~~", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"n1", ":", 
                RowBox[{"DigitCharacter", ".."}]}], "~~", "\"\<.\>\"", "~~", 
               RowBox[{"n2", ":", 
                RowBox[{"DigitCharacter", ".."}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "\t", "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"n1", "<>", "\"\<.\>\"", "<>", "n2"}], "]"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", "patternX"}], "~~", 
             RowBox[{"n", ":", 
              RowBox[{"DigitCharacter", ".."}]}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}]}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"n", "~~", "pm"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", "patternX"}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"n", "~~", "pm"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"x", ":", "patternX"}], "~~", 
             RowBox[{"n", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"ToExpression", "@", "n"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "\t", "}"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<\>\"", "\[Rule]", "\"\<1\>\""}], ",", 
         RowBox[{"Null", "\[Rule]", "1"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Extracting", " ", "symbols", " ", 
       "and", " ", "numbers", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Distribute", " ", "parenthesis", " ", "subscripts"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"elements", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"elements", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"\"\<(\>\"", "~~", "p__", "~~", "\"\<)\>\"", "~~", 
          RowBox[{"s", ":", 
           RowBox[{"DigitCharacter", ".."}]}]}], "\[IndentingNewLine]", 
         "\t\t", "\[RuleDelayed]", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"ToString", "/@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"MapAt", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "*", 
                RowBox[{"ToExpression", "[", "s", "]"}]}], "&"}], ",", 
              RowBox[{"groupX", "@", "p"}], ",", 
              RowBox[{"{", 
               RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "\t", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Group", " ", "elements", " ", "and", " ", "corresponding", " ", 
       "subscripts"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"elements", "=", 
      RowBox[{"groupX", "@", "elements"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"elements", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetElements", "::", "formula"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"elements", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"temp", ",", "\"\<InterpretElement\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"DeleteDuplicates", "@", "temp"}]}], ";", "\[IndentingNewLine]",
      "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"Keys", "@", "$PeriodicTable"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetElements", "::", "invalid"}], ",", 
          RowBox[{"ToString", "@", "temp"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Merge", " ", "equal", " ", "elements"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DuplicateFreeQ", "[", 
         RowBox[{"First", "/@", "elements"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"elements", "=", 
         RowBox[{"MapAt", "[", 
          RowBox[{"ToExpression", ",", "elements", ",", 
           RowBox[{"{", 
            RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"elements", "=", 
         RowBox[{"GatherBy", "[", 
          RowBox[{"elements", ",", "First"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"elements", "=", 
         RowBox[{"elements", "/.", 
          RowBox[{
           RowBox[{"x_", "/;", 
            RowBox[{
             RowBox[{"Depth", "[", "x", "]"}], "===", "3"}]}], 
           "\[RuleDelayed]", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Total", "@", 
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Checking", " ", "for", " ", "ions"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elements", "=", 
      RowBox[{"elements", "/.", 
       RowBox[{
        RowBox[{"x_List", "/;", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
          RowBox[{"StringContainsQ", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "]"}]}]}], 
        "\[RuleDelayed]", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"StringJoin", "@@", "x"}], ",", "\"\<1\>\""}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Remove", " ", "charge", " ", "of", " ", "ions"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IgnoreIonCharge\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"elements", "=", 
        RowBox[{"MapAt", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StringDelete", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
              "}"}]}], "]"}], "&"}], ",", "\[IndentingNewLine]", "elements", 
          ",", 
          RowBox[{"{", 
           RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Confirm", " ", "that", " ", "tally", " ", "numbers", " ", "are", " ", 
       "expressions"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{"ToExpression", ",", "elements", ",", 
        RowBox[{"{", 
         RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Keep", " ", "tally", " ", "of", " ", "the", " ", "various", " ", 
        "atoms"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "tallyQ"}], ",", 
       RowBox[{"elements", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"First", "/@", "elements"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "elements"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.685292929314414*^9, 3.685292949551355*^9}, {
   3.685292980630427*^9, 3.685293093109366*^9}, {3.6852935686996202`*^9, 
   3.685293592607072*^9}, {3.685294304496677*^9, 3.685294312832938*^9}, {
   3.685294359159436*^9, 3.685294392591338*^9}, 3.685294452156907*^9, {
   3.7125585005216303`*^9, 3.712558599149044*^9}, {3.712558653688374*^9, 
   3.712558706404811*^9}, 3.712558740953339*^9, {3.7125590860901546`*^9, 
   3.712559142612122*^9}, {3.7125592016674137`*^9, 3.7125592063906593`*^9}, {
   3.712559401604739*^9, 3.71255953948845*^9}, {3.716825435019915*^9, 
   3.716825443192257*^9}, {3.716829256621364*^9, 3.716829678456518*^9}, {
   3.716829747406776*^9, 3.7168297497583103`*^9}, {3.716829817072053*^9, 
   3.716829872267585*^9}, {3.7168702686821833`*^9, 3.716870278953738*^9}, {
   3.719168963772888*^9, 3.7191689675316343`*^9}, {3.7191690693051367`*^9, 
   3.71916911050533*^9}, {3.719169157745376*^9, 3.7191691630471363`*^9}, {
   3.719169213549266*^9, 3.719169225037245*^9}, {3.7191694293210917`*^9, 
   3.719169484711543*^9}, {3.719169568221366*^9, 3.71916957778019*^9}, {
   3.7191703668084784`*^9, 3.7191704010195827`*^9}, {3.719170432031032*^9, 
   3.719170480309218*^9}, {3.7191707916063957`*^9, 3.719170851325012*^9}, {
   3.719170886467657*^9, 3.719170977504312*^9}, {3.719171068463624*^9, 
   3.7191711057322683`*^9}, {3.719171210442648*^9, 3.719171214817477*^9}, {
   3.7191717353185587`*^9, 3.71917173550896*^9}, {3.719171831764216*^9, 
   3.719171832127336*^9}, {3.719171976553056*^9, 3.719171978487883*^9}, {
   3.719172633208712*^9, 3.7191726664464083`*^9}, {3.719173370807959*^9, 
   3.719173382142346*^9}, {3.71917342099035*^9, 3.719173584729095*^9}, {
   3.7191736766562643`*^9, 3.71917378886082*^9}, 3.719173877524808*^9, {
   3.719173941337644*^9, 3.7191739875119867`*^9}, 3.719174069918503*^9, {
   3.7191742150360928`*^9, 3.719174247370132*^9}, {3.719174503030614*^9, 
   3.7191745794530478`*^9}, {3.719174865447359*^9, 3.719174867454191*^9}, {
   3.719174900223995*^9, 3.719174903453495*^9}, {3.719174946589995*^9, 
   3.7191749492283287`*^9}, {3.719174996797008*^9, 3.7191750201387253`*^9}, {
   3.719175669790955*^9, 3.7191757249355516`*^9}, {3.719176455672847*^9, 
   3.719176469255004*^9}, {3.719176846095621*^9, 3.719177110017375*^9}, 
   3.7272440207729063`*^9, {3.735026359560768*^9, 3.735026415725293*^9}, {
   3.735026452534255*^9, 3.7350264984462748`*^9}, {3.735026556379381*^9, 
   3.73502668032768*^9}, {3.735027182439661*^9, 3.735027257538212*^9}, {
   3.735027287691483*^9, 3.73502735715379*^9}, {3.735027390658354*^9, 
   3.735027451511298*^9}, {3.735027580296316*^9, 3.735027583171487*^9}, {
   3.735027614671505*^9, 3.73502765105129*^9}, {3.735027695863276*^9, 
   3.735027748161511*^9}, {3.7350278283459587`*^9, 3.735027830051031*^9}, {
   3.735027908613785*^9, 3.7350279090084343`*^9}, {3.7350279586886263`*^9, 
   3.735027997182349*^9}, {3.735028138640189*^9, 3.735028172319462*^9}, {
   3.7350283323634443`*^9, 3.7350284239931192`*^9}, {3.7350284765515842`*^9, 
   3.735028502245571*^9}, {3.735028532733877*^9, 3.7350285646801977`*^9}, {
   3.7350286139958363`*^9, 3.735028614225257*^9}, {3.737384802769537*^9, 
   3.73738485758283*^9}, {3.737384892058063*^9, 3.737384920149081*^9}, {
   3.737384968509556*^9, 3.737385024213161*^9}, {3.7373850962752028`*^9, 
   3.737385169697603*^9}, {3.737385206944845*^9, 3.737385234562249*^9}, {
   3.739210170513124*^9, 3.739210172239122*^9}, {3.7392102340995407`*^9, 
   3.7392102379176903`*^9}, {3.739210281988481*^9, 3.7392102932204247`*^9}, {
   3.7392104917399178`*^9, 3.739210492064567*^9}, {3.739210768332066*^9, 
   3.739210783338932*^9}, {3.73921083063846*^9, 3.7392108948330183`*^9}, {
   3.7392109736499968`*^9, 3.739211116047324*^9}, {3.7392111528303413`*^9, 
   3.739211209194542*^9}, {3.742020582664439*^9, 3.7420205872094193`*^9}, {
   3.742020622844721*^9, 3.742020679523018*^9}, {3.742021091478095*^9, 
   3.74202109197392*^9}, {3.74202121505618*^9, 3.742021236453971*^9}, {
   3.7420213185883703`*^9, 3.7420213578267717`*^9}, {3.7420213952475348`*^9, 
   3.742021407915893*^9}, {3.7420216306880617`*^9, 3.742021632527237*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[66]:=",ExpressionUUID->"28b70032-b1e9-43de-94be-f55bb0c806d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[67]:=",ExpressionUUID->"12821adb-dced-40b1-bb4d-a4072ddc8ae7"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetLatticeParameters", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 
   3.705030491163352*^9}},ExpressionUUID->"f78c9db7-e155-46bf-8ec2-\
22a1f9879d92"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[68]:=",ExpressionUUID->"b6d23b38-b752-41f9-b03a-784324ca588b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetLatticeParameters", "::", "input"}], "=", 
    "\"\<Invalid input.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GetLatticeParameters", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<RoundAnglesThreshold\>\"", "\[Rule]", "0.001"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6866553885251007`*^9, 3.686655392814109*^9}, {
  3.6866555184690027`*^9, 3.686655575776688*^9}, {3.705030508312458*^9, 
  3.7050305121232233`*^9}, {3.705030966176993*^9, 3.705030978938044*^9}, {
  3.705031761456892*^9, 3.705031763383602*^9}, {3.705032213071164*^9, 
  3.7050322539618597`*^9}, {3.713718151921575*^9, 3.713718152424184*^9}, {
  3.714924157900049*^9, 3.7149241583679953`*^9}, {3.737968499623808*^9, 
  3.7379684996892643`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"cbda1014-4302-493c-9867-3d3b5d7f8e6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[71]:=",ExpressionUUID->"f7d6f7e1-17c3-430c-80af-8f6422c1b7a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetLatticeParameters", "[", 
   RowBox[{"input_", ",", 
    RowBox[{"OptionsPattern", "@", "GetLatticeParameters"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
      "\[Gamma]", ",", "cell", ",", "\[IndentingNewLine]", "\[Delta]", ",", 
      "fr"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Crystal", " ", "entry", " ", "input"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\t", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"InputCheck", "[", 
         RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"cell", "=", 
         RowBox[{"QuantityMagnitude", "@", 
          RowBox[{"Values", "@", 
           RowBox[{"$CrystalData", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"input", ",", "\"\<LatticeParameters\>\""}], 
            "]"}]}]}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Metric", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"MatrixQ", "[", "input", "]"}], "&&", 
        RowBox[{
         RowBox[{"Dimensions", "[", "input", "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}]}]}], ",", "\t", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
         RowBox[{"Sqrt", "@", 
          RowBox[{"Diagonal", "@", "input"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"\[Alpha]", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{
            RowBox[{"input", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"b", "*", "c"}], ")"}]}], "]"}], "/", "Degree"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\[Beta]", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{
            RowBox[{"input", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"a", "*", "c"}], ")"}]}], "]"}], "/", "Degree"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\[Gamma]", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{
            RowBox[{"input", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"a", "*", "b"}], ")"}]}], "]"}], "/", "Degree"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"cell", "=", 
         RowBox[{"{", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", ",", 
           "\[Gamma]"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\t", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetLatticeParameters", "::", "input"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Round", " ", "angles"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"OptionValue", "[", "\"\<RoundAnglesThreshold\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"fr", "=", 
         RowBox[{"FractionalPart", "@", 
          RowBox[{"cell", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fr", ">", "0.5"}], ",", 
          RowBox[{"fr", "=", 
           RowBox[{"1", "-", "fr"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fr", "\[LessEqual]", "\[Delta]"}], ",", 
          RowBox[{
           RowBox[{"cell", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"Round", "@", 
            RowBox[{"cell", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4", ",", "6"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Use", " ", "units"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"i", "\[LessEqual]", "3"}], ",", 
           RowBox[{
            RowBox[{"cell", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Quantity", "[", 
             RowBox[{
              RowBox[{"cell", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<angstrom\>\""}], 
             "]"}]}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"i", "\[GreaterEqual]", "4"}], ",", 
           RowBox[{
            RowBox[{"cell", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Quantity", "[", 
             RowBox[{
              RowBox[{"cell", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<degree\>\""}], 
             "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "cell"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, 3.705030516132319*^9, {
   3.705030854490851*^9, 3.705030855594645*^9}, {3.705030886826001*^9, 
   3.705030897163478*^9}, {3.705031098702557*^9, 3.705031114340454*^9}, {
   3.705031170526485*^9, 3.7050311927839212`*^9}, {3.705031531018292*^9, 
   3.705031543220398*^9}, {3.70503165376649*^9, 3.705031676591818*^9}, {
   3.705031712520639*^9, 3.705031713810836*^9}, {3.7050318153266163`*^9, 
   3.705031930883963*^9}, {3.705031983369022*^9, 3.705032057059581*^9}, {
   3.7137185004843197`*^9, 3.7137185357381477`*^9}, 3.714924306008999*^9, {
   3.714924684167651*^9, 3.714924833922771*^9}, {3.71492487802812*^9, 
   3.7149249497280197`*^9}, {3.714924983688899*^9, 3.7149250098399477`*^9}, {
   3.7149250443684483`*^9, 3.714925097110804*^9}, {3.714925261826474*^9, 
   3.714925271569159*^9}, 3.7177409207486897`*^9, {3.730145347590613*^9, 
   3.730145350061535*^9}, {3.737968499769812*^9, 3.737968499911303*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[72]:=",ExpressionUUID->"bc2e2d62-702c-4e2f-a45f-238851ebc9d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[73]:=",ExpressionUUID->"5496b488-1f6f-498d-9f42-312726fde4cc"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetLaueClass", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.684667958524547*^9, 3.684667960120316*^9}, {3.6846686457735453`*^9, 
   3.6846686463667*^9}, 
   3.68570063082576*^9},ExpressionUUID->"77e6bc4b-1ed1-48b5-bf9d-\
0c47588d6ca0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[74]:=",ExpressionUUID->"17c25943-c463-4d61-9044-bf2897b6b034"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetLaueClass", "::", "missing"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.737968520211151*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"8535efb6-2c8f-460b-ada9-bf4f08f3159d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[76]:=",ExpressionUUID->"3a19538f-bbf9-4135-9db7-05899e0649d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetLaueClass", "[", "symbol_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", ",", "extract"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "$CrystalData", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"$CrystalData", "[", "symbol", "]"}], "[", 
       "\"\<SpaceGroup\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "g"}], ",", 
       RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", 
        RowBox[{
         RowBox[{"-", "3"}], "m"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "symbol", "\[Equal]", 
         "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)1m\>\""}], "||", 
        RowBox[{"symbol", "\[Equal]", "\"\<-31m\>\""}]}], ",", 
       RowBox[{
       "Return", "[", "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)1m\>\"", "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "symbol", "\[Equal]", 
         "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)m:r\>\""}], "||", 
        RowBox[{"symbol", "\[Equal]", "\"\<-3m:r\>\""}]}], ",", 
       RowBox[{
       "Return", "[", "\"\<\!\(\*OverscriptBox[\(3\), \(_\)]\)m:r\>\"", "]"}],
        ",", "\[IndentingNewLine]", "True", ",", "Null"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Point", " ", "group", " ", "or", " ", "space", " ", "group"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"$GroupSymbolRedirect", "[", "symbol", "]"}], "[", 
       "\"\<LaueClass\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "g"}], ",", 
       RowBox[{"Return", "@", "g"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Point", " ", "group", " ", "or", " ", "space", " ", "group", " ", 
       RowBox[{"(", 
        RowBox[{"alternative", " ", "setting"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"extract", "=", 
      RowBox[{
       RowBox[{"FullForm", "[", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Extract", "[", "\[IndentingNewLine]", 
          RowBox[{
          "$GroupSymbolRedirect", ",", "\[IndentingNewLine]", "symbol", ",", 
           "Inactivate"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"$GroupSymbolRedirect", "[", "extract", "]"}], "[", 
       "\"\<LaueClass\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"No", " ", "match"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringQ", "@", "g"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetLaueClass", "::", "missing"}], ",", "symbol"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "g"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"End", " ", 
       RowBox[{"(", 
        RowBox[{"for", " ", "use", " ", "with", " ", "$CrystalData"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"GetLaueClass", "[", "g", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, {
   3.685079528520215*^9, 3.6850795700522537`*^9}, {3.685079609824223*^9, 
   3.68507976209107*^9}, {3.6850801175697823`*^9, 3.685080136669197*^9}, {
   3.6850801705077353`*^9, 3.685080193540316*^9}, {3.6850802428064957`*^9, 
   3.685080244336314*^9}, {3.68508029169517*^9, 3.6850803659439173`*^9}, {
   3.685080400088478*^9, 3.685080401518166*^9}, {3.6850805073455763`*^9, 
   3.685080567126417*^9}, {3.6852486796520853`*^9, 3.6852486864393597`*^9}, {
   3.685248720001297*^9, 3.685248724174099*^9}, 3.6852487544120092`*^9, {
   3.685248800204956*^9, 3.685248803000963*^9}, {3.685249136526149*^9, 
   3.685249179200903*^9}, {3.685249683180578*^9, 3.6852497229340143`*^9}, {
   3.685249765477912*^9, 3.685249806794134*^9}, {3.685249936405735*^9, 
   3.685250039598538*^9}, {3.685250203904066*^9, 3.685250237194146*^9}, {
   3.685250268520568*^9, 3.685250278543681*^9}, {3.685250310995026*^9, 
   3.685250473891493*^9}, {3.685250515497068*^9, 3.685250550260337*^9}, {
   3.685250596138503*^9, 3.685250597311151*^9}, {3.685250650170144*^9, 
   3.685250701320359*^9}, {3.685678714163109*^9, 3.685678724227903*^9}, {
   3.685680631552026*^9, 3.685680726344557*^9}, {3.685680777866826*^9, 
   3.685680813584144*^9}, {3.685700637133027*^9, 3.685700641664912*^9}, {
   3.7177409045951014`*^9, 3.717740920784957*^9}, {3.730145930529347*^9, 
   3.730145931248543*^9}, {3.730146045655348*^9, 3.730146046973926*^9}, {
   3.737968520312047*^9, 3.737968520667469*^9}, {3.7438654556085653`*^9, 
   3.743865455699587*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[77]:=",ExpressionUUID->"be3f562a-7b1a-41b9-a1e7-359d2ead6a0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[78]:=",ExpressionUUID->"7fd77fd3-1c05-430c-9432-ff3e25a7d2e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetScatteringCrossSections", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, 3.717739586397138*^9, {
   3.735291133581037*^9, 
   3.735291138159142*^9}},ExpressionUUID->"c871ff2b-1f77-404b-826e-\
db627ebc15cd"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[79]:=",ExpressionUUID->"f931cdc0-19a7-4d01-908e-9a5a838c2a88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringCrossSections", "::", "\"\<invsrc\>\""}], "=", 
   "\"\<Invalid source.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringCrossSections", "::", "\"\<invelt\>\""}], "=", 
   "\"\<Invalid element.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringCrossSections", "::", "invproc"}], "=", 
   "\"\<The scattering process type \[LeftGuillemet]`1`\[RightGuillemet] is \
not recognised.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetScatteringCrossSections", "::", "\"\<invwlrange\>\""}], "=", 
    "\"\<The wavelength, `1` \[CapitalARing], must be within (0.001 \
\[LessEqual] \[Lambda] \[LessEqual] 3.000) \[CapitalARing] when using cross \
sections.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GetScatteringCrossSections"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<PhysicalProcess\>\"", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Source\>\"", "\[Rule]", "\"\<xraylib\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719174557698147*^9, 3.719174575089182*^9}, 
   3.7272440207601767`*^9, {3.735028184066166*^9, 3.735028195898958*^9}, {
   3.735028314418393*^9, 3.7350283221953506`*^9}, {3.735291141295652*^9, 
   3.735291184066963*^9}, {3.735291225379405*^9, 3.735291229257778*^9}, {
   3.735291632802617*^9, 3.7352916596886263`*^9}, {3.735291714655457*^9, 
   3.735291726262683*^9}, {3.735291774887849*^9, 3.735291810741148*^9}, {
   3.7352918492397757`*^9, 3.735291853499892*^9}, {3.7352946419742203`*^9, 
   3.735294652334242*^9}, {3.73529518760988*^9, 3.7352951926106787`*^9}, {
   3.735295565794612*^9, 3.73529556679265*^9}, {3.735295724749537*^9, 
   3.735295724893229*^9}, 3.735306079956148*^9, {3.735306390011011*^9, 
   3.735306399498732*^9}, {3.7438658806326017`*^9, 3.743865880812434*^9}, 
   3.744172272698161*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"cab70876-da94-465f-9283-4b527865ee65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[85]:=",ExpressionUUID->"f3ee08b9-ccc1-41eb-adb7-585522c84430"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetScatteringCrossSections", "[", 
   RowBox[{"input_", ",", "\[IndentingNewLine]", 
    RowBox[{"wavelength", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{"OptionsPattern", "@", "GetScatteringCrossSections"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"src", ",", "unitsQ", ",", "elements", ",", 
      RowBox[{"\[Lambda]", "=", "wavelength"}], ",", 
      RowBox[{"pp", "=", 
       RowBox[{"OptionValue", "[", "\"\<PhysicalProcess\>\"", "]"}]}], ",", 
      "column", ",", "\[IndentingNewLine]", "setpos", ",", "\[Sigma]", ",", 
      "file", ",", "read", ",", "\[Sigma]i"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checks", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Chemical", " ", "element", 
      RowBox[{"(", "s", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"elements", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"GetElements", "[", "input", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Data", " ", "source"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"src", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<CrossSections\>\"", ",", 
         RowBox[{"OptionValue", "[", "\"\<Source\>\"", "]"}]}], "}"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "@", "src"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetScatteringCrossSections", "::", "\"\<invsrc\>\""}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"unitsQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wavelength", " ", "and", " ", "its", " ", "range"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
         "0.001", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", "3.000"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetScatteringCrossSections", "::", "invwlrange"}], ",", 
          RowBox[{"ToString", "@", "\[Lambda]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "\"\<\>\"", ",", "wavelength", ",", "\"\<ProcessWavelength\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Column", " ", "to", " ", "read", " ", "from", " ", 
       RowBox[{"(", 
        RowBox[{"cross", " ", "section", " ", "type"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"column", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pp", "===", "\"\<\>\""}], ",", "5", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<Photoelectric\>\"", ",", "\"\<Photoionisation\>\""}], 
           "}"}], ",", "pp"}], "]"}], ",", "2", ",", "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Coherent\>\"", ",", "\"\<Rayleigh\>\"", ",", 
            "\"\<Thompson\>\"", ",", "\[IndentingNewLine]", 
            "\"\<Classical\>\"", ",", "\"\<Elastic\>\""}], "}"}], ",", "pp"}],
          "]"}], ",", "3", ",", "\[IndentingNewLine]", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Incoherent\>\"", ",", "\"\<Compton\>\"", ",", 
            "\"\<Inelastic\>\""}], "\[IndentingNewLine]", "}"}], ",", "pp"}], 
         "]"}], ",", "4", ",", "\[IndentingNewLine]", 
        RowBox[{"pp", "===", "\"\<Total\>\""}], ",", "5", ",", 
        "\[IndentingNewLine]", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"GetScatteringCrossSections", "::", "invproc"}], ",", 
           "pp"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Read", " ", "from", " ", "file", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Stream", " ", "position", " ", "in", " ", "dat", " ", "files"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"setpos", "=", 
      RowBox[{"66", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"1000", "*", "\[Lambda]"}], "]"}], "-", "1"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Extract", " ", "cross", " ", "sections"}], ";", " ", 
       RowBox[{"\[Sigma]", " ", "=", " ", 
        RowBox[{"\[Sigma]", 
         RowBox[{"(", 
          RowBox[{"element", ",", " ", "wavelength"}], ")"}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"file", "=", 
         RowBox[{"OpenRead", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"src", ",", 
             RowBox[{"X", "<>", "\"\<.dat\>\""}]}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetStreamPosition", "[", 
         RowBox[{"file", ",", "setpos"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"read", "=", 
         RowBox[{"Read", "[", 
          RowBox[{"file", ",", "Record"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Sigma]i", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", "read", "]"}], "[", 
             RowBox[{"[", "column", "]"}], "]"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{
             RowBox[{"m__", "~~", "\"\<E\>\"", "~~", 
              RowBox[{"s", ":", 
               RowBox[{"{", 
                RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
              RowBox[{"e", ":", 
               RowBox[{"DigitCharacter", ".."}]}]}], "\[RuleDelayed]", 
             "\[IndentingNewLine]", 
             RowBox[{
             "m", "<>", "\"\<*10^(\>\"", "<>", "s", "<>", "e", "<>", 
              "\"\<)\>\""}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"unitsQ", ",", 
          RowBox[{"\[Sigma]i", "=", 
           RowBox[{"Quantity", "[", 
            RowBox[{"\[Sigma]i", ",", "\"\<Barns\>\""}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Close", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"\[Sigma]", ",", 
          RowBox[{"X", "\[Rule]", "\[Sigma]i"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"X", ",", "elements"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Output", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Association", "@", "\[Sigma]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.685292929314414*^9, 3.685292949551355*^9}, {
   3.685292980630427*^9, 3.685293093109366*^9}, {3.6852935686996202`*^9, 
   3.685293592607072*^9}, {3.685294304496677*^9, 3.685294312832938*^9}, {
   3.685294359159436*^9, 3.685294392591338*^9}, 3.685294452156907*^9, {
   3.7125585005216303`*^9, 3.712558599149044*^9}, {3.712558653688374*^9, 
   3.712558706404811*^9}, 3.712558740953339*^9, {3.7125590860901546`*^9, 
   3.712559142612122*^9}, {3.7125592016674137`*^9, 3.7125592063906593`*^9}, {
   3.712559401604739*^9, 3.71255953948845*^9}, {3.716825435019915*^9, 
   3.716825443192257*^9}, {3.716829256621364*^9, 3.716829678456518*^9}, {
   3.716829747406776*^9, 3.7168297497583103`*^9}, {3.716829817072053*^9, 
   3.716829872267585*^9}, {3.7168702686821833`*^9, 3.716870278953738*^9}, {
   3.719168963772888*^9, 3.7191689675316343`*^9}, {3.7191690693051367`*^9, 
   3.71916911050533*^9}, {3.719169157745376*^9, 3.7191691630471363`*^9}, {
   3.719169213549266*^9, 3.719169225037245*^9}, {3.7191694293210917`*^9, 
   3.719169484711543*^9}, {3.719169568221366*^9, 3.71916957778019*^9}, {
   3.7191703668084784`*^9, 3.7191704010195827`*^9}, {3.719170432031032*^9, 
   3.719170480309218*^9}, {3.7191707916063957`*^9, 3.719170851325012*^9}, {
   3.719170886467657*^9, 3.719170977504312*^9}, {3.719171068463624*^9, 
   3.7191711057322683`*^9}, {3.719171210442648*^9, 3.719171214817477*^9}, {
   3.7191717353185587`*^9, 3.71917173550896*^9}, {3.719171831764216*^9, 
   3.719171832127336*^9}, {3.719171976553056*^9, 3.719171978487883*^9}, {
   3.719172633208712*^9, 3.7191726664464083`*^9}, {3.719173370807959*^9, 
   3.719173382142346*^9}, {3.71917342099035*^9, 3.719173584729095*^9}, {
   3.7191736766562643`*^9, 3.71917378886082*^9}, 3.719173877524808*^9, {
   3.719173941337644*^9, 3.7191739875119867`*^9}, 3.719174069918503*^9, {
   3.7191742150360928`*^9, 3.719174247370132*^9}, {3.719174503030614*^9, 
   3.7191745794530478`*^9}, {3.719174865447359*^9, 3.719174867454191*^9}, {
   3.719174900223995*^9, 3.719174903453495*^9}, {3.719174946589995*^9, 
   3.7191749492283287`*^9}, {3.719174996797008*^9, 3.7191750201387253`*^9}, {
   3.719175669790955*^9, 3.7191757249355516`*^9}, {3.719176455672847*^9, 
   3.719176469255004*^9}, {3.719176846095621*^9, 3.719177110017375*^9}, 
   3.7272440207729063`*^9, {3.735026359560768*^9, 3.735026415725293*^9}, {
   3.735026452534255*^9, 3.7350264984462748`*^9}, {3.735026556379381*^9, 
   3.73502668032768*^9}, {3.735027182439661*^9, 3.735027257538212*^9}, {
   3.735027287691483*^9, 3.73502735715379*^9}, {3.735027390658354*^9, 
   3.735027451511298*^9}, {3.735027580296316*^9, 3.735027583171487*^9}, {
   3.735027614671505*^9, 3.73502765105129*^9}, {3.735027695863276*^9, 
   3.735027748161511*^9}, {3.7350278283459587`*^9, 3.735027830051031*^9}, {
   3.735027908613785*^9, 3.7350279090084343`*^9}, {3.7350279586886263`*^9, 
   3.735027997182349*^9}, {3.735028138640189*^9, 3.735028172319462*^9}, {
   3.7350283323634443`*^9, 3.7350284239931192`*^9}, {3.7350284765515842`*^9, 
   3.735028502245571*^9}, {3.735028532733877*^9, 3.7350285646801977`*^9}, {
   3.7350286139958363`*^9, 3.735028614225257*^9}, {3.735291150800659*^9, 
   3.735291169475254*^9}, {3.7352912368180227`*^9, 3.735291276457193*^9}, {
   3.7352913496176023`*^9, 3.735291377512362*^9}, {3.735291591653658*^9, 
   3.735291622523106*^9}, 3.735291701489131*^9, {3.735291733794158*^9, 
   3.735291771207726*^9}, {3.7352918222169437`*^9, 3.7352918270087843`*^9}, {
   3.73529186003209*^9, 3.7352918997085457`*^9}, {3.735291981203569*^9, 
   3.735291995311404*^9}, {3.7352920944713697`*^9, 3.735292333783617*^9}, {
   3.7352941774627867`*^9, 3.735294198529961*^9}, {3.735294360872147*^9, 
   3.735294364486846*^9}, {3.735294395526725*^9, 3.735294431941141*^9}, {
   3.7352944887078648`*^9, 3.735294628272335*^9}, {3.735294660521525*^9, 
   3.73529471570223*^9}, {3.735294793471644*^9, 3.735294809995585*^9}, {
   3.735294879211343*^9, 3.735295003526989*^9}, {3.735295180916245*^9, 
   3.735295183786879*^9}, {3.73529522295564*^9, 3.735295272817762*^9}, {
   3.73529531596251*^9, 3.7352953605696497`*^9}, {3.735295452357264*^9, 
   3.735295486173215*^9}, {3.735295532692325*^9, 3.7352955332273684`*^9}, {
   3.735295645691324*^9, 3.735295710297604*^9}, {3.7352997948361263`*^9, 
   3.7352998463232727`*^9}, {3.735305592745775*^9, 3.7353057118758707`*^9}, {
   3.73530577839625*^9, 3.735305809425119*^9}, 3.7353059146736517`*^9, {
   3.735306278649869*^9, 3.735306367750526*^9}, {3.735306415334628*^9, 
   3.735306434406185*^9}, 3.735306484402957*^9, 3.743865412276691*^9, {
   3.743865880884262*^9, 3.743865881015009*^9}, {3.743992547175686*^9, 
   3.7439925517869883`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[86]:=",ExpressionUUID->"8bf26ab2-f7a7-4d6b-9be8-2b9a5554b370"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[87]:=",ExpressionUUID->"bc38bf82-922a-451d-8701-d0a59018d4f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetSymmetryData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9, {3.713180935870894*^9, 3.713180938209676*^9}, 
   3.717767492093237*^9},ExpressionUUID->"c127255c-ce86-4714-8f8d-\
97a5b08a7874"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[88]:=",ExpressionUUID->"390a33df-ad51-4741-abdc-e3a25892f15c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetSymmetryData", "::", "invalid"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised \
label.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSymmetryData", "::", "incompatible"}], "=", 
    "\"\<Incompatible group type and label.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GetSymmetryData"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<UnambiguousSymbol\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<UseMainEntry\>\"", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7131810413608723`*^9, 3.713181077064309*^9}, {
  3.713181132188043*^9, 3.7131811983538933`*^9}, {3.713255047767827*^9, 
  3.713255056779663*^9}, {3.713255506659046*^9, 3.713255517296316*^9}, {
  3.713255553288314*^9, 3.7132555744919357`*^9}, {3.7136030670066347`*^9, 
  3.7136030675094767`*^9}, {3.7143685834948673`*^9, 3.714368593787736*^9}, {
  3.71785181409776*^9, 3.717851843742972*^9}, {3.7379685452616777`*^9, 
  3.737968545394628*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"31871dd5-2faa-4c55-aee5-fdc95b5d5f02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[92]:=",ExpressionUUID->"7d66c936-8730-487c-9230-af4faed95128"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetSymmetryData", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"label_String:", "\"\<Lookup\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "GetSymmetryData"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "group", ",", "validLabels", ",", "type", ",", "data", ",", "dataMain", 
      ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Input", " ", "check", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Extract", " ", "point"}], "-", " ", 
      RowBox[{"or", " ", "space", " ", "group", " ", 
       RowBox[{"(", 
        RowBox[{"also", " ", "check", " ", "$CrystalData"}], ")"}]}]}], " ", 
     "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"group", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"input", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "label"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"validLabels", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<Lookup\>\"", ",", "\[IndentingNewLine]", "\t", "\"\<Symbol\>\"", 
        ",", "\"\<HermannMauguinFull\>\"", ",", "\"\<HermannMauguinShort\>\"",
         ",", "\[IndentingNewLine]", "\t", "\"\<HallString\>\"", ",", 
        "\[IndentingNewLine]", "\t", "\"\<PointGroupNumber\>\"", ",", 
        "\"\<SpaceGroupNumber\>\"", ",", "\[IndentingNewLine]", "\t", 
        "\"\<LaueClass\>\"", ",", "\"\<CrystalSystem\>\"", ",", 
        "\"\<Centring\>\"", ",", "\[IndentingNewLine]", "\t", 
        "\"\<MainEntryQ\>\"", ",", "\"\<GroupType\>\"", ",", 
        "\[IndentingNewLine]", "\t", "\"\<Setting\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"validLabels", ",", "label"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetSymmetryData", "::", "invalid"}], ",", "label"}], "]"}],
         ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"data", "=", 
      RowBox[{"$GroupSymbolRedirect", "@", "group"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "whether", " ", "point"}], "-", " ", 
       RowBox[{"or", " ", "space", " ", "group"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"$PointGroups", ",", "data", ",", "Infinity"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"type", "=", "\"\<PointGroup\>\""}], ",", 
       RowBox[{"type", "=", "\"\<SpaceGroup\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "validity", " ", "of", " ", "certain", " ", "labels"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"type", "===", "\"\<PointGroup\>\""}], "&&", 
          RowBox[{"label", "===", "\"\<SpaceGroupNumber\>\""}]}], ")"}], "||",
         "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"type", "===", "\"\<SpaceGroup\>\""}], "&&", 
          RowBox[{"label", "===", "\"\<PointGroupNumber\>\""}]}], ")"}]}], 
       ",", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"GetSymmetryData", "::", "incompatible"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Return", " ", "group", " ", 
       RowBox[{"type", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "===", "\"\<GroupType\>\""}], ",", 
       RowBox[{"Return", "@", "type"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Group", " ", "designation"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Space", " ", "gorups"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\t\t", 
      RowBox[{
       RowBox[{"type", "===", "\"\<SpaceGroup\>\""}], ",", "\t", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"group", "=", 
        RowBox[{"data", "[", 
         RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Point", " ", "gorups"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"type", "===", "\"\<PointGroup\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"group", "===", 
        RowBox[{"data", "[", 
         RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", 
       RowBox[{"centring", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "\[Equal]", "\"\<Centring\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"type", "\[Equal]", "\"\<PointGroup\>\""}], ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"GetSymmetryData", "::", "incompatible"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t\t", 
        RowBox[{"Return", "@", 
         RowBox[{"StringTake", "[", 
          RowBox[{"group", ",", "1"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Ascertain", " ", "main", " ", "entry"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Space", " ", "gorups"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\t", 
      RowBox[{
       RowBox[{"type", "\[Equal]", "\"\<SpaceGroup\>\""}], ",", "\t", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"$SpaceGroups", ",", "group"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"dataMain", "=", 
         RowBox[{"$SpaceGroups", "[", 
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Point", " ", "gorups"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"type", "\[Equal]", "\"\<PointGroup\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"$PointGroups", ",", "data"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"dataMain", "=", 
         RowBox[{"$PointGroups", "[", 
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Use", " ", "main", " ", "entry", " ", "corresponding", " ", "to", " ",
         "input"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<UseMainEntry\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"data", "=", "dataMain"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Executing", " ", "commands", " ", "*", 
       
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"A", ".", " ", "Return"}], " ", "entry", " ", "as", " ", "is", 
       " ", 
       RowBox[{"(", "default", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "===", "\"\<Lookup\>\""}], ",", 
       RowBox[{"Return", "@", "data"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"C", ".", " ", "Check"}], " ", "whether", " ", "input", " ", 
       "is", " ", "a", " ", "main", " ", "entry"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"label", "===", "\"\<MainEntryQ\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Return", "@", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"data", ",", 
          RowBox[{"type", "<>", "\"\<Number\>\""}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Alternative", ":", " ", 
        RowBox[{"TrueQ", "[", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"First", "@", "tempPos"}]}], "\[LessEqual]", "3"}], 
         "]"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"D", ".", " ", "Symbol"}], " ", "and", " ", "name", " ", 
       "attributes"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
          "\"\<Symbol\>\"", ",", "\"\<HermannMauguinFull\>\"", ",", 
           "\[IndentingNewLine]", "\t", "\"\<HermannMauguinShort\>\"", ",", 
           "\"\<HallString\>\""}], "}"}], ",", "label"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Optional", ":", " ", 
         RowBox[{"Let", " ", "output", " ", "be", " ", "unambiguous"}]}], " ",
         "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<UnambiguousSymbol\>\"", "]"}], "&&", 
          RowBox[{"label", "===", "\"\<Symbol\>\""}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"data", "[", 
            RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Return", "@", 
           RowBox[{"ToStandardSetting", "@", "temp"}]}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Return", " ", "formatted", " ", "anyway"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Return", "@", 
          RowBox[{"data", "[", 
           RowBox[{"\"\<Name\>\"", ",", "label"}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"E", ".", " ", "Other"}], " ", "attributes"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
          "\"\<PointGroupNumber\>\"", ",", "\"\<SpaceGroupNumber\>\"", ",", 
           "\[IndentingNewLine]", "\t", "\"\<LaueClass\>\"", ",", 
           "\"\<CrystalSystem\>\"", ",", "\"\<Setting\>\""}], "}"}], ",", 
         "label"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Return", "@", 
        RowBox[{"dataMain", "[", "label", "]"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, 3.685686496167932*^9, {3.6856944477863503`*^9, 
   3.68569446921675*^9}, {3.685694605238812*^9, 3.6856946062341757`*^9}, {
   3.685695893282233*^9, 3.685695896451762*^9}, {3.6856960214137506`*^9, 
   3.6856960251722317`*^9}, {3.687521359980748*^9, 3.687521435237295*^9}, {
   3.6875214687991743`*^9, 3.687521494623404*^9}, {3.6876768933160543`*^9, 
   3.687676910356525*^9}, {3.712650700261273*^9, 3.7126507027975063`*^9}, {
   3.7126508246994467`*^9, 3.7126508373862047`*^9}, {3.712650880057147*^9, 
   3.71265091066479*^9}, {3.712650944551971*^9, 3.712650951383466*^9}, {
   3.712651061181072*^9, 3.7126510654943533`*^9}, {3.71265113385168*^9, 
   3.712651134019478*^9}, {3.7126512882721786`*^9, 3.712651310583632*^9}, {
   3.712651420262867*^9, 3.712651422476676*^9}, {3.7131809448179398`*^9, 
   3.7131810356054564`*^9}, {3.713181086907085*^9, 3.713181107379854*^9}, {
   3.713181159084453*^9, 3.713181161701188*^9}, {3.713181213099559*^9, 
   3.713181282581812*^9}, {3.713181395925655*^9, 3.71318151312195*^9}, {
   3.7131815453258333`*^9, 3.713181580107853*^9}, {3.713251827327198*^9, 
   3.7132518702424192`*^9}, {3.713251944205166*^9, 3.713251965880468*^9}, 
   3.713253926836597*^9, {3.713254030079486*^9, 3.713254056001268*^9}, {
   3.713254601042029*^9, 3.713254606903442*^9}, {3.713255033399905*^9, 
   3.7132550452582607`*^9}, {3.713255173715601*^9, 3.713255178277837*^9}, {
   3.713255269047741*^9, 3.713255296701899*^9}, {3.7132554233367357`*^9, 
   3.713255456956232*^9}, {3.713255524341331*^9, 3.7132555370046387`*^9}, {
   3.713255630041746*^9, 3.713255754351347*^9}, {3.713255878197596*^9, 
   3.713255884948148*^9}, {3.713256297692585*^9, 3.7132563372575808`*^9}, {
   3.71325646948123*^9, 3.713256549123855*^9}, {3.713256593063978*^9, 
   3.713256606351722*^9}, {3.713256684861882*^9, 3.713256723112616*^9}, {
   3.7132567780590973`*^9, 3.713256778951418*^9}, {3.7132569482601748`*^9, 
   3.7132569919648247`*^9}, {3.7132570445646544`*^9, 3.713257318364801*^9}, {
   3.713257422816969*^9, 3.71325751243474*^9}, {3.713257781793808*^9, 
   3.713257789422627*^9}, {3.713257920552896*^9, 3.713257951558282*^9}, {
   3.713258002738751*^9, 3.713258023002263*^9}, {3.713258132808494*^9, 
   3.7132581573886557`*^9}, {3.713258280011162*^9, 3.713258306930822*^9}, {
   3.713258406157126*^9, 3.7132584079015827`*^9}, {3.713258483627623*^9, 
   3.713258501832863*^9}, {3.713258874176128*^9, 3.7132589621947727`*^9}, {
   3.713259006586093*^9, 3.71325902705698*^9}, {3.713259151029574*^9, 
   3.713259157722631*^9}, {3.713259295981337*^9, 3.713259305376504*^9}, {
   3.713259340305367*^9, 3.713259344080024*^9}, {3.7132593807762957`*^9, 
   3.713259395145294*^9}, {3.7132594289741507`*^9, 3.7132595096258097`*^9}, {
   3.713259724575598*^9, 3.7132597478771753`*^9}, {3.713259845692296*^9, 
   3.7132598664044523`*^9}, {3.713259951731834*^9, 3.713259957818882*^9}, {
   3.7132601222001143`*^9, 3.7132601792802553`*^9}, {3.71326028434074*^9, 
   3.7132602890460987`*^9}, {3.7132603605954638`*^9, 
   3.7132603734089727`*^9}, {3.7132604960901403`*^9, 3.713260498539002*^9}, {
   3.713260967143147*^9, 3.7132610324499474`*^9}, {3.713261075884906*^9, 
   3.713261088728733*^9}, {3.713261130434133*^9, 3.713261149036117*^9}, {
   3.7132611849243603`*^9, 3.7132611850904217`*^9}, {3.713261308398665*^9, 
   3.713261362591132*^9}, {3.7132614080968943`*^9, 3.713261418237978*^9}, {
   3.713261503519844*^9, 3.713261575487731*^9}, {3.713261606302849*^9, 
   3.713261608471685*^9}, {3.713261675536581*^9, 3.7132617730431957`*^9}, {
   3.7132628769562807`*^9, 3.713262902060273*^9}, {3.7132629411877193`*^9, 
   3.713262972458766*^9}, {3.713497308178856*^9, 3.713497311117917*^9}, {
   3.7134975717584867`*^9, 3.71349757189139*^9}, {3.7134976066938972`*^9, 
   3.7134976090462093`*^9}, {3.713588548318825*^9, 3.7135886446923227`*^9}, {
   3.71360308316119*^9, 3.7136031245029917`*^9}, {3.713604419569841*^9, 
   3.713604489759857*^9}, {3.713604571895423*^9, 3.713604587756934*^9}, {
   3.713604657988145*^9, 3.7136046586250687`*^9}, {3.714368625065659*^9, 
   3.714368677606341*^9}, {3.714368711557106*^9, 3.7143687468505793`*^9}, {
   3.7143688423652163`*^9, 3.714368893670738*^9}, {3.7143691901424303`*^9, 
   3.714369196393856*^9}, {3.7143692468223867`*^9, 3.714369320979141*^9}, {
   3.7143694816793833`*^9, 3.714369533987314*^9}, {3.714383361847651*^9, 
   3.71438336499629*^9}, {3.714457630929338*^9, 3.714457636104167*^9}, {
   3.716614813072504*^9, 3.716614815003395*^9}, {3.7166159509002*^9, 
   3.71661595367447*^9}, {3.7166160223818274`*^9, 3.716616068780747*^9}, {
   3.717740896766366*^9, 3.717740919790469*^9}, {3.717828717817094*^9, 
   3.717828728359373*^9}, 3.717829526691352*^9, {3.717829561834627*^9, 
   3.717829567842368*^9}, {3.717829711332901*^9, 3.7178297138923473`*^9}, {
   3.717829820148017*^9, 3.71782984300292*^9}, {3.717829873857195*^9, 
   3.71782999705438*^9}, {3.717830146665791*^9, 3.717830174018708*^9}, {
   3.717830961192195*^9, 3.717830998176252*^9}, {3.7178516904059267`*^9, 
   3.717851800821513*^9}, 3.7178518557153673`*^9, {3.7178520759837837`*^9, 
   3.717852103172366*^9}, {3.7178521808521338`*^9, 3.717852207898322*^9}, {
   3.7263414849809303`*^9, 3.7263415053987093`*^9}, {3.726341580490561*^9, 
   3.726341596874646*^9}, {3.72767546182131*^9, 3.727675588001774*^9}, {
   3.727677599027997*^9, 3.7276776008168907`*^9}, {3.727679791641213*^9, 
   3.7276797934416122`*^9}, 3.7276806018676662`*^9, {3.7276807387029448`*^9, 
   3.7276807612601*^9}, {3.728625292765798*^9, 3.728625298660047*^9}, {
   3.728625349898917*^9, 3.7286253534828987`*^9}, {3.728674363211102*^9, 
   3.7286744204279222`*^9}, {3.728674524191201*^9, 3.728674527109857*^9}, 
   3.728674560656323*^9, {3.737968545464172*^9, 3.737968545759601*^9}, {
   3.742813077399351*^9, 3.742813176814568*^9}, 3.743865455795642*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[93]:=",ExpressionUUID->"92ee4800-7c87-4826-b953-bb3f09427e7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[94]:=",ExpressionUUID->"77b18f17-5b94-4805-83ae-f1ff1a9c8daf"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetSymmetryOperations", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.684667958524547*^9, 3.684667960120316*^9}, {3.6846686457735453`*^9, 
   3.6846686463667*^9}, {3.684837480210894*^9, 3.684837483365593*^9}, 
   3.685074444164577*^9, 3.68508167559099*^9, 
   3.685700701541703*^9},ExpressionUUID->"5ddc0dc1-c4b6-4dbc-ade0-\
e663f1ba025c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[95]:=",ExpressionUUID->"83363ce0-6d39-46f5-b865-b48d814ddb15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetSymmetryOperations", "::", "missing"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GetSymmetryOperations"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<UseCentring\>\"", "\[Rule]", "False"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.734076134151382*^9, 3.7340761479096622`*^9}, {
  3.7379685760782547`*^9, 3.7379685761314907`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"481d459e-424a-421e-8555-cf5186cb0220"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->"In[98]:=",ExpressionUUID->"74ea4ddb-f9a8-4315-9418-7271beb51841"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetSymmetryOperations", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"OptionsPattern", "@", "GetSymmetryOperations"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"temp1", ",", "temp2", ",", "c"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp1", "=", 
      RowBox[{"$GroupSymbolRedirect", "@", 
       RowBox[{"InputCheck", "[", 
        RowBox[{"input", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Point", " ", "group"}], ",", " ", 
       RowBox[{"alternative", " ", "setting"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"temp1", ",", "\"\<MatrixOperations\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "@", 
        RowBox[{"temp1", "[", "\"\<MatrixOperations\>\"", "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"temp2", "=", 
      RowBox[{"temp1", "[", "\"\<SymmetryOperations\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Point", " ", "group", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"temp2", ",", "\"\<MatrixOperations\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "@", 
        RowBox[{"temp2", "[", "\"\<MatrixOperations\>\"", "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"*", 
        RowBox[{"-", " ", "Space"}], " ", "group", " ", "*", 
        RowBox[{"--", "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<UseCentring\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Apply", " ", "centring", " ", "vectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"StringTake", "[", 
          RowBox[{
           RowBox[{"temp1", "[", 
            RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinShort\>\""}], 
            "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"InputCheck", "[", 
          RowBox[{"c", ",", "\"\<GetCentringVectors\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"temp2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"temp2", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"temp2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                RowBox[{"c", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ",", "1"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "@", "c"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "temp2"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"temp2", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"No", " ", "centring", " ", "applied"}], " ", "*)"}], 
       "\[IndentingNewLine]", "temp2"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, 
   3.685074261443593*^9, {3.685080709320731*^9, 3.685080721804512*^9}, {
   3.685080764745716*^9, 3.6850808805559807`*^9}, {3.68508092962964*^9, 
   3.6850809341411123`*^9}, {3.685081014698917*^9, 3.6850811293896*^9}, {
   3.685081173070106*^9, 3.685081230337706*^9}, 3.685081300925284*^9, {
   3.685081341850636*^9, 3.685081358126698*^9}, {3.6850818355206947`*^9, 
   3.685081835699297*^9}, {3.685120724135499*^9, 3.685120754724948*^9}, {
   3.685120804629829*^9, 3.685120838795546*^9}, 3.685120900087543*^9, {
   3.685120954884305*^9, 3.6851209627033567`*^9}, {3.6851210281209993`*^9, 
   3.685121100111109*^9}, {3.685121131684601*^9, 3.685121175144966*^9}, {
   3.6851212087246017`*^9, 3.6851214248011837`*^9}, {3.685121460013051*^9, 
   3.685121487798689*^9}, {3.6851217072037277`*^9, 3.685121914718864*^9}, {
   3.6851220048170958`*^9, 3.685122005941601*^9}, {3.6851220491750507`*^9, 
   3.685122049974614*^9}, {3.685123695915769*^9, 3.685123701937531*^9}, {
   3.685123734493568*^9, 3.6851237403569517`*^9}, {3.6851241822831697`*^9, 
   3.685124185297907*^9}, {3.685125479207363*^9, 3.685125499047991*^9}, {
   3.6851263077107067`*^9, 3.68512644910214*^9}, {3.685126547021373*^9, 
   3.685126702387765*^9}, {3.685350851724683*^9, 3.685350853038637*^9}, {
   3.6856794352419147`*^9, 3.685679544384791*^9}, {3.685679692841302*^9, 
   3.6856797084427013`*^9}, {3.685679746023396*^9, 3.68567987927634*^9}, {
   3.685685092575449*^9, 3.6856851072626762`*^9}, {3.6856949536468353`*^9, 
   3.685694959496551*^9}, {3.685695023405781*^9, 3.685695049017387*^9}, {
   3.685699158166354*^9, 3.685699158825663*^9}, {3.685700703455983*^9, 
   3.6857007046212263`*^9}, {3.685702859526775*^9, 3.685702879954515*^9}, {
   3.717740903622292*^9, 3.717740919923519*^9}, {3.727505260288527*^9, 
   3.7275052607324343`*^9}, {3.72751425216635*^9, 3.7275142589027233`*^9}, {
   3.727514317450564*^9, 3.727514334992009*^9}, {3.727514377326157*^9, 
   3.727514442630692*^9}, {3.7275145339976892`*^9, 3.7275145367939262`*^9}, {
   3.727547164727139*^9, 3.7275471776929483`*^9}, {3.727677154651916*^9, 
   3.727677154917931*^9}, {3.734076226619268*^9, 3.734076285681925*^9}, {
   3.734076434114067*^9, 3.734076442966711*^9}, 3.734076483606106*^9, {
   3.7340808632864323`*^9, 3.734080953803822*^9}, {3.734080986930374*^9, 
   3.734081101183668*^9}, {3.7340820059912653`*^9, 3.734082109729949*^9}, {
   3.734082146450555*^9, 3.7340821634971313`*^9}, {3.734082297607605*^9, 
   3.734082329565339*^9}, 3.73408240619228*^9, 3.737968576183352*^9, 
   3.743865455889378*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[99]:=",ExpressionUUID->"f0e3dddf-2275-4826-9be1-95f1e3e9ed9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[100]:=",ExpressionUUID->"6da9c7a4-9942-4a95-9184-a84e6bb7e4f2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ImportCrystalData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, 
   3.717942205149007*^9, {3.7268980577164307`*^9, 
   3.726898057878839*^9}},ExpressionUUID->"6ec27fa3-3c2d-44a9-a1d9-\
d30f5165b2e7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[101]:=",ExpressionUUID->"35de6eea-b75e-4d58-86f9-c75a9c9e0fa8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "subdataInteger"}], "=", 
   "\"\<\\\"\!\(\*StyleBox[\"ExtractSubdata\", \"Program\"]\)\\\" must be a \
positive integer.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "subdataLength"}], "=", 
   "\"\<The \!\(\*StyleBox[\".\", \"Program\"]\)\!\(\*StyleBox[\"cif\", \
\"Program\"]\) file has a subdata length of `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "latticeParameters"}], "=", 
   "\"\<No lattice parameters were located, or they have an invalid \
form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "atomData"}], "=", 
   "\"\<No atom data was located.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "SG"}], "=", 
   "\"\<Could not determine space group. 'P1' will be used.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "cell"}], "=", 
   "\"\<Could not work out the unit cell properly.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "::", "notMaXrd"}], "=", 
   "\"\<Data collected using `1` radiation. Errors may occur.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImportCrystalData", "::", "modulation"}], "=", 
    "\"\<Modulated structure detected. Errors may occur.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ImportCrystalData"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<DataFile\>\"", "\[Rule]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<CrystalData.m\>\""}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ExtractSubdata\>\"", "\[Rule]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<IgnoreIonCharge\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Notes\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<RoundAnglesThreshold\>\"", "\[Rule]", "0.001"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<OverwriteWarning\>\"", "\[Rule]", "True"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.66810571214802*^9, {3.6681867516522207`*^9, 
   3.668186778354513*^9}, {3.6681868394172163`*^9, 3.6681868614325943`*^9}, {
   3.668187374101748*^9, 3.6681874104278383`*^9}, {3.668187695125526*^9, 
   3.668187730468417*^9}, {3.668188056044814*^9, 3.668188056876872*^9}, {
   3.6681926250344687`*^9, 3.668192625250432*^9}, 3.68166923708845*^9, {
   3.6817064191712627`*^9, 3.68170642414537*^9}, {3.6817239114596*^9, 
   3.681723955601696*^9}, {3.681724223652172*^9, 3.681724224172266*^9}, {
   3.6818128705108147`*^9, 3.681812886108671*^9}, {3.681819874858591*^9, 
   3.681819895264824*^9}, {3.681835709479094*^9, 3.681835743293057*^9}, {
   3.682100938006762*^9, 3.682100938717538*^9}, {3.683537673194815*^9, 
   3.683537695846451*^9}, {3.683537801117275*^9, 3.683537820368045*^9}, {
   3.6835378509602337`*^9, 3.6835379652168307`*^9}, {3.683872568026477*^9, 
   3.6838725813488774`*^9}, {3.6838755364193954`*^9, 
   3.6838755630017953`*^9}, {3.683875596619796*^9, 3.6838755997709956`*^9}, {
   3.683883154459938*^9, 3.6838831559107385`*^9}, {3.6838834647439404`*^9, 
   3.68388346822274*^9}, 3.6838844948587465`*^9, {3.683884644312748*^9, 
   3.683884657962748*^9}, {3.6838850595535507`*^9, 3.6838850748883505`*^9}, {
   3.683885134589551*^9, 3.6838851736519513`*^9}, {3.683913171307146*^9, 
   3.683913207514256*^9}, {3.6839171824682417`*^9, 3.683917209618238*^9}, {
   3.6839469879120827`*^9, 3.683947021990581*^9}, 3.683966169680979*^9, {
   3.683966389814184*^9, 3.683966401444254*^9}, {3.6839672153149443`*^9, 
   3.683967216968305*^9}, 3.685383224383915*^9, 3.6865396500180807`*^9, {
   3.6865474433420763`*^9, 3.6865474810423117`*^9}, {3.717394967952651*^9, 
   3.717394985509343*^9}, {3.7173986023852253`*^9, 3.717398648986843*^9}, {
   3.717942206289736*^9, 3.717942206316785*^9}, {3.717951917348363*^9, 
   3.717951925065959*^9}, {3.718014808848607*^9, 3.718014817499877*^9}, 
   3.718015826329137*^9, 3.718016203248323*^9, {3.72111992623072*^9, 
   3.721119960300297*^9}, {3.73736723509699*^9, 3.737367235446919*^9}, {
   3.737374290135022*^9, 3.737374293045693*^9}, {3.738307378688077*^9, 
   3.738307378902713*^9}, {3.739209258179865*^9, 3.739209258423847*^9}, {
   3.739209866595991*^9, 3.739209867810956*^9}, {3.739251594550383*^9, 
   3.739251605678607*^9}, {3.7392653600532627`*^9, 3.739265382579735*^9}, {
   3.739502515356379*^9, 3.7395025380522223`*^9}, {3.739503650580277*^9, 
   3.7395036705144863`*^9}, {3.7395047560359173`*^9, 3.739504756236701*^9}, 
   3.743865412368585*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"07375a0c-d51d-4322-a9af-3a2dec13c0fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[111]:=",ExpressionUUID->"9a99be2f-d096-45cf-a811-39c89592b367"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportCrystalData", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"CrystalName_String", ",", "\[IndentingNewLine]", 
      RowBox[{"ChemicalFormula", ":", 
       RowBox[{"_", "?", "StringQ"}], ":", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Z", ":", 
       RowBox[{"_", "?", "IntegerQ"}], ":", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SpaceGroup_:", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Wavelength", ":", 
       RowBox[{"_", "?", "NumericQ"}], ":", 
       RowBox[{"-", "1"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "GetLatticeParameters_List", ",", 
    "\[IndentingNewLine]", "AtomData_List", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "ImportCrystalData"}]}], 
   "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "choice", ",", "name", ",", "sg", ",", "cell", ",", "\[Delta]", ",", 
      "fr", ",", "latticeItem", ",", "\[Lambda]", ",", "itemAtomData", ",", 
      "item", ",", "datafile", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Check", " ", "if", " ", "name", " ", 
      "already", " ", "exists", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"CrystalName", "===", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"name", "=", 
        RowBox[{"\"\<ImportedCrystal_\>\"", "<>", 
         RowBox[{"DateString", "[", "\"\<ISODate\>\"", "]"}]}]}], ",", 
       RowBox[{"name", "=", "CrystalName"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<OverwriteWarning\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"$CrystalData", ",", "name"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"choice", "=", 
           RowBox[{"ChoiceDialog", "[", 
            RowBox[{
            "\"\<\[LeftGuillemet]\>\"", "<>", "name", "<>", 
             "\[IndentingNewLine]", 
             "\"\<\[RightGuillemet] already exists in $CrystalData.\\nDo you \
want to overwrite this entry?\>\""}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "choice"}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", "Space"}]}], " ", "Group", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"SpaceGroup", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"ToStandardSetting", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Lattice", " ", "parameters", " ", "*", 
       
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"AllTrue", "[", 
          RowBox[{"GetLatticeParameters", ",", 
           RowBox[{
            RowBox[{"NumericQ", "[", "#", "]"}], "&"}]}], "]"}]}], "||", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "@", "GetLatticeParameters"}], "\[NotEqual]", 
         "6"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Message", "[", 
        RowBox[{"ImportCrystalData", "::", "latticeParameters"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Round", " ", "angles"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"cell", "=", "GetLatticeParameters"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"OptionValue", "[", "\"\<RoundAnglesThreshold\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"fr", "=", 
         RowBox[{"FractionalPart", "@", 
          RowBox[{"cell", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fr", ">", "0.5"}], ",", 
          RowBox[{"fr", "=", 
           RowBox[{"1", "-", "fr"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fr", "\[LessEqual]", "\[Delta]"}], ",", 
          RowBox[{
           RowBox[{"cell", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"Round", "@", 
            RowBox[{"cell", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "4", ",", "6"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Use", " ", "units"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"i", "\[LessEqual]", "3"}], ",", 
           RowBox[{
            RowBox[{"cell", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Quantity", "[", 
             RowBox[{
              RowBox[{"cell", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Angstroms\>\""}], 
             "]"}]}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"i", "\[GreaterEqual]", "4"}], ",", 
           RowBox[{
            RowBox[{"cell", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Quantity", "[", 
             RowBox[{
              RowBox[{"cell", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Degrees\>\""}], 
             "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Prepare", " ", "association", " ", "entry"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"latticeItem", "=", 
      RowBox[{"Association", "@", "\[IndentingNewLine]", "\t", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", 
           "\"\<\[Alpha]\>\"", ",", "\"\<\[Beta]\>\"", ",", 
           "\"\<\[Gamma]\>\""}], "}"}], "\[Rule]", "cell"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Wavelength", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Use", " ", "units"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"Quantity", "[", 
         RowBox[{"Wavelength", ",", "\"\<Angstroms\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", "Wavelength"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Atom", " ", "data", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AtomData", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"itemAtomData", "=", 
        RowBox[{"{", 
         RowBox[{"<|", "|>"}], "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"itemAtomData", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DeleteMissing", "@", 
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"AtomData", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
               "\"\<Element\>\"", ",", "\[IndentingNewLine]", 
                "\"\<OccupationFactor\>\"", ",", "\[IndentingNewLine]", 
                "\"\<SiteSymmetryMultiplicity\>\"", ",", 
                "\[IndentingNewLine]", "\"\<SiteSymmetryOrder\>\"", ",", 
                "\[IndentingNewLine]", "\"\<FractionalCoordinates\>\"", ",", 
                "\[IndentingNewLine]", "\"\<DisplacementParameters\>\"", ",", 
                "\[IndentingNewLine]", "\"\<Type\>\""}], "}"}]}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "AtomData"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{
              RowBox[{"First", "@", "itemAtomData"}], ",", "k"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"itemAtomData", "=", 
             RowBox[{"MapAt", "[", "\[IndentingNewLine]", 
              RowBox[{"ToExpression", ",", "itemAtomData", ",", 
               RowBox[{"{", 
                RowBox[{"All", ",", 
                 RowBox[{"Key", "[", "k", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"{", "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<OccupationFactor\>\"", ",", "\[IndentingNewLine]", "\t", 
              "\"\<SiteSymmetryMultiplicity\>\"", ",", "\[IndentingNewLine]", 
              "\t", "\"\<SiteSymmetryOrder\>\"", ",", "\[IndentingNewLine]", 
              "\t", "\"\<DisplacementParameters\>\""}], "}"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Checking", " ", "strings", " ", "in", " ", "coordinates"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"itemAtomData", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "\"\<FractionalCoordinates\>\""}], "]"}], 
            "]"}], "=", 
           RowBox[{
            RowBox[{"itemAtomData", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "\"\<FractionalCoordinates\>\""}], "]"}], 
             "]"}], "/.", 
            RowBox[{"x_String", "\[RuleDelayed]", 
             RowBox[{"ToExpression", "[", "x", "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "itemAtomData"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "item", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"item", "=", "\[IndentingNewLine]", "\t", 
      RowBox[{"<|", 
       RowBox[{"name", "\[Rule]", 
        RowBox[{"<|", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"\"\<ChemicalFormula\>\"", "\[Rule]", "ChemicalFormula"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<FormulaUnits\>\"", "\[Rule]", "Z"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<SpaceGroup\>\"", "\[Rule]", "sg"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<LatticeParameters\>\"", "\[Rule]", "latticeItem"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Wavelength\>\"", "\[Rule]", "\[Lambda]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<AtomData\>\"", "\[Rule]", "itemAtomData"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Notes\>\"", "\[Rule]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"OptionValue", "[", "\"\<Notes\>\"", "]"}], "}"}], 
            "]"}]}]}], "\[IndentingNewLine]", "\t", "|>"}]}], "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Delete", " ", "certain", " ", "keys"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"item", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "\"\<ChemicalFormula\>\""}], "]"}], "]"}], "===", 
        "\"\<\>\""}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"item", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"KeyDrop", "[", 
         RowBox[{
          RowBox[{"item", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<ChemicalFormula\>\""}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"item", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "\"\<Notes\>\""}], "]"}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"item", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"KeyDrop", "[", 
         RowBox[{
          RowBox[{"item", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Notes\>\""}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"Positive", "@", 
         RowBox[{"item", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "\"\<Wavelength\>\""}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"item", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"KeyDrop", "[", 
         RowBox[{
          RowBox[{"item", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Wavelength\>\""}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Z", "===", "0"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"item", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"KeyDrop", "[", 
         RowBox[{
          RowBox[{"item", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<FormulaUnits\>\""}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", " ", "all", " ", "occupation", " ", "factors"}], " ", 
        "=", " ", "1"}], ",", " ", 
       RowBox[{"delete", " ", "column"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"item", "[", 
       RowBox[{"[", 
        RowBox[{
        "1", ",", "\"\<AtomData\>\"", ",", "All", ",", 
         "\"\<OccupationFactor\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"N", "@", "temp"}], ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "1."}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"item", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "\"\<AtomData\>\"", ",", "All"}], "]"}], "]"}], 
        "=", 
        RowBox[{"KeyDrop", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"item", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "\"\<AtomData\>\"", ",", "All"}], "]"}], "]"}], 
          ",", "\"\<OccupationFactor\>\""}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", " ", "all", " ", "displacement", " ", "parameters"}], 
        " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"delete", " ", "column"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"item", "[", 
       RowBox[{"[", 
        RowBox[{
        "1", ",", "\"\<AtomData\>\"", ",", "All", ",", 
         "\"\<DisplacementParameters\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"N", "@", "temp"}], ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "0."}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"item", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "\"\<AtomData\>\"", ",", "All"}], "]"}], "]"}], 
        "=", 
        RowBox[{"KeyDrop", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"item", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "\"\<AtomData\>\"", ",", "All"}], "]"}], "]"}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"\"\<DisplacementParameters\>\"", ",", "\"\<Type\>\""}], 
           "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Data", " ", "file", " ", "operations"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"datafile", "=", 
      RowBox[{"OptionValue", "[", "\"\<DataFile\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "datafile"}]}], ",", 
       RowBox[{"Export", "[", 
        RowBox[{"datafile", ",", 
         RowBox[{"<|", "|>"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"$CrystalData", "=", 
      RowBox[{"Import", "@", "datafile"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"$CrystalData", ",", "item"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$CrystalData", "=", 
      RowBox[{"KeySort", "@", "$CrystalData"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Export", "[", 
      RowBox[{"datafile", ",", "$CrystalData"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Update", " ", "auto", " ", "completion"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FE`Evaluate", "[", 
        RowBox[{"FEPrivate`AddSpecialArgCompletion", "[", "#", "]"}], "]"}], 
       "&"}], "\[IndentingNewLine]", "[", 
      RowBox[{"\"\<$CrystalData\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Keys", "@", "$CrystalData"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<ChemicalFormula\>\"", ",", "\"\<SpaceGroup\>\"", ",", 
           "\[IndentingNewLine]", "\"\<LatticeParameters\>\"", ",", 
           "\"\<AtomData\>\"", ",", "\"\<Notes\>\""}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Display", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#1", "\[Equal]", "\"\<AtomData\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<AtomData\>\"", "\[Rule]", 
           RowBox[{"Shallow", "[", 
            RowBox[{"#2", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"#1", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", "name", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682676951614175*^9, 
   3.682677014282371*^9}, {3.682743302412827*^9, 3.682743302984312*^9}, {
   3.68283882611203*^9, 3.682838829861582*^9}, {3.682839274791851*^9, 
   3.6828392951419153`*^9}, {3.6828394322211113`*^9, 3.682839485235921*^9}, {
   3.682839522176443*^9, 3.6828396062695837`*^9}, {3.6838754373593946`*^9, 
   3.6838754620697947`*^9}, {3.683875498464595*^9, 3.6838755411461954`*^9}, {
   3.6838755757937956`*^9, 3.6838756168373957`*^9}, {3.683877299628604*^9, 
   3.683877302748604*^9}, {3.683877625231806*^9, 3.683877735617407*^9}, {
   3.6838777700934067`*^9, 3.683877786629407*^9}, {3.683877824459407*^9, 
   3.683877883255808*^9}, {3.683877991675808*^9, 3.6838780441230087`*^9}, 
   3.6838781541810093`*^9, {3.6838785155238113`*^9, 3.6838785162258115`*^9}, {
   3.683883648168741*^9, 3.6838836561403418`*^9}, {3.6838836902887416`*^9, 
   3.683884028949144*^9}, {3.6838840713655443`*^9, 3.6838841621887445`*^9}, {
   3.683885078039551*^9, 3.6838850783983507`*^9}, {3.6840604337874165`*^9, 
   3.6840604341150165`*^9}, {3.684060677475018*^9, 3.6840607181130185`*^9}, {
   3.684064659458737*^9, 3.684064660824226*^9}, {3.684065013290655*^9, 
   3.6840651007018023`*^9}, 3.684091992501087*^9, {3.684092047571642*^9, 
   3.684092056517186*^9}, {3.684092093787097*^9, 3.684092109418057*^9}, {
   3.684092154139434*^9, 3.684092154840337*^9}, 3.684092215316921*^9, {
   3.684092293078665*^9, 3.684092296157777*^9}, {3.684092465243285*^9, 
   3.684092482747108*^9}, {3.684092743174653*^9, 3.684092745262229*^9}, {
   3.684122119660481*^9, 3.684122119802287*^9}, {3.684122540865759*^9, 
   3.684122543651548*^9}, {3.684122650380859*^9, 3.684122682496744*^9}, {
   3.684122718574717*^9, 3.6841227264847918`*^9}, {3.6841275607768307`*^9, 
   3.684127629729051*^9}, {3.684127891116247*^9, 3.684127892571128*^9}, {
   3.684483205713032*^9, 3.684483211262594*^9}, {3.684483790403738*^9, 
   3.684483795123879*^9}, {3.685285890213419*^9, 3.685285902411302*^9}, {
   3.6852859679097023`*^9, 3.685285972385825*^9}, {3.686539651186246*^9, 
   3.686539652401841*^9}, {3.6865488692683764`*^9, 3.686548871875628*^9}, {
   3.686549678453073*^9, 3.686549812821848*^9}, {3.6865498480750237`*^9, 
   3.6865498666827497`*^9}, {3.686549900073018*^9, 3.686549936893228*^9}, {
   3.6865499930279913`*^9, 3.686550060430197*^9}, {3.686550112225142*^9, 
   3.6865501356261597`*^9}, {3.6865501835287313`*^9, 3.686550267746396*^9}, {
   3.686550530272417*^9, 3.686550577558567*^9}, {3.686636392798913*^9, 
   3.686636458512154*^9}, {3.686636825377118*^9, 3.6866368257130737`*^9}, {
   3.690876148810753*^9, 3.690876180435878*^9}, {3.690888859078938*^9, 
   3.690888904056428*^9}, {3.6908895958854427`*^9, 3.690889596291432*^9}, {
   3.690889701343381*^9, 3.690889744880413*^9}, {3.690889780680581*^9, 
   3.690889820427496*^9}, {3.690890032406951*^9, 3.690890053995669*^9}, {
   3.690890444323526*^9, 3.6908904470700083`*^9}, {3.690890814997316*^9, 
   3.690890815831262*^9}, {3.690891007984201*^9, 3.690891031395673*^9}, {
   3.690891133552911*^9, 3.690891137120051*^9}, {3.690891176841043*^9, 
   3.6908911898237658`*^9}, {3.690891626381727*^9, 3.690891627189205*^9}, {
   3.690891712786038*^9, 3.690891713655484*^9}, {3.690891758219355*^9, 
   3.6908917585035152`*^9}, {3.690891852466124*^9, 3.690891855496437*^9}, {
   3.690892074279029*^9, 3.690892122266016*^9}, {3.690892157891358*^9, 
   3.690892159507001*^9}, {3.690892460974785*^9, 3.690892488819858*^9}, {
   3.690892643174568*^9, 3.6908926561424713`*^9}, {3.690892695920432*^9, 
   3.690892761646077*^9}, {3.705381561172036*^9, 3.705381563232807*^9}, {
   3.705381730133943*^9, 3.705381731010749*^9}, {3.705381761485899*^9, 
   3.7053817625813923`*^9}, {3.705381961091528*^9, 3.705381961739848*^9}, {
   3.705382886776128*^9, 3.705382910719694*^9}, {3.70538298540779*^9, 
   3.705382999790876*^9}, {3.705383200859761*^9, 3.705383201317832*^9}, {
   3.712039804004003*^9, 3.712039837410914*^9}, {3.712039888007128*^9, 
   3.712039976950371*^9}, {3.712040039595913*^9, 3.7120400428353252`*^9}, {
   3.71437291775845*^9, 3.714372920591165*^9}, {3.714373013115429*^9, 
   3.714373111168646*^9}, {3.714381611549461*^9, 3.71438168878443*^9}, {
   3.71438182004793*^9, 3.7143818226490498`*^9}, {3.714913981660367*^9, 
   3.714913993459426*^9}, {3.716819647322055*^9, 3.716819649144059*^9}, {
   3.716819738528111*^9, 3.716819741943658*^9}, {3.716819893292836*^9, 
   3.716819911259316*^9}, {3.716820049225861*^9, 3.716820110288262*^9}, {
   3.716820157664789*^9, 3.7168201582227993`*^9}, 3.716820271941564*^9, {
   3.7173994935959806`*^9, 3.717399535062772*^9}, 3.717740896966391*^9, {
   3.7179422063447857`*^9, 3.717942206357648*^9}, {3.7180130748350773`*^9, 
   3.7180130910990973`*^9}, {3.7180148242351923`*^9, 
   3.7180148311457357`*^9}, {3.718014898102281*^9, 3.718014898233629*^9}, {
   3.718015243930171*^9, 3.718015282584255*^9}, 3.718015315920961*^9, {
   3.7180156461055937`*^9, 3.718015755165243*^9}, {3.7180157967662783`*^9, 
   3.718015829733087*^9}, {3.7180158831958733`*^9, 3.7180160053342524`*^9}, {
   3.718016239795858*^9, 3.718016245499477*^9}, {3.71844534122999*^9, 
   3.718445351214416*^9}, {3.718445534462845*^9, 3.718445544887985*^9}, {
   3.726464354380864*^9, 3.726464357211823*^9}, {3.7264644108631153`*^9, 
   3.72646442689914*^9}, {3.726470847882986*^9, 3.726470865128058*^9}, {
   3.7264709109909163`*^9, 3.72647099076378*^9}, {3.726471087701652*^9, 
   3.726471104816641*^9}, {3.726474185878257*^9, 3.726474189604694*^9}, 
   3.726474223211694*^9, {3.7264744761979103`*^9, 3.726474483011284*^9}, {
   3.7264745194447823`*^9, 3.72647451967942*^9}, {3.726904493491934*^9, 
   3.726904531469075*^9}, {3.726905529651862*^9, 3.726905645699419*^9}, 
   3.727164723614419*^9, {3.7271647636423893`*^9, 3.727164798426024*^9}, {
   3.727164958421529*^9, 3.727164988222075*^9}, {3.727165042310004*^9, 
   3.7271650488753567`*^9}, {3.727679329728222*^9, 3.727679384869399*^9}, 
   3.72767941926967*^9, {3.7301441859807997`*^9, 3.7301441909532824`*^9}, {
   3.7305437419606*^9, 3.7305437430825768`*^9}, {3.730544137286261*^9, 
   3.730544137542388*^9}, {3.730544272563367*^9, 3.73054429091084*^9}, {
   3.734086643112812*^9, 3.734086650280046*^9}, {3.734086721542708*^9, 
   3.734086741504282*^9}, {3.734086996113962*^9, 3.7340869980551243`*^9}, 
   3.73408730066591*^9, {3.734087391864551*^9, 3.734087401446116*^9}, {
   3.734087436367076*^9, 3.734087460116948*^9}, {3.7340876420579853`*^9, 
   3.7340876423708982`*^9}, {3.734087932780149*^9, 3.734088059863969*^9}, {
   3.734088377921844*^9, 3.7340884199114656`*^9}, {3.734088509745023*^9, 
   3.734088518509304*^9}, {3.7340885760800037`*^9, 3.734088595190104*^9}, 
   3.7340888079526997`*^9, {3.734088951665037*^9, 3.734089018509555*^9}, {
   3.734092222193697*^9, 3.73409229550977*^9}, {3.734092364593038*^9, 
   3.73409237038064*^9}, {3.734097452322815*^9, 3.7340974727356043`*^9}, {
   3.7340976191960287`*^9, 3.734097652441235*^9}, {3.73410054000917*^9, 
   3.734100541951701*^9}, {3.735030627906562*^9, 3.7350306391261253`*^9}, {
   3.7350306883908873`*^9, 3.7350307008109818`*^9}, {3.7350309342608757`*^9, 
   3.735030941583761*^9}, {3.7350311561314373`*^9, 3.73503121656846*^9}, {
   3.735031371649341*^9, 3.73503137200354*^9}, {3.7350314486109877`*^9, 
   3.735031497236422*^9}, {3.735031527623269*^9, 3.735031536838859*^9}, {
   3.737968498976862*^9, 3.737968499224889*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[112]:=",ExpressionUUID->"ff9dd400-1e91-4323-934f-5c14e1c2929f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportCrystalData", "[", 
   RowBox[{"ciffile_", ",", 
    RowBox[{"Name_String:", "\"\<\>\""}], ",", 
    RowBox[{"OptionsPattern", "@", "ImportCrystalData"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"A", ".", " ", "Input"}], " ", "check", " ", "and", " ", 
       "setup"}], " ", "*)"}], 
     RowBox[{
     "name", ",", "import", ",", "sub", ",", "endstring", ",", "enc", ",", 
      "left", ",", "mid", ",", "right", ",", "\[IndentingNewLine]", 
      RowBox[{"modulationQ", "=", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"B", ".", " ", "Lattice"}], " ", "parameters"}], " ", "*)"}], 
      "cell", ",", "x", ",", "X", ",", "multipleQ", ",", "parts", ",", 
      "coordCount", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"C", ".", " ", "Atom"}], " ", "data"}], " ", "*)"}], 
      "atomdata", ",", "atomtags", ",", "c", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"D", ".", " ", "Anisotropic"}], " ", "displacement", " ", 
        "parameters", " ", 
        RowBox[{"(", "ADPs", ")"}]}], " ", "*)"}], "anisodata", ",", 
      "anisoOrder", ",", "P", ",", "atomoverview", ",", "tags", ",", "labels",
       ",", "disp", ",", "item", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"E", ".", " ", "Misc"}], " ", "data", " ", "labels", " ", 
        RowBox[{"(", 
         RowBox[{"wavelength", ",", " ", 
          RowBox[{"formula", " ", "units"}]}], ")"}]}], " ", "*)"}], 
      "\[Lambda]", ",", "Z", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"F", ".", " ", "Chemical"}], " ", "formula"}], " ", "*)"}], 
      "formula", ",", "chemicalformula", ",", "L", ",", "l", ",", "r", ",", 
      "checkParentheses", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"G", ".", " ", "Space"}], " ", "group"}], " ", "*)"}], 
      "sgTags", ",", "sgData", ",", "sg", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"H", ".", " ", "Adding"}], " ", "item", " ", "to", " ", 
        "dataset"}], " ", "*)"}], "options", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Misc", " ", "*)"}], "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "check", " ", "and", " ", 
      "setup", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Name", "\[Equal]", "\"\<\>\""}], ",", 
       RowBox[{"name", "=", 
        RowBox[{"FileBaseName", "[", "ciffile", "]"}]}], ",", 
       RowBox[{"name", "=", "Name"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".1", ".", " ", "Check"}], " ", "file"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"import", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"ciffile", ",", "\"\<String\>\""}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sub", "=", 
      RowBox[{"OptionValue", "[", "\"\<ExtractSubdata\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
            RowBox[{"Positive", "[", "#", "]"}]}], "&"}], "@", "sub"}], 
         ")"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "subdataInteger"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Auxiliary"}], " ", "variables"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"endstring", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<loop_\>\"", ",", "\"\<\\n\\n\>\"", ",", "\"\<;\>\"", ",", 
        "\"\<#\>\"", ",", "EndOfString"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"enc", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"annotation", "/", "enclosing"}], " ", "marks"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{"left", ",", "mid", ",", "right"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\\!\\(\\*SubscriptBox[\\(\>\"", ",", "\"\<\\), \\(\>\"", ",", 
         "\"\<\\)]\\)\>\""}], "}"}]}],
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True], 
     StyleBox[";",
      ShowSpecialCharacters->False,
      ShowStringCharacters->True,
      NumberMarks->True], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".3", ".", " ", "Check"}], " ", "radiation", " ", "type"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<_diffrn_radiation_type\>\"", ",", 
             "\"\<_diffrn_radiation_probe\>\""}], "}"}], 
           "\[IndentingNewLine]", "~~", "Whitespace", "~~", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "enc"}], "}"}], "~~", 
           RowBox[{"t", ":", 
            RowBox[{"LetterCharacter", ".."}]}], "~~", "\"\<\\n\>\""}], "]"}],
          "\[RuleDelayed]", "t"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"temp", ",", "#"}], "]"}], ",", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ImportCrystalData", "::", "notMaXrd"}], ",", "#"}], 
          "]"}]}], "]"}], "\[IndentingNewLine]", "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<neutron\>\"", ",", "\"\<electron\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".4", ".", " ", "Check"}], " ", "for", " ", "modulation"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"import", ",", "\"\<_space_group_ssg_name\>\""}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"modulationQ", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{"ImportCrystalData", "::", "modulation"}], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Lattice"}], " ", "parameters", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Extracting"}], " ", "lattice", " ", 
       "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cell", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<_cell_\>\"", "~~", 
              RowBox[{"{", 
               RowBox[{"\"\<length\>\"", ",", "\"\<angle\>\""}], "}"}], "~~", 
              "__", "~~", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"DigitCharacter", ",", "\"\<.\>\""}], "}"}], ".."}]}],
              ")"}]}], "~~", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<(\>\"", ",", "Whitespace"}], "}"}]}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"ToLowerCase", "@", "x"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cell", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "latticeParameters"}], "]"}], ";",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".2", ".", " ", "Check"}], " ", "for", " ", "multiplue", " ", 
       "structures"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"cell", ",", "Whitespace"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "cell"}], ">", "6"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"multipleQ", "=", "True"}], ";", 
        RowBox[{"parts", "=", 
         RowBox[{
          RowBox[{"Length", "[", "cell", "]"}], "/", "6"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Length", "@", "cell"}], "\[Equal]", "6"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"multipleQ", "=", "False"}], ";", 
        RowBox[{"parts", "=", "1"}]}], ",", "\[IndentingNewLine]", "\t", 
       "True", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "cell"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "@", "cell"}]}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Correct", " ", "ordering"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"cell", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Length", "@", "cell"}], "/", 
         RowBox[{"Quotient", "[", 
          RowBox[{
           RowBox[{"Length", "@", "cell"}], ",", "6"}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "=", 
         RowBox[{"cell", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"x", "=", 
         RowBox[{"X", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"P", "=", 
         RowBox[{"FindPermutation", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "\"\<_cell_length_a\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_length_b\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_length_c\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_angle_alpha\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_angle_beta\>\"", ",", "\[IndentingNewLine]", "\t", 
             "\"\<_cell_angle_gamma\>\""}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"cell", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Permute", "[", 
          RowBox[{"X", ",", "P"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "cell"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"cell", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".3", ".", " ", "Check"}], " ", "subdata", " ", "extraction"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Verify", " ", "with", " ", "fractional", " ", "coordinates"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"coordCount", "=", 
      RowBox[{"StringCount", "[", 
       RowBox[{"import", ",", "\"\<_atom_site_fract_x\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coordCount", "===", "0"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "atomData"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\t", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"parts", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"parts", ",", "coordCount"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"multipleQ", "&&", 
          RowBox[{"sub", ">", "parts"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"!", "multipleQ"}], "&&", 
          RowBox[{"sub", "\[NotEqual]", "1"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ImportCrystalData", "::", "subdataLength"}], ",", 
          "parts"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "parts", "]"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "subdataInteger"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "@", "parts"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extract", " ", "subdata"}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"cell", "=", 
      RowBox[{"ToExpression", "@", 
       RowBox[{"cell", "[", 
        RowBox[{"[", "sub", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Atom"}], " ", "data", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<AtomData\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Extracting"}], " ", "relevant", " ", "data", 
       " ", "block"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Fractional", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Occupation", " ", "factor"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Site", " ", "symmetry", " ", "multiplicity"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Extracting", " ", "_atom", "_site", " ", "loop"}], " ", "*)"}],
      "\[IndentingNewLine]", "\t", 
     RowBox[{"atomdata", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"labels", ":", 
            RowBox[{"(", 
             RowBox[{
             "Whitespace", "~~", "\"\<_atom_site_\>\"", "~~", "__", "~~", 
              "\"\<\\n\>\""}], ")"}]}], "~~", 
           RowBox[{"data", ":", 
            RowBox[{"(", 
             RowBox[{"StartOfLine", "~~", 
              RowBox[{"Whitespace", "..."}], "~~", "LetterCharacter", "~~", 
              "__", "~~", "\"\<\\n\>\""}], ")"}]}], "\[IndentingNewLine]", "~~", 
           RowBox[{"{", 
            RowBox[{"endstring", ",", "\"\<_atom_site_aniso\>\"", ",", 
             RowBox[{"\"\<_\>\"", "~~", 
              RowBox[{"Except", "[", "\"\<a\>\"", "]"}]}]}], "}"}]}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"labels", ",", "data"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"No", " ", 
       RowBox[{"data", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"atomdata", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "atomData"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Delete", " ", "cases", " ", "containing", " ", "anisotropy", " ", 
       "data"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"atomdata", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"atomdata", ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"x_", "/;", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<aniso\>\""}], "]"}]}]}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Specify", " ", "sub"}], "-", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"atomdata", "=", 
      RowBox[{"atomdata", "[", 
       RowBox[{"[", "sub", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".2", ".", " ", "Organising"}], " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"atomtags", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{
         RowBox[{"atomdata", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<_atom_site_\>\"", "~~", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"WordCharacter", ",", "\"\<_\>\""}], "}"}], ".."}]}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"atomdata", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"atomdata", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"\"\<(\>\"", "~~", 
         RowBox[{"DigitCharacter", ".."}], "~~", "\"\<)\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"atomdata", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"StringSplit", "@", "atomdata"}], ",", 
        RowBox[{"Length", "@", "atomtags"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomdata", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"atomdata", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "x", "]"}], "\[NotEqual]", 
          RowBox[{"Length", "[", "atomtags", "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomdata", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", 
        RowBox[{"atomtags", "\[Rule]", 
         RowBox[{"Transpose", "@", "atomdata"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", ".3", " ", "Fixing", " ", "entries"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", " ", "'"}], "site_type", 
        RowBox[{"_symbol", "'"}], " ", "is", " ", "missing"}], ",", " ", 
       RowBox[{
        RowBox[{"copy", " ", "'"}], 
        RowBox[{"site_label", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"atomdata", ",", "\"\<_atom_site_type_symbol\>\""}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"atomdata", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<_atom_site_type_symbol\>\"", "\[Rule]", 
          RowBox[{"atomdata", "[", "\"\<_atom_site_label\>\"", "]"}]}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Process", " ", "and", " ", "check", " ", "elements"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"atomdata", "[", "\"\<_atom_site_type_symbol\>\"", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"temp", ",", "\"\<InterpretElement\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Clear", " ", "any", " ", "ion", " ", "charges"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IgnoreIonCharge\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"StringDelete", "[", 
         RowBox[{"temp", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<+\>\"", ",", "\"\<-\>\"", ",", "DigitCharacter"}], 
           "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Update", " ", "'"}], 
       RowBox[{"atomdata", "'"}], " ", 
       RowBox[{"with", " ", "'"}], 
       RowBox[{"temp", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"atomdata", "[", "\"\<_atom_site_type_symbol\>\"", "]"}], "=", 
      "temp"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Anisotropic"}], " ", "displacement", " ", 
       "parameters", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"D", 
        RowBox[{".1", ".", " ", "If"}], " ", "missing"}], ",", " ", 
       RowBox[{
       "use", " ", "default", " ", "values", " ", "for", " ", "ADP"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"First", "@", "atomdata"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"atomdata", ",", "\"\<_atom_site_adp_type\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"atomdata", ",", 
         RowBox[{"\"\<_atom_site_adp_type\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"\"\<Uiso\>\"", ",", "L"}], "]"}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"atomdata", ",", "\"\<_atom_site_U_iso_or_equiv\>\""}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"atomdata", ",", 
         RowBox[{"\"\<_atom_site_U_iso_or_equiv\>\"", "\[Rule]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "L"}], "]"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"D", 
       RowBox[{".2", ".", " ", "Anisotropic"}], " ", "displacement", " ", 
       "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "\"\<loop_\>\"", "~~", "Whitespace", "~~", "\[IndentingNewLine]", 
           RowBox[{"x", ":", 
            RowBox[{"(", 
             RowBox[{"\"\<_atom_site_aniso\>\"", "~~", "__"}], ")"}]}], "~~", 
           "endstring"}], "]"}], "\[RuleDelayed]", "x"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"anisodata", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Goto", "[", "\"\<OrganiseAtomdata\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"anisodata", "=", 
        RowBox[{"anisodata", "[", 
         RowBox[{"[", "sub", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"D", 
       RowBox[{".3", ".", " ", "Noting"}], " ", "the", " ", "order", " ", 
       RowBox[{"(", "permutation", ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"anisoOrder", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"anisodata", ",", 
         RowBox[{"\"\<U_\>\"", "~~", 
          RowBox[{"DigitCharacter", ".."}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{"FindPermutation", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<U_11\>\"", ",", "\"\<U_22\>\"", ",", "\"\<U_33\>\"", ",", 
          "\"\<U_12\>\"", ",", "\"\<U_13\>\"", ",", "\"\<U_23\>\""}], "}"}], 
        ",", "anisoOrder"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Nothing", " ", "there", " ", "to", " ", 
       RowBox[{"extract", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"anisodata", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Shortest", "[", 
           RowBox[{
           "\"\<_atom_site_aniso_\>\"", "~~", "x__", "~~", "Whitespace"}], 
           "]"}], "\[RuleDelayed]", "x"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"c", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Quiet", "@", 
        RowBox[{"Position", "[", 
         RowBox[{"temp", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"x_", "/;", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"x", ",", "\"\<U\>\""}], "]"}]}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"D", 
       RowBox[{".4", ".", " ", "Extracting"}], " ", "relevant", " ", "data", 
       " ", "and", " ", "trimming"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"anisodata", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Shortest", "[", 
           RowBox[{
           "\"\<_atom_site_aniso\>\"", "~~", "__", "~~", "EndOfLine"}], "]"}],
           "~~", "Whitespace", "~~", 
          RowBox[{"(*", " ", 
           RowBox[{"Last", " ", "line"}], " ", "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"x", ":", 
           RowBox[{"(", 
            RowBox[{"WordCharacter", "~~", "__"}], ")"}]}]}], 
         "\[RuleDelayed]", "x"}]}], 
       RowBox[{"(*", " ", "Content", " ", "*)"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "there", " ", "is", " ", "any", " ", "actual", 
       " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"anisodata", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<OrganiseAtomdata\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"First", "@", "anisodata"}], ",", "Whitespace"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"anisodata", ",", 
        RowBox[{
         RowBox[{"x__", "~~", "\"\<(\>\"", "~~", "__", "~~", "\"\<)\>\""}], 
         "\[RuleDelayed]", "x"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"anisodata", ",", 
        RowBox[{"Length", "@", "temp"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Correcting", " ", "parameter", " ", "order"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"anisodata", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "c"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Permute", "[", 
         RowBox[{"#", ",", "P"}], "]"}], "&"}], "/@", 
       RowBox[{"anisodata", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "c"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Associating", " ", "each", " ", "atom", " ", "with", " ", "values"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"anisodata", "=", 
      RowBox[{"Association", "[", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"anisodata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", 
          RowBox[{"anisodata", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "c"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "anisodata"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"D", 
       RowBox[{".5", ".", " ", "Organising"}], " ", "the", " ", "atom", " ", 
       "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<OrganiseAtomdata\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomoverview", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tags", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<_atom_site_occupancy\>\"", ",", "\[IndentingNewLine]", 
        "\"\<_atom_site_site_symmetry_multiplicity\>\"", ",", 
        "\[IndentingNewLine]", "\"\<_atom_site_site_symmetry_order\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"labels", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<OccupationFactor\>\"", ",", "\[IndentingNewLine]", 
        "\"\<SiteSymmetryMultiplicity\>\"", ",", "\[IndentingNewLine]", 
        "\"\<SiteSymmetryOrder\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"item", "=", 
         RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"item", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Element\>\"", "\[Rule]", 
           RowBox[{"atomdata", "[", 
            RowBox[{"[", 
             RowBox[{"\"\<_atom_site_type_symbol\>\"", ",", "i"}], "]"}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"atomdata", ",", 
              RowBox[{"tags", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"item", ",", 
              RowBox[{
               RowBox[{"labels", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
               "\[IndentingNewLine]", 
               RowBox[{"atomdata", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"tags", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "i"}], "]"}], 
                "]"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "tags"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"item", ",", 
          RowBox[{
          "\"\<FractionalCoordinates\>\"", "\[Rule]", "\[IndentingNewLine]", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"atomdata", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"\"\<_atom_site_fract_\>\"", "<>", "#"}], ",", "i"}],
                 "]"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
              "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"atomdata", "[", 
              RowBox[{"[", 
               RowBox[{"\"\<_atom_site_adp_type\>\"", ",", "i"}], "]"}], 
              "]"}], ",", 
             RowBox[{"-", "3"}]}], "]"}], "===", "\"\<ani\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"disp", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"anisodata", ",", 
             RowBox[{"atomdata", "[", 
              RowBox[{"[", 
               RowBox[{"\"\<_atom_site_label\>\"", ",", "i"}], "]"}], "]"}]}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"disp", "=", 
           RowBox[{"atomdata", "[", 
            RowBox[{"[", 
             RowBox[{"\"\<_atom_site_U_iso_or_equiv\>\"", ",", "i"}], "]"}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"item", ",", 
          RowBox[{"\"\<DisplacementParameters\>\"", "\[Rule]", "disp"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"item", ",", 
          RowBox[{"\"\<Type\>\"", "\[Rule]", 
           RowBox[{"atomdata", "[", 
            RowBox[{"[", 
             RowBox[{"\"\<_atom_site_adp_type\>\"", ",", "i"}], "]"}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"atomoverview", ",", "item"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"First", "@", "atomdata"}]}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"E", ".", " ", "Misc"}], " ", "data", " ", "labels", " ", "*", 
       
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"E", 
       RowBox[{".1", ".", " ", "Wavelength"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "\"\<_diffrn_radiation_wavelength\>\"", "~~", "\[IndentingNewLine]",
            "Whitespace", "~~", 
           RowBox[{"x", ":", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"DigitCharacter", ",", "\"\<.\>\""}], "}"}], ".."}]}], "~~",
            "Whitespace"}], "]"}], "\[RuleDelayed]", "x"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Lambda]", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "\[Lambda]"}], ">", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Lambda]", "=", 
          RowBox[{"ToExpression", "@", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "sub", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"\[Lambda]", "=", 
          RowBox[{"ToExpression", "@", 
           RowBox[{"First", "@", "\[Lambda]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"E", 
       RowBox[{".2", ".", " ", "Forumla"}], " ", "units", " ", 
       RowBox[{"(", "Z", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Z", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "\"\<_cell_formula_units_Z\>\"", "~~", "\[IndentingNewLine]", 
           "Whitespace", "~~", 
           RowBox[{"z", ":", "DigitCharacter"}]}], "]"}], "\[RuleDelayed]", 
         "z"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Z", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Z", "=", "0"}], ",", 
       RowBox[{"Z", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"First", "@", "Z"}]}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"F", ".", " ", "Chemical"}], " ", "formula", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"F", 
       RowBox[{".1", ".", " ", "Extracting"}], " ", "formula"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"formula", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{"import", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Shortest", "[", 
            RowBox[{"#", "~~", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Whitespace", ",", "\"\<\\n\>\""}], "}"}], ".."}], "~~", 
             RowBox[{"{", 
              RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", "f__", 
             "~~", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Whitespace", ",", "\"\<\\n\>\""}], "}"}], ".."}]}], 
            "]"}], "\[RuleDelayed]", "f"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Prioritised", " ", "order"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<_chemical_formula_iupac\>\"", ",", "\[IndentingNewLine]", 
         "\"\<_chemical_formula_structural\>\"", ",", "\[IndentingNewLine]", 
         "\"\<_chemical_formula_sum\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"formula", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", "formula"}], ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<,\>\"", ",", "\"\<?\>\""}], "}"}]}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"formula", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"formula", ",", "\"\<\\r\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"F", 
       RowBox[{".2", ".", " ", "Check"}], " ", "for", " ", "simplest", " ", 
       "formula"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"formula", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<(\>\""}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"formula", "=", 
        RowBox[{"{", 
         RowBox[{"First", "@", "temp"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"F", 
       RowBox[{".3", ".", " ", "Misc"}], " ", "treatmeant", " ", "and", " ", 
       "possible", " ", "subdata", " ", "selection"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"formula", "===", 
         RowBox[{"{", "}"}]}], "||", 
        RowBox[{"formula", "===", 
         RowBox[{"{", "\"\<\>\"", "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chemicalformula", "=", "\"\<\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroup\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"formula", "=", 
      RowBox[{"{", 
       RowBox[{"StringDelete", "[", 
        RowBox[{
         RowBox[{"StringTrim", "@", 
          RowBox[{"First", "@", "formula"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}]}], "]"}], "}"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"formula", "===", 
        RowBox[{"{", "\"\<\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chemicalformula", "=", "\"\<\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroup\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"StringSplit", "@", "formula"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "formula"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"formula", "[", 
         RowBox[{"[", "sub", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{"Flatten", "@", "formula"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"F", 
       RowBox[{".4", ".", " ", "Loop"}], " ", "for", " ", "formatting", " ", 
       "the", " ", "chemical", " ", "formula"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<FormatFormula\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AnyTrue", "[", 
        RowBox[{"formula", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}], "&"}]}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l", ",", "r"}], "}"}], "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"StringPosition", "[", "\[IndentingNewLine]", 
             RowBox[{"formula", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_"}], "}"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"checkParentheses", "=", "True"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"chemicalformula", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"StringCases", "[", 
           RowBox[{
            RowBox[{"formula", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"x", ":", 
               RowBox[{"LetterCharacter", ".."}]}], "~~", 
              "\[IndentingNewLine]", 
              RowBox[{"y", ":", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"{", 
                  RowBox[{"DigitCharacter", ",", "\"\<.\>\""}], "}"}], ")"}], 
                ".."}]}]}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"temp", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"chemicalformula", ",", 
            RowBox[{"formula", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"temp", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<1\>\""}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"chemicalformula", ",", 
            RowBox[{"temp", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "True", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"chemicalformula", ",", 
            RowBox[{"left", "<>", 
             RowBox[{"temp", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<>", "mid", "<>", 
             RowBox[{"temp", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "<>", "right"}]}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "formula"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"chemicalformula", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"chemicalformula", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Adding", " ", "back", " ", "parentheses"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"checkParentheses", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"chemicalformula", "[", 
          RowBox[{"[", "l", "]"}], "]"}], "=", 
         RowBox[{"\"\<(\>\"", "<>", 
          RowBox[{"chemicalformula", "[", 
           RowBox[{"[", "l", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"chemicalformula", "[", 
          RowBox[{"[", "r", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"chemicalformula", "[", 
           RowBox[{"[", "r", "]"}], "]"}], "<>", "\"\<)\>\""}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"chemicalformula", "=", 
      RowBox[{"StringJoin", "@", "chemicalformula"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"G", ".", " ", "Space"}], " ", "group", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SpaceGroup\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".1", ".", " ", "Prioritised"}], " ", "list", " ", "of", " ", 
       "data", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sgTags", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<_space_group_name_Hall\>\"", ",", "\[IndentingNewLine]", 
        "\"\<_space_group_name_H-M\>\"", ",", "\[IndentingNewLine]", 
        "\"\<_space_group_IT_number\>\"", ",", "\[IndentingNewLine]", 
        "\"\<_symmetry_space_group_name_Hall\>\"", ",", 
        "\[IndentingNewLine]", "\"\<_symmetry_space_group_name_H-M\>\"", ",", 
        "\[IndentingNewLine]", "\"\<_symmetry_Int_Tables_number\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".2", ".", " ", "Extract"}], " ", "space", " ", "group", " ", 
       "sections", " ", "from", " ", "imported", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"import", ",", 
        RowBox[{"Shortest", "[", 
         RowBox[{"sgTags", "~~", "__", "~~", "\"\<loop_\>\""}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "sgData", "]"}], ">", "0"}], ",", 
       RowBox[{"sgData", "=", 
        RowBox[{"sgData", "[", 
         RowBox[{"[", "sub", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"StringTrim", "@", 
       RowBox[{"StringDelete", "[", 
        RowBox[{"sgData", ",", "\"\<loop_\>\""}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".3", ".", " ", "Make"}], " ", "association", " ", "of", " ", 
       "tags", " ", "and", " ", "corresponding", " ", "info"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"sgData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"t", ":", "sgTags"}], "~~", "Whitespace", "~~", 
          RowBox[{"sg", ":", 
           RowBox[{"Shortest", "[", 
            RowBox[{
             RowBox[{"Except", "[", "WhitespaceCharacter", "]"}], "~~", 
             "__"}], "]"}]}], "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<\\n\>\"", ",", "EndOfString"}], "}"}]}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"t", "\[Rule]", "sg"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Flatten", "@", "sgData"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sgData", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"sgData", ",", "\"\<?\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".4", ".", " ", "Go"}], " ", "through", " ", "priority", " ", 
       "order", " ", "and", " ", "validate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"sgData", "[", 
          RowBox[{"sgTags", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"Quiet", "@", 
          RowBox[{"InputCheck", "[", 
           RowBox[{"sg", ",", "\"\<InterpretSpaceGroup\>\"", ",", "False"}], 
           "]"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sg", "=!=", "Null"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "sgTags"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"G", 
       RowBox[{".5", ".", " ", "For"}], " ", "modulated", " ", "structures"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sg", "===", "Null"}], "&&", "modulationQ"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"import", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "\"\<_space_group_ssg_name\>\"", "~~", "Whitespace", "~~", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", "sg__",
              "~~", 
             RowBox[{"{", 
              RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
             "\"\<\\n\>\""}], "\[RuleDelayed]", "sg"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"sg", ",", 
           RowBox[{
            RowBox[{"Shortest", "[", 
             RowBox[{"StartOfString", "~~", "___", "\[IndentingNewLine]", "~~", 
              RowBox[{"sg", ":", 
               RowBox[{"(", 
                RowBox[{"LetterCharacter", "~~", "__"}], ")"}]}], "~~", 
              "\"\<(\>\""}], "]"}], "\[RuleDelayed]", "sg"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sg", "=!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"sg", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"InputCheck", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"Flatten", "@", "sg"}]}], ",", 
              "\"\<InterpretSpaceGroup\>\"", ",", "False"}], "]"}]}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"G", 
        RowBox[{".6", ".", " ", "If"}], " ", "missing", " ", "space", " ", 
        "group"}], ",", " ", 
       RowBox[{"display", " ", "message", " ", "and", " ", 
        RowBox[{"use", " ", "'"}], 
        RowBox[{"P1", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "Null"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ImportCrystalData", "::", "SG"}], "]"}], ";", 
        RowBox[{"sg", "=", "\"\<P1\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"H", ".", " ", "Adding"}], " ", "item", " ", "to", " ", 
       "dataset", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"#", "\[Rule]", 
           RowBox[{"OptionValue", "[", "#", "]"}]}], ",", "String"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"First", "/@", 
         RowBox[{"Options", "@", "ImportCrystalData"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ImportCrystalData", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "name", ",", "chemicalformula", ",", "Z", ",", "sg", ",", 
         "\[Lambda]"}], "}"}], ",", "\[IndentingNewLine]", "cell", ",", 
       "atomoverview", ",", "\[IndentingNewLine]", "options"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.681837686555131*^9, 3.681837715873535*^9}, {
   3.681877151035359*^9, 3.681877151857564*^9}, {3.681877348954164*^9, 
   3.681877351369781*^9}, {3.6819101014855537`*^9, 3.681910102580982*^9}, {
   3.681910388849527*^9, 3.681910408879343*^9}, {3.68191049699089*^9, 
   3.681910537526072*^9}, 3.681911688964922*^9, {3.681911786680073*^9, 
   3.68191179058315*^9}, {3.6819118723996363`*^9, 3.681911873844613*^9}, {
   3.6819140964123163`*^9, 3.681914157322269*^9}, {3.681914205795579*^9, 
   3.681914208330812*^9}, {3.6819143084716177`*^9, 3.681914309199279*^9}, {
   3.681915194701557*^9, 3.68191521259623*^9}, {3.681915428641061*^9, 
   3.6819154541920223`*^9}, {3.681915508982588*^9, 3.6819155187349586`*^9}, {
   3.6819168348799667`*^9, 3.681916852300927*^9}, {3.681916888900612*^9, 
   3.6819168922893877`*^9}, {3.6820739592699213`*^9, 3.682073996952688*^9}, {
   3.682077463877149*^9, 3.6820776052573*^9}, {3.6820776372594213`*^9, 
   3.682077686799657*^9}, {3.682082418603697*^9, 3.682082430746922*^9}, {
   3.682082519458561*^9, 3.682082521010309*^9}, {3.682082595976618*^9, 
   3.682082596294907*^9}, {3.6820837443110313`*^9, 3.682083747517606*^9}, {
   3.682085086096871*^9, 3.682085095360746*^9}, 3.682085308263221*^9, {
   3.682100925090796*^9, 3.682100925856657*^9}, {3.682101196995595*^9, 
   3.68210120054681*^9}, {3.682102829546782*^9, 3.682102838691023*^9}, {
   3.682102904632976*^9, 3.68210290614216*^9}, {3.6821029535021467`*^9, 
   3.68210296190212*^9}, {3.6821774013515873`*^9, 3.6821774370058517`*^9}, {
   3.682177563252334*^9, 3.6821775661249437`*^9}, {3.682177600506325*^9, 
   3.682177656459094*^9}, {3.682177729400577*^9, 3.6821778309729347`*^9}, {
   3.6821779750759077`*^9, 3.6821780129943647`*^9}, {3.682178072320471*^9, 
   3.682178073136857*^9}, {3.682214729418475*^9, 3.68221473007382*^9}, {
   3.682214797329495*^9, 3.682214821071869*^9}, {3.682677055762129*^9, 
   3.682677082149714*^9}, {3.682832420816259*^9, 3.682832449368558*^9}, {
   3.682832537779292*^9, 3.682832682693927*^9}, {3.682832735492477*^9, 
   3.682832824132668*^9}, {3.6828328598467293`*^9, 3.682833026767085*^9}, 
   3.682833162444942*^9, {3.682837210396799*^9, 3.6828372402788343`*^9}, 
   3.6828373947973213`*^9, {3.68283759506389*^9, 3.682837664986249*^9}, {
   3.682837709908091*^9, 3.682837753503565*^9}, {3.6828379970329027`*^9, 
   3.682838055525839*^9}, 3.682838232320035*^9, {3.682838429627843*^9, 
   3.682838434879648*^9}, {3.682838593168171*^9, 3.682838596462935*^9}, {
   3.682838879126762*^9, 3.6828390199199743`*^9}, {3.682839067845223*^9, 
   3.682839077317922*^9}, {3.682839121979623*^9, 3.682839223955677*^9}, {
   3.6828393367109547`*^9, 3.682839338923073*^9}, 3.682839501563301*^9, {
   3.6828417490831413`*^9, 3.682841811537655*^9}, {3.682842027045608*^9, 
   3.6828420299735603`*^9}, {3.682842258778105*^9, 3.682842282884631*^9}, {
   3.683459177108799*^9, 3.683459293968474*^9}, {3.6834593554150763`*^9, 
   3.683459366581719*^9}, {3.6834598133851852`*^9, 3.683459848895413*^9}, {
   3.683459997268997*^9, 3.6834600067561207`*^9}, {3.6835293248460393`*^9, 
   3.683529326321478*^9}, {3.6835294138321333`*^9, 3.6835295044250803`*^9}, {
   3.683537492652543*^9, 3.68353749405657*^9}, {3.683537541824689*^9, 
   3.6835375782357893`*^9}, {3.683537711555953*^9, 3.683537794377946*^9}, {
   3.683537977977876*^9, 3.683537990192911*^9}, {3.6835380313465023`*^9, 
   3.6835380750741434`*^9}, {3.683538285553391*^9, 3.6835383618232574`*^9}, {
   3.6835383921034403`*^9, 3.6835383922126417`*^9}, {3.6835385237387714`*^9, 
   3.683538644173087*^9}, {3.683538876743412*^9, 3.6835388845745115`*^9}, {
   3.683539294421953*^9, 3.683539430798027*^9}, 3.6835395063385925`*^9, {
   3.683539599016776*^9, 3.683539607581341*^9}, {3.683539676599069*^9, 
   3.6835396785491066`*^9}, {3.6835397231971655`*^9, 3.683539733087755*^9}, {
   3.683540253168607*^9, 3.6835404587493606`*^9}, {3.6835404930700207`*^9, 
   3.6835404965800877`*^9}, {3.683540560868924*^9, 3.6835405975523753`*^9}, {
   3.6835406619192133`*^9, 3.6835407044144306`*^9}, 3.683541270345587*^9, {
   3.68354135218476*^9, 3.6835414187044396`*^9}, {3.6835414565975685`*^9, 
   3.683541461776868*^9}, {3.683541917711236*^9, 3.6835419313458977`*^9}, 
   3.6835422222290916`*^9, {3.683572964384384*^9, 3.683572966999359*^9}, {
   3.6835730541015053`*^9, 3.683573069879159*^9}, {3.683573103784048*^9, 
   3.683573132220851*^9}, {3.68357317178211*^9, 3.683573226507544*^9}, {
   3.68357326053117*^9, 3.683573653411612*^9}, {3.683573688834921*^9, 
   3.6835737835140333`*^9}, {3.683573824322988*^9, 3.6835738252471046`*^9}, {
   3.683595424868795*^9, 3.683595451786187*^9}, {3.683595483733911*^9, 
   3.683595484340826*^9}, {3.6835955910574837`*^9, 3.6835956274016047`*^9}, {
   3.683595762457136*^9, 3.683595797136365*^9}, {3.683595846224218*^9, 
   3.683596001170824*^9}, {3.6835960422674*^9, 3.6835960891762123`*^9}, {
   3.6835962378875504`*^9, 3.6835962484282827`*^9}, {3.683596395857547*^9, 
   3.6835966353910303`*^9}, {3.683596898118559*^9, 3.683596901156117*^9}, {
   3.683596978213135*^9, 3.6835970018659067`*^9}, {3.683597032809555*^9, 
   3.6835970665686617`*^9}, {3.68359712696749*^9, 3.6835971278314257`*^9}, {
   3.683597176550775*^9, 3.68359717787001*^9}, {3.68359720886909*^9, 
   3.683597216597783*^9}, {3.6835972585402813`*^9, 3.6835972594512873`*^9}, {
   3.68359730637988*^9, 3.68359732121716*^9}, {3.683597369010441*^9, 
   3.6835974243989*^9}, {3.683597489283207*^9, 3.6835974932304993`*^9}, {
   3.6835975761879187`*^9, 3.683597578756028*^9}, {3.683597619308737*^9, 
   3.683597743987504*^9}, 3.683598235040094*^9, {3.683598338929348*^9, 
   3.683598413911125*^9}, {3.68359850546655*^9, 3.683598562786562*^9}, {
   3.683600135064497*^9, 3.6836001441563673`*^9}, 3.683600190405829*^9, {
   3.683600223266963*^9, 3.68360022351584*^9}, {3.683861653697109*^9, 
   3.6838617583709097`*^9}, {3.6838617890837097`*^9, 3.68386180051851*^9}, {
   3.6838720230872736`*^9, 3.6838721491664743`*^9}, {3.6838722337964754`*^9, 
   3.6838723530428762`*^9}, {3.683872389047676*^9, 3.683872467032077*^9}, {
   3.68387824945021*^9, 3.68387825924701*^9}, {3.6838782937698097`*^9, 
   3.6838783371378107`*^9}, {3.683878387057811*^9, 3.6838784373210115`*^9}, {
   3.683878666485012*^9, 3.6838787350002127`*^9}, {3.683879405377817*^9, 
   3.6838794279042177`*^9}, {3.6838794682146177`*^9, 3.683879531597418*^9}, {
   3.6838823679725337`*^9, 3.683882399500134*^9}, {3.683882440028934*^9, 
   3.683882440200534*^9}, {3.68388345639794*^9, 3.68388345794234*^9}, {
   3.683883545037141*^9, 3.683883563881941*^9}, {3.6838843089223456`*^9, 
   3.6838843101859455`*^9}, {3.6838846093375473`*^9, 
   3.6838846380259476`*^9}, {3.6838847150743484`*^9, 3.683884738474348*^9}, {
   3.683884796022749*^9, 3.683884836645149*^9}, {3.683884879498349*^9, 
   3.6838848901375494`*^9}, {3.68388495205395*^9, 3.68388501010155*^9}, {
   3.68388504030315*^9, 3.68388504270555*^9}, 3.6838850989123507`*^9, {
   3.683885198268751*^9, 3.683885218689152*^9}, {3.683912883065785*^9, 
   3.683912893756435*^9}, {3.683913100428589*^9, 3.6839131623230047`*^9}, {
   3.6839132253230247`*^9, 3.6839132395051737`*^9}, {3.683913537550117*^9, 
   3.68391355671695*^9}, {3.683914614791511*^9, 3.683914615884431*^9}, {
   3.683914757414419*^9, 3.683914851565317*^9}, {3.683914963356751*^9, 
   3.683915043562475*^9}, {3.6839150884529943`*^9, 3.68391514006312*^9}, {
   3.683915261541957*^9, 3.683915267605801*^9}, {3.683915370843563*^9, 
   3.683915373148366*^9}, {3.6839154629056883`*^9, 3.683915465520754*^9}, {
   3.683916066162204*^9, 3.683916209881385*^9}, {3.683916242403504*^9, 
   3.68391624273678*^9}, {3.68391631311016*^9, 3.683916315029543*^9}, {
   3.683916417398801*^9, 3.683916493270235*^9}, 3.683916540969326*^9, {
   3.6839165797143183`*^9, 3.683916597561346*^9}, {3.683916669848016*^9, 
   3.6839166878486032`*^9}, {3.683916731510866*^9, 3.6839167406461277`*^9}, {
   3.683916779525547*^9, 3.683916810603664*^9}, {3.683916856013338*^9, 
   3.683916880227283*^9}, {3.683916915864532*^9, 3.6839169239385757`*^9}, {
   3.683916981905188*^9, 3.683917053855734*^9}, 3.683917085238093*^9, {
   3.683917117406871*^9, 3.683917155940662*^9}, {3.683917254301112*^9, 
   3.683917322640829*^9}, {3.683917369048996*^9, 3.6839173725287027`*^9}, {
   3.683945926436631*^9, 3.683945951299859*^9}, {3.6839460310261507`*^9, 
   3.683946039878233*^9}, {3.683946754408388*^9, 3.683946763862039*^9}, {
   3.683946855058311*^9, 3.6839468559487123`*^9}, {3.683946888930604*^9, 
   3.6839468916350193`*^9}, {3.683965973504136*^9, 3.683965981803792*^9}, {
   3.6839660266131144`*^9, 3.6839660635760393`*^9}, {3.683966150618153*^9, 
   3.68396615989508*^9}, {3.683966552362355*^9, 3.683966630751149*^9}, {
   3.683966716879807*^9, 3.6839667201718407`*^9}, {3.683966814971418*^9, 
   3.683966816827961*^9}, {3.6839670871586246`*^9, 3.683967092940967*^9}, {
   3.6839672384469957`*^9, 3.683967264565357*^9}, {3.68396731494932*^9, 
   3.6839673155162992`*^9}, {3.6839675945381927`*^9, 
   3.6839676210608873`*^9}, {3.683967653597517*^9, 3.683967667282453*^9}, {
   3.683967706895344*^9, 3.68396783896605*^9}, {3.683967886281891*^9, 
   3.683967890763636*^9}, {3.6839680655577517`*^9, 3.683968086932863*^9}, {
   3.6840603924630165`*^9, 3.684060392650216*^9}, {3.6840604459398165`*^9, 
   3.6840604461270165`*^9}, {3.684060758127019*^9, 3.6840607719330187`*^9}, {
   3.684091108204876*^9, 3.684091109186337*^9}, {3.6840912297215223`*^9, 
   3.684091257151688*^9}, {3.684091304149659*^9, 3.6840913743737698`*^9}, {
   3.684091528500297*^9, 3.684091546612001*^9}, {3.6840916760088882`*^9, 
   3.684091710208632*^9}, {3.684091779365342*^9, 3.6840917872010107`*^9}, {
   3.6840918193186693`*^9, 3.684091822997663*^9}, {3.6840920204991217`*^9, 
   3.684092027753368*^9}, {3.684092242821933*^9, 3.68409224877349*^9}, {
   3.684092375853321*^9, 3.684092446402137*^9}, {3.684092529479371*^9, 
   3.684092601541663*^9}, {3.684092631976705*^9, 3.684092706444932*^9}, {
   3.684122583204362*^9, 3.684122583338593*^9}, {3.684122617769887*^9, 
   3.6841226326425533`*^9}, {3.684122842850892*^9, 3.6841228803670053`*^9}, 
   3.684662456408539*^9, {3.685083215676849*^9, 3.685083225479327*^9}, {
   3.685273842160692*^9, 3.685273843369611*^9}, 3.6852859866984377`*^9, {
   3.6852865797565203`*^9, 3.6852867418301563`*^9}, {3.68528678670284*^9, 
   3.685286837658393*^9}, {3.6852876402392797`*^9, 3.68528764082928*^9}, {
   3.685287686672612*^9, 3.6852877328345823`*^9}, 3.685288359599786*^9, {
   3.685288405265378*^9, 3.685288413567605*^9}, {3.685288460159389*^9, 
   3.6852885790055923`*^9}, {3.685288768401976*^9, 3.685288776719144*^9}, {
   3.6852888594727592`*^9, 3.685288869167355*^9}, {3.6852889018778133`*^9, 
   3.685288928989695*^9}, {3.685289137837894*^9, 3.685289156578895*^9}, {
   3.6852893298741426`*^9, 3.685289339184761*^9}, {3.6852894371950483`*^9, 
   3.685289490675153*^9}, {3.685289568013756*^9, 3.685289576976079*^9}, {
   3.685289608357773*^9, 3.685289658711172*^9}, {3.685289735218001*^9, 
   3.6852898069422903`*^9}, {3.685289930471755*^9, 3.6852900810382442`*^9}, {
   3.685290184784808*^9, 3.685290208077758*^9}, {3.685290251165133*^9, 
   3.685290252421399*^9}, {3.68529039678588*^9, 3.685290434036058*^9}, {
   3.6852905616198597`*^9, 3.685290648834957*^9}, {3.685290772225479*^9, 
   3.6852908445314827`*^9}, {3.685290944529559*^9, 3.685290945406761*^9}, {
   3.6852994143987617`*^9, 3.6852994382525454`*^9}, {3.685299497976466*^9, 
   3.685299503829215*^9}, {3.6852995392171392`*^9, 3.685299553596043*^9}, {
   3.685299992582048*^9, 3.685300067802575*^9}, {3.685300115636456*^9, 
   3.6853001652887*^9}, {3.685857413666704*^9, 3.685857416648685*^9}, {
   3.685857458690517*^9, 3.685857460318738*^9}, {3.685857739673769*^9, 
   3.685857804387884*^9}, {3.685858053804237*^9, 3.685858097255934*^9}, {
   3.685858148189295*^9, 3.685858151202751*^9}, {3.6858582764177513`*^9, 
   3.685858278372242*^9}, {3.685858315119955*^9, 3.685858329069948*^9}, {
   3.6858583599842167`*^9, 3.685858443918298*^9}, {3.685858474929714*^9, 
   3.685858549786276*^9}, {3.685858646044956*^9, 3.685858729439179*^9}, {
   3.685858780464095*^9, 3.6858588174599037`*^9}, {3.6858588495554333`*^9, 
   3.685858854343585*^9}, {3.685858884851486*^9, 3.685858951983511*^9}, {
   3.6858589994260674`*^9, 3.685859010716827*^9}, {3.6858590913432503`*^9, 
   3.6858590933696404`*^9}, {3.6858591266083927`*^9, 3.685859175567238*^9}, 
   3.6858592443417377`*^9, {3.685859293152143*^9, 3.685859295503252*^9}, {
   3.685859355430237*^9, 3.685859372237409*^9}, {3.685859410728088*^9, 
   3.685859590839635*^9}, {3.685859820712883*^9, 3.685859834624839*^9}, {
   3.685859901734437*^9, 3.685859903978137*^9}, {3.685860388384758*^9, 
   3.685860416754836*^9}, {3.6858604795627413`*^9, 3.685860511227654*^9}, {
   3.685860553637973*^9, 3.685860566610154*^9}, {3.685860914338649*^9, 
   3.685860923340206*^9}, {3.6858609596753263`*^9, 3.685861032397937*^9}, {
   3.685861066897966*^9, 3.685861207437435*^9}, {3.685861269462768*^9, 
   3.685861333954526*^9}, {3.68586136454725*^9, 3.685861474318748*^9}, {
   3.685861517225202*^9, 3.685861630127417*^9}, 3.686539654224182*^9, {
   3.6865404731983*^9, 3.686540476632311*^9}, {3.686540838010448*^9, 
   3.6865408409572363`*^9}, {3.6865408783411818`*^9, 
   3.6865409309172087`*^9}, {3.6865410083871517`*^9, 3.686541019566337*^9}, {
   3.686541108523757*^9, 3.6865411160838137`*^9}, {3.686541345632307*^9, 
   3.6865413786757183`*^9}, {3.686541414671311*^9, 3.6865414232386217`*^9}, {
   3.686542165948737*^9, 3.686542250863388*^9}, {3.686542299286373*^9, 
   3.686542419483355*^9}, {3.686542765365814*^9, 3.686542896718195*^9}, {
   3.6865429651805696`*^9, 3.686542994361959*^9}, {3.686543052880053*^9, 
   3.68654308126692*^9}, {3.686543188486841*^9, 3.686543246136475*^9}, {
   3.686543277183275*^9, 3.686543354140892*^9}, {3.6865439221051064`*^9, 
   3.6865439500516567`*^9}, {3.686543985426251*^9, 3.6865439866119337`*^9}, {
   3.686545075225861*^9, 3.686545085996263*^9}, {3.686545142403131*^9, 
   3.686545154301223*^9}, {3.686545598710578*^9, 3.686545685031988*^9}, {
   3.686545806504096*^9, 3.686545808221018*^9}, {3.686545843613908*^9, 
   3.686545858760723*^9}, {3.6865468611972027`*^9, 3.686546864228973*^9}, {
   3.686547018082903*^9, 3.686547062903644*^9}, {3.686547103018654*^9, 
   3.6865472172532377`*^9}, {3.686547286632975*^9, 3.6865473094649553`*^9}, {
   3.68654734925193*^9, 3.686547436898713*^9}, {3.68654749370965*^9, 
   3.686547528959359*^9}, {3.6865475636469088`*^9, 3.686547609057955*^9}, {
   3.686547718709216*^9, 3.6865477759813023`*^9}, {3.686547826737184*^9, 
   3.6865480149557037`*^9}, {3.686548045811688*^9, 3.6865480534768553`*^9}, {
   3.686548358608864*^9, 3.6865483707973957`*^9}, {3.686548545229116*^9, 
   3.686548549254797*^9}, {3.686548686552582*^9, 3.686548712479574*^9}, {
   3.686548761541046*^9, 3.686548806149107*^9}, {3.686548844469076*^9, 
   3.6865488456614323`*^9}, {3.6865512672815323`*^9, 3.686551349772369*^9}, {
   3.686551394491152*^9, 3.686551419220949*^9}, {3.68655189093897*^9, 
   3.686551964617752*^9}, {3.686552125034718*^9, 3.686552127678214*^9}, {
   3.686552278738872*^9, 3.686552288051901*^9}, {3.6865525035827713`*^9, 
   3.6865525526784353`*^9}, {3.686552735101828*^9, 3.686552795442685*^9}, {
   3.686628436474517*^9, 3.686628536322258*^9}, {3.68662881083289*^9, 
   3.686628821580617*^9}, {3.686628873638318*^9, 3.686628910585565*^9}, {
   3.686628983168025*^9, 3.686628993135873*^9}, {3.6866290244093027`*^9, 
   3.686629036936223*^9}, {3.6866293771745977`*^9, 3.686629573836637*^9}, {
   3.686629642177215*^9, 3.686629642772787*^9}, {3.6866297243246927`*^9, 
   3.6866297671380577`*^9}, {3.68662980589575*^9, 3.686629921941725*^9}, {
   3.6866301477171917`*^9, 3.6866302198000402`*^9}, {3.686631051792659*^9, 
   3.686631052244384*^9}, {3.686631154483254*^9, 3.6866311697969627`*^9}, {
   3.686631263333723*^9, 3.686631263601918*^9}, {3.68663139867869*^9, 
   3.686631404581489*^9}, {3.686632984962451*^9, 3.686633004174432*^9}, {
   3.686633061394642*^9, 3.686633130346314*^9}, 3.68663316413481*^9, {
   3.686633214954659*^9, 3.686633436141959*^9}, {3.686633467345083*^9, 
   3.6866334864811068`*^9}, {3.686633732074704*^9, 3.686633950675581*^9}, {
   3.6866339912854033`*^9, 3.6866340595716867`*^9}, {3.686634611539404*^9, 
   3.686634722427601*^9}, {3.686634814350337*^9, 3.686634814637828*^9}, {
   3.686634848303295*^9, 3.686634860468422*^9}, {3.686634959197269*^9, 
   3.686635026207364*^9}, {3.68663506717763*^9, 3.6866350677294807`*^9}, {
   3.686635268873169*^9, 3.686635270603788*^9}, {3.68663534659659*^9, 
   3.6866353696721687`*^9}, {3.686635471413412*^9, 3.686635473760983*^9}, {
   3.6866356402250023`*^9, 3.686635644442481*^9}, {3.686635679985345*^9, 
   3.686635680347102*^9}, {3.686635843450626*^9, 3.686635908529458*^9}, {
   3.686635953810897*^9, 3.6866359950759563`*^9}, {3.686636042815072*^9, 
   3.6866360445918283`*^9}, {3.686636224007688*^9, 3.686636234413014*^9}, {
   3.6866363817222557`*^9, 3.6866363842471933`*^9}, {3.686636486734826*^9, 
   3.686636604026161*^9}, {3.686636645111916*^9, 3.6866366626343937`*^9}, {
   3.6866368484698067`*^9, 3.6866368552832947`*^9}, {3.686636984722148*^9, 
   3.686637049101089*^9}, {3.6866375767735558`*^9, 3.686637597148796*^9}, {
   3.686637631857192*^9, 3.686637660318914*^9}, 3.686637776999043*^9, 
   3.6866378241871567`*^9, {3.686638044023232*^9, 3.6866380683314543`*^9}, {
   3.686648571674737*^9, 3.686648590586588*^9}, {3.686648644103341*^9, 
   3.686648699630372*^9}, {3.6866488318241167`*^9, 3.686648927329699*^9}, {
   3.686649011926078*^9, 3.686649017761073*^9}, 3.6866490558613367`*^9, {
   3.686649180311656*^9, 3.686649237585517*^9}, {3.686649268341486*^9, 
   3.686649299889591*^9}, 3.686649347683876*^9, 3.6866493803691263`*^9, {
   3.686649421883061*^9, 3.686649452018013*^9}, {3.68664949952623*^9, 
   3.686649514816061*^9}, {3.686649598044321*^9, 3.6866496640735693`*^9}, {
   3.6866499742318172`*^9, 3.686650012613455*^9}, {3.68665014714787*^9, 
   3.686650168490876*^9}, {3.686653129809244*^9, 3.686653140923666*^9}, 
   3.686653171799799*^9, {3.686653203816307*^9, 3.686653397228634*^9}, {
   3.686653465870021*^9, 3.686653466088895*^9}, {3.6866591193849993`*^9, 
   3.6866591352071877`*^9}, {3.6866591837970877`*^9, 3.686659210764454*^9}, {
   3.690874230627651*^9, 3.690874268469171*^9}, {3.69087456514154*^9, 
   3.690874571118001*^9}, {3.690874767574018*^9, 3.690874860731365*^9}, {
   3.690875040950881*^9, 3.6908750514047613`*^9}, {3.690875087293241*^9, 
   3.69087508958405*^9}, {3.6908751460732193`*^9, 3.690875201464147*^9}, {
   3.690875238324142*^9, 3.690875244244442*^9}, {3.690875332110111*^9, 
   3.690875363938733*^9}, {3.690875479188937*^9, 3.690875485268502*^9}, 
   3.690875705424657*^9, {3.6908757446717033`*^9, 3.6908757566453743`*^9}, {
   3.690876018113851*^9, 3.690876090202244*^9}, {3.690876130301553*^9, 
   3.6908761305931997`*^9}, {3.6908777563640127`*^9, 3.690877779628961*^9}, 
   3.690877827070587*^9, {3.690877871694067*^9, 3.690877874641543*^9}, {
   3.69087798628898*^9, 3.6908779879454107`*^9}, {3.6908781424130697`*^9, 
   3.6908781425572853`*^9}, {3.6908803713150663`*^9, 3.690880375245215*^9}, {
   3.690880409207288*^9, 3.690880410842257*^9}, {3.690880443383237*^9, 
   3.6908804962567787`*^9}, {3.6908805517361307`*^9, 3.690880564888294*^9}, {
   3.69088101790664*^9, 3.690881022556374*^9}, {3.690881227807176*^9, 
   3.690881275933888*^9}, {3.690881502287149*^9, 3.690881522253579*^9}, {
   3.6908815757498693`*^9, 3.690881595413355*^9}, {3.690881689977112*^9, 
   3.69088169272445*^9}, {3.690881823214643*^9, 3.69088186786427*^9}, {
   3.690881955183896*^9, 3.690881961966961*^9}, {3.690881998162924*^9, 
   3.6908820032421503`*^9}, {3.690882071583241*^9, 3.6908821174670258`*^9}, {
   3.6908824066073523`*^9, 3.690882492658814*^9}, {3.690882526130692*^9, 
   3.690882543146225*^9}, {3.690882573247946*^9, 3.6908826192923326`*^9}, {
   3.690882691946703*^9, 3.6908827488378057`*^9}, {3.690883257173853*^9, 
   3.690883258024938*^9}, 3.690883321343444*^9, {3.6908834730530787`*^9, 
   3.690883505616665*^9}, {3.690883586666316*^9, 3.690883587886053*^9}, {
   3.690883726732333*^9, 3.690883730635768*^9}, {3.6908847416899967`*^9, 
   3.690884800086941*^9}, {3.690884833588965*^9, 3.690884846707543*^9}, {
   3.690884956325741*^9, 3.690884960595014*^9}, {3.6908851561812887`*^9, 
   3.690885159020203*^9}, {3.6908851897244253`*^9, 3.690885201131942*^9}, {
   3.690885272446883*^9, 3.6908852729055567`*^9}, {3.6908859970913353`*^9, 
   3.6908859977945843`*^9}, {3.6908861081770906`*^9, 
   3.6908862090540743`*^9}, {3.6908862482401733`*^9, 3.690886364363151*^9}, {
   3.690886399985446*^9, 3.690886400137809*^9}, {3.6908865069000893`*^9, 
   3.6908865110757093`*^9}, {3.690886573914403*^9, 3.690886576086144*^9}, {
   3.6908866803232403`*^9, 3.690886722521126*^9}, {3.690886883712907*^9, 
   3.6908868936917353`*^9}, {3.690886953697514*^9, 3.69088720818289*^9}, {
   3.690887585108078*^9, 3.690887606738702*^9}, {3.690887655800318*^9, 
   3.690887749544612*^9}, {3.6908879194909277`*^9, 3.690888005258441*^9}, {
   3.690888075006751*^9, 3.690888123005012*^9}, {3.690888154107943*^9, 
   3.690888165839559*^9}, {3.6908882161064177`*^9, 3.690888300778494*^9}, {
   3.690888770051404*^9, 3.690888783892008*^9}, {3.6908901458703527`*^9, 
   3.69089015758394*^9}, {3.690890191114049*^9, 3.690890310979289*^9}, {
   3.690890370799263*^9, 3.6908904356941547`*^9}, {3.6908905934376993`*^9, 
   3.690890698958642*^9}, {3.690890731521749*^9, 3.690890737003929*^9}, {
   3.690890771478266*^9, 3.690890787306638*^9}, {3.6908910420417356`*^9, 
   3.690891074213822*^9}, {3.690891258425971*^9, 3.690891490528727*^9}, {
   3.690891524491589*^9, 3.690891537510817*^9}, {3.690891574588409*^9, 
   3.6908916135805607`*^9}, {3.690891651212935*^9, 3.69089166958366*^9}, {
   3.705028644018639*^9, 3.705028647599525*^9}, {3.705029101172365*^9, 
   3.705029107290732*^9}, {3.705029149528407*^9, 3.705029166206131*^9}, {
   3.7050292214937363`*^9, 3.705029222428486*^9}, {3.705029256554995*^9, 
   3.7050292575576143`*^9}, {3.705029316649047*^9, 3.705029347147097*^9}, {
   3.705379984089679*^9, 3.7053800543548393`*^9}, {3.705380095250505*^9, 
   3.705380108115614*^9}, 3.705380148169414*^9, {3.70538019683451*^9, 
   3.705380213095047*^9}, {3.7053804166764708`*^9, 3.7053804402345467`*^9}, {
   3.705380566776813*^9, 3.705380576521379*^9}, {3.705380611345931*^9, 
   3.705380640053465*^9}, {3.705380722618957*^9, 3.7053807433800993`*^9}, {
   3.705380799464793*^9, 3.7053808012668877`*^9}, {3.70538083355977*^9, 
   3.7053808588703537`*^9}, {3.705380894266776*^9, 3.705380895503932*^9}, {
   3.705381058358472*^9, 3.705381065358697*^9}, {3.705381102219154*^9, 
   3.705381105719275*^9}, {3.7053811558848658`*^9, 3.705381277348399*^9}, {
   3.705381974474321*^9, 3.705382003060091*^9}, {3.70538203810003*^9, 
   3.7053820411788607`*^9}, {3.705382108889456*^9, 3.7053821467573442`*^9}, {
   3.7053821786248293`*^9, 3.705382179617531*^9}, {3.705382481290308*^9, 
   3.705382522062904*^9}, {3.7053825535503798`*^9, 3.705382555679167*^9}, {
   3.705382630831314*^9, 3.705382708240117*^9}, {3.705383207993224*^9, 
   3.705383246279758*^9}, {3.7053833306512327`*^9, 3.705383407796979*^9}, {
   3.7053834552078743`*^9, 3.705383537800829*^9}, {3.705384029774302*^9, 
   3.7053840422253847`*^9}, {3.705384123564886*^9, 3.705384143090168*^9}, {
   3.705384309537613*^9, 3.7053843356127777`*^9}, {3.705384405334144*^9, 
   3.705384495729072*^9}, {3.705384623715996*^9, 3.7053846592758636`*^9}, {
   3.711351111770576*^9, 3.711351113856388*^9}, {3.711351145943018*^9, 
   3.711351152774556*^9}, {3.711352489546802*^9, 3.7113524914060583`*^9}, {
   3.711352591876399*^9, 3.711352760371176*^9}, {3.711352795505945*^9, 
   3.7113528061494007`*^9}, {3.711352946687026*^9, 3.711352947992275*^9}, {
   3.711872206103055*^9, 3.711872263469742*^9}, {3.711872332850672*^9, 
   3.711872333104144*^9}, {3.712038639037058*^9, 3.712038722071074*^9}, {
   3.712039155304579*^9, 3.712039158509935*^9}, {3.712039224408853*^9, 
   3.712039251439427*^9}, 3.712039316350741*^9, {3.712039482613575*^9, 
   3.7120395129520063`*^9}, {3.712039594482299*^9, 3.712039605579571*^9}, 
   3.712039718787567*^9, {3.712039758887706*^9, 3.7120397888413477`*^9}, {
   3.712041870075758*^9, 3.712041943264638*^9}, {3.712042231432576*^9, 
   3.712042273473843*^9}, {3.712042360001617*^9, 3.71204237737145*^9}, {
   3.7120424364915*^9, 3.712042501698626*^9}, {3.7120431096884727`*^9, 
   3.712043171911232*^9}, {3.712476026225499*^9, 3.712476051024411*^9}, 
   3.712476100775619*^9, {3.712476645729344*^9, 3.712476702921423*^9}, {
   3.712476737449065*^9, 3.712476758588127*^9}, {3.712476821297773*^9, 
   3.712476831624687*^9}, {3.712478672953239*^9, 3.712478687162466*^9}, {
   3.71247877161519*^9, 3.7124788849639*^9}, {3.71247892120807*^9, 
   3.712479085521503*^9}, 3.712479672963057*^9, 3.712479765712575*^9, {
   3.712479876872574*^9, 3.712479903650322*^9}, {3.71247996505613*^9, 
   3.712479966003675*^9}, {3.712480117261688*^9, 3.712480119698488*^9}, {
   3.712482156061984*^9, 3.71248216501117*^9}, {3.712482757208851*^9, 
   3.712482776726468*^9}, {3.712483335793894*^9, 3.712483376257092*^9}, {
   3.712483534540847*^9, 3.712483585245718*^9}, {3.712554043916257*^9, 
   3.71255407205492*^9}, {3.7125541494405003`*^9, 3.712554259995756*^9}, {
   3.7143644954690237`*^9, 3.714364498620454*^9}, {3.714364530650523*^9, 
   3.714364532234413*^9}, {3.7143646331374283`*^9, 3.714364648867915*^9}, {
   3.714365035935523*^9, 3.714365068184824*^9}, {3.7143652039844503`*^9, 
   3.714365213251802*^9}, {3.714365295999627*^9, 3.7143653030948477`*^9}, {
   3.7143657521081333`*^9, 3.714365762242819*^9}, {3.714366393814814*^9, 
   3.714366419913129*^9}, {3.714366466477858*^9, 3.714366467674356*^9}, {
   3.714366501937438*^9, 3.714366505723628*^9}, {3.714367167021729*^9, 
   3.71436740245326*^9}, {3.71436784827663*^9, 3.71436790164959*^9}, {
   3.714368199518496*^9, 3.714368219341834*^9}, {3.714371806450234*^9, 
   3.7143718693604507`*^9}, {3.714382063322034*^9, 3.7143820825814953`*^9}, {
   3.714382171958996*^9, 3.714382227738618*^9}, {3.7143822632015457`*^9, 
   3.714382264865775*^9}, {3.714382426612254*^9, 3.714382427651102*^9}, {
   3.714382513226758*^9, 3.714382549358738*^9}, {3.714382765216748*^9, 
   3.71438278235201*^9}, {3.714382814153933*^9, 3.714382877397443*^9}, {
   3.714382914463346*^9, 3.7143829604795856`*^9}, {3.7143830031041183`*^9, 
   3.714383016857888*^9}, {3.714383452159505*^9, 3.714383452706373*^9}, {
   3.71438357484027*^9, 3.714383576234696*^9}, {3.7143842702358847`*^9, 
   3.7143842886956043`*^9}, {3.714384418210403*^9, 3.714384448154595*^9}, {
   3.714384480836069*^9, 3.7143844888277197`*^9}, {3.714384681093793*^9, 
   3.714384684135685*^9}, {3.714384749336495*^9, 3.714384813372967*^9}, {
   3.714913420900578*^9, 3.714913427072555*^9}, {3.714913637647194*^9, 
   3.714913637787532*^9}, {3.717255063345069*^9, 3.717255067807077*^9}, {
   3.717395044031961*^9, 3.7173950695702343`*^9}, {3.717398264490716*^9, 
   3.717398264834695*^9}, {3.7173982974356413`*^9, 3.71739829773092*^9}, {
   3.7173983312148123`*^9, 3.717398410935465*^9}, {3.7173985489270277`*^9, 
   3.7173985906669397`*^9}, {3.717398663320311*^9, 3.7173986995367126`*^9}, {
   3.717398766756649*^9, 3.7173988344406033`*^9}, 3.71774089699483*^9, {
   3.717942206461034*^9, 3.717942206596238*^9}, {3.718001083421361*^9, 
   3.7180010863717527`*^9}, {3.718001135716935*^9, 3.7180011730042562`*^9}, {
   3.7180012420205603`*^9, 3.718001246082906*^9}, {3.71800131202584*^9, 
   3.718001490297841*^9}, {3.718001758217325*^9, 3.7180017624723253`*^9}, {
   3.7180020086844378`*^9, 3.71800202103938*^9}, {3.7180021208313513`*^9, 
   3.718002138298472*^9}, {3.718002178107481*^9, 3.7180021870757427`*^9}, {
   3.718002278697837*^9, 3.7180022917418327`*^9}, {3.718004011257444*^9, 
   3.718004060306809*^9}, {3.718004178323606*^9, 3.718004200606402*^9}, {
   3.718004231644692*^9, 3.718004294053293*^9}, {3.718004332014246*^9, 
   3.7180043497396603`*^9}, {3.718004412450512*^9, 3.718004595533595*^9}, {
   3.7180050361781807`*^9, 3.718005036907324*^9}, {3.7180052709414*^9, 
   3.7180052733987427`*^9}, {3.718005586792924*^9, 3.7180056075707893`*^9}, {
   3.718005658259408*^9, 3.718005754817443*^9}, {3.71800856463656*^9, 
   3.71800857111441*^9}, {3.718011555406355*^9, 3.7180116436145687`*^9}, {
   3.7180116767277927`*^9, 3.718011716802039*^9}, {3.718011812817415*^9, 
   3.7180119039718733`*^9}, {3.718011946973734*^9, 3.718012009401104*^9}, {
   3.7180123279232197`*^9, 3.7180123303706408`*^9}, {3.71801252154222*^9, 
   3.718012528853718*^9}, {3.718012574849312*^9, 3.718012574966339*^9}, {
   3.718013271916046*^9, 3.7180133097037563`*^9}, {3.718016115636971*^9, 
   3.718016120139029*^9}, 3.718016215078356*^9, {3.718019262481444*^9, 
   3.718019291892578*^9}, {3.718019370276717*^9, 3.718019382214369*^9}, {
   3.7211196117950983`*^9, 3.7211196190156116`*^9}, {3.721119873978917*^9, 
   3.7211199180767117`*^9}, {3.721120069028652*^9, 3.721120086820054*^9}, {
   3.7211203629974737`*^9, 3.721120378086216*^9}, {3.721120546601379*^9, 
   3.721120563053873*^9}, {3.721120663741705*^9, 3.721120766165029*^9}, {
   3.721120876472484*^9, 3.721120891775013*^9}, {3.7264644375260687`*^9, 
   3.7264645036052856`*^9}, {3.726464686640902*^9, 3.726464771880875*^9}, {
   3.7264648643195066`*^9, 3.726464864714224*^9}, {3.726464894788763*^9, 
   3.726464899931055*^9}, {3.726465521020912*^9, 3.7264655296166677`*^9}, {
   3.726465562307811*^9, 3.726465564286838*^9}, {3.7264656031749563`*^9, 
   3.726465603565353*^9}, {3.72646579688305*^9, 3.726465891906356*^9}, {
   3.7264663432198753`*^9, 3.72646636188659*^9}, {3.726466394426621*^9, 
   3.726466397906537*^9}, {3.72646643028502*^9, 3.7264664738672743`*^9}, {
   3.726470472993636*^9, 3.726470659912174*^9}, {3.726470703245821*^9, 
   3.7264708113652277`*^9}, {3.726471139895425*^9, 3.726471141013126*^9}, {
   3.726472819712816*^9, 3.726472845807508*^9}, {3.726472914426814*^9, 
   3.726472989073833*^9}, {3.7264736097205877`*^9, 3.7264736249601183`*^9}, {
   3.726473937644083*^9, 3.7264740296429377`*^9}, {3.726474069875421*^9, 
   3.726474072787526*^9}, {3.726474120797406*^9, 3.726474143959763*^9}, {
   3.726903049806059*^9, 3.7269030547343407`*^9}, {3.726903142272684*^9, 
   3.7269031702654457`*^9}, {3.72690323817605*^9, 3.72690324214952*^9}, {
   3.726904666797345*^9, 3.72690472961802*^9}, {3.72690503908265*^9, 
   3.7269050510823603`*^9}, {3.7269053676492443`*^9, 
   3.7269053707222843`*^9}, {3.726905403463994*^9, 3.7269054117154408`*^9}, {
   3.726905443971477*^9, 3.726905503921131*^9}, {3.727164034637611*^9, 
   3.727164037865155*^9}, {3.7271640764732323`*^9, 3.727164077961165*^9}, {
   3.727164122196415*^9, 3.727164195119008*^9}, {3.72716427909273*^9, 
   3.7271643209900007`*^9}, {3.727164551035019*^9, 3.727164566305697*^9}, {
   3.727164826004902*^9, 3.727164856425762*^9}, {3.727164911864665*^9, 
   3.7271649472276087`*^9}, 3.727165028000827*^9, {3.727165439732793*^9, 
   3.727165443410883*^9}, {3.7271655152345543`*^9, 3.727165518210894*^9}, {
   3.727165612817891*^9, 3.7271656329615726`*^9}, {3.727165667879693*^9, 
   3.727165694496305*^9}, {3.727165734300901*^9, 3.727165734484397*^9}, {
   3.7271657951285973`*^9, 3.727165800373414*^9}, 3.727166507374901*^9, {
   3.727166549641523*^9, 3.7271665498291388`*^9}, {3.727679363556376*^9, 
   3.72767937948258*^9}, {3.730144293448069*^9, 3.730144296917568*^9}, {
   3.73054370707415*^9, 3.730543712122634*^9}, {3.730543761369562*^9, 
   3.730543761517167*^9}, {3.7305443832698298`*^9, 3.730544389970169*^9}, {
   3.7305444347499123`*^9, 3.730544441814794*^9}, {3.7338213833691607`*^9, 
   3.73382142523367*^9}, {3.733821517836343*^9, 3.733821589706148*^9}, {
   3.7340600124562607`*^9, 3.734060063003248*^9}, {3.734060151981092*^9, 
   3.734060191746683*^9}, {3.734060532242168*^9, 3.734060537704068*^9}, {
   3.734060585434946*^9, 3.7340606246327257`*^9}, {3.734061322798773*^9, 
   3.7340613832977667`*^9}, {3.734069414109047*^9, 3.734069418132304*^9}, {
   3.734069680538341*^9, 3.734069682825083*^9}, {3.734069733114378*^9, 
   3.734069767695834*^9}, {3.734070638970187*^9, 3.7340706410756283`*^9}, {
   3.734070708827845*^9, 3.7340707230922327`*^9}, {3.734083757070177*^9, 
   3.734083760402235*^9}, {3.7340840063424*^9, 3.734084006846657*^9}, 
   3.734084066556363*^9, {3.7340842329062567`*^9, 3.7340842649203176`*^9}, {
   3.734084439828793*^9, 3.734084441876491*^9}, 3.734085096434462*^9, {
   3.735025726975864*^9, 3.7350257613559637`*^9}, {3.7350258084118757`*^9, 
   3.73502582134374*^9}, {3.7373672276558247`*^9, 3.737367228060437*^9}, {
   3.737367271609766*^9, 3.737367504463647*^9}, {3.737367582693924*^9, 
   3.737367631755705*^9}, {3.737367687697275*^9, 3.737367900789085*^9}, {
   3.737367931531619*^9, 3.7373679328500347`*^9}, {3.737367992378326*^9, 
   3.737368184001418*^9}, {3.737368333564695*^9, 3.737368401954623*^9}, {
   3.737368455521988*^9, 3.7373687186417828`*^9}, {3.7373687558414373`*^9, 
   3.737368894109664*^9}, {3.737370888637344*^9, 3.737370901891749*^9}, {
   3.737371024231876*^9, 3.7373711379412193`*^9}, {3.737371190992815*^9, 
   3.737371197173321*^9}, {3.7373714128846693`*^9, 3.737371471027995*^9}, 
   3.73737150259584*^9, {3.7373716044231253`*^9, 3.737371628470811*^9}, {
   3.737371991230308*^9, 3.73737216973435*^9}, {3.737372259597537*^9, 
   3.73737230284109*^9}, {3.737372371273141*^9, 3.737372416495337*^9}, {
   3.7373726176529007`*^9, 3.737372640371661*^9}, {3.737372675754272*^9, 
   3.737372688047003*^9}, {3.737372730568018*^9, 3.737372787801385*^9}, {
   3.737373842226688*^9, 3.7373738544398613`*^9}, {3.737373922351479*^9, 
   3.7373739660355883`*^9}, {3.7373739961147947`*^9, 
   3.7373740095217733`*^9}, {3.73737417904727*^9, 3.7373741904563*^9}, {
   3.737374318036729*^9, 3.737374333651806*^9}, {3.737374502409672*^9, 
   3.737374528134899*^9}, {3.737374592736747*^9, 3.73737462776425*^9}, {
   3.737382441958872*^9, 3.737382542523754*^9}, {3.737382588651662*^9, 
   3.737382598538786*^9}, {3.737382658892776*^9, 3.737382680641808*^9}, 
   3.737968544778825*^9, {3.738044991514905*^9, 3.738045063823347*^9}, {
   3.738045218611374*^9, 3.738045254776026*^9}, {3.738045467737158*^9, 
   3.738045468426176*^9}, {3.738292472268417*^9, 3.738292476830532*^9}, {
   3.7382975723874826`*^9, 3.738297572664035*^9}, {3.738297678253478*^9, 
   3.738297691732843*^9}, {3.738297799382346*^9, 3.738297799698987*^9}, {
   3.738297854337059*^9, 3.7382978562770987`*^9}, {3.738299981879734*^9, 
   3.738299985756028*^9}, {3.738300232134356*^9, 3.738300265159543*^9}, {
   3.738301417561187*^9, 3.738301421379984*^9}, {3.738305570882181*^9, 
   3.738305574359171*^9}, {3.738305621413837*^9, 3.738305622716712*^9}, {
   3.7383056704989567`*^9, 3.7383056997381477`*^9}, {3.738307257373272*^9, 
   3.738307324478037*^9}, {3.738307399772354*^9, 3.7383074103856564`*^9}, {
   3.738308050665287*^9, 3.7383081040337133`*^9}, {3.738308166180523*^9, 
   3.7383082080336847`*^9}, {3.7383082450667143`*^9, 3.738308250712489*^9}, {
   3.738308384535429*^9, 3.7383083908472548`*^9}, {3.738308495902157*^9, 
   3.738308505252943*^9}, {3.7383086210103207`*^9, 3.7383086225272503`*^9}, {
   3.738308655158655*^9, 3.7383086656697283`*^9}, {3.738309065814824*^9, 
   3.73830911591614*^9}, {3.7383091656127863`*^9, 3.7383092548540363`*^9}, {
   3.7383093166278467`*^9, 3.738309381077928*^9}, {3.7383094140745573`*^9, 
   3.7383094144477453`*^9}, {3.738309474660437*^9, 3.7383094763264933`*^9}, {
   3.738309544373711*^9, 3.7383095672818317`*^9}, {3.738309626746223*^9, 
   3.738309686606472*^9}, {3.7383097878300123`*^9, 3.7383098080184298`*^9}, {
   3.73831008863527*^9, 3.7383100931104927`*^9}, {3.73831012540152*^9, 
   3.738310153239818*^9}, {3.73831018813549*^9, 3.7383101906998787`*^9}, {
   3.738310702605604*^9, 3.7383107366660223`*^9}, {3.738311448517243*^9, 
   3.738311476287703*^9}, {3.73831153232588*^9, 3.738311643201743*^9}, {
   3.73831170591776*^9, 3.7383117596420403`*^9}, {3.738311803135922*^9, 
   3.738311881839653*^9}, {3.738312660839986*^9, 3.738312769887286*^9}, {
   3.738312858806275*^9, 3.738312880821744*^9}, {3.7383130875270042`*^9, 
   3.738313159525738*^9}, {3.73831449690935*^9, 3.73831472574437*^9}, {
   3.738315037050962*^9, 3.738315100386753*^9}, 3.7386448366225033`*^9, {
   3.739209267282373*^9, 3.739209268018241*^9}, {3.739209326856827*^9, 
   3.7392094359818153`*^9}, {3.739209885542487*^9, 3.739209934701859*^9}, {
   3.7392514819307404`*^9, 3.739251581962144*^9}, {3.739255008253765*^9, 
   3.739255011490672*^9}, {3.739255066656047*^9, 3.7392550824240007`*^9}, {
   3.739255142878743*^9, 3.739255283903492*^9}, {3.739255720480454*^9, 
   3.739255727111*^9}, {3.739256287055029*^9, 3.739256341393654*^9}, {
   3.73925641825317*^9, 3.7392565173479767`*^9}, {3.739263649822032*^9, 
   3.739263658124049*^9}, 3.739263715216667*^9, {3.7392637780936117`*^9, 
   3.7392638339231377`*^9}, {3.7392646974800873`*^9, 
   3.7392647880938883`*^9}, {3.739264828770708*^9, 3.739264860614913*^9}, {
   3.739265111538767*^9, 3.73926511238643*^9}, 3.7392651895141582`*^9, {
   3.739265274853752*^9, 3.739265344393036*^9}, 3.739265406508833*^9, {
   3.739265501727188*^9, 3.7392655468414288`*^9}, {3.7392655797055807`*^9, 
   3.739265654530856*^9}, {3.7392658147651653`*^9, 3.739265844506536*^9}, {
   3.739265905041802*^9, 3.739265913559229*^9}, {3.739265992597846*^9, 
   3.739265993275798*^9}, {3.739266033723297*^9, 3.739266035422327*^9}, {
   3.739266811418664*^9, 3.73926687478578*^9}, {3.739266977670642*^9, 
   3.739267041586645*^9}, {3.7392670907045803`*^9, 3.739267124775742*^9}, {
   3.739267566391371*^9, 3.739267581859811*^9}, {3.739267693849613*^9, 
   3.739267733480055*^9}, {3.739500656020678*^9, 3.739500659976337*^9}, {
   3.7395006969264317`*^9, 3.739500713982374*^9}, {3.739501495335629*^9, 
   3.739501544167218*^9}, {3.739501598877145*^9, 3.739501624752326*^9}, {
   3.739501656382229*^9, 3.73950165674544*^9}, {3.739501696252055*^9, 
   3.739501700174621*^9}, {3.739501815789463*^9, 3.739501848527233*^9}, {
   3.7395020425474033`*^9, 3.739502055293776*^9}, {3.739502270383594*^9, 
   3.7395023249533443`*^9}, {3.739502364851117*^9, 3.7395023649874983`*^9}, {
   3.739502397724936*^9, 3.73950245059044*^9}, {3.739502494773876*^9, 
   3.7395025078806763`*^9}, {3.739503687333411*^9, 3.739503690907442*^9}, {
   3.739504615185549*^9, 3.7395046199765778`*^9}, {3.7395046607954073`*^9, 
   3.7395046937366962`*^9}, {3.739504739026966*^9, 3.7395047466587133`*^9}, {
   3.739504808349332*^9, 3.739504840551146*^9}, {3.739505054065979*^9, 
   3.739505086771042*^9}, {3.739505219115593*^9, 3.7395052742229757`*^9}, {
   3.7395053160638657`*^9, 3.7395053687482347`*^9}, {3.739505438709841*^9, 
   3.739505440939834*^9}, {3.739505712856276*^9, 3.739505720094058*^9}, {
   3.73950674796898*^9, 3.7395067895030527`*^9}, {3.739506837284807*^9, 
   3.7395069307398977`*^9}, {3.739510669635346*^9, 3.7395106958391943`*^9}, {
   3.739510854101157*^9, 3.7395108698816967`*^9}, {3.739510902032847*^9, 
   3.7395109474224663`*^9}, {3.739510978476756*^9, 3.739511061221396*^9}, {
   3.739511141633822*^9, 3.739511147488902*^9}, {3.739511365717485*^9, 
   3.7395113847506*^9}, {3.739511574592642*^9, 3.7395115751698093`*^9}, {
   3.739512742152898*^9, 3.739512781917255*^9}, {3.739512835388238*^9, 
   3.739512836450012*^9}, {3.73951292009779*^9, 3.7395129219629602`*^9}, {
   3.73951303923135*^9, 3.739513068695093*^9}, {3.739513170936591*^9, 
   3.739513178640259*^9}, {3.7395132394206257`*^9, 3.739513271927874*^9}, 
   3.739513333199873*^9, {3.739513835482668*^9, 3.7395138598415413`*^9}, {
   3.739516616294798*^9, 3.739516630184428*^9}, {3.739520325663392*^9, 
   3.739520357127063*^9}, 3.73952039036992*^9, {3.739520609942298*^9, 
   3.739520628512047*^9}, {3.7395213965133944`*^9, 3.7395215217751837`*^9}, {
   3.7395218684504423`*^9, 3.739521868798478*^9}, {3.739522181151222*^9, 
   3.739522185509658*^9}, {3.7395250428083553`*^9, 3.73952512999087*^9}, {
   3.739525231381093*^9, 3.739525236148944*^9}, {3.739525441628783*^9, 
   3.739525447141528*^9}, {3.739525625305385*^9, 3.739525630522257*^9}, {
   3.739525688987609*^9, 3.7395257248002577`*^9}, {3.739525961073133*^9, 
   3.739525961341238*^9}, {3.739526200207596*^9, 3.739526260428417*^9}, {
   3.739526412293812*^9, 3.739526448415297*^9}, {3.7395270643373623`*^9, 
   3.7395270673875637`*^9}, {3.7395271048722343`*^9, 3.739527119577311*^9}, {
   3.739527214889127*^9, 3.739527301903318*^9}, {3.739527355429894*^9, 
   3.739527358675673*^9}, {3.7395273897861547`*^9, 3.739527416968782*^9}, {
   3.742010806687113*^9, 3.742010858483757*^9}, {3.742010908226156*^9, 
   3.742010932749796*^9}, {3.742011160214778*^9, 3.74201116475535*^9}, 
   3.742011265860978*^9, {3.74201160271281*^9, 3.7420116069067287`*^9}, {
   3.74201165267314*^9, 3.7420117396509542`*^9}, {3.7420117771334352`*^9, 
   3.742011792107109*^9}, {3.742011841321661*^9, 3.742011845982538*^9}, {
   3.742012242145617*^9, 3.742012242629952*^9}, {3.7420122736923532`*^9, 
   3.7420122964333153`*^9}, {3.742012345700942*^9, 3.742012353132306*^9}, {
   3.74201258496979*^9, 3.742012717560898*^9}, {3.7420256773746157`*^9, 
   3.742025723268963*^9}, {3.742025753509473*^9, 3.742025844855604*^9}, {
   3.742025881411282*^9, 3.742025899104787*^9}, {3.744033690604783*^9, 
   3.7440336969133663`*^9}, 3.744034816827615*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[113]:=",ExpressionUUID->"ef46536c-57c5-49bf-90a0-4472cd53b5ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ImportCrystalData", "[", "\"\<RunDialogue\>\"", "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "name", ",", "gridA", ",", "gridB", ",", "currentGrid", ",", 
         "updGrid", ",", "\[IndentingNewLine]", 
         RowBox[{"sgKeys", "=", 
          RowBox[{"Keys", "@", "$SpaceGroups"}]}], ",", 
         RowBox[{"sgNumber", "=", "Null"}], ",", 
         RowBox[{"sgSymbol", "=", "Null"}], ",", "\[IndentingNewLine]", 
         "crystalSystem", ",", "systemParameterFields", ",", 
         "parameterFields", ",", "\[IndentingNewLine]", 
         RowBox[{"a", "=", "Null"}], ",", 
         RowBox[{"b", "=", "Null"}], ",", 
         RowBox[{"c", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]", "=", "Null"}], ",", 
         RowBox[{"\[Beta]", "=", "Null"}], ",", 
         RowBox[{"\[Gamma]", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"chemicalFormula", "=", "Null"}], ",", 
         RowBox[{"wavelength", "=", "Null"}], ",", 
         RowBox[{"massDensity", "=", "Null"}], ",", 
         RowBox[{"formulaUnits", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"atomdata", "=", 
          RowBox[{"{", "}"}]}], ",", "atomdataSummary", ",", 
         "updAtomdataSummary", ",", "\[IndentingNewLine]", 
         "createDeleteButtons", ",", "deleteButtons", ",", 
         "createAtomdataPanel", ",", 
         RowBox[{"atomdataPanel", "=", "\"\<(no entries)\>\""}], ",", 
         "updAtomdataPanel", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Adding", " ", "entries"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"element", "=", "Null"}], ",", "elementListWithNumber", ",", 
         "\[IndentingNewLine]", "coordinates", ",", "\[IndentingNewLine]", 
         RowBox[{"coordX", "=", "Null"}], ",", 
         RowBox[{"coordY", "=", "Null"}], ",", 
         RowBox[{"coordZ", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"occupationFactor", "=", "Null"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"adpType", "=", "\"\<Isotropic\>\""}], ",", "createAdpField",
          ",", "adpField", ",", "\[IndentingNewLine]", 
         RowBox[{"adpU11", "=", "Null"}], ",", 
         RowBox[{"adpU22", "=", "Null"}], ",", 
         RowBox[{"adpU33", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"adpU12", "=", "Null"}], ",", 
         RowBox[{"adpU13", "=", "Null"}], ",", 
         RowBox[{"adpU23", "=", "Null"}], ",", "\[IndentingNewLine]", 
         RowBox[{"adpUiso", "=", "Null"}], ",", "ADPs", ",", 
         "\[IndentingNewLine]", "updRet", ",", "toBeReturned", ",", 
         RowBox[{"validQ", "=", "False"}]}], "\[IndentingNewLine]", "}"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", "-"}], "*", " ", "Setup", " ", "for", " ", "grid", " ",
          "B", " ", "*", 
         RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Logic", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"elementListWithNumber", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "<>", "\"\< (\>\"", "<>", "\[IndentingNewLine]", 
            RowBox[{"ToString", "@", 
             RowBox[{"$PeriodicTable", "[", 
              RowBox[{"#", ",", "\"\<AtomicNumber\>\""}], "]"}]}], "<>", 
            "\[IndentingNewLine]", "\"\<)\>\""}], "&"}], "/@", 
          RowBox[{"Keys", "@", "$PeriodicTable"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"elementListWithNumber", "=", 
         RowBox[{"Thread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Keys", "@", "$PeriodicTable"}], "\[Rule]", 
           "elementListWithNumber"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"createAdpField", "[", "]"}], ":=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"adpType", "===", "\"\<Isotropic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"adpField", "=", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"adpUiso", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpUiso", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                 ",", "\[IndentingNewLine]", "Number", ",", 
                 RowBox[{"FieldSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                 RowBox[{
                 "FieldHint", "\[Rule]", 
                  "\"\<\!\(\*SubscriptBox[\(U\), \(iso\)]\)\>\""}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Spacer", "[", 
                RowBox[{"{", 
                 RowBox[{"165.", ",", "17.5"}], "}"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"adpType", "===", "\"\<Anisotropic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"adpField", "=", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU11", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU11", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(11\)]\)\>\""}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Spacer", "[", "5", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU22", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU22", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(22\)]\)\>\""}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Spacer", "[", "5", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU33", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU33", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(33\)]\)\>\""}]}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU12", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU12", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(12\)]\)\>\""}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Spacer", "[", "5", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU13", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU13", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(13\)]\)\>\""}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Spacer", "[", "5", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"adpU23", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpU23", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", "Number", ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    RowBox[{
                    "FieldHint", "\[Rule]", 
                    "\"\<\!\(\*SubscriptBox[\(U\), \(23\)]\)\>\""}]}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"createAdpField", "[", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Dynamic", " ", "variable", " ", "storing", " ", "input", " ", 
          "data"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ADPs", "=", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"{", 
           RowBox[{
           "adpU11", ",", "adpU22", ",", "adpU33", ",", "adpU12", ",", 
            "adpU13", ",", "adpU23"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coordinates", "=", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"{", 
           RowBox[{"coordX", ",", "coordY", ",", "coordZ"}], "}"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updRet", "[", "]"}], ":=", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"toBeReturned", "=", 
            RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"element", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"toBeReturned", ",", 
               RowBox[{"\"\<Element\>\"", "\[Rule]", "element"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"KeyDropFrom", "[", 
              RowBox[{"toBeReturned", ",", "\"\<Element\>\""}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"occupationFactor", "=!=", "Null"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"toBeReturned", ",", 
               RowBox[{
               "\"\<OccupationFactor\>\"", "\[Rule]", "occupationFactor"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"KeyDropFrom", "[", 
              RowBox[{"toBeReturned", ",", "\"\<OccupationFactor\>\""}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{
               RowBox[{"coordinates", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "NumericQ"}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"toBeReturned", ",", 
               RowBox[{
               "\"\<FractionalCoordinates\>\"", "\[Rule]", "coordinates"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"KeyDropFrom", "[", 
              RowBox[{"toBeReturned", ",", "\"\<FractionalCoordinates\>\""}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"adpType", "===", "\"\<Anisotropic\>\""}], ")"}], "&&", 
              RowBox[{"AllTrue", "[", 
               RowBox[{
                RowBox[{"ADPs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "NumericQ"}], "]"}]}], 
             ",", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"AssociateTo", "[", 
               RowBox[{"toBeReturned", ",", 
                RowBox[{
                "\"\<DisplacementParameters\>\"", "\[Rule]", "ADPs"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"toBeReturned", ",", 
                RowBox[{"\"\<Type\>\"", "\[Rule]", "\"\<Uani\>\""}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"adpType", "===", "\"\<Isotropic\>\""}], ")"}], "&&", 
              RowBox[{"NumericQ", "@", "adpUiso"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"AssociateTo", "[", 
               RowBox[{"toBeReturned", ",", 
                RowBox[{
                "\"\<DisplacementParameters\>\"", "\[Rule]", "adpUiso"}]}], 
               "]"}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"toBeReturned", ",", 
                RowBox[{"\"\<Type\>\"", "\[Rule]", "\"\<Uiso\>\""}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", "True", ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"KeyDropFrom", "[", 
              RowBox[{"toBeReturned", ",", "\"\<DisplacementParameters\>\""}],
               "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"element", "=!=", "Null"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"AllTrue", "[", 
                RowBox[{
                 RowBox[{"coordinates", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "NumericQ"}], "]"}], 
               ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"validQ", "=", "True"}], ",", 
             RowBox[{"validQ", "=", "False"}]}], "]"}]}], 
          "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"updRet", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"--", "-"}], "*"}], " ", "//", " ", 
           RowBox[{"End", " ", "of", " ", "grid", " ", "B", " ", "setup"}]}], 
          " ", "//", " ", 
          RowBox[{"*", 
           RowBox[{"--", "-"}]}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Logic", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"systemParameterFields", "[", "system_String", "]"}], ":=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"system", "===", "\"\<Triclinic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "a"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "b"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "\[Alpha]"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "\[Beta]"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "\[Gamma]"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"system", "===", "\"\<Monoclinic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "a"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "b"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "\[Gamma]"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"system", "===", "\"\<Orthorhombic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "a"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "b"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"\[Gamma]", "=", "90"}], ",", "Number", ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                   
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"system", "===", "\"\<Tetragonal\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "=", "#"}], ";", 
                    RowBox[{"b", "=", "#"}]}], ")"}], "&"}]}], "]"}], ",", 
                    "Number", ",", "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"b", "=", 
                    RowBox[{"Dynamic", "@", "a"}]}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"system", "===", "\"\<Hexagonal\>\""}], "||", 
            RowBox[{"system", "===", "\"\<Trigonal\>\""}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "=", "#"}], ";", 
                    RowBox[{"b", "=", "#"}]}], ")"}], "&"}]}], "]"}], ",", 
                    "Number", ",", "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"b", "=", 
                    RowBox[{"Dynamic", "@", "a"}]}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "c"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "=", "120"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"system", "===", "\"\<Cubic\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"Column", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"a", "=", "#"}], ";", 
                    RowBox[{"b", "=", "#"}], ";", 
                    RowBox[{"c", "=", "#"}]}], ")"}], "&"}]}], "]"}], ",", 
                    "Number", ",", "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<a\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "True"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"b", "=", 
                    RowBox[{"Dynamic", "@", "a"}]}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<b\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"c", "=", 
                    RowBox[{"Dynamic", "@", "a"}]}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<c\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Beta]\>\""}], ",", 
                    
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Spacer", "[", "5", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "=", "90"}], ",", "Number", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<\[Gamma]\>\""}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Enabled", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", "0.65", "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Atom", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updAtomdataSummary", "[", "]"}], ":=", 
         RowBox[{"atomdataSummary", "=", 
          RowBox[{"atomdata", "[", 
           RowBox[{"[", "\[IndentingNewLine]", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Element\>\"", ",", "\"\<FractionalCoordinates\>\""}], 
              "}"}]}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"createDeleteButtons", "[", "]"}], ":=", 
         RowBox[{"deleteButtons", "=", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Button", "[", 
             RowBox[{"\"\<\[Times]\>\"", ",", 
              RowBox[{
               RowBox[{"atomdataSummary", "=", 
                RowBox[{"Delete", "[", 
                 RowBox[{"atomdataSummary", ",", "#"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"createDeleteButtons", "[", "]"}], ";", 
               RowBox[{"createAtomdataPanel", "[", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], "]"}],
             "&"}], "/@", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", "atomdataSummary"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"createAtomdataPanel", "[", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"deleteButtons", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"atomdataPanel", "=", "\"\<(no entries)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"atomdataPanel", "=", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"Pane", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Grid", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "@", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Values", "@", "atomdataSummary"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "deleteButtons", "}"}]}], "]"}]}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], ",", 
                RowBox[{"Scrollbars", "\[Rule]", "False"}]}], "]"}], "}"}], 
             "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updAtomdataPanel", "[", "]"}], ":=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"atomdata", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"atomdataPanel", "=", "\"\<(no entries)\>\""}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"updAtomdataSummary", "[", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"createDeleteButtons", "[", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"createAtomdataPanel", "[", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Initial", " ", "settings"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"parameterFields", "=", 
         RowBox[{"systemParameterFields", "[", "\"\<Triclinic\>\"", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"updAtomdataPanel", "[", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"--", "-"}], "*", " ", "Grids", " ", "*", 
          RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grid", " ", "switcher"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updGrid", "[", "label_String", "]"}], ":=", 
         RowBox[{"currentGrid", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"label", "===", "\"\<A\>\""}], ",", "gridA", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"label", "===", "\"\<B\>\""}], ",", "gridB"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"updGrid", "[", "\"\<A\>\"", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grid", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"gridA", "=", 
         RowBox[{"Dynamic", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Crystal name\>\"", ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "name"}], ",", "String", ",", 
                RowBox[{
                "FieldHint", "\[Rule]", "\"\<Crystal name or label\>\""}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<Space group\>\"", ",", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"Row", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"PopupMenu", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"sgNumber", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"sgNumber", "=", "#"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sgSymbol", "=", 
                    RowBox[{"sgKeys", "[", 
                    RowBox[{"[", "sgNumber", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"crystalSystem", "=", 
                    RowBox[{"$SpaceGroups", "[", 
                    RowBox[{"sgSymbol", ",", "\"\<CrystalSystem\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"parameterFields", "=", 
                    RowBox[{
                    "systemParameterFields", "[", "crystalSystem", "]"}]}]}], 
                    "\[IndentingNewLine]", ")"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\t", 
                    RowBox[{"Range", "@", "230"}], ",", "\"\<Number\>\""}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"PopupMenu", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"sgSymbol", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"sgSymbol", "=", "#"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sgNumber", "=", 
                    RowBox[{"$SpaceGroups", "[", 
                    RowBox[{"sgSymbol", ",", "\"\<SpaceGroupNumber\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"crystalSystem", "=", 
                    RowBox[{"$SpaceGroups", "[", 
                    RowBox[{"sgSymbol", ",", "\"\<CrystalSystem\>\""}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"parameterFields", "=", 
                    RowBox[{
                    "systemParameterFields", "[", "crystalSystem", "]"}]}]}], 
                    "\[IndentingNewLine]", ")"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\t", 
                    RowBox[{"Keys", "@", "$SpaceGroups"}], ",", 
                    "\"\<Symbol\>\""}], "]"}]}], "}"}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{"\"\<Lattice parameters\>\"", ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<a  b  c\>\"", ",", 
                   "\"\<\[Alpha]  \[Beta]  \[Gamma]\>\"", ",", 
                   "\"\<\[ARing]ngstr\[ODoubleDot]m and degree\>\""}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "@", "parameterFields"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
               "\"\<Chemical formula\>\"", ",", 
                "\"\<e.g. 'C13 H22 Fe N6 S3'\>\"", ",", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "chemicalFormula"}], ",", "String", 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                "FieldHint", "\[Rule]", "\"\<e.g. 'C13 H22 Fe N6 S3'\>\""}]}],
                "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
               "\"\<Wavelength\>\"", ",", 
                "\"\<\[ARing]ngstr\[ODoubleDot]m\>\"", ",", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "wavelength"}], ",", "Number", ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Lambda]\>\""}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PopupMenu", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "wavelength"}], ",", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "1.54059", "\[Rule]", 
                    "\"\<Cu \!\(\*SubscriptBox[\(K\[Alpha]\), \(1\)]\)\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "1.54443", "\[Rule]", 
                    "\"\<Cu \!\(\*SubscriptBox[\(K\[Alpha]\), \(2\)]\)\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "1.39223", "\[Rule]", 
                    "\"\<Cu \!\(\*SubscriptBox[\(K\[Beta]\), \(1\)]\)\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "0.70932", "\[Rule]", 
                    "\"\<Mo \!\(\*SubscriptBox[\(K\[Alpha]\), \(1\)]\)\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "0.71361", "\[Rule]", 
                    "\"\<Mo \!\(\*SubscriptBox[\(K\[Alpha]\), \(2\)]\)\>\""}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    "0.63230", "\[Rule]", 
                    "\"\<Mo \!\(\*SubscriptBox[\(K\[Beta]\), \
\(1\)]\)\>\""}]}], "\[IndentingNewLine]", "}"}], ",", 
                   "\"\<(Predefined)\>\""}], "]"}]}], "\[IndentingNewLine]", 
                "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
               "\"\<Mass density\>\"", ",", 
                "\"\<g/\!\(\*SuperscriptBox[\(cm\), \(3\)]\)\>\"", ",", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "massDensity"}], ",", "Number", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<\[Rho]\>\""}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", "\"\<formula units\>\"", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "formulaUnits"}], ",", "Number", 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<Z\>\""}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<Atom data\>\"", ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<Add new element\>\"", ",", 
                   RowBox[{"updGrid", "[", "\"\<B\>\"", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "@", "atomdataPanel"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"CancelButton", "[", "]"}], ",", 
                 RowBox[{"DefaultButton", "[", "\[IndentingNewLine]", 
                  RowBox[{"DialogReturn", "[", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{"Final", " ", "checks"}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"StringQ", "@", "name"}]}], ",", 
                    RowBox[{"name", "=", "\"\<(no name)\>\""}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"chemicalFormula", "===", "Null"}], ",", 
                    RowBox[{"chemicalFormula", "=", "\"\<\>\""}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"formulaUnits", "===", "Null"}], ",", 
                    RowBox[{"formulaUnits", "=", "0"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sgSymbol", "===", "Null"}], ",", 
                    RowBox[{"sgSymbol", "=", "1"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"wavelength", "===", "Null"}], ",", 
                    RowBox[{"wavelength", "=", 
                    RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]",
                     "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", "Return", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"MaXrd`Private`$temp", "=", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "name", ",", "chemicalFormula", ",", "formulaUnits", ",", 
                    "sgSymbol", ",", "wavelength"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "\[Alpha]", ",", "\[Beta]", 
                    ",", "\[Gamma]"}], "}"}], ",", "atomdata"}], 
                    "\[IndentingNewLine]", "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MaXrd`Private`$temp", "=", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"MaXrd`Private`$temp", ",", "\[IndentingNewLine]", 
                    RowBox[{"x_Dynamic", "\[RuleDelayed]", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
                   "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grid", " ", "B"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"gridB", "=", 
         RowBox[{"Dynamic", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Element\>\"", ",", 
              RowBox[{"PopupMenu", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"element", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"element", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                ",", "\[IndentingNewLine]", "elementListWithNumber", ",", 
                "\"\<Element\>\""}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<Fractional coordinates\>\"", ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"coordX", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"coordX", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<x\>\""}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"coordY", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"coordY", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<y\>\""}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"coordZ", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"coordZ", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", "Number", ",", 
                   RowBox[{"FieldSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                   RowBox[{"FieldHint", "\[Rule]", "\"\<z\>\""}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\"\<Occupation factor\>\"", ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"occupationFactor", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"occupationFactor", "=", "#"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                ",", "Number", ",", 
                RowBox[{"FieldSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"5.", ",", "1."}], "}"}]}], ",", 
                RowBox[{"FieldHint", "\[Rule]", "\"\<1\>\""}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
               "\"\<ADP type\>\"", ",", 
                "\"\<Anisotropic displacement parameters\>\"", ",", 
                RowBox[{"TooltipDelay", "\[Rule]", "0.6"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"RadioButtonBar", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{"adpType", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"adpType", "=", "#"}], ";", 
                    RowBox[{"createAdpField", "[", "]"}], ";", 
                    RowBox[{"updRet", "[", "]"}]}], ")"}], "&"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Isotropic\>\"", ",", "\"\<Anisotropic\>\""}], 
                 "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<Active\>\""}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"Dynamic", "@", "adpField"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Null", ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"CancelButton", "[", 
                  RowBox[{"updGrid", "[", "\"\<A\>\"", "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"DefaultButton", "[", 
                  RowBox[{"\"\<Add\>\"", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"atomdata", ",", "\[IndentingNewLine]", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"toBeReturned", ",", 
                    RowBox[{"x_Dynamic", "\[RuleDelayed]", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"updAtomdataPanel", "[", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"updGrid", "[", "\"\<A\>\"", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Enabled", "\[Rule]", 
                    RowBox[{"Dynamic", "@", "validQ"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grid", " ", "on", " ", "display"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Dynamic", "@", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"currentGrid", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0.5"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Alignment", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Left", ",", "Center"}], "}"}]}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dialogue", " ", "settings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
     "WindowTitle", "\[Rule]", "\"\<Add crystal to $CrystalData\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Modal", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"WindowSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"310", ",", "All"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739595978214114*^9, 3.739595990960588*^9}, {
   3.739596669627418*^9, 3.739596695911725*^9}, {3.739596912394574*^9, 
   3.739596932092749*^9}, {3.7395970199751673`*^9, 3.739597066689048*^9}, {
   3.73959711186619*^9, 3.739597356240508*^9}, {3.739597461697694*^9, 
   3.7395975030637703`*^9}, {3.739597555516307*^9, 3.739597641340172*^9}, {
   3.739597793824828*^9, 3.7395978241317577`*^9}, {3.739597855600132*^9, 
   3.739597902263493*^9}, {3.739598245770096*^9, 3.739598361343294*^9}, {
   3.739599172833571*^9, 3.739599177517766*^9}, {3.739599213923336*^9, 
   3.739599322529324*^9}, 3.739599511772471*^9, {3.739599555972958*^9, 
   3.739599564138731*^9}, {3.739599596703545*^9, 3.739599679162033*^9}, {
   3.739599709968329*^9, 3.739599729728099*^9}, {3.739599777433371*^9, 
   3.739599819200165*^9}, {3.7396001729638844`*^9, 3.7396002251424217`*^9}, 
   3.739600299286446*^9, {3.739600366177018*^9, 3.739600398831429*^9}, {
   3.739600442540759*^9, 3.739600442810607*^9}, {3.739600491367622*^9, 
   3.7396005534641953`*^9}, {3.7396006186292343`*^9, 
   3.7396006874968777`*^9}, {3.739600838419689*^9, 3.7396009595871468`*^9}, {
   3.739601031898162*^9, 3.7396010323136044`*^9}, {3.73960143563618*^9, 
   3.739601464736333*^9}, {3.739601721310192*^9, 3.739601722306417*^9}, {
   3.739602479115416*^9, 3.739602547709318*^9}, {3.73960261429424*^9, 
   3.739602633508088*^9}, {3.739602666336516*^9, 3.7396026675947447`*^9}, {
   3.7396027284612103`*^9, 3.739602738197445*^9}, {3.739602881326993*^9, 
   3.739602909640366*^9}, {3.739603624511942*^9, 3.739603791042316*^9}, {
   3.739603996203532*^9, 3.739604101606237*^9}, {3.739604146456543*^9, 
   3.73960415529599*^9}, {3.739604214561223*^9, 3.739604219167306*^9}, {
   3.7396042506303787`*^9, 3.739604268312009*^9}, {3.739604473386827*^9, 
   3.739604664867947*^9}, {3.739604847714067*^9, 3.73960497908556*^9}, {
   3.739605188312948*^9, 3.73960526815869*^9}, {3.7396053616518307`*^9, 
   3.739605380756493*^9}, {3.739606390752233*^9, 3.739606582251404*^9}, {
   3.73960661254064*^9, 3.739606647981111*^9}, {3.7396067107737417`*^9, 
   3.739606739461856*^9}, {3.7396075023942213`*^9, 3.73960754045004*^9}, {
   3.7396075782464437`*^9, 3.7396076187558393`*^9}, {3.73960765770329*^9, 
   3.739607781095315*^9}, {3.739607816578467*^9, 3.7396079456654997`*^9}, {
   3.7396079883067503`*^9, 3.739608014913579*^9}, {3.739608138957831*^9, 
   3.7396081392048283`*^9}, {3.739608180236808*^9, 3.73960818041252*^9}, {
   3.739608232358246*^9, 3.7396082832029963`*^9}, {3.739608314916871*^9, 
   3.7396083814410763`*^9}, {3.739608413778994*^9, 3.739608414923287*^9}, {
   3.739608540812207*^9, 3.739608564697151*^9}, {3.7396086208319187`*^9, 
   3.739608707325838*^9}, {3.7396087516824512`*^9, 3.739608772848316*^9}, {
   3.7396088172813683`*^9, 3.739608873886364*^9}, {3.739608949401414*^9, 
   3.739608971227984*^9}, {3.739609090888156*^9, 3.7396091126284237`*^9}, {
   3.739609146205271*^9, 3.739609200960956*^9}, {3.739609272821333*^9, 
   3.739609364028111*^9}, {3.739609461069508*^9, 3.739609674326315*^9}, {
   3.739609740987973*^9, 3.7396097423774967`*^9}, {3.7396098442242126`*^9, 
   3.739609861229912*^9}, 3.739609894456533*^9, {3.739610012922155*^9, 
   3.739610013510725*^9}, {3.739610062273484*^9, 3.739610108332995*^9}, 
   3.739610279762279*^9, 3.739610309890603*^9, {3.7396103881359386`*^9, 
   3.739610408666873*^9}, {3.739610449368506*^9, 3.739610474008996*^9}, {
   3.739610518181279*^9, 3.739610561128326*^9}, {3.739610605216217*^9, 
   3.7396106533798933`*^9}, {3.7396106961302347`*^9, 3.739610719521283*^9}, {
   3.7396107514167*^9, 3.739610785658737*^9}, {3.739610821836543*^9, 
   3.7396108270223303`*^9}, {3.739610904406472*^9, 3.7396109432912703`*^9}, {
   3.739610983393579*^9, 3.739610985921002*^9}, {3.739611047610756*^9, 
   3.739611082981056*^9}, {3.7396111202331247`*^9, 3.739611141913677*^9}, {
   3.739611174288352*^9, 3.7396112737859983`*^9}, {3.739611337138582*^9, 
   3.739611396260716*^9}, {3.7396228109407873`*^9, 3.739622874736499*^9}, {
   3.739622964649042*^9, 3.7396229763536654`*^9}, {3.739623010221518*^9, 
   3.73962313081952*^9}, {3.7396231658281612`*^9, 3.739623295079341*^9}, {
   3.739623332696557*^9, 3.739623332845948*^9}, {3.7396233779106073`*^9, 
   3.739623380655662*^9}, {3.7396234416776657`*^9, 3.739623517554187*^9}, {
   3.739623579334292*^9, 3.739623580450202*^9}, {3.739623651727364*^9, 
   3.739623662398727*^9}, {3.739623711135504*^9, 3.739623723580459*^9}, {
   3.7396273924772997`*^9, 3.739627495663086*^9}, {3.739627533657785*^9, 
   3.7396275715670977`*^9}, {3.739627602949834*^9, 3.739627758744505*^9}, {
   3.7396279052729*^9, 3.739627995644252*^9}, {3.73962812681828*^9, 
   3.739628140968225*^9}, {3.739628194120064*^9, 3.739628295620471*^9}, {
   3.739628515689384*^9, 3.739628592021266*^9}, {3.73962863395826*^9, 
   3.739628672903981*^9}, {3.739628719307742*^9, 3.739628853107712*^9}, {
   3.739628886385207*^9, 3.739628914180913*^9}, {3.739628990749894*^9, 
   3.739629014507296*^9}, {3.739629048859845*^9, 3.7396290748589783`*^9}, {
   3.739629383121718*^9, 3.7396293892553387`*^9}, {3.739629419353114*^9, 
   3.739629467696455*^9}, {3.739629579611897*^9, 3.739629594562914*^9}, {
   3.7396297021955147`*^9, 3.739629738962376*^9}, {3.7396298004087954`*^9, 
   3.7396299112522182`*^9}, {3.739629988308178*^9, 3.7396300054739428`*^9}, {
   3.739630076970662*^9, 3.739630092649198*^9}, {3.739630156530631*^9, 
   3.739630228830247*^9}, {3.739630260800342*^9, 3.739630351211857*^9}, {
   3.739630389373459*^9, 3.739630435431656*^9}, {3.7396304725706778`*^9, 
   3.739630502657832*^9}, {3.7396306002789*^9, 3.739630622685934*^9}, {
   3.739630702597105*^9, 3.739630787593442*^9}, {3.739630862777617*^9, 
   3.739630943598301*^9}, {3.739630996477914*^9, 3.739631079224884*^9}, {
   3.739631110227867*^9, 3.739631216168207*^9}, {3.739631268639762*^9, 
   3.7396314065719137`*^9}, {3.7396314393177147`*^9, 3.739631458844926*^9}, {
   3.73963149461353*^9, 3.73963155381565*^9}, {3.739631623512226*^9, 
   3.73963177342599*^9}, 3.739631815864191*^9, {3.739631869031271*^9, 
   3.739631945612903*^9}, {3.739631979531575*^9, 3.7396319840424557`*^9}, {
   3.7396320736534*^9, 3.7396320917410088`*^9}, {3.739632142721302*^9, 
   3.739632142863393*^9}, {3.73963219202211*^9, 3.7396322821004553`*^9}, {
   3.739632388268977*^9, 3.739632402956642*^9}, {3.739632435368124*^9, 
   3.7396327242385*^9}, {3.739632762526031*^9, 3.739632785336027*^9}, {
   3.739632827056922*^9, 3.739632827878628*^9}, {3.739632862923669*^9, 
   3.739632886577631*^9}, {3.739632963861861*^9, 3.7396330248348637`*^9}, {
   3.739675412157125*^9, 3.739675516086557*^9}, {3.739675594294528*^9, 
   3.739675656767128*^9}, {3.739675800550416*^9, 3.739675861434029*^9}, {
   3.7396759204476757`*^9, 3.739675943988346*^9}, {3.7396761895284767`*^9, 
   3.7396762101909847`*^9}, {3.739679000703518*^9, 3.7396791367361727`*^9}, {
   3.739679188600012*^9, 3.739679190122048*^9}, 3.739679236458902*^9, {
   3.739679299103034*^9, 3.739679382796001*^9}, {3.739679426804431*^9, 
   3.739679432938841*^9}, {3.7396794731976*^9, 3.739679510055163*^9}, {
   3.7396795991342297`*^9, 3.739679636995349*^9}, {3.739679699275319*^9, 
   3.7396797003419943`*^9}, {3.739679741712719*^9, 3.7396798364763117`*^9}, {
   3.739679885259416*^9, 3.739679887258333*^9}, {3.739680577068009*^9, 
   3.7396805980576267`*^9}, {3.73968066677735*^9, 3.739680678443376*^9}, {
   3.7396808330637836`*^9, 3.7396808539610367`*^9}, {3.7396810247286797`*^9, 
   3.739681026881317*^9}, {3.739681155384138*^9, 3.739681213740945*^9}, {
   3.739681332020043*^9, 3.739681407632062*^9}, {3.739682613028644*^9, 
   3.739682671253872*^9}, {3.7396828519162493`*^9, 3.7396829003948298`*^9}, {
   3.7396833755889797`*^9, 3.739683405064172*^9}, {3.7396834374814043`*^9, 
   3.7396834429171047`*^9}, 3.739683489676093*^9, {3.739684106265815*^9, 
   3.739684118955434*^9}, {3.739684179627265*^9, 3.7396842015951138`*^9}, {
   3.739684263587494*^9, 3.739684283216798*^9}, {3.73968880388513*^9, 
   3.739688838171343*^9}, {3.739688873192896*^9, 3.739688946020999*^9}, {
   3.739688988543015*^9, 3.739689104402824*^9}, {3.739689142834998*^9, 
   3.739689192432645*^9}, {3.73968922669903*^9, 3.7396892327928667`*^9}, {
   3.7396892708092947`*^9, 3.739689272888376*^9}, {3.739689314201379*^9, 
   3.739689368910149*^9}, {3.739689510382373*^9, 3.7396895422579107`*^9}, {
   3.739689774190139*^9, 3.739689778940134*^9}, {3.739689829620129*^9, 
   3.73968990164141*^9}, {3.739689951569553*^9, 3.739690108283433*^9}, {
   3.73969017399741*^9, 3.739690229819253*^9}, {3.739690264866005*^9, 
   3.739690342849268*^9}, {3.739758946799944*^9, 3.7397589481111593`*^9}, {
   3.739758995366086*^9, 3.739759002839532*^9}, {3.739863575531982*^9, 
   3.739863578353183*^9}, {3.739863707824779*^9, 3.739863740157061*^9}, {
   3.739863771072855*^9, 3.739863791517488*^9}, {3.739863868162785*^9, 
   3.739863870886099*^9}, {3.7398639129310913`*^9, 3.739863948384541*^9}, {
   3.739864013949608*^9, 3.7398640383000107`*^9}, {3.739864207728085*^9, 
   3.739864230387827*^9}, 3.739864282806341*^9, {3.739864336316687*^9, 
   3.739864377023755*^9}, {3.7398644823866262`*^9, 3.739864508937294*^9}, {
   3.739864848672627*^9, 3.739864856776475*^9}, {3.739864925721705*^9, 
   3.739864955440385*^9}, {3.739865048067428*^9, 3.739865100600758*^9}, {
   3.739865824948411*^9, 3.739865847441052*^9}, 3.739865896990898*^9, {
   3.739865928772797*^9, 3.739865969487401*^9}, {3.739866026639572*^9, 
   3.739866030789463*^9}, {3.7398661246333723`*^9, 3.739866125022056*^9}, {
   3.739866218724064*^9, 3.739866234677065*^9}, {3.739866367311499*^9, 
   3.739866367481835*^9}, {3.7398663985689*^9, 3.739866523829637*^9}, {
   3.739866571058456*^9, 3.7398665713374557`*^9}, {3.739866652844152*^9, 
   3.739866658837242*^9}, {3.739866718000596*^9, 3.7398667238271933`*^9}, {
   3.739866781347661*^9, 3.739866804024081*^9}, {3.7398668441415777`*^9, 
   3.7398668846214046`*^9}, {3.739866960197887*^9, 3.739867013444448*^9}, {
   3.739867046244567*^9, 3.739867065060412*^9}, {3.739867836084358*^9, 
   3.7398679029305677`*^9}, {3.739868009517646*^9, 3.7398680099155197`*^9}, {
   3.73986838483932*^9, 3.739868480695668*^9}, {3.739868581166408*^9, 
   3.7398685893985233`*^9}, {3.739868636008234*^9, 3.739868658031337*^9}, {
   3.7398686946914787`*^9, 3.739868712473447*^9}, {3.739868787636284*^9, 
   3.739868804537919*^9}, {3.739869520246541*^9, 3.7398695411085653`*^9}, {
   3.739869953126285*^9, 3.739869976386943*^9}, {3.739870087611046*^9, 
   3.7398702328716516`*^9}, {3.739870350125676*^9, 3.739870392186141*^9}, {
   3.739870422566345*^9, 3.7398704849265003`*^9}, {3.7398705309234533`*^9, 
   3.7398705454106703`*^9}, {3.739870622355419*^9, 3.739870711135853*^9}, {
   3.739870762703689*^9, 3.739870762984342*^9}, {3.739876439573551*^9, 
   3.739876456494874*^9}, {3.73987676781678*^9, 3.739876806094466*^9}, {
   3.739876944013143*^9, 3.739876966551764*^9}, {3.739877083454373*^9, 
   3.739877148859359*^9}, {3.739877228013012*^9, 3.739877232938452*^9}, {
   3.739877402328149*^9, 3.7398774168235397`*^9}, 3.739883203190524*^9, {
   3.7398838170096703`*^9, 3.7398838284660063`*^9}, {3.739884144446562*^9, 
   3.739884151374771*^9}, 3.7398842053380117`*^9, {3.739884364414351*^9, 
   3.739884366328815*^9}, 3.739884400758272*^9, {3.740715301864786*^9, 
   3.74071530491991*^9}, {3.740718948306694*^9, 3.740718974231278*^9}, {
   3.740719005521709*^9, 3.740719076476572*^9}, {3.740719249286849*^9, 
   3.740719282471192*^9}, {3.740719319774604*^9, 3.740719321100967*^9}, {
   3.740719355530716*^9, 3.740719356375108*^9}, {3.740719476017921*^9, 
   3.740719545357823*^9}, {3.740719585650416*^9, 3.740719627948525*^9}, {
   3.7407196636576643`*^9, 3.740719678868546*^9}, {3.740720112294278*^9, 
   3.7407202424705763`*^9}, {3.740720281690967*^9, 3.740720360295545*^9}, {
   3.7407204178744917`*^9, 3.7407204517139597`*^9}, {3.740720542486318*^9, 
   3.7407206238042316`*^9}, {3.7407206598393383`*^9, 3.740720683396193*^9}, {
   3.7407207541633797`*^9, 3.740720754676684*^9}, {3.740722123423622*^9, 
   3.740722139079146*^9}, {3.740722618155561*^9, 3.740722618528919*^9}, {
   3.740725597051619*^9, 3.7407256103766947`*^9}, {3.743835348895899*^9, 
   3.743835350614464*^9}, {3.744033597296912*^9, 3.7440336078716087`*^9}, {
   3.7440336543163357`*^9, 3.744033668984364*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[114]:=",
 CellID->737696194,ExpressionUUID->"685793d0-4e6b-41c6-affa-d9ec5cf93819"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportCrystalData", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "name", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MaXrd`Private`$temp", "=", "Null"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ImportCrystalData", "[", "\"\<RunDialogue\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MaXrd`Private`$temp", "===", "Null"}], ",", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"name", "=", 
      RowBox[{"MaXrd`Private`$temp", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Execute", " ", "ImportCrystalData", " ", "on", " ", "input", " ", 
       "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "@", "MaXrd`Private`$temp"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MaXrd`Private`$temp", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "/.", 
             RowBox[{"x_Dynamic", "\[RuleDelayed]", 
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "NumericQ"}], "]"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ImportCrystalData", "::", "latticeParameters"}], "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImportCrystalData", "@@", "MaXrd`Private`$temp"}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reset", " ", "temporary", " ", "variable"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"MaXrd`Private`$temp", "=", "Null"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Display", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#1", "\[Equal]", "\"\<AtomData\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<AtomData\>\"", "\[Rule]", 
           RowBox[{"Shallow", "[", 
            RowBox[{"#2", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"#1", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", "name", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.739877426691807*^9, 3.739877512185233*^9}, {
   3.739877546275635*^9, 3.7398776229190817`*^9}, {3.739877703000132*^9, 
   3.739877749709647*^9}, {3.739877809507863*^9, 3.739877812473098*^9}, {
   3.73988326754291*^9, 3.7398833299152517`*^9}, 3.739883389420485*^9, {
   3.739883430701161*^9, 3.7398834730901318`*^9}, {3.7407211261529217`*^9, 
   3.740721187584734*^9}, 3.740721261813945*^9, {3.740721315715322*^9, 
   3.740721315988946*^9}, {3.740721861127396*^9, 3.7407218680373373`*^9}, {
   3.7407225108236713`*^9, 3.740722544404612*^9}, {3.740722575666327*^9, 
   3.740722581820733*^9}, {3.7407266695846148`*^9, 3.7407266704084167`*^9}, {
   3.7416719890224524`*^9, 3.74167199814979*^9}, {3.741672032958386*^9, 
   3.741672045595846*^9}, {3.743835351755103*^9, 3.7438353571302423`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[115]:=",ExpressionUUID->"9b87cce1-9c4a-4837-a103-4fad26c1d25d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[116]:=",ExpressionUUID->"31ba05d1-9b20-4540-ad8e-465850b6579e"]
}, Closed]],

Cell[CellGroupData[{

Cell["InputCheck", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9, {3.6856909140644207`*^9, 3.6856909161285*^9}, {
   3.6856955548132*^9, 
   3.685695556654903*^9}},ExpressionUUID->"b5fce791-c483-4bbb-a620-\
43b6add0c57b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[117]:=",ExpressionUUID->"08127a61-0a46-4737-bdd2-eb44b81e2d02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "label"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a recognised check label.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "dim"}], "=", 
   "\"\<Reflections (and coordinates) must be on a {\!\(\*StyleBox[\"h\", \
\"TI\"]\), \!\(\*StyleBox[\"k\", \"TI\"]\), \!\(\*StyleBox[\"l\", \"TI\"]\)} \
(or {\!\(\*StyleBox[\"x\", \"TI\"]\), \!\(\*StyleBox[\"y\", \"TI\"]\), \
\!\(\*StyleBox[\"z\", \"TI\"]\)}) form\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "one"}], "=", 
   "\"\<Only one `1` expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "head"}], "=", 
   "\"\<Head of indices must be either Integer, String or Symbol.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "integer"}], "=", 
   "\"\<One or more indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "few"}], "=", 
   "\"\<At least two reflections are required to make comparisons.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyunit"}], "=", 
   "\"\<Input does not have a unit compatible with energy or \
wavelength.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "energyinput"}], "=", 
   "\"\<Input must be an energy or wavelength compatible Quantity, or a \
number.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "poslambda"}], "=", 
    "\"\<The wavelength/energy must be positive.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystal"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "wavelength"}], "=", 
   "\"\<No wavelength was found for crystal \[LeftGuillemet]`1`\
\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "userinput"}], "=", 
   "\"\<Invalid user input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "polarisation"}], "=", 
    "\"\<Invalid polarisation setting.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PSG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point- \
or space group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "PG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SG"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a space \
group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "SGnumber"}], "=", 
   "\"\<Valid space group numbers are between 1 and 230.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "crystalSG"}], "=", 
   "\"\<Crystal entry \[LeftGuillemet]`1`\[RightGuillemet] has invalid space \
group \[LeftGuillemet]`2`\[RightGuillemet].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InputCheck", "::", "PSGC"}], "=", 
    "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a point \
group, space group or a crystal.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "centringerror"}], "=", 
   "\"\<Invalid space group centring.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementNumber"}], "=", 
   "\"\<Element number `1` is out of range.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementFailed"}], "=", 
   "\"\<Unable to interpret \[LeftGuillemet]`1`\[RightGuillemet] as a \
chemical element.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputCheck", "::", "ElementError"}], "=", 
   "\"\<The element \[LeftGuillemet]`1`\[RightGuillemet] cannot be \
interpreted.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6856820263060083`*^9, 3.6856820338793163`*^9}, {
   3.685682083417005*^9, 3.685682092894709*^9}, {3.6856840260308533`*^9, 
   3.685684026178547*^9}, {3.685686819102976*^9, 3.6856868408053513`*^9}, {
   3.685687011142066*^9, 3.685687017829006*^9}, {3.685687131249773*^9, 
   3.685687151398356*^9}, {3.685687183159276*^9, 3.6856871838215933`*^9}, {
   3.685687254295497*^9, 3.685687281286789*^9}, {3.685687660039452*^9, 
   3.6856877115995817`*^9}, {3.68568838863011*^9, 3.6856884381337767`*^9}, {
   3.685690949932845*^9, 3.6856909574232817`*^9}, {3.685691048596792*^9, 
   3.685691065258542*^9}, {3.685691555385049*^9, 3.685691595897393*^9}, {
   3.685693407917099*^9, 3.6856934105491962`*^9}, {3.685693449539488*^9, 
   3.685693464972211*^9}, {3.685693732995039*^9, 3.6856937393916893`*^9}, {
   3.685693867613049*^9, 3.685693870503192*^9}, {3.685694016861869*^9, 
   3.685694053583612*^9}, {3.685694415120605*^9, 3.685694415410471*^9}, {
   3.6856953860999413`*^9, 3.685695404607368*^9}, {3.68569555947088*^9, 
   3.685695605133265*^9}, {3.685696124318612*^9, 3.68569613828201*^9}, {
   3.685696178849712*^9, 3.685696180401723*^9}, {3.685696592780033*^9, 
   3.6856965970349083`*^9}, {3.6870711449669037`*^9, 3.687071165830688*^9}, {
   3.6870725649937353`*^9, 3.687072567422408*^9}, {3.711081329746539*^9, 
   3.711081335862384*^9}, {3.711083709642126*^9, 3.71108372803414*^9}, {
   3.712990896317184*^9, 3.712990899230811*^9}, {3.713603056038671*^9, 
   3.7136030717991047`*^9}, 3.713603337329356*^9, {3.7136034598308163`*^9, 
   3.713603470204297*^9}, {3.713604348937676*^9, 3.71360436129599*^9}, {
   3.717147714818186*^9, 3.717147739983534*^9}, {3.7171480835458517`*^9, 
   3.717148091231995*^9}, {3.726560324583314*^9, 3.7265603577752657`*^9}, {
   3.726853588279467*^9, 3.7268536391946774`*^9}, {3.7271789201847763`*^9, 
   3.727178947159677*^9}, {3.7275066313384666`*^9, 3.72750665317505*^9}, {
   3.727513894430643*^9, 3.727513902461985*^9}, {3.727596618528956*^9, 
   3.727596645209611*^9}, {3.727601483861143*^9, 3.7276014841869497`*^9}, {
   3.7276028953923073`*^9, 3.727602914012473*^9}, {3.728109699712471*^9, 
   3.728109743760724*^9}, {3.728765837392223*^9, 3.728765846807078*^9}, {
   3.7340775949863367`*^9, 3.734077598710491*^9}, {3.7372791075805187`*^9, 
   3.73727914741197*^9}, {3.7372792368998547`*^9, 3.737279256825714*^9}, {
   3.737285569781273*^9, 3.737285603410686*^9}, {3.739187854951786*^9, 
   3.73918785517507*^9}, {3.742016334042914*^9, 3.742016337494812*^9}, {
   3.742016368507223*^9, 3.74201638931714*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"f6062f54-1222-4d57-ae33-6e13722a2bcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[142]:=",ExpressionUUID->"fcf44abb-fe7e-43b2-b3b8-089963ee157a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", "\[IndentingNewLine]", 
   RowBox[{"input_List", ",", "\[IndentingNewLine]", 
    RowBox[{"labels___", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", ",", 
           "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
           "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], ",", 
         RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"check", ",", "hkl", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"check", "=", 
      RowBox[{"{", "labels", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"check", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<1hkl\>\"", ",", "\"\<1xyz\>\"", ",", "\"\<Integer\>\"", 
               ",", "\"\<Multiple\>\"", ",", "\[IndentingNewLine]", 
               "\"\<StringSymbol\>\"", ",", "\"\<WrapSingle\>\""}], "}"}], 
             ",", "temp"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"InputCheck", "::", "label"}], ",", "temp"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "check"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Dimensions", " ", "check", " ", 
       RowBox[{"(", 
        RowBox[{"always", " ", "required"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Single", " ", 
        RowBox[{"reflection", "/", "coordinate"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"input", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
            "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"hkl", "=", 
        RowBox[{"{", "input", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Multiple", " ", 
         RowBox[{"reflections", "/", "coordinates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "/;", 
             RowBox[{"!", 
              RowBox[{"AnyTrue", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "ListQ"}], 
               "]"}]}]}]}], "]"}], "&"}]}], "]"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{"hkl", "=", "input"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"None", " ", "of", " ", "the", " ", "above"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "dim"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", 
       RowBox[{"reflection", "/", "coordinates"}], " ", "check"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1hkl\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<reflection\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<1xyz\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "\[NotEqual]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "one"}], ",", "\"\<coordinate\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Multiple", " ", "reflections", " ", "check"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Multiple\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "hkl"}], "<", "2"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "few"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Integer", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<Integer\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "hkl"}], ",", "IntegerQ"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "integer"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "if", " ", "Integer"}], ",", " ", 
       RowBox[{"String", " ", "or", " ", "Symbol"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<StringSymbol\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ContainsAll", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Integer", ",", "String", ",", "Symbol", ",", "Times"}], 
             "}"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Head", "/@", 
             RowBox[{"Flatten", "@", "hkl"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "head"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Wrap", " ", "single", " ", "reflections"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"check", ",", "\"\<WrapSingle\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"ListQ", "[", "#", "]"}]}], "&"}], ")"}]}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "input", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"Return", "[", "input", "]"}]}], "\[IndentingNewLine]", "\t",
         "]"}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.687070782983131*^9, 3.687070826316058*^9}, {
   3.711080493388452*^9, 3.711080530269607*^9}, {3.7110838434149733`*^9, 
   3.711083844960722*^9}, {3.712990600076755*^9, 3.712990608318782*^9}, {
   3.712990804480831*^9, 3.7129908060016212`*^9}, {3.712990947248521*^9, 
   3.712990947808515*^9}, {3.713510243799721*^9, 3.7135102514986553`*^9}, {
   3.713510288538774*^9, 3.713510293259116*^9}, {3.7135103372502947`*^9, 
   3.713510338184915*^9}, {3.71431192571665*^9, 3.7143119392365303`*^9}, {
   3.7143120972494097`*^9, 3.714312097447524*^9}, {3.7143121915742683`*^9, 
   3.7143122110300217`*^9}, {3.714312273573138*^9, 3.714312308114839*^9}, {
   3.71445784032449*^9, 3.714457847602706*^9}, 3.714458049967931*^9, {
   3.7147109057397537`*^9, 3.714710909787726*^9}, {3.714710945019298*^9, 
   3.714710963965468*^9}, {3.717143871479184*^9, 3.717143873754469*^9}, {
   3.717146708601173*^9, 3.717146713501816*^9}, {3.717147467353772*^9, 
   3.717147472518999*^9}, {3.717147554646175*^9, 3.717147555923188*^9}, {
   3.717147595628448*^9, 3.717147596128397*^9}, 3.7171476872925243`*^9, {
   3.717147790297018*^9, 3.7171478112554407`*^9}, {3.7171480444680862`*^9, 
   3.717148048818454*^9}, {3.7171482182403383`*^9, 3.7171482183828487`*^9}, {
   3.717148818843635*^9, 3.717148834361803*^9}, {3.7171489319542913`*^9, 
   3.717148951600135*^9}, {3.717149178012879*^9, 3.71714919115486*^9}, {
   3.717149260050128*^9, 3.717149280072538*^9}, {3.717149333315688*^9, 
   3.717149397350493*^9}, {3.717149552908246*^9, 3.7171495813302383`*^9}, {
   3.718521630559267*^9, 3.718521641789692*^9}, {3.7185216726962433`*^9, 
   3.7185216733580647`*^9}, {3.718636471385057*^9, 3.7186364749898767`*^9}, {
   3.7186366347963343`*^9, 3.718636636271434*^9}, {3.7259581138852463`*^9, 
   3.725958115603722*^9}, {3.7372783098194*^9, 3.737278316869255*^9}, 
   3.737371806626379*^9, 3.737384013131838*^9, {3.7373840435457*^9, 
   3.7373840851194687`*^9}, {3.737384137351205*^9, 3.73738418240597*^9}, {
   3.7373842155798798`*^9, 3.737384232171645*^9}, {3.737384415256804*^9, 
   3.737384433510865*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[143]:=",ExpressionUUID->"582dd116-7bbf-4577-b0db-a95e7cf4dbe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<CrystalQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "entry", " ", "exists", " ", 
     RowBox[{"in", " ", "'"}], 
     RowBox[{"$CrystalData", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MissingQ", "@", 
      RowBox[{"$CrystalData", "[", "input", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "crystal"}], ",", "input"}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.7276035463522577`*^9, 
   3.72760354706783*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[144]:=",ExpressionUUID->"2573f9e8-2af9-42ca-94dd-d3fbf8c90797"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"centring_String", ",", "\"\<GetCentringVectors\>\""}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "vectors", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"centring", "===", "\"\<P\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<F\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<I\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<R\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<A\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<B\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "0", ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<C\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", 
           RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"centring", "===", "\"\<H\>\""}], ",", 
       RowBox[{"vectors", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "/", "3"}], ",", 
            RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "3"}], ",", 
            RowBox[{"2", "/", "3"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "centringerror"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"vectors", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}, {
   3.734077376632456*^9, 3.734077480964463*^9}, {3.734412586131454*^9, 
   3.7344125991220827`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[145]:=",ExpressionUUID->"dbcf2741-11e4-4698-a8af-daf49f068290"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalFormulaUnits\>\""}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
       "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
         "\"\<FormulaUnits\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"input", ",", "\"\<FormulaUnits\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "not"}], ",", " ", 
         RowBox[{"query", " ", "user", " ", "manually"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"InputString", "[", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Cannot determine the number of formula units \>\"", "<>", 
           "\[IndentingNewLine]", "\"\<for \[LeftGuillemet]\>\"", "<>", 
           "input", "<>", "\"\<\[RightGuillemet].\>\"", "<>", "\"\<\\n\>\"", "<>",
            "\[IndentingNewLine]", 
           "\"\<Please enter that number or the density below.\>\""}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "output"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"InputCheck", "::", "userinput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", "output"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.727178717966507*^9, 
   3.727178721188702*^9}, {3.727178758964155*^9, 3.727178761323883*^9}, {
   3.727178860595625*^9, 3.727178901192408*^9}, {3.727178964913246*^9, 
   3.727178966567266*^9}, {3.727601687423465*^9, 3.727601704808043*^9}, {
   3.727601744534422*^9, 3.727601771061698*^9}, {3.727602475651042*^9, 
   3.727602607286476*^9}, {3.7276026482929697`*^9, 3.727602649418606*^9}, {
   3.727602816432906*^9, 3.727602879307555*^9}, {3.7276029234914637`*^9, 
   3.727602926124346*^9}, {3.727603730383863*^9, 3.72760373066368*^9}, {
   3.727603973849247*^9, 3.7276039750255003`*^9}, {3.738049785054161*^9, 
   3.7380497898471613`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[146]:=",ExpressionUUID->"9ccfd331-de3b-4fca-9f9d-02e8c569c92d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalSpaceGroup\>\""}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "is", " ", "valid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.727506566988821*^9, 
   3.7275065675308313`*^9}, {3.7276035560711937`*^9, 3.72760355630114*^9}, {
   3.7276036304674597`*^9, 3.727603631524433*^9}, 3.727676784104806*^9, {
   3.7340864321506767`*^9, 3.7340865206369267`*^9}, 3.743865456049979*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[147]:=",ExpressionUUID->"bf221871-bd0a-4a76-8548-8cb2f84c0102"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<GetCrystalWavelength\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InputCheck", "[", 
     RowBox[{"input", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Return", " ", "crystal", " ", "wavelength", " ", "if", " ", 
      "attached"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"$CrystalData", "[", "input", "]"}], ",", 
        "\"\<Wavelength\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "@", 
       RowBox[{"$CrystalData", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{"input", ",", "\"\<Wavelength\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", " ", "not"}], ",", " ", 
        RowBox[{
         RowBox[{"abort", " ", "OR", " ", 
          RowBox[{"return", " ", "'"}]}], "-", 
         RowBox[{"1", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"abortQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InputCheck", "::", "wavelength"}], ",", "input"}], "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}],
    ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.739125707135515*^9, 3.7391257657796993`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[148]:=",ExpressionUUID->"4076f94c-029e-4e4f-be5f-3bb8a6a0ae57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Converts", " ", "to", " ", 
    RowBox[{"wavelength", " ", "[", "\[ARing]ngstr\[ODoubleDot]ms", "]"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"InputCheck", "[", 
    RowBox[{"input_", ",", "\"\<GetEnergyWavelength\>\"", ",", 
     RowBox[{"unitsQ_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hcKeV", "=", "12.398420"}], ",", "\[Lambda]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Only", " ", "exception"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"input", "===", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"-", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "if", " ", "positive"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"Positive", "@", "input"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "poslambda"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"A", ".", " ", "Number"}], " ", "input"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NumericQ", "@", "input"}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"1.", " ", "Assume", " ", "\[ARing]ngstr\[ODoubleDot]ms"}], 
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"input", " ", "\[LessEqual]", " ", "5.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"N", "@", "input"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"2.", " ", "Assume", " ", "kilo", " ", "electronvolt"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{"input", " ", "\[LessEqual]", " ", "250.0"}], ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", "input"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"3.", " ", "Assume", " ", "electronvolts"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"1000", "*", 
            RowBox[{"hcKeV", "/", "input"}]}]}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Quantity"}], " ", "input"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"QuantityQ", "[", "input", "]"}], " ", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Convert", " ", "wavelength", " ", "or", " ", "energy", " ", "to", 
          " ", "\[ARing]ngstr\[ODoubleDot]ms"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"UnitDimensions", "[", "input", "]"}], "===", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\"\<LengthUnit\>\"", ",", "1"}], "}"}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"\[Lambda]", "=", 
            RowBox[{"UnitConvert", "[", 
             RowBox[{"input", ",", "\"\<Angstroms\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"unitsQ", ",", 
             RowBox[{"Return", "@", "\[Lambda]"}], ",", 
             RowBox[{"Return", "@", 
              RowBox[{"QuantityMagnitude", "@", "\[Lambda]"}]}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"CompatibleUnitQ", "[", 
           RowBox[{"input", ",", "\"\<Joules\>\""}], "]"}], ",", "\t\t", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"hcKeV", "/", 
            RowBox[{"QuantityMagnitude", "@", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"UnitConvert", "[", 
              RowBox[{"input", ",", "\"\<Kiloelectronvols\>\""}], "]"}]}]}]}],
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"InputCheck", "::", "energyunit"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"C", ".", " ", "None"}], " ", "of", " ", "the", " ", 
          "above"}], " ", "*)"}], "\[IndentingNewLine]", "True", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"InputCheck", "::", "energyinput"}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Set", " ", "in", " ", "Quantity", " ", "if", " ", "desired"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"unitsQ", ",", "\[IndentingNewLine]", 
        RowBox[{"Quantity", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Angstroms\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\[Lambda]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609703542757*^9}, 3.713609761205812*^9, {
   3.714456648703538*^9, 3.7144566607405*^9}, {3.714462761679092*^9, 
   3.714462774005431*^9}, {3.7144628807577868`*^9, 3.714462892938987*^9}, {
   3.714711288174638*^9, 3.7147112901418753`*^9}, {3.717740904496645*^9, 
   3.71774090450635*^9}, 3.725958197232127*^9, {3.726560443424157*^9, 
   3.726560447064084*^9}, 3.72685205362494*^9, {3.7268524061436033`*^9, 
   3.7268525118996563`*^9}, {3.726853451219391*^9, 3.726853553519404*^9}, {
   3.72685364594137*^9, 3.726853659220982*^9}, {3.726853721494712*^9, 
   3.7268537360194597`*^9}, {3.726853814139167*^9, 3.726853866046702*^9}, {
   3.72685391283145*^9, 3.726854013342908*^9}, {3.72685443464507*^9, 
   3.726854444243165*^9}, {3.726854740941407*^9, 3.726854744623098*^9}, {
   3.726854833074029*^9, 3.726854873935768*^9}, {3.72685491084039*^9, 
   3.726854918136497*^9}, {3.72685498979923*^9, 3.726855068318531*^9}, {
   3.726855109331604*^9, 3.726855122067479*^9}, {3.7268555301237164`*^9, 
   3.726855539752921*^9}, {3.7268559339858027`*^9, 3.726855959866241*^9}, {
   3.7268559904322023`*^9, 3.72685603510135*^9}, {3.72685615357065*^9, 
   3.72685615402689*^9}, {3.726856216650893*^9, 3.726856369277254*^9}, {
   3.7268564800835943`*^9, 3.7268564992580137`*^9}, {3.726856620967496*^9, 
   3.726856621815027*^9}, {3.726856668775392*^9, 3.726856720204636*^9}, {
   3.7268568209881*^9, 3.72685684971353*^9}, {3.72685688102668*^9, 
   3.7268569498483753`*^9}, {3.7268570554316273`*^9, 3.726857141124441*^9}, {
   3.72685733536134*^9, 3.726857445821105*^9}, {3.7268574798936377`*^9, 
   3.726857484116231*^9}, {3.726857520876247*^9, 3.726857597705496*^9}, {
   3.7268576490821247`*^9, 3.726857665286269*^9}, {3.726896856919681*^9, 
   3.726896865360489*^9}, {3.726897043655274*^9, 3.72689706577814*^9}, {
   3.726899351343816*^9, 3.726899381328332*^9}, 3.7268997978240433`*^9, {
   3.7275466850188923`*^9, 3.727546685984756*^9}, {3.727596442016464*^9, 
   3.727596443184536*^9}, {3.7275965437672157`*^9, 3.727596576954631*^9}, 
   3.727596651111322*^9, {3.72760374260155*^9, 3.727603759529471*^9}, {
   3.728109774970121*^9, 3.728109880586781*^9}, 3.73441267980902*^9, {
   3.738049815649427*^9, 3.738049826421247*^9}, {3.7391251770910673`*^9, 
   3.739125211688257*^9}, {3.7391256829934187`*^9, 3.739125689976153*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[149]:=",ExpressionUUID->"46300c07-37a8-4c26-9c3c-bfd429ab81d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "if", " ", "space", " ", "group", " ", "number", " ", "is",
       " ", "given"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "\[LessEqual]", "input", "\[LessEqual]", "230"}], ")"}],
         "&&", 
        RowBox[{"IntegerQ", "@", "input"}]}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"$SpaceGroups", "[", 
         RowBox[{"[", 
          RowBox[{"input", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], 
          "]"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "If", " ", "actual", " ", "input", " ", "is", " ", "a", " ", 
         "point"}], "-", " ", 
        RowBox[{"or", " ", "space", " ", "group"}]}], ",", " ", 
       RowBox[{"return", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}], ",", 
       RowBox[{"Return", "@", "input"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "crystal", " ", "entry", " ", "exists"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "@", 
        RowBox[{"$CrystalData", "[", "input", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "PSGC"}], ",", "input"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "space", " ", "group", " ", "of", " ", 
       "crystal", " ", "exists"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"input", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"$GroupSymbolRedirect", ",", "sg"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "crystalSG"}], ",", "input", ",", 
          "sg"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "sg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609865523466*^9, 
   3.713609889562788*^9}, {3.7144567047959967`*^9, 3.714456760475725*^9}, {
   3.714456865530085*^9, 3.714456883711838*^9}, {3.7144569578701982`*^9, 
   3.714456970919194*^9}, {3.7147103047089357`*^9, 3.7147103160470448`*^9}, {
   3.714710780931141*^9, 3.714710786371043*^9}, {3.714711349610618*^9, 
   3.714711369582601*^9}, {3.717740904523778*^9, 3.717740920672461*^9}, {
   3.725958236767309*^9, 3.725958238463688*^9}, {3.727505577163589*^9, 
   3.7275055992983847`*^9}, {3.727505895015423*^9, 3.7275058952018433`*^9}, {
   3.727506115867244*^9, 3.72750615284511*^9}, {3.72750620550637*^9, 
   3.727506277082754*^9}, 3.7275065790218277`*^9, 3.72750668943563*^9, {
   3.7275138768842697`*^9, 3.727513877580575*^9}, {3.7276037003393583`*^9, 
   3.7276037005968237`*^9}, {3.727603930848737*^9, 3.727603935750414*^9}, {
   3.734086562493793*^9, 3.734086592174155*^9}, {3.734087081953874*^9, 
   3.734087111656989*^9}, {3.743865456115304*^9, 3.743865456153502*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[150]:=",ExpressionUUID->"40d1c1ed-62fb-4df8-907d-7b157fdb296f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretElement\>\""}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"elementsIn", "=", "input"}], ",", "pertiodicTable", ",", 
      "elementsRead", ",", "elementsReadNeutral", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{"elementsIn", ",", "NumberString"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"elementsIn", "=", 
          RowBox[{"ToExpression", "@", "elementsIn"}]}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{"in", " ", "the", " ", "periodic", " ", "table"}], ")"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "elementsIn"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "elementsIn", "\[LessEqual]", 
            RowBox[{"Length", "@", "$PeriodicTable"}]}], ")"}], "&&", 
          RowBox[{"IntegerQ", "@", "elementsIn"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Keys", "@", "$PeriodicTable"}], ")"}], "[", 
           RowBox[{"[", "elementsIn", "]"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InputCheck", "::", "ElementNumber"}], ",", 
            RowBox[{"ToString", "@", "elementsIn"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "single", " ", "string", " ", 
       "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Wrap"}], " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "elementsIn"}], ",", 
       RowBox[{"elementsIn", "=", 
        RowBox[{"{", "elementsIn", "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Process"}], " ", "list", " ", "of", " ", 
       "strings", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "input", " ", "is", 
       " ", "a", " ", "list", " ", "of", " ", "strings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "elementsIn"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"elementsIn", ",", "StringQ"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".2", ".", " ", "Set"}], " ", "of", " ", "valid", " ", 
       "symbols", " ", "from", " ", "the", " ", "periodic", " ", "table"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pertiodicTable", "=", 
      RowBox[{"Keys", "@", "$PeriodicTable"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"C", 
        RowBox[{".3", ".", " ", "Find"}], " ", 
        RowBox[{"(", "possible", ")"}], " ", "matches"}], ",", " ", 
       RowBox[{"and", " ", "establish", " ", "order"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"elementsIn", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StartOfString", "~~", 
          RowBox[{"a", ":", "LetterCharacter"}], "~~", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{"b", ":", "LetterCharacter"}]}], "}"}], "~~", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", 
            RowBox[{
             RowBox[{"n1", ":", 
              RowBox[{"DigitCharacter", "..."}]}], "~~", 
             RowBox[{"pm", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n2", ":", 
              RowBox[{"DigitCharacter", "..."}]}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"ToUpperCase", "[", "a", "]"}], "<>", 
          RowBox[{"ToLowerCase", "[", "b", "]"}], "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n1", "===", "\"\<\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"n2", "===", "\"\<\>\""}], ")"}]}], ",", "\"\<1\>\"", 
            ",", "\"\<\>\""}], "]"}], "<>", "n1", "<>", "n2", "<>", 
          "pm"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Check", " ", "for", " ", "non"}], "-", "elements"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"elementsRead", ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsRead", ",", 
               RowBox[{"{", "}"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Separate", " ", "element", " ", "symbol", " ", "and", " ", "charge", 
       " ", 
       RowBox[{"(", 
        RowBox[{"if", " ", "any"}], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "elementsRead"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"a", ":", 
             RowBox[{"LetterCharacter", ".."}]}], "~~", "b___"}], 
           "\[IndentingNewLine]", "\t", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"b", "===", "\"\<\>\""}], ",", "\"\<&\>\"", ",", "b"}],
               "]"}]}], "}"}]}]}], "]"}], ",", "1"}], "]"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"'", "&"}], "'"}], " ", "should", " ", "be", " ", "deleted", 
       " ", "later"}], " ", "*)"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsRead", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".4", ".", " ", "Remove"}], " ", "second", " ", "character", 
       " ", "if", " ", "not", " ", "applicable"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{
        RowBox[{"s_String", "/;", "\[IndentingNewLine]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"pertiodicTable", ",", "s"}], "]"}]}]}], "\[RuleDelayed]", 
        
        RowBox[{"StringTake", "[", 
         RowBox[{"s", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", "deuterium"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"elementsReadNeutral", "=", 
      RowBox[{"elementsReadNeutral", "/.", 
       RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".5", ".", " ", "Final"}], " ", "validity", " ", "check"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"elementsReadNeutral", ",", "pertiodicTable"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"temp", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"InputCheck", "::", "ElementError"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Part", "[", 
           RowBox[{"elementsIn", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"elementsReadNeutral", ",", "\[IndentingNewLine]", 
               RowBox[{"First", "@", "temp"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".6", ".", " ", "Concatenate"}], " ", "elements", " ", "and", 
       " ", "charge"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"elementsRead", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", "elementsReadNeutral"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"elementsRead", "/.", 
       RowBox[{"\"\<1\>\"", "\[Rule]", "\"\<\>\""}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elementsRead", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"StringJoin", "/@", "elementsRead"}], ",", "\"\<&\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "chemical", " ", "element"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<ElementFailed\>\""}], ",", 
       RowBox[{"ToString", "@", "input"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Abort", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"b", ".", " ", "Return"}], " ", "string", " ", 
       RowBox[{"(", 
        RowBox[{"or", " ", "list", " ", "of", " ", "strings"}], ")"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "input"}], ",", "\[IndentingNewLine]", 
       RowBox[{"elementsRead", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "elementsRead"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278567175089*^9, 
   3.737278609150566*^9}, {3.737278661861796*^9, 3.7372787061104527`*^9}, {
   3.737278786430764*^9, 3.737278815614232*^9}, {3.737278876614931*^9, 
   3.737278894575992*^9}, {3.737279063214642*^9, 3.737279117617867*^9}, {
   3.737279153995288*^9, 3.737279156957521*^9}, {3.737279209224059*^9, 
   3.7372792281945353`*^9}, {3.737279265333662*^9, 3.7372792662517557`*^9}, {
   3.737279499593874*^9, 3.7372795003597097`*^9}, {3.7372795311927958`*^9, 
   3.737279607430427*^9}, {3.737279901036427*^9, 3.737279905187501*^9}, {
   3.73728056780586*^9, 3.737280595834815*^9}, {3.737280731938634*^9, 
   3.7372807824368553`*^9}, {3.737280821275927*^9, 3.737280850048135*^9}, {
   3.7372808982833033`*^9, 3.7372809507817802`*^9}, {3.737281047830305*^9, 
   3.737281064716365*^9}, {3.7372811554403543`*^9, 3.73728118861235*^9}, {
   3.7372812569776163`*^9, 3.737281316071546*^9}, {3.737281653054924*^9, 
   3.737281698062044*^9}, {3.737284237057*^9, 3.737284327083954*^9}, {
   3.7372843590048733`*^9, 3.737284369739956*^9}, {3.7372844386235523`*^9, 
   3.737284484892178*^9}, {3.7372850819056*^9, 3.737285090806818*^9}, {
   3.73728520111075*^9, 3.737285222748335*^9}, {3.737285270111203*^9, 
   3.73728530587646*^9}, {3.737285533840251*^9, 3.737285559292869*^9}, {
   3.7372856101403227`*^9, 3.737285657390164*^9}, {3.737285700136235*^9, 
   3.737285798718968*^9}, {3.7372858357113028`*^9, 3.737285868194257*^9}, {
   3.737285908459991*^9, 3.737286014905347*^9}, 3.737286052837697*^9, {
   3.7372861540618677`*^9, 3.737286154519107*^9}, {3.737286254980082*^9, 
   3.7372863413456507`*^9}, {3.737286380256139*^9, 3.7372864143825283`*^9}, {
   3.737286458977261*^9, 3.737286576079788*^9}, {3.737286623935347*^9, 
   3.737286632869177*^9}, {3.7372866648183327`*^9, 3.737286723584116*^9}, {
   3.737374746359795*^9, 3.737374832079135*^9}, {3.73737499904206*^9, 
   3.737375023959383*^9}, {3.737378138033321*^9, 3.737378164259573*^9}, {
   3.737378225363977*^9, 3.73737825691322*^9}, 3.7373784605339413`*^9, {
   3.737378502252293*^9, 3.73737864023484*^9}, {3.737378704823086*^9, 
   3.737378712047621*^9}, {3.737378750431796*^9, 3.737378752703669*^9}, {
   3.737378898239748*^9, 3.737378990411519*^9}, {3.73737903566635*^9, 
   3.7373791239583397`*^9}, {3.737379162032648*^9, 3.737379164836317*^9}, {
   3.7373792649735928`*^9, 3.7373793244342623`*^9}, {3.737379375913303*^9, 
   3.73737941501803*^9}, {3.737379491076782*^9, 3.737379495461954*^9}, {
   3.737379605763606*^9, 3.7373796928169928`*^9}, {3.73737986755727*^9, 
   3.7373800849030933`*^9}, {3.7373801268150043`*^9, 
   3.7373801843010073`*^9}, {3.737380294292263*^9, 3.737380294698414*^9}, {
   3.737380414361321*^9, 3.737380698358766*^9}, {3.7373807418017273`*^9, 
   3.73738075376825*^9}, {3.7373807854482927`*^9, 3.737380862411724*^9}, {
   3.737381036834449*^9, 3.737381064693281*^9}, {3.737381100937663*^9, 
   3.7373811217752542`*^9}, 3.737381158470895*^9, 3.737381221032393*^9, {
   3.737381678459423*^9, 3.737381805116645*^9}, {3.737381836958056*^9, 
   3.737381881326532*^9}, {3.737381917168672*^9, 3.7373819592222023`*^9}, {
   3.737382007542437*^9, 3.737382116848222*^9}, {3.7373821591203203`*^9, 
   3.737382355002592*^9}, {3.7379744155182457`*^9, 3.737974415670136*^9}, {
   3.7379754153411427`*^9, 3.737975452667324*^9}, {3.73797549962778*^9, 
   3.7379755241789637`*^9}, 3.737975563770276*^9, {3.737975648095365*^9, 
   3.7379756613659477`*^9}, {3.73921005915567*^9, 3.739210067088846*^9}, {
   3.7392103437571*^9, 3.739210372090125*^9}, {3.7392104083569927`*^9, 
   3.739210408785853*^9}, {3.739210561112054*^9, 3.739210658951914*^9}, {
   3.742878249248098*^9, 3.7428782535467987`*^9}, {3.7428782893930473`*^9, 
   3.742878353943668*^9}, {3.742878774060712*^9, 3.7428787793596373`*^9}, {
   3.742878811736623*^9, 3.742878976915493*^9}, {3.7428790184091597`*^9, 
   3.7428790837272663`*^9}, {3.742879158784565*^9, 3.7428791803486032`*^9}, {
   3.742879211104168*^9, 3.742879211738106*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[151]:=",ExpressionUUID->"980d813f-5ce6-44d1-8dac-360bec13d687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_", ",", "\"\<InterpretSpaceGroup\>\"", ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sg", "=", "input"}], ",", "o", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", 
      RowBox[{"A", ".", " ", "Input"}], " ", "number", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"A", 
      RowBox[{".1", ".", " ", "Check"}], " ", "whether", " ", "number", " ", 
      "is", " ", "a", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringMatchQ", "[", 
          RowBox[{
           RowBox[{"StringTrim", "@", "sg"}], ",", "NumberString"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"sg", "=", 
          RowBox[{"ToExpression", "@", "sg"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"A", 
       RowBox[{".2", ".", " ", "Check"}], " ", "if", " ", "valid", " ", 
       "integer", " ", 
       RowBox[{"(", 
        RowBox[{
        "a", " ", "canonical", " ", "space", " ", "group", " ", "number"}], 
        ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "@", "sg"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "\[LessEqual]", "sg", "\[LessEqual]", "230"}], ")"}], 
          "&&", 
          RowBox[{"IntegerQ", "@", "sg"}]}], ",", 
         RowBox[{"Return", "@", 
          RowBox[{"$SpaceGroups", "[", 
           RowBox[{"[", 
            RowBox[{"sg", ",", "\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}],
            "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"InputCheck", "::", "SGnumber"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"abortQ", ",", 
            RowBox[{"Abort", "[", "]"}], ",", 
            RowBox[{"Return", "@", "Null"}]}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"B", ".", " ", "Process"}], " ", "string", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", 
       RowBox[{".1", ".", " ", "Check"}], " ", "if", " ", "string"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringQ", "@", "sg"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".2", " ", "Process", " ", "any", " ", "annotations"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"sg", ",", "\"\<origin\>\"", ",", 
         RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"o", "=", 
         RowBox[{"ChoiceDialog", "[", 
          RowBox[{
           RowBox[{
           "\"\<Information on cell origin detected.\>\"", "<>", 
            "\[IndentingNewLine]", "\"\<\\n\>\"", "<>", 
            "\"\<Please confirm the cell origin.\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"WindowTitle", "\[Rule]", "\"\<Cell origin\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"sg", ",", 
           RowBox[{
           "Whitespace", "~~", "\"\<(\>\"", "~~", "__", "~~", "\"\<)\>\""}]}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"B", ".3", " ", "Tidy", " ", "string"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sg", "=", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "sg", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"B", ".4", 
           RowBox[{".1", ".", " ", "Remove"}], " ", "any", " ", "_enclosing", 
           "_", " ", "quotation", " ", "marks"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Note", ":", " ", 
           RowBox[{
           "Some", " ", "Hall", " ", "symbols", " ", "contain", " ", "double",
             " ", "quotation", " ", "marks"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "main__", "~~", 
            RowBox[{"{", 
             RowBox[{"\"\<'\>\"", ",", "\"\<\\\"\>\""}], "}"}], "~~", 
            "EndOfString"}], "\[RuleDelayed]", "main"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".2", " ", "Uppercase", " ", "centring", " ", "1"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StartOfString", "~~", 
            RowBox[{"first", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<-\>\"", "~~", "_"}], ",", "_"}], "}"}]}], "~~", 
            "rest__", "~~", "EndOfString"}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ToUpperCase", "@", "first"}], "~~", 
            RowBox[{"ToLowerCase", "@", "rest"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".3", ".", " ", "Fix"}], " ", "boxes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<overscriptbox\>\"", "\[Rule]", "\"\<OverscriptBox\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<subscriptbox\>\"", "\[Rule]", "\"\<SubscriptBox\>\""}]}], 
           "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "B", ".4", ".4", " ", "Uppercase", " ", "centring", " ", "2"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<Box[\\(\>\"", "~~", "c_"}], "\[RuleDelayed]", 
           RowBox[{"\"\<Box[\\(\>\"", "<>", 
            RowBox[{"ToUpperCase", "[", "c", "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", ".5", " ", "Screw", " ", "axes"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"a", ":", "DigitCharacter"}], "~~", "\"\<(\>\"", "~~", 
            RowBox[{"b", ":", "DigitCharacter"}], "~~", "\"\<)\>\""}], 
           "\[RuleDelayed]", 
           RowBox[{"a", "<>", "b"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"B", ".4", 
            RowBox[{".6", ".", " ", "Miscellaneous"}], " ", "replacements"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\"\<;\>\"", "\[Rule]", "\"\< \>\""}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sg", "=", 
      RowBox[{"StringTrim", "@", "sg"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"C", ".", " ", "Check"}], " ", "symbol", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", 
       RowBox[{".1", ".", " ", "Check"}], " ", "centring", " ", "symbol"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<P\>\"", ",", "\"\<I\>\"", ",", "\"\<F\>\"", ",", "\"\<R\>\"", 
            ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", 
            "\"\<H\>\"", ",", "\"\<\\!\>\"", ",", "\"\<-\>\""}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StringTake", "[", 
           RowBox[{"sg", ",", "1"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"C", ".2", " ", "Check", " ", "if", " ", "found", " ", 
       RowBox[{"by", " ", "'"}], 
       RowBox[{"$GroupSymbolRedirect", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "sg", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"temp", ",", "\"\<PointGroupNumber\>\""}], "]"}], ",", 
          RowBox[{"Goto", "[", "\"\<Failed\>\"", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"temp", "[", 
          RowBox[{"[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}], "]"}]}], 
        ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Exception", ":", " ", 
       RowBox[{"Old", " ", "symbol"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sg", "===", "\"\<Fm3m\>\""}], ",", 
       RowBox[{
        RowBox[{"sg", "=", "\"\<Fm-3m\>\""}], ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "C", ".3", " ", "Delete", " ", "whitespace", " ", "and", " ", "check", 
       " ", "again"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"sg", ",", "Whitespace"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "temp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "temp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sg", "=", 
         RowBox[{"temp", "[", 
          RowBox[{"[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}], "]"}]}], 
        ";", 
        RowBox[{"Goto", "[", "\"\<SpaceGroupFound\>\"", "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", 
       RowBox[{"D", ".", " ", "Post"}], " ", "process", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"A", ".", " ", "Unable"}], " ", "to", " ", "determine", " ", 
       "space", " ", "group"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Failed\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "\"\<SG\>\""}], ",", "input"}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"abortQ", ",", 
       RowBox[{"Abort", "[", "]"}], ",", 
       RowBox[{"Return", "@", "Null"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"B", ".", " ", "Return"}], " ", "non"}], "-", 
       RowBox[{"ambiguous", " ", "output"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<SpaceGroupFound\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "o", "]"}], ",", 
       RowBox[{"sg", "=", 
        RowBox[{"sg", "<>", "\"\<:\>\"", "<>", 
         RowBox[{"ToString", "[", "o", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ToStandardSetting", "[", "sg", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.734341137328184*^9, 3.7343411759988194`*^9}, {
   3.734341475311934*^9, 3.734341576694551*^9}, {3.734341967735984*^9, 
   3.734342044717266*^9}, {3.7343421124130297`*^9, 3.7343421147220497`*^9}, {
   3.734342157264969*^9, 3.7343421593299932`*^9}, {3.734342221153916*^9, 
   3.734342268636704*^9}, {3.734342315367675*^9, 3.734342348352634*^9}, {
   3.734342660472481*^9, 3.734342708367038*^9}, {3.734343038667759*^9, 
   3.734343065102769*^9}, {3.734343158173188*^9, 3.7343432657514677`*^9}, {
   3.734343330059511*^9, 3.734343345374936*^9}, {3.734343379084358*^9, 
   3.734343384220396*^9}, {3.734343453912177*^9, 3.734343472607889*^9}, {
   3.73434351476071*^9, 3.7343435158786793`*^9}, {3.734343583617649*^9, 
   3.7343436514341507`*^9}, {3.734343683030909*^9, 3.734343832579129*^9}, {
   3.7343438677100477`*^9, 3.7343439724631023`*^9}, {3.7343440088952208`*^9, 
   3.734344052952825*^9}, {3.734344095501465*^9, 3.7343441133871517`*^9}, {
   3.734344504885613*^9, 3.7343445722004347`*^9}, {3.734344746741618*^9, 
   3.734344778504403*^9}, {3.734344844849532*^9, 3.7343448449792213`*^9}, {
   3.734344914208906*^9, 3.734344914690722*^9}, {3.734344971285687*^9, 
   3.7343449799500437`*^9}, {3.7344114140022373`*^9, 3.734411571230638*^9}, {
   3.73441172129373*^9, 3.73441173825721*^9}, {3.734412700777219*^9, 
   3.734412709319187*^9}, {3.734413527709764*^9, 3.734413550093383*^9}, {
   3.7344137797137613`*^9, 3.7344137798642187`*^9}, {3.734413835296232*^9, 
   3.734413924894289*^9}, 3.734413976109795*^9, {3.734414156561953*^9, 
   3.7344141612237043`*^9}, {3.734414195600566*^9, 3.7344143143411903`*^9}, {
   3.734414882922276*^9, 3.734414894936925*^9}, {3.734414964231298*^9, 
   3.734415005952628*^9}, {3.734415042935251*^9, 3.734415047670806*^9}, {
   3.734415088734322*^9, 3.734415120620316*^9}, {3.734415326821014*^9, 
   3.7344154384774523`*^9}, {3.734415668960808*^9, 3.73441572954326*^9}, {
   3.734415779510621*^9, 3.734415821813545*^9}, {3.734415860540681*^9, 
   3.7344160340489798`*^9}, {3.734416125489831*^9, 3.73441614447849*^9}, {
   3.734416338910688*^9, 3.734416340339375*^9}, {3.7346678900276537`*^9, 
   3.7346679831146584`*^9}, {3.734668017765711*^9, 3.734668073329541*^9}, {
   3.734668375315628*^9, 3.734668413450987*^9}, {3.734669281971924*^9, 
   3.734669395756266*^9}, {3.734669642615943*^9, 3.734669686326432*^9}, {
   3.734669816249323*^9, 3.734669816447013*^9}, {3.734670351320223*^9, 
   3.734670352736187*^9}, {3.73467038659089*^9, 3.734670398274848*^9}, {
   3.734670437246735*^9, 3.734670487004538*^9}, {3.734670555686846*^9, 
   3.734670556393078*^9}, {3.7346707849406157`*^9, 3.734670991275021*^9}, {
   3.7350327225480556`*^9, 3.7350327285692*^9}, {3.735032790587693*^9, 
   3.7350328693591547`*^9}, {3.7350331913467073`*^9, 3.735033209989203*^9}, {
   3.73503328679311*^9, 3.735033337778858*^9}, {3.737278689235427*^9, 
   3.737278724291026*^9}, {3.7373828319134293`*^9, 3.737382905583477*^9}, {
   3.7380503409830427`*^9, 3.7380503462202253`*^9}, {3.738050409199875*^9, 
   3.738050410020376*^9}, {3.738050587280776*^9, 3.738050594380994*^9}, {
   3.738050633314591*^9, 3.738050741885346*^9}, 3.738050787226899*^9, {
   3.738050820907621*^9, 3.738050913718038*^9}, {3.738050967336628*^9, 
   3.738051039601925*^9}, {3.738051123094633*^9, 3.7380511685169477`*^9}, {
   3.7380512915012083`*^9, 3.73805131582058*^9}, 3.73805147687253*^9, {
   3.738291406092393*^9, 3.738291463424559*^9}, {3.739251235484573*^9, 
   3.739251259594013*^9}, {3.7392664653604727`*^9, 3.739266516678097*^9}, 
   3.7392665477450542`*^9, {3.739267739894909*^9, 3.739267740037506*^9}, 
   3.73950412920148*^9, {3.742016464322269*^9, 3.742016465840391*^9}, {
   3.742022822926903*^9, 3.742022908512398*^9}, {3.742022978221959*^9, 
   3.74202298550244*^9}, {3.743865456276009*^9, 3.7438654563219023`*^9}, {
   3.7438669045354652`*^9, 3.7438669207895317`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[152]:=",ExpressionUUID->"87669779-bf6f-49c2-a46e-d094bc03bec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointGroupQ\>\""}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Check", " ", "if", " ", "valid", " ", "space", " ", "group", " ", 
     "string"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"$PointGroups", ",", "input", ",", "Infinity"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"InputCheck", "::", "\"\<PG\>\""}], ",", "input"}], "]"}], 
      ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.7136042900817747`*^9}, {
   3.713604322627748*^9, 3.713604324160606*^9}, {3.7136043702641973`*^9, 
   3.713604371101212*^9}, {3.71471126435174*^9, 3.71471126555512*^9}, 
   3.717740897041522*^9, 3.72760353803649*^9, {3.7305444772094812`*^9, 
   3.730544481061934*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[153]:=",ExpressionUUID->"254eed9a-9445-40db-b24d-472d2350b88b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"input_String", ",", "\"\<PointSpaceGroupQ\>\""}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Check", " ", "if", " ", "valid", " ", "point"}], "-", " ", 
    RowBox[{"or", " ", "space", " ", "group", " ", "string"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"$GroupSymbolRedirect", ",", "input"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"InputCheck", "::", "PSG"}], ",", "input"}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, {
   3.713604296226803*^9, 3.713604299721271*^9}, {3.714710977590053*^9, 
   3.714710979768374*^9}, 3.717740920646922*^9, 3.7276035440759487`*^9, 
   3.743865456393198*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[154]:=",ExpressionUUID->"ca8d9a53-8b24-4939-b8f1-e2ca3a470796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{"type_String", ",", 
    RowBox[{"scatteringAngle_:", "0"}], ",", "\"\<Polarisation\>\""}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"type", "===", "\"\<sigma\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Sigma]\>\""}]}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", "===", "\"\<pi\>\""}], "||", 
     RowBox[{"type", "===", "\"\<\[Pi]\>\""}]}], ",", 
    RowBox[{"Abs", "@", 
     RowBox[{"Cos", "[", "scatteringAngle", "]"}]}], ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"InputCheck", "::", "\"\<polarisation\>\""}], "]"}], ";", 
     RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.713603211792478*^9, 3.713603330743202*^9}, 
   3.7136034818290167`*^9, {3.713603526324111*^9, 3.713603601082445*^9}, {
   3.7136036823367767`*^9, 3.713603756325656*^9}, {3.713603793229167*^9, 
   3.7136038014447613`*^9}, {3.71360423895645*^9, 3.713604260194231*^9}, {
   3.7136096220507708`*^9, 3.713609766629499*^9}, {3.713609803694686*^9, 
   3.7136098460035143`*^9}, {3.713609896764085*^9, 3.7136098971713457`*^9}, 
   3.7143124623172703`*^9, {3.714711400201912*^9, 3.7147114013487253`*^9}, {
   3.7177409045433407`*^9, 3.7177409045530024`*^9}, {3.7265604536850843`*^9, 
   3.7265604571899033`*^9}, 3.726561476915771*^9, {3.727603738644006*^9, 
   3.727603738970872*^9}, {3.727603872991158*^9, 3.7276038737620068`*^9}, 
   3.727675395188451*^9, {3.728765707484078*^9, 3.728765708834387*^9}, {
   3.728765780634018*^9, 3.728765813592382*^9}, {3.72876589943944*^9, 
   3.728765908688555*^9}, {3.730017879620852*^9, 3.730017885274577*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[155]:=",ExpressionUUID->"21c993c3-a67a-4d03-a7b5-7cd460cbf33b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InputCheck", "[", 
   RowBox[{
   "crystal_String", ",", "wavelength_", ",", "\"\<ProcessWavelength\>\"", 
    ",", 
    RowBox[{"abortQ_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[Lambda]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"wavelength", "===", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{
         "crystal", ",", "\"\<GetCrystalWavelength\>\"", ",", "abortQ"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", "wavelength"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"\[Lambda]", ",", "\"\<GetEnergyWavelength\>\"", ",", "False"}],
       "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730395241910015*^9, 3.730395331782501*^9}, 
   3.73039551088382*^9, {3.7391249707350397`*^9, 3.739124986130555*^9}, {
   3.73912511330057*^9, 3.739125114641823*^9}, {3.739125407092436*^9, 
   3.7391254219192133`*^9}, {3.7391254965873337`*^9, 3.739125499857193*^9}, {
   3.739125656582911*^9, 3.739125666230063*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[156]:=",ExpressionUUID->"a5b11313-8f8e-4d89-bf43-7d46a4865e93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[157]:=",ExpressionUUID->"be2c3ed8-fcd6-453a-9672-ca4fc3985baf"]
}, Closed]],

Cell[CellGroupData[{

Cell["InterplanarSpacing", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, 3.682327712058332*^9, {
   3.7050304793013973`*^9, 3.7050304802794743`*^9}, {3.714925546281479*^9, 
   3.7149255477761383`*^9}, {3.715064144253417*^9, 3.71506414748868*^9}, {
   3.715064231136232*^9, 3.715064235741983*^9}, 
   3.71532668875773*^9},ExpressionUUID->"ab055846-8658-4583-8218-\
17bbdb5d8fa7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[158]:=",ExpressionUUID->"090636ee-5713-425e-967b-d93461927769"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "InterplanarSpacing"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714926640095376*^9, 3.714926648623674*^9}, 
   3.715064183906497*^9, {3.715078876499865*^9, 3.715078880193625*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"b69513f4-4d5f-4622-afba-be073c445005"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[160]:=",ExpressionUUID->"27ccbf94-5abc-4efd-aaa3-17632cfb8a27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterplanarSpacing", "[", 
   RowBox[{"input_", ",", "reflections_List", ",", 
    RowBox[{"OptionsPattern", "@", "InterplanarSpacing"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hkl", ",", "H", ",", "d", ",", "h"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "reflection"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "reflections", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reciprocal", " ", "metric"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", 
         RowBox[{"GetCrystalMetric", "[", "input", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Interplanar", " ", "distance"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "=", 
            RowBox[{"hkl", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", "\[IndentingNewLine]", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"h", ".", "H", ".", "h"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "hkl"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", "Units"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Quantity", "[", 
         RowBox[{"d", ",", "\"\<Angstroms\>\""}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "only", " ", "one", " ", "reflection"}], ",", " ", 
       RowBox[{"return", " ", "content"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "d"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"First", "@", "d"}], ",", "d"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.682327662602072*^9, {3.6824963506791697`*^9, 3.6824963547512217`*^9}, {
   3.682496400113083*^9, 3.682496493228437*^9}, 3.682677149488262*^9, {
   3.685082142306231*^9, 3.6850821530756807`*^9}, 3.685084035768195*^9, {
   3.68655238046353*^9, 3.686552426771611*^9}, {3.6865525950866337`*^9, 
   3.686552685595372*^9}, {3.686635545814003*^9, 3.686635612323032*^9}, {
   3.686645933806924*^9, 3.686646007894505*^9}, {3.686646064248117*^9, 
   3.68664607682882*^9}, {3.686655195368894*^9, 3.6866552343027163`*^9}, {
   3.6866553151103287`*^9, 3.686655409251244*^9}, {3.6866554490764103`*^9, 
   3.686655514039054*^9}, {3.686655580018355*^9, 3.686655635546473*^9}, {
   3.686655748745368*^9, 3.686655776590246*^9}, {3.714925556554666*^9, 
   3.714925578583651*^9}, {3.7149256217212152`*^9, 3.714925689133297*^9}, {
   3.7149258652268667`*^9, 3.714925953487383*^9}, {3.71492600096751*^9, 
   3.714926119019596*^9}, {3.714926175338132*^9, 3.714926196305581*^9}, 
   3.7149262352489967`*^9, {3.714926307824396*^9, 3.7149264095004387`*^9}, {
   3.714926450015284*^9, 3.7149265295624437`*^9}, {3.7149265755610447`*^9, 
   3.714926579417263*^9}, {3.714926655695353*^9, 3.714926765295703*^9}, {
   3.714927064423978*^9, 3.714927159155733*^9}, {3.7149272069557753`*^9, 
   3.7149276407442627`*^9}, {3.714927818589819*^9, 3.714927894002508*^9}, {
   3.715014199691877*^9, 3.7150142148573313`*^9}, {3.7150641849014177`*^9, 
   3.715064208336918*^9}, 3.715078883076619*^9, {3.715078913508091*^9, 
   3.715078913682675*^9}, {3.715079164837681*^9, 3.7150791802962923`*^9}, {
   3.7150792131352386`*^9, 3.715079215811734*^9}, {3.7150805829910393`*^9, 
   3.715080601633729*^9}, {3.7153143538431253`*^9, 3.715314619337658*^9}, {
   3.71531482604503*^9, 3.715314858601492*^9}, 3.717740920731542*^9, {
   3.730543614674137*^9, 3.730543615290286*^9}, {3.730544530561977*^9, 
   3.730544530964417*^9}, 3.73796846805212*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[161]:=",ExpressionUUID->"9f7d0cbd-7fef-4bf1-a1db-2f7fd6f091cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[162]:=",ExpressionUUID->"ec1d0533-84e1-4ffa-9a50-fc621814f680"]
}, Closed]],

Cell[CellGroupData[{

Cell["MergeSymmetryEquivalentReflections", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.682754675215427*^9, 3.682754677485675*^9}, {
   3.6827632401424837`*^9, 3.682763247126801*^9}, 3.682763763856205*^9, 
   3.6827638067251377`*^9, 
   3.730106310308416*^9},ExpressionUUID->"f7f5c0eb-0cfc-4bed-bb51-\
c73909baf384"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[163]:=",ExpressionUUID->"b3b192c7-a919-4679-a2b4-3b7d437992fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "MergeSymmetryEquivalentReflections"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ToStandardSetting\>\"", "\[Rule]", "True"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.7301063103200483`*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"651cb324-4578-4f1b-b7a1-0ebdcd7c573e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[165]:=",ExpressionUUID->"92e2bd91-05cf-4d86-b279-fa48d563662c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MergeSymmetryEquivalentReflections", "[", 
   RowBox[{"group_String", ",", "hkl_List", ",", 
    RowBox[{"OptionsPattern", "@", "MergeSymmetryEquivalentReflections"}]}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"input", ",", "sg", ",", "merged"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"input", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"hkl", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"group", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Consider", " ", "duplicate", " ", "if", " ", "they", " ", "generate", 
       " ", "same", " ", "symmetry", " ", "equivalents"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"merged", "=", 
      RowBox[{"DeleteDuplicatesBy", "[", 
       RowBox[{"input", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Sort", "@", 
          RowBox[{"SymmetryEquivalentReflections", "[", 
           RowBox[{"sg", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Use", " ", "standard", " ", "setting", " ", "on", " ", "indices"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ToStandardSetting\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ToStandardSetting", "[", 
          RowBox[{"sg", ",", "#"}], "]"}], "&"}], "/@", "merged"}], ",", 
       "\[IndentingNewLine]", "\t", "merged"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.682682345535097*^9, 3.682682347997387*^9}, {
   3.682754890045689*^9, 3.682754900136516*^9}, {3.682754952296125*^9, 
   3.682755022164933*^9}, {3.682755115621669*^9, 3.6827551535141687`*^9}, {
   3.682755192899743*^9, 3.682755204616169*^9}, {3.682755483075945*^9, 
   3.682755572184518*^9}, {3.682755620936475*^9, 3.68275570339452*^9}, {
   3.682755785197132*^9, 3.6827558328591137`*^9}, {3.682755872957996*^9, 
   3.682755929888302*^9}, {3.6827560172459*^9, 3.68275608066227*^9}, {
   3.6827561903761797`*^9, 3.682756208255334*^9}, {3.682756341293084*^9, 
   3.682756435807774*^9}, {3.682756481562601*^9, 3.6827566171437607`*^9}, {
   3.6827571356319447`*^9, 3.68275715086217*^9}, {3.682757193154983*^9, 
   3.682757204761051*^9}, {3.682757287045686*^9, 3.6827573748421717`*^9}, {
   3.6827574428815193`*^9, 3.682757463459453*^9}, {3.6827575865280647`*^9, 
   3.682757600041594*^9}, {3.6827576521824217`*^9, 3.682757654103991*^9}, {
   3.682757736488762*^9, 3.68275776848295*^9}, {3.682757872746702*^9, 
   3.682757878996653*^9}, {3.682760893290402*^9, 3.682760919442278*^9}, {
   3.682761050069873*^9, 3.6827610875022707`*^9}, {3.682761344440157*^9, 
   3.6827613948805656`*^9}, {3.682761467533331*^9, 3.6827614906040382`*^9}, {
   3.682761599041744*^9, 3.6827616051249332`*^9}, {3.682761640140191*^9, 
   3.682761640269712*^9}, {3.6827632705416527`*^9, 3.682763272313184*^9}, {
   3.6827634698943243`*^9, 3.682763491297275*^9}, 3.682763560088398*^9, {
   3.682763672646283*^9, 3.682763703768117*^9}, 3.682763765769903*^9, {
   3.6827638097007027`*^9, 3.682763841562532*^9}, {3.682764002267891*^9, 
   3.682764060609202*^9}, {3.682764092437544*^9, 3.682764093948495*^9}, {
   3.682764145109967*^9, 3.682764153463393*^9}, {3.682764193547503*^9, 
   3.682764223520398*^9}, {3.682764299751896*^9, 3.682764385964645*^9}, {
   3.68276443988243*^9, 3.6827644490889807`*^9}, {3.682764497839053*^9, 
   3.68276451442174*^9}, {3.682764590085518*^9, 3.682764666566125*^9}, {
   3.682764709108004*^9, 3.682764713033717*^9}, {3.682764803156188*^9, 
   3.682764805193653*^9}, {3.682764858920453*^9, 3.68276487123205*^9}, {
   3.6827650306638536`*^9, 3.682765032106743*^9}, {3.682765077128017*^9, 
   3.682765114630002*^9}, {3.682765148933024*^9, 3.682765156919944*^9}, {
   3.6827677197030478`*^9, 3.682767720010531*^9}, {3.683604340403654*^9, 
   3.6836043529073563`*^9}, {3.684139656863722*^9, 3.68413966623372*^9}, {
   3.684213591199651*^9, 3.68421359766739*^9}, 3.68423542388873*^9, {
   3.684494231046241*^9, 3.6844942328843927`*^9}, {3.6846687766667967`*^9, 
   3.684668833479196*^9}, {3.6850821810967503`*^9, 3.685082181896227*^9}, 
   3.685084049591119*^9, {3.685301853914551*^9, 3.6853018858709908`*^9}, {
   3.685301957111362*^9, 3.6853019648610888`*^9}, {3.685301997069955*^9, 
   3.68530212067407*^9}, {3.685302176210725*^9, 3.685302185680876*^9}, {
   3.685302454443644*^9, 3.685302484386928*^9}, {3.685302801397314*^9, 
   3.6853028247972393`*^9}, {3.6853028602362013`*^9, 3.685302902395097*^9}, {
   3.685331251904861*^9, 3.6853312646170473`*^9}, {3.6853312960267057`*^9, 
   3.6853313204691477`*^9}, {3.685331539879148*^9, 3.685331677385861*^9}, {
   3.685331889662311*^9, 3.685332001364971*^9}, {3.685332031404345*^9, 
   3.6853320318833237`*^9}, {3.685332097919066*^9, 3.68533210035004*^9}, {
   3.6853321321988993`*^9, 3.685332135240776*^9}, {3.685332208432933*^9, 
   3.685332251093843*^9}, {3.685332353259377*^9, 3.685332354313655*^9}, {
   3.685334186433942*^9, 3.685334188848311*^9}, {3.6853342830532503`*^9, 
   3.685334343176944*^9}, {3.685351973845551*^9, 3.6853519796240673`*^9}, {
   3.6853837611243258`*^9, 3.685383766849927*^9}, {3.685697704820434*^9, 
   3.6856977220768137`*^9}, {3.6856980151258297`*^9, 3.685698042947495*^9}, {
   3.6856981446843*^9, 3.685698153416366*^9}, {3.685770338473489*^9, 
   3.685770340565543*^9}, 3.685777919630587*^9, {3.685784957125655*^9, 
   3.685784959319334*^9}, {3.685785897727392*^9, 3.6857859357454*^9}, 
   3.685786625994659*^9, {3.713078853682228*^9, 3.71307892925729*^9}, {
   3.7130795040128727`*^9, 3.7130795045791473`*^9}, {3.71308394897624*^9, 
   3.713083949446762*^9}, {3.714456574367063*^9, 3.714456601006489*^9}, {
   3.714456780323517*^9, 3.714456781803543*^9}, {3.7144569909110603`*^9, 
   3.7144570019091177`*^9}, {3.714457188425292*^9, 3.714457211242263*^9}, {
   3.717224340099481*^9, 3.717224347072815*^9}, {3.7172244383366337`*^9, 
   3.717224443766733*^9}, {3.717740920803213*^9, 3.717740920811776*^9}, {
   3.7276752143072567`*^9, 3.7276752342186823`*^9}, {3.730106310331801*^9, 
   3.730106310339879*^9}, 3.730209956777421*^9, {3.730544545611946*^9, 
   3.730544546560378*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[166]:=",ExpressionUUID->"b82e1e4f-deb8-4c23-a3eb-1d636c7ff42c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[167]:=",ExpressionUUID->"eebf94d3-0195-4fa1-917d-0c80a8834da3"]
}, Closed]],

Cell[CellGroupData[{

Cell["MillerNotationToList", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9},ExpressionUUID->"e77d37a6-9a20-4138-9bbc-\
c0cac6a9ff9b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[168]:=",ExpressionUUID->"1a10b825-773d-428c-a40e-8d9852abf1e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[169]:=",ExpressionUUID->"24e9e6cd-56b6-482d-b2b2-0af33929aa9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MillerNotationToList", "[", "input_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L", ",", "R", ",", "temp", ",", "split"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Removing", " ", "overbars"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"L", "=", "\"\<\\!\\(\\*OverscriptBox[\\(\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", "\"\<\\), \\(_\\)]\\)\>\""}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"input", ",", 
        RowBox[{
         RowBox[{"L", "~~", 
          RowBox[{"Shortest", "@", "x__"}], "~~", "R"}], "\[RuleDelayed]", 
         RowBox[{
         "\"\<|\>\"", "<>", "\"\<-\>\"", "<>", "x", "<>", "\"\<|\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Separating", " ", "indices"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Sign", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", ":", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "\"\<-\>\"", ",", "\"\<|\>\""}], "}"}]}],
           "~~", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Letters", " ", "are", " ", "not", " ", "joined", " ", "with", 
             " ", "digits"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x", ":", "LetterCharacter"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Digits", " ", "could", " ", "be", " ", "joined"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"d", ":", "DigitCharacter"}], "~~", 
             "\[IndentingNewLine]", 
             RowBox[{"y", ":", 
              RowBox[{"Shortest", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"\"\<|\>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"DigitCharacter", ".."}], "~~", 
                  RowBox[{"{", 
                   RowBox[{"\"\<,\>\"", ",", "\"\<|\>\"", ",", "\"\<)\>\""}], 
                   "}"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[RuleDelayed]", 
         RowBox[{
         "\"\<|\>\"", "<>", "s", "<>", "x", "<>", "d", "<>", "y", "<>", 
          "\"\<|\>\""}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"\"\<|\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"temp", ",", "\"\<,\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Special", " ", 
       RowBox[{"case", ":", " ", 
        RowBox[{"Positive", " ", "single", " ", 
         RowBox[{"digits", "/", "letters"}], " ", "only"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", 
      StyleBox["[", "Code"], 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "temp"}], "<", "3"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"temp", ",", 
           RowBox[{
            RowBox[{"x", ":", "WordCharacter"}], "\[RuleDelayed]", "x"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"{", "}"}]}], "]"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Trimming", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<(\>\"", ",", "\"\<)\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"temp", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "Null", ",", "\"\<{}\>\""}], "}"}], ",", 
           "x"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "not", " ", "three", " ", "entires"}], ",", " ", 
       RowBox[{"split", " ", "digits"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"split", "[", "x_", "]"}], ":=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", ":", 
              RowBox[{"{", 
               RowBox[{"\"\<\>\"", ",", "\"\<-\>\""}], "}"}]}], "~~", 
             RowBox[{"n", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
            RowBox[{"p", "~~", "n"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n1", ":", "DigitCharacter"}], "~~", 
             RowBox[{"n2", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2"}], "}"}]}]}], "\[IndentingNewLine]", 
          "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"temp", "/.", 
       RowBox[{
        RowBox[{"x_List", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "x", "]"}], "<", "3"}]}], "\[RuleDelayed]", 
        RowBox[{"split", "[", "x", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Setting", " ", "numbers", " ", "as", " ", "experssions"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "/.", 
      RowBox[{
       RowBox[{"x_List", "/;", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"x", ",", "DigitCharacter"}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"ToExpression", "[", "x", "]"}]}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.71265181170818*^9, 3.71265184851582*^9}, {
   3.712652095518579*^9, 3.712652257498863*^9}, 3.71265239748778*^9, {
   3.71265244571208*^9, 3.7126524481825333`*^9}, {3.7126526553150253`*^9, 
   3.71265266634685*^9}, {3.7126544272990713`*^9, 3.7126544608744907`*^9}, {
   3.712654491008285*^9, 3.712654513440096*^9}, {3.712654550942759*^9, 
   3.712654670547868*^9}, {3.712654703821003*^9, 3.712654741083172*^9}, {
   3.7126572447956333`*^9, 3.71265724552361*^9}, {3.7126573384427958`*^9, 
   3.712657409919541*^9}, {3.712657442783066*^9, 3.7126575394046917`*^9}, {
   3.712657574141005*^9, 3.712657877853153*^9}, {3.712657916505589*^9, 
   3.712657926412139*^9}, {3.712657958155428*^9, 3.7126580079624166`*^9}, {
   3.712658051969553*^9, 3.712658055873343*^9}, {3.71265910828284*^9, 
   3.712659135617361*^9}, {3.7126592131276484`*^9, 3.71265921347163*^9}, {
   3.712659259014515*^9, 3.7126594153067408`*^9}, {3.7126594508836*^9, 
   3.712659478377791*^9}, {3.7126595314564962`*^9, 3.7126595319043083`*^9}, {
   3.712659580336278*^9, 3.712659593718773*^9}, {3.71265962760645*^9, 
   3.712659696409937*^9}, {3.712659779410568*^9, 3.712659796570158*^9}, {
   3.7127232179121027`*^9, 3.712723229072281*^9}, {3.712723277198616*^9, 
   3.712723280222929*^9}, 3.7127233136458893`*^9, {3.712723486689425*^9, 
   3.7127235463119698`*^9}, {3.712723798706465*^9, 3.7127238719521513`*^9}, {
   3.712723903031745*^9, 3.712724002493475*^9}, {3.712724277432616*^9, 
   3.712724372844721*^9}, {3.7127244033803263`*^9, 3.7127245266898813`*^9}, {
   3.712724809955243*^9, 3.712724840289219*^9}, {3.712724885592177*^9, 
   3.712724888296068*^9}, {3.7127251133317757`*^9, 3.7127251193874807`*^9}, {
   3.712725321551262*^9, 3.7127254430142107`*^9}, {3.712725492618681*^9, 
   3.71272563230217*^9}, {3.712725684446393*^9, 3.712725711940311*^9}, {
   3.7127257433872843`*^9, 3.71272585209263*^9}, {3.712725885065549*^9, 
   3.71272600940621*^9}, {3.712726073572926*^9, 3.712726127066513*^9}, {
   3.712726177392968*^9, 3.712726178104968*^9}, {3.71272621473763*^9, 
   3.712726243943431*^9}, {3.712726332173551*^9, 3.712726360589281*^9}, {
   3.712726422612451*^9, 3.712726423847527*^9}, {3.712726521650385*^9, 
   3.71272659331116*^9}, {3.712726652214963*^9, 3.712726742067371*^9}, {
   3.712727206140136*^9, 3.7127272078411407`*^9}, {3.7127272390958357`*^9, 
   3.712727247711342*^9}, 3.712727323335806*^9, {3.712727411252993*^9, 
   3.7127274113952227`*^9}, {3.712727598072218*^9, 3.712727698157626*^9}, {
   3.712727740709833*^9, 3.7127277633311167`*^9}, {3.712727795986257*^9, 
   3.712727876712543*^9}, {3.7127280099270153`*^9, 3.71272801297314*^9}, {
   3.7172312671661167`*^9, 3.717231282002515*^9}, {3.7172313463954897`*^9, 
   3.717231376033064*^9}, {3.717231406601571*^9, 3.717231452543467*^9}, {
   3.7172316471403503`*^9, 3.7172316547383347`*^9}, {3.717231691578803*^9, 
   3.717231701833466*^9}, {3.7172317522655582`*^9, 3.717231761664892*^9}, {
   3.717231804824963*^9, 3.717231842701837*^9}, {3.71723209703476*^9, 
   3.717232117511814*^9}, {3.717232160832486*^9, 3.7172323308668337`*^9}, {
   3.7172323846671267`*^9, 3.717232387569281*^9}, {3.717232420625662*^9, 
   3.717232442809225*^9}, {3.717232480177041*^9, 3.717232486886738*^9}, {
   3.71723254374341*^9, 3.7172325701171293`*^9}, {3.71723271350712*^9, 
   3.717232736193582*^9}, {3.7172328302000628`*^9, 3.717232858494359*^9}, 
   3.7379684244868317`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[170]:=",ExpressionUUID->"0a286452-fd34-44db-a06e-c9ed3d11f2d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[171]:=",ExpressionUUID->"bc552144-0c64-4288-91ed-b82e34ecd62f"]
}, Closed]],

Cell[CellGroupData[{

Cell["MillerNotationToString", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9},ExpressionUUID->"8ff72b30-e54c-47ed-88fe-\
570b7a4abb31"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[172]:=",ExpressionUUID->"b577cecc-3bcf-4495-bf21-9282788bc2ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MillerNotationToString", "::", "inv"}], "=", 
   "\"\<Invalid index input \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7452232741050367`*^9, 3.745223276614665*^9}, {
  3.745223451212205*^9, 3.745223460081909*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"0291c17b-0fdc-4fbb-a50b-4b58926fd362"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[173]:=",ExpressionUUID->"fd27474a-7c85-4525-8bf8-733c90f512ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MillerNotationToString", "[", "input_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "L", ",", "R", ",", "quit", ",", "i", ",", "H", ",", "index", ",", 
      "presentation", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"InputCheck", "[", "input", "]"}], ",", 
       RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Shortcuts", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"L", "=", "\"\<\\!\\(\\*OverscriptBox[\\(\>\""}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"R", "=", "\"\<\\), \\(_\\)]\\)\>\""}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"quit", "[", "index_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"MillerNotationToString", "::", "inv"}], ",", "index"}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Converting", " ", "to", " ", "string", " ", "with", " ", "overbar", 
       " ", "if", " ", "negative"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"H", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"index", "=", 
         RowBox[{"input", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"IntegerQ", "@", "index"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"index", "<", "0"}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"H", ",", 
              RowBox[{"L", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"-", "index"}], "]"}], "<>", "R"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"H", ",", 
              RowBox[{"ToString", "@", "index"}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"StringQ", "@", "index"}], ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "@", "index"}], "\[NotEqual]", "1"}], 
            ",", 
            RowBox[{"quit", "[", "index", "]"}], ",", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"H", ",", "index"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Head", "[", "index", "]"}], "===", "Times"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"index", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"StringQ", "@", 
               RowBox[{"index", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringLength", "@", 
                RowBox[{"index", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "\[NotEqual]", "1"}], ",", 
              
              RowBox[{"quit", "[", "index", "]"}], ",", "\[IndentingNewLine]",
               "\t\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"H", ",", 
                RowBox[{"L", "<>", 
                 RowBox[{"index", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "<>", "R"}]}], "]"}]}], 
             "]"}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"quit", "[", "index", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"quit", "[", "index", "]"}]}], "\[IndentingNewLine]", "\t", 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Presentation", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"presentation", "=", 
      RowBox[{"StringJoin", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"\"\<(\>\"", "<>", 
        RowBox[{"H", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<|\>\"", "<>", 
        RowBox[{"H", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<|\>\"", "<>", 
        RowBox[{"H", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "<>", "\"\<)\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Only", " ", "remove", " ", "commas", " ", "for", " ", "single", " ", 
       "digit", " ", "integers"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"input", ",", "NumericQ"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Abs", "[", "#", "]"}], "\[LessEqual]", "9"}], ")"}], "&&", 
           RowBox[{"IntegerQ", "[", "#", "]"}]}], "&"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"output", "=", 
        RowBox[{"StringDelete", "[", 
         RowBox[{"presentation", ",", "\"\<|\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"output", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"presentation", ",", 
          RowBox[{"\"\<|\>\"", "\[Rule]", "\"\<,\>\""}]}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "input"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, 3.685686496167932*^9, {3.6856944477863503`*^9, 
   3.68569446921675*^9}, {3.685694605238812*^9, 3.6856946062341757`*^9}, {
   3.685695893282233*^9, 3.685695896451762*^9}, {3.6856960214137506`*^9, 
   3.6856960251722317`*^9}, {3.687521359980748*^9, 3.687521435237295*^9}, {
   3.6875214687991743`*^9, 3.687521494623404*^9}, {3.6876768933160543`*^9, 
   3.687676910356525*^9}, {3.712650700261273*^9, 3.7126507027975063`*^9}, {
   3.7126508246994467`*^9, 3.7126508373862047`*^9}, {3.712650880057147*^9, 
   3.71265091066479*^9}, {3.712650944551971*^9, 3.712650951383466*^9}, {
   3.712651061181072*^9, 3.7126510654943533`*^9}, {3.71265113385168*^9, 
   3.712651134019478*^9}, {3.7126512882721786`*^9, 3.712651310583632*^9}, {
   3.712651420262867*^9, 3.712651422476676*^9}, 3.717740919994548*^9, 
   3.737968267347493*^9, {3.745222099337564*^9, 3.7452221260403023`*^9}, {
   3.745222196932884*^9, 3.7452222408157177`*^9}, {3.745222627190054*^9, 
   3.745222770544285*^9}, {3.745222809765418*^9, 3.745222818340452*^9}, {
   3.74522294956068*^9, 3.7452230106142282`*^9}, {3.745223471259536*^9, 
   3.745223526338607*^9}, {3.7452236006883802`*^9, 3.745223608369892*^9}, {
   3.745223642571735*^9, 3.745223665435327*^9}, {3.745223714074592*^9, 
   3.745223864250751*^9}, {3.74522392889231*^9, 3.745223948208666*^9}, {
   3.745223983821549*^9, 3.7452239988039722`*^9}, {3.745224103043028*^9, 
   3.745224128284939*^9}, {3.745224298694689*^9, 3.745224359705023*^9}, {
   3.7452244082811823`*^9, 3.74522441139579*^9}, {3.7452253089840384`*^9, 
   3.745225332402544*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[350]:=",ExpressionUUID->"ce9c7baf-282f-4246-8132-eb3ef658f934"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MillerNotationToString", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "\"\<\[OSlash]\>\"", ",", "3"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.745221837173061*^9, 3.7452218496587887`*^9}, {
   3.745222025372834*^9, 3.745222028463799*^9}, 3.745223616007778*^9, {
   3.745223892037216*^9, 3.7452239082281513`*^9}, 3.745224273455091*^9, {
   3.745224364062827*^9, 3.745224394546876*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"15b2ca8c-ad04-4262-94dc-345e6c2973e7"],

Cell[BoxData["\<\"(1\[OSlash]3)\"\>"], "Output",
 CellChangeTimes->{{3.74522184369197*^9, 3.745221850105988*^9}, {
   3.745222025854134*^9, 3.745222028859808*^9}, 3.745223532081872*^9, {
   3.745223613629158*^9, 3.745223616265724*^9}, {3.745223890091711*^9, 
   3.7452239088357983`*^9}, 3.745224007653368*^9, 3.745224274082066*^9, {
   3.745224362903235*^9, 3.745224394961351*^9}, 3.74522533597357*^9},
 CellLabel->
  "Out[351]=",ExpressionUUID->"fdf29155-e79e-431c-92b8-332b7884f01d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringLength", "[", "\"\<\[OSlash]\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.745225289806643*^9, 3.7452252928482122`*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"73670396-0c13-403e-9cac-d179aacd1def"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.745225293151723*^9},
 CellLabel->
  "Out[347]=",ExpressionUUID->"0c3c6711-7bd6-4799-9204-70a83e222920"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[175]:=",ExpressionUUID->"36f1e117-1302-4157-a322-71c0a7341a7c"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReciprocalSpaceSimulation", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, 3.667900125753806*^9, {3.6846465171332808`*^9, 
   3.684646521502282*^9}, 
   3.715855140211611*^9},ExpressionUUID->"421cda21-11db-4c8c-8e0f-\
126a17ec7163"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[176]:=",ExpressionUUID->"88a788b5-38b3-44c5-b02d-f882237ffa7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReciprocalSpaceSimulation", "::", "invalid"}], "=", 
   "\"\<Invalid input form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReciprocalSpaceSimulation", "::", "dep"}], "=", 
    "\"\<The layer vectors are not linearly independent.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ReciprocalSpaceSimulation"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ReturnData\>\"", "\[Rule]", "False"}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[177]:=",ExpressionUUID->"3b28efe8-b41a-4a19-8df1-def5e9d40c9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[180]:=",ExpressionUUID->"034dc9aa-8a40-4b49-a35b-6340c2fb45b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReciprocalSpaceSimulation", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"L1_List", ",", "L2_List"}], "}"}], ",", "origin_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"res_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"NumericQ", "[", "#", "]"}], "&&", 
        RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "ReciprocalSpaceSimulation"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\[Lambda]", ",", "check", ",", "\[IndentingNewLine]", "G", ",", "Ginv", 
      ",", "B", ",", "CrystalDot", ",", "CrystalCross", ",", 
      "\[IndentingNewLine]", "Hx", ",", "Hy", ",", "Hz", ",", "HCx", ",", 
      "HCy", ",", "HCz", ",", "\[IndentingNewLine]", "U", ",", "UB", ",", "o",
       ",", "ref", ",", "refz", ",", "flip", ",", "condition", ",", "pindex", 
      ",", "\[IndentingNewLine]", "\[Epsilon]", ",", "disk", ",", 
      "\[IndentingNewLine]", "hkl", ",", "xy", ",", "pair", ",", "points"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "Input", " ", "check"}], " ", "**)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"lambda", "\[Equal]", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{"crystal", ",", "\"\<GetCrystalWavelength\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", "lambda"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"check", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"L1", ",", "L2", ",", "origin"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "check"}], "\[NotEqual]", "9"}], "||", 
        RowBox[{"!", 
         RowBox[{"AllTrue", "[", 
          RowBox[{"check", ",", "NumericQ"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalSpaceSimulation", "::", "invalid"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "vectors", " ", "are", " ", "linearly", " ", 
       "independent"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"L1", ".", "L1"}], ",", 
             RowBox[{"L1", ".", "L2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"L2", ".", "L1"}], ",", 
             RowBox[{"L2", ".", "L2"}]}], "}"}]}], "}"}], "]"}], "\[Equal]", 
        "0"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReciprocalSpaceSimulation", "::", "dep"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Metric", " ", "information"}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"G", "=", 
      RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Ginv", "=", 
      RowBox[{"Inverse", "@", "G"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"B", "=", 
      RowBox[{"CholeskyDecomposition", "@", 
       RowBox[{"Inverse", "@", "G"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"*", " ", "Dot"}], "-", " ", 
       RowBox[{
       "and", " ", "cross", " ", "products", " ", "in", " ", "reciprocal", 
        " ", "space"}]}], " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CrystalDot", "[", 
       RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Ginv", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"u", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"v", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CrystalCross", "[", 
       RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Sqrt", "@", 
         RowBox[{"Det", "@", "Ginv"}]}], "*", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"Signature", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "*", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"G", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "t"}], "]"}], "]"}], "*", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "*", 
                 RowBox[{"v", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "3"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"t", ",", "3"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Plane", " ", "of", " ", "projection"}], " ", "**)"}],
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Projection", " ", "plane", " ", "in", " ", "reciprocal", " ", 
       "space"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Hx", "=", "L1"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Hy", "=", 
      RowBox[{"L2", "-", 
       RowBox[{"Hx", "*", 
        RowBox[{
         RowBox[{"CrystalDot", "[", 
          RowBox[{"Hx", ",", "L2"}], "]"}], "/", 
         RowBox[{"CrystalDot", "[", 
          RowBox[{"Hx", ",", "Hx"}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Hz", "=", 
      RowBox[{"CrystalCross", "[", 
       RowBox[{"Hx", ",", "Hy"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Components", " ", "in", " ", "Cartesian", " ", "frame"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"HCx", ",", "HCy", ",", "HCz"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Normalize", "[", 
         RowBox[{"B", ".", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "U", " ", "and", " ", "UB", " ", "matrices", " ", "for", " ", 
       "generation", " ", "of", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"U", "=", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ".", 
       RowBox[{"Inverse", "@", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"HCx", ",", "HCy", ",", "HCz"}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"UB", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{"U", ".", "B"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Reference", " ", "position", " ", "in", " ", "projection"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"o", "=", "origin"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"ref", "=", 
      RowBox[{"UB", ".", "o"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"refz", "=", 
      RowBox[{"ref", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Chop", "[", "origin", "]"}], "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"o", "=", 
         RowBox[{"L1", "+", "L2"}]}], ";", 
        RowBox[{"flip", "=", "True"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"flip", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"condition", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h_", ",", "k_", ",", "l_"}], "}"}], "/;", 
           RowBox[{"h", "\[Equal]", "#1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h_", ",", "k_", ",", "l_"}], "}"}], "/;", 
           RowBox[{"k", "\[Equal]", "#2"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h_", ",", "k_", ",", "l_"}], "}"}], "/;", 
           RowBox[{"l", "\[Equal]", "#3"}]}]}], "\[IndentingNewLine]", "}"}], 
        "&"}], "@@", "o"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"condition", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"condition", ",", 
        RowBox[{"c_", "/;", "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{"flip", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"!", 
            RowBox[{"Equal", "[", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
           ",", "\[IndentingNewLine]", "\t   ", 
           RowBox[{"Equal", "[", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Constant", " ", "plane", " ", "index"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"pindex", "=", 
      RowBox[{"condition", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"pindex", "=", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"pindex", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "\[Rule]", 
       RowBox[{"pindex", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "condition"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"condition", "=", 
         RowBox[{"condition", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"condition", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h_", ",", "k_", ",", "l_"}], "}"}], "/;", "#"}], "&"}], 
          "[", 
          RowBox[{"And", "@@", "condition"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"condition", "=", 
        RowBox[{"First", "@", "condition"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", "Building"}], " ", "**)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Label", "[", "\"\<Building\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Resolution", ",", " ", 
       RowBox[{"limits", " ", "and", " ", "background"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Epsilon]", "=", "2.0*^-6"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"disk", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"GrayLevel", "[", "0.95", "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"Thickness", "[", "Small", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"1", "/", "res"}]}], "]"}]}], "\[IndentingNewLine]", 
          "\t", "}"}], "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Generating", " ", "reflection"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"ReflectionList", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "crystal", ",", "\[Lambda]", ",", "condition", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<HoldIndex\>\"", "\[Rule]", "pindex"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<SplitEquivalent\>\"", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"\"\<ShowProgress\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Generating", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"xy", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"UB", ".", "#"}], "-", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "refz"}], "}"}]}], "&"}], "/@", 
         "hkl"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"pair", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"xy", ",", "hkl"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"pair", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"pair", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"CrystalDot", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "<", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1.01", "*", "res"}], ")"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Return", " ", "data"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ReturnData\>\"", "]"}], ",", 
       RowBox[{"Return", "@", "pair"}]}], "]"}], ";", "\t", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"pair", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tooltip", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"MillerNotationToString", "[", "#2", "]"}]}], "]"}], 
          "\[IndentingNewLine]", "&"}], "@@", "#"}], "&"}], "/@", "pair"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"points", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"pair", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "Large", "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"disk", ",", "points", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "#"}], ",", "#"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "#"}], ",", "#"}], "}"}]}], "}"}]}], "&"}], "[", 
        RowBox[{"1.01", "/", "res"}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], "\t", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, {3.684745337599188*^9, 3.68474537980447*^9}, {
   3.684745683328042*^9, 3.6847456907977457`*^9}, {3.6847457891850033`*^9, 
   3.684746061305086*^9}, {3.684746141124728*^9, 3.684746199596496*^9}, {
   3.684746239968897*^9, 3.684746476906747*^9}, 3.684746516183593*^9, {
   3.684746565602297*^9, 3.684746701504117*^9}, {3.684747704997624*^9, 
   3.684747714320107*^9}, {3.6847478257793713`*^9, 3.684747830808964*^9}, {
   3.684747904590282*^9, 3.684747909027731*^9}, {3.684747987584041*^9, 
   3.6847479901077967`*^9}, {3.6847480366430817`*^9, 3.684748399057756*^9}, {
   3.684749405159607*^9, 3.684749488355398*^9}, {3.684749543943878*^9, 
   3.6847496737773943`*^9}, {3.684749730279647*^9, 3.684749913917756*^9}, {
   3.684749985476234*^9, 3.684750039391656*^9}, {3.6847500890619307`*^9, 
   3.68475009107802*^9}, {3.6847503748919067`*^9, 3.684750422744948*^9}, {
   3.6847506849349947`*^9, 3.684750753350258*^9}, {3.684750809214427*^9, 
   3.684750839528977*^9}, {3.684750911740037*^9, 3.684751027853921*^9}, {
   3.6847510958058243`*^9, 3.684751169395117*^9}, {3.684751226987747*^9, 
   3.684751247567849*^9}, {3.684751383586632*^9, 3.684751386819116*^9}, {
   3.68475158838805*^9, 3.684751675188871*^9}, {3.684754099955616*^9, 
   3.684754130897352*^9}, {3.685093713849648*^9, 3.685093714753817*^9}, {
   3.6852517446001863`*^9, 3.6852517477297363`*^9}, {3.685767547708188*^9, 
   3.685767548831842*^9}, {3.687001964745152*^9, 3.6870019744028*^9}, {
   3.688107597786675*^9, 3.688107665612611*^9}, {3.688378866613222*^9, 
   3.6883788763885612`*^9}, {3.715855140322721*^9, 3.715855140347814*^9}, 
   3.716186984442049*^9, {3.716187022749711*^9, 3.716187033352743*^9}, {
   3.716187122464801*^9, 3.7161871414482718`*^9}, {3.716187304963607*^9, 
   3.7161873460413733`*^9}, {3.716187548088441*^9, 3.716187564246188*^9}, {
   3.716192286432003*^9, 3.7161922901024637`*^9}, {3.716194204440352*^9, 
   3.7161942070439672`*^9}, 3.7161943234519157`*^9, {3.71619443593258*^9, 
   3.716194438406436*^9}, {3.7162005215789223`*^9, 3.7162005253123217`*^9}, {
   3.7162007764807167`*^9, 3.716200777692432*^9}, {3.716200810422229*^9, 
   3.71620081852131*^9}, {3.716201248093273*^9, 3.71620125822864*^9}, {
   3.716201307218774*^9, 3.7162014183866568`*^9}, {3.7162014891276207`*^9, 
   3.716201507465034*^9}, {3.71620177112007*^9, 3.716201859847453*^9}, {
   3.7162019012791557`*^9, 3.716201930716146*^9}, {3.716201976973514*^9, 
   3.716201989580621*^9}, {3.7177408972749023`*^9, 3.717740919551998*^9}, 
   3.726561495995541*^9, 3.72767528757977*^9, 3.7303561656883583`*^9, 
   3.737968266806053*^9, 3.73796846818062*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[181]:=",ExpressionUUID->"7d860420-44c2-4999-bbcc-08d1df4f64c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[182]:=",ExpressionUUID->"d8ec7c26-2004-4faf-946c-e75676e28778"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReflectionList", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105581487666*^9, 3.668188141932252*^9, 3.682827194448793*^9, 
   3.684214417115694*^9},ExpressionUUID->"3c0bd9f8-dc90-42c8-b080-\
6f73152589fd"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[183]:=",ExpressionUUID->"2dea52a8-0bb7-4725-b28e-ed330d9b1ddc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "form"}], "=", 
   "\"\<Some reflections are not on a {\!\(\*StyleBox[\"h\", \"TI\"]\), \
\!\(\*StyleBox[\"k\", \"TI\"]\), \!\(\*StyleBox[\"l\", \"TI\"]\)} \
form.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "integer"}], "=", 
   "\"\<Some reflection indices are not integers.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "empty"}], "=", 
   "\"\<No reflections match the conditions.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "keep"}], "=", 
   "\"\<Invalid setting for the \[LeftGuillemet]Keep\[RightGuillemet] option.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReflectionList", "::", "index"}], "=", 
   "\"\<Invalid index setting.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReflectionList", "::", "limit"}], "=", 
    "\"\<Limit must be a natural number.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ReflectionList"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<CustomReflections\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Keep\>\"", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Limit\>\"", "\[Rule]", "30"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<ShowProgress\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SplitEquivalent\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<HoldIndex\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"'", 
       RowBox[{"ToStandardSetting", "'"}], " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ToStandardSetting\>\"", "\[Rule]", "True"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.730356152266515*^9, {3.742022139935775*^9, 3.742022156094028*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"aeda2119-96e7-47ad-9852-e406c29541f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[191]:=",ExpressionUUID->"abd56de5-8541-4cfc-b00e-cf2976046ad5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReflectionList", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
        RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
    "\[IndentingNewLine]", "condition___Condition", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "ReflectionList"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "opt", ",", "i", ",", "v", ",", "h", ",", "k", ",", "l", ",", "hkl"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Optional", ":", " ", 
      RowBox[{
      "Hold", " ", "an", " ", "index", " ", "at", " ", "same", " ", 
       "value"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"opt", "=", 
      RowBox[{"OptionValue", "[", "\"\<HoldIndex\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{
         RowBox[{"Head", "@", "opt"}], "\[Equal]", "Rule"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "v"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{"opt", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"StringTake", "[", 
          RowBox[{"i", ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"i", "=", "\"\<None\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[NotEqual]", "\"\<None\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<h\>\"", ",", "\"\<k\>\"", ",", "\"\<l\>\""}], 
              "}"}], ",", "i"}], "]"}]}], "||", 
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", "v", "]"}]}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"ReflectionList", "::", "index"}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"hkl", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "\"\<h\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", ",", "k", ",", "l"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"i", "\[Equal]", "\"\<k\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h", ",", "v", ",", "l"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"i", "\[Equal]", "\"\<l\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h", ",", "k", ",", "v"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "n"}], ",", "n"}], "]"}], ",", "3"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Remove", " ", 
       RowBox[{"the", " ", "'"}], 
       RowBox[{"000", "'"}], " ", "reflection"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"hkl", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Sorting", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"hkl", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{"Abs", "[", "#", "]"}]}], "&"}], ",", "Negative"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Checking", " ", "if", " ", "extra", " ", "conditions", " ", "are", " ",
        "present"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "condition", "}"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Filtering", " ", "reflections"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"hkl", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{"hkl", ",", "condition"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "hkl"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.6681063146377697`*^9, {3.6681794881585197`*^9, 
   3.6681794908373833`*^9}, 3.668179945997423*^9, {3.66818814657975*^9, 
   3.668188157307557*^9}, {3.6846634286032257`*^9, 3.684663437628909*^9}, {
   3.684666849371333*^9, 3.684666850027832*^9}, {3.684666967261876*^9, 
   3.6846670086191874`*^9}, {3.6846670396091223`*^9, 
   3.6846671042527514`*^9}, {3.684667154917301*^9, 3.684667166534492*^9}, {
   3.685418587482739*^9, 3.685418600803513*^9}, {3.6854196568824778`*^9, 
   3.685419762523224*^9}, {3.6854198033527*^9, 3.685420025866006*^9}, {
   3.6854209220003233`*^9, 3.685420970517354*^9}, {3.685421010676374*^9, 
   3.685421055071308*^9}, {3.6854211041566896`*^9, 3.685421105555825*^9}, {
   3.685768693396085*^9, 3.685768694755793*^9}, {3.7161940339382677`*^9, 
   3.716194068263068*^9}, 3.7161942428531113`*^9, 3.7161943378126307`*^9, {
   3.716194403563705*^9, 3.716194405470615*^9}, {3.716197549021216*^9, 
   3.7161976731716957`*^9}, {3.716197717712677*^9, 3.71619772022684*^9}, {
   3.7161977595993767`*^9, 3.716197788631216*^9}, {3.716197844708214*^9, 
   3.716197847086852*^9}, {3.7161978772508383`*^9, 3.716197881594894*^9}, {
   3.71619791290978*^9, 3.716197954650558*^9}, {3.716197998443026*^9, 
   3.7161980383758698`*^9}, {3.716198109371828*^9, 3.71619815097666*^9}, {
   3.716198220389483*^9, 3.7161982363282843`*^9}, {3.716198272914839*^9, 
   3.7161982897401857`*^9}, {3.716206052767763*^9, 3.7162060916556883`*^9}, {
   3.7162061573118143`*^9, 3.7162061889322157`*^9}, 3.7185177553887987`*^9, {
   3.718517839124168*^9, 3.7185178837692966`*^9}, {3.71851862637221*^9, 
   3.718518632587442*^9}, {3.71851874344134*^9, 3.718518795246827*^9}, {
   3.718518867183139*^9, 3.718518869398591*^9}, 3.718518962141176*^9, {
   3.718518998347128*^9, 3.7185190920731363`*^9}, {3.718519440795792*^9, 
   3.718519442793964*^9}, {3.7185196193513517`*^9, 3.718519699717318*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[192]:=",ExpressionUUID->"b25b7597-1501-4073-a875-d379d9a8992d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReflectionList", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    "condition___Condition", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "ReflectionList"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\[Lambda]", ",", "limit", ",", "H", ",", "\[Theta]", ",", 
      "checkIfEmpty", ",", "custom", ",", "n", ",", "list", ",", 
      "\[IndentingNewLine]", "G", ",", "Ginv", ",", "CrystalDot", ",", "res", 
      ",", "\[IndentingNewLine]", "keep", ",", "options", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Progress", " ", "*)"}], "\[IndentingNewLine]", 
      "progress", ",", "total"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Dynamical", " ", "progress"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\"\<Initialisation\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"total", "=", "11"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<ShowProgress\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"ProgressIndicator", "@", 
            RowBox[{"Dynamic", "[", 
             RowBox[{
              RowBox[{"progress", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", "total"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"Dynamic", "@", 
            RowBox[{"progress", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "\t", 
          "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Checking", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\"\<Checking input\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"crystal", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"lambda", "\[Equal]", 
        RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"InputCheck", "[", 
         RowBox[{"crystal", ",", "\"\<GetCrystalWavelength\>\""}], "]"}]}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"\[Lambda]", "=", "lambda"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"limit", "=", 
      RowBox[{"OptionValue", "[", "\"\<Limit\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Positive", "[", "limit", "]"}], "&&", 
          RowBox[{"IntegerQ", "[", "limit", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"ReflectionList", "::", "limit"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "\"\<Defining variables\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"G", "=", 
      RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Ginv", "=", 
      RowBox[{"Inverse", "@", "G"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"H", "=", 
      RowBox[{"N", "@", 
       RowBox[{"Chop", "@", "Ginv"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "hkl_", "]"}], ":=", 
      RowBox[{"N", "[", 
       RowBox[{"ArcSin", "[", 
        RowBox[{"\[Lambda]", "*", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"hkl", ".", "H", ".", "hkl"}], "]"}], "/", "2"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Empty", " ", "list", " ", "check"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"checkIfEmpty", ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"list", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"ReflectionList", "::", "empty"}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Goto", "[", "\"\<ReturnEmpty\>\"", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", ":", " ", 
       RowBox[{"Use", " ", "custom", " ", "reflections"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "\"\<Custom input\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<CustomReflections\>\"", "]"}]}], ",",
        "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"custom", "=", 
         RowBox[{"OptionValue", "[", "\"\<CustomReflections\>\"", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "custom", " ", "input"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "@", "custom"}], "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"InputCheck", "::", "hkl"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"InputCheck", "[", 
           RowBox[{
           "custom", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
           "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\t", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"list", "=", "custom"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<ListDone\>\"", "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Generating", " ", "a", " ", "reflection", " ", "list"}], " ",
       "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "\"\<Generating a reflection list\>\""}], "}"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Dot", " ", "product", " ", "in", " ", "reciprocal", " ", "space"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CrystalDot", "[", 
       RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Ginv", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"u", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"v", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"{", 
            RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Coarse", " ", "decision", " ", "on", " ", 
       RowBox[{"which", " ", "'"}], 
       RowBox[{"hkl", "'"}], " ", "values", " ", "to", " ", "generate"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"5", ",", "\"\<Deciding which 'hkl' values to generate\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"options", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
       RowBox[{"Keys", "@", 
        RowBox[{"Options", "@", "ReflectionList"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"n", "=", "1"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Im", "@", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n", ",", "n"}], "}"}], "]"}]}], "\[Equal]", 
        "0"}], ",", 
       RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"n", ",", "limit"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"ReflectionList", "[", 
       RowBox[{"n", ",", "condition", ",", "options"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "checkIfEmpty", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Resolution", " ", "filtering"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"6", ",", "\"\<Resolution filtering\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"res", "=", 
      RowBox[{"\[Lambda]", "/", "2"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"list", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"CrystalDot", "[", 
            RowBox[{"#", ",", "#"}], "]"}], "]"}], "<", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1.01", "*", "res"}], ")"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "checkIfEmpty", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Filter", " ", "away", " ", "absent", " ", "reflections"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<ListDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"7", ",", "\"\<Filtering away absent reflections\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"Pick", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"list", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"SystematicAbsentQ", "[", 
         RowBox[{"crystal", ",", "list"}], "]"}], ",", "\[IndentingNewLine]", 
        "\t", "False"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     "checkIfEmpty", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Filter", " ", "away", " ", "reflections", " ", "with", " ", "complex", 
       " ", "Bragg", " ", "angle"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"8", ",", "\"\<Checking Bragg angles\>\""}], "}"}]}], " ", ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"list", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", "#", "]"}], "\[LessEqual]", "1"}], "&&", 
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "=!=", "Complex"}]}], "&"}], 
          "[", 
          RowBox[{"\[Theta]", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{
         RowBox[{"Merge", " ", "symmetry"}], "-", 
         RowBox[{"equivalent", " ", "reflections"}]}]}]}], " ", "**)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"9", ",", "\"\<Merging symmetry equivalent reflections\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<SplitEquivalent\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", "Split", " ", "*)"}], "\[IndentingNewLine]", "\t", 
       "Null", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", "Merge", " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"list", "=", 
        RowBox[{
        "MergeSymmetryEquivalentReflections", "[", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"crystal", ",", "list", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<ToStandardSetting\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<ToStandardSetting\>\"", "]"}]}]}],
          "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Limit", " ", "number", " ", "of", " ", "reflections"}]}]}], 
      " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"10", ",", "\"\<Limiting the number of reflections\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"keep", "=", 
      RowBox[{"OptionValue", "[", "\"\<Keep\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"keep", "\[Equal]", "All"}], ",", 
       RowBox[{"keep", "=", 
        RowBox[{"Length", "@", "list"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "keep", "]"}], "&&", 
          RowBox[{"Positive", "[", "keep", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Message", "[", 
        RowBox[{"ReflectionList", "::", "keep"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"progress", "=", 
      RowBox[{"{", 
       RowBox[{"11", ",", "\"\<Reflection list done\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"list", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"list", ",", 
        RowBox[{"Min", "[", 
         RowBox[{"keep", ",", 
          RowBox[{"Length", "@", "list"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "End", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "list"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<ReturnEmpty\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106184497395*^9, {3.668179282556993*^9, 
   3.668179291738758*^9}, 3.668180181616701*^9, 3.668188149406043*^9, {
   3.6681881979543457`*^9, 3.6681882467050457`*^9}, {3.668188593440853*^9, 
   3.668188694254387*^9}, 3.6681888088447247`*^9, {3.668188844363966*^9, 
   3.668188871474244*^9}, {3.6681889047538137`*^9, 3.668188922729329*^9}, 
   3.668189128709815*^9, {3.668189166268243*^9, 3.668189431749264*^9}, {
   3.668189645376062*^9, 3.668189649240117*^9}, {3.668189804616765*^9, 
   3.668189807470254*^9}, {3.668189838436864*^9, 3.668189884772358*^9}, {
   3.668189929178705*^9, 3.668190023760564*^9}, {3.6681907997252617`*^9, 
   3.668190858100079*^9}, {3.668191260899456*^9, 3.668191322370517*^9}, {
   3.668194280870161*^9, 3.66819428782981*^9}, {3.668196653374757*^9, 
   3.668196677347934*^9}, {3.679758065507057*^9, 3.6797580749954453`*^9}, {
   3.6797581581250477`*^9, 3.679758229415306*^9}, {3.6797582839727993`*^9, 
   3.679758384682056*^9}, {3.67975842843478*^9, 3.679758450522142*^9}, {
   3.67975848234529*^9, 3.679758538264204*^9}, {3.6797588299927883`*^9, 
   3.679758838151547*^9}, {3.679759573704154*^9, 3.6797595780157013`*^9}, {
   3.6816688605634604`*^9, 3.68166886238643*^9}, 3.682761693212624*^9, {
   3.682761776882873*^9, 3.682761783031293*^9}, {3.682761990469831*^9, 
   3.682762067367221*^9}, {3.682762238569338*^9, 3.682762258037012*^9}, {
   3.682762379145604*^9, 3.682762551599121*^9}, {3.6827625926782722`*^9, 
   3.6827626402047586`*^9}, {3.682763068942165*^9, 3.6827630940933104`*^9}, {
   3.682763158201823*^9, 3.682763165807467*^9}, {3.682764974181076*^9, 
   3.682764993909774*^9}, {3.68276795013719*^9, 3.682767951957551*^9}, {
   3.6827683854796124`*^9, 3.6827684355907583`*^9}, {3.682768727648377*^9, 
   3.682768728286333*^9}, {3.682768829821347*^9, 3.6827688433963747`*^9}, 
   3.682769104334716*^9, {3.682769175661327*^9, 3.682769266066882*^9}, 
   3.6827693004348497`*^9, 3.682769417055482*^9, {3.682769455573188*^9, 
   3.682769458940526*^9}, {3.682769607209363*^9, 3.682769627688966*^9}, {
   3.68276970943268*^9, 3.682769728470189*^9}, {3.682769786086359*^9, 
   3.6827697999006023`*^9}, {3.682769838204773*^9, 3.682769852251082*^9}, {
   3.682792225868579*^9, 3.68279222687479*^9}, {3.6827924002405043`*^9, 
   3.682792402616119*^9}, 3.682792574694977*^9, {3.6828253243024063`*^9, 
   3.682825325886156*^9}, {3.6841397853456163`*^9, 3.6841397897886257`*^9}, {
   3.684139855686323*^9, 3.684139909090061*^9}, {3.684140071281108*^9, 
   3.684140072800102*^9}, {3.684140111834372*^9, 3.6841401375080357`*^9}, {
   3.684140171617261*^9, 3.684140367431093*^9}, 3.684140413002187*^9, {
   3.684140607591*^9, 3.684140719518632*^9}, 3.684145330433218*^9, {
   3.684145367821651*^9, 3.68414536950362*^9}, {3.6842136403446903`*^9, 
   3.684213644869915*^9}, {3.684213781858488*^9, 3.684213842590571*^9}, {
   3.684214341919759*^9, 3.6842143481060534`*^9}, {3.684662946378191*^9, 
   3.684663033222123*^9}, {3.684666733281546*^9, 3.6846667335043497`*^9}, {
   3.684666789312871*^9, 3.6846667918438883`*^9}, {3.684667191356744*^9, 
   3.684667230047998*^9}, {3.684667576777402*^9, 3.684667648184586*^9}, {
   3.6846692069053698`*^9, 3.684669239222193*^9}, {3.684669303503991*^9, 
   3.684669304232194*^9}, {3.684669351718648*^9, 3.68466935801514*^9}, {
   3.6846696540499773`*^9, 3.6846697128700647`*^9}, 3.684669821629673*^9, {
   3.684670188061883*^9, 3.684670339910618*^9}, {3.684741565023261*^9, 
   3.684741565191321*^9}, {3.6847416190109797`*^9, 3.6847416192011423`*^9}, {
   3.6847417135516577`*^9, 3.6847417286424093`*^9}, 3.6847440797217293`*^9, {
   3.684745574688994*^9, 3.684745611189694*^9}, {3.684745671918826*^9, 
   3.684745674267671*^9}, {3.684755103228157*^9, 3.684755108576395*^9}, {
   3.684755171923361*^9, 3.684755187463394*^9}, {3.684755246825118*^9, 
   3.684755283342084*^9}, {3.6847553676610107`*^9, 3.684755431665193*^9}, {
   3.684755486352098*^9, 3.684755527993668*^9}, 3.684755583263332*^9, 
   3.6850821865474253`*^9, 3.6850840533478737`*^9, {3.685252116307905*^9, 
   3.685252130289748*^9}, {3.6852521639931173`*^9, 3.6852522099243727`*^9}, {
   3.6852522696028643`*^9, 3.685252305885971*^9}, {3.685299079213583*^9, 
   3.685299128553773*^9}, {3.685421136843091*^9, 3.6854212005008287`*^9}, {
   3.685421247997067*^9, 3.685421273847663*^9}, {3.685421839983242*^9, 
   3.685421881876747*^9}, {3.6854220306738977`*^9, 3.68542211867824*^9}, 
   3.6857659255735283`*^9, {3.685769388710121*^9, 3.685769443166129*^9}, {
   3.685769502208377*^9, 3.6857695272180357`*^9}, {3.685770126995985*^9, 
   3.685770145533038*^9}, {3.685771239786865*^9, 3.685771240255959*^9}, {
   3.685784051382121*^9, 3.6857841117518797`*^9}, {3.685784265618553*^9, 
   3.685784278519128*^9}, {3.685784409071766*^9, 3.685784411110262*^9}, {
   3.685784529872205*^9, 3.6857845940883636`*^9}, {3.685784803091606*^9, 
   3.685784842772554*^9}, {3.686657600224687*^9, 3.686657671699209*^9}, {
   3.6866577115441504`*^9, 3.686657714636054*^9}, {3.686657747010147*^9, 
   3.686657810681427*^9}, {3.6866579946426067`*^9, 3.6866580360676737`*^9}, {
   3.68665807591435*^9, 3.6866582357264347`*^9}, {3.686658270034141*^9, 
   3.6866585330297403`*^9}, {3.686658564917584*^9, 3.686658673625255*^9}, {
   3.686658755022271*^9, 3.686658766266034*^9}, 3.686894057694735*^9, {
   3.6870713455229473`*^9, 3.687071351352529*^9}, {3.6870739076956863`*^9, 
   3.687073920398181*^9}, {3.7143868107397623`*^9, 3.714386844409388*^9}, {
   3.714387107839142*^9, 3.714387129978853*^9}, {3.714455900836638*^9, 
   3.714455905313134*^9}, {3.714457271188592*^9, 3.714457271361904*^9}, {
   3.714457992952488*^9, 3.7144580362802258`*^9}, {3.714458100647457*^9, 
   3.714458104893808*^9}, {3.714458147871139*^9, 3.714458163404636*^9}, {
   3.714458341305675*^9, 3.7144583420726757`*^9}, {3.7147125204212837`*^9, 
   3.714712552375537*^9}, {3.7147129949496403`*^9, 3.714713045261551*^9}, {
   3.714816168307774*^9, 3.7148161969150953`*^9}, {3.714816284113997*^9, 
   3.7148163393843727`*^9}, {3.714816422375482*^9, 3.714816430294612*^9}, {
   3.716193705872978*^9, 3.7161937589650707`*^9}, {3.716193828675597*^9, 
   3.716193905188253*^9}, 3.716194238592029*^9, 3.7161943343865337`*^9, {
   3.7161944090351143`*^9, 3.716194410957553*^9}, {3.7161944865635023`*^9, 
   3.716194488361787*^9}, {3.716194668670053*^9, 3.7161947824000607`*^9}, {
   3.716194928105888*^9, 3.716194929217705*^9}, {3.716194999576075*^9, 
   3.716195018887147*^9}, {3.71619844966753*^9, 3.716198462293277*^9}, {
   3.7161985275653152`*^9, 3.716198541652034*^9}, {3.717740896524231*^9, 
   3.7177409196071587`*^9}, {3.718520024357975*^9, 3.718520050004541*^9}, {
   3.7185204232425213`*^9, 3.7185204317771883`*^9}, {3.7185263265766277`*^9, 
   3.718526358969618*^9}, {3.718526413551124*^9, 3.718526457381061*^9}, {
   3.718526548948234*^9, 3.718526582995021*^9}, {3.7185268790454483`*^9, 
   3.718526883595771*^9}, {3.718526951469385*^9, 3.7185269516031733`*^9}, 
   3.7265615393313313`*^9, 3.727675288396509*^9, 3.727676784192745*^9, 
   3.7301063103561983`*^9, 3.730356159302247*^9, {3.7303566959053307`*^9, 
   3.73035676505906*^9}, {3.7303568110713243`*^9, 3.730356916108645*^9}, {
   3.730357018258333*^9, 3.7303570472177258`*^9}, {3.730357097713035*^9, 
   3.7303571568866863`*^9}, 3.730357226293139*^9, {3.730357395849288*^9, 
   3.730357427671856*^9}, {3.7303574676640463`*^9, 3.730357484270207*^9}, 
   3.737968468305195*^9, {3.742021962959537*^9, 3.7420220175219803`*^9}, {
   3.742022111944613*^9, 3.7420221299270153`*^9}, {3.7420221739832993`*^9, 
   3.742022177446185*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[193]:=",ExpressionUUID->"33cbd15a-a70e-4f2b-bb1c-1fffa1ddd8ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[194]:=",ExpressionUUID->"119d5847-7a97-49d5-ae0d-69132759d164"]
}, Closed]],

Cell[CellGroupData[{

Cell["RelatedFunctionsGraph", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, {3.7142997886404963`*^9, 
   3.7142997926945553`*^9}},ExpressionUUID->"c89479ba-70ef-423f-9e19-\
f49bdf34deee"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[195]:=",ExpressionUUID->"5aa551c9-82df-448d-9ae9-25ab8cb89960"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "RelatedFunctionsGraph"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Limit\>\"", "\[Rule]", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DirectOnly\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ShowDependent\>\"", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714300336239785*^9, 3.7143003481828947`*^9}, {
  3.714301392171356*^9, 3.714301396387164*^9}, {3.7143023369906797`*^9, 
  3.714302341243659*^9}, {3.730122907680587*^9, 3.730122942623517*^9}, {
  3.7301241679174767`*^9, 3.7301241685476847`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"db25a19e-3ceb-41d6-bac0-2a577dfc51cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"RelatedFunctionsGraph", ",", "HoldFirst"}], "]"}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.7300961670423326`*^9, 3.7300961708125143`*^9}, {
  3.730096698004781*^9, 3.730096704220503*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"31d61b69-17ca-42e1-a9e1-f4ce24a7db2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[198]:=",ExpressionUUID->"edafc056-9644-41cf-bcd3-042725e00852"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RelatedFunctionsGraph", "[", 
    RowBox[{"function_", ",", 
     RowBox[{"OptionsPattern", "@", "RelatedFunctionsGraph"}]}], "]"}], ":=", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "f", ",", "allf", ",", "deffile", ",", "import", ",", "finddepf", ",", 
       "data", ",", "d", ",", "main", ",", "g", ",", "done", ",", "new", ",", 
       "x", ",", "X", ",", "c", ",", "part"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Loading", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"HoldForm", "@", "function"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allf", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"First", "@", "$MaXrdFunctions"}]}], ",", "\"\<\>\""}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"deffile", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Definitions.m\>\""}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"import", "=", 
       RowBox[{"StringJoin", "@", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"deffile", ",", "\"\<Text\>\""}], "]"}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Show", " ", "all", " ", "functions", " ", "depedent", " ", 
         RowBox[{"on", " ", "'"}], 
         RowBox[{"f", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<ShowDependent\>\"", "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"data", "=", 
          RowBox[{"StringCases", "[", 
           RowBox[{"import", ",", 
            RowBox[{
             RowBox[{"Shortest", "[", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"c", ":", 
                RowBox[{"(", "allf", ")"}]}], "~~", 
               RowBox[{"{", 
                RowBox[{"\"\<[\>\"", ",", "\"\<:=\>\""}], "}"}], "~~", "d__", 
               "~~", "\"\<End[];\>\""}], "]"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"c", ",", "d"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"x", "=", 
          RowBox[{"Reap", "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"c", "=", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"d", "=", 
               RowBox[{"Sort", "@", 
                RowBox[{"DeleteDuplicates", "@", 
                 RowBox[{"StringCases", "[", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "allf"}], 
                  "]"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"d", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"d", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"Sow", "[", 
               RowBox[{"c", "\[Rule]", "d"}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"x", "=", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"part", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"Position", "[", 
            RowBox[{"x", ",", "f"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"g", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"x", "[", 
            RowBox[{"[", "part", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]",
          "\t", 
         RowBox[{"g", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"g", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"If", " ", "none"}], ",", " ", 
           RowBox[{"return", " ", "empty", " ", "list"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"g", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"g", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "\[Rule]", "#"}], "&"}], "/@", "g"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Goto", "[", "\"\<GraphDataGenerated\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Function", " ", "for", " ", "finding", " ", "related", " ", 
        "functions"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"finddepf", "[", "F_", "]"}], ":=", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data", "=", 
          RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
           RowBox[{"import", ",", 
            RowBox[{
             RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
              RowBox[{
              "\"\<Begin[\\\"`Private`\\\"];\>\"", "~~", "Whitespace", "~~", 
               "\[IndentingNewLine]", 
               "\"\<(* ::Input::Initialization:: *)\\n\>\"", "~~", 
               "\[IndentingNewLine]", "F", "~~", 
               RowBox[{"{", 
                RowBox[{"\"\<[\>\"", ",", "\"\<:=\>\""}], "}"}], "~~", "d__", 
               "~~", "\"\<End[];\>\""}], "]"}], "\[IndentingNewLine]", 
             "\[RuleDelayed]", "d"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Check", " ", "if", " ", "anything", " ", "is", " ", "found"}], " ",
           "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"data", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Sort", "@", 
             RowBox[{"StringCases", "[", 
              RowBox[{
               RowBox[{"First", "@", "data"}], ",", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<\\\"\>\"", "~~", "allf", "~~", "\"\<\\\"\>\""}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"allf", "~~", "\"\<::\>\""}], ",", 
                 "\[IndentingNewLine]", "allf"}], "}"}]}], "]"}]}]}]}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"d", ",", "F"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"d", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\\\"\>\"", ",", "\"\<::\>\""}], "}"}]}], 
              "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Seed", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"main", "=", 
       RowBox[{"finddepf", "@", "f"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"main", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Loop", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"done", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"new", "=", 
       RowBox[{"{", "f", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"new", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"First", "@", "new"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"X", "=", 
          RowBox[{"finddepf", "@", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"g", "=", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Join", "[", 
            RowBox[{"g", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[Rule]", "x"}], "&"}], "/@", "X"}]}], "]"}]}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"done", ",", "x"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"new", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"new", ",", "X"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"new", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"new", ",", "done"}], "]"}]}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Label", "[", "\"\<GraphDataGenerated\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"DeleteDuplicatesBy", "[", 
        RowBox[{"g", ",", "Sort"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Only", " ", "directly", " ", "connected"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<DirectOnly\>\"", "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"g", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"g", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a_", "\[Rule]", "b_"}], ")"}], "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "\[NotEqual]", "f"}], "&&", 
              RowBox[{"b", "\[NotEqual]", "f"}]}], ")"}]}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Optional", ":", " ", 
        RowBox[{"Limiting", " ", "graph"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"g", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"g", ",", 
         RowBox[{"UpTo", "@", 
          RowBox[{"OptionValue", "[", "\"\<Limit\>\"", "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Plot", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"GraphPlot", "[", 
       RowBox[{"g", ",", 
        RowBox[{"DirectedEdges", "\[Rule]", "True"}], ",", 
        RowBox[{"VertexLabeling", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MultiedgeStyle", "\[Rule]", "False"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DirectedEdges", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"SelfLoopStyle", "\[Rule]", "None"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexLabeling", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexRenderingFunction", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"White", ",", 
             RowBox[{"EdgeForm", "[", "]"}], ",", 
             RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.02", "*", 
                   RowBox[{"StringLength", "@", "#2"}]}], ",", "0.05"}], 
                 "}"}]}], ",", 
               RowBox[{"#", "+", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.02", "*", 
                   RowBox[{"StringLength", "@", "#2"}]}], ",", "0.05"}], 
                 "}"}]}]}], "]"}], ",", "Black", ",", "\[IndentingNewLine]", 
             RowBox[{"Text", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Hyperlink", "[", 
                  RowBox[{"#2", ",", " ", 
                   RowBox[{"\"\<paclet:MaXrd/ref/\>\"", "<>", "#2"}]}], "]"}],
                  ",", "\[IndentingNewLine]", "11", ",", "\"\<Program\>\""}], 
                "]"}], ",", "\[IndentingNewLine]", "#1"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "&"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Method", "\[Rule]", "\"\<RadialDrawing\>\""}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.685292929314414*^9, 3.685292949551355*^9}, {
   3.685292980630427*^9, 3.685293093109366*^9}, {3.6852935686996202`*^9, 
   3.685293592607072*^9}, {3.685294304496677*^9, 3.685294312832938*^9}, {
   3.685294359159436*^9, 3.685294392591338*^9}, 3.685294452156907*^9, {
   3.7125585005216303`*^9, 3.712558599149044*^9}, {3.712558653688374*^9, 
   3.712558706404811*^9}, 3.712558740953339*^9, {3.7125590860901546`*^9, 
   3.712559142612122*^9}, {3.7125592016674137`*^9, 3.7125592063906593`*^9}, {
   3.712559401604739*^9, 3.71255953948845*^9}, {3.714299857191777*^9, 
   3.7142999807555943`*^9}, {3.714300353839711*^9, 3.714300370025322*^9}, {
   3.7143006580073347`*^9, 3.71430073426262*^9}, {3.714300764771763*^9, 
   3.714300765044641*^9}, {3.7143009931156893`*^9, 3.714300999489381*^9}, {
   3.714301113534289*^9, 3.714301113829965*^9}, {3.7143020774421186`*^9, 
   3.7143021118228292`*^9}, {3.71430227439701*^9, 3.714302294510023*^9}, {
   3.714302347836523*^9, 3.7143023831981583`*^9}, 3.714302664964923*^9, {
   3.714302722174418*^9, 3.714302735315815*^9}, {3.714302979671762*^9, 
   3.714303016956828*^9}, {3.7143030469840384`*^9, 3.714303104119825*^9}, {
   3.714303151126802*^9, 3.7143031732439528`*^9}, {3.714310925701439*^9, 
   3.714310932964589*^9}, {3.7143142015143538`*^9, 3.7143142638299913`*^9}, {
   3.714314627190888*^9, 3.714314627357841*^9}, {3.717950017228942*^9, 
   3.717950160656786*^9}, {3.730095724552846*^9, 3.730095727188938*^9}, {
   3.730095768792885*^9, 3.7300957955994368`*^9}, {3.730095872367436*^9, 
   3.7300959720295467`*^9}, {3.730096018757462*^9, 3.730096023821756*^9}, {
   3.730096101254458*^9, 3.730096112884797*^9}, {3.7300967599675837`*^9, 
   3.730096761279415*^9}, {3.730104202662957*^9, 3.730104206917555*^9}, {
   3.730379169007759*^9, 3.73037924742875*^9}, {3.730379446001863*^9, 
   3.730379450823716*^9}, {3.7303794992640257`*^9, 3.7303795127738*^9}, {
   3.742028275962288*^9, 3.742028294205703*^9}, {3.742028329004146*^9, 
   3.7420283507206287`*^9}, 3.74383537227837*^9, 3.743865333765183*^9, 
   3.743865412706151*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[199]:=",ExpressionUUID->"50a12956-af47-4f3c-8db4-990281e7fd74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[200]:=",ExpressionUUID->"72529848-bcdd-4cbb-98a7-70632c549cc6"]
}, Closed]],

Cell[CellGroupData[{

Cell["StructureFactor", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327322973885*^9, 3.682327330887693*^9}, 3.682607017127143*^9, 
   3.6839701729945917`*^9, 3.6841388311985064`*^9, 3.6908782674206257`*^9, {
   3.7186534034983*^9, 3.718653404817141*^9}, 
   3.7391696076737328`*^9},ExpressionUUID->"5f66d2ce-62aa-4d7c-9868-\
ac7f9e7a4ca4"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[201]:=",ExpressionUUID->"dbf6caec-edc9-4e5e-ac04-d3d0941e5688"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StructureFactor", "::", "invalidsetting"}], "=", 
   "\"\<Invalid setting of the `1` option.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StructureFactor", "::", "extinct"}], "=", 
   "\"\<The reflection `1` is systematically absent for space group \
`2`.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StructureFactor", "::", "mismatch"}], "=", 
    "\"\<Element mismatch detected.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "StructureFactor"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<AbsoluteValue\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Units\>\"", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<IgnoreSystematicAbsence\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Threshold\>\"", "\[Rule]", 
      RowBox[{"Power", "[", 
       RowBox[{"10.", ",", 
        RowBox[{"-", "6"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Options", " ", 
       RowBox[{"from", " ", "'"}], 
       RowBox[{"AtomicScatteringFactor", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<DispersionCorrections\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<f0Source\>\"", "\[Rule]", "\"\<WaasmaierKirfel\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<f1f2Source\>\"", "\[Rule]", "\"\<CromerLiberman\>\""}], ",",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Options", " ", 
       RowBox[{"from", " ", "'"}], 
       RowBox[{"GetElements", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"\"\<IgnoreIonCharge\>\"", "\[Rule]", "True"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7186504887317142`*^9, 3.7186505104123993`*^9}, {
   3.718650833844981*^9, 3.718650860266952*^9}, {3.719071620177432*^9, 
   3.719071653263418*^9}, {3.7238803711167517`*^9, 3.7238803796417437`*^9}, {
   3.723880463384264*^9, 3.7238804927994747`*^9}, {3.724146049028111*^9, 
   3.7241461473154383`*^9}, {3.724147956329715*^9, 3.72414795872057*^9}, {
   3.724150271869894*^9, 3.724150297714615*^9}, {3.7246665076500187`*^9, 
   3.724666508113414*^9}, {3.725173720083654*^9, 3.7251737230739307`*^9}, {
   3.725173864767118*^9, 3.7251738659667597`*^9}, {3.7254483178322573`*^9, 
   3.725448342494196*^9}, {3.7256173921911087`*^9, 3.725617392898306*^9}, {
   3.726907438437258*^9, 3.7269074387588778`*^9}, 3.727244020896077*^9, {
   3.7303807654171133`*^9, 3.73038076676744*^9}, {3.737806839827971*^9, 
   3.737806866175991*^9}, {3.738649503972081*^9, 3.73864950513848*^9}, {
   3.739169640520637*^9, 3.7391696643680573`*^9}, {3.739184520182152*^9, 
   3.739184554187086*^9}, {3.739184633436884*^9, 3.73918463368222*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"ef560771-6f30-4ec6-8439-0b49797d9c71"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[206]:=",ExpressionUUID->"eeb47795-2852-4abd-9391-1197590b7f03"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureFactor", "[", "\[IndentingNewLine]", 
   RowBox[{
   "crystal_String", ",", "\[IndentingNewLine]", "hklInput_List", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "StructureFactor"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "data", ",", "abs", ",", "ignoreExtinct", ",", "units", ",", "\[Delta]", 
      ",", "hkl", ",", "L0", ",", "L", ",", "\[Lambda]", ",", 
      "\[IndentingNewLine]", "zerotype", ",", "absence", ",", "l", ",", 
      "hklPos", ",", "j", ",", "\[IndentingNewLine]", "sgHM", ",", "H", ",", 
      "d", ",", "sl", ",", "fOptions", ",", "f", ",", "\[IndentingNewLine]", 
      "atomdata", ",", "r", ",", "operators", ",", "type", ",", 
      "\[IndentingNewLine]", "disp", ",", "U", ",", "R", ",", "T", ",", 
      "lattice", ",", "cvecs", ",", "occ", ",", "elements", ",", 
      "\[IndentingNewLine]", "siteSymMxyz", ",", "siteSymO", ",", 
      "\[IndentingNewLine]", "sf", ",", "SF", ",", "F", ",", "\[Phi]"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checking", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Crystal", " ", "and", " ", 
      RowBox[{"wavelength", "/", "energy"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"InputCheck", "[", 
       RowBox[{"crystal", ",", "\"\<CrystalQ\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"InputCheck", "[", 
        RowBox[{"crystal", ",", "lambda", ",", "\"\<ProcessWavelength\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"data", "=", 
       RowBox[{"$CrystalData", "[", "crystal", "]"}]}], ";"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Option", " ", "settings"}], " ", "*)"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"abs", "=", 
      RowBox[{"OptionValue", "[", "\"\<AbsoluteValue\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"ignoreExtinct", "=", 
      RowBox[{"OptionValue", "[", "\"\<IgnoreSystematicAbsence\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"units", "=", 
      RowBox[{"OptionValue", "[", "\"\<Units\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "\[Delta]"}]}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"StructureFactor", "::", "\"\<invalidsetting\>\""}], ",", 
          "\"\<\\\"Threshold\\\"\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
       "hklInput", ",", "\"\<Integer\>\"", ",", "\"\<WrapSingle\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"L0", "=", 
      RowBox[{"Length", "@", "hkl"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Systematically", " ", "absent", " ", 
       "reflections", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "ignoreExtinct"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Check"}], " ", "for", " ", "systematic", " ",
          "absence"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"zerotype", "=", 
         RowBox[{"If", "[", 
          RowBox[{"abs", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{"units", ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Quantity", "[", 
                RowBox[{"0", ",", "\"\<Degrees\>\""}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"absence", "=", 
         RowBox[{"SystematicAbsentQ", "[", 
          RowBox[{"crystal", ",", "hkl"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"l", "=", 
         RowBox[{"Length", "@", "absence"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"hkl", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"hkl", ",", "absence", ",", "False"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"hklPos", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"absence", ",", "False"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Return", " ", "if", " ", "only", " ", "extinct", " ", 
          "reflections"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "absence"}], ",", "TrueQ"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"l", "===", "1"}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"Return", "@", "zerotype"}], ",", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"Return", "@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"zerotype", ",", "l"}], "]"}]}]}], 
           "\[IndentingNewLine]", "\t", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Keep"}], " ", "list", " ", "as", " ", "is"}],
         " ", "*)"}], "\[IndentingNewLine]", "\t", "Null"}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Useful", " ", "variables", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Miscellaneous", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "hkl"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sgHM", "=", 
      RowBox[{"GetSymmetryData", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", "\"\<SpaceGroup\>\"", "]"}], "]"}], ",", 
        "\"\<HermannMauguinFull\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", 
         RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sl", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"#", ".", "H", ".", "#"}], "]"}], "/", "2"}], "]"}], "&"}],
        "/@", "hkl"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Obtaining", " ", "atomic", " ", "scattering", " ", "factors"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"fOptions", "=", 
      RowBox[{"Keys", "@", 
       RowBox[{"Options", "@", "GetAtomicScatteringFactors"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"fOptions", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"fOptions", ",", "\"\<SeparateCorrections\>\""}], "]"}]}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"fOptions", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
       "fOptions"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"f", "=", 
      RowBox[{"GetAtomicScatteringFactors", "[", 
       RowBox[{"crystal", ",", "hkl", ",", "\[Lambda]", ",", 
        RowBox[{"Sequence", "@@", "fOptions"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Wrap", " ", "'"}], 
       RowBox[{"f", "'"}], " ", "if", " ", "single", " ", "reflection", " ", 
       "input"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "f"}], ",", 
       RowBox[{"f", "=", 
        RowBox[{"{", "f", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"atomdata", "=", 
      RowBox[{"data", "[", "\"\<AtomData\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"r", "=", 
      RowBox[{"atomdata", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<FractionalCoordinates\>\""}], "]"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Variables", " ", "related", " ", "to", " ", "displacement", " ", 
       "parameters"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"d", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Sqrt", "@", 
         RowBox[{"DiagonalMatrix", "@", 
          RowBox[{"Diagonal", "@", "H"}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"disp", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"atomdata", ",", "\"\<DisplacementParameters\>\"", ",", "0."}],
        "]"}]}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Atomic", " ", "displacement", " ", "parameters", " ", "preparation"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"U", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"disp", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "\[Equal]", "6"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"U", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{
               RowBox[{"disp", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "4", ",", "5", ",", "4", ",", "2", ",", "6", ",", 
                 "5", ",", "6", ",", "3"}], "}"}]}], "]"}], ",", "3"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"U", ",", 
           RowBox[{"disp", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "\t", "]"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "disp"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Symmetry", " ", "operators"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"operators", "=", 
      RowBox[{"GetSymmetryOperations", "[", "crystal", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "T"}], "}"}], "=", 
      RowBox[{"Transpose", "@", "operators"}]}], ";", "\[IndentingNewLine]", 
     "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"elements", "=", 
      RowBox[{"atomdata", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Element\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Remove", " ", 
        RowBox[{"charge", "/", "ions"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<IgnoreIonCharge\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"elements", "=", 
        RowBox[{"StringDelete", "[", 
         RowBox[{"elements", ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"DigitCharacter", ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
           "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "\t\t", "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "if", " ", "elements", " ", 
       RowBox[{"don", "'"}], "t", " ", 
       RowBox[{"match", " ", "'"}], 
       RowBox[{"f", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Keys", "@", 
          RowBox[{"First", "@", "f"}]}]}], "=!=", 
        RowBox[{"Sort", "@", 
         RowBox[{"DeleteDuplicates", "@", "elements"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"StructureFactor", "::", "mismatch"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"type", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"atomdata", ",", "\"\<Type\>\"", ",", "\"\<Uiso\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Centring", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     
     RowBox[{"lattice", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"sgHM", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"cvecs", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"InputCheck", "[", 
        RowBox[{"lattice", ",", "\"\<GetCentringVectors\>\""}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Site", " ", "symmetry", " ", "multiplicity", " ", "and", " ", 
       "order"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Site", " ", "multiplicity", " ", "of", " ", "general", " ", 
       "position"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"siteSymMxyz", "=", 
      RowBox[{"cvecs", "*", 
       RowBox[{"Length", "@", "operators"}]}]}], ";", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Site", " ", "symmetry", " ", 
        RowBox[{"order", ":", " ", "siteSymO"}]}], " ", "=", " ", 
       RowBox[{"siteSymMxyz", " ", "/", " ", "siteSymM"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", ".", " ", 
         RowBox[{"Extract", " ", "'"}]}], 
        RowBox[{"SiteSymmetryOrder", "'"}], " ", "from", " ", 
        "$CrystalData"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"First", "@", "atomdata"}], ",", 
         "\"\<SiteSymmetryOrder\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"siteSymO", "=", 
        RowBox[{"atomdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "\"\<SiteSymmetryOrder\>\""}], "]"}], "]"}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Calculate"}], " ", "order", " ", 
         RowBox[{"from", " ", "'"}], 
         RowBox[{"SiteSymmetryMultiplicity", "'"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"First", "@", "atomdata"}], ",", 
         "\"\<SiteSymmetryMultiplicity\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"siteSymO", "=", 
        RowBox[{"siteSymMxyz", "/", "\[IndentingNewLine]", "\t", 
         RowBox[{"atomdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<SiteSymmetryMultiplicity\>\""}], "]"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"c", ".", " ", "Calculate"}], " ", "site", " ", "symmetry", 
         " ", "order"}], " ", "*)"}], "\[IndentingNewLine]", "\t", "True", 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"siteSymO", "=", 
        RowBox[{"siteSymMxyz", "/", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "@", "\[IndentingNewLine]", "\t", 
            RowBox[{
            "SymmetryEquivalentPositions", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"crystal", ",", 
              RowBox[{"r", "[", 
               RowBox[{"[", "a", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"Length", "@", "r"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Occupation", " ", "factor"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<OccupationFactor\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"occ", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"atomdata", ",", "\"\<OccupationFactor\>\"", ",", "1."}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Structure", " ", "factor", " ", 
       "calculation", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Magnitude", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"sf", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"(*", " ", 
        RowBox[{"Table", " ", "for", " ", "each", " ", "reflection"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"1", "\[IndentingNewLine]", "\t", "*", 
           RowBox[{"occ", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{"(*", " ", 
            RowBox[{"Occupation", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "*", "cvecs", 
           RowBox[{"(*", " ", 
            RowBox[{"Centring", " ", "vectors"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "*", 
           RowBox[{"1.0", "/", 
            RowBox[{"siteSymO", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"Symmetry", " ", "reduction"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "*", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "h", "]"}], "]"}], ",", 
             RowBox[{"elements", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
           RowBox[{"(*", " ", 
            RowBox[{"Atomic", " ", "form", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "*", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{"(*", " ", 
                RowBox[{"Atomic", " ", "displacement"}], " ", "*)"}], 
               "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"type", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", 
                 "\"\<Uani\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], 
                  SuperscriptBox["Pi", "2"], "*", 
                  RowBox[{
                   RowBox[{"hkl", "[", 
                    RowBox[{"[", "h", "]"}], "]"}], ".", "d", ".", 
                   RowBox[{"R", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "\[IndentingNewLine]", 
                   "\t\t", ".", 
                   RowBox[{"U", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "\[IndentingNewLine]", 
                   "\t\t", ".", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "]"}], 
                   "\[IndentingNewLine]", "\t\t", ".", "d", ".", 
                   RowBox[{"hkl", "[", 
                    RowBox[{"[", "h", "]"}], "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{"type", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", 
                 "\"\<Uiso\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "8"}], 
                  SuperscriptBox["Pi", "2"], "*", 
                  RowBox[{"disp", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "*", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"sl", "[", 
                    RowBox[{"[", "h", "]"}], "]"}], ")"}], "2"]}], "]"}], ",",
                 "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{"type", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", 
                 "\"\<Bani\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "4"}], "*", 
                  RowBox[{
                   RowBox[{"hkl", "[", 
                    RowBox[{"[", "h", "]"}], "]"}], ".", "d", ".", 
                   RowBox[{"R", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "\[IndentingNewLine]", 
                   "\t\t", ".", 
                   RowBox[{"U", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "\[IndentingNewLine]", 
                   "\t\t", ".", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], "]"}], 
                   "\[IndentingNewLine]", "\t\t", ".", "d", ".", 
                   RowBox[{"hkl", "[", 
                    RowBox[{"[", "h", "]"}], "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{"type", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", 
                 "\"\<Biso\>\""}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"Temperature", " ", "factor"}], " ", "*)"}], 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"disp", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "*", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"sl", "[", 
                    RowBox[{"[", "h", "]"}], "]"}], ")"}], "2"]}], "]"}], ",",
                 "\[IndentingNewLine]", "\t", "True", ",", 
                RowBox[{
                 RowBox[{"Message", "[", 
                  RowBox[{
                   RowBox[{"$CrystalData", "::", "type"}], ",", "type"}], 
                  "]"}], ";", 
                 RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t",
                "]"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"2", "Pi", "*", "I", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"hkl", "[", 
                    RowBox[{"[", "h", "]"}], "]"}], ".", 
                   RowBox[{"R", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], ".", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"hkl", "[", 
                    RowBox[{"[", "h", "]"}], "]"}], ".", 
                   RowBox[{"T", "[", 
                    RowBox[{"[", "s", "]"}], "]"}]}]}], ")"}]}], "]"}]}], ",",
              "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"Length", "@", "R"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "atomdata"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"h", ",", "L"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Phase", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "abs"}], ",", 
       RowBox[{
        RowBox[{"SF", "=", "sf"}], ";", 
        RowBox[{"Goto", "[", "\"\<ComplexNumber\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"SF", "=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"F", "=", 
            RowBox[{"sf", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"a", ".", " ", "Check"}], " ", "threshold"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{"Re", "@", "F"}]}], "<", "\[Delta]"}], ",", 
             RowBox[{"Sow", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{"b", ".", " ", "Calculate"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "\[Equal]", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "\[GreaterEqual]", "0"}]}], 
                ",", "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{"F", "=", "0"}], ";", 
                 RowBox[{"\[Phi]", "=", "90"}]}], ",", "\[IndentingNewLine]", 
                "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "\[Equal]", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "<", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sf", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ";", 
                 RowBox[{"\[Phi]", "=", 
                  RowBox[{"-", "90"}]}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "\[GreaterEqual]", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "\[Equal]", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", "90"}], ",", "\[IndentingNewLine]", 
                "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "<", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "\[Equal]", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", "180"}], ",", "\[IndentingNewLine]", 
                "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], ">", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], ">", "0"}]}], ",", "\t", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "F", "]"}], "/", 
                    RowBox[{"Re", "[", "F", "]"}]}], "]"}], "]"}], "/", 
                   "Degree"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], ">", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "<", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"-", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "F", "]"}], "/", 
                    RowBox[{"Re", "[", "F", "]"}]}], "]"}], "]"}], "/", 
                    "Degree"}], "]"}]}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "<", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], ">", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Pi", "-", 
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "F", "]"}], "/", 
                    RowBox[{"Re", "[", "F", "]"}]}], "]"}], "]"}]}], ")"}], 
                   "/", "Degree"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", "F", "]"}], "<", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"Im", "[", "F", "]"}], "<", "0"}]}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "F", "]"}], "/", 
                    RowBox[{"Re", "[", "F", "]"}]}], "]"}], "]"}], "-", 
                    "Pi"}], ")"}], "/", "Degree"}], "]"}]}]}], 
               "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]",
               "\t", 
              RowBox[{"Sow", "[", 
               RowBox[{"{", 
                RowBox[{"F", ",", "\[Phi]"}], "}"}], "]"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", "L"}], "}"}]}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "output", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Processing", " ", "units"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"units", ",", 
       RowBox[{"SF", "=", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Quantity", "[", 
            RowBox[{"#", ",", "\"\<Degrees\>\""}], "]"}], "&"}], ",", "SF", 
          ",", 
          RowBox[{"{", 
           RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Organising", " ", "structure", " ", "factors"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "Return"}], " ", "absolute", " ", "value", " ", 
       "and", " ", "phase"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"SF", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Abs", ",", "SF", ",", 
        RowBox[{"{", 
         RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"b", ".", " ", "Return"}], " ", "complex", " ", "number"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"Label", "[", "\"\<ComplexNumber\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Putting", " ", "back", " ", "extinct", " ", "reflections"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"L0", ">", "1"}], "&&", 
        RowBox[{"!", "ignoreExtinct"}]}], ",", 
       RowBox[{"SF", "=", 
        RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"zerotype", ",", "l"}], "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Thread", "[", 
           RowBox[{"hklPos", "\[Rule]", "SF"}], "]"}]}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"L0", "===", "1"}], ",", 
       RowBox[{"First", "@", "SF"}], ",", "SF"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.68235021035181*^9, {3.6823554070859623`*^9, 3.682355407653955*^9}, {
   3.682355524419012*^9, 3.682355549058449*^9}, {3.6823559134372807`*^9, 
   3.682356009697699*^9}, {3.682356055121172*^9, 3.682356070174657*^9}, {
   3.682356114759941*^9, 3.682356146109274*^9}, {3.6823561846870003`*^9, 
   3.682356185652179*^9}, {3.682357088441045*^9, 3.682357115407319*^9}, {
   3.682357217406158*^9, 3.6823572183887863`*^9}, {3.6823574922248783`*^9, 
   3.682357553533513*^9}, {3.6823576090602837`*^9, 3.6823576183235407`*^9}, 
   3.68235766925104*^9, {3.682357741160877*^9, 3.682357843894844*^9}, {
   3.682358010140523*^9, 3.6823580520101*^9}, {3.682358086130682*^9, 
   3.682358102765896*^9}, 3.6823582603329163`*^9, 3.6823583250867977`*^9, {
   3.6823583641011267`*^9, 3.682358366674511*^9}, 3.6823584135236263`*^9, {
   3.6823585146473923`*^9, 3.682358560902493*^9}, {3.682358896111889*^9, 
   3.682358919406041*^9}, {3.682359169393344*^9, 3.682359193791843*^9}, {
   3.682359621431341*^9, 3.682359650654871*^9}, {3.682359721501602*^9, 
   3.682359739977715*^9}, {3.682359770331414*^9, 3.682359801225906*^9}, {
   3.682359954534068*^9, 3.682359994741144*^9}, 3.682360035622307*^9, {
   3.682360094717492*^9, 3.682360096227025*^9}, {3.682360593992386*^9, 
   3.682360642439151*^9}, {3.682360697895648*^9, 3.682360723116581*^9}, {
   3.682360759580455*^9, 3.6823608376656218`*^9}, {3.68236087692924*^9, 
   3.682360906264741*^9}, {3.682360980088883*^9, 3.68236098204853*^9}, 
   3.682361022206366*^9, {3.68236117119483*^9, 3.68236124324862*^9}, {
   3.6823613327685347`*^9, 3.682361342998777*^9}, {3.682362037112319*^9, 
   3.6823621240535173`*^9}, {3.682362292506065*^9, 3.6823623050569687`*^9}, {
   3.6823623617369537`*^9, 3.682362430592595*^9}, {3.682362474877223*^9, 
   3.6823624930618887`*^9}, {3.682362531443944*^9, 3.682362642281513*^9}, {
   3.682362672297182*^9, 3.6823627144868517`*^9}, {3.6823628461017427`*^9, 
   3.682362858611738*^9}, {3.682363215924656*^9, 3.682363219444872*^9}, {
   3.6824119473472843`*^9, 3.682411971197215*^9}, {3.682412042218315*^9, 
   3.682412072484001*^9}, {3.6824121240286503`*^9, 3.68241212793725*^9}, {
   3.682413245227405*^9, 3.682413345524603*^9}, {3.6824133869221287`*^9, 
   3.6824134491915197`*^9}, {3.682413745889159*^9, 3.682413760903536*^9}, {
   3.682413862079846*^9, 3.682413954924138*^9}, {3.682414025061961*^9, 
   3.682414115022747*^9}, 3.682414167870982*^9, {3.6824142584617968`*^9, 
   3.6824142703546247`*^9}, {3.682414389750587*^9, 3.682414435535961*^9}, 
   3.682414480952491*^9, 3.682414574850103*^9, {3.682414605378304*^9, 
   3.6824146058413057`*^9}, {3.682428125837381*^9, 3.682428147707459*^9}, {
   3.6824282090186234`*^9, 3.6824282643929358`*^9}, {3.6824287210409727`*^9, 
   3.682428724735961*^9}, {3.6824288917113657`*^9, 3.6824289135955276`*^9}, {
   3.6824289628129463`*^9, 3.6824290142821817`*^9}, {3.682429213286439*^9, 
   3.682429263700617*^9}, {3.6824298109288588`*^9, 3.6824298165448837`*^9}, 
   3.682429903488199*^9, {3.682429948647789*^9, 3.682429951686625*^9}, {
   3.682484251361381*^9, 3.682484254055951*^9}, {3.682484339504552*^9, 
   3.682484346319045*^9}, {3.682484444142501*^9, 3.682484464726788*^9}, {
   3.682484533445196*^9, 3.6824845395306664`*^9}, {3.68248495192418*^9, 
   3.682484984994215*^9}, {3.682485034932179*^9, 3.682485039536675*^9}, {
   3.682485072738564*^9, 3.682485128607079*^9}, {3.682485162046349*^9, 
   3.682485184174527*^9}, 3.68248528949996*^9, {3.682485335322666*^9, 
   3.682485341594153*^9}, {3.682485440834176*^9, 3.68248547227719*^9}, {
   3.682485503250204*^9, 3.682485519345251*^9}, {3.68248611217078*^9, 
   3.68248612407618*^9}, {3.682486191082102*^9, 3.682486205960585*^9}, {
   3.6824868938343887`*^9, 3.682486948103623*^9}, {3.682486987606151*^9, 
   3.68248702309336*^9}, {3.682487080956669*^9, 3.6824871561629333`*^9}, {
   3.682487294730164*^9, 3.682487357158196*^9}, {3.682487389183364*^9, 
   3.682487545816203*^9}, {3.682487583067555*^9, 3.682487612025353*^9}, {
   3.682487644559989*^9, 3.6824876659599133`*^9}, {3.682487805773508*^9, 
   3.682487839939349*^9}, {3.682487870706712*^9, 3.682487979200822*^9}, {
   3.682488013752686*^9, 3.6824880161807623`*^9}, {3.682488270701757*^9, 
   3.6824883620619173`*^9}, {3.6824883990164633`*^9, 3.682488454205749*^9}, {
   3.6824885540999527`*^9, 3.682488565716568*^9}, 3.6824886385539417`*^9, {
   3.68248877476259*^9, 3.68248884726932*^9}, {3.6824889603470716`*^9, 
   3.682489112047206*^9}, {3.682489497857304*^9, 3.682489502943169*^9}, {
   3.682489644092379*^9, 3.682489705833146*^9}, {3.682489832316371*^9, 
   3.682489904553688*^9}, {3.682489959763069*^9, 3.682489961114745*^9}, {
   3.682490364250053*^9, 3.682490368303422*^9}, {3.682492269390111*^9, 
   3.68249227029191*^9}, 3.682492350477738*^9, {3.682492417450835*^9, 
   3.6824924185204363`*^9}, {3.682492455264069*^9, 3.682492470994844*^9}, {
   3.682497385475168*^9, 3.682497405552649*^9}, {3.6824974690732803`*^9, 
   3.6824974699685583`*^9}, {3.682497582542081*^9, 3.682497607428425*^9}, {
   3.6824977498992643`*^9, 3.682497824540435*^9}, {3.682498611628029*^9, 
   3.682498653894286*^9}, {3.682498694599101*^9, 3.682498904660245*^9}, {
   3.68249895176313*^9, 3.6824989619051437`*^9}, {3.682498998603953*^9, 
   3.682499110847574*^9}, {3.682499146079774*^9, 3.6824995046786633`*^9}, {
   3.682499568669202*^9, 3.6824996599651814`*^9}, {3.6825007687644787`*^9, 
   3.682500769314032*^9}, {3.682500887551874*^9, 3.68250096329532*^9}, {
   3.68267724942268*^9, 3.6826772714823112`*^9}, {3.682677483806719*^9, 
   3.682677508083475*^9}, {3.682677614132016*^9, 3.68267766183434*^9}, {
   3.6826777652997847`*^9, 3.6826778130495443`*^9}, {3.682677854747525*^9, 
   3.682677919196094*^9}, {3.682678009905512*^9, 3.68267802035*^9}, 
   3.682681815204053*^9, 3.682742937261579*^9, {3.683603474603673*^9, 
   3.683603498242755*^9}, {3.6836035321491623`*^9, 3.683603532584096*^9}, {
   3.683603923115225*^9, 3.6836039487002163`*^9}, {3.683604007305277*^9, 
   3.683604046313713*^9}, {3.6840603536190157`*^9, 3.684060353915416*^9}, {
   3.6840604628970165`*^9, 3.6840604631154165`*^9}, 3.684126669883862*^9, {
   3.684126842291597*^9, 3.684126927064343*^9}, {3.684129595742449*^9, 
   3.684129617686654*^9}, {3.684129942198956*^9, 3.684129952360091*^9}, {
   3.684130057402573*^9, 3.684130074934708*^9}, {3.684132290063151*^9, 
   3.68413229155823*^9}, {3.6841323224690523`*^9, 3.6841323325558233`*^9}, {
   3.684132377119636*^9, 3.684132461548952*^9}, {3.684132549727417*^9, 
   3.684132556509632*^9}, {3.6841352955964603`*^9, 3.684135296501561*^9}, {
   3.684135427610285*^9, 3.6841354644426413`*^9}, {3.684135499863474*^9, 
   3.6841355772664137`*^9}, {3.684135631694504*^9, 3.684135776024764*^9}, {
   3.6841358249719543`*^9, 3.684135864110319*^9}, {3.684136093200944*^9, 
   3.6841361942922707`*^9}, 3.684138667592083*^9, {3.6842127906103487`*^9, 
   3.684212809772808*^9}, {3.684233496915926*^9, 3.684233501578506*^9}, {
   3.684233577438147*^9, 3.684233581499976*^9}, {3.6842336434194613`*^9, 
   3.684233723759993*^9}, 3.684235428108548*^9, {3.68449189948267*^9, 
   3.684491927666718*^9}, {3.684492216996893*^9, 3.6844922245206547`*^9}, {
   3.6844923574289637`*^9, 3.684492357507423*^9}, {3.685083388121538*^9, 
   3.6850833971122723`*^9}, {3.685245875512651*^9, 3.685245891304591*^9}, {
   3.685268980744462*^9, 3.6852689848592577`*^9}, {3.685269200031828*^9, 
   3.685269235615137*^9}, {3.685269330744046*^9, 3.685269340959529*^9}, {
   3.685269540547988*^9, 3.6852695467179737`*^9}, {3.6852695917983227`*^9, 
   3.685269860087473*^9}, {3.6852699071063232`*^9, 3.685269919626947*^9}, {
   3.6852700164430637`*^9, 3.6852700176511097`*^9}, {3.685270069705021*^9, 
   3.6852701123512917`*^9}, {3.685270274799631*^9, 3.685270278303849*^9}, {
   3.685270524895504*^9, 3.685270525113432*^9}, {3.685271210000054*^9, 
   3.685271213479288*^9}, {3.685271253270619*^9, 3.685271259453857*^9}, {
   3.685271320474208*^9, 3.685271330238566*^9}, {3.685271494959454*^9, 
   3.685271508193318*^9}, {3.6854192725223494`*^9, 3.6854193120892353`*^9}, {
   3.685419436607959*^9, 3.685419460022567*^9}, {3.6854195292524*^9, 
   3.685419535365223*^9}, {3.6856997810572433`*^9, 3.685699801401469*^9}, {
   3.685699852782089*^9, 3.68569986979154*^9}, {3.685699939741787*^9, 
   3.685699974508688*^9}, {3.685700022704438*^9, 3.6857000279545*^9}, {
   3.685700079266445*^9, 3.6857000793941193`*^9}, {3.685700490090118*^9, 
   3.685700522976573*^9}, {3.685700557380581*^9, 3.685700586180781*^9}, 
   3.685700790084831*^9, 3.685765929542613*^9, {3.6865358520581503`*^9, 
   3.686535924995319*^9}, {3.686535956470832*^9, 3.686535958044951*^9}, {
   3.686536001142067*^9, 3.686536008557165*^9}, {3.68653605329885*^9, 
   3.686536114697093*^9}, {3.6865361857271757`*^9, 3.6865362091598787`*^9}, {
   3.6865362441294622`*^9, 3.6865363020134687`*^9}, {3.686536356496814*^9, 
   3.686536395066627*^9}, {3.686536496974524*^9, 3.686536497870997*^9}, {
   3.6865365296306458`*^9, 3.686536543648244*^9}, {3.686536581297986*^9, 
   3.686536707378796*^9}, {3.686536787046989*^9, 3.686536944309525*^9}, {
   3.686536999230639*^9, 3.686537092649219*^9}, {3.686537350092806*^9, 
   3.686537385060277*^9}, {3.686537447065879*^9, 3.6865374674396753`*^9}, {
   3.686537602045158*^9, 3.686537811778129*^9}, {3.686538009664114*^9, 
   3.6865380111820374`*^9}, {3.686639039775693*^9, 3.686639060647485*^9}, {
   3.6866391382128267`*^9, 3.686639162265592*^9}, {3.6866392097794647`*^9, 
   3.68663921588174*^9}, {3.686639249133515*^9, 3.686639262259482*^9}, {
   3.6866393479134808`*^9, 3.6866393492506037`*^9}, {3.686639385739629*^9, 
   3.686639569572411*^9}, {3.6866396649341087`*^9, 3.686639708563305*^9}, {
   3.686639755978696*^9, 3.686639816039085*^9}, {3.686639850559414*^9, 
   3.686640024698845*^9}, {3.6866400993523912`*^9, 3.6866401602993402`*^9}, 
   3.686640288912417*^9, {3.686640398471506*^9, 3.686640616303235*^9}, {
   3.686640702384297*^9, 3.6866407141563168`*^9}, {3.6866414624930353`*^9, 
   3.686641464325823*^9}, {3.6866415662892857`*^9, 3.6866416851473*^9}, {
   3.686641795071535*^9, 3.686641829559442*^9}, {3.6866418730620737`*^9, 
   3.686641878091366*^9}, {3.686643455863309*^9, 3.686643466892089*^9}, {
   3.686643521106599*^9, 3.686643521547914*^9}, {3.6866440864294024`*^9, 
   3.6866441007596893`*^9}, 3.686645469125093*^9, {3.686645594918067*^9, 
   3.686645622694941*^9}, {3.6866463859427032`*^9, 3.6866465064197474`*^9}, {
   3.6866466900184107`*^9, 3.68664670832253*^9}, {3.68664673934373*^9, 
   3.6866470398395348`*^9}, {3.686647116437593*^9, 3.686647153211206*^9}, {
   3.686647195914625*^9, 3.686647309263627*^9}, 3.686647391456807*^9, {
   3.686647441847991*^9, 3.6866474744817743`*^9}, {3.686647510035316*^9, 
   3.686647512242793*^9}, {3.6866475954109488`*^9, 3.686647601952989*^9}, {
   3.686647675718945*^9, 3.6866477037105427`*^9}, {3.686647784299597*^9, 
   3.6866478112634907`*^9}, {3.686648394432047*^9, 3.6866484666379557`*^9}, {
   3.6866534327598658`*^9, 3.6866534399969673`*^9}, {3.686654085150263*^9, 
   3.686654215720572*^9}, {3.6866542960529213`*^9, 3.686654304123146*^9}, {
   3.68665448727005*^9, 3.686654501486758*^9}, {3.686654534112*^9, 
   3.686654570609671*^9}, {3.68665463546408*^9, 3.686654690258994*^9}, {
   3.687072762240677*^9, 3.6870727663856573`*^9}, {3.687072805954468*^9, 
   3.687072817021658*^9}, {3.687072847586732*^9, 3.6870728556852093`*^9}, {
   3.687073510113536*^9, 3.687073516420169*^9}, 3.687073558908938*^9, {
   3.690025779646481*^9, 3.690025802098175*^9}, {3.690878676179409*^9, 
   3.690878760347547*^9}, {3.690879030188471*^9, 3.690879056259705*^9}, {
   3.6908790878566303`*^9, 3.690879090410026*^9}, {3.690898596040187*^9, 
   3.690898626210072*^9}, {3.690900659333523*^9, 3.6909006864432783`*^9}, {
   3.6909008783741493`*^9, 3.6909009191407423`*^9}, {3.6909009572933493`*^9, 
   3.6909009582506323`*^9}, {3.690901005339761*^9, 3.690901216192507*^9}, {
   3.690974764117507*^9, 3.690974788841832*^9}, {3.690975370540357*^9, 
   3.6909753934428263`*^9}, 3.6909754366587133`*^9, {3.69097546880268*^9, 
   3.690975503534981*^9}, {3.6909777141486387`*^9, 3.690977818880795*^9}, {
   3.691126706363833*^9, 3.691126710172639*^9}, 3.6911268598638287`*^9, 
   3.691127163939904*^9, {3.6911277713007917`*^9, 3.6911277772595873`*^9}, {
   3.6911280137962523`*^9, 3.69112801626263*^9}, {3.69112809308037*^9, 
   3.691128147587358*^9}, {3.691144012452911*^9, 3.6911440460355*^9}, {
   3.6911441826017036`*^9, 3.691144195487897*^9}, 3.691144319648478*^9, {
   3.691144650403228*^9, 3.6911446554486*^9}, {3.6911446937913847`*^9, 
   3.691144731983123*^9}, {3.691144793473301*^9, 3.6911447948588867`*^9}, {
   3.69114522436063*^9, 3.691145280419627*^9}, {3.691147570557919*^9, 
   3.6911475707324657`*^9}, {3.691147623558091*^9, 3.691147639037039*^9}, {
   3.691147892444419*^9, 3.691147914367961*^9}, {3.6911479535020123`*^9, 
   3.6911479572053957`*^9}, {3.691155598871255*^9, 3.691155701315138*^9}, {
   3.691157634096757*^9, 3.691157639169035*^9}, {3.691159230710688*^9, 
   3.69115925016014*^9}, {3.6911593915751057`*^9, 3.691159422340479*^9}, {
   3.691159458909935*^9, 3.691159465795944*^9}, {3.691159530402904*^9, 
   3.691159544385497*^9}, {3.691159614584931*^9, 3.691159640968917*^9}, {
   3.691159675032302*^9, 3.6911596983581333`*^9}, {3.691159728646122*^9, 
   3.6911597467513857`*^9}, {3.691159822355818*^9, 3.691159823994444*^9}, 
   3.691159862908317*^9, {3.6911599138036137`*^9, 3.691159919672388*^9}, {
   3.691160353263249*^9, 3.691160375614052*^9}, {3.691160650048457*^9, 
   3.691160678581853*^9}, 3.691165154333824*^9, {3.691165203018216*^9, 
   3.6911653008314257`*^9}, {3.6911655589618797`*^9, 3.691165595582507*^9}, {
   3.691165631520339*^9, 3.6911657492211*^9}, 3.691165787587769*^9, {
   3.691165842434667*^9, 3.6911658431757174`*^9}, {3.691165875609087*^9, 
   3.691165875752102*^9}, {3.706329878752262*^9, 3.706329882460821*^9}, {
   3.706329931666987*^9, 3.70632997324356*^9}, {3.712555006792688*^9, 
   3.712555127255632*^9}, {3.7125576195745*^9, 3.712557630128243*^9}, {
   3.712557758847629*^9, 3.712557759148643*^9}, {3.7125578301475563`*^9, 
   3.712557832388919*^9}, {3.7125578638881493`*^9, 3.712557864068542*^9}, {
   3.712558110447866*^9, 3.712558118436214*^9}, {3.712558826611998*^9, 
   3.712558829610416*^9}, {3.712559993610076*^9, 3.712560018236985*^9}, {
   3.712560082025857*^9, 3.712560195326495*^9}, {3.714462684262381*^9, 
   3.714462716756855*^9}, {3.714710013035928*^9, 3.714710013245159*^9}, 
   3.714710203499085*^9, {3.714711456472847*^9, 3.714711459525902*^9}, {
   3.714711603633684*^9, 3.7147117131108713`*^9}, {3.7147118349390917`*^9, 
   3.7147118443756638`*^9}, {3.7147119053630857`*^9, 3.714711906857216*^9}, {
   3.717740896716333*^9, 3.717740919715315*^9}, 3.7179538850177402`*^9, {
   3.718527677646764*^9, 3.718527691020012*^9}, {3.718527785734352*^9, 
   3.718527871985846*^9}, {3.718527926536118*^9, 3.718527969630934*^9}, 
   3.718531173423358*^9, {3.718531232841338*^9, 3.718531256847206*^9}, {
   3.718533847618675*^9, 3.718533913808114*^9}, {3.718543512776991*^9, 
   3.718543521720064*^9}, {3.7185436324992123`*^9, 3.718543790156437*^9}, {
   3.718543821237425*^9, 3.718543975277853*^9}, {3.7185440221196127`*^9, 
   3.718544051871626*^9}, {3.718544109595942*^9, 3.718544203377638*^9}, {
   3.718544363461361*^9, 3.7185444688688717`*^9}, {3.7185446350043*^9, 
   3.7185447209089746`*^9}, {3.718624865299603*^9, 3.718624870542665*^9}, {
   3.718625967770801*^9, 3.718625978288886*^9}, {3.718626187395894*^9, 
   3.718626202667638*^9}, {3.7186300004551907`*^9, 3.718630046690415*^9}, {
   3.718633919196464*^9, 3.7186339551354723`*^9}, {3.7186340043345833`*^9, 
   3.718634106646303*^9}, {3.718634174587448*^9, 3.718634188715056*^9}, {
   3.718634224096203*^9, 3.718634358249167*^9}, {3.7186344156562243`*^9, 
   3.718634528525507*^9}, {3.718634615958276*^9, 3.71863466855867*^9}, {
   3.718634708217246*^9, 3.718634718184246*^9}, 3.718634796174251*^9, {
   3.718634831746257*^9, 3.7186348409138527`*^9}, {3.718635054467161*^9, 
   3.7186351502490177`*^9}, {3.718635333933066*^9, 3.718635468967456*^9}, {
   3.71863559690244*^9, 3.718635611456811*^9}, {3.718635861273704*^9, 
   3.7186359397615757`*^9}, {3.718636007553063*^9, 3.718636111943492*^9}, {
   3.718636143404682*^9, 3.718636148373069*^9}, {3.718636179277677*^9, 
   3.7186361804361277`*^9}, {3.718636273382629*^9, 3.718636278006249*^9}, {
   3.7186367395660257`*^9, 3.71863674534039*^9}, 3.718636784455512*^9, {
   3.7186368158684483`*^9, 3.718636844927195*^9}, {3.718636900365027*^9, 
   3.718636900634088*^9}, {3.718637483624073*^9, 3.718637515773211*^9}, {
   3.7186375867350693`*^9, 3.7186376848994503`*^9}, {3.7186377716613197`*^9, 
   3.718637834662388*^9}, {3.718637868699911*^9, 3.71863787807069*^9}, {
   3.718637909685691*^9, 3.7186379118664703`*^9}, {3.7186379825622263`*^9, 
   3.71863798441439*^9}, {3.718638501160863*^9, 3.718638582878704*^9}, {
   3.718638729150199*^9, 3.718638734334074*^9}, {3.7186387952057257`*^9, 
   3.718638849484035*^9}, {3.71863888679734*^9, 3.718638901885063*^9}, {
   3.7186393140579863`*^9, 3.718639337008689*^9}, {3.718639631689644*^9, 
   3.718639654798298*^9}, {3.718639901229538*^9, 3.718639935956284*^9}, {
   3.718640442276641*^9, 3.718640470155349*^9}, {3.7186405729607487`*^9, 
   3.718640573481882*^9}, {3.718640619781396*^9, 3.718640657069721*^9}, {
   3.718640752005581*^9, 3.718640755744193*^9}, {3.718640794318283*^9, 
   3.7186408336464787`*^9}, {3.7186409779009237`*^9, 
   3.7186410858105917`*^9}, {3.718641195390216*^9, 3.7186413868269377`*^9}, {
   3.7186414362032557`*^9, 3.718641455242989*^9}, {3.718641624918593*^9, 
   3.718641752821053*^9}, 3.718642019375333*^9, {3.718642085493113*^9, 
   3.718642117001196*^9}, {3.7186421540983353`*^9, 3.718642167577339*^9}, {
   3.718642255504282*^9, 3.71864225765915*^9}, {3.71864230334627*^9, 
   3.718642304834527*^9}, {3.718642356334309*^9, 3.718642403037221*^9}, 
   3.718642485747217*^9, {3.718643273001608*^9, 3.718643292257222*^9}, {
   3.718643338694646*^9, 3.718643340777215*^9}, 3.7186434167582693`*^9, 
   3.71864348557904*^9, {3.718643563362646*^9, 3.718643617814856*^9}, {
   3.718643788342004*^9, 3.718643887699991*^9}, 3.7186439199389467`*^9, {
   3.718643950505294*^9, 3.718644046400427*^9}, {3.718644817480879*^9, 
   3.718644836727697*^9}, 3.7186448928146057`*^9, {3.718644934389924*^9, 
   3.718644971436803*^9}, {3.718645012707621*^9, 3.718645051273069*^9}, {
   3.71864547989636*^9, 3.7186455993205137`*^9}, {3.718645642176772*^9, 
   3.718645642436988*^9}, {3.718650537705412*^9, 3.718650558713146*^9}, {
   3.718650764662345*^9, 3.7186507691931047`*^9}, {3.718650869075322*^9, 
   3.718650906249342*^9}, {3.7186509419131517`*^9, 3.7186511356198063`*^9}, {
   3.7186521820238943`*^9, 3.718652182806731*^9}, {3.7186536873155746`*^9, 
   3.7186537733243523`*^9}, {3.718654210672594*^9, 3.718654219091264*^9}, {
   3.7186545421532507`*^9, 3.718654594263721*^9}, {3.718654635306229*^9, 
   3.718654743331316*^9}, {3.718654792291512*^9, 3.7186548537632027`*^9}, {
   3.718654918842803*^9, 3.71865492006437*^9}, {3.718654994967835*^9, 
   3.718655076720158*^9}, {3.7186551916595*^9, 3.718655230122362*^9}, {
   3.718655267657659*^9, 3.718655295935725*^9}, {3.718696693742841*^9, 
   3.7186966962991734`*^9}, {3.718696887994276*^9, 3.718696888123917*^9}, 
   3.718697227272997*^9, {3.718697432605813*^9, 3.7186974356561937`*^9}, {
   3.718729172707295*^9, 3.718729173264016*^9}, 3.718980534558011*^9, 
   3.719063106966579*^9, {3.719083639537867*^9, 3.719083652615138*^9}, {
   3.719085045623962*^9, 3.719085054454421*^9}, {3.7198363110943737`*^9, 
   3.71983632499797*^9}, {3.7205133135044117`*^9, 3.7205133305445433`*^9}, {
   3.721029191915366*^9, 3.721029210654334*^9}, {3.724145596678763*^9, 
   3.724145665278071*^9}, {3.724145716052232*^9, 3.724145754560947*^9}, {
   3.7241457987595787`*^9, 3.724145808878604*^9}, {3.724146029544669*^9, 
   3.724146043385973*^9}, 3.724146177784893*^9, {3.7241462470878887`*^9, 
   3.7241462484617233`*^9}, {3.724149956284987*^9, 3.724150126674526*^9}, {
   3.724150241948049*^9, 3.724150251788508*^9}, {3.724150316124902*^9, 
   3.724150372508952*^9}, {3.7241504030697803`*^9, 3.724150422705534*^9}, {
   3.724150454761139*^9, 3.7241505509534693`*^9}, {3.724561396305125*^9, 
   3.7245614074142933`*^9}, {3.724561462950499*^9, 3.7245614685083637`*^9}, {
   3.724564716359003*^9, 3.7245647185257883`*^9}, {3.724564821737604*^9, 
   3.7245648349609003`*^9}, {3.724565007327551*^9, 3.724565048525113*^9}, {
   3.724565153339657*^9, 3.724565234033993*^9}, {3.724565285591118*^9, 
   3.724565291733634*^9}, {3.7245661698967247`*^9, 3.724566172491467*^9}, 
   3.724566213869773*^9, {3.724566285155117*^9, 3.7245662852866287`*^9}, 
   3.7245667371712027`*^9, {3.724566829065361*^9, 3.72456684581383*^9}, {
   3.724567754897757*^9, 3.724567755455063*^9}, {3.7246599646753674`*^9, 
   3.724659980266561*^9}, 3.7246602067243958`*^9, {3.724660380657509*^9, 
   3.724660380831779*^9}, {3.724660529975087*^9, 3.724660532246895*^9}, {
   3.7246606924748917`*^9, 3.724660692696698*^9}, {3.72466074515444*^9, 
   3.7246608507133493`*^9}, {3.724662172741002*^9, 3.7246621826189013`*^9}, {
   3.724664927225902*^9, 3.724664927355006*^9}, {3.724666740678011*^9, 
   3.7246667428391943`*^9}, {3.724666792196143*^9, 3.724666846319498*^9}, {
   3.724666925596292*^9, 3.7246669792437363`*^9}, {3.724667056539875*^9, 
   3.7246671524311733`*^9}, {3.7246672252443247`*^9, 3.724667304673367*^9}, {
   3.724667386650441*^9, 3.724667442348775*^9}, {3.724667476202106*^9, 
   3.724667476376495*^9}, {3.724667553628648*^9, 3.7246676140870657`*^9}, {
   3.724667648123928*^9, 3.724667658400072*^9}, {3.7246676952833548`*^9, 
   3.7246677045603952`*^9}, {3.724667777470542*^9, 3.7246677990469913`*^9}, {
   3.72466810007837*^9, 3.724668111950631*^9}, {3.7251737272906017`*^9, 
   3.7251737544247017`*^9}, {3.725173803673904*^9, 3.725173842893956*^9}, {
   3.7254484797431593`*^9, 3.725448493902485*^9}, {3.72544865519354*^9, 
   3.725448669537215*^9}, {3.725448729379508*^9, 3.72544875027493*^9}, {
   3.725449385771718*^9, 3.725449402761017*^9}, {3.7256153916179028`*^9, 
   3.725615415821506*^9}, {3.725615793658289*^9, 3.725615803225354*^9}, {
   3.725615924191431*^9, 3.725615928959609*^9}, {3.725616111095373*^9, 
   3.725616180249893*^9}, {3.725616238939508*^9, 3.72561624355674*^9}, {
   3.725616597859741*^9, 3.7256166302901917`*^9}, {3.725616698082979*^9, 
   3.725616720264295*^9}, {3.72561675735168*^9, 3.725616788826537*^9}, {
   3.725617156235186*^9, 3.725617212844368*^9}, {3.7256172509664288`*^9, 
   3.725617275440839*^9}, {3.725617343412187*^9, 3.7256174043866463`*^9}, {
   3.726470343029024*^9, 3.726470354794454*^9}, {3.726488984815798*^9, 
   3.7264889956705837`*^9}, 3.726505019837242*^9, {3.726505073088929*^9, 
   3.726505073253257*^9}, 3.726561564710672*^9, {3.726859417371212*^9, 
   3.726859418211994*^9}, {3.7268594505225*^9, 3.726859456882266*^9}, {
   3.726898188060453*^9, 3.726898191349244*^9}, {3.7268982742787848`*^9, 
   3.726898274512164*^9}, {3.726906121043355*^9, 3.726906164203*^9}, {
   3.726906245933783*^9, 3.726906253890044*^9}, {3.7269062845618477`*^9, 
   3.726906287749412*^9}, {3.726906384258444*^9, 3.726906384407981*^9}, {
   3.7269064225643873`*^9, 3.726906479191285*^9}, {3.726906511289557*^9, 
   3.726906573390658*^9}, {3.726906641720665*^9, 3.7269066502617292`*^9}, {
   3.726907060816388*^9, 3.726907060935128*^9}, {3.726907170176078*^9, 
   3.726907175143551*^9}, {3.726907233159137*^9, 3.72690729131479*^9}, {
   3.726907414626561*^9, 3.726907490687174*^9}, 3.726907553753632*^9, {
   3.726907595838131*^9, 3.7269077819136543`*^9}, {3.726907856045974*^9, 
   3.726907887744969*^9}, {3.726908115416163*^9, 3.726908159121975*^9}, {
   3.72690821376005*^9, 3.7269082286738234`*^9}, {3.726908379256392*^9, 
   3.726908420098743*^9}, {3.726908458536557*^9, 3.726908490530883*^9}, {
   3.726908640594524*^9, 3.726908641942788*^9}, {3.726908679072648*^9, 
   3.726908700410343*^9}, {3.726908834480789*^9, 3.726908855775869*^9}, {
   3.726908990038205*^9, 3.726909009666183*^9}, {3.726909280590005*^9, 
   3.726909456449881*^9}, {3.726909497736565*^9, 3.7269095024249363`*^9}, {
   3.726909704084219*^9, 3.726909722436139*^9}, {3.7269100986810093`*^9, 
   3.726910098953269*^9}, {3.7269102807815933`*^9, 3.726910282602582*^9}, {
   3.7269103203256207`*^9, 3.726910320447009*^9}, {3.726910849369268*^9, 
   3.726910852647759*^9}, {3.726910911233726*^9, 3.726910921874176*^9}, 
   3.726911041337955*^9, {3.7269111967711287`*^9, 3.726911214304221*^9}, {
   3.727158576396359*^9, 3.7271585773463593`*^9}, {3.7271586690500107`*^9, 
   3.727158705202383*^9}, 3.7271587527614393`*^9, {3.727158786160768*^9, 
   3.727158786358838*^9}, {3.7271588173530893`*^9, 3.727158817558272*^9}, {
   3.7271591290315933`*^9, 3.7271591527508993`*^9}, {3.727159658108057*^9, 
   3.727159665553772*^9}, {3.727159724290596*^9, 3.727159727241869*^9}, {
   3.727159818392055*^9, 3.72715982167978*^9}, {3.727159882888464*^9, 
   3.727160002094442*^9}, {3.727160217166821*^9, 3.727160226301404*^9}, {
   3.7271629721608343`*^9, 3.72716297458897*^9}, {3.727163088029752*^9, 
   3.7271631820820713`*^9}, {3.727163282161408*^9, 3.727163305401881*^9}, {
   3.727163384932481*^9, 3.7271633954768343`*^9}, {3.727189928903273*^9, 
   3.727189932748803*^9}, {3.7271899868128433`*^9, 3.7271900150142393`*^9}, 
   3.7271900520660963`*^9, 3.7272440209161787`*^9, 3.7276752890194387`*^9, 
   3.727676624853285*^9, 3.727676784261179*^9, 3.7300971411738863`*^9, {
   3.73036627987351*^9, 3.730366282672369*^9}, {3.730366412962906*^9, 
   3.730366442510378*^9}, 3.730366508313837*^9, 3.730366582786269*^9, 
   3.730366625930894*^9, {3.730367787307919*^9, 3.730367811199376*^9}, {
   3.730367842739057*^9, 3.730367845788413*^9}, 3.730367896970634*^9, 
   3.730368028710956*^9, 3.730368343205833*^9, 3.730368388949328*^9, {
   3.730368622748129*^9, 3.730368769962433*^9}, {3.730368804494926*^9, 
   3.7303688066872063`*^9}, {3.730368859719089*^9, 3.730368861259066*^9}, {
   3.730368892630349*^9, 3.730368892874979*^9}, {3.7303746119665833`*^9, 
   3.730374612060484*^9}, {3.730374663683868*^9, 3.730374729814693*^9}, {
   3.730374782631168*^9, 3.73037478495109*^9}, {3.730374853841782*^9, 
   3.730374854789981*^9}, {3.730374917246572*^9, 3.730374924781241*^9}, {
   3.730374958522914*^9, 3.73037498874479*^9}, {3.730375027846882*^9, 
   3.7303750428413067`*^9}, {3.730375942014379*^9, 3.730376019987307*^9}, {
   3.7303760500387287`*^9, 3.730376050980377*^9}, {3.730376084988002*^9, 
   3.730376099444498*^9}, {3.73037617781859*^9, 3.730376196168026*^9}, {
   3.73037623941689*^9, 3.7303763277846947`*^9}, 3.730376375352146*^9, {
   3.730376448387857*^9, 3.730376491667026*^9}, {3.730376530931423*^9, 
   3.730376566801742*^9}, {3.730376685878744*^9, 3.730376718608508*^9}, {
   3.7303774254052143`*^9, 3.730377425923779*^9}, {3.7303872514850407`*^9, 
   3.730387275452536*^9}, {3.730398135670518*^9, 3.730398153697288*^9}, {
   3.730544556973566*^9, 3.730544565333839*^9}, {3.7331706929503317`*^9, 
   3.7331706965380173`*^9}, {3.735032469440843*^9, 3.735032484729834*^9}, {
   3.735032517859907*^9, 3.735032601394354*^9}, {3.7350326346892223`*^9, 
   3.735032635034664*^9}, {3.735033496785925*^9, 3.7350335281258993`*^9}, {
   3.7350335603081903`*^9, 3.735033663437683*^9}, {3.735033904013899*^9, 
   3.7350339075891523`*^9}, {3.735033984637506*^9, 3.735034093197612*^9}, {
   3.73503413980792*^9, 3.735034140092969*^9}, {3.737806352728956*^9, 
   3.737806367811644*^9}, {3.737806433894595*^9, 3.737806435967967*^9}, {
   3.737806476532917*^9, 3.737806574063101*^9}, {3.7378067551073437`*^9, 
   3.737806828981542*^9}, 3.737806878644868*^9, {3.737968444470468*^9, 
   3.737968468464669*^9}, 3.737968545067499*^9, 3.737968575390418*^9, {
   3.739029626888796*^9, 3.739029633847821*^9}, {3.739030429186804*^9, 
   3.739030431008545*^9}, {3.7391695345754766`*^9, 3.739169536334717*^9}, {
   3.739169727221682*^9, 3.739169737715694*^9}, {3.7391698678374557`*^9, 
   3.739169951171378*^9}, {3.7391702356395273`*^9, 3.739170236908888*^9}, 
   3.739170291692564*^9, {3.739184573008953*^9, 3.739184596252761*^9}, {
   3.739187730290718*^9, 3.7391877776088867`*^9}, {3.73921225861617*^9, 
   3.739212281452911*^9}, {3.7392123593828087`*^9, 3.7392124850476933`*^9}, 
   3.7392125327555513`*^9, {3.739212659381495*^9, 3.739212661404315*^9}, 
   3.7392128537150297`*^9, {3.7438658514596167`*^9, 3.743865851515725*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[207]:=",ExpressionUUID->"3a24910f-7410-4996-b0aa-6fcc2a917cee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[208]:=",ExpressionUUID->"267d530b-fa63-4715-bac0-20bd8fc18927"]
}, Closed]],

Cell[CellGroupData[{

Cell["StructureFactorTable", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.6681055844957*^9, {3.66810585066947*^9, 3.668105858356221*^9}, 
   3.682827196585244*^9, 
   3.6844879863598137`*^9},ExpressionUUID->"ea62a536-4bde-4c29-9d2e-\
dcb6e7949a4c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[209]:=",ExpressionUUID->"e1b7b95b-619a-4c38-a408-f937413b5154"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StructureFactorTable", "::", "invcustom"}], "=", 
   "\"\<Invalid setting for the \[LeftGuillemet]CustomReflections\
\[RightGuillemet] option.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StructureFactorTable", "::", "sort"}], "=", 
    "\"\<Invalid \[LeftGuillemet]Sort\[RightGuillemet] option.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StructureFactorTable", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "DarwinWidth", " ", "and", " ", "ExtinctionLength", " ", "options"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "\"\<\[Pi]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"StructureFactor", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Threshold\>\"", "\[Rule]", 
      RowBox[{"Power", "[", 
       RowBox[{"10.", ",", 
        RowBox[{"-", "6"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"ReflectionList", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SplitEquivalent\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<CustomReflections\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ReflectionListKeep\>\"", "\[Rule]", "50"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"StructureFactorTable", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Keep\>\"", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Sort\>\"", "\[Rule]", 
      RowBox[{"-", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<TitleStyle\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Baskerville\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "15"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SubtitleStyle\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "13"}], ",", "Gray"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<NumberStyle\>\"", "\[Rule]", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Background", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "None", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"None", ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "LightGray"}], "}"}]}], "}"}]}], "}"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Dividers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"None", ",", 
          RowBox[{"{", "True", "}"}], ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"None", ",", "None", ",", "True"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.668105730347047*^9, {3.6681057635034733`*^9, 
   3.668105770743743*^9}, {3.668105863188552*^9, 3.6681058655778723`*^9}, {
   3.668194174710959*^9, 3.668194200997211*^9}, {3.679749057336968*^9, 
   3.679749065727788*^9}, {3.6797491392317333`*^9, 3.679749188325144*^9}, {
   3.679749469999255*^9, 3.679749477094261*^9}, {3.679752707933913*^9, 
   3.679752720990613*^9}, {3.679755885846201*^9, 3.679755887076858*^9}, {
   3.6797559482689734`*^9, 3.679755950347142*^9}, {3.681633881405313*^9, 
   3.681633882428932*^9}, {3.681633921173172*^9, 3.681634041501145*^9}, {
   3.681634191462041*^9, 3.681634194092729*^9}, {3.681634316204688*^9, 
   3.6816343331267242`*^9}, {3.681634485786175*^9, 3.681634488746072*^9}, {
   3.685266410723361*^9, 3.685266411087372*^9}, {3.685419621265628*^9, 
   3.685419621340851*^9}, {3.68542135881497*^9, 3.68542136123435*^9}, {
   3.685421972498349*^9, 3.685421973457191*^9}, {3.6854220084304543`*^9, 
   3.685422008728126*^9}, {3.6857080176285677`*^9, 3.685708046018064*^9}, {
   3.685777331857526*^9, 3.685777354965396*^9}, {3.685779053854518*^9, 
   3.68577905613339*^9}, {3.685779091629904*^9, 3.685779103410666*^9}, {
   3.685779834029439*^9, 3.685779834082477*^9}, {3.686534688749203*^9, 
   3.6865346889520035`*^9}, {3.7303848395375853`*^9, 
   3.7303848578650017`*^9}, {3.7303852705109243`*^9, 3.730385288030526*^9}, 
   3.730385333695622*^9, {3.730385382941999*^9, 3.730385452826951*^9}, {
   3.7303855440435553`*^9, 3.730385550850548*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"bd7a5cb1-6f2f-4050-bb92-ccf140ec9653"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[213]:=",ExpressionUUID->"f42d2041-a5a2-47f6-a1ed-36f8a96cd18b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructureFactorTable", "[", "\[IndentingNewLine]", 
   RowBox[{"crystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"lambda", ":", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "#", "]"}], "||", 
         RowBox[{"QuantityQ", "[", "#", "]"}]}], "&"}], ")"}]}], ":", 
     RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
    "condition___Condition", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "StructureFactorTable"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\[Lambda]", ",", "hkl", ",", "H", ",", "sl", ",", "bragg", ",", 
      "\[IndentingNewLine]", "column1", ",", "column2", ",", "column3", ",", 
      "column4", ",", "column5", ",", "column6", ",", "\[IndentingNewLine]", 
      "V", ",", "\[IndentingNewLine]", "zeros", ",", "\[IndentingNewLine]", 
      "R", ",", "\[Theta]", ",", "Fh", ",", "FhBar", ",", "\[CapitalLambda]o",
       ",", "\[Delta]os", ",", "\[IndentingNewLine]", "temp", ",", "temp1", 
      ",", "temp2", ",", "temp3", ",", "temp4", ",", "temp5", ",", "temp6", 
      ",", "\[IndentingNewLine]", "sort", ",", "keep", ",", "polarisation", 
      ",", "threshold"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Preparations", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Checking", " ", "wavelength"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"crystal", ",", "lambda", ",", "\"\<ProcessWavelength\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "list", " ", "of", " ", "reflections"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"hkl", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"ReflectionList", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
         "crystal", ",", "\[Lambda]", ",", "condition", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<SplitEquivalent\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<SplitEquivalent\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<CustomReflections\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<CustomReflections\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<Keep\>\"", "\[Rule]", 
           RowBox[{
           "OptionValue", "[", "\"\<ReflectionListKeep\>\"", "]"}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"H", "=", 
      RowBox[{"Chop", "@", 
       RowBox[{"N", "@", 
        RowBox[{"Inverse", "@", 
         RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Using", " ", "inner", " ", "product", " ", "and", " ", 
       RowBox[{"Bragg", "'"}], "s", " ", "law"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"sl", "[", "h_", "]"}], ":=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"h", ".", "H", ".", "h"}], "]"}], "/", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"bragg", "[", "h_", "]"}], ":=", 
      RowBox[{"N", "[", 
       RowBox[{"ArcSin", "[", 
        RowBox[{
         RowBox[{"sl", "[", "h", "]"}], "*", 
         RowBox[{"QuantityMagnitude", "@", "\[Lambda]"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Miscellaneous", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"polarisation", "=", 
      RowBox[{"OptionValue", "[", "\"\<Polarisation\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"threshold", "=", 
      RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Calculations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Miller", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"column1", "=", 
      RowBox[{"MillerNotationToString", "/@", "hkl"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Structure", " ", "factors"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"StructureFactor", "[", 
         RowBox[{"crystal", ",", "hkl", ",", "\[Lambda]", ",", 
          RowBox[{"\"\<Threshold\>\"", "\[Rule]", "threshold"}]}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"column2", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"temp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Structure", " ", "factor", " ", "zero", " ", "positions"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"zeros", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"column2", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Phase", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"column3", "=", 
      RowBox[{"QuantityMagnitude", "@", 
       RowBox[{"temp", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"column3", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"column3", ",", 
        RowBox[{"zeros", "\[Rule]", "\"\<\[Dash]\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Bragg", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"column4", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"bragg", "/@", "hkl"}], ")"}], "/", "Degree"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Unit", " ", "cell", " ", "volume"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"V", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"GetCrystalMetric", "[", "crystal", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Extinction", " ", "length", " ", 
       RowBox[{"(", 
        RowBox[{"Pendell\[ODoubleDot]sung", " ", "distance"}], ")"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"R", "=", 
      RowBox[{"QuantityMagnitude", "@", 
       RowBox[{"UnitConvert", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Quantity", "[", "\"\<ClassicalElectronRadius\>\"", "]"}], 
         ",", "\"\<Angstroms\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"column4", "*", "Degree"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"Fh", "=", "column2"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"FhBar", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"StructureFactor", "[", 
         RowBox[{"crystal", ",", 
          RowBox[{"-", "hkl"}], ",", "\[Lambda]"}], "]"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"ExtinctionLength", "[", 
        RowBox[{
        "crystal", ",", "\[Lambda]", ",", "hkl", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}], ",", 
         RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "polarisation"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[CapitalLambda]o", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"\[CapitalLambda]o", ",", 
        RowBox[{"zeros", "\[Rule]", "\"\<\[Dash]\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Darwin", " ", "width"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"\[Delta]os", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"DarwinWidth", "[", 
        RowBox[{
        "crystal", ",", "\[Lambda]", ",", "hkl", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}], ",", 
         RowBox[{"\"\<Polarisation\>\"", "\[Rule]", "polarisation"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]os", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"\[Delta]os", ",", 
        RowBox[{"zeros", "\[Rule]", "\"\<\[Dash]\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"column5", ",", "column6"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"\[CapitalLambda]o", ",", "\[Delta]os"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Preparing", " ", "output", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp1", "=", 
      RowBox[{"{", 
       RowBox[{
       "column1", ",", "column2", ",", "column3", ",", "column4", ",", 
        "column5", ",", "column6"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Sorting", " ", "option"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"sort", "=", 
      RowBox[{"OptionValue", "[", "\"\<Sort\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "sort", " ", "setting"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Range", "[", "6", "]"}], ",", 
          RowBox[{"Abs", "@", "sort"}]}], "]"}]}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"StructureFactorTable", "::", "sort"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Sorting", " ", "by", " ", "a", " ", "specific", " ", "column"}], " ", 
      "*)"}], "\t\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp2", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Transpose", "@", "temp1"}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", 
            RowBox[{"Abs", "@", "sort"}], "]"}], "]"}], "<", 
          RowBox[{"#2", "[", 
           RowBox[{"[", 
            RowBox[{"Abs", "@", "sort"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Reversing", " ", "if", " ", "negative"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sort", "<", "0"}], ",", 
       RowBox[{"temp2", "=", 
        RowBox[{"Reverse", "@", "temp2"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Truncate", " ", "the", " ", "list", " ", "of", " ", "reflections"}]}],
       " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"keep", "=", 
      RowBox[{"OptionValue", "[", "\"\<Keep\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"keep", "\[Equal]", "All"}], ",", 
       RowBox[{"keep", "=", 
        RowBox[{"Length", "@", "hkl"}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"IntegerQ", "[", "keep", "]"}]}], "||", 
        RowBox[{"!", 
         RowBox[{"Positive", "[", "keep", "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"StructureFactorTable", "::", "invkeep"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t\t", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp2", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"temp2", ",", 
        RowBox[{"Min", "[", 
         RowBox[{"keep", ",", 
          RowBox[{"Length", "@", "hkl"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Rounding", " ", "off", " ", "numbers"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp3", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NumberForm", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "3"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"DigitBlock", "\[Rule]", "3"}], ",", 
          RowBox[{"NumberSeparator", "\[Rule]", "\"\<,\>\""}]}], "]"}], "&"}],
        "/@", 
       RowBox[{"(", 
        RowBox[{"Flatten", "@", "temp2"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"temp4", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"temp3", ",", 
        RowBox[{"Last", "@", 
         RowBox[{"Dimensions", "@", "temp2"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Table", " ", "construction", " ", "*", 
       
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp5", "=", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"temp4", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "\"\<(hkl)\>\"", ",", 
          "\"\<|\!\(\*SubscriptBox[\(F\), \(hkl\)]\)|\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(\[Phi]\), \(hkl\)]\) [\[Degree]]\>\"", 
          ",", "\[IndentingNewLine]", "\t", 
          "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(B\)]\) [\[Degree]]\>\"", 
          ",", "\"\<\!\(\*SubscriptBox[\(\[CapitalLambda]\), \(0\)]\) [\
\[Micro]m]\>\"", ",", 
          "\"\<2\!\(\*SubscriptBox[\(\[Delta]\), \(os\)]\) \
[\[Micro]rad]\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp6", "=", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"temp5", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "Null", ",", "\"\<Structure factor\>\"", ",", "\"\<Phase\>\"", ",", 
          "\[IndentingNewLine]", "\t", "\"\<Bragg angle\>\"", ",", 
          "\"\<Extinction length\>\"", ",", "\[IndentingNewLine]", "\t", 
          "\"\<Darwin width\>\""}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Grid", "[", 
      RowBox[{"temp6", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Dividers", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Dividers", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Background", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Background", "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Alignment", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Center"}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"2", "\[Rule]", "0.5"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"ItemStyle", "\[Rule]", "\[IndentingNewLine]", "\t", 
        RowBox[{"{", 
         RowBox[{
         "Automatic", ",", "\[IndentingNewLine]", "\t", "Automatic", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"First", "@", 
                  RowBox[{"Dimensions", "@", "temp1"}]}]}], "}"}]}], "}"}], 
             "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<TitleStyle\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"First", "@", 
                  RowBox[{"Dimensions", "@", "temp1"}]}]}], "}"}]}], "}"}], 
             "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<SubtitleStyle\>\"", "]"}]}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"Dimensions", "@", "temp2"}]}], "+", "2"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"First", "@", 
                  RowBox[{"Dimensions", "@", "temp1"}]}]}], "}"}]}], "}"}], 
             "\[Rule]", 
             RowBox[{"OptionValue", "[", "\"\<NumberStyle\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "\t", "}"}]}], "\[IndentingNewLine]", "\t", 
         "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.6681059041705027`*^9, {3.668106026194642*^9, 
   3.668106055503222*^9}, 3.668192910799576*^9, {3.6681941224670277`*^9, 
   3.668194126738676*^9}, {3.668194161897127*^9, 3.6681941659530773`*^9}, {
   3.668194225695754*^9, 3.6681943053267803`*^9}, {3.668194339678026*^9, 
   3.668194344188929*^9}, {3.6681944039575644`*^9, 3.668194466586141*^9}, {
   3.6681945564479427`*^9, 3.6681945658649063`*^9}, {3.668194622790612*^9, 
   3.668194759771111*^9}, {3.66819490548871*^9, 3.668195027229073*^9}, {
   3.6681951039560843`*^9, 3.66819510554707*^9}, {3.66819513761075*^9, 
   3.668195162577676*^9}, {3.668195214651011*^9, 3.668195218113638*^9}, 
   3.6681952494025793`*^9, 3.6681954247493143`*^9, 3.66824401430801*^9, 
   3.6684058731849527`*^9, {3.668405944769766*^9, 3.668405951720669*^9}, {
   3.6736853314815063`*^9, 3.673685355082993*^9}, {3.6736944025692043`*^9, 
   3.673694463026792*^9}, {3.679749111284326*^9, 3.679749119529436*^9}, {
   3.679749272848419*^9, 3.679749286046275*^9}, 3.6797493496599827`*^9, {
   3.679749406699519*^9, 3.6797494299138737`*^9}, {3.679752731081196*^9, 
   3.679752735159561*^9}, {3.679755957575972*^9, 3.679755974526786*^9}, {
   3.679757886760714*^9, 3.679757915049499*^9}, {3.679757952809022*^9, 
   3.67975795343259*^9}, {3.6797580074154797`*^9, 3.6797580077028008`*^9}, {
   3.6816343573203783`*^9, 3.681634369229891*^9}, {3.6816344032239857`*^9, 
   3.681634446203055*^9}, {3.681634504934698*^9, 3.681634520684157*^9}, {
   3.681668871102579*^9, 3.681668878253851*^9}, {3.684485120925991*^9, 
   3.684485135297613*^9}, {3.684485165928299*^9, 3.684485198270612*^9}, {
   3.684485246037017*^9, 3.684485436633341*^9}, {3.6844854724040728`*^9, 
   3.6844855337764053`*^9}, {3.6844856008386497`*^9, 
   3.6844857691632633`*^9}, {3.684485809188869*^9, 3.6844858205229397`*^9}, {
   3.6844858510434237`*^9, 3.684485911259457*^9}, {3.6844859442451973`*^9, 
   3.684486072812007*^9}, {3.6844861149482327`*^9, 3.6844862603708687`*^9}, {
   3.68448629383969*^9, 3.684486347931925*^9}, {3.684486396878598*^9, 
   3.6844864256933117`*^9}, {3.6844865317020893`*^9, 
   3.6844865929976273`*^9}, {3.6844866482327633`*^9, 3.684486740721855*^9}, {
   3.684487045709893*^9, 3.684487070636261*^9}, 3.684487103167721*^9, {
   3.684487880088442*^9, 3.6844879170825977`*^9}, {3.6850834290776587`*^9, 
   3.685083453530726*^9}, {3.685083491735672*^9, 3.685083493793859*^9}, {
   3.685084511620009*^9, 3.685084534377172*^9}, {3.6852513095226097`*^9, 
   3.685251331509769*^9}, {3.685265793853511*^9, 3.685265803975073*^9}, {
   3.685265839556972*^9, 3.68526596218845*^9}, {3.685266073088797*^9, 
   3.685266093823522*^9}, {3.685266220826173*^9, 3.685266238271948*^9}, {
   3.685266275245944*^9, 3.685266340576406*^9}, {3.685267063973906*^9, 
   3.68526709334811*^9}, {3.685270774115447*^9, 3.6852709228653717`*^9}, {
   3.685300321882452*^9, 3.685300335601007*^9}, {3.685421443505704*^9, 
   3.685421463958482*^9}, {3.685422156442091*^9, 3.685422172609242*^9}, {
   3.685699369585546*^9, 3.685699369868608*^9}, {3.685707914475984*^9, 
   3.6857079249369507`*^9}, {3.6857080309963493`*^9, 3.685708055487095*^9}, 
   3.685765931784999*^9, {3.685776663041807*^9, 3.685776681732292*^9}, {
   3.685777377256502*^9, 3.685777405662352*^9}, 3.685777524891036*^9, {
   3.6857787731275463`*^9, 3.68577877339953*^9}, {3.685778916829303*^9, 
   3.68577891751688*^9}, {3.685779003826284*^9, 3.6857790040668373`*^9}, {
   3.685779111530941*^9, 3.6857791390455627`*^9}, {3.6857791829251223`*^9, 
   3.685779226673965*^9}, {3.685779257568705*^9, 3.685779324132321*^9}, {
   3.685863811228397*^9, 3.685863888812524*^9}, {3.6858639418180532`*^9, 
   3.685864030534474*^9}, {3.685864068109055*^9, 3.6858640728944902`*^9}, {
   3.685864320620183*^9, 3.685864364665761*^9}, {3.685881483399377*^9, 
   3.685881483983437*^9}, {3.6865346936788034`*^9, 3.686534729215604*^9}, {
   3.6865348797712045`*^9, 3.6865349111896048`*^9}, {3.6865351710388064`*^9, 
   3.6865351905388064`*^9}, {3.6865354148980083`*^9, 
   3.6865354271440077`*^9}, {3.6866574967551813`*^9, 3.68665754350769*^9}, {
   3.7147128016475286`*^9, 3.7147128052312393`*^9}, {3.714712861943325*^9, 
   3.7147128669009533`*^9}, {3.714712922756605*^9, 3.714712927633663*^9}, {
   3.714713663696129*^9, 3.7147136882868347`*^9}, {3.7147164475537777`*^9, 
   3.7147164612558727`*^9}, {3.715330575007782*^9, 3.71533060055259*^9}, {
   3.71533063423807*^9, 3.7153306667473297`*^9}, {3.717740896749968*^9, 
   3.717740919759727*^9}, {3.719080061839922*^9, 3.7190800635580177`*^9}, {
   3.719080096107452*^9, 3.71908013681688*^9}, 3.726561582555664*^9, 
   3.727675289752404*^9, {3.730379987198442*^9, 3.7303800426667137`*^9}, {
   3.730380220134783*^9, 3.730380225254434*^9}, 3.7303802840384197`*^9, {
   3.7303805113333607`*^9, 3.730380531762488*^9}, {3.7303805650160418`*^9, 
   3.730380592271204*^9}, {3.730380624520441*^9, 3.7303806444062567`*^9}, {
   3.730383886626964*^9, 3.7303838976804667`*^9}, {3.7303841186379232`*^9, 
   3.730384121147691*^9}, {3.730384175596126*^9, 3.730384297453144*^9}, {
   3.730384401122053*^9, 3.7303844100839863`*^9}, {3.730384791008588*^9, 
   3.730384825634898*^9}, {3.730398391122581*^9, 3.730398403439115*^9}, {
   3.7303989641138067`*^9, 3.730399035992712*^9}, {3.730399129245757*^9, 
   3.730399157067222*^9}, 3.737968267054536*^9, {3.737968468576823*^9, 
   3.7379684686723223`*^9}, {3.7391703649281387`*^9, 3.739170378745417*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[214]:=",ExpressionUUID->"63da2822-8b11-43e6-9295-5a294a4f7a0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[215]:=",ExpressionUUID->"34c51dac-8753-41d0-b735-5357f53cd7e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetryEquivalentPositions", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.684667958524547*^9, 3.684667960120316*^9}, {3.6846686457735453`*^9, 
   3.6846686463667*^9}, {3.684836784425963*^9, 3.684836788963016*^9}, 
   3.6850744452466288`*^9, 3.6850823153301153`*^9, {3.6854348821014957`*^9, 
   3.685434894095244*^9}, 
   3.737968626349929*^9},ExpressionUUID->"a8b3473f-7956-4cdf-bedc-\
4daf3905b910"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[216]:=",ExpressionUUID->"ef238868-85bb-45e7-bdf3-16d50502ebbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymmetryEquivalentPositions", "::", "threshold"}], "=", 
    "\"\<Tolerance specification must be a non-negative number.\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "SymmetryEquivalentPositions"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<UseCentring\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<RationaliseThreshold\>\"", "\[Rule]", "0.001"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713499594264703*^9, 3.713499600791645*^9}, {
   3.7134997559003563`*^9, 3.713499760848817*^9}, {3.713500682715701*^9, 
   3.713500701729546*^9}, {3.718704905455051*^9, 3.718704929765172*^9}, {
   3.724146707499155*^9, 3.724146707702059*^9}, {3.724146878698964*^9, 
   3.72414690422395*^9}, {3.724147745195922*^9, 3.724147746304405*^9}, {
   3.724148051662944*^9, 3.724148105663968*^9}, {3.725178522395805*^9, 
   3.725178523035316*^9}, {3.7263875589391527`*^9, 3.726387575167107*^9}, {
   3.7263876327996063`*^9, 3.726387668868034*^9}, {3.72638806060953*^9, 
   3.726388104569353*^9}, 3.72638820342171*^9, {3.726908811296638*^9, 
   3.7269088127070007`*^9}, {3.734077581412663*^9, 3.734077582179674*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"75c95abf-d66f-4b84-afcb-899dfacfb16f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[219]:=",ExpressionUUID->"8c819c7f-8146-44fa-80ec-28d1151a012f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryEquivalentPositions", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"xyzInput_List:", 
     RowBox[{"{", 
      RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "@", "SymmetryEquivalentPositions"}]}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "group", ",", "\[Delta]", ",", "useCentringQ", ",", "fracs", ",", "r", 
      ",", "xyz", ",", "\[IndentingNewLine]", "s", ",", "R", ",", "T", ",", 
      "equiv", ",", "rationalise", ",", "mod", ",", "generate", ",", "gather",
       ",", "centring", ",", "final", ",", "t", ",", "sym", ",", "c", ",", 
      "add", ",", "pos", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Input", " ", "check", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"group", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"input", ",", "\"\<GetPointSpaceGroupCrystal\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"xyz", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"xyzInput", ",", "\"\<WrapSingle\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Options", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"OptionValue", "[", "\"\<RationaliseThreshold\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"NumericQ", "[", "#", "]"}], "&&", 
            RowBox[{"!", 
             RowBox[{"Negative", "[", "#", "]"}]}]}], ")"}]}], "&"}], "@", 
        "\[Delta]"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Message", "@", 
        RowBox[{"SymmetryEquivalentPositions", "::", "threshold"}]}]}], "]"}],
      ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"useCentringQ", "=", 
      RowBox[{"OptionValue", "[", "\"\<UseCentring\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Procedure", " ", "for", " ", 
       "generating", " ", "equivalent", " ", "positions", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Replace", " ", "float", " ", "zero", " ", "to", " ", "integer", " ", 
       "zero", " ", "and", " ", "rationalis"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"fracs", "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "12"], ",", 
        FractionBox["1", "8"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "3"], ",", 
        FractionBox["3", "8"], ",", 
        FractionBox["5", "12"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["7", "12"], ",", 
        FractionBox["5", "8"], ",", 
        FractionBox["2", "3"], ",", 
        FractionBox["3", "4"], ",", 
        FractionBox["5", "6"], ",", 
        FractionBox["7", "8"], ",", 
        FractionBox["11", "12"]}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     
     RowBox[{
      RowBox[{"rationalise", "[", "coord_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Sow", "@", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"fracs", ",", 
               RowBox[{"r", "=", 
                RowBox[{"Rationalize", "[", 
                 RowBox[{
                  RowBox[{"i", "/.", 
                   RowBox[{"{", 
                    RowBox[{"0.", "\[Rule]", "0"}], "}"}]}], ",", 
                  "\[Delta]"}], "]"}]}]}], "]"}], ",", "r", ",", "i"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "coord"}], "}"}]}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Dealing", " ", "with", " ", "remainder", " ", "of", " ", 
       "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"mod", "[", "X_", "]"}], ":=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"NumericQ", "[", "X", "]"}], ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"X", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Head", "[", "X", "]"}], "===", "Plus"}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"X", ",", "NumericQ"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"sym", "=", 
          RowBox[{"X", "-", "t"}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "1"}], "]"}], "+", "sym"}]}], ",", 
        "\[IndentingNewLine]", "\t", "True", ",", "X"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "symmetry", " ", "generation"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"s", "=", 
      RowBox[{"GetSymmetryOperations", "@", "group"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "T"}], "}"}], "=", 
      RowBox[{"Transpose", "@", "s"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Dimensions", "@", "s"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "3", ",", "3"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Point", " ", "group", " ", "procedure"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"generate", "[", "coord_", "]"}], ":=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"s", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", "coord"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "s"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Space", " ", "group", " ", "procedure"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"generate", "[", "coord_", "]"}], ":=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", "coord"}], "+", 
           RowBox[{"T", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "s"}]}], "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Bring", " ", "coordinates", " ", "into", " ", "one", " ", "cell"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"gather", "[", "list_", "]"}], ":=", 
      RowBox[{"Map", "[", 
       RowBox[{"mod", ",", "list", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Process", " ", "centring"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"c", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{"GetSymmetryData", "[", 
         RowBox[{"group", ",", "\"\<HermannMauguinFull\>\""}], "]"}], ",", 
        "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"add", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"c", ",", "\"\<GetCentringVectors\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{"useCentringQ", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Apply"}], " ", "centring", " ", "vectors"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"centring", "[", "list_", "]"}], ":=", 
        RowBox[{"(", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"equiv", "=", 
           RowBox[{"DeleteDuplicates", "@", "list"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"temp", "=", "equiv"}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"equiv", "=", 
           RowBox[{
            RowBox[{"Reap", "[", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"Sow", "[", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "+", 
                   RowBox[{"add", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "&"}], "/@", "temp"}], 
                "]"}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "@", "add"}]}], "}"}]}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"equiv", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"equiv", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"Map", "[", 
           RowBox[{"mod", ",", "equiv", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", "\t", 
         ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Do"}], " ", "not", " ", "use", " ", 
         "centring", " ", "vectors"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"centring", "[", "list_", "]"}], ":=", 
        RowBox[{"(", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"mod", ",", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", 
                RowBox[{"add", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "@", "add"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "list"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"pos", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Position", "[", "\[IndentingNewLine]", 
                RowBox[{"list", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "@", "list"}]}], "}"}]}], "]"}], "&"}], "/@",
             "temp"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"temp", "=", 
           RowBox[{"Transpose", "@", "pos"}]}], ";", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"temp", "=", 
           RowBox[{"DeleteDuplicates", "@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Sort", "@", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"temp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "@", "temp"}]}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"temp", "=", 
           RowBox[{"Flatten", "@", 
            RowBox[{"temp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"Flatten", "@", "temp"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "\t", ")"}]}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Final", " ", "trimming"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"final", "[", "list_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"list", "/.", 
          RowBox[{"x_Real", "\[RuleDelayed]", 
           RowBox[{"Round", "[", 
            RowBox[{"x", ",", 
             RowBox[{"10.", "^", 
              RowBox[{"(", 
               RowBox[{"-", "6"}], ")"}]}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"DeleteDuplicates", "@", "temp"}]}], "\[IndentingNewLine]", 
       "\t", ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Execute", " ", "procedure", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"final", "/@", 
       RowBox[{"centring", "/@", 
        RowBox[{"gather", "/@", 
         RowBox[{"generate", "/@", 
          RowBox[{"rationalise", "/@", "xyz"}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"xyzInput", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "ListQ"}], 
            "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", 
        RowBox[{"First", "@", "xyz"}]}], ",", 
       RowBox[{"Return", "@", "xyz"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, 
   3.684837418146798*^9, {3.685081765462866*^9, 3.685081784523337*^9}, {
   3.685118924669243*^9, 3.685118964383156*^9}, {3.685119054695488*^9, 
   3.685119066377532*^9}, {3.685119112037159*^9, 3.6851191612366247`*^9}, {
   3.6851222233997707`*^9, 3.685122323624399*^9}, {3.685122416923841*^9, 
   3.685122647957561*^9}, {3.685122869265139*^9, 3.685122929853465*^9}, {
   3.68512305683995*^9, 3.685123057632986*^9}, {3.685123097397284*^9, 
   3.6851231341679573`*^9}, {3.6851232087492*^9, 3.685123290233316*^9}, {
   3.6851233206586733`*^9, 3.685123472518133*^9}, {3.685124768846352*^9, 
   3.685124788413164*^9}, 3.685124827498146*^9, {3.685124922417843*^9, 
   3.685124934839531*^9}, {3.6851249687289753`*^9, 3.685124990060795*^9}, {
   3.6851253439768457`*^9, 3.685125361990635*^9}, {3.685125398349538*^9, 
   3.68512542023664*^9}, {3.6851254611798267`*^9, 3.6851254618843307`*^9}, {
   3.685125539762597*^9, 3.685125544444332*^9}, {3.685125577885902*^9, 
   3.685125578465879*^9}, {3.685125849690433*^9, 3.685125882844267*^9}, 
   3.6851260251970587`*^9, {3.6851260882802267`*^9, 3.685126100928886*^9}, 
   3.6851261506388273`*^9, 3.685158949332796*^9, {3.685159842828394*^9, 
   3.6851598471301613`*^9}, {3.685183225218504*^9, 3.685183274544767*^9}, {
   3.685183644991259*^9, 3.685183651371249*^9}, {3.685183769606805*^9, 
   3.685183925611478*^9}, {3.685184067941053*^9, 3.6851842703513117`*^9}, {
   3.685184421759241*^9, 3.6851844684094353`*^9}, {3.685184503184823*^9, 
   3.685184553229735*^9}, {3.685184708178369*^9, 3.68518473788163*^9}, {
   3.68518479378185*^9, 3.685184816728256*^9}, {3.685184887217552*^9, 
   3.685184904730365*^9}, {3.685184963595149*^9, 3.685184963842359*^9}, {
   3.685185169679628*^9, 3.685185173609806*^9}, {3.685185206615876*^9, 
   3.685185211544053*^9}, {3.685186054699051*^9, 3.685186105224084*^9}, {
   3.685186171361231*^9, 3.68518622835814*^9}, {3.6851864968530817`*^9, 
   3.6851864977507257`*^9}, {3.685188226992251*^9, 3.6851882855032883`*^9}, {
   3.685188338677219*^9, 3.685188389925318*^9}, {3.6851884225533133`*^9, 
   3.6851884778853292`*^9}, {3.6851886397627687`*^9, 
   3.6851886404914837`*^9}, {3.685188736921248*^9, 3.6851887716553507`*^9}, {
   3.6851888382458267`*^9, 3.685188843807993*^9}, {3.685188901531807*^9, 
   3.685188958942677*^9}, {3.6852030136406918`*^9, 3.6852030203402653`*^9}, {
   3.685203332714066*^9, 3.6852034664310293`*^9}, {3.68520357949958*^9, 
   3.685203583579488*^9}, {3.685203631691106*^9, 3.6852038238427153`*^9}, {
   3.685204014818913*^9, 3.685204018641644*^9}, {3.6852046948378363`*^9, 
   3.685204701530817*^9}, 3.685205189266966*^9, {3.685205251120021*^9, 
   3.685205258984681*^9}, {3.685205294199864*^9, 3.685205323967197*^9}, {
   3.685205382261896*^9, 3.6852053942304697`*^9}, {3.685205539665709*^9, 
   3.685205582735384*^9}, {3.685205749293621*^9, 3.685205767326249*^9}, 
   3.685205870955637*^9, {3.685205939497405*^9, 3.685205952679864*^9}, {
   3.685206060213029*^9, 3.685206145011127*^9}, {3.68520619674656*^9, 
   3.68520619707379*^9}, {3.685206227123476*^9, 3.6852062339549627`*^9}, {
   3.685206272608488*^9, 3.685206275168111*^9}, {3.6852064304145*^9, 
   3.685206469262385*^9}, {3.685206550603971*^9, 3.6852066279924726`*^9}, {
   3.6852066849438343`*^9, 3.6852067411658983`*^9}, {3.685206788680094*^9, 
   3.6852068067724953`*^9}, 3.685206882845697*^9, {3.685206965809578*^9, 
   3.6852069758419437`*^9}, {3.6852070473454227`*^9, 3.685207057519327*^9}, {
   3.6852452311009398`*^9, 3.685245232029594*^9}, {3.685245304014555*^9, 
   3.685245306103737*^9}, {3.68533315360011*^9, 3.685333158638859*^9}, {
   3.685333288226824*^9, 3.685333412181869*^9}, {3.685333489406932*^9, 
   3.685333527621323*^9}, {3.685334009710787*^9, 3.6853340615531063`*^9}, {
   3.685683948109357*^9, 3.685683969066854*^9}, {3.685684173378677*^9, 
   3.685684179360407*^9}, {3.685684219351754*^9, 3.685684242026422*^9}, {
   3.685684329113531*^9, 3.685684344552244*^9}, 3.685684490792983*^9, {
   3.685684963453862*^9, 3.685684972318191*^9}, {3.685685202118141*^9, 
   3.685685202722992*^9}, {3.6856983764665422`*^9, 3.685698384472649*^9}, {
   3.685698414521661*^9, 3.685698453912359*^9}, {3.6856986280000772`*^9, 
   3.685698635822954*^9}, {3.6856989018480177`*^9, 3.685698902841278*^9}, {
   3.685700719109725*^9, 3.685700720110365*^9}, {3.713083751718377*^9, 
   3.713083768413437*^9}, {3.713168273264307*^9, 3.713168277563582*^9}, {
   3.713168352903799*^9, 3.713168405861792*^9}, {3.713169589471793*^9, 
   3.713169608606256*^9}, 3.713170013682741*^9, 3.7131700575141897`*^9, {
   3.713170088986618*^9, 3.713170095603582*^9}, {3.713499526158893*^9, 
   3.713499560588848*^9}, {3.713499770664796*^9, 3.71349982766545*^9}, {
   3.713500050118387*^9, 3.713500061879233*^9}, {3.713500101567704*^9, 
   3.7135001351390047`*^9}, {3.7135003662897367`*^9, 3.713500366952792*^9}, {
   3.7135004654799128`*^9, 3.713500473607541*^9}, {3.713500510785741*^9, 
   3.713500548924837*^9}, {3.7135006099457817`*^9, 3.713500636869567*^9}, {
   3.7135006877885723`*^9, 3.713500703153545*^9}, {3.713501023263645*^9, 
   3.713501030131527*^9}, {3.713501167584064*^9, 3.713501170406444*^9}, {
   3.713501223155225*^9, 3.71350124856561*^9}, {3.713501362594186*^9, 
   3.7135013680528383`*^9}, {3.7135029931867867`*^9, 3.71350304465942*^9}, {
   3.713503129290868*^9, 3.7135031834803953`*^9}, {3.7135032444088163`*^9, 
   3.713503287944261*^9}, {3.713503370502891*^9, 3.713503374958488*^9}, {
   3.713503975546476*^9, 3.71350397576543*^9}, {3.713504684810058*^9, 
   3.71350471149022*^9}, {3.713504821673073*^9, 3.713504847051462*^9}, {
   3.713506770792006*^9, 3.7135067710357733`*^9}, {3.7177409035310583`*^9, 
   3.7177409198199987`*^9}, {3.718702267905682*^9, 3.718702270984975*^9}, {
   3.718702546513485*^9, 3.71870255542673*^9}, {3.718702587256318*^9, 
   3.718702592924734*^9}, {3.718702790866989*^9, 3.718702840811036*^9}, {
   3.7187029420200768`*^9, 3.71870295733777*^9}, {3.7187033042637167`*^9, 
   3.718703324477955*^9}, {3.718703557410552*^9, 3.718703580861421*^9}, {
   3.718703721969316*^9, 3.7187037670065403`*^9}, {3.718703810648787*^9, 
   3.718703819606621*^9}, {3.7187042484751873`*^9, 3.718704276325185*^9}, {
   3.718704359572277*^9, 3.718704403538443*^9}, {3.718704579618905*^9, 
   3.718704584453946*^9}, {3.718704649134219*^9, 3.7187046773772163`*^9}, {
   3.718704772052511*^9, 3.718704803326536*^9}, {3.718704861649938*^9, 
   3.718704861758614*^9}, {3.71870489875311*^9, 3.718704902109955*^9}, {
   3.718704935516982*^9, 3.7187050089972143`*^9}, {3.7187050974002247`*^9, 
   3.718705143963745*^9}, {3.7187051797426157`*^9, 3.71870518179688*^9}, {
   3.7187052496216383`*^9, 3.718705309113635*^9}, {3.718705342961183*^9, 
   3.718705486696869*^9}, {3.71870558241322*^9, 3.718705631663995*^9}, {
   3.718705669496666*^9, 3.718705693622848*^9}, {3.7187057832542257`*^9, 
   3.7187057844852753`*^9}, {3.718943604887106*^9, 3.718943605567745*^9}, {
   3.718957331435055*^9, 3.718957332253023*^9}, {3.7189581197219467`*^9, 
   3.718958126536869*^9}, {3.718958262990077*^9, 3.7189583030322647`*^9}, {
   3.718958341354164*^9, 3.718958395057558*^9}, {3.718958902658646*^9, 
   3.7189589330848703`*^9}, {3.7189595972869463`*^9, 
   3.7189595999236383`*^9}, {3.718959645726413*^9, 3.718959645938561*^9}, {
   3.718959723445923*^9, 3.718959731129519*^9}, {3.718959855847272*^9, 
   3.7189598628644333`*^9}, {3.718959928416421*^9, 3.718960092214171*^9}, {
   3.7189603590826797`*^9, 3.7189603675865917`*^9}, {3.718960430355897*^9, 
   3.718960476213838*^9}, {3.718960506946436*^9, 3.718960531167076*^9}, {
   3.718960569668892*^9, 3.7189605967364483`*^9}, {3.718960716944191*^9, 
   3.718960719223394*^9}, {3.7189607746680527`*^9, 3.718960822713955*^9}, {
   3.718960862042358*^9, 3.7189608891031923`*^9}, {3.718960954685461*^9, 
   3.718960996746277*^9}, {3.718961138055512*^9, 3.718961142984647*^9}, {
   3.718961176445119*^9, 3.718961207844944*^9}, {3.718961519200281*^9, 
   3.718961529170055*^9}, 3.718961804790731*^9, {3.71896185591358*^9, 
   3.718961881823591*^9}, {3.718961997669425*^9, 3.718961997860964*^9}, {
   3.718962067462232*^9, 3.718962191140209*^9}, {3.718962245560566*^9, 
   3.7189622458724203`*^9}, {3.7189623145675488`*^9, 3.718962343842904*^9}, {
   3.718962426989458*^9, 3.718962428820262*^9}, {3.718974001878937*^9, 
   3.718974004349689*^9}, {3.718974122257966*^9, 3.718974134597761*^9}, {
   3.718974283762995*^9, 3.718974286577139*^9}, {3.718974370343102*^9, 
   3.718974373886902*^9}, {3.718974407984931*^9, 3.718974408640705*^9}, {
   3.7189755121327887`*^9, 3.7189756028499804`*^9}, {3.718975782558567*^9, 
   3.7189757829743357`*^9}, {3.7189759875925694`*^9, 3.71897600053087*^9}, {
   3.718976113763732*^9, 3.7189761554244003`*^9}, {3.718976199097856*^9, 
   3.718976218167144*^9}, {3.718976858317809*^9, 3.718977011610354*^9}, {
   3.718977219894305*^9, 3.718977230977405*^9}, {3.718977403251737*^9, 
   3.718977438577445*^9}, {3.718977547318542*^9, 3.7189776158462963`*^9}, {
   3.718977661438077*^9, 3.7189777150195827`*^9}, {3.718979971407103*^9, 
   3.718980029709015*^9}, {3.718980144339252*^9, 3.7189802286591253`*^9}, {
   3.721029130761808*^9, 3.721029164831861*^9}, {3.7241476371690207`*^9, 
   3.724147798167531*^9}, {3.724148002937152*^9, 3.7241480436785307`*^9}, {
   3.724148181215764*^9, 3.7241481911749477`*^9}, {3.724148305769567*^9, 
   3.7241483067806177`*^9}, {3.724148653838604*^9, 3.7241486699696617`*^9}, {
   3.724149039524035*^9, 3.724149059360086*^9}, {3.724149101482971*^9, 
   3.724149143000737*^9}, {3.7241491768592052`*^9, 3.724149177006098*^9}, {
   3.724149213842347*^9, 3.724149230497789*^9}, {3.72456240877332*^9, 
   3.724562437241872*^9}, {3.724562691949194*^9, 3.724562705074954*^9}, {
   3.724562738986405*^9, 3.724562744786539*^9}, {3.7245627838992968`*^9, 
   3.724562806177045*^9}, {3.7245628474439163`*^9, 3.724562980600527*^9}, {
   3.724563014640937*^9, 3.724563063724536*^9}, 3.724563137901832*^9, {
   3.724563852516762*^9, 3.724563900159609*^9}, {3.724563966154461*^9, 
   3.724563968696681*^9}, {3.724563999155751*^9, 3.72456400504391*^9}, {
   3.7245642420808363`*^9, 3.7245642459234447`*^9}, 3.724564353346133*^9, {
   3.725178421835697*^9, 3.7251785155592957`*^9}, {3.726387588253851*^9, 
   3.726387595167289*^9}, {3.7263876411446466`*^9, 3.7263876432217493`*^9}, {
   3.7263879719181004`*^9, 3.726388017726527*^9}, {3.7263880512764597`*^9, 
   3.726388052385066*^9}, {3.726388106877531*^9, 3.726388112017288*^9}, {
   3.72638820775865*^9, 3.726388217097714*^9}, {3.726388261414641*^9, 
   3.726388271841373*^9}, {3.726388305339175*^9, 3.726388334413658*^9}, {
   3.726388825085866*^9, 3.726389001368773*^9}, {3.726389032049206*^9, 
   3.726389066652157*^9}, {3.7263891317997007`*^9, 3.7263891487172613`*^9}, {
   3.726389221087077*^9, 3.726389223956566*^9}, {3.7264151648398333`*^9, 
   3.726415208707095*^9}, {3.726489400555379*^9, 3.726489429073037*^9}, {
   3.726489732160439*^9, 3.7264897372408533`*^9}, {3.7264899125900087`*^9, 
   3.7264899127440157`*^9}, {3.72648998651215*^9, 3.7264899891958923`*^9}, {
   3.726504530915469*^9, 3.7265045395905123`*^9}, {3.726504825852056*^9, 
   3.726504840043426*^9}, {3.7265077848728437`*^9, 3.726507787550996*^9}, {
   3.7265078438964777`*^9, 3.7265078594780807`*^9}, 3.7265079119767237`*^9, {
   3.727676991582205*^9, 3.727677039008367*^9}, {3.727677095868355*^9, 
   3.7276771258869543`*^9}, {3.727677467171747*^9, 3.727677514204391*^9}, {
   3.7276775832617702`*^9, 3.7276775836411533`*^9}, {3.730544578740963*^9, 
   3.730544579232334*^9}, {3.7340777597422867`*^9, 3.734077772304899*^9}, {
   3.73486098583354*^9, 3.734861021506486*^9}, {3.734861433872726*^9, 
   3.734861465045043*^9}, {3.734861565527253*^9, 3.734861622205986*^9}, {
   3.7348620902371817`*^9, 3.734862091319553*^9}, {3.7348621617054987`*^9, 
   3.734862204718985*^9}, {3.734862323475853*^9, 3.734862411200985*^9}, {
   3.734862583790059*^9, 3.7348625925288677`*^9}, {3.734862625049259*^9, 
   3.734862692372064*^9}, {3.7348627243620567`*^9, 3.734862752835022*^9}, {
   3.73486279054207*^9, 3.734862829270259*^9}, {3.7348628679178543`*^9, 
   3.734863013197206*^9}, {3.734863123296424*^9, 3.73486318018404*^9}, 
   3.73486333229845*^9, {3.734863390870963*^9, 3.7348634050096817`*^9}, {
   3.734863474190488*^9, 3.734863601336433*^9}, {3.73486363259906*^9, 
   3.734863648144658*^9}, {3.734863702739545*^9, 3.734863738886001*^9}, {
   3.734863772657653*^9, 3.734863969922078*^9}, {3.734864004365635*^9, 
   3.734864006345433*^9}, {3.734864077884124*^9, 3.7348641062215242`*^9}, {
   3.734864142277185*^9, 3.734864185780414*^9}, {3.734864247463869*^9, 
   3.7348642530248213`*^9}, {3.73486431505219*^9, 3.7348643207831917`*^9}, {
   3.734864360592111*^9, 3.7348645503844547`*^9}, {3.734864605516275*^9, 
   3.734864620872447*^9}, {3.7348647600644484`*^9, 3.7348647900575533`*^9}, {
   3.73486482234233*^9, 3.734864906273492*^9}, {3.734865238259924*^9, 
   3.73486530354867*^9}, {3.734865482500976*^9, 3.734865649645473*^9}, {
   3.734865774304893*^9, 3.734865788269722*^9}, {3.734865852967577*^9, 
   3.734865871728486*^9}, {3.734865920520743*^9, 3.7348661142347593`*^9}, {
   3.734866190179076*^9, 3.734866193345695*^9}, {3.7373839264276752`*^9, 
   3.737383930316886*^9}, 3.7373844586748533`*^9, {3.7379685458872004`*^9, 
   3.737968575584436*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[220]:=",ExpressionUUID->"e95c523f-e25b-4f2b-8b3b-c87bc52cba1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[221]:=",ExpressionUUID->"8fd09bbc-90d0-478c-b034-bf21ef2762de"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetryEquivalentReflections", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.681669216072617*^9, 3.6816692308311157`*^9}, {
   3.682134073518475*^9, 3.682134077310957*^9}, {3.6821351637913322`*^9, 
   3.682135164412662*^9}, {3.682138013029172*^9, 3.682138014016361*^9}, {
   3.684667958524547*^9, 3.684667960120316*^9}, {3.6846686457735453`*^9, 
   3.6846686463667*^9}, {3.684836784425963*^9, 3.684836788963016*^9}, 
   3.6850744452466288`*^9, 3.6850823153301153`*^9, {3.6854348821014957`*^9, 
   3.6854349197447567`*^9}},ExpressionUUID->"260cf381-8e26-4b2a-a9c2-\
945d9d8ca66d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[222]:=",ExpressionUUID->"2ccfbe0b-a8f1-43c3-b27e-a926ff2823cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[223]:=",ExpressionUUID->"83e22536-bff4-44d7-b9c5-1be29c6e0dc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryEquivalentReflections", "[", 
   RowBox[{"group_String", ",", 
    RowBox[{"hkl_List:", 
     RowBox[{"{", 
      RowBox[{"\"\<h\>\"", ",", "\"\<k\>\"", ",", "\"\<l\>\""}], "}"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"$GroupSymbolRedirect", ",", "group"}], "]"}]}], "&&", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"!", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"$CrystalData", ",", "group"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"GetSymmetryOperations", "::", "missing"}], ",", "group"}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"hkl", ",", "\"\<1hkl\>\"", ",", "\"\<StringSymbol\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Symmetry", " ", "equivalent", " ", "reflections"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "@", "$PointGroups"}], ",", "group"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"s", "=", 
        RowBox[{"GetSymmetryOperations", "@", "group"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"s", "=", 
        RowBox[{"GetSymmetryOperations", "@", 
         RowBox[{"GetLaueClass", "@", "group"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"DeleteDuplicates", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"s", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", "hkl"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "s"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.68166924518751*^9, 3.681669257401746*^9}, 
   3.681706490571958*^9, {3.681706560665007*^9, 3.681706560808091*^9}, {
   3.681706701190172*^9, 3.6817067089323483`*^9}, {3.681706888369705*^9, 
   3.68170694343121*^9}, {3.681707009919237*^9, 3.681707054877233*^9}, 
   3.681707094253208*^9, {3.681707298537107*^9, 3.681707301151917*^9}, {
   3.681710383837879*^9, 3.681710517243684*^9}, {3.681710549236743*^9, 
   3.681710591906762*^9}, 3.68171076139857*^9, 3.681710814623724*^9, {
   3.6817109067478313`*^9, 3.6817110010439167`*^9}, {3.681711080522023*^9, 
   3.6817111039844112`*^9}, 3.681711207870273*^9, {3.6817112607821617`*^9, 
   3.681711305188384*^9}, {3.681711445370324*^9, 3.681711513296112*^9}, {
   3.6817115774404993`*^9, 3.681711650636854*^9}, {3.68171500692944*^9, 
   3.681715026767819*^9}, {3.681715181501337*^9, 3.681715181739588*^9}, {
   3.681715678282447*^9, 3.6817156946895933`*^9}, {3.681715923758252*^9, 
   3.6817159597723722`*^9}, {3.68171782238949*^9, 3.681717946865253*^9}, {
   3.681718348825375*^9, 3.681718349067914*^9}, {3.681718672178816*^9, 
   3.68171869694698*^9}, {3.681718727898713*^9, 3.681718795793612*^9}, {
   3.681719297392269*^9, 3.681719364987854*^9}, {3.681719424875423*^9, 
   3.681719476273019*^9}, {3.681719564217062*^9, 3.6817195753909283`*^9}, {
   3.681719696949328*^9, 3.681719703508996*^9}, {3.681720146779862*^9, 
   3.681720188282736*^9}, {3.681720357048739*^9, 3.681720404007724*^9}, {
   3.681720538565111*^9, 3.68172054257139*^9}, {3.681720713993903*^9, 
   3.681720714144103*^9}, {3.6817209858918037`*^9, 3.681721182870202*^9}, {
   3.681721229493627*^9, 3.6817212759562902`*^9}, {3.681721318685071*^9, 
   3.681721337315277*^9}, {3.681721411035223*^9, 3.681721483737514*^9}, {
   3.6817215519766006`*^9, 3.6817216024457273`*^9}, {3.681721640646819*^9, 
   3.681721648839014*^9}, {3.681721731125741*^9, 3.681721732668375*^9}, {
   3.681721789833881*^9, 3.681721806418096*^9}, {3.6817219185830507`*^9, 
   3.6817219344066553`*^9}, {3.681722442266707*^9, 3.6817224444361963`*^9}, {
   3.6817227023431807`*^9, 3.681722723774548*^9}, {3.6817228369801702`*^9, 
   3.681722870587195*^9}, 3.6817229070837173`*^9, {3.681723229228771*^9, 
   3.681723316371806*^9}, 3.681723352394136*^9, {3.681723491110834*^9, 
   3.6817234976219*^9}, {3.681723533046878*^9, 3.681723549182931*^9}, {
   3.681723690723069*^9, 3.681723710538261*^9}, {3.681723746168332*^9, 
   3.681723764431592*^9}, {3.6817239634608393`*^9, 3.681724024526379*^9}, {
   3.681724085449534*^9, 3.6817242176903954`*^9}, {3.6817242696057167`*^9, 
   3.681724295774458*^9}, 3.681724327237109*^9, {3.681724474011566*^9, 
   3.681724476993256*^9}, 3.681724828780448*^9, {3.6818125091048193`*^9, 
   3.6818125114155693`*^9}, {3.6818368257106333`*^9, 3.68183686908536*^9}, {
   3.681836932372287*^9, 3.6818369624101877`*^9}, 3.681837110530672*^9, {
   3.681837208341257*^9, 3.681837224397664*^9}, {3.6818373595787363`*^9, 
   3.6818374537754908`*^9}, {3.681837562221323*^9, 3.6818375769428663`*^9}, {
   3.681910108411652*^9, 3.681910109523672*^9}, {3.681914019772044*^9, 
   3.6819140660350637`*^9}, {3.681914192192573*^9, 3.681914197016157*^9}, {
   3.6819143018703423`*^9, 3.6819143025663137`*^9}, {3.681915201163806*^9, 
   3.681915204987383*^9}, {3.681915310962316*^9, 3.681915331517808*^9}, {
   3.681915405175632*^9, 3.6819154062625723`*^9}, {3.681915499756755*^9, 
   3.681915499981236*^9}, {3.682073936912169*^9, 3.6820739483816547`*^9}, {
   3.6820743306881447`*^9, 3.682074335621664*^9}, {3.682074407370736*^9, 
   3.682074414704529*^9}, {3.6820745276580267`*^9, 3.6820745282934628`*^9}, {
   3.6820746925334578`*^9, 3.682074694860141*^9}, {3.682074732983082*^9, 
   3.682074765426908*^9}, {3.6820749940801067`*^9, 3.682075014622149*^9}, {
   3.682075051439227*^9, 3.6820750769809523`*^9}, {3.682080559474235*^9, 
   3.682080571064229*^9}, {3.682081192052569*^9, 3.682081198850922*^9}, {
   3.6820825372652617`*^9, 3.682082587828931*^9}, {3.682083882451795*^9, 
   3.682083906361766*^9}, {3.682084834510179*^9, 3.682084909148551*^9}, {
   3.682085355867062*^9, 3.6820853570730352`*^9}, {3.682085387352064*^9, 
   3.682085468590469*^9}, {3.6820954917674417`*^9, 3.682095491933237*^9}, {
   3.6820955359818773`*^9, 3.6820955368911743`*^9}, {3.6820955810166683`*^9, 
   3.682095702639804*^9}, {3.6820958051670427`*^9, 3.682095833859441*^9}, {
   3.6820959556190987`*^9, 3.682095960147934*^9}, {3.682096089911231*^9, 
   3.682096098702631*^9}, {3.6820961601906853`*^9, 3.682096164437451*^9}, {
   3.6820962600043573`*^9, 3.682096261183568*^9}, 3.6820964289853363`*^9, {
   3.682101172972685*^9, 3.682101186499799*^9}, {3.682102756494223*^9, 
   3.6821027720587893`*^9}, {3.682102815514278*^9, 3.682102843539885*^9}, {
   3.682102913889373*^9, 3.6821029181999683`*^9}, {3.682134119475279*^9, 
   3.68213414049387*^9}, {3.682134230034416*^9, 3.682134358353902*^9}, {
   3.682134389202623*^9, 3.682134415753475*^9}, {3.68213471223449*^9, 
   3.682134738680016*^9}, {3.682135167917287*^9, 3.6821351692739058`*^9}, {
   3.682138062911598*^9, 3.682138063720244*^9}, {3.6821381082904797`*^9, 
   3.682138208115355*^9}, {3.682138260558123*^9, 3.682138470630207*^9}, {
   3.682142430328573*^9, 3.682142561470036*^9}, {3.6821426027834806`*^9, 
   3.682142633588481*^9}, {3.682142673674217*^9, 3.682142683054764*^9}, {
   3.682142831982066*^9, 3.6821428879204903`*^9}, {3.6821443136719933`*^9, 
   3.682144398215694*^9}, {3.682144667707994*^9, 3.682144722485908*^9}, {
   3.682146073210956*^9, 3.68214608362833*^9}, {3.6821461172637672`*^9, 
   3.6821461630666447`*^9}, {3.6821463016789713`*^9, 3.682146327282445*^9}, {
   3.682151620835616*^9, 3.682151624741599*^9}, {3.682151684939176*^9, 
   3.6821516924478617`*^9}, {3.6821521411767*^9, 3.682152149634416*^9}, {
   3.682152264995434*^9, 3.682152328608294*^9}, {3.682152441457012*^9, 
   3.68215245878516*^9}, {3.682152762344564*^9, 3.682152791810916*^9}, {
   3.6821528601618853`*^9, 3.682152860391903*^9}, {3.6821529539507027`*^9, 
   3.682152984540741*^9}, {3.68215302321913*^9, 3.682153129482265*^9}, {
   3.682153280259882*^9, 3.682153321673149*^9}, {3.684668021791493*^9, 
   3.6846681658947287`*^9}, {3.6846682780447197`*^9, 3.684668352798271*^9}, {
   3.684668436113463*^9, 3.684668448437615*^9}, {3.6846684900089483`*^9, 
   3.684668526904063*^9}, {3.684668561814063*^9, 3.68466856288406*^9}, {
   3.684668655065772*^9, 3.6846686926482964`*^9}, {3.684668903775888*^9, 
   3.684668909809854*^9}, {3.68466897106539*^9, 3.6846690320927258`*^9}, 
   3.684837418146798*^9, {3.685081765462866*^9, 3.685081784523337*^9}, {
   3.685118924669243*^9, 3.685118964383156*^9}, {3.685119054695488*^9, 
   3.685119066377532*^9}, {3.685119112037159*^9, 3.6851191612366247`*^9}, {
   3.6851222233997707`*^9, 3.685122323624399*^9}, {3.685122416923841*^9, 
   3.685122647957561*^9}, {3.685122869265139*^9, 3.685122929853465*^9}, {
   3.68512305683995*^9, 3.685123057632986*^9}, {3.685123097397284*^9, 
   3.6851231341679573`*^9}, {3.6851232087492*^9, 3.685123290233316*^9}, {
   3.6851233206586733`*^9, 3.685123472518133*^9}, {3.685124768846352*^9, 
   3.685124788413164*^9}, 3.685124827498146*^9, {3.685124922417843*^9, 
   3.685124934839531*^9}, {3.6851249687289753`*^9, 3.685124990060795*^9}, {
   3.6851253439768457`*^9, 3.685125361990635*^9}, {3.685125398349538*^9, 
   3.68512542023664*^9}, {3.6851254611798267`*^9, 3.6851254618843307`*^9}, {
   3.685125539762597*^9, 3.685125544444332*^9}, {3.685125577885902*^9, 
   3.685125578465879*^9}, {3.685125849690433*^9, 3.685125882844267*^9}, 
   3.6851260251970587`*^9, {3.6851260882802267`*^9, 3.685126100928886*^9}, 
   3.6851261506388273`*^9, 3.685158949332796*^9, {3.685159842828394*^9, 
   3.6851598471301613`*^9}, {3.685183225218504*^9, 3.685183274544767*^9}, {
   3.685183644991259*^9, 3.685183651371249*^9}, {3.685183769606805*^9, 
   3.685183925611478*^9}, {3.685184067941053*^9, 3.6851842703513117`*^9}, {
   3.685184421759241*^9, 3.6851844684094353`*^9}, {3.685184503184823*^9, 
   3.685184553229735*^9}, {3.685184708178369*^9, 3.68518473788163*^9}, {
   3.68518479378185*^9, 3.685184816728256*^9}, {3.685184887217552*^9, 
   3.685184904730365*^9}, {3.685184963595149*^9, 3.685184963842359*^9}, {
   3.685185169679628*^9, 3.685185173609806*^9}, {3.685185206615876*^9, 
   3.685185211544053*^9}, {3.685186054699051*^9, 3.685186105224084*^9}, {
   3.685186171361231*^9, 3.68518622835814*^9}, {3.6851864968530817`*^9, 
   3.6851864977507257`*^9}, {3.685188226992251*^9, 3.6851882855032883`*^9}, {
   3.685188338677219*^9, 3.685188389925318*^9}, {3.6851884225533133`*^9, 
   3.6851884778853292`*^9}, {3.6851886397627687`*^9, 
   3.6851886404914837`*^9}, {3.685188736921248*^9, 3.6851887716553507`*^9}, {
   3.6851888382458267`*^9, 3.685188843807993*^9}, {3.685188901531807*^9, 
   3.685188958942677*^9}, {3.6852030136406918`*^9, 3.6852030203402653`*^9}, {
   3.685203332714066*^9, 3.6852034664310293`*^9}, {3.68520357949958*^9, 
   3.685203583579488*^9}, {3.685203631691106*^9, 3.6852038238427153`*^9}, {
   3.685204014818913*^9, 3.685204018641644*^9}, {3.6852046948378363`*^9, 
   3.685204701530817*^9}, 3.685205189266966*^9, {3.685205251120021*^9, 
   3.685205258984681*^9}, {3.685205294199864*^9, 3.685205323967197*^9}, {
   3.685205382261896*^9, 3.6852053942304697`*^9}, {3.685205539665709*^9, 
   3.685205582735384*^9}, {3.685205749293621*^9, 3.685205767326249*^9}, 
   3.685205870955637*^9, {3.685205939497405*^9, 3.685205952679864*^9}, {
   3.685206060213029*^9, 3.685206145011127*^9}, {3.68520619674656*^9, 
   3.68520619707379*^9}, {3.685206227123476*^9, 3.6852062339549627`*^9}, {
   3.685206272608488*^9, 3.685206275168111*^9}, {3.6852064304145*^9, 
   3.685206469262385*^9}, {3.685206550603971*^9, 3.6852066279924726`*^9}, {
   3.6852066849438343`*^9, 3.6852067411658983`*^9}, {3.685206788680094*^9, 
   3.6852068067724953`*^9}, 3.685206882845697*^9, {3.685206965809578*^9, 
   3.6852069758419437`*^9}, {3.6852070473454227`*^9, 3.685207057519327*^9}, {
   3.6852452311009398`*^9, 3.685245232029594*^9}, {3.685245304014555*^9, 
   3.685245306103737*^9}, {3.68533315360011*^9, 3.685333158638859*^9}, {
   3.685333288226824*^9, 3.685333412181869*^9}, {3.685333489406932*^9, 
   3.685333527621323*^9}, {3.685334009710787*^9, 3.6853340615531063`*^9}, {
   3.685434951893444*^9, 3.68543495645269*^9}, {3.685679308302184*^9, 
   3.685679366541724*^9}, {3.685681362973937*^9, 3.685681390985156*^9}, {
   3.685681541848689*^9, 3.685681548849369*^9}, {3.685681624159025*^9, 
   3.6856817248245993`*^9}, {3.685682375085328*^9, 3.6856824096829777`*^9}, {
   3.685682706970652*^9, 3.6856827361419764`*^9}, {3.685682780500025*^9, 
   3.685682793326985*^9}, {3.6856834020300283`*^9, 3.6856834023318663`*^9}, {
   3.685683541715803*^9, 3.685683546893722*^9}, {3.685683742811008*^9, 
   3.685683769887274*^9}, {3.685684019680534*^9, 3.685684021685522*^9}, {
   3.685694740553224*^9, 3.685694766829873*^9}, {3.685694805066313*^9, 
   3.685694808781307*^9}, {3.685694869054508*^9, 3.6856948787401648`*^9}, {
   3.685695112301713*^9, 3.6856951137454853`*^9}, 3.685695291215526*^9, 
   3.685695949981629*^9, {3.6856960570805883`*^9, 3.685696063351282*^9}, {
   3.68569622489463*^9, 3.685696229856901*^9}, {3.685696435911221*^9, 
   3.685696442965283*^9}, {3.6857006845375023`*^9, 3.685700715242507*^9}, {
   3.712991278892541*^9, 3.712991280175083*^9}, {3.712991603345912*^9, 
   3.71299160388553*^9}, {3.712991641984169*^9, 3.712991644925946*^9}, {
   3.713082611111361*^9, 3.713082648830266*^9}, {3.713082711733365*^9, 
   3.713082738595105*^9}, {3.713508632168604*^9, 3.7135086477071753`*^9}, {
   3.713508700392296*^9, 3.713508705070444*^9}, {3.7135090149047403`*^9, 
   3.713509014983123*^9}, {3.71350904912803*^9, 3.713509071140704*^9}, {
   3.713509218835183*^9, 3.7135092234542313`*^9}, {3.717216931454473*^9, 
   3.7172169366602583`*^9}, {3.717740903605912*^9, 3.7177409198879843`*^9}, 
   3.73796852100904*^9, {3.737968575699355*^9, 3.737968575897303*^9}, 
   3.7438654566376657`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[224]:=",ExpressionUUID->"884e7a36-7904-452c-a0ed-2b278e861532"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[225]:=",ExpressionUUID->"df0319cd-1e8f-4fdd-a693-864763088e2d"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetryEquivalentReflectionsQ", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.682754675215427*^9, 3.682754677485675*^9}, {
   3.728589882633176*^9, 
   3.728589884007854*^9}},ExpressionUUID->"b934d72a-6ed8-4db3-b8b8-\
13d3ffcf65bd"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[226]:=",ExpressionUUID->"2f5ed8c8-e8c4-428e-a162-32c3c1e6b196"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[227]:=",ExpressionUUID->"bcabff55-690a-4a90-8edc-3680705d2947"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetryEquivalentReflectionsQ", "[", 
   RowBox[{"group_String", ",", "hkl_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "equiv", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Check", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"InputCheck", "[", 
        RowBox[{"hkl", ",", "\"\<Multiple\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Listing", " ", "all", " ", "symmetry"}], "-", 
       RowBox[{
       "equivalents", " ", "of", " ", "the", " ", "first", " ", 
        "reflection"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"equiv", "=", 
      RowBox[{"SymmetryEquivalentReflections", "[", 
       RowBox[{"group", ",", 
        RowBox[{"First", "@", "hkl"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Checking", " ", "if", " ", "all", " ", "given", " ", "reflections", 
       " ", "are", " ", "symmetry", " ", "equivalent"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"AllTrue", "[", 
      RowBox[{"hkl", ",", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"equiv", ",", "#"}], "]"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.682682345535097*^9, 3.682682347997387*^9}, {
   3.682754890045689*^9, 3.682754900136516*^9}, {3.682754952296125*^9, 
   3.682755022164933*^9}, {3.682755115621669*^9, 3.6827551535141687`*^9}, {
   3.682755192899743*^9, 3.682755204616169*^9}, {3.682755483075945*^9, 
   3.682755572184518*^9}, {3.682755620936475*^9, 3.68275570339452*^9}, {
   3.682755785197132*^9, 3.6827558328591137`*^9}, {3.682755872957996*^9, 
   3.682755929888302*^9}, {3.6827560172459*^9, 3.68275608066227*^9}, {
   3.6827561903761797`*^9, 3.682756208255334*^9}, {3.682756341293084*^9, 
   3.682756435807774*^9}, {3.682756481562601*^9, 3.6827566171437607`*^9}, {
   3.6827571356319447`*^9, 3.68275715086217*^9}, {3.682757193154983*^9, 
   3.682757204761051*^9}, {3.682757287045686*^9, 3.6827573748421717`*^9}, {
   3.6827574428815193`*^9, 3.682757463459453*^9}, {3.6827575865280647`*^9, 
   3.682757600041594*^9}, {3.6827576521824217`*^9, 3.682757654103991*^9}, {
   3.682757736488762*^9, 3.68275776848295*^9}, {3.682757872746702*^9, 
   3.682757878996653*^9}, {3.682760893290402*^9, 3.682760919442278*^9}, {
   3.682761050069873*^9, 3.6827610875022707`*^9}, {3.682761344440157*^9, 
   3.6827613948805656`*^9}, {3.682761467533331*^9, 3.6827614906040382`*^9}, {
   3.682761599041744*^9, 3.6827616051249332`*^9}, {3.682761640140191*^9, 
   3.682761640269712*^9}, 3.6827639426904078`*^9, {3.6836041069697723`*^9, 
   3.6836041112112017`*^9}, 3.6836042162385483`*^9, {3.683604258086424*^9, 
   3.683604264748822*^9}, {3.68413887737684*^9, 3.684138878448064*^9}, {
   3.684138967042678*^9, 3.6841389692184362`*^9}, {3.684139303146071*^9, 
   3.6841393351275997`*^9}, {3.684139441296114*^9, 3.684139473944319*^9}, {
   3.684140980548189*^9, 3.6841409843885393`*^9}, {3.684148295094286*^9, 
   3.6841482963032303`*^9}, 3.6842129856849403`*^9, {3.684213283716967*^9, 
   3.6842133828533163`*^9}, 3.684235428926165*^9, {3.684492634022192*^9, 
   3.684492635098358*^9}, {3.684669134566234*^9, 3.6846691376529293`*^9}, {
   3.685082157159202*^9, 3.685082158064439*^9}, 3.685084042458507*^9, {
   3.685351440985919*^9, 3.68535144830571*^9}, {3.685351631494957*^9, 
   3.685351726668476*^9}, 3.685352008158111*^9, {3.685686126515623*^9, 
   3.685686128329524*^9}, {3.68568617716809*^9, 3.685686214633534*^9}, {
   3.6856966918105917`*^9, 3.685696730149053*^9}, {3.685696768458043*^9, 
   3.685696768931511*^9}, {3.685699116303381*^9, 3.685699129690091*^9}, {
   3.717218478566028*^9, 3.7172184794036493`*^9}, 3.717740919858317*^9, 
   3.728589900907535*^9, {3.728621424723817*^9, 3.7286214272083683`*^9}, 
   3.7416291419918423`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[228]:=",ExpressionUUID->"8b8efc98-fb44-405c-9999-e95ad45a984b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[229]:=",ExpressionUUID->"62c6a1e8-b7cc-4499-bec2-0b72ed3cc94d"]
}, Closed]],

Cell[CellGroupData[{

Cell["SystematicAbsentQ", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, 
   3.684152664923592*^9, 3.684212717826067*^9, {3.684235367542338*^9, 
   3.684235368959896*^9}, {3.7348608567219887`*^9, 
   3.7348608578805103`*^9}},ExpressionUUID->"1f92a3f4-158a-426e-9e4c-\
8235584137d5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[230]:=",ExpressionUUID->"a30969de-3ec1-4a89-b675-e74e65e6c030"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "SystematicAbsentQ"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Options", " ", 
      RowBox[{"from", " ", "'"}], 
      RowBox[{"StructureFactor", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{"\"\<Threshold\>\"", "\[Rule]", "0"}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717953990950385*^9, 3.7179540186608152`*^9}, {
   3.717955286881834*^9, 3.71795528908066*^9}, 3.7185275807475443`*^9, {
   3.7185288952692947`*^9, 3.7185289042447977`*^9}, {3.718528971946641*^9, 
   3.718528972505208*^9}, {3.7186524404557343`*^9, 3.7186524494142714`*^9}, {
   3.718652492038546*^9, 3.7186524992533197`*^9}, 3.718655947266296*^9},
 CellLabel->
  "In[231]:=",ExpressionUUID->"756406cb-15d1-42c5-8bbb-f7da7c18360e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[232]:=",ExpressionUUID->"10654a33-b1b0-47dc-947b-6fe59e0bccab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SystematicAbsentQ", "[", 
   RowBox[{"group_String", ",", "hkl_List", ",", 
    RowBox[{"OptionsPattern", "@", "SystematicAbsentQ"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sgHM", ",", "centring", ",", "symop", ",", "r", ",", "t", ",", 
      "\[Delta]", ",", "crystalQ", ",", "\[Lambda]", ",", "check"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Checking", " ", "and", " ", 
      "processing", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"$CrystalData", ",", "group"}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"sgHM", "=", 
        RowBox[{"$CrystalData", "[", 
         RowBox[{"group", ",", "\"\<SpaceGroup\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"sgHM", "=", "group"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sgHM", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"sgHM", ",", "\"\<InterpretSpaceGroup\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"hkl", ",", "\"\<Integer\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Loading", " ", "lattice", " ", "centring", " ", "vectors", " ", "and", 
       " ", "symmetry", " ", "operations"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sgHM", "=", 
      RowBox[{"GetSymmetryData", "[", 
       RowBox[{"sgHM", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"centring", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"sgHM", ",", "1"}], "]"}], ",", 
        "\"\<GetCentringVectors\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"symop", "=", 
      RowBox[{"GetSymmetryOperations", "[", "sgHM", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Procedure", " ", "for", " ", 
       "checking", " ", "systematic", " ", "absence", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Useful", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"OptionValue", "[", "\"\<Threshold\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"crystalQ", "=", 
      RowBox[{"KeyExistsQ", "[", 
       RowBox[{"$CrystalData", ",", "group"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Ony", " ", "check", " ", "structure", " ", "factor", " ", "if", " ", 
       "\[Delta]", " ", "is", " ", "numeric"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NumericQ", "@", "\[Delta]"}], "&&", 
        RowBox[{"\[Delta]", ">", "0"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       
       RowBox[{
        RowBox[{"\[Lambda]", "=", 
         RowBox[{"$CrystalData", "[", 
          RowBox[{"group", ",", "\"\<Wavelength\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "@", "\[Lambda]"}], ",", 
          RowBox[{"\[Lambda]", "=", "1.0"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"crystalQ", "=", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"check", "[", "input_", "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"General", " ", "absence", " ", 
         RowBox[{"(", "centring", ")"}]}], " ", "*)"}], "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"input", ",", "#"}], "]"}], "&"}], "/@", "centring"}],
              ",", "IntegerQ"}], "]"}]}], ",", 
          RowBox[{"Return", "@", "True"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Special", " ", "absence", " ", 
          RowBox[{"(", "translation", ")"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"r", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Equal", "[", 
            RowBox[{"input", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", 
             RowBox[{"symop", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ".", "input"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"t", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", 
            RowBox[{"input", ".", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"symop", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"r", ",", "t"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Return", "@", "True"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Structure", " ", "factor", " ", "below", " ", "threshold"}],
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"crystalQ", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"First", "@", "\[IndentingNewLine]", 
               RowBox[{"StructureFactor", "[", 
                RowBox[{
                "group", ",", "input", ",", "\[Lambda]", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                 "\"\<IgnoreSystematicAbsence\>\"", "\[Rule]", "True"}]}], 
                "]"}]}], "]"}], "<", "\[Delta]"}], ",", "\[IndentingNewLine]",
             "\t", 
            RowBox[{"Return", "@", "True"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Not", " ", "systematically", " ", "absent", " ", "reflection"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", "False"}], 
       "\[IndentingNewLine]", "\t", ")"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Checking", " ", "one", " ", "or", " ", 
       "more", " ", "reflections", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatrixQ", "@", "hkl"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Multiple", " ", "reflections"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Sow", "[", 
            RowBox[{"check", "@", 
             RowBox[{"hkl", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "hkl"}]}], "}"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Single", " ", "reflection", " ", "input"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"check", "[", "hkl", "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, {
   3.682414147181966*^9, 3.6824141504193163`*^9}, {3.682422054610866*^9, 
   3.682422058841216*^9}, {3.68248889321034*^9, 3.6824889312093363`*^9}, {
   3.682497870103613*^9, 3.682497870838962*^9}, {3.682498439949175*^9, 
   3.682498473226802*^9}, {3.682498545616006*^9, 3.682498583222694*^9}, {
   3.682652463274819*^9, 3.6826524633856573`*^9}, {3.6826525226633253`*^9, 
   3.682652528176805*^9}, {3.682652588129519*^9, 3.682652647587326*^9}, {
   3.682652732220833*^9, 3.682652759824765*^9}, 3.682652789955687*^9, {
   3.682652885565811*^9, 3.682652898414853*^9}, {3.682652934435927*^9, 
   3.682653039668708*^9}, {3.682653269191456*^9, 3.6826532707753983`*^9}, {
   3.6826767635081587`*^9, 3.682676763842099*^9}, {3.6826768070865793`*^9, 
   3.682676845830226*^9}, 3.682742965166976*^9, {3.682769742543735*^9, 
   3.6827697571522007`*^9}, {3.6828236360002527`*^9, 3.682823671982461*^9}, {
   3.6836006968597813`*^9, 3.6836006973216457`*^9}, {3.684060484643417*^9, 
   3.6840604848150167`*^9}, {3.68412495791751*^9, 3.684124960014814*^9}, {
   3.6841250363069344`*^9, 3.6841250440786533`*^9}, {3.684125292582508*^9, 
   3.684125320225617*^9}, {3.68412538876647*^9, 3.6841254623463984`*^9}, {
   3.6841304713418827`*^9, 3.684130478389627*^9}, {3.6841306699315777`*^9, 
   3.684130724975029*^9}, 3.68413089413463*^9, {3.684131204505745*^9, 
   3.6841312582019*^9}, {3.6841313634646997`*^9, 3.684131393356784*^9}, {
   3.6841498342496643`*^9, 3.684149837987958*^9}, {3.684150149112711*^9, 
   3.684150240284457*^9}, {3.684150362867743*^9, 3.684150386986066*^9}, {
   3.684150541179953*^9, 3.6841505423276777`*^9}, {3.6841506380119553`*^9, 
   3.684150651459449*^9}, {3.684151021257702*^9, 3.684151032817149*^9}, {
   3.684151182764062*^9, 3.684151185275826*^9}, {3.684212476920885*^9, 
   3.684212511750373*^9}, {3.684212647039875*^9, 3.684212651448751*^9}, 
   3.6842126863927193`*^9, {3.684233783894244*^9, 3.684233817065721*^9}, {
   3.684233916907439*^9, 3.6842339411075363`*^9}, {3.684234821167623*^9, 
   3.6842348230804157`*^9}, {3.684234886376019*^9, 3.68423497922346*^9}, {
   3.6842353860797777`*^9, 3.6842353905422564`*^9}, {3.6846668654727983`*^9, 
   3.684666891492681*^9}, {3.685082222817321*^9, 3.685082226317616*^9}, 
   3.685084031481782*^9, {3.685350925968895*^9, 3.68535100680781*^9}, {
   3.685351038989582*^9, 3.685351047812945*^9}, {3.685351078290902*^9, 
   3.685351108504094*^9}, {3.685694584031888*^9, 3.685694653828217*^9}, 
   3.685695925701322*^9, {3.68569711141499*^9, 3.685697134185396*^9}, 
   3.685700713456634*^9, {3.685704829547666*^9, 3.685704830086855*^9}, {
   3.685705075633955*^9, 3.685705079583547*^9}, {3.685706365866496*^9, 
   3.685706368934197*^9}, 3.713602168106978*^9, {3.713602392449037*^9, 
   3.713602410077929*^9}, {3.713602464998026*^9, 3.713602530509159*^9}, {
   3.713603876670116*^9, 3.7136038840449266`*^9}, 3.713603942045004*^9, {
   3.7136040206666107`*^9, 3.713604020825574*^9}, {3.713604931237699*^9, 
   3.713604935186516*^9}, {3.713605001324107*^9, 3.713605128920559*^9}, {
   3.713605172705031*^9, 3.713605173103353*^9}, {3.713605233679226*^9, 
   3.7136052559896107`*^9}, {3.713605301141511*^9, 3.713605614517179*^9}, {
   3.713605649172325*^9, 3.7136056930135727`*^9}, {3.713605763281867*^9, 
   3.71360577276626*^9}, {3.7136077822162323`*^9, 3.713607843717113*^9}, {
   3.713607914690593*^9, 3.713607919186142*^9}, {3.713607950954817*^9, 
   3.713607988512763*^9}, {3.7136081182553368`*^9, 3.7136081193341618`*^9}, {
   3.713608165309813*^9, 3.713608212131865*^9}, {3.713608491703147*^9, 
   3.713608597826982*^9}, 3.713608669427478*^9, {3.714457514532886*^9, 
   3.7144575569858093`*^9}, {3.714457667858124*^9, 3.714457669215103*^9}, {
   3.717740903699132*^9, 3.7177409199751043`*^9}, {3.717954022464028*^9, 
   3.717954117702723*^9}, {3.7179541502456493`*^9, 3.717954151084145*^9}, {
   3.7179541877469873`*^9, 3.717954200013671*^9}, {3.717954240531042*^9, 
   3.717954310601891*^9}, {3.717954534557487*^9, 3.717954567347104*^9}, {
   3.7179546616498013`*^9, 3.717954701520533*^9}, 3.717955292653183*^9, {
   3.717955363875353*^9, 3.717955382178829*^9}, {3.717955462743301*^9, 
   3.7179554822550488`*^9}, {3.7179555253191767`*^9, 3.71795554901346*^9}, {
   3.717955579894808*^9, 3.7179556017012653`*^9}, {3.718520157118865*^9, 
   3.71852016386948*^9}, {3.7185266339210453`*^9, 3.718526647279551*^9}, {
   3.718526718817865*^9, 3.7185267198307457`*^9}, {3.718526958506631*^9, 
   3.718526978097324*^9}, {3.71852707035251*^9, 3.718527110758883*^9}, {
   3.7185272311573143`*^9, 3.718527233715704*^9}, {3.718527274972436*^9, 
   3.7185273330257473`*^9}, 3.718527396194458*^9, {3.718527453279973*^9, 
   3.718527477222574*^9}, {3.71852751867883*^9, 3.718527563899838*^9}, {
   3.718527600238863*^9, 3.718527617234693*^9}, 3.718527655228056*^9, {
   3.718528013163574*^9, 3.718528024201454*^9}, {3.7186525272007*^9, 
   3.718652527959489*^9}, {3.718652565120645*^9, 3.718652566214712*^9}, {
   3.718652832245657*^9, 3.7186528407286243`*^9}, {3.718653288762394*^9, 
   3.718653314743916*^9}, {3.7186538005244913`*^9, 3.718653936992763*^9}, {
   3.718654029831277*^9, 3.71865403138211*^9}, {3.7186540805920153`*^9, 
   3.7186540965122004`*^9}, {3.718654395807845*^9, 3.7186544596309137`*^9}, {
   3.718655975082776*^9, 3.718655992074871*^9}, 3.730401919641734*^9, {
   3.7305445959573927`*^9, 3.730544596119605*^9}, {3.734670078980603*^9, 
   3.734670088906211*^9}, {3.734670130909657*^9, 3.7346702172628927`*^9}, {
   3.7346714423800507`*^9, 3.734671497162018*^9}, {3.735032658265091*^9, 
   3.735032660215802*^9}, {3.735033384792354*^9, 3.735033389780846*^9}, 
   3.737968546032345*^9, 3.737968576313637*^9, {3.739170399037306*^9, 
   3.7391704006911793`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[233]:=",ExpressionUUID->"94f30ddb-232e-48db-bb64-dbcefb71e62e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[234]:=",ExpressionUUID->"21745d01-5e4b-4055-8655-98661a94bedc"]
}, Closed]],

Cell[CellGroupData[{

Cell["ToStandardSetting", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105579311858*^9, {3.6827596700257883`*^9, 
   3.6827596859071627`*^9}},ExpressionUUID->"ded90728-21fa-437a-8696-\
d0dd3ec677a2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[235]:=",ExpressionUUID->"0c42b29b-8605-4be1-b2cb-60db6ce45526"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToStandardSetting", "::", "ext"}], "=", 
   "\"\<Invalid extension \[LeftGuillemet]`1`\[RightGuillemet] for this space \
group.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.667811591227736*^9, 3.66810571214802*^9, {3.6681867516522207`*^9, 
   3.668186778354513*^9}, {3.6681868394172163`*^9, 3.6681868614325943`*^9}, {
   3.668187374101748*^9, 3.6681874104278383`*^9}, {3.668187695125526*^9, 
   3.668187730468417*^9}, {3.668188056044814*^9, 3.668188056876872*^9}, {
   3.6681926250344687`*^9, 3.668192625250432*^9}, {3.682755004772629*^9, 
   3.682755006380539*^9}, {3.6827550880482693`*^9, 3.6827550883851967`*^9}, {
   3.682757166386887*^9, 3.682757187609177*^9}, {3.682760997892744*^9, 
   3.6827610174084167`*^9}, {3.682763962473707*^9, 3.682763962814755*^9}, {
   3.684140977908526*^9, 3.6841409783589582`*^9}, {3.684148290703258*^9, 
   3.684148309867588*^9}, {3.684148479444276*^9, 3.684148481151258*^9}, {
   3.685686180336005*^9, 3.6856861809425592`*^9}, {3.7124803378635798`*^9, 
   3.712480360617807*^9}, {3.725962849323039*^9, 3.725962853881053*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"a5f08b51-82ff-4737-a3e1-369cd472067c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[237]:=",ExpressionUUID->"62bf923b-e934-4220-a7e9-59194ea62628"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToStandardSetting", "[", 
   RowBox[{"group_String", ",", "hkl_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "operators", ",", "equivalents", ",", "nonnegative", ",", "list"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Input", " ", "check"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"hkl", ",", "\"\<1hkl\>\"", ",", "\"\<Integer\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"group", ",", "\"\<PointSpaceGroupQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Listing", " ", "all", " ", "symmetry"}], "-", "equivalents"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"operators", "=", 
      RowBox[{"GetSymmetryOperations", "@", 
       RowBox[{"GetLaueClass", "@", "group"}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "@", "operators"}], "\[Equal]", "5"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"operators", "=", 
        RowBox[{"operators", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"equivalents", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "#", "]"}], ".", "hkl"}], "&"}], "/@", 
       "operators"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Selection", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"nonnegative", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"equivalents", ",", 
        RowBox[{
         RowBox[{"AllTrue", "[", 
          RowBox[{"#", ",", "NonNegative"}], "]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nonnegative", "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"list", "=", "nonnegative"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"list", "=", "equivalents"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Last", "@", 
      RowBox[{"SortBy", "[", 
       RowBox[{"list", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106433667647*^9, {3.6827597597787027`*^9, 
   3.682759834796783*^9}, {3.682759891973723*^9, 3.6827599381135283`*^9}, {
   3.6827599744510717`*^9, 3.682760059158255*^9}, 3.682760089218005*^9, 
   3.682760175235159*^9, {3.682760273255459*^9, 3.682760273401188*^9}, {
   3.682760309150391*^9, 3.682760330431353*^9}, {3.682760623312214*^9, 
   3.682760634074464*^9}, {3.6827607536729813`*^9, 3.682760780680396*^9}, 
   3.6827639524031057`*^9, {3.682766856819317*^9, 3.6827668581203957`*^9}, {
   3.682767574024981*^9, 3.6827676450236273`*^9}, {3.683604297716032*^9, 
   3.683604323859149*^9}, {3.6841396193294077`*^9, 3.684139624630027*^9}, {
   3.684213538234778*^9, 3.684213555949724*^9}, 3.684235429735504*^9, {
   3.684493396540483*^9, 3.684493397210763*^9}, {3.684669115218993*^9, 
   3.6846691192528687`*^9}, {3.684669432088505*^9, 3.684669457777866*^9}, {
   3.684669489122911*^9, 3.684669518670082*^9}, {3.684669609081485*^9, 
   3.6846696230904016`*^9}, {3.685082164662752*^9, 3.685082172057521*^9}, 
   3.6850840466699457`*^9, {3.685247146490287*^9, 3.685247154770102*^9}, {
   3.685247286241943*^9, 3.685247305372675*^9}, {3.685247348944471*^9, 
   3.685247396744459*^9}, {3.6852474395342817`*^9, 3.68524751248363*^9}, {
   3.685247568575778*^9, 3.685247596178206*^9}, {3.6852491993387747`*^9, 
   3.685249199534231*^9}, {3.685697524120323*^9, 3.685697526389267*^9}, {
   3.685697566427183*^9, 3.685697604683166*^9}, 3.685700685716364*^9, 
   3.685700721712253*^9, {3.714370012740911*^9, 3.714370023123824*^9}, {
   3.7177409200144033`*^9, 3.717740920023315*^9}, {3.725954106003827*^9, 
   3.72595410715429*^9}, 3.7259582915662403`*^9, {3.725958525342989*^9, 
   3.725958533777025*^9}, 3.725958679383768*^9, {3.727675215252287*^9, 
   3.727675231692677*^9}, {3.727680799461162*^9, 3.727680801984366*^9}, 
   3.7379685211198072`*^9, 3.737968576457651*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[238]:=",ExpressionUUID->"854059f1-7a28-4376-8109-e0ea2628a7a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToStandardSetting", "[", 
   RowBox[{"input_String", ",", 
    RowBox[{"extension_:", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "sg", ",", "fullHM", ",", "SG", ",", "\[IndentingNewLine]", 
      "mainTargetQ", ",", "uniqueInSgQ", ",", "mainSetting", ",", 
      "\[IndentingNewLine]", "output", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "Prepartaion", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "=", "input"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "if", " ", "valid", " ", "input", " ", "symbol"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"InputCheck", "[", 
      RowBox[{"input", ",", "\"\<PointSpaceGroupQ\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "input", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"fullHM", "=", 
      RowBox[{"sg", "[", 
       RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"$SpaceGroups", ",", "fullHM"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"SG", "=", 
      RowBox[{"$SpaceGroups", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Is", " ", "target", " ", "space", " ", "group", " ", "main", " ", 
       RowBox[{"setting", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mainTargetQ", "=", 
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"First", "@", "temp"}]}], "\[LessEqual]", "3"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Is", " ", "target", " ", "symbol", " ", "unique", " ", "among", " ", 
       "all", " ", "space", " ", 
       RowBox[{"groups", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"$SpaceGroups", ",", 
        RowBox[{"sg", "[", 
         RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"temp", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}]}], "===", 
         "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", "fullHM"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Is", " ", "target", " ", "symbol", " ", "unique", " ", "in", " ", 
       "its", " ", "space", " ", 
       RowBox[{"group", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"uniqueInSgQ", "=", 
      RowBox[{
       RowBox[{"Length", "@", "temp"}], "===", "1"}]}], ";", "\t", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"With", " ", "cell", " ", "origin", " ", 
        RowBox[{"tag", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"extension", "=!=", "1"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"output", "=", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}], "<>", 
          "\"\<:\>\"", "<>", 
          RowBox[{"ToString", "@", "extension"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"$GroupSymbolRedirect", ",", "output"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"ToStandardSetting", "::", "ext"}], ",", "extension"}], 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Is", " ", "target", " ", "\"\<best candidate\>\"", " ", "for", " ", 
          "non"}], "-", 
         RowBox[{"main", " ", 
          RowBox[{"symbol", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"!", "uniqueInSgQ"}], "&&", 
        RowBox[{"!", "mainTargetQ"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"mainSetting", "=", 
         RowBox[{"First", "@", 
          RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"sg", "[", "\"\<Setting\>\"", "]"}]}], "===", 
           "mainSetting"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"output", "=", 
           RowBox[{"sg", "[", 
            RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"output", "=", "fullHM"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Uniquely", " ", "formatted", " ", "symbol", " ", "OR", " ", 
         RowBox[{"\"\<main symbol\>\"", "?"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"uniqueInSgQ", "||", "mainTargetQ"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"output", "=", 
        RowBox[{
         RowBox[{"$GroupSymbolRedirect", "[", "output", "]"}], "[", 
         RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "ambiguous"}], ",", " ", 
         RowBox[{"use", " ", "full", " ", 
          RowBox[{"Hermman", "--"}], "Mauguin"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"output", "=", "fullHM"}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "output"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106433667647*^9, {3.6827597597787027`*^9, 
   3.682759834796783*^9}, {3.682759891973723*^9, 3.6827599381135283`*^9}, {
   3.6827599744510717`*^9, 3.682760059158255*^9}, 3.682760089218005*^9, 
   3.682760175235159*^9, {3.682760273255459*^9, 3.682760273401188*^9}, {
   3.682760309150391*^9, 3.682760330431353*^9}, {3.682760623312214*^9, 
   3.682760634074464*^9}, {3.6827607536729813`*^9, 3.682760780680396*^9}, 
   3.6827639524031057`*^9, {3.682766856819317*^9, 3.6827668581203957`*^9}, {
   3.682767574024981*^9, 3.6827676450236273`*^9}, {3.683604297716032*^9, 
   3.683604323859149*^9}, {3.6841396193294077`*^9, 3.684139624630027*^9}, {
   3.684213538234778*^9, 3.684213555949724*^9}, 3.684235429735504*^9, {
   3.684493396540483*^9, 3.684493397210763*^9}, {3.684669115218993*^9, 
   3.6846691192528687`*^9}, {3.684669432088505*^9, 3.684669457777866*^9}, {
   3.684669489122911*^9, 3.684669518670082*^9}, {3.684669609081485*^9, 
   3.6846696230904016`*^9}, {3.685082164662752*^9, 3.685082172057521*^9}, 
   3.6850840466699457`*^9, {3.685247146490287*^9, 3.685247154770102*^9}, {
   3.685247286241943*^9, 3.685247305372675*^9}, {3.685247348944471*^9, 
   3.685247396744459*^9}, {3.6852474395342817`*^9, 3.68524751248363*^9}, {
   3.685247568575778*^9, 3.685247596178206*^9}, {3.6852491993387747`*^9, 
   3.685249199534231*^9}, {3.685697524120323*^9, 3.685697526389267*^9}, {
   3.685697566427183*^9, 3.685697604683166*^9}, 3.685700685716364*^9, 
   3.685700721712253*^9, {3.712472174195052*^9, 3.712472177692658*^9}, {
   3.7124722215936527`*^9, 3.712472222125225*^9}, {3.7124726596033487`*^9, 
   3.712472831548615*^9}, 3.712472876359597*^9, {3.7124729225976963`*^9, 
   3.712472933328292*^9}, {3.712473065774521*^9, 3.712473085606015*^9}, {
   3.7124732297432747`*^9, 3.712473420166718*^9}, {3.7124737265129843`*^9, 
   3.712473738810995*^9}, {3.712473783794465*^9, 3.712473809180954*^9}, {
   3.7124738405360813`*^9, 3.7124739622882833`*^9}, {3.7124740164607363`*^9, 
   3.7124740355848503`*^9}, {3.712474526311514*^9, 3.71247454749196*^9}, {
   3.712474580437092*^9, 3.712474582276721*^9}, {3.7124748834875793`*^9, 
   3.712474934322382*^9}, {3.712474972745503*^9, 3.71247497289651*^9}, {
   3.7124750051489697`*^9, 3.712475018976412*^9}, {3.71248021179641*^9, 
   3.7124802412684507`*^9}, {3.712480291485821*^9, 3.712480313250639*^9}, 
   3.712480368500133*^9, {3.712480407676384*^9, 3.712480415123426*^9}, {
   3.712480531005803*^9, 3.7124806041575623`*^9}, {3.7124806490537233`*^9, 
   3.712480670116323*^9}, {3.712481025893857*^9, 3.712481064923984*^9}, {
   3.7143700581623793`*^9, 3.714370126083304*^9}, {3.714917865649086*^9, 
   3.7149179313574133`*^9}, {3.7149179630125713`*^9, 3.714917969850429*^9}, {
   3.714917999909767*^9, 3.714918043458394*^9}, {3.71491808323484*^9, 
   3.7149180863296623`*^9}, {3.7149181163613*^9, 3.714918121665152*^9}, 
   3.716618459915923*^9, {3.716618497717318*^9, 3.716618500665338*^9}, {
   3.716618556633456*^9, 3.7166185688222218`*^9}, 3.7166186120507097`*^9, {
   3.716623449771859*^9, 3.716623453353243*^9}, {3.716623558778885*^9, 
   3.716623579014586*^9}, {3.716623611307054*^9, 3.7166236149186153`*^9}, {
   3.716623666697957*^9, 3.716623666886039*^9}, {3.7166245086791477`*^9, 
   3.716624512246523*^9}, {3.716626230555719*^9, 3.7166262307671556`*^9}, {
   3.716626362872368*^9, 3.716626366478477*^9}, {3.716626401845291*^9, 
   3.716626410580432*^9}, {3.716626461873996*^9, 3.7166265694576187`*^9}, {
   3.7177409200415707`*^9, 3.717740920085593*^9}, {3.725954168642559*^9, 
   3.725954174585816*^9}, {3.7259544475654078`*^9, 3.725954453397047*^9}, {
   3.725954529596027*^9, 3.725954536170638*^9}, {3.725954897275111*^9, 
   3.7259549057293167`*^9}, {3.725955820678866*^9, 3.7259558389101562`*^9}, {
   3.725956228516712*^9, 3.7259562736346397`*^9}, {3.72595638572224*^9, 
   3.725956390152341*^9}, {3.725956444608553*^9, 3.7259565050163183`*^9}, {
   3.725956540351451*^9, 3.725956552420847*^9}, {3.7259566391886063`*^9, 
   3.725956744409425*^9}, {3.7259568065361633`*^9, 3.725956853631604*^9}, {
   3.725957068004551*^9, 3.7259571342078733`*^9}, {3.7259575859913692`*^9, 
   3.725957588447097*^9}, 3.725957938529029*^9, {3.725957985144517*^9, 
   3.725957988807857*^9}, {3.725958295593363*^9, 3.725958310575184*^9}, 
   3.725958500965064*^9, {3.7259585374199533`*^9, 3.725958540370281*^9}, 
   3.725958624258267*^9, {3.725958658665193*^9, 3.725958661783428*^9}, {
   3.725958708575451*^9, 3.7259587087667017`*^9}, {3.725960536390708*^9, 
   3.725960556380581*^9}, {3.725962451509495*^9, 3.725962508178426*^9}, {
   3.725962544908064*^9, 3.725962545122154*^9}, {3.725962621129652*^9, 
   3.725962629171185*^9}, {3.7259626800164413`*^9, 3.7259627547331057`*^9}, {
   3.725962864044545*^9, 3.725962864194646*^9}, {3.727675216158976*^9, 
   3.7276752323227167`*^9}, 3.727682066238936*^9, {3.728674616539852*^9, 
   3.728674623693241*^9}, {3.728674704063981*^9, 3.7286747063174458`*^9}, {
   3.7286747572315702`*^9, 3.728674771781168*^9}, {3.728674827973637*^9, 
   3.728674830483848*^9}, {3.728674895642453*^9, 3.7286749553686237`*^9}, {
   3.728675135911109*^9, 3.7286751520763397`*^9}, {3.7286752731619453`*^9, 
   3.728675273385056*^9}, {3.730544614406321*^9, 3.7305446146093597`*^9}, {
   3.7438654567386503`*^9, 3.7438654568231373`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[239]:=",ExpressionUUID->"e84457cb-6a86-4c41-968e-f5335ea663b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[240]:=",ExpressionUUID->"680d1989-ce15-4dea-afc0-d619281fd301"]
}, Closed]],

Cell[CellGroupData[{

Cell["UnitCellTransformation", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105575055373*^9, {3.682754675215427*^9, 3.682754677485675*^9}, {
   3.6827632401424837`*^9, 3.682763247126801*^9}, 3.682763763856205*^9, 
   3.6827638067251377`*^9, {3.704436680457919*^9, 3.70443668392809*^9}, 
   3.7044395288318233`*^9},ExpressionUUID->"dcbfee7f-15a0-4d52-b21d-\
03e41b1f4ad2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[241]:=",ExpressionUUID->"f35d0055-6f60-4e7b-9582-3703a2e836cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "command"}], "=", 
   "\"\<Transformation command \[LeftGuillemet]`1`\[RightGuillemet] not \
recognised.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "invalid"}], "=", 
   "\"\<The setting \[LeftGuillemet]`1`\[RightGuillemet] is invalid.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "invalidSG"}], "=", 
   "\"\<The setting \[LeftGuillemet]`1`\[RightGuillemet] is invalid for this \
particular space group.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "na"}], "=", 
   "\"\<Input not applicable for the `1` system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "diffset"}], "=", 
   "\"\<Setting mismatch between source, `1`, and target, `2`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "sg"}], "=", 
   "\"\<Could not interpret \[LeftGuillemet]`1`\[RightGuillemet] as a space \
group symbol.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "differentsg"}], "=", 
   "\"\<The source space group, \[LeftGuillemet]`1`\[RightGuillemet] \
(no.`2`), and the target space group, \[LeftGuillemet]`3`\[RightGuillemet] \
(no. `4`), are not the same.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "support"}], "=", 
   "\"\<Transformation of the input is not supported.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitCellTransformation", "::", "target"}], "=", 
   "\"\<Could not determine target space group.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnitCellTransformation", "::", "one"}], "=", 
    "\"\<This space group, \[LeftGuillemet]`1`\[RightGuillemet] (no. `2`), \
has no alternative representations.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "UnitCellTransformation"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ReturnP\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<CustomP\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719819749369479*^9, 3.719819754436316*^9}, {
  3.719821718288604*^9, 3.719821721509223*^9}, {3.726153764130487*^9, 
  3.726153765873062*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"19292abe-2104-4d0f-99a8-cba5b75fc1ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[253]:=",ExpressionUUID->"bbd9b0e1-524f-40bb-882a-72e1cc5a55a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnitCellTransformation", "[", 
   RowBox[{"crystal_String", ",", "userinput___"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "1.", " ", "Input", " ", "check", " ", 
       "and", " ", "preparation", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"1.", 
        RowBox[{"A", ".", " ", "Load"}], " ", "crystal", " ", "metric"}], ",",
        " ", 
       RowBox[{
       "space", " ", "group", " ", "and", " ", "crystal", " ", "system"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "G", ",", "G0", ",", "sg", ",", "sg0", ",", "sourceSG", ",", "fullHM", 
      ",", "posSG", ",", "SG", ",", "fullHMs", ",", "sourceSGnumber", ",", 
      "system", ",", "mainSourceQ", ",", "\[IndentingNewLine]", "P", ",", 
      "P1", ",", "P2", ",", "p", ",", "\[IndentingNewLine]", "centList", ",", 
      "axpList", ",", "tetList", ",", "hex3List", ",", "hexList", ",", 
      "monoList", ",", "\[IndentingNewLine]", "sourceSetting", ",", 
      "targetSetting", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"B", ".", " ", "Keep"}], " ", "notes", " ", "if", " ", 
        "any"}], " ", "*)"}], "\[IndentingNewLine]", "notes0", ",", "notes", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"C", ".", " ", "Process"}], " ", "input", " ", "syntax", " ", 
        "and", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
      "inputRules", ",", "inputString", ",", "returnP", ",", "customP", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"D", ".", " ", "Interpret"}], " ", "space", " ", "group", " ",
         "from", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", 
      "targetSG", ",", "needtargetSG", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", "E", " ", "Process", " ", "source", " ", "setting"}], 
       " ", "*)"}], "\[IndentingNewLine]", "sourceCentring", ",", "notesinfo",
       ",", "sourceCell", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", "F", " ", "Process", " ", "target", " ", "setting"}], 
       " ", "*)"}], "\[IndentingNewLine]", "allowed", ",", "cmds", ",", "na", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"G", ".", " ", "Validating"}], " ", "input", " ", "values"}], 
       " ", "*)"}], "\[IndentingNewLine]", "targetCentring", ",", 
      "targetAxis", ",", "targetCC", ",", "targetAP", ",", "targetCell", ",", 
      "targetRS", ",", "\[IndentingNewLine]", "targetO", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"H", ".", " ", "Check"}], " ", "setting", " ", "constraints", 
        " ", "on", " ", "certain", " ", "space", " ", "groups"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"J", ".", " ", "Determining"}], " ", "new", " ", "space", " ",
         "group", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", 
      "targetSGnumber", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1.", 
        RowBox[{"K", ".", " ", "Common"}], " ", "transformation", " ", 
        "procedures"}], " ", "*)"}], "\[IndentingNewLine]", 
      "procedureCellCentring", ",", "procedureCellOrigin", ",", "shift", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "2.", " ", "Determining", " ", 
        "correct", " ", "transformation", " ", "matrices", " ", "*", 
        RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"A", ".", " ", "Triclinic"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"B", ".", " ", "Monoclinic"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "cmd", ",", "Q", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"C", ".", " ", "Orthorhombic"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"D", ".", " ", "Tetragonal"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"E", ".", " ", "Hexagonal"}], " ", "crystal", " ", "family"}],
        " ", "*)"}], "\[IndentingNewLine]", "sourceRS", ",", "M", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"2.", 
        RowBox[{"F", ".", " ", "Cubic"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "3.", " ", "Carrying", " ", "out", " ",
         "transformations", " ", "*", 
        RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"3.", 
        RowBox[{"A", ".", " ", "Preparations"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "q", ",", "newlattice", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"3.", 
        RowBox[{"B", ".", " ", "Transforming"}], " ", "coordinates", " ", 
        "and", " ", "ADPs"}], " ", "*)"}], "\[IndentingNewLine]", "xyz", ",", 
      "newxyz", ",", "adps", ",", "U", ",", "n0", ",", "n", ",", "newU", ",", 
      "u", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "4.", " ", "Overwriting", " ", "entry",
         " ", "in", " ", "$CrystalData", " ", "*", 
        RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "targetFullHM", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", "-"}], "*", " ", "5.", " ", "Display", " ", "*", 
        RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Dummy", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", "temp", ",", "x", ",", "y", ",", "i"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "1.", " ", "Input", " ", "check", " ", 
      "and", " ", "preparation", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"1.", 
       RowBox[{"A", ".", " ", "Load"}], " ", "crystal", " ", "metric"}], ",", 
      " ", 
      RowBox[{
      "space", " ", "group", " ", "and", " ", "crystal", " ", "system"}]}], 
     " ", "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"InputCheck", "[", 
      RowBox[{"crystal", ",", "\"\<GetCrystalSpaceGroup\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"G", "=", 
      RowBox[{"G0", "=", 
       RowBox[{"GetCrystalMetric", "@", "crystal"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"sg0", "=", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"crystal", ",", "\"\<SpaceGroup\>\""}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sg", "=", 
      RowBox[{"$GroupSymbolRedirect", "[", "sg", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sourceSG", "=", 
      RowBox[{"fullHM", "=", 
       RowBox[{"sg", "[", 
        RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"posSG", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"$SpaceGroups", ",", "fullHM"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"SG", "=", 
      RowBox[{"$SpaceGroups", "[", 
       RowBox[{"posSG", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"fullHMs", "=", 
      RowBox[{"SG", "[", 
       RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"sourceSGnumber", "=", 
      RowBox[{"SG", "[", "\"\<SpaceGroupNumber\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"system", "=", 
      RowBox[{"SG", "[", "\"\<CrystalSystem\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"mainSourceQ", "=", 
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"First", "@", "posSG"}]}], "\[LessEqual]", "3"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Default", " ", "transformation", " ", "matrices", " ", "and", " ", 
       "origin", " ", "shift"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"P", "=", 
      RowBox[{"P1", "=", 
       RowBox[{"P2", "=", 
        RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"p", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Frequently", " ", "used", " ", "lists"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"centList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<P\>\"", ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", 
        ",", "\"\<F\>\"", ",", "\"\<I\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"axpList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<abc\>\"", ",", "\"\<ba-c\>\"", ",", "\"\<cab\>\"", ",", 
        "\"\<-cba\>\"", ",", "\"\<bca\>\"", ",", "\"\<a-cb\>\""}], "}"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"tetList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<P\>\"", ",", "\"\<I\>\"", ",", "\"\<C1\>\"", ",", "\"\<F1\>\"", 
        ",", "\"\<C2\>\"", ",", "\"\<F2\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"hex3List", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{"\"\<R1\>\"", ",", "\"\<R2\>\"", ",", "\"\<R3\>\""}], "}"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"hexList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<C1\>\"", ",", "\"\<C2\>\"", ",", "\"\<C3\>\"", ",", "\"\<H1\>\"", 
        ",", "\"\<H2\>\"", ",", "\"\<H3\>\"", ",", "\"\<D1\>\"", ",", 
        "\"\<D2\>\""}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"monoList", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
       "\"\<Cb1\>\"", ",", "\"\<Cb2\>\"", ",", "\"\<Cb3\>\"", ",", 
        "\"\<Ac1\>\"", ",", "\"\<Ac2\>\"", ",", "\"\<Ac3\>\""}], "}"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Miscellaneous", " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"sourceSetting", "=", 
      RowBox[{"targetSetting", "=", 
       RowBox[{"<|", "|>"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"B", ".", " ", "Keep"}], " ", "notes", " ", "if", " ", "any"}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"notes0", "=", 
      RowBox[{"notes", "=", 
       RowBox[{"$CrystalData", "[", 
        RowBox[{"crystal", ",", "\"\<Notes\>\""}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "@", "notes0"}], ",", 
       RowBox[{"notes0", "=", 
        RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Ignore", " ", "cell", " ", "descriptions", " ", "from", " ", 
       "transformations"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"notes0", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"notes0", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<Origin choice\>\"", ",", "\"\<Lattice description\>\"", ",", 
             "\"\<Multiple cell symbol\>\"", ",", "\[IndentingNewLine]", 
             "\"\<Rhombohedral setting\>\"", ",", 
             "\"\<Rhombohedral cell transformed\>\"", ",", 
             "\[IndentingNewLine]", "\"\<Hexagonal cell transformed\>\"", 
             ",", "\"\<Custom centring\>\""}], "}"}]}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"C", ".", " ", "Process"}], " ", "input", " ", "syntax", " ", 
       "and", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"inputRules", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "userinput", "}"}], ",", "_Rule"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"inputString", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"{", "userinput", "}"}], ",", "_String"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"#", "===", "0"}], ",", "Null", ",", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"#", "===", "1"}], ",", 
         RowBox[{"inputString", "=", 
          RowBox[{"First", "@", "inputString"}]}], ",", "\[IndentingNewLine]",
          "\t\t", "True", ",", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
            "inputString"}], "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t\t", 
        "]"}], "&"}], "@", 
      RowBox[{"Length", "@", "inputString"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Save", " ", "option", " ", "settings"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"returnP", "=", 
      RowBox[{"inputRules", "[", "\"\<ReturnP\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"customP", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"inputRules", ",", "\"\<CustomP\>\"", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Remove", " ", "options", " ", "from", " ", "other", " ", "settings"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"KeyDropFrom", "[", 
      RowBox[{"inputRules", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ReturnP\>\"", ",", "\"\<CustomP\>\"", ",", 
         "\"\<CustomSymbol\>\""}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"D", ".", " ", "Interpret"}], " ", "space", " ", "group", " ", 
       "from", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "No"}], " ", "input", " ", 
       RowBox[{"commands", " ", "--"}], " ", "prompt", " ", 
       RowBox[{"dialogue", "/", "UI"}], " ", 
       RowBox[{"(", "TODO", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "Custom"}], " ", "transformation", " ", 
       "matrix"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"customP", "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"P1", "=", "customP"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MatrixQ", "@", "P1"}]}], ",", 
          RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", "P1"}],
             "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"targetSG", "=", "sourceSG"}], 
        RowBox[{"(*", " ", 
         RowBox[{"Use", " ", "same", " ", "space", " ", "group"}], " ", 
         "*)"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}]}]}], "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "Interpret"}], " ", "string", " ", "as", " ", 
       "target", " ", "space", " ", "group"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inputString", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "if", " ", "valid", " ", "space", " ", "group", " ", 
         "symbol"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "@", 
           RowBox[{"$GroupSymbolRedirect", "[", "inputString", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "sg"}], ",", 
             "inputString"}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"targetSG", "=", "inputString"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iv", ".", " ", "Parse"}], " ", "input", " ", "as", " ", 
       "setting", " ", "commands"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inputRules", "=!=", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"needtargetSG", "=", "True"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "whether", " ", "Hall", " ", "symbol", " ", "has", " ", 
         "been", " ", "used"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"$SpaceGroups", ",", "targetSG"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"temp", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "===", 
             "\"\<HallString\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"targetSG", "=", 
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"$SpaceGroups", "@@@", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Most", "@", 
                 RowBox[{"First", "@", "temp"}]}]}], "]"}], "[", 
              RowBox[{"\"\<Name\>\"", ",", "\"\<Symbol\>\""}], "]"}]}]}], 
           "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", "E", " ", "Process", " ", "source", " ", "setting"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "Load"}], " ", "source", " ", "setting", " ", 
       "from", " ", "source", " ", "space", " ", "group"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"sourceSetting", "=", 
      RowBox[{
       RowBox[{"$GroupSymbolRedirect", "[", "sourceSG", "]"}], "[", 
       "\"\<Setting\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "Check"}], " ", "if", " ", "space", " ", 
       "group", " ", "has", " ", "alternative", " ", "settings"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sourceSetting", "===", 
         RowBox[{"<|", "|>"}]}], "&&", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Exception", ":", " ", 
          RowBox[{"Special", " ", "multiple", " ", "cells"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Tetragonal\>\"", ",", "\"\<Hexagonal\>\""}], "}"}], 
           ",", "system"}], "]"}]}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnitCellTransformation", "::", "one"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"GetSymmetryData", "[", 
           RowBox[{"sourceSG", ",", "\"\<Symbol\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", "sourceSGnumber"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "Check"}], " ", "cell", " ", "origin", " ", 
       "from", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"temp", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"sg0", ",", 
        RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"temp", "===", "\"\<:2\>\""}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"sourceSetting", ",", 
         RowBox[{"\"\<CellOrigin\>\"", "\[Rule]", "2"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iv", ".", " ", 
        RowBox[{"Checking", " ", "'"}]}], 
       RowBox[{"Notes", "'"}], " ", "for", " ", "info", " ", "on", " ", 
       "input", " ", "setting"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"notesinfo", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListQ", "@", "notes"}], "||", 
        RowBox[{"StringQ", "@", "notes"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Rhombohedral", " ", "setting"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"AnyTrue", "[", 
             RowBox[{"notes", ",", 
              RowBox[{
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "s", ",", 
                 RowBox[{"IgnoreCase", "\[Rule]", "True"}]}], "]"}], "&"}]}], 
             "]"}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"notesinfo", ",", 
              RowBox[{"\"\<RhombohedralSetting\>\"", "\[Rule]", "s"}]}], 
             "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<reverse\>\"", ",", "\"\<obverse\>\""}], "}"}]}], 
           "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"notesinfo", ",", "\"\<RhombohedralSetting\>\""}], "]"}], 
           "||", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"sourceSetting", ",", "\"\<RhombohedralSetting\>\""}], 
            "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notesinfo", ",", 
            RowBox[{"\"\<MultipleCell\>\"", "\[Rule]", "\"\<R\>\""}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Multiple", " ", "cell", " ", "designation"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"StringCases", "[", 
           RowBox[{"notes", ",", 
            RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"x", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<R\>\"", ",", "\"\<C\>\"", ",", "\"\<F\>\"", ",", 
                   "\"\<H\>\"", ",", "\"\<D\>\""}], "}"}], "~~", 
                 "DigitCharacter"}], ")"}]}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"x", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<A\>\"", ",", "\"\<C\>\""}], "}"}], "~~", 
                 RowBox[{"{", 
                  RowBox[{"\"\<b\>\"", ",", "\"\<c\>\""}], "}"}], "~~", 
                 "DigitCharacter"}], ")"}]}], ",", "\[IndentingNewLine]", 
              "\t\t", 
              RowBox[{"x", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<C\>\"", ",", "\"\<F\>\""}], "}"}], "~~", 
                 RowBox[{"{", 
                  RowBox[{"\"\<1\>\"", ",", "\"\<2\>\""}], "}"}]}], ")"}]}], 
              ",", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
               RowBox[{
               "\"\<monoclinic \>\"", "~~", "x__", "~~", "\"\< cell\>\""}], 
               "\[RuleDelayed]", "x"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notesinfo", ",", 
            RowBox[{"\"\<MultipleCell\>\"", "\[Rule]", 
             RowBox[{"First", "@", "temp"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Custom", " ", "centring"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"StringCases", "[", 
           RowBox[{"notes", ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"\"\<Custom centring: \>\"", "~~", "x_"}], 
             "\[RuleDelayed]", "x"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notesinfo", ",", 
            RowBox[{"\"\<CellCentring\>\"", "\[Rule]", 
             RowBox[{"First", "@", "temp"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Cell", " ", "origin"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"StringCases", "[", 
           RowBox[{"notes", ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<O\>\"", ",", "\"\<o\>\""}], "}"}], "~~", 
              "\"\<rigin choice\>\"", "~~", "__", "~~", 
              RowBox[{"x", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
             "x"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"temp", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notesinfo", ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"\"\<CellOrigin\>\"", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"First", "@", "temp"}]}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Checking", " ", "gathered", " ", "data", " ", "for", " ", "crucial",
           " ", "source", " ", "information"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"notesinfo", "\[NotEqual]", 
           RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"temp", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Keys", "@", "notesinfo"}], ",", 
              RowBox[{"Keys", "@", "sourceSetting"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"sourceSetting", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{"notesinfo", ",", "temp"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Process", " ", "cell", " ", "centring", " ", "setting", " ", 
             "if", " ", "contained", " ", "in", " ", "notes"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"sourceCentring", "=", 
            RowBox[{"notesinfo", "[", "\"\<CellCentring\>\"", "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"KeyDropFrom", "[", 
            RowBox[{"sourceSetting", ",", "\"\<CellCentring\>\""}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Process", " ", "multiple", " ", "cell", " ", "if", " ", 
             "contained", " ", "in", " ", "notes"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"sourceCell", "=", 
            RowBox[{"notesinfo", "[", "\"\<MultipleCell\>\"", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Process", " ", "cell", " ", "rhombohedral", " ", "setting", " ", 
             "if", " ", "contained", " ", "in", " ", "notes"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"sourceRS", "=", 
            RowBox[{"notesinfo", "[", "\"\<RhombohedralSetting\>\"", "]"}]}], 
           ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"KeyDropFrom", "[", 
            RowBox[{"sourceSetting", ",", "\"\<RhombohedralSetting\>\""}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", "F", " ", "Process", " ", "target", " ", "setting"}], " ",
       "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inputRules", "=!=", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"a", ".", " ", "Setting"}], " ", "commands", " ", "given", 
         " ", "in", " ", "association"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"targetSetting", "=", "inputRules"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Checking", " ", "commands"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"allowed", "=", 
         RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
          "\"\<UniqueAxis\>\"", ",", "\"\<CellChoice\>\"", ",", 
           "\"\<AxisPermutation\>\"", ",", "\[IndentingNewLine]", "\t\t\t", 
           "\"\<CellCentring\>\"", ",", "\"\<MultipleCell\>\"", ",", 
           "\[IndentingNewLine]", "\t\t\t", "\"\<RhombohedralSetting\>\"", 
           ",", "\"\<CellOrigin\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\t\t\t", 
        RowBox[{"cmds", "=", 
         RowBox[{"Keys", "@", "targetSetting"}]}], ";", "\[IndentingNewLine]",
         "\t\t\t", 
        RowBox[{"na", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"cmds", ",", "allowed"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"na", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "command"}], ",", 
             RowBox[{"First", "@", "na"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Checking", " ", "usefullness", " ", "of", " ", "commands"}],
          " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"temp", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"system", "===", "\"\<Triclinic\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", "\"\<CellCentring\>\"", "}"}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"system", "===", "\"\<Monoclinic\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"\"\<UniqueAxis\>\"", ",", "\"\<CellChoice\>\""}], "}"}], 
           ",", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"system", "===", "\"\<Orthorhombic\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
            "\"\<AxisPermutation\>\"", ",", "\"\<CellCentring\>\"", ",", 
             "\"\<CellOrigin\>\""}], "}"}], ",", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"system", "===", "\"\<Tetragonal\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
            "\"\<CellCentring\>\"", ",", "\"\<MultipleCell\>\"", ",", 
             "\"\<CellOrigin\>\""}], "}"}], ",", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"system", "===", "\"\<Trigonal\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
            "\"\<MultipleCell\>\"", ",", "\"\<RhombohedralSetting\>\""}], 
            "}"}], ",", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"system", "===", "\"\<Hexagonal\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", "\"\<MultipleCell\>\"", "}"}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"system", "===", "\"\<Cubic\>\""}], ",", 
           "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"\"\<CellCentring\>\"", ",", "\"\<CellOrigin\>\""}], 
            "}"}]}], "\[IndentingNewLine]", "\t\t\t", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"targetSetting", "=", 
         RowBox[{"DeleteMissing", "@", 
          RowBox[{"targetSetting", "[", 
           RowBox[{"[", "temp", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"targetSetting", "===", 
           RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "na"}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"ToLowerCase", "@", "system"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Setting"}], " ", "extracted", " ", "from", 
         " ", "target", " ", "space", " ", "group"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"targetSetting", "=", 
        RowBox[{
         RowBox[{"$GroupSymbolRedirect", "[", "targetSG", "]"}], "[", 
         "\"\<Setting\>\"", "]"}]}]}], "\t\t\t", "\[IndentingNewLine]", 
      "\t\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     
     RowBox[{"(*", " ", 
      RowBox[{
      "Supply", " ", "with", " ", "current", " ", "settings", " ", "if", " ", 
       "unspecified", " ", "in", " ", "input"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"targetSetting", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"sourceSetting", ",", "targetSetting"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Exception", ":", " ", 
       RowBox[{
        RowBox[{"No", " ", "'"}], 
        RowBox[{"RhombohedralSetting", "'"}], " ", 
        RowBox[{"for", " ", "'"}], 
        RowBox[{"R", "'"}], " ", "cell"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"targetSetting", "[", "\"\<MultipleCell\>\"", "]"}], "===", 
        "\"\<R\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{"targetSetting", ",", "\"\<RhombohedralSetting\>\""}], 
        "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"G", ".", " ", "Validating"}], " ", "input", " ", "values"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetCentring", "=", 
      RowBox[{"targetSetting", "[", "\"\<CellCentring\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetCentring"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
           "centList", ",", "\[IndentingNewLine]", "\t", "targetCentring"}], 
           "]"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
            "\[IndentingNewLine]", "\t", "targetCentring"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"UniqueAxis", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetAxis", "=", 
      RowBox[{"targetSetting", "[", "\"\<UniqueAxis\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetAxis"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\""}], 
              "}"}], ",", "targetAxis"}], "]"}]}], ",", "\[IndentingNewLine]",
           "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
             "\[IndentingNewLine]", "\t", "targetAxis"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"targetAxis", "=", 
         RowBox[{"ToLowerCase", "@", "targetAxis"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "'"}], 
       RowBox[{"CellChoice", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetCC", "=", 
      RowBox[{"targetSetting", "[", "\"\<CellChoice\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetCC"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "targetCC"}], 
           "]"}]}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
            "\[IndentingNewLine]", "\t", "targetCC"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iv", ".", " ", "'"}], 
       RowBox[{"AxisPermutation", "'"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"targetAP", "=", 
      RowBox[{"targetSetting", "[", "\"\<AxisPermutation\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetAP"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "if", " ", "string"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringQ", "@", "targetAP"}]}], ",", "\[IndentingNewLine]",
           "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
             "\[IndentingNewLine]", "\t", "targetAP"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Support", " ", "for", " ", "various", " ", "input", " ", "forms"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"targetAP", "=", 
         RowBox[{"ToLowerCase", "@", 
          RowBox[{"StringReplace", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{"targetAP", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\"\<\!\(\*OverscriptBox[\(c\), \(_\)]\)\>\"", "\[Rule]", 
               "\"\<-c\>\""}], ",", 
              RowBox[{
              "\"\<\!\(\*OverscriptBox[\(C\), \(_\)]\)\>\"", "\[Rule]", 
               "\"\<-C\>\""}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "setting", " ", "value"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"axpList", ",", "targetAP"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"targetSetting", "[", "\"\<AxisPermutation\>\"", "]"}]}],
             "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Update", " ", "'"}], 
          RowBox[{"targetSetting", "'"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"targetSetting", "[", "\"\<AxisPermutation\>\"", "]"}], "=", 
         "targetAP"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"v", ".", " ", "'"}], 
       RowBox[{"MultipleCell", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetCell", "=", 
      RowBox[{"targetSetting", "[", "\"\<MultipleCell\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetCell"}]}], ",", "\[IndentingNewLine]",
        "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Depending", " ", "on", " ", "crystal", " ", "system"}], 
         "..."}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"system", "===", "\"\<Tetragonal\>\""}], ",", "tetList", 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"system", "===", "\"\<Trigonal\>\""}], "||", 
            RowBox[{"system", "===", "\"\<Hexagonal\>\""}]}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<P\>\"", ",", "\"\<R\>\""}], "}"}], ",", 
              "hex3List", ",", "hexList", ",", "monoList"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"UnitCellTransformation", "::", "na"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"ToLowerCase", "@", "system"}]}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "setting", " ", "value"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"temp", ",", "targetCell"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalidSG"}], ",", 
             "\[IndentingNewLine]", "\t", "targetCell"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"vi", ".", " ", "'"}], 
       RowBox[{"RhombohedralSetting", "'"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"targetRS", "=", 
      RowBox[{"inputRules", "[", "\"\<RhombohedralSetting\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetRS"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"targetRS", "=", 
         RowBox[{"ToLowerCase", "@", "targetRS"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Check", " ", "setting", " ", "value"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<obverse\>\"", ",", "\"\<reverse\>\""}], "}"}], ",",
              "targetRS"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "targetSetting", "[", "\"\<RhombohedralSetting\>\"", "]"}]}], 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Update", " ", "'"}], 
          RowBox[{"targetSetting", "'"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"targetSetting", "[", "\"\<RhombohedralSetting\>\"", "]"}], 
         "=", "targetRS"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"vii", ".", " ", "'"}], 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"targetO", "=", 
      RowBox[{"targetSetting", "[", "\"\<CellOrigin\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetO"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], ",", "targetO"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"UnitCellTransformation", "::", "invalid"}], ",", 
            "\[IndentingNewLine]", "\t", "targetO"}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"H", ".", " ", "Check"}], " ", "setting", " ", "constraints", 
       " ", "on", " ", "certain", " ", "space", " ", "groups"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "Target"}], " ", "setting", " ", "must", " ", 
       "be", " ", "a", " ", "subset", " ", "of", " ", "space", " ", "group", 
       " ", "settings"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"SubsetQ", "@@", 
          RowBox[{"Keys", "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Which", "[", 
              RowBox[{"(*", " ", 
               RowBox[{"Exceptions", ":", " ", 
                RowBox[{
                "Cell", " ", "centring", " ", "and", " ", "special", " ", 
                 "multiple", " ", "cells"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<Tetragonal\>\"", ",", "\"\<Hexagonal\>\""}], 
                  "}"}], ",", "system"}], "]"}], ",", "\[IndentingNewLine]", 
               "\t", 
               RowBox[{"KeyDrop", "[", 
                RowBox[{"targetSetting", ",", "\"\<MultipleCell\>\""}], "]"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Monoclinic\>\"", ",", "\"\<Orthorhombic\>\"", ",", 
                   "\"\<Tetragonal\>\"", ",", "\"\<Cubic\>\""}], "}"}], ",", 
                 "system"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"KeyDrop", "[", 
                RowBox[{"targetSetting", ",", "\"\<CellCentring\>\""}], "]"}],
                ",", "\[IndentingNewLine]", "True", ",", 
               "\[IndentingNewLine]", "\t", "targetSetting"}], "]"}]}], 
            "}"}]}]}], "\[IndentingNewLine]", "\t", ")"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnitCellTransformation", "::", "diffset"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Keys", "@", "sourceSetting"}], ",", 
          RowBox[{"Keys", "@", "targetSetting"}]}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"J", ".", " ", "Determining"}], " ", "new", " ", "space", " ", 
       "group", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "Determine"}], " ", "the", " ", "target", " ", 
       "space", " ", "group", " ", "from", " ", "setting", " ", "if", " ", 
       "needed"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"needtargetSG", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Main", " ", 
         RowBox[{"entry", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "@", 
           RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}]}], "===", 
          RowBox[{"Sort", "@", "targetSetting"}]}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"targetSG", "=", 
          RowBox[{"SG", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinFull\>\""}], 
           "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Special", " ", "multiple", " ", 
           RowBox[{"cell", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"{", 
                 RowBox[{"tetList", ",", 
                  RowBox[{"{", "\"\<R\>\"", "}"}], ",", "hex3List", ",", 
                  "hexList", ",", "monoList"}], "}"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t\t\t", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"targetSG", "=", "sourceSG"}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"targetSGnumber", "=", "sourceSGnumber"}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"Goto", "[", "\"\<CheckSGformat\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "\t\t\t", "]"}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Check", " ", "alternatives"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"temp", "=", 
           RowBox[{"SG", "[", 
            RowBox[{"[", "\"\<AlternativeSettings\>\"", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"While", "[", 
           RowBox[{"True", ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", ">", 
                RowBox[{"Length", "@", "temp"}]}], ",", "\[IndentingNewLine]",
                "\t\t", 
               RowBox[{
                RowBox[{"Message", "[", 
                 RowBox[{"UnitCellTransformation", "::", "target"}], "]"}], 
                ";", 
                RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sort", "@", 
                 RowBox[{"temp", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "\"\<Setting\>\""}], "]"}], "]"}]}], "===", 
                RowBox[{"Sort", "@", "targetSetting"}]}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{"targetSG", "=", 
                 RowBox[{"temp", "[", 
                  RowBox[{"[", 
                   RowBox[{
                   "i", ",", "\"\<Name\>\"", ",", 
                    "\"\<HermannMauguinFull\>\""}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"i", "++"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
        "\t\t", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "Check"}], " ", "if", " ", "source", " ", 
       "and", " ", "target", " ", "are", " ", "same", " ", "space", " ", 
       "group"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"targetSGnumber", "=", 
      RowBox[{"GetSymmetryData", "[", 
       RowBox[{"targetSG", ",", "\"\<SpaceGroupNumber\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sourceSGnumber", "\[NotEqual]", "targetSGnumber"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnitCellTransformation", "::", "differentsg"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"GetSymmetryData", "[", 
           RowBox[{"sourceSG", ",", "\"\<Symbol\>\""}], "]"}], ",", 
          "sourceSGnumber", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"GetSymmetryData", "[", 
           RowBox[{"targetSG", ",", "\"\<Symbol\>\""}], "]"}], ",", 
          "targetSGnumber"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "Check"}], " ", "whether", " ", "to", " ", 
       "use", " ", "formatted", " ", "symbol"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<CheckSGformat\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"targetSG", "=", 
      RowBox[{"ToStandardSetting", "@", "targetSG"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"1.", 
       RowBox[{"K", ".", " ", "Common"}], " ", "transformation", " ", 
       "procedures"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"'", 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"procedureCellCentring", ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MissingQ", "@", "targetCentring"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MissingQ", "@", "sourceCentring"}], "||", 
             RowBox[{"!", 
              RowBox[{"ValueQ", "@", "sourceCentring"}]}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"sourceCentring", "=", 
             RowBox[{"StringTake", "[", 
              RowBox[{"fullHM", ",", "1"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"No", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
            "\t", 
           RowBox[{
            RowBox[{"sourceCentring", "===", "targetCentring"}], ",", 
            "\[IndentingNewLine]", "\t", "Null", ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Transformation", " ", 
              RowBox[{"from", " ", "'"}], 
              RowBox[{"P", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
            
            RowBox[{"sourceCentring", "===", "\"\<P\>\""}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"P1", "=", 
             RowBox[{"Inverse", "@", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{"targetCentring", "<>", "\"\<_to_P\>\""}], "]"}]}]}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Transformation", " ", 
              RowBox[{"to", " ", "'"}], 
              RowBox[{"P", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
            
            RowBox[{"targetCentring", "===", "\"\<P\>\""}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"P1", "=", 
             RowBox[{"$TransformationMatrices", "[", 
              RowBox[{"sourceCentring", "<>", "\"\<_to_P\>\""}], "]"}]}], ",",
             "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Transformation", " ", 
              RowBox[{"via", " ", "'"}], 
              RowBox[{"P", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
            "True", ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"P1", "=", 
              RowBox[{"$TransformationMatrices", "[", 
               RowBox[{"sourceCentring", "<>", "\"\<_to_P\>\""}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t", 
             RowBox[{"P2", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{"$TransformationMatrices", "[", 
                RowBox[{"targetCentring", "<>", "\"\<_to_P\>\""}], 
                "]"}]}]}]}]}], "\[IndentingNewLine]", "\t", "]"}]}]}], 
        "\[IndentingNewLine]", "\t", "]"}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"'", 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"procedureCellOrigin", ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"targetSetting", ",", "\"\<CellOrigin\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sourceSetting", "[", "\"\<CellOrigin\>\"", "]"}], ",", 
             "targetO"}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"shift", "=", 
           RowBox[{"SG", "[", 
            RowBox[{"[", 
             RowBox[{
             "\"\<AlternativeSettings\>\"", ",", "1", ",", 
              "\"\<OriginShift\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MissingQ", "@", "targetO"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Get", " ", "space", " ", "group", " ", "origin", " ", "shift", 
              " ", 
              RowBox[{"(", 
               RowBox[{"shift", " ", "vector"}], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"temp", "===", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], ",", "Null", ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"temp", "===", 
               RowBox[{"{", 
                RowBox[{"2", ",", "2"}], "}"}]}], ",", "Null", ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"temp", "===", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], ",", 
              RowBox[{"p", "=", "shift"}], ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"temp", "===", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}]}], ",", 
              RowBox[{"p", "=", 
               RowBox[{"-", "shift"}]}]}], "]"}]}], "\[IndentingNewLine]", 
           "\t", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "2.", " ", "Determining", " ", 
       "correct", " ", "transformation", " ", "matrices", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Goto", "[", "system", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"A", ".", " ", 
        RowBox[{"Triclinic", " ", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Triclinic\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellCentring", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"B", ".", " ", 
        RowBox[{"Monoclinic", " ", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"Label", "[", "\"\<Monoclinic\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Prepartations", " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"If", " ", "target", " ", "axis", " ", "not", " ", "given"}], 
       ",", " ", 
       RowBox[{"use", " ", "same", " ", "axis", " ", "as", " ", "source"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "targetAxis"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "targetAxis"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"targetAxis", "=", 
        RowBox[{"sourceSetting", "[", "\"\<UniqueAxis\>\"", "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"UniqueAxis", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Target", " ", "unique", " ", "axis", " ", "transformation"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"allowed", "=", 
      RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
       "\"\<UniqueAxisB_to_C\>\"", ",", "\[IndentingNewLine]", "\t\t", 
        "\"\<UniqueAxisB_to_A\>\"", ",", "\[IndentingNewLine]", "\t\t", 
        "\"\<UniqueAxisC_to_A\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"temp", "=", 
      RowBox[{"ToUpperCase", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sourceSetting", "[", "\"\<UniqueAxis\>\"", "]"}], ",", 
         "targetAxis"}], "}"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "whether", " ", "P", " ", "or", " ", "Q", " ", 
       RowBox[{"(", "inverse", ")"}], " ", "is", " ", "needed"}], " ", "*)"}],
      "\[IndentingNewLine]", "\t\t", 
     RowBox[{"cmd", "=", 
      RowBox[{"\"\<UniqueAxis\>\"", "<>", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_to_\>\"", "<>", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"allowed", ",", "cmd"}], "]"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Q", "=", "False"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Q", "=", "True"}], ";", "\[IndentingNewLine]", "\t\t\t", 
        RowBox[{"cmd", "=", 
         RowBox[{"\"\<UniqueAxis\>\"", "<>", 
          RowBox[{"temp", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<_to_\>\"", "<>", 
          RowBox[{"temp", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "\t\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Target", " ", "unique", " ", "axis", " ", "transformation"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"SameQ", "@@", "temp"}]}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"P1", "=", 
         RowBox[{"$TransformationMatrices", "[", "cmd", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"Q", ",", 
          RowBox[{"P1", "=", 
           RowBox[{"Inverse", "@", "P1"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"CellChoice", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "cell", " ", "choice", " ", "is", " ", "an", 
       " ", "available", " ", "setting"}], " ", "*)"}], "\t\t", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{
           RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}], ",", 
           "\"\<CellChoice\>\""}], "]"}]}], "\[IndentingNewLine]", "\t\t", "&&", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"targetSetting", ",", "\"\<CellChoice\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"UnitCellTransformation", "::", "command"}], ",", 
          "\"\<CellChoice\>\""}], "]"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MissingQ", "@", "targetCC"}]}], ",", "\[IndentingNewLine]",
          "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Matrix", " ", "for", " ", "checking", " ", "transformation", " ", 
           "signature"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"temp", "=", 
           RowBox[{"temp", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"sg", "[", 
               RowBox[{"\"\<Setting\>\"", ",", "\"\<CellChoice\>\""}], "]"}], 
              ",", "targetCC"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Use", " ", "regular"}], ",", " ", "none", ",", " ", 
            RowBox[{"or", " ", "inverse", " ", "transformation"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"temp", "===", 
             RowBox[{"-", "1"}]}], ",", 
            RowBox[{"Q", "=", "True"}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"temp", "===", "0"}], ",", 
            RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"temp", "===", "1"}], ",", 
            RowBox[{"Q", "=", "False"}]}], "\[IndentingNewLine]", "\t\t", 
           "]"}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"cmd", "=", 
           RowBox[{"\"\<UniqueAxis\>\"", "<>", 
            RowBox[{"ToUpperCase", "@", "targetAxis"}], "\[IndentingNewLine]",
             "\t\t", "<>", "\"\<_CellChoice+1\>\""}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"P2", "=", 
           RowBox[{"$TransformationMatrices", "[", "cmd", "]"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{"Q", ",", 
            RowBox[{"P2", "=", 
             RowBox[{"Inverse", "@", "P2"}]}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\t\t", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"C", ".", " ", 
        RowBox[{"Orthorhombic", " ", "--"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Orthorhombic\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"AxisPermutation", "'"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MissingQ", "@", "targetAP"}]}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "which", " ", "matrices", " ", "are", " ", "needed"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"ToUpperCase", "/@", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sourceSetting", "[", "\"\<AxisPermutation\>\"", "]"}], 
            ",", "targetAP"}], "}"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SameQ", "@@", "temp"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Same", " ", "axis", " ", 
            RowBox[{"permutation", " ", "--"}], " ", "no", " ", "transform", 
            " ", "required"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          "Null", ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"temp", ",", "\"\<DEF\>\""}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Chain", " ", 
              RowBox[{"through", " ", "'"}], 
              RowBox[{"abc", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{"x", "=", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_to_DEF\>\""}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"y", "=", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<_to_DEF\>\""}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"$TransformationMatrices", "[", "x", "]"}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{"$TransformationMatrices", "[", "y", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "OR", " ", "use", " ", "one", " ", "of", " ", "the", " ", "six", 
              " ", "transformations"}], " ", "*)"}], "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{
             RowBox[{"cmd", "=", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_to_\>\"", "<>", 
               RowBox[{"temp", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"KeyExistsQ", "[", 
                RowBox[{"$TransformationMatrices", ",", "cmd"}], "]"}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"P1", "=", 
                RowBox[{"$TransformationMatrices", "[", "cmd", "]"}]}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"P1", "=", 
                RowBox[{"Inverse", "@", 
                 RowBox[{
                 "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t", 
                  
                  RowBox[{
                   RowBox[{"temp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<_to_\>\"", "<>", 
                   RowBox[{"temp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}]}], 
              "\[IndentingNewLine]", "\t\t", "]"}]}]}], "\[IndentingNewLine]",
            "\t\t", "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellOrigin", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"D", ".", " ", 
        RowBox[{"Tetragonal", " ", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"Label", "[", "\"\<Tetragonal\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Checks", " ", "and", " ", "updates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "sourceCentring"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "sourceCentring"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"sourceCentring", "=", 
        RowBox[{"StringTake", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinShort\>\""}], 
           "]"}], ",", "1"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "targetCentring"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "targetCentring"}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"targetCentring", "=", 
        RowBox[{"StringTake", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"SG", "[", 
           RowBox[{"\"\<Name\>\"", ",", "\"\<HermannMauguinShort\>\""}], 
           "]"}], ",", "1"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellCentring", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"MultipleCell", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{"targetSetting", ",", "\"\<MultipleCell\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "already", " ", "transformed"}], ",", " ", 
         RowBox[{"transform", " ", 
          RowBox[{"to", " ", "'"}], 
          RowBox[{"P", "'"}], " ", 
          RowBox[{"or", " ", "'"}], 
          RowBox[{"I", "'"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"tetList", ",", "sourceCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"P1", "=", 
           RowBox[{"Inverse", "@", 
            RowBox[{
            "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"\"\<TetragonalProjection\>\"", "<>", 
              RowBox[{"StringTake", "[", 
               RowBox[{"sourceCell", ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Transforming", " ", "to", " ", "target", " ", "cell"}], " ",
          "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<P\>\"", ",", "\"\<I\>\""}], "}"}], ",", 
             "targetCell"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"P2", "=", 
           RowBox[{
           "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"\"\<TetragonalProjection\>\"", "<>", 
             RowBox[{"StringTake", "[", 
              RowBox[{"targetCell", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\t", "]"}]}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"iii", ".", " ", "'"}], 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellOrigin", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"E", ".", " ", "Hexagonal"}], " ", "crystal", " ", 
       RowBox[{"family", " ", "--"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Trigonal\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Hexagonal\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Checks", " ", "and", " ", "updates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Reinstate", " ", "'"}], 
       RowBox[{"MultipleCell", "'"}], " ", "label"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "sourceCell"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "sourceCell"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"sourceCell", "=", 
        RowBox[{"sourceSetting", "[", "\"\<MultipleCell\>\"", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "rhombohedral", " ", "source", " ", "setting"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "sourceRS"}], "||", 
        RowBox[{"!", 
         RowBox[{"ValueQ", "@", "sourceRS"}]}]}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Assume", " ", "main", " ", "space", " ", "group", " ", "setting"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{"sourceRS", "=", "\"\<obverse\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Check", " ", "rhombohedral", " ", "target", " ", "setting"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MissingQ", "@", "targetRS"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"hex3List", ",", "targetCell"}], "]"}]}], ",", 
       RowBox[{"targetRS", "=", "\"\<obverse\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MissingQ", "@", "targetRS"}]}], "&&", 
        RowBox[{"targetCell", "===", "\"\<R\>\""}]}], ",", 
       RowBox[{"targetCell", "=", "\"\<R1\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"A", ".", " ", "Rhombohedral"}], " ", "space", " ", "group"}],
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "146", ",", "148", ",", "155", ",", "160", ",", "161", ",", "166", 
           ",", "167"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"sourceSGnumber", ",", "targetSGnumber"}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "target", " ", "command"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "\"\<R\>\"", "}"}], ",", "hex3List", ",", 
                 "monoList"}], "}"}], "]"}]}], ",", "targetCell"}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalidSG"}], ",", 
             "\[IndentingNewLine]", "\t\t\t", "targetCell"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"a", ".", " ", "Rhombohedral"}], " ", "source"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"sourceCell", "===", "\"\<R\>\""}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"a", 
             RowBox[{".1", ".", " ", "Rhombohedral"}], " ", "target"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"targetCell", "===", "\"\<R\>\""}], "&&", 
             RowBox[{"MissingQ", "@", "targetRS"}]}], ",", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"a", 
              RowBox[{".2", ".", " ", "Triple"}], " ", "hexagonal", " ", 
              "target"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hex3List", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"P1", "=", 
             RowBox[{
             "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
              "\"\<Rhombohedral_to_\>\"", "<>", "targetCell", "<>", 
               "\"\<_\>\"", "<>", "targetRS"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"a", 
              RowBox[{".3", ".", " ", "Monoclinic"}], " ", "target"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t\t", "True", ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"P1", "=", 
             RowBox[{
             "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
              "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "targetCell"}], 
              "]"}]}]}], "\[IndentingNewLine]", "\t\t", "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"b", ".", " ", "Regular"}], " ", "hexagonal", " ", 
            RowBox[{"(", 
             RowBox[{"R1", ",", " ", "R2", ",", " ", "R3"}], ")"}], " ", 
            "source"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"hex3List", ",", "sourceCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"b", 
             RowBox[{".1", ".", " ", "Rhombohedral"}], " ", "target"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"targetCell", "===", "\"\<R\>\""}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"P1", "=", 
             RowBox[{"Inverse", "@", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_\>\"", "<>", "sourceCell", "<>", 
                "\"\<_\>\"", "<>", "sourceRS"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"b", 
              RowBox[{".2", ".", " ", "Triple"}], " ", "hexagonal", " ", 
              "target"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hex3List", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"sourceCell", "===", "targetCell"}], "&&", 
                RowBox[{"sourceRS", "===", "targetRS"}]}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{
               "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                
                RowBox[{
                "\"\<Rhombohedral_to_\>\"", "<>", "sourceCell", "<>", 
                 "\"\<_\>\"", "<>", "sourceRS"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_\>\"", "<>", "targetCell", "<>", 
                "\"\<_\>\"", "<>", "targetRS"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"b", 
              RowBox[{".3", ".", " ", "Monoclinic"}], " ", "target"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t\t", "True", ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sourceCell", "===", "\"\<R1\>\""}], "&&", 
               RowBox[{"sourceRS", "===", "\"\<obverse\>\""}]}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"P1", "=", 
               RowBox[{
               "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                
                RowBox[{
                "\"\<TripleHexagonal_to_Monoclinic_\>\"", "<>", 
                 "targetCell"}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
              
              RowBox[{
               RowBox[{"P1", "=", 
                RowBox[{"Inverse", "@", 
                 RowBox[{
                 "$TransformationMatrices", "[", "\[IndentingNewLine]", 
                  "\t\t", 
                  RowBox[{"\"\<Rhombohedral_to_\>\"", 
                   RowBox[{
                   "sourceCell", "<>", "\"\<_\>\"", "<>", "sourceRS"}]}], 
                  "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"P2", "=", 
                RowBox[{
                "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                 RowBox[{
                 "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "targetCell"}], 
                 "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", "\t\t", "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"c", ".", " ", "Monoclinic"}], " ", "source"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"monoList", ",", "sourceCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"c", 
             RowBox[{".1", ".", " ", "Rhombohedral"}], " ", "target"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"targetCell", "===", "\"\<R\>\""}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"P1", "=", 
             RowBox[{"Inverse", "@", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "sourceCell"}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"c", 
              RowBox[{".2", ".", " ", "Regular"}], " ", "hexagonal", " ", 
              RowBox[{"(", 
               RowBox[{"R1", ",", " ", "R2", ",", " ", "R3"}], ")"}], "l", 
              " ", "target"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hex3List", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"P1", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{
               "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                
                RowBox[{
                "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "sourceCell"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_\>\"", "<>", "targetCell", "<>", 
                "\"\<_\>\"", "<>", "targetRS"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"c", 
              RowBox[{".3", ".", " ", "Monoclinic"}], " ", "target"}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t\t", "True", ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"sourceCell", "===", "targetCell"}], ",", 
               RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"Inverse", "@", 
               RowBox[{
               "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
                
                RowBox[{
                "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "sourceCell"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{
              "$TransformationMatrices", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
               "\"\<Rhombohedral_to_Monoclinic_\>\"", "<>", "targetCell"}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "\t\t", "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}]}], ",", "\[IndentingNewLine]", 
       "\t", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"B", ".", " ", "Transformation"}], " ", "of", " ", "the", 
         " ", "hexagonal", " ", "lattice"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", "True", ",", "\[IndentingNewLine]", "\t", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "if", " ", "target", " ", "is", " ", "valid"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "\"\<P\>\"", "}"}], ",", "hexList", ",", 
                 "monoList"}], "}"}], "]"}]}], ",", "targetCell"}], "]"}]}], 
          ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"UnitCellTransformation", "::", "invalidSG"}], ",", 
             "\[IndentingNewLine]", "\t\t\t", "targetCell"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"StringCases", "[", 
             RowBox[{
              RowBox[{"Keys", "@", "$TransformationMatrices"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "StartOfString", "~~", "\"\<Hexagonal\>\"", "~~", "__"}]}], 
             "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "@", "sourceCell"}], ",", 
          RowBox[{"sourceCell", "=", "\"\<P\>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"a", ".", " ", "Primitive"}], " ", "hexagonal", " ", 
           "source"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"sourceCell", "===", "\"\<P\>\""}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"a", 
             RowBox[{".1", ".", " ", "No"}], " ", "change"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"targetCell", "===", "\"\<P\>\""}], ",", 
            RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"a", 
              RowBox[{".2", ".", " ", "Special"}], " ", "hexagonal", " ", 
              "target"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hexList", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"M", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "targetCell"}], "]"}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"$TransformationMatrices", "@@", "temp"}]}]}]}], 
           "\[IndentingNewLine]", "\t\t", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"b", ".", " ", "Special"}], " ", "hexagonal", " ", 
            "source"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"hexList", ",", "sourceCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"b", 
             RowBox[{".1", ".", " ", "To"}], " ", "primitive", " ", 
             "hexagonal", " ", "cell"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{
            RowBox[{"targetCell", "===", "\"\<P\>\""}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"M", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "targetCell"}], "]"}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{
               RowBox[{"Inverse", "@", "$TransformationMatrices"}], "@@", 
               "temp"}]}]}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"b", 
              RowBox[{".2", ".", " ", "To"}], " ", "special", " ", 
              "hexagonal", " ", "target"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"hexList", ",", "targetCell"}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"sourceCell", "===", "targetCell"}], ",", 
               RowBox[{"Goto", "[", "\"\<MatricesDone\>\"", "]"}]}], "]"}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"M", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "sourceCell"}], "]"}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P1", "=", 
              RowBox[{"Inverse", "[", 
               RowBox[{"$TransformationMatrices", "@@", "temp"}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"temp", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"M", ",", 
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "targetCell"}], "]"}], "&"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"P2", "=", 
              RowBox[{"$TransformationMatrices", "@@", "temp"}]}]}]}], 
           "\[IndentingNewLine]", "\t\t", "]"}]}], "\[IndentingNewLine]", 
         "\t\t", "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<MatricesDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", " ", "2."}], 
       RowBox[{"F", ".", " ", 
        RowBox[{"Cubic", " ", "--"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<Cubic\>\"", "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"i", ".", " ", "'"}], 
       RowBox[{"CellCentring", "'"}]}], " ", "*)"}], " ", 
     "\[IndentingNewLine]", "\t", "procedureCellCentring", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ii", ".", " ", "'"}], 
       RowBox[{"CellOrigin", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", "procedureCellOrigin", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparations", " ", "done"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Goto", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "3.", " ", "Carrying", " ", "out", " ", 
       "transformations", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"3.", 
       RowBox[{"A", ".", " ", "Preparations"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<MetricTransformation\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"P", "=", 
      RowBox[{"P1", ".", "P2"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"returnP", "===", "All"}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"{", 
         RowBox[{"P1", ",", "P2"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"returnP", ",", 
       RowBox[{"Return", "@", "P"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Q", "=", 
      RowBox[{"Inverse", "@", "P"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"q", "=", 
      RowBox[{"-", 
       RowBox[{"Q", ".", "p"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"G", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "P", "]"}], ".", "G", ".", "P"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"newlattice", "=", 
      RowBox[{"Association", "@", 
       RowBox[{"Thread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", 
           "\"\<\[Alpha]\>\"", ",", "\"\<\[Beta]\>\"", ",", 
           "\"\<\[Gamma]\>\""}], "}"}], "\[IndentingNewLine]", "\[Rule]", 
         RowBox[{"GetLatticeParameters", "[", "G", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"3.", 
       RowBox[{"B", ".", " ", "Transforming"}], " ", "coordinates", " ", 
       "and", " ", "ADPs"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Fractional", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"xyz", "=", 
      RowBox[{"$CrystalData", "[", 
       RowBox[{"[", 
        RowBox[{
        "crystal", ",", "\[IndentingNewLine]", "\t", "\"\<AtomData\>\"", ",", 
         "All", ",", "\"\<FractionalCoordinates\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"newxyz", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FractionalPart", "[", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{"Q", ",", "#"}], "]"}], "+", "q"}], "]"}], "&"}], "/@", 
        "xyz"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Atomic", " ", "displacement", " ", "parameters"}], " ", "*)"}],
      "\[IndentingNewLine]", "\t", 
     RowBox[{"adps", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"$CrystalData", "[", 
         RowBox[{"crystal", ",", "\"\<AtomData\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", "\"\<DisplacementParameters\>\"", ",", 
        "0."}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"U", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", "#4", ",", "#5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"#4", ",", "#2", ",", "#6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"#5", ",", "#6", ",", "#3"}], "}"}]}], "}"}], "&"}], "@@",
          "#"}], "&"}], "/@", "adps"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", 
       RowBox[{"diagonal", " ", "'"}], 
       RowBox[{"N", "'"}], " ", "matrices"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "References", ":", "\[IndentingNewLine]", "\t", "https", ":"}], "//", 
        
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"doi", ".", "org"}], "/", "10.1107"}], "/", 
          "S0108767311018216"}], "\[IndentingNewLine]", "\t", 
         RowBox[{"https", ":"}]}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{"doi", ".", "org"}], "/", "10.1107"}], "/", 
        "S0021889802008580"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"n0", "=", 
      RowBox[{"DiagonalMatrix", "@", 
       RowBox[{"Sqrt", "@", 
        RowBox[{"Diagonal", "@", 
         RowBox[{"Inverse", "@", "G0"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Inverse", "@", 
       RowBox[{"DiagonalMatrix", "@", 
        RowBox[{"Sqrt", "@", 
         RowBox[{"Diagonal", "@", 
          RowBox[{"Inverse", "@", "G"}]}]}]}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Transforming", " ", "ADPs"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"newU", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "=", 
         RowBox[{"U", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "u", "]"}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{
           RowBox[{"temp", "=", 
            RowBox[{"n0", ".", "u", ".", 
             RowBox[{"Transpose", "[", "n0", "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"temp", "=", 
            RowBox[{"Q", ".", "temp", ".", 
             RowBox[{"Transpose", "[", "Q", "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"temp", "=", 
            RowBox[{"Chop", "[", 
             RowBox[{"n", ".", "temp", ".", 
              RowBox[{"Transpose", "[", "n", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"temp", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"temp", ",", 
                RowBox[{"#", "/.", 
                 RowBox[{"List", "\[Rule]", "Sequence"}]}]}], "]"}], "&"}], "/@",
              "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}]}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"temp", "=", "u"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newU", ",", "temp"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "adps"}]}], "}"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "4.", " ", "Overwriting", " ", "entry", 
       " ", "in", " ", "$CrystalData", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Determine", " ", "new", " ", "space", " ", "group", " ", "symbol", " ",
        "automatically"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Remove", " ", "old", " ", "cell", " ", "tag"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"targetSG", ",", 
          RowBox[{"{", 
           RowBox[{"-", "2"}], "}"}]}], "]"}], "===", "\"\<:\>\""}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"targetSG", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{"targetSG", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "3"}]}], "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Update", " ", "space", " ", "group", " ", "symbol"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"targetO", "===", "2"}], "||", 
          RowBox[{
           RowBox[{"targetSetting", "[", "\"\<CellOrigin\>\"", "]"}], "===", 
           "2"}]}], ")"}], "&&", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"targetSG", ",", "\"\<:2\>\""}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"targetSG", "=", 
        RowBox[{"targetSG", "<>", "\"\<:2\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Get", " ", "full", " ", "Hermann"}], "\[Dash]", 
       RowBox[{"Mauguin", " ", "symbol"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"targetFullHM", "=", 
      RowBox[{"GetSymmetryData", "[", 
       RowBox[{"targetSG", ",", "\"\<HermannMauguinFull\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Set", " ", "new", " ", "symbol"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"$CrystalData", "[", 
       RowBox[{"crystal", ",", "\"\<SpaceGroup\>\""}], "]"}], "=", 
      "targetSG"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"New", " ", "lattice", " ", "parameters"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"$CrystalData", "[", 
        RowBox[{
        "crystal", ",", "\[IndentingNewLine]", "\t", 
         "\"\<LatticeParameters\>\""}], "]"}], ",", "newlattice"}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"New", " ", "fractional", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"$CrystalData", "[", 
       RowBox[{"[", 
        RowBox[{
        "crystal", ",", "\"\<AtomData\>\"", ",", "All", ",", 
         "\[IndentingNewLine]", "\t", "\"\<FractionalCoordinates\>\""}], 
        "]"}], "]"}], "=", "newxyz"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"New", " ", "ADPs"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AllTrue", "[", 
         RowBox[{
          RowBox[{"N", "@", "newU"}], ",", 
          RowBox[{
           RowBox[{"#", "\[Equal]", "0."}], "&"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"$CrystalData", "[", 
         RowBox[{"[", 
          RowBox[{
          "crystal", ",", "\"\<AtomData\>\"", ",", "All", ",", 
           "\[IndentingNewLine]", "\t", "\"\<DisplacementParameters\>\""}], 
          "]"}], "]"}], "=", "newU"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Updating", " ", "'"}], 
       RowBox[{"Notes", "'"}], " ", "and", " ", "adding", " ", "space", " ", 
       "group", " ", "notes", " ", "if", " ", "needed"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Checking", " ", "for", " ", "updates"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"notes", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
      "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"a", ".", " ", 
        RowBox[{"Exception", ":", " ", 
         RowBox[{"default", " ", "space", " ", "group", " ", "setting"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Values", "@", 
          RowBox[{"SG", "[", "\"\<Setting\>\"", "]"}]}]}], "=!=", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Sort", "@", 
         RowBox[{"DeleteMissing", "@", 
          RowBox[{"{", 
           RowBox[{"targetCell", ",", "targetRS", ",", "targetCentring"}], 
           "}"}]}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"b", ".", " ", "Write"}], " ", "both", " ", "multiple", " ", 
         "cell", " ", "and", " ", "rhombohedral", " ", "setting"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"targetSetting", ",", "\"\<MultipleCell\>\""}], "]"}], "&&",
            "\[IndentingNewLine]", "\t", 
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<P\>\"", ",", "\"\<I\>\""}], "}"}], ",", 
              "targetCell"}], "]"}]}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notes", ",", 
            RowBox[{"\"\<Multiple cell symbol: \>\"", "<>", "targetCell"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"hex3List", ",", "targetCell"}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notes", ",", 
            RowBox[{"\"\<Rhombohedral setting: \>\"", "<>", "targetRS"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MissingQ", "@", "targetCentring"}]}], "&&", 
           RowBox[{"ValueQ", "@", "targetCentring"}], "&&", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "No", " ", "need", " ", "if", " ", "centring", " ", "is", " ", 
             "in", " ", "space", " ", "group", " ", "symbol"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"targetFullHM", ",", "1"}], "]"}], "\[NotEqual]", 
            "targetCentring"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"notes", ",", 
            RowBox[{"\"\<Custom centring: \>\"", "<>", "targetCentring"}]}], 
           "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Writing", " ", 
       RowBox[{"over", " ", "'"}], 
       RowBox[{"Notes", "'"}], " ", "or", " ", "removing", " ", "if", " ", 
       "empty"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"notes", "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"$CrystalData", "[", 
          RowBox[{"crystal", ",", "\"\<Notes\>\""}], "]"}], "=", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Join", "[", 
          RowBox[{"notes0", ",", "notes"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"notes0", "===", "notes", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"No", " ", "notes"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"KeyDropFrom", "[", 
        RowBox[{
         RowBox[{"$CrystalData", "[", "crystal", "]"}], ",", 
         "\"\<Notes\>\""}], "]"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Use", " ", "only", " ", "core", " ", "notes"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"$CrystalData", "[", 
         RowBox[{"crystal", ",", "\"\<Notes\>\""}], "]"}], "=", "notes0"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "5.", " ", "Display", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#1", "===", "\"\<AtomData\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<AtomData\>\"", "\[Rule]", 
           RowBox[{"Shallow", "[", 
            RowBox[{"#2", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"#1", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"$CrystalData", "[", "crystal", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106086235696*^9, {3.6681847250202436`*^9, 
   3.668184763578227*^9}, {3.668184859415769*^9, 3.6681848958952827`*^9}, {
   3.6681849656538982`*^9, 3.668184966557592*^9}, {3.668186746700986*^9, 
   3.668186748499941*^9}, {3.668186887833519*^9, 3.668186915465481*^9}, 
   3.668187179635866*^9, {3.6681873567029552`*^9, 3.668187367461336*^9}, {
   3.6681874297574987`*^9, 3.668187481442852*^9}, {3.6681875159231033`*^9, 
   3.66818751647386*^9}, {3.668187676247175*^9, 3.66818768715088*^9}, {
   3.668187807957081*^9, 3.668187810156796*^9}, 3.6681878677945766`*^9, {
   3.668192637722664*^9, 3.6681926384504833`*^9}, {3.668192682042522*^9, 
   3.668192705296905*^9}, {3.682682345535097*^9, 3.682682347997387*^9}, {
   3.682754890045689*^9, 3.682754900136516*^9}, {3.682754952296125*^9, 
   3.682755022164933*^9}, {3.682755115621669*^9, 3.6827551535141687`*^9}, {
   3.682755192899743*^9, 3.682755204616169*^9}, {3.682755483075945*^9, 
   3.682755572184518*^9}, {3.682755620936475*^9, 3.68275570339452*^9}, {
   3.682755785197132*^9, 3.6827558328591137`*^9}, {3.682755872957996*^9, 
   3.682755929888302*^9}, {3.6827560172459*^9, 3.68275608066227*^9}, {
   3.6827561903761797`*^9, 3.682756208255334*^9}, {3.682756341293084*^9, 
   3.682756435807774*^9}, {3.682756481562601*^9, 3.6827566171437607`*^9}, {
   3.6827571356319447`*^9, 3.68275715086217*^9}, {3.682757193154983*^9, 
   3.682757204761051*^9}, {3.682757287045686*^9, 3.6827573748421717`*^9}, {
   3.6827574428815193`*^9, 3.682757463459453*^9}, {3.6827575865280647`*^9, 
   3.682757600041594*^9}, {3.6827576521824217`*^9, 3.682757654103991*^9}, {
   3.682757736488762*^9, 3.68275776848295*^9}, {3.682757872746702*^9, 
   3.682757878996653*^9}, {3.682760893290402*^9, 3.682760919442278*^9}, {
   3.682761050069873*^9, 3.6827610875022707`*^9}, {3.682761344440157*^9, 
   3.6827613948805656`*^9}, {3.682761467533331*^9, 3.6827614906040382`*^9}, {
   3.682761599041744*^9, 3.6827616051249332`*^9}, {3.682761640140191*^9, 
   3.682761640269712*^9}, {3.6827632705416527`*^9, 3.682763272313184*^9}, {
   3.6827634698943243`*^9, 3.682763491297275*^9}, 3.682763560088398*^9, {
   3.682763672646283*^9, 3.682763703768117*^9}, 3.682763765769903*^9, {
   3.6827638097007027`*^9, 3.682763841562532*^9}, {3.682764002267891*^9, 
   3.682764060609202*^9}, {3.682764092437544*^9, 3.682764093948495*^9}, {
   3.682764145109967*^9, 3.682764153463393*^9}, {3.682764193547503*^9, 
   3.682764223520398*^9}, {3.682764299751896*^9, 3.682764385964645*^9}, {
   3.68276443988243*^9, 3.6827644490889807`*^9}, {3.682764497839053*^9, 
   3.68276451442174*^9}, {3.682764590085518*^9, 3.682764666566125*^9}, {
   3.682764709108004*^9, 3.682764713033717*^9}, {3.682764803156188*^9, 
   3.682764805193653*^9}, {3.682764858920453*^9, 3.68276487123205*^9}, {
   3.6827650306638536`*^9, 3.682765032106743*^9}, {3.682765077128017*^9, 
   3.682765114630002*^9}, {3.682765148933024*^9, 3.682765156919944*^9}, {
   3.6827677197030478`*^9, 3.682767720010531*^9}, {3.683604340403654*^9, 
   3.6836043529073563`*^9}, {3.684139656863722*^9, 3.68413966623372*^9}, {
   3.684213591199651*^9, 3.68421359766739*^9}, 3.68423542388873*^9, {
   3.684494231046241*^9, 3.6844942328843927`*^9}, {3.6846687766667967`*^9, 
   3.684668833479196*^9}, {3.6850821810967503`*^9, 3.685082181896227*^9}, 
   3.685084049591119*^9, {3.685301853914551*^9, 3.6853018858709908`*^9}, {
   3.685301957111362*^9, 3.6853019648610888`*^9}, {3.685301997069955*^9, 
   3.68530212067407*^9}, {3.685302176210725*^9, 3.685302185680876*^9}, {
   3.685302454443644*^9, 3.685302484386928*^9}, {3.685302801397314*^9, 
   3.6853028247972393`*^9}, {3.6853028602362013`*^9, 3.685302902395097*^9}, {
   3.685331251904861*^9, 3.6853312646170473`*^9}, {3.6853312960267057`*^9, 
   3.6853313204691477`*^9}, {3.685331539879148*^9, 3.685331677385861*^9}, {
   3.685331889662311*^9, 3.685332001364971*^9}, {3.685332031404345*^9, 
   3.6853320318833237`*^9}, {3.685332097919066*^9, 3.68533210035004*^9}, {
   3.6853321321988993`*^9, 3.685332135240776*^9}, {3.685332208432933*^9, 
   3.685332251093843*^9}, {3.685332353259377*^9, 3.685332354313655*^9}, {
   3.685334186433942*^9, 3.685334188848311*^9}, {3.6853342830532503`*^9, 
   3.685334343176944*^9}, {3.685351973845551*^9, 3.6853519796240673`*^9}, {
   3.6853837611243258`*^9, 3.685383766849927*^9}, {3.685697704820434*^9, 
   3.6856977220768137`*^9}, {3.6856980151258297`*^9, 3.685698042947495*^9}, {
   3.6856981446843*^9, 3.685698153416366*^9}, {3.685770338473489*^9, 
   3.685770340565543*^9}, 3.685777919630587*^9, {3.685784957125655*^9, 
   3.685784959319334*^9}, {3.685785897727392*^9, 3.6857859357454*^9}, 
   3.685786625994659*^9, {3.7044367020593557`*^9, 3.704436716910542*^9}, {
   3.704437060469801*^9, 3.704437061355534*^9}, {3.7045291539654207`*^9, 
   3.704529181429552*^9}, {3.70463904720662*^9, 3.704639053820704*^9}, {
   3.7046390868371058`*^9, 3.7046391487704353`*^9}, {3.704639211626547*^9, 
   3.704639215864826*^9}, {3.704639303936639*^9, 3.704639314247789*^9}, {
   3.704639575801569*^9, 3.704639591328041*^9}, 3.704681465753708*^9, {
   3.70471440884299*^9, 3.704714411656499*^9}, {3.704781095163774*^9, 
   3.704781138312235*^9}, {3.704781171096986*^9, 3.704781372927989*^9}, {
   3.704781431044951*^9, 3.704781673054648*^9}, {3.704781704457116*^9, 
   3.704781784136161*^9}, {3.7047821103878107`*^9, 3.704782160367371*^9}, {
   3.70478225943954*^9, 3.704782259977478*^9}, {3.7047823093508368`*^9, 
   3.7047824001982603`*^9}, {3.7047827469674673`*^9, 3.704782850953916*^9}, {
   3.704783306198886*^9, 3.704783308376602*^9}, {3.704783381925585*^9, 
   3.7047834127075787`*^9}, {3.7047834626515923`*^9, 
   3.7047835034465427`*^9}, {3.704783548944147*^9, 3.704783565198893*^9}, {
   3.704784188054659*^9, 3.704784188812976*^9}, {3.704784274852812*^9, 
   3.7047842831346407`*^9}, {3.7047845251019573`*^9, 3.70478454238107*^9}, {
   3.704784614679093*^9, 3.7047848263804607`*^9}, {3.704784869444706*^9, 
   3.704784898453231*^9}, {3.7047849541155043`*^9, 3.704785094445505*^9}, {
   3.7047851368258247`*^9, 3.7047851828459463`*^9}, {3.7047852202997713`*^9, 
   3.7047852670324802`*^9}, {3.704785306325713*^9, 3.7047854132528477`*^9}, {
   3.7047863648626738`*^9, 3.704786383547965*^9}, {3.7049001358451014`*^9, 
   3.704900173795347*^9}, {3.70490023363381*^9, 3.704900259162404*^9}, {
   3.704900330919608*^9, 3.7049003391983232`*^9}, {3.704900392039269*^9, 
   3.704900472595674*^9}, {3.704900584282815*^9, 3.7049006103228073`*^9}, {
   3.704963963713521*^9, 3.704963986927402*^9}, {3.704964135126243*^9, 
   3.704964148285693*^9}, {3.704980030539423*^9, 3.704980056464788*^9}, {
   3.70498010586537*^9, 3.704980265589656*^9}, {3.704980793631959*^9, 
   3.704980813917923*^9}, {3.704981234310117*^9, 3.7049812748186007`*^9}, {
   3.7049814049766703`*^9, 3.704981519030542*^9}, {3.704981685339789*^9, 
   3.704981687209407*^9}, {3.7049820740671997`*^9, 3.704982134359151*^9}, {
   3.704984647694091*^9, 3.7049847372057247`*^9}, {3.704985012540173*^9, 
   3.704985027746879*^9}, {3.704985322604034*^9, 3.704985356203178*^9}, {
   3.704985572790638*^9, 3.704985573678316*^9}, {3.704985610646216*^9, 
   3.7049856725238533`*^9}, {3.704986040627817*^9, 3.704986073961976*^9}, {
   3.7049863568451033`*^9, 3.70498638990417*^9}, {3.704995796843191*^9, 
   3.70499580306463*^9}, 3.7049958876557503`*^9, {3.7049960745392323`*^9, 
   3.704996074845935*^9}, {3.704996112145527*^9, 3.704996138969049*^9}, {
   3.7049962503187857`*^9, 3.704996256669743*^9}, {3.704996298430338*^9, 
   3.704996330565116*^9}, {3.7049963910354977`*^9, 3.704996394890852*^9}, {
   3.704996518000986*^9, 3.704996707979019*^9}, {3.704997361116303*^9, 
   3.704997368235462*^9}, 3.704997529753606*^9, 3.704997978672222*^9, 
   3.704998128497937*^9, {3.705027191473016*^9, 3.705027191990677*^9}, {
   3.7050275262190447`*^9, 3.705027527946822*^9}, {3.705027686695097*^9, 
   3.705027707329789*^9}, {3.70502942221036*^9, 3.70502942666612*^9}, {
   3.705029813070311*^9, 3.705029837661684*^9}, {3.705029909889103*^9, 
   3.70502997405014*^9}, {3.7050300386500483`*^9, 3.705030048247272*^9}, {
   3.70503011403964*^9, 3.7050301334636383`*^9}, 3.7050301872024384`*^9, {
   3.705030650141613*^9, 3.705030666925023*^9}, {3.7050327114837713`*^9, 
   3.70503271691243*^9}, 3.705032748383803*^9, {3.7050335565174017`*^9, 
   3.705033565659082*^9}, {3.7050342276513577`*^9, 3.705034250492412*^9}, {
   3.70503524165161*^9, 3.7050352511429253`*^9}, {3.7050353007418127`*^9, 
   3.7050353068811617`*^9}, {3.7050365424344673`*^9, 
   3.7050366893737164`*^9}, {3.705038107767313*^9, 3.705038309656887*^9}, {
   3.705038429478346*^9, 3.7050384358761263`*^9}, {3.7050417798662558`*^9, 
   3.705041792210204*^9}, {3.705042407535633*^9, 3.705042410991593*^9}, {
   3.705042628519524*^9, 3.705042646810892*^9}, {3.7050427126205482`*^9, 
   3.705042718526626*^9}, {3.705044080341269*^9, 3.7050440821784983`*^9}, {
   3.705044316216131*^9, 3.705044329376607*^9}, {3.705044402695487*^9, 
   3.705044407075869*^9}, {3.70504448679101*^9, 3.705044504568029*^9}, {
   3.705045240937169*^9, 3.7050452710625267`*^9}, {3.705046282930406*^9, 
   3.705046283115456*^9}, {3.705046741835627*^9, 3.705046742124878*^9}, {
   3.705048329572276*^9, 3.705048379584826*^9}, {3.705049000608982*^9, 
   3.7050490095271893`*^9}, {3.705049156787076*^9, 3.7050492372473783`*^9}, {
   3.7050499254469833`*^9, 3.705049936416349*^9}, {3.705050431778676*^9, 
   3.705050474548069*^9}, {3.7050506593649597`*^9, 3.705050659855472*^9}, {
   3.705129118982942*^9, 3.70512917306572*^9}, {3.705133879629517*^9, 
   3.705133900143785*^9}, {3.705134046684074*^9, 3.705134132852232*^9}, {
   3.70513424892887*^9, 3.705134390682773*^9}, {3.705134728065423*^9, 
   3.705134729699651*^9}, {3.7051352565259333`*^9, 3.705135260849962*^9}, {
   3.705135377489744*^9, 3.70513543198728*^9}, {3.705135548850492*^9, 
   3.7051355812945137`*^9}, {3.705135784759841*^9, 3.705135795573468*^9}, {
   3.705135858295582*^9, 3.705135865524931*^9}, {3.7051360660689297`*^9, 
   3.705136149927412*^9}, 3.705136249277987*^9, {3.705136316523295*^9, 
   3.705136330359829*^9}, {3.70513639014494*^9, 3.705136410286891*^9}, {
   3.7051367827338753`*^9, 3.705136810929234*^9}, {3.705137023818898*^9, 
   3.705137071908162*^9}, {3.7051371058332157`*^9, 3.705137145957691*^9}, {
   3.705137186884502*^9, 3.705137191806534*^9}, {3.705137768677368*^9, 
   3.705137806555847*^9}, {3.705137839362135*^9, 3.7051379156964493`*^9}, {
   3.705137966158246*^9, 3.70513796838484*^9}, {3.7051382023067303`*^9, 
   3.70513823184061*^9}, {3.705138341345182*^9, 3.705138382945879*^9}, {
   3.70513844032931*^9, 3.7051384465618*^9}, {3.705138486335884*^9, 
   3.705138488802494*^9}, {3.70513869921233*^9, 3.705138715382256*^9}, {
   3.7051387724892263`*^9, 3.705138852508317*^9}, {3.705138917144311*^9, 
   3.7051389248081703`*^9}, {3.705139294844222*^9, 3.705139345711564*^9}, {
   3.7051393870136127`*^9, 3.705139388090567*^9}, {3.705139458344056*^9, 
   3.7051394639595747`*^9}, {3.705139502174138*^9, 3.7051395058249073`*^9}, {
   3.705139538711701*^9, 3.7051395388838778`*^9}, {3.705139965561282*^9, 
   3.705139972664957*^9}, {3.705140007168377*^9, 3.705140115236768*^9}, {
   3.705140416891889*^9, 3.7051404256468363`*^9}, {3.705140502658304*^9, 
   3.7051405178063583`*^9}, {3.7051406181794357`*^9, 3.705140687265101*^9}, 
   3.7051407176711283`*^9, {3.705140797275918*^9, 3.7051408873069344`*^9}, {
   3.705140923134645*^9, 3.705140971593884*^9}, {3.705141031875164*^9, 
   3.7051410356307297`*^9}, {3.705141110099742*^9, 3.705141110607222*^9}, {
   3.705141361072769*^9, 3.705141374397616*^9}, {3.705141434270504*^9, 
   3.705141564356914*^9}, {3.705141608481204*^9, 3.70514162724044*^9}, {
   3.70514166372377*^9, 3.7051417263686533`*^9}, {3.705141877062311*^9, 
   3.705141922307913*^9}, {3.705141984746685*^9, 3.7051421153072777`*^9}, {
   3.705142176906891*^9, 3.70514221987148*^9}, {3.7051424427668962`*^9, 
   3.705142443078116*^9}, {3.70514248781894*^9, 3.705142729198312*^9}, {
   3.705142765610014*^9, 3.70514276573202*^9}, {3.7051428209774837`*^9, 
   3.705142865993743*^9}, {3.705142899741997*^9, 3.705142976149148*^9}, {
   3.7051433887402077`*^9, 3.70514345280599*^9}, {3.7051434928444977`*^9, 
   3.7051435830853853`*^9}, {3.705143636554434*^9, 3.7051436610831623`*^9}, {
   3.705143723298917*^9, 3.7051438063715563`*^9}, {3.705143873150329*^9, 
   3.705143874618601*^9}, {3.705143922666315*^9, 3.705143933179586*^9}, {
   3.705143979591456*^9, 3.705144087402367*^9}, {3.705144550172387*^9, 
   3.705144624308989*^9}, {3.705144685982032*^9, 3.705144792091082*^9}, {
   3.705144836604164*^9, 3.705144891641996*^9}, {3.7051449312424927`*^9, 
   3.705144935817683*^9}, {3.705144990161862*^9, 3.705145090190558*^9}, {
   3.705145132564702*^9, 3.7051451394102383`*^9}, {3.7051451901098843`*^9, 
   3.7051451907813787`*^9}, {3.705145260475809*^9, 3.70514535531808*^9}, {
   3.705145449883666*^9, 3.705145557870324*^9}, {3.705145902294602*^9, 
   3.7051459028280067`*^9}, {3.705146089935442*^9, 3.705146090497797*^9}, {
   3.70520492384804*^9, 3.705204926981947*^9}, {3.705204962706514*^9, 
   3.705205035751008*^9}, {3.70520526710811*^9, 3.705205267261889*^9}, {
   3.705205534425808*^9, 3.705205535982808*^9}, {3.70520559106012*^9, 
   3.705205591626911*^9}, {3.705205806019764*^9, 3.705205839889661*^9}, {
   3.705205870509894*^9, 3.7052059125284452`*^9}, {3.705205961825032*^9, 
   3.7052059869425983`*^9}, {3.705206525719851*^9, 3.705206525972541*^9}, {
   3.705206625330481*^9, 3.705206626601255*^9}, 3.7052066971567583`*^9, {
   3.705206944207471*^9, 3.70520704019034*^9}, {3.7052073657658157`*^9, 
   3.705207395558386*^9}, {3.705207645445804*^9, 3.705207667935486*^9}, {
   3.705207722033196*^9, 3.7052077237388144`*^9}, {3.7052079574187927`*^9, 
   3.705207960466035*^9}, {3.7052079958542*^9, 3.70520800766794*^9}, {
   3.70520817563155*^9, 3.705208191169538*^9}, {3.705208228744602*^9, 
   3.705208252653234*^9}, {3.705208681758316*^9, 3.7052086822664967`*^9}, {
   3.705209476957964*^9, 3.705209486704342*^9}, {3.705209873133827*^9, 
   3.7052099114154787`*^9}, {3.705209945256117*^9, 3.705209945477171*^9}, 
   3.70521001280859*^9, {3.705210117262548*^9, 3.705210117519784*^9}, {
   3.705210285222413*^9, 3.705210332389411*^9}, {3.705213577622493*^9, 
   3.7052135777776737`*^9}, {3.705215498110587*^9, 3.705215566540249*^9}, {
   3.7052169045583277`*^9, 3.7052169048827267`*^9}, {3.705216950775433*^9, 
   3.705216951199793*^9}, {3.7052170039198627`*^9, 3.705217023918941*^9}, {
   3.705217057854904*^9, 3.705217081168824*^9}, {3.7052171856770973`*^9, 
   3.705217287195796*^9}, {3.705217328795271*^9, 3.7052173571337442`*^9}, {
   3.705217392816124*^9, 3.705217398617674*^9}, {3.7052174305534773`*^9, 
   3.7052174984410067`*^9}, {3.705217683738093*^9, 3.7052176869416943`*^9}, {
   3.705217735738285*^9, 3.7052177973044987`*^9}, {3.705217840451035*^9, 
   3.705217841144998*^9}, {3.705218161433465*^9, 3.7052182707829638`*^9}, {
   3.705218307271225*^9, 3.7052183365896673`*^9}, {3.705218378850938*^9, 
   3.705218387490273*^9}, {3.705218576362125*^9, 3.705218615515748*^9}, {
   3.7052186697320337`*^9, 3.705218691821752*^9}, {3.705218928480157*^9, 
   3.705218950734406*^9}, {3.7052192112*^9, 3.705219217046579*^9}, {
   3.705219362186788*^9, 3.705219447438871*^9}, {3.7052194998100653`*^9, 
   3.7052195805955677`*^9}, {3.70521963595047*^9, 3.705219692748089*^9}, {
   3.7052197475924187`*^9, 3.705219950325479*^9}, {3.705220004339085*^9, 
   3.7052200117806807`*^9}, 3.7052204524566708`*^9, {3.705220486746422*^9, 
   3.7052205119375143`*^9}, {3.7052205563419724`*^9, 3.705220668406275*^9}, {
   3.705220736989337*^9, 3.705220839667692*^9}, {3.705224886431378*^9, 
   3.705224886661612*^9}, 3.705238260156303*^9, {3.705238324839102*^9, 
   3.705238325781958*^9}, {3.705251533643182*^9, 3.705251840062107*^9}, {
   3.70525214022403*^9, 3.705252142903782*^9}, {3.705252178537224*^9, 
   3.705252196622939*^9}, {3.7052528288415623`*^9, 3.705252978186975*^9}, {
   3.705253564909952*^9, 3.705253600911561*^9}, {3.7052536408230886`*^9, 
   3.705253717152933*^9}, {3.7052537626835747`*^9, 3.705253818050123*^9}, {
   3.705253852273823*^9, 3.705253861670011*^9}, {3.705253955269247*^9, 
   3.7052539652055893`*^9}, {3.7052540867370663`*^9, 3.70525409009583*^9}, {
   3.705254128759838*^9, 3.705254162374536*^9}, {3.705254197337021*^9, 
   3.705254455320642*^9}, {3.705254668103619*^9, 3.705254687817384*^9}, {
   3.7052547394501543`*^9, 3.705254750368639*^9}, {3.7052548998220387`*^9, 
   3.705254962925976*^9}, {3.705255001462636*^9, 3.705255036995092*^9}, {
   3.705255081282763*^9, 3.705255191233206*^9}, {3.705255367240821*^9, 
   3.7052554264736853`*^9}, {3.7052554732834177`*^9, 3.705255487201248*^9}, {
   3.705255531658811*^9, 3.705255630965055*^9}, {3.7052556620204144`*^9, 
   3.7052556880194693`*^9}, {3.705255731019322*^9, 3.7052559048635798`*^9}, {
   3.705255957318224*^9, 3.705255959236627*^9}, {3.705255991800148*^9, 
   3.705256031669004*^9}, {3.705256344534951*^9, 3.7052564070065937`*^9}, {
   3.7052565435857553`*^9, 3.705256794163871*^9}, {3.70525683813299*^9, 
   3.7052568989684772`*^9}, {3.7052569389212303`*^9, 3.705256978488652*^9}, {
   3.70525702612693*^9, 3.705257224227964*^9}, {3.705257258810624*^9, 
   3.705257309741723*^9}, {3.705257375454597*^9, 3.705257444459873*^9}, {
   3.705292316521531*^9, 3.7052923313880787`*^9}, {3.705292581827649*^9, 
   3.705292618948083*^9}, {3.705292648964617*^9, 3.705292649144369*^9}, {
   3.7052926960082283`*^9, 3.7052928430502033`*^9}, {3.705292878674069*^9, 
   3.705292891701365*^9}, {3.705293177795878*^9, 3.705293240132618*^9}, 
   3.705293303654491*^9, {3.7052933419484653`*^9, 3.705293421695074*^9}, 
   3.705293458138187*^9, {3.705293611924305*^9, 3.7052937143380537`*^9}, {
   3.7052937517161007`*^9, 3.705293886701077*^9}, {3.7052940405018597`*^9, 
   3.705294069301467*^9}, {3.7052940998130836`*^9, 3.70529410240497*^9}, {
   3.705294158682767*^9, 3.705294210092641*^9}, {3.705294243639102*^9, 
   3.705294287758873*^9}, {3.705296643209125*^9, 3.7052967848620872`*^9}, {
   3.705296839022025*^9, 3.705296849602798*^9}, {3.705296880799471*^9, 
   3.70529690332943*^9}, {3.705296951964251*^9, 3.705296956966277*^9}, {
   3.7052971295348167`*^9, 3.7052971773761673`*^9}, {3.705297544518312*^9, 
   3.705297663446692*^9}, 3.705297887937996*^9, {3.705297941876665*^9, 
   3.7052979498011837`*^9}, {3.7052979869832153`*^9, 3.705297987599801*^9}, {
   3.7052986642049713`*^9, 3.7052986644376497`*^9}, {3.7052987368318653`*^9, 
   3.705298840704857*^9}, {3.7052988918921432`*^9, 3.705298920493923*^9}, {
   3.705299473781114*^9, 3.7052994796802807`*^9}, {3.7052997025372972`*^9, 
   3.7052997173530273`*^9}, {3.705299902561019*^9, 3.705300018089386*^9}, {
   3.705300057012689*^9, 3.7053000573965263`*^9}, {3.7053000980194893`*^9, 
   3.7053001311250687`*^9}, {3.705300294561941*^9, 3.705300320336357*^9}, {
   3.705300405744686*^9, 3.705300406552545*^9}, {3.705300446383276*^9, 
   3.705300446544093*^9}, {3.705300494110099*^9, 3.7053005048207703`*^9}, {
   3.70530090954736*^9, 3.705301134460576*^9}, {3.705301332407178*^9, 
   3.70530135231676*^9}, {3.705301660627195*^9, 3.705301758691369*^9}, {
   3.705301810778324*^9, 3.705301813363123*^9}, {3.705301915186879*^9, 
   3.705301973171743*^9}, {3.7053020616473913`*^9, 3.705302061792736*^9}, {
   3.705302336245203*^9, 3.705302383985675*^9}, {3.7053024615378036`*^9, 
   3.7053024647211*^9}, {3.705302509132918*^9, 3.7053025152491837`*^9}, {
   3.705302570331689*^9, 3.7053025962860947`*^9}, {3.705302794455661*^9, 
   3.705302803116275*^9}, {3.705302882253385*^9, 3.705302987141849*^9}, {
   3.705303333754031*^9, 3.7053033923297358`*^9}, {3.705303447247937*^9, 
   3.705303698812203*^9}, {3.7053037347309513`*^9, 3.705303794576151*^9}, {
   3.705303851204859*^9, 3.70530386687055*^9}, {3.705303978048608*^9, 
   3.705304015989539*^9}, {3.705307857350231*^9, 3.705307858083166*^9}, {
   3.705308700650333*^9, 3.705308728715775*^9}, {3.7053851864541693`*^9, 
   3.705385189823866*^9}, {3.705385228292685*^9, 3.7053852285772257`*^9}, {
   3.705385290864856*^9, 3.705385293489229*^9}, {3.705385421905799*^9, 
   3.7053854430334463`*^9}, {3.705385731417651*^9, 3.705385733262224*^9}, {
   3.7053857863648443`*^9, 3.705385786460814*^9}, {3.705723036771315*^9, 
   3.7057232317180223`*^9}, {3.7057381380764637`*^9, 
   3.7057381403278217`*^9}, {3.705738176124276*^9, 3.705738260968843*^9}, 
   3.705738608071063*^9, {3.7057386661785107`*^9, 3.705738696155033*^9}, {
   3.705738739552717*^9, 3.7057388255522003`*^9}, {3.705738857087241*^9, 
   3.705738863024667*^9}, {3.7057389067571077`*^9, 3.705738937028471*^9}, {
   3.705739009587306*^9, 3.705739024960655*^9}, {3.705739062467881*^9, 
   3.705739119559057*^9}, {3.70573915908762*^9, 3.705739218404941*^9}, 
   3.705739264616764*^9, 3.705739327335144*^9, {3.70573936893161*^9, 
   3.7057393813477993`*^9}, {3.705913680622958*^9, 3.705913690244141*^9}, {
   3.705913752928967*^9, 3.705913756784409*^9}, {3.7059813089432907`*^9, 
   3.705981356907051*^9}, {3.705981392989254*^9, 3.7059814159723053`*^9}, {
   3.705981764353423*^9, 3.705981777350182*^9}, {3.7059818575068073`*^9, 
   3.705981884104355*^9}, {3.7059819237522717`*^9, 3.705981929723441*^9}, {
   3.70598205990697*^9, 3.705982071945877*^9}, {3.705982752157476*^9, 
   3.7059827758405647`*^9}, {3.705983289155574*^9, 3.705983332844392*^9}, {
   3.705983908048778*^9, 3.7059839106948853`*^9}, {3.70598395732097*^9, 
   3.705983978601652*^9}, {3.705984230824749*^9, 3.70598423599312*^9}, {
   3.705984347705736*^9, 3.7059843478617573`*^9}, {3.7059843875102386`*^9, 
   3.705984388345572*^9}, {3.7059844573543463`*^9, 3.705984459646902*^9}, {
   3.705984590353057*^9, 3.705984591795024*^9}, {3.7059846394961977`*^9, 
   3.705984658663569*^9}, {3.705984689288726*^9, 3.705984708701847*^9}, {
   3.705985064998043*^9, 3.70598513472497*^9}, {3.705985773528983*^9, 
   3.705985828288145*^9}, {3.705986030941818*^9, 3.705986084436261*^9}, {
   3.7059866775574007`*^9, 3.7059867693901987`*^9}, {3.705986829987151*^9, 
   3.705986918434267*^9}, {3.705986962955988*^9, 3.705987015114876*^9}, {
   3.7059873339373617`*^9, 3.7059873611951313`*^9}, {3.70598740161532*^9, 
   3.705987412012315*^9}, {3.705987574491012*^9, 3.705987678044581*^9}, {
   3.705988291169626*^9, 3.7059883033242273`*^9}, {3.705988359386763*^9, 
   3.705988366872992*^9}, {3.705988794602923*^9, 3.705988817155946*^9}, {
   3.705988999588422*^9, 3.705989022012693*^9}, {3.7059892254790707`*^9, 
   3.7059893736168203`*^9}, {3.705989416716905*^9, 3.705989455178505*^9}, {
   3.70598957084943*^9, 3.705989649213118*^9}, {3.70598969364682*^9, 
   3.705989751036031*^9}, {3.705989885445201*^9, 3.705989960177657*^9}, {
   3.705990217216312*^9, 3.705990230283655*^9}, {3.7059902808651857`*^9, 
   3.705990345364119*^9}, {3.705990557319564*^9, 3.705990562657579*^9}, {
   3.705990782672245*^9, 3.7059908186449003`*^9}, {3.705990877051375*^9, 
   3.705990924456079*^9}, {3.705990991802732*^9, 3.705990992067655*^9}, {
   3.705991063133174*^9, 3.705991073437008*^9}, {3.7059924121817837`*^9, 
   3.705992530208927*^9}, {3.7059928883379393`*^9, 3.705992946153357*^9}, {
   3.7059929948370247`*^9, 3.705993058943427*^9}, {3.7059932980921707`*^9, 
   3.7059933037810173`*^9}, {3.7059933657329483`*^9, 3.705993393111959*^9}, {
   3.7059934312000847`*^9, 3.705993440150673*^9}, {3.705993518183893*^9, 
   3.705993625444303*^9}, {3.705993662972682*^9, 3.7059938233141823`*^9}, {
   3.705993863610602*^9, 3.7059938914406643`*^9}, {3.705993929505357*^9, 
   3.705993966915594*^9}, {3.7059943625392637`*^9, 3.705994373653015*^9}, {
   3.705994412726768*^9, 3.705994454057073*^9}, {3.705994678403863*^9, 
   3.7059947482327538`*^9}, {3.7059948024812326`*^9, 3.705994891097687*^9}, {
   3.7059949261647367`*^9, 3.7059950415081387`*^9}, {3.705995370031122*^9, 
   3.7059953709841757`*^9}, {3.705995405360695*^9, 3.705995432701353*^9}, {
   3.705995466067439*^9, 3.705995467972025*^9}, {3.7059955059406157`*^9, 
   3.705995518685025*^9}, {3.705995551532349*^9, 3.705995591658929*^9}, 
   3.705995622195798*^9, {3.705995790674307*^9, 3.705996105291909*^9}, {
   3.705996152015524*^9, 3.705996183878426*^9}, {3.705996289337983*^9, 
   3.705996309276947*^9}, {3.705996353486627*^9, 3.705996501260627*^9}, {
   3.7059966231848593`*^9, 3.7059967051364317`*^9}, {3.70599673903454*^9, 
   3.705996839663988*^9}, {3.705996881923689*^9, 3.705996931802927*^9}, {
   3.705997008663715*^9, 3.705997053746008*^9}, {3.705997085662011*^9, 
   3.705997211922049*^9}, {3.705997394867838*^9, 3.705997555365387*^9}, {
   3.705997622521495*^9, 3.705997639222679*^9}, {3.705997893405896*^9, 
   3.7059979165981197`*^9}, {3.705998057061222*^9, 3.705998116128847*^9}, {
   3.7059981715970383`*^9, 3.705998173958157*^9}, {3.706009708231956*^9, 
   3.706009709093066*^9}, {3.706009897070361*^9, 3.706009898277586*^9}, {
   3.706009988238125*^9, 3.706010001551382*^9}, {3.7060114250088577`*^9, 
   3.706011446223936*^9}, {3.706011743936923*^9, 3.706011782865551*^9}, {
   3.70601188646025*^9, 3.7060118969566317`*^9}, {3.706012078947495*^9, 
   3.7060122970132504`*^9}, {3.706012332870673*^9, 3.706012376150633*^9}, {
   3.706012775751536*^9, 3.706012779493967*^9}, {3.706012816213613*^9, 
   3.70601284073291*^9}, {3.706012914081197*^9, 3.706012946491407*^9}, {
   3.706012977658215*^9, 3.706012992104451*^9}, {3.706013332163403*^9, 
   3.706013356502632*^9}, {3.706013573259345*^9, 3.7060136783103228`*^9}, 
   3.706013759952327*^9, {3.706013838886388*^9, 3.7060138428826303`*^9}, {
   3.7060138741189117`*^9, 3.7060138976800423`*^9}, {3.706013943474957*^9, 
   3.706013949375132*^9}, {3.706014160060913*^9, 3.706014160466408*^9}, {
   3.7060142065392723`*^9, 3.706014268349365*^9}, {3.7060299293648777`*^9, 
   3.7060299669838667`*^9}, {3.7060300694576807`*^9, 
   3.7060300835750713`*^9}, {3.706030485469371*^9, 3.706030538255686*^9}, {
   3.706030791570002*^9, 3.70603079524196*^9}, 3.706030956934888*^9, {
   3.7060318354232283`*^9, 3.706031837951342*^9}, {3.706031884130349*^9, 
   3.706031933004107*^9}, {3.706032350141871*^9, 3.7060323520995893`*^9}, {
   3.706032453416477*^9, 3.706032461238804*^9}, {3.7060325171428833`*^9, 
   3.7060325185987253`*^9}, {3.706032928488412*^9, 3.706032984835511*^9}, {
   3.706033578008252*^9, 3.706033630282621*^9}, {3.7060336719980583`*^9, 
   3.706033692827427*^9}, {3.7060337979698887`*^9, 3.706033861863656*^9}, {
   3.70603391091175*^9, 3.706033911586562*^9}, {3.706033944175456*^9, 
   3.70603394509159*^9}, {3.706034071404274*^9, 3.706034090480228*^9}, {
   3.706034344093485*^9, 3.706034411304138*^9}, {3.706034444735011*^9, 
   3.706034453744433*^9}, {3.7060345508577023`*^9, 3.706034564882123*^9}, {
   3.7060349050131273`*^9, 3.706035065473825*^9}, {3.70624121718253*^9, 
   3.706241218579421*^9}, 3.706241360613386*^9, {3.70624170516693*^9, 
   3.7062417315099173`*^9}, {3.7062437292706947`*^9, 3.706243758125078*^9}, {
   3.706243875115734*^9, 3.706243918949189*^9}, {3.706244104391144*^9, 
   3.706244122273889*^9}, {3.706244607898261*^9, 3.7062446081250772`*^9}, {
   3.706244721408293*^9, 3.706244796377308*^9}, {3.706244837341124*^9, 
   3.706245029833456*^9}, {3.7062456644064503`*^9, 3.706245700612759*^9}, {
   3.706245731245364*^9, 3.706245739427504*^9}, {3.706246054450367*^9, 
   3.7062460772214947`*^9}, {3.70624632904537*^9, 3.7062463558621807`*^9}, {
   3.706246502942149*^9, 3.706246570854295*^9}, {3.706246628539219*^9, 
   3.706246751976741*^9}, {3.706246784593099*^9, 3.706246804658778*^9}, {
   3.706246867822605*^9, 3.706246940947085*^9}, {3.706247040076668*^9, 
   3.7062470988010893`*^9}, {3.706247132490872*^9, 3.706247136666691*^9}, {
   3.706247170852536*^9, 3.706247269340583*^9}, {3.7062473173742437`*^9, 
   3.706247320826948*^9}, {3.706247363027392*^9, 3.706247427721095*^9}, {
   3.706247566500464*^9, 3.706247677407552*^9}, 3.706247736451206*^9, {
   3.7062477770599403`*^9, 3.7062477845314074`*^9}, {3.706248299243305*^9, 
   3.706248386494555*^9}, {3.706248545911954*^9, 3.70624857591109*^9}, {
   3.7062487714164047`*^9, 3.706248796411941*^9}, {3.7062488341660013`*^9, 
   3.706248886719866*^9}, {3.706248928737824*^9, 3.706248942875634*^9}, {
   3.706249001698501*^9, 3.7062490078438053`*^9}, {3.706249380854306*^9, 
   3.7062493818816633`*^9}, {3.706249434155242*^9, 3.7062494666693363`*^9}, {
   3.706249519049365*^9, 3.706249550036438*^9}, {3.7062496066730633`*^9, 
   3.7062496191334457`*^9}, {3.706249782410483*^9, 3.7062498547033453`*^9}, {
   3.706251297971162*^9, 3.706251363083086*^9}, {3.706251585979506*^9, 
   3.7062515883143044`*^9}, {3.706251626875352*^9, 3.7062516929232397`*^9}, {
   3.70625173813279*^9, 3.706251804464847*^9}, {3.706252919947699*^9, 
   3.7062529266482*^9}, {3.706253232147072*^9, 3.706253234264935*^9}, {
   3.706253276864798*^9, 3.7062533825441647`*^9}, {3.7062534957492113`*^9, 
   3.706253542354117*^9}, {3.7062536257263203`*^9, 3.706253629496188*^9}, {
   3.706253695748952*^9, 3.706253700991004*^9}, {3.706253734483376*^9, 
   3.7062537677405663`*^9}, {3.706253840832909*^9, 3.706253969959643*^9}, {
   3.706254051851592*^9, 3.7062541821284523`*^9}, {3.70625421950632*^9, 
   3.706254233548114*^9}, {3.706254302677676*^9, 3.706254471635064*^9}, {
   3.706254530263835*^9, 3.706254537413919*^9}, {3.706255341106498*^9, 
   3.70625540479604*^9}, {3.706255450871311*^9, 3.706255460186768*^9}, {
   3.7062554931026793`*^9, 3.706255537518355*^9}, {3.706255581023189*^9, 
   3.706255669008223*^9}, {3.7062557184647818`*^9, 3.7062557215441027`*^9}, {
   3.706255856876886*^9, 3.706255857490615*^9}, {3.706255891574235*^9, 
   3.706255905961547*^9}, {3.706256059991372*^9, 3.7062561842362547`*^9}, {
   3.706256218089278*^9, 3.706256229460588*^9}, {3.7062562737892427`*^9, 
   3.706256453023575*^9}, {3.706256495178485*^9, 3.706256620580948*^9}, {
   3.706256668072405*^9, 3.7062567101639833`*^9}, {3.706256745641925*^9, 
   3.70625681017964*^9}, {3.70625684238258*^9, 3.706256858980401*^9}, {
   3.706257324364374*^9, 3.706257384063334*^9}, {3.706257472936247*^9, 
   3.706257498649765*^9}, {3.706257589513754*^9, 3.706257592195167*^9}, {
   3.7062576437655907`*^9, 3.706257748899642*^9}, {3.706257804836254*^9, 
   3.706257848788732*^9}, {3.7062579235122633`*^9, 3.7062579454304953`*^9}, {
   3.70625798150872*^9, 3.706257982955022*^9}, {3.7062580506306963`*^9, 
   3.706258071214459*^9}, {3.706258137309979*^9, 3.706258142814679*^9}, {
   3.706258275982864*^9, 3.706258295044526*^9}, {3.70625841545084*^9, 
   3.7062584683101482`*^9}, {3.706258593280916*^9, 3.7062586183676653`*^9}, {
   3.7062587193482103`*^9, 3.706258722628915*^9}, {3.706258778179036*^9, 
   3.706258870667232*^9}, {3.706259081335903*^9, 3.706259082993059*^9}, {
   3.706259507988605*^9, 3.706259513900545*^9}, {3.7062596183334217`*^9, 
   3.706259695937771*^9}, {3.706330783612206*^9, 3.706330811929722*^9}, {
   3.706342762034821*^9, 3.706342797281801*^9}, {3.7063428604786797`*^9, 
   3.7063428698235826`*^9}, 3.706436962615814*^9, {3.706437461360961*^9, 
   3.7064374686467943`*^9}, {3.706437538919175*^9, 3.7064375748111897`*^9}, {
   3.706437630818524*^9, 3.706437653963113*^9}, {3.7064382551727448`*^9, 
   3.7064382557887287`*^9}, {3.70643906182644*^9, 3.706439063433023*^9}, {
   3.706439741596692*^9, 3.7064397498897467`*^9}, {3.7064399423572474`*^9, 
   3.7064399813468027`*^9}, {3.70644034391888*^9, 3.706440344821884*^9}, {
   3.706440546514017*^9, 3.70644056116584*^9}, {3.7064407333542852`*^9, 
   3.7064407373719*^9}, {3.70644081200793*^9, 3.706440883157537*^9}, {
   3.706440942644883*^9, 3.706440955001151*^9}, {3.706448676249009*^9, 
   3.706448775629497*^9}, {3.7064493308094378`*^9, 3.7064493657942057`*^9}, {
   3.706449663761032*^9, 3.7064496814534893`*^9}, {3.706456629428711*^9, 
   3.7064566947422867`*^9}, {3.7064567982359*^9, 3.7064568791660748`*^9}, {
   3.706456943593301*^9, 3.706456982895362*^9}, {3.706457364930254*^9, 
   3.706457365096998*^9}, {3.706457441477809*^9, 3.706457491324748*^9}, {
   3.7064575590940723`*^9, 3.706457708719816*^9}, {3.7064577428562*^9, 
   3.70645775107672*^9}, {3.706457799101426*^9, 3.7064578607186623`*^9}, {
   3.706457898670003*^9, 3.7064579535156612`*^9}, {3.706458000802929*^9, 
   3.706458001018239*^9}, {3.7064580550661373`*^9, 3.7064581042047033`*^9}, {
   3.706458140724389*^9, 3.706458224461994*^9}, {3.706461756018086*^9, 
   3.7064617965668993`*^9}, {3.706461920494986*^9, 3.706461934247657*^9}, {
   3.706502260844467*^9, 3.706502263059874*^9}, {3.706502306619676*^9, 
   3.706502340957513*^9}, {3.706502550959292*^9, 3.706502551946198*^9}, {
   3.706502585114703*^9, 3.70650260814682*^9}, {3.706502780933331*^9, 
   3.706502785161867*^9}, {3.706503194694964*^9, 3.706503194824492*^9}, {
   3.706503248192811*^9, 3.706503258632017*^9}, {3.7065033161237288`*^9, 
   3.7065034586600437`*^9}, {3.706503639254446*^9, 3.706503694235753*^9}, {
   3.7065040314418507`*^9, 3.7065042603024406`*^9}, {3.706504298580009*^9, 
   3.7065043239627733`*^9}, {3.7065045082872057`*^9, 3.706504512927886*^9}, {
   3.706505005891634*^9, 3.706505058496193*^9}, 3.7065051461153927`*^9, {
   3.70650607579869*^9, 3.706506076384499*^9}, {3.70650616044035*^9, 
   3.706506214281142*^9}, {3.706507555516178*^9, 3.7065075706057158`*^9}, {
   3.706507616122488*^9, 3.706507657497203*^9}, {3.706507871282762*^9, 
   3.7065078984480658`*^9}, {3.706507930383028*^9, 3.7065079584794416`*^9}, {
   3.706508028735167*^9, 3.706508099304182*^9}, {3.7065093727138357`*^9, 
   3.706509388449566*^9}, {3.7065094805106373`*^9, 3.706509488592474*^9}, {
   3.706509571080123*^9, 3.706509601835145*^9}, {3.706509673604703*^9, 
   3.706509721790305*^9}, {3.706509755244396*^9, 3.7065099095479107`*^9}, {
   3.706509956776037*^9, 3.706509992073339*^9}, {3.706510025232699*^9, 
   3.706510128731172*^9}, {3.706510451081092*^9, 3.7065104754775743`*^9}, {
   3.706510520603799*^9, 3.706510540347559*^9}, {3.706510570925349*^9, 
   3.706510588856595*^9}, {3.706512130173274*^9, 3.706512131158163*^9}, {
   3.706512167630221*^9, 3.706512181328939*^9}, {3.7065122993946257`*^9, 
   3.706512476555559*^9}, {3.706512799939794*^9, 3.70651286091591*^9}, {
   3.70651385237949*^9, 3.706513863537747*^9}, {3.706514249054594*^9, 
   3.7065142688316803`*^9}, {3.706514389538768*^9, 3.706514497186817*^9}, {
   3.706514532216638*^9, 3.7065145708890667`*^9}, {3.7065147686439543`*^9, 
   3.70651477101563*^9}, {3.706514862605081*^9, 3.7065149018010197`*^9}, {
   3.706514938085705*^9, 3.706514992982601*^9}, {3.70651502321843*^9, 
   3.706515048084738*^9}, {3.706515094216135*^9, 3.706515097234033*^9}, {
   3.706515435561634*^9, 3.706515523207204*^9}, {3.7065155654289913`*^9, 
   3.706515598443337*^9}, {3.706515641658794*^9, 3.706515690002198*^9}, {
   3.706515748620262*^9, 3.706515768043652*^9}, {3.706515808670938*^9, 
   3.706515908155115*^9}, {3.706516030768282*^9, 3.706516065400889*^9}, {
   3.7065161301498127`*^9, 3.706516133296014*^9}, {3.706516206429626*^9, 
   3.7065162929686728`*^9}, {3.7065163363520317`*^9, 3.706516343368088*^9}, {
   3.706516375252429*^9, 3.706516406954563*^9}, {3.706516550903051*^9, 
   3.706516684382011*^9}, {3.706516742557333*^9, 3.7065167440266953`*^9}, {
   3.706517657448531*^9, 3.7065177125800323`*^9}, {3.7065178596459017`*^9, 
   3.70651786023599*^9}, {3.706518020105165*^9, 3.706518056500325*^9}, {
   3.706518106044475*^9, 3.706518177551388*^9}, {3.706518211299156*^9, 
   3.706518222316951*^9}, {3.706518312143351*^9, 3.706518404726252*^9}, {
   3.706518437229823*^9, 3.7065184512930107`*^9}, {3.7065190921882257`*^9, 
   3.706519095914461*^9}, {3.706590021062077*^9, 3.70659002117944*^9}, {
   3.706590252947886*^9, 3.706590255795123*^9}, {3.706590288445293*^9, 
   3.706590296116835*^9}, {3.706590388905938*^9, 3.706590390738783*^9}, {
   3.7065928568966503`*^9, 3.706592870687175*^9}, {3.706593039069352*^9, 
   3.7065930448324633`*^9}, {3.7065930974849367`*^9, 3.706593116730452*^9}, {
   3.70659317064044*^9, 3.7065932061452827`*^9}, {3.706593253173311*^9, 
   3.706593271728599*^9}, {3.706853215373156*^9, 3.70685330022717*^9}, {
   3.706853334604957*^9, 3.706853336523492*^9}, {3.7068533786806192`*^9, 
   3.706853383992433*^9}, 3.706853449421154*^9, {3.7068554782343483`*^9, 
   3.706855478813583*^9}, {3.7071314041037283`*^9, 3.707131474125011*^9}, {
   3.7071317927896*^9, 3.707131799508236*^9}, {3.707131848559968*^9, 
   3.707131853671112*^9}, {3.7071320137688637`*^9, 3.707132077335463*^9}, {
   3.70713210763974*^9, 3.7071321273677807`*^9}, {3.707132213049734*^9, 
   3.707132229128357*^9}, {3.707132289837677*^9, 3.70713230074951*^9}, {
   3.7071576045216417`*^9, 3.7071576178873863`*^9}, {3.7071576529818077`*^9, 
   3.707157676314725*^9}, {3.707465941145788*^9, 3.707466020166457*^9}, {
   3.707466085360752*^9, 3.707466200859255*^9}, {3.7074665453610897`*^9, 
   3.7074665849265833`*^9}, {3.7074666397498302`*^9, 3.70746664340106*^9}, {
   3.707466770854087*^9, 3.707466957146106*^9}, {3.7074670384558353`*^9, 
   3.7074670758132467`*^9}, 3.707467113993164*^9, 3.707467175943679*^9, {
   3.7075493672733517`*^9, 3.707549491120492*^9}, {3.707549528932137*^9, 
   3.7075495418777246`*^9}, {3.707575938004191*^9, 3.7075759504012203`*^9}, {
   3.707579716763712*^9, 3.707579719990539*^9}, {3.707579758634995*^9, 
   3.707579784132867*^9}, {3.707579902475512*^9, 3.707580033973423*^9}, 
   3.7075818903307123`*^9, {3.7075819428601933`*^9, 3.7075819467624397`*^9}, {
   3.707581986664236*^9, 3.707582000777796*^9}, {3.707582037286564*^9, 
   3.7075820671774063`*^9}, 3.7075822341201973`*^9, {3.707582282985121*^9, 
   3.70758233571325*^9}, 3.707583985667904*^9, {3.7076379334093857`*^9, 
   3.707637941614832*^9}, {3.707638107641124*^9, 3.7076381085674686`*^9}, {
   3.7076383647236547`*^9, 3.707638452622541*^9}, {3.7076384855007763`*^9, 
   3.7076384997281637`*^9}, {3.707638595228503*^9, 3.707638597433135*^9}, {
   3.707638629853853*^9, 3.707638694180642*^9}, {3.7076387450479794`*^9, 
   3.707638811771818*^9}, {3.707638927483871*^9, 3.707638952232049*^9}, {
   3.707639056426566*^9, 3.707639150132474*^9}, {3.707639251505043*^9, 
   3.70763931452956*^9}, {3.707639692436083*^9, 3.7076396954934807`*^9}, {
   3.707719127245804*^9, 3.70771914989246*^9}, {3.707719187148534*^9, 
   3.707719187242835*^9}, 3.707719503289505*^9, {3.707720556227209*^9, 
   3.707720685751362*^9}, {3.707721123961838*^9, 3.707721155203644*^9}, {
   3.7077211965566196`*^9, 3.70772119970255*^9}, {3.707721244710166*^9, 
   3.7077212571948147`*^9}, {3.707721534314039*^9, 3.707721597800474*^9}, {
   3.707732695015037*^9, 3.7077326962252407`*^9}, {3.707732784548252*^9, 
   3.707732800449053*^9}, {3.707732840847904*^9, 3.707732873502616*^9}, {
   3.7077329060956593`*^9, 3.707732946018174*^9}, {3.7077336027400084`*^9, 
   3.707733606770207*^9}, {3.707733923046543*^9, 3.707734092555238*^9}, {
   3.707734158155652*^9, 3.707734300344297*^9}, {3.7077343321209106`*^9, 
   3.7077343713401127`*^9}, {3.707734410504928*^9, 3.707734504091647*^9}, {
   3.7077346581997643`*^9, 3.7077346695767517`*^9}, {3.707735070521221*^9, 
   3.7077351123592653`*^9}, {3.7077351955646257`*^9, 3.707735196660061*^9}, {
   3.707735301926351*^9, 3.70773533973027*^9}, 3.707735385136903*^9, {
   3.707735426274147*^9, 3.707735442115775*^9}, {3.7077354758978577`*^9, 
   3.7077355822098618`*^9}, {3.707735615278441*^9, 3.70773563170863*^9}, {
   3.707735846428733*^9, 3.707735846612348*^9}, {3.70773593243161*^9, 
   3.707736014616427*^9}, {3.7077365655288563`*^9, 3.70773659838056*^9}, {
   3.707736747940555*^9, 3.707736804527059*^9}, {3.707737070363381*^9, 
   3.707737134460249*^9}, 3.7077371941977367`*^9, {3.7077372405803127`*^9, 
   3.707737306625217*^9}, {3.707737398483204*^9, 3.707737413998562*^9}, {
   3.707737495867628*^9, 3.7077375183286657`*^9}, {3.7077375534405937`*^9, 
   3.707737656388545*^9}, {3.7077376975294533`*^9, 3.707737704553046*^9}, {
   3.70773824965408*^9, 3.707738302453381*^9}, {3.7077383512490597`*^9, 
   3.707738423046399*^9}, {3.7077384658077393`*^9, 3.707738500700541*^9}, 
   3.70780330358922*^9, 3.707803375181419*^9, {3.70780348765142*^9, 
   3.7078035686721773`*^9}, {3.707803607481648*^9, 3.707803693648343*^9}, {
   3.7078109942654533`*^9, 3.707811103930249*^9}, {3.707811763147643*^9, 
   3.707811786759828*^9}, {3.7078118562634153`*^9, 3.707811999521441*^9}, {
   3.707812109216044*^9, 3.707812156213127*^9}, {3.707812329066925*^9, 
   3.707812363250409*^9}, {3.7078124196338387`*^9, 3.7078124588400908`*^9}, {
   3.707812492528027*^9, 3.7078126775231533`*^9}, {3.707812762858016*^9, 
   3.707812879951695*^9}, {3.707812948536462*^9, 3.707813016258553*^9}, {
   3.707813075221726*^9, 3.707813139317733*^9}, {3.707813792649165*^9, 
   3.707813806771071*^9}, {3.7078138533136177`*^9, 3.707813886669022*^9}, {
   3.707813921940318*^9, 3.707813973040642*^9}, {3.707814021689506*^9, 
   3.707814045775576*^9}, {3.707814090218832*^9, 3.70781413564224*^9}, {
   3.707814181848267*^9, 3.707814182771565*^9}, {3.707814226165325*^9, 
   3.707814268268075*^9}, {3.707814317508996*^9, 3.707814765130735*^9}, {
   3.7078148176426287`*^9, 3.7078148600396223`*^9}, {3.70781490103935*^9, 
   3.707814927946382*^9}, {3.7078149652751617`*^9, 3.7078149721895323`*^9}, {
   3.711076249106537*^9, 3.711076250011035*^9}, {3.7110764108688803`*^9, 
   3.711076411472514*^9}, {3.711076451868855*^9, 3.711076529201584*^9}, 
   3.7110769077370033`*^9, {3.711077089708709*^9, 3.711077105139934*^9}, {
   3.711080345968483*^9, 3.7110804138947783`*^9}, {3.711080467802228*^9, 
   3.7110804679762793`*^9}, {3.711082762134838*^9, 3.7110828365861473`*^9}, {
   3.7110834463614902`*^9, 3.711083446574347*^9}, {3.711083922070167*^9, 
   3.711083943177844*^9}, {3.711084670159135*^9, 3.71108467355376*^9}, {
   3.711084963033689*^9, 3.711084971194949*^9}, 3.711085033122815*^9, {
   3.711085065946453*^9, 3.7110850746879263`*^9}, {3.711085609032613*^9, 
   3.71108574376938*^9}, {3.7110858369607286`*^9, 3.711085936719851*^9}, {
   3.71108597203126*^9, 3.711086010416456*^9}, {3.711086122301375*^9, 
   3.71108615276507*^9}, {3.711086192203298*^9, 3.711086243393342*^9}, {
   3.7110865836096287`*^9, 3.711086623332416*^9}, {3.7110866830172653`*^9, 
   3.711086881304578*^9}, {3.711087111763637*^9, 3.7110871189661837`*^9}, {
   3.71108734793892*^9, 3.711087519724134*^9}, {3.711087587757368*^9, 
   3.71108763096436*^9}, {3.711087708543227*^9, 3.711087714213256*^9}, {
   3.711087795849557*^9, 3.711087807133287*^9}, {3.7110878474593554`*^9, 
   3.7110879183752947`*^9}, {3.711087956309869*^9, 3.711087964831174*^9}, {
   3.711088008586546*^9, 3.711088060256014*^9}, {3.711088097464513*^9, 
   3.7110881114174356`*^9}, {3.711088145546204*^9, 3.711088197270257*^9}, {
   3.7110882436935*^9, 3.711088247667746*^9}, {3.7110885407420197`*^9, 
   3.71108854175576*^9}, {3.711088585145524*^9, 3.711088930587428*^9}, {
   3.711089227838242*^9, 3.711089293743424*^9}, {3.711089339765525*^9, 
   3.711089348082735*^9}, {3.7110894472979918`*^9, 3.7110894483071127`*^9}, {
   3.711169064487401*^9, 3.711169090040655*^9}, {3.7111691912813396`*^9, 
   3.711169210341741*^9}, {3.711169288874893*^9, 3.711169293571253*^9}, {
   3.711169454509798*^9, 3.711169455180006*^9}, {3.711169630583826*^9, 
   3.7111696607374353`*^9}, {3.71116969224677*^9, 3.7111696927227488`*^9}, {
   3.711170228904414*^9, 3.71117031092456*^9}, {3.711170444198761*^9, 
   3.711170450316287*^9}, {3.711170527287199*^9, 3.7111705541064053`*^9}, {
   3.711170625030436*^9, 3.711170701568969*^9}, {3.711170846929132*^9, 
   3.7111708480469646`*^9}, {3.711170918111161*^9, 3.711170998653996*^9}, {
   3.71117102986703*^9, 3.711171177969558*^9}, {3.7111713390922213`*^9, 
   3.711171355102103*^9}, {3.7111715228673897`*^9, 3.711171566525804*^9}, {
   3.7111716436482687`*^9, 3.711171684169895*^9}, {3.711171727015441*^9, 
   3.711171749750822*^9}, {3.7111718714341373`*^9, 3.7111718813415813`*^9}, {
   3.7111719178983727`*^9, 3.711171981337624*^9}, {3.7111720133308077`*^9, 
   3.711172097064136*^9}, {3.711172159202985*^9, 3.711172163785681*^9}, {
   3.711172231832417*^9, 3.711172283190504*^9}, {3.711172328094574*^9, 
   3.7111724131741753`*^9}, {3.7111724722777433`*^9, 3.711172586653287*^9}, {
   3.711172653196891*^9, 3.71117270028325*^9}, {3.711172807145643*^9, 
   3.7111729696617928`*^9}, {3.7111730323571873`*^9, 
   3.7111731098721457`*^9}, {3.711173160410696*^9, 3.7111731985919323`*^9}, {
   3.7111734015668907`*^9, 3.711173450337616*^9}, {3.7111737054830647`*^9, 
   3.711173738604169*^9}, {3.711173792603381*^9, 3.711173801761066*^9}, {
   3.711173841516457*^9, 3.711173876846397*^9}, {3.711174006902103*^9, 
   3.7111741111755342`*^9}, {3.711174146873064*^9, 3.7111741709358673`*^9}, {
   3.711174202379146*^9, 3.711174242757101*^9}, {3.7111743109553633`*^9, 
   3.711174320128693*^9}, {3.711174852604443*^9, 3.711174881928976*^9}, {
   3.711174917440824*^9, 3.711174919530731*^9}, {3.711175206732423*^9, 
   3.7111752070271883`*^9}, {3.711175461653493*^9, 3.7111754624880867`*^9}, {
   3.7111755142692347`*^9, 3.711175527377466*^9}, {3.7111755833248663`*^9, 
   3.7111755843455467`*^9}, {3.7111756517008047`*^9, 3.711175666473081*^9}, {
   3.711175826768401*^9, 3.711175931068639*^9}, {3.7111759961793737`*^9, 
   3.711176008110099*^9}, 3.711176051620833*^9, {3.7111761914340897`*^9, 
   3.711176336165865*^9}, {3.711176410741198*^9, 3.711176411076395*^9}, {
   3.7111770783076468`*^9, 3.711177082181086*^9}, {3.71117713856334*^9, 
   3.711177211065238*^9}, {3.711177259031373*^9, 3.711177338489583*^9}, {
   3.711177393213674*^9, 3.7111774100644283`*^9}, {3.711177491685378*^9, 
   3.7111775554246387`*^9}, {3.711177886794417*^9, 3.711177964156706*^9}, 
   3.7111780113028803`*^9, {3.711178092964117*^9, 3.711178104746307*^9}, {
   3.711178142200165*^9, 3.711178142792729*^9}, {3.711178183237871*^9, 
   3.711178211560566*^9}, {3.711181487427704*^9, 3.71118150746597*^9}, 
   3.71118155994289*^9, {3.7111817068451557`*^9, 3.7111817533779507`*^9}, {
   3.711181809984159*^9, 3.711181816830282*^9}, {3.71118188256579*^9, 
   3.711181949454337*^9}, {3.7111820723032846`*^9, 3.71118208577262*^9}, {
   3.7111842507325783`*^9, 3.711184284466919*^9}, {3.711184323179574*^9, 
   3.711184341636526*^9}, {3.7111847545251637`*^9, 3.7111847860287952`*^9}, {
   3.7111852381483107`*^9, 3.711185240722468*^9}, {3.711185764946741*^9, 
   3.7111857666922703`*^9}, {3.711186512044641*^9, 3.711186517969537*^9}, {
   3.711186577046145*^9, 3.711186618866007*^9}, {3.711186655065918*^9, 
   3.7111866734736853`*^9}, {3.7111867204411287`*^9, 3.711186748612918*^9}, {
   3.711186794602808*^9, 3.711186819567134*^9}, {3.711187036200836*^9, 
   3.711187216653249*^9}, {3.7111875486776657`*^9, 3.7111875760671587`*^9}, {
   3.711187773494898*^9, 3.71118778666365*^9}, {3.711188029852159*^9, 
   3.7111880771558647`*^9}, {3.711188179160038*^9, 3.711188179301528*^9}, {
   3.711188218025964*^9, 3.711188234399613*^9}, {3.711188299445138*^9, 
   3.711188374144781*^9}, {3.711188493355733*^9, 3.7111885800504713`*^9}, {
   3.711188610639082*^9, 3.711188713540744*^9}, {3.711188794702096*^9, 
   3.711188826825407*^9}, {3.711188863665741*^9, 3.7111892639968*^9}, {
   3.711189661246977*^9, 3.711189713715559*^9}, {3.711189794083074*^9, 
   3.711189795174592*^9}, {3.71118998582661*^9, 3.711190052548339*^9}, {
   3.711190114952579*^9, 3.711190151989986*^9}, {3.711190192692458*^9, 
   3.711190208529851*^9}, {3.711190238839307*^9, 3.711190294623542*^9}, {
   3.711190329954872*^9, 3.711190341732442*^9}, {3.711190398825757*^9, 
   3.7111904028760633`*^9}, {3.711190435352318*^9, 3.71119049625926*^9}, {
   3.7111906927891827`*^9, 3.711190842651059*^9}, {3.7111909322128143`*^9, 
   3.711190932575182*^9}, {3.711191140499773*^9, 3.711191243809835*^9}, {
   3.711191281625227*^9, 3.711191318823964*^9}, {3.711191359297291*^9, 
   3.711191408426137*^9}, {3.7111914738522053`*^9, 3.7111915460944366`*^9}, {
   3.711191577633608*^9, 3.711191605321034*^9}, {3.711191647038059*^9, 
   3.711191648609706*^9}, {3.7111918896256447`*^9, 3.711191907017627*^9}, {
   3.711191964487152*^9, 3.711192044769033*^9}, {3.711192087395803*^9, 
   3.711192113761038*^9}, {3.711192144988831*^9, 3.711192146491314*^9}, {
   3.7111921798770113`*^9, 3.711192208238632*^9}, {3.711192269476659*^9, 
   3.711192336406609*^9}, {3.7111934394827147`*^9, 3.711193475724348*^9}, {
   3.711193545669178*^9, 3.711193603912924*^9}, {3.711193831550892*^9, 
   3.7111938592724113`*^9}, {3.711193980783289*^9, 3.711194049297073*^9}, {
   3.711194092569667*^9, 3.7111941245385113`*^9}, {3.711194158964534*^9, 
   3.7111942960989656`*^9}, {3.711194341346551*^9, 3.711194348354897*^9}, {
   3.7111943789741983`*^9, 3.7111943807340317`*^9}, {3.7112016886475563`*^9, 
   3.71120169295907*^9}, {3.711201724581654*^9, 3.711201726262536*^9}, 
   3.711201759037087*^9, {3.711203187761223*^9, 3.711203215567058*^9}, {
   3.711203250450976*^9, 3.7112032706742067`*^9}, {3.711203339959942*^9, 
   3.711203352440989*^9}, 3.711203429268115*^9, {3.711203459344821*^9, 
   3.7112034605384827`*^9}, {3.711203495843745*^9, 3.711203534102955*^9}, {
   3.711203630551841*^9, 3.711203637006439*^9}, {3.711203675490794*^9, 
   3.7112036808699083`*^9}, {3.711203758801608*^9, 3.711203767944395*^9}, {
   3.71120384164421*^9, 3.711203878159667*^9}, {3.711339625843899*^9, 
   3.711339667917532*^9}, {3.711339902475814*^9, 3.711339956773549*^9}, {
   3.71134005276696*^9, 3.711340080143833*^9}, {3.711340168248633*^9, 
   3.7113401870181293`*^9}, {3.7113411592348537`*^9, 3.711341167693533*^9}, {
   3.711341205592166*^9, 3.711341226118902*^9}, {3.711346192698126*^9, 
   3.711346193489847*^9}, {3.711348027849848*^9, 3.711348087095139*^9}, {
   3.711348348805202*^9, 3.711348357597334*^9}, {3.711348668978715*^9, 
   3.711348690045905*^9}, {3.711348777545583*^9, 3.711348789453149*^9}, {
   3.711348913512733*^9, 3.711348948956318*^9}, {3.7113489860905323`*^9, 
   3.7113489896572857`*^9}, {3.711349025461096*^9, 3.7113490368957653`*^9}, {
   3.711349617621038*^9, 3.711349621529355*^9}, {3.7113533702907476`*^9, 
   3.711353401038217*^9}, {3.7113534592797613`*^9, 3.7113534598706703`*^9}, {
   3.711353856274534*^9, 3.711353868817107*^9}, {3.711354008364753*^9, 
   3.711354009547784*^9}, {3.7113541870174913`*^9, 3.7113542054725657`*^9}, {
   3.711354847441937*^9, 3.711354882811368*^9}, {3.7113549365080833`*^9, 
   3.711354955027919*^9}, {3.711355025202389*^9, 3.7113551077268753`*^9}, {
   3.711355158172502*^9, 3.7113551592729387`*^9}, {3.711355562459709*^9, 
   3.711355580876729*^9}, {3.711355961790165*^9, 3.7113560397119417`*^9}, {
   3.711356100039713*^9, 3.71135611750767*^9}, {3.711356167672617*^9, 
   3.711356226426201*^9}, {3.711356257476321*^9, 3.711356262584394*^9}, {
   3.711356351660719*^9, 3.7113563597583017`*^9}, {3.711357501841672*^9, 
   3.711357528703497*^9}, {3.7113576662394333`*^9, 3.711357770767989*^9}, {
   3.7113581489128437`*^9, 3.711358161646556*^9}, {3.71135820899518*^9, 
   3.711358342751214*^9}, {3.711358435734214*^9, 3.711358476972413*^9}, {
   3.711358555365341*^9, 3.7113586382549963`*^9}, {3.711358683221422*^9, 
   3.711358685689146*^9}, {3.711358767379915*^9, 3.711358773868766*^9}, {
   3.7113588167607*^9, 3.711358817977832*^9}, {3.711358887801382*^9, 
   3.711358929522666*^9}, {3.711358987836953*^9, 3.7113590496731663`*^9}, {
   3.711359110829299*^9, 3.711359142723885*^9}, {3.7113592279993563`*^9, 
   3.711359262622539*^9}, {3.711359308277071*^9, 3.711359309663073*^9}, {
   3.711360579316424*^9, 3.711360659289722*^9}, {3.711360752227017*^9, 
   3.711360752903206*^9}, {3.711360920148674*^9, 3.711360935018899*^9}, {
   3.711361498150445*^9, 3.7113615696174507`*^9}, {3.7113623930366983`*^9, 
   3.711362404405168*^9}, {3.711362469691575*^9, 3.711362590636661*^9}, {
   3.711362638035898*^9, 3.711362638736044*^9}, {3.7113626761360283`*^9, 
   3.711362683795649*^9}, {3.711362842791842*^9, 3.711362947598456*^9}, {
   3.7113629807734833`*^9, 3.7113629832554617`*^9}, {3.711363016182416*^9, 
   3.711363020706422*^9}, {3.711363119884424*^9, 3.7113632096021347`*^9}, {
   3.711363340742806*^9, 3.711363351152981*^9}, {3.711363383105543*^9, 
   3.711363385588291*^9}, {3.7113634310616426`*^9, 3.711363443459938*^9}, {
   3.711363596088305*^9, 3.7113636541283617`*^9}, {3.711363688350415*^9, 
   3.7113636932521677`*^9}, {3.7113640804768877`*^9, 3.711364082728804*^9}, {
   3.71136419732661*^9, 3.7113642051011753`*^9}, {3.711364236984682*^9, 
   3.7113642631236877`*^9}, {3.711364382861101*^9, 3.711364396450444*^9}, {
   3.7113644421427307`*^9, 3.711364474875566*^9}, {3.711364598016384*^9, 
   3.711364623522675*^9}, {3.7113646752135563`*^9, 3.711364780853804*^9}, {
   3.711364862307481*^9, 3.71136486319633*^9}, {3.711366065899683*^9, 
   3.711366217377677*^9}, {3.711366259399075*^9, 3.7113662664667187`*^9}, {
   3.711366580275948*^9, 3.71136662281948*^9}, {3.711366720350649*^9, 
   3.711366736337776*^9}, {3.711367146109694*^9, 3.711367181642256*^9}, {
   3.711367218051202*^9, 3.711367223427847*^9}, {3.711367263147249*^9, 
   3.7113672996950274`*^9}, {3.711367521075807*^9, 3.711367525216132*^9}, {
   3.711367734592588*^9, 3.711367753603813*^9}, {3.711367848231689*^9, 
   3.7113678654891863`*^9}, {3.711367902328944*^9, 3.711367962907378*^9}, {
   3.7113680929934807`*^9, 3.711368118467617*^9}, {3.711368169333827*^9, 
   3.711368198569048*^9}, {3.7113682589053383`*^9, 3.711368316355253*^9}, {
   3.711444012634965*^9, 3.711444014036304*^9}, {3.711444050598781*^9, 
   3.711444078171336*^9}, {3.7114441430416927`*^9, 3.711444155654361*^9}, {
   3.711444211008142*^9, 3.711444222945484*^9}, {3.711444913532843*^9, 
   3.711444917916278*^9}, {3.711445638234077*^9, 3.7114457142059803`*^9}, {
   3.711445812481102*^9, 3.711445823628696*^9}, {3.711445886980443*^9, 
   3.711445899043128*^9}, {3.7114459309905243`*^9, 3.711445979155053*^9}, 
   3.711446270581298*^9, {3.7114463308054247`*^9, 3.711446372666728*^9}, {
   3.711446743543539*^9, 3.711446743762939*^9}, {3.711446778864575*^9, 
   3.7114467920571337`*^9}, {3.711446843577504*^9, 3.71144691680796*^9}, {
   3.711446947828663*^9, 3.711447016331296*^9}, {3.7114476746674433`*^9, 
   3.711447677619226*^9}, {3.711447874898755*^9, 3.7114479129750853`*^9}, {
   3.711448074350299*^9, 3.711448100906324*^9}, {3.711448154839827*^9, 
   3.7114481583375683`*^9}, {3.711448208548778*^9, 3.7114482112670097`*^9}, {
   3.71144825994024*^9, 3.711448261454723*^9}, {3.7114482930742188`*^9, 
   3.711448325403615*^9}, {3.711448393441205*^9, 3.7114484150155973`*^9}, {
   3.711448473506063*^9, 3.711448474363574*^9}, {3.711448567332444*^9, 
   3.71144871050826*^9}, {3.711448786937727*^9, 3.7114488412292147`*^9}, {
   3.711448981241233*^9, 3.711449003358726*^9}, {3.7114491279595213`*^9, 
   3.71144917764513*^9}, 3.711449228753628*^9, {3.711449356069438*^9, 
   3.711449362875856*^9}, {3.711449468384678*^9, 3.711449790213224*^9}, {
   3.711449995322118*^9, 3.711449995852787*^9}, {3.711450073313737*^9, 
   3.711450083272072*^9}, {3.711450169316863*^9, 3.711450169732785*^9}, {
   3.711450273434507*^9, 3.711450290803741*^9}, {3.7114503473365183`*^9, 
   3.7114504401099586`*^9}, {3.71145050530264*^9, 3.711450513561553*^9}, {
   3.711450554051916*^9, 3.711450554484458*^9}, {3.711450598624017*^9, 
   3.7114507456695423`*^9}, {3.711450779494379*^9, 3.7114509437124968`*^9}, {
   3.711451480506003*^9, 3.7114515352037582`*^9}, {3.711451613543661*^9, 
   3.7114516760813723`*^9}, {3.7114517241471863`*^9, 3.711451743410972*^9}, {
   3.711451789842123*^9, 3.711451996744917*^9}, {3.711452037124004*^9, 
   3.711452180227179*^9}, 3.711452575446095*^9, 3.71145263178615*^9, {
   3.711452728547261*^9, 3.711452733948135*^9}, {3.711452781128867*^9, 
   3.711452793735079*^9}, {3.711452838738577*^9, 3.7114528396264963`*^9}, {
   3.711453090699608*^9, 3.711453126856103*^9}, {3.711453187657736*^9, 
   3.711453330458934*^9}, {3.711453419410343*^9, 3.711453437004228*^9}, {
   3.711453468783537*^9, 3.711453501650586*^9}, {3.711453554275793*^9, 
   3.7114535733112717`*^9}, {3.711453753235471*^9, 3.711453759508793*^9}, {
   3.711453823172538*^9, 3.711453837107913*^9}, {3.711453897551571*^9, 
   3.711453956160755*^9}, {3.7114541626620293`*^9, 3.711454254065056*^9}, {
   3.7114542884027243`*^9, 3.711454376674634*^9}, 3.71145441495399*^9, {
   3.711454450601775*^9, 3.711454450889942*^9}, {3.71145450061423*^9, 
   3.711454517392828*^9}, {3.711454898184688*^9, 3.711454946671588*^9}, {
   3.711454978659624*^9, 3.7114549788039713`*^9}, {3.7114550151578217`*^9, 
   3.711455191325802*^9}, {3.711455222339517*^9, 3.7114552568939257`*^9}, {
   3.711455294502894*^9, 3.7114553592119427`*^9}, {3.711455399732573*^9, 
   3.7114555270210257`*^9}, {3.7114555579879103`*^9, 3.71145556893751*^9}, {
   3.711455611079998*^9, 3.711455783636402*^9}, {3.711455842455398*^9, 
   3.711455923746694*^9}, {3.71145597958496*^9, 3.711455991349378*^9}, {
   3.7114560230990467`*^9, 3.711456155349967*^9}, {3.711456214435046*^9, 
   3.711456219301276*^9}, {3.711456254004005*^9, 3.71145632510503*^9}, {
   3.711456356292487*^9, 3.7114564469426203`*^9}, {3.7114564816246758`*^9, 
   3.711456555996478*^9}, {3.711456598088101*^9, 3.7114566480907707`*^9}, {
   3.711456679619567*^9, 3.71145673930075*^9}, {3.711456786787404*^9, 
   3.7114567890038147`*^9}, {3.71145684150487*^9, 3.711456915340357*^9}, {
   3.71145698067262*^9, 3.71145709312157*^9}, {3.711457142061902*^9, 
   3.7114572643296337`*^9}, {3.7114573255171957`*^9, 3.711457380179927*^9}, {
   3.711457419960204*^9, 3.711457440572315*^9}, {3.711550765633596*^9, 
   3.711550782986311*^9}, {3.711688376011978*^9, 3.711688376449068*^9}, {
   3.711688539225646*^9, 3.711688574928646*^9}, 3.711688641197062*^9, {
   3.7116889126716833`*^9, 3.711688931793767*^9}, {3.711688978337325*^9, 
   3.71168897906174*^9}, {3.711691938229073*^9, 3.711691948998644*^9}, {
   3.711692705074779*^9, 3.7116927052420397`*^9}, {3.711699794607367*^9, 
   3.7116999327625113`*^9}, {3.7116999875321503`*^9, 3.711700047843047*^9}, {
   3.7117006444583187`*^9, 3.71170066180112*^9}, {3.711700951973588*^9, 
   3.711700977521481*^9}, {3.711701333342249*^9, 3.7117014370386353`*^9}, {
   3.7117014706101522`*^9, 3.711701478194108*^9}, {3.711701571031974*^9, 
   3.71170172988551*^9}, {3.711707257539235*^9, 3.711707346039424*^9}, {
   3.711707439114017*^9, 3.711707447226589*^9}, {3.711707494703285*^9, 
   3.711707613608101*^9}, {3.711707652424891*^9, 3.711707652837706*^9}, {
   3.7117078749868383`*^9, 3.711707887515828*^9}, {3.7117079461981487`*^9, 
   3.711708256908557*^9}, {3.711708319083432*^9, 3.711708534418507*^9}, {
   3.711708716448113*^9, 3.711708749788947*^9}, {3.711708816530039*^9, 
   3.711708828860754*^9}, {3.7117090779699087`*^9, 3.7117090848167686`*^9}, {
   3.711709134758985*^9, 3.7117091914587507`*^9}, {3.7117092643634768`*^9, 
   3.711709320916568*^9}, {3.7117098448383102`*^9, 3.7117098578866787`*^9}, {
   3.7117099898701553`*^9, 3.711710052694724*^9}, {3.711710819446031*^9, 
   3.711710907506391*^9}, {3.71171093919237*^9, 3.7117109484048653`*^9}, {
   3.711710992896636*^9, 3.7117109942161217`*^9}, {3.7117111096288033`*^9, 
   3.71171121670175*^9}, {3.7117114560268803`*^9, 3.711711489321228*^9}, {
   3.711711542001693*^9, 3.7117117200713387`*^9}, {3.71171175116225*^9, 
   3.711711820492977*^9}, {3.711711871586306*^9, 3.711711898696576*^9}, {
   3.711712153631043*^9, 3.711712156055893*^9}, {3.711712190993113*^9, 
   3.7117122119584627`*^9}, {3.711712286992083*^9, 3.711712420006316*^9}, {
   3.711712527459572*^9, 3.711712554817479*^9}, {3.711712598210115*^9, 
   3.7117126233857517`*^9}, {3.711712663926282*^9, 3.711712677963969*^9}, {
   3.7117127143232193`*^9, 3.71171283636454*^9}, {3.711712890226419*^9, 
   3.71171297017192*^9}, {3.711713033386931*^9, 3.711713113193408*^9}, {
   3.711713270546527*^9, 3.711713376392864*^9}, {3.7117134360514383`*^9, 
   3.7117134521058598`*^9}, {3.71171354762317*^9, 3.711713702474166*^9}, {
   3.711713737915236*^9, 3.7117140280529757`*^9}, {3.711714067027259*^9, 
   3.711714103625893*^9}, {3.711714176110145*^9, 3.711714334086934*^9}, {
   3.711714380666874*^9, 3.711714405276936*^9}, {3.711714437078164*^9, 
   3.711714595293891*^9}, {3.711714635180492*^9, 3.711714690654114*^9}, {
   3.711714727742941*^9, 3.711715147171102*^9}, {3.711715235825972*^9, 
   3.7117152568149433`*^9}, {3.711784104959674*^9, 3.711784106199234*^9}, {
   3.71178445301131*^9, 3.711784453848421*^9}, {3.711784507291938*^9, 
   3.711784575125554*^9}, {3.7117846227408323`*^9, 3.711784649237905*^9}, {
   3.711784687672142*^9, 3.711784701135272*^9}, {3.7117847412317467`*^9, 
   3.7117849487836657`*^9}, {3.711785573649926*^9, 3.711785775628487*^9}, {
   3.711785820947344*^9, 3.711785895150774*^9}, {3.7117861204233627`*^9, 
   3.711786135672924*^9}, {3.7117862921580067`*^9, 3.711786359262266*^9}, {
   3.711786426547173*^9, 3.711786443039057*^9}, {3.7117865007767773`*^9, 
   3.7117865560375137`*^9}, {3.711786590416128*^9, 3.7117866012131233`*^9}, {
   3.711786730881966*^9, 3.7117867730516243`*^9}, {3.711786922551297*^9, 
   3.7117870163305607`*^9}, {3.711787088763198*^9, 3.711787180193055*^9}, {
   3.711787297166319*^9, 3.711787312665358*^9}, {3.71178735159801*^9, 
   3.711787420613758*^9}, {3.711787489864869*^9, 3.711787489989731*^9}, {
   3.7117876863656883`*^9, 3.711787750535157*^9}, {3.71178791695615*^9, 
   3.711787920653549*^9}, {3.7117881376629467`*^9, 3.711788200165227*^9}, {
   3.711788264390147*^9, 3.711788435364151*^9}, {3.71178849298979*^9, 
   3.711788499498106*^9}, {3.711788681715877*^9, 3.7117886930371017`*^9}, {
   3.711788832799857*^9, 3.711788856109014*^9}, {3.7117888915754433`*^9, 
   3.711788892061606*^9}, {3.711788931387052*^9, 3.71178901820332*^9}, {
   3.711789060665462*^9, 3.711789114448452*^9}, {3.71178930935955*^9, 
   3.711789622051798*^9}, {3.711789675012504*^9, 3.711789687131687*^9}, {
   3.711789741349247*^9, 3.711789773504673*^9}, {3.7117899270018673`*^9, 
   3.711789930118472*^9}, {3.711789967805709*^9, 3.711789994278637*^9}, {
   3.7117900360916777`*^9, 3.7117900484073677`*^9}, {3.711790080179262*^9, 
   3.711790190326627*^9}, {3.711790231165081*^9, 3.711790244126717*^9}, 
   3.7117902819888*^9, 3.711790365785543*^9, {3.7117904235505943`*^9, 
   3.711790706907007*^9}, {3.711790743010371*^9, 3.711790970360853*^9}, {
   3.711791023357136*^9, 3.711791152806876*^9}, {3.7117911841542*^9, 
   3.711791188405192*^9}, 3.711791260333805*^9, 3.7117913781427402`*^9, {
   3.711791414771887*^9, 3.711791440224498*^9}, {3.711791545568243*^9, 
   3.711791563106161*^9}, {3.711791643350531*^9, 3.7117916439666147`*^9}, {
   3.7117916873367853`*^9, 3.711791730664639*^9}, {3.711792460540369*^9, 
   3.711792676933498*^9}, {3.711792730880637*^9, 3.711792743702052*^9}, {
   3.7117933271248817`*^9, 3.7117934384779577`*^9}, {3.711793473371661*^9, 
   3.711793585897832*^9}, {3.7117936446903763`*^9, 3.711793774856956*^9}, {
   3.711794191421297*^9, 3.711794245951428*^9}, {3.711794296416274*^9, 
   3.711794396992828*^9}, {3.7117944282301188`*^9, 3.711794658178746*^9}, {
   3.711794707471777*^9, 3.711794834247944*^9}, {3.711794869397765*^9, 
   3.711794876876605*^9}, {3.711794914707821*^9, 3.711795003173275*^9}, {
   3.7117950449965963`*^9, 3.711795105253804*^9}, {3.711795161601767*^9, 
   3.711795418611628*^9}, 3.711795462802204*^9, {3.711795522745356*^9, 
   3.7117955279105864`*^9}, {3.711795610538742*^9, 3.7117956143500767`*^9}, {
   3.7117956893135757`*^9, 3.711795770860044*^9}, {3.711795806621375*^9, 
   3.7117958390778103`*^9}, {3.71179592486473*^9, 3.711795931676244*^9}, {
   3.7117960557992907`*^9, 3.711796063281951*^9}, {3.71179612639487*^9, 
   3.711796210957591*^9}, {3.711796289248413*^9, 3.711796295797208*^9}, {
   3.711796369147184*^9, 3.7117964020480833`*^9}, {3.71179662608216*^9, 
   3.7117966669407997`*^9}, {3.7117967344493847`*^9, 
   3.7117969252477283`*^9}, {3.711796968350814*^9, 3.711797099609456*^9}, 
   3.711797158565823*^9, {3.7117971901744003`*^9, 3.711797264777217*^9}, {
   3.7117972971963663`*^9, 3.711797306300507*^9}, {3.711797418931633*^9, 
   3.711797530447123*^9}, {3.711797698916926*^9, 3.711797699689649*^9}, {
   3.71179791117065*^9, 3.711797950819491*^9}, {3.7117979885087223`*^9, 
   3.7117980027172956`*^9}, {3.711798034185925*^9, 3.711798059061019*^9}, {
   3.711798201367887*^9, 3.711798298300724*^9}, {3.711799538980822*^9, 
   3.711799580941712*^9}, {3.7117996174052134`*^9, 3.711799664333276*^9}, {
   3.7117996981246433`*^9, 3.711799769055666*^9}, {3.711799820107644*^9, 
   3.71179990175733*^9}, {3.711799934133251*^9, 3.711799939016966*^9}, {
   3.711799971226782*^9, 3.711799974811883*^9}, 3.711800014357254*^9, {
   3.711800144025835*^9, 3.711800146550562*^9}, {3.7118001807361403`*^9, 
   3.711800299996344*^9}, {3.711800370806348*^9, 3.711800376689205*^9}, {
   3.711800417041902*^9, 3.71180049476162*^9}, {3.7118590295256243`*^9, 
   3.711859029789344*^9}, {3.711872751303054*^9, 3.711872763872518*^9}, {
   3.711872847164363*^9, 3.711872860563685*^9}, {3.711872891281166*^9, 
   3.711872891544774*^9}, {3.711872957161303*^9, 3.7118729584933147`*^9}, {
   3.711873009423822*^9, 3.7118730133631372`*^9}, {3.7118730468297586`*^9, 
   3.7118730625639544`*^9}, {3.7118730953086233`*^9, 
   3.7118731390962057`*^9}, {3.711873174186379*^9, 3.711873274811908*^9}, {
   3.711873822197033*^9, 3.71187383617902*^9}, {3.7118822980522213`*^9, 
   3.711882306909831*^9}, {3.71188547036269*^9, 3.711885527853188*^9}, {
   3.711885569190887*^9, 3.7118856093901978`*^9}, 3.7118862495148573`*^9, {
   3.711886830723823*^9, 3.711886835517229*^9}, {3.711886882673757*^9, 
   3.711886909966226*^9}, {3.7118869822380447`*^9, 3.711887006844308*^9}, {
   3.711887233291751*^9, 3.711887257081068*^9}, {3.711887426810306*^9, 
   3.711887428559114*^9}, {3.7118875034168997`*^9, 3.711887617375017*^9}, {
   3.711887766569253*^9, 3.71188779427701*^9}, {3.711887832128873*^9, 
   3.7118880867852097`*^9}, {3.711888152053378*^9, 3.7118881729850407`*^9}, {
   3.711888203706883*^9, 3.711888217642531*^9}, {3.711888256614128*^9, 
   3.711888327978409*^9}, {3.711888398198203*^9, 3.7118885074409943`*^9}, {
   3.711888560282297*^9, 3.711888675919918*^9}, 3.711948349341341*^9, {
   3.7119530496526213`*^9, 3.711953085800497*^9}, {3.711959784989153*^9, 
   3.7119597865755577`*^9}, {3.711960507456923*^9, 3.711960537071499*^9}, {
   3.7119605671375093`*^9, 3.711960594228026*^9}, {3.711962040336061*^9, 
   3.711962045995981*^9}, {3.711962081417602*^9, 3.7119621759318123`*^9}, {
   3.711962212124713*^9, 3.7119622263650084`*^9}, {3.711962516561172*^9, 
   3.7119625698417187`*^9}, {3.71196265050212*^9, 3.711962682317382*^9}, {
   3.711962726716455*^9, 3.71196272946348*^9}, {3.711962767424748*^9, 
   3.7119628712482233`*^9}, {3.711962910233987*^9, 3.711963064548922*^9}, {
   3.711963350561845*^9, 3.71196338505623*^9}, {3.711963418785634*^9, 
   3.711963453756783*^9}, {3.71196355522621*^9, 3.711963592773085*^9}, {
   3.7119636311430492`*^9, 3.711963657628707*^9}, {3.7119641015053577`*^9, 
   3.7119641963923273`*^9}, {3.711964354132296*^9, 3.711964554647477*^9}, {
   3.711964587335414*^9, 3.711964635096534*^9}, {3.711964735239407*^9, 
   3.7119647596866407`*^9}, {3.711964806210194*^9, 3.711964809562117*^9}, {
   3.7119652240351477`*^9, 3.711965315576467*^9}, {3.711965347548133*^9, 
   3.711965351861435*^9}, {3.711965431997693*^9, 3.7119654335336742`*^9}, {
   3.711965500191391*^9, 3.711965543641477*^9}, {3.711965993356686*^9, 
   3.711966062624126*^9}, {3.7119664631601543`*^9, 3.711966516716346*^9}, {
   3.711966634194055*^9, 3.711966674686421*^9}, {3.7119667224177713`*^9, 
   3.7119667253546467`*^9}, {3.71196682592589*^9, 3.7119668262105*^9}, {
   3.7119670688268003`*^9, 3.711967168628481*^9}, {3.711967201480136*^9, 
   3.711967266946197*^9}, {3.7119672976818027`*^9, 3.711967387340583*^9}, {
   3.7119674327029457`*^9, 3.71196744305317*^9}, {3.711967538863327*^9, 
   3.711967556165669*^9}, {3.7119676395952*^9, 3.711967719024094*^9}, {
   3.7119677681693077`*^9, 3.711967918338924*^9}, {3.711968292315563*^9, 
   3.711968324347993*^9}, {3.711969140172073*^9, 3.711969242774755*^9}, {
   3.711969316405387*^9, 3.711969319617745*^9}, {3.7119693503993807`*^9, 
   3.711969392705052*^9}, {3.7119694950500727`*^9, 3.7119695654481993`*^9}, {
   3.711969649137199*^9, 3.711969716313838*^9}, {3.711970861379126*^9, 
   3.7119709534631033`*^9}, {3.711971203301393*^9, 3.7119712337183437`*^9}, {
   3.711971338122127*^9, 3.711971392606924*^9}, {3.711971450989493*^9, 
   3.711971688717309*^9}, {3.7119717539710903`*^9, 3.711971798294956*^9}, {
   3.711971850210952*^9, 3.711971868374463*^9}, {3.711971952057358*^9, 
   3.7119719752622557`*^9}, {3.711972049963718*^9, 3.711972137703079*^9}, {
   3.711972180079288*^9, 3.711972255936721*^9}, {3.7119722955157213`*^9, 
   3.711972297151588*^9}, {3.711972327493813*^9, 3.711972418476639*^9}, {
   3.711972477694942*^9, 3.711972514603087*^9}, {3.7119725463414297`*^9, 
   3.711972600209508*^9}, {3.711972630475486*^9, 3.711972698310624*^9}, {
   3.7119727342875338`*^9, 3.711972761434218*^9}, {3.711972926512678*^9, 
   3.711973002234017*^9}, {3.711973042465145*^9, 3.711973111601922*^9}, {
   3.711973200701743*^9, 3.71197348618195*^9}, {3.712033537828726*^9, 
   3.712033550243896*^9}, {3.7120338449497643`*^9, 3.712033974195416*^9}, {
   3.712034269436159*^9, 3.712034491812441*^9}, {3.712034599217203*^9, 
   3.71203459949512*^9}, {3.712035072540472*^9, 3.7120351455559597`*^9}, {
   3.7120352284969273`*^9, 3.712035371327695*^9}, {3.7120354477096*^9, 
   3.712035495292094*^9}, {3.712035548138625*^9, 3.7120356829299498`*^9}, {
   3.712035714710857*^9, 3.7120357151538563`*^9}, {3.712035746202113*^9, 
   3.712035746356085*^9}, {3.7120358182869387`*^9, 3.712035818844575*^9}, {
   3.712035849270734*^9, 3.712035850032112*^9}, 3.71203645680392*^9, {
   3.712036514575899*^9, 3.7120365153091307`*^9}, {3.712036625347808*^9, 
   3.712036625488199*^9}, {3.7120445654812098`*^9, 3.712044570757584*^9}, {
   3.712044685190667*^9, 3.7120446935482483`*^9}, {3.712044926614204*^9, 
   3.71204492899782*^9}, {3.712045464008932*^9, 3.712045497084684*^9}, {
   3.712045671454899*^9, 3.712045673648834*^9}, {3.712045709795499*^9, 
   3.712045821917343*^9}, {3.712045853655113*^9, 3.712045870251657*^9}, {
   3.712045901249321*^9, 3.712046093033224*^9}, {3.712051939679096*^9, 
   3.712052022601418*^9}, 3.712052369862358*^9, {3.712055317433651*^9, 
   3.712055353305418*^9}, {3.712055389483309*^9, 3.712055473392084*^9}, {
   3.7120555050165167`*^9, 3.712055626111742*^9}, {3.712055707277977*^9, 
   3.7120557733631277`*^9}, {3.712055829283258*^9, 3.7120559135077143`*^9}, {
   3.712291484559189*^9, 3.712291487846279*^9}, {3.712291588459659*^9, 
   3.7122915994049387`*^9}, {3.712292487572933*^9, 3.7122925235384083`*^9}, {
   3.7122925875383368`*^9, 3.712292600499793*^9}, {3.712292815906193*^9, 
   3.7122928178569527`*^9}, {3.7122932219597588`*^9, 3.712293226772396*^9}, {
   3.7122933391604424`*^9, 3.712293395207252*^9}, {3.712293448970687*^9, 
   3.7122934687588367`*^9}, {3.712293565311905*^9, 3.71229358638242*^9}, {
   3.7122940496684647`*^9, 3.712294107042864*^9}, {3.712294160167544*^9, 
   3.712294222043564*^9}, {3.7122943390117188`*^9, 3.7122943558175898`*^9}, {
   3.712295765922201*^9, 3.7122957664931307`*^9}, {3.7123000737625713`*^9, 
   3.712300146375442*^9}, {3.712300187710394*^9, 3.712300204299726*^9}, {
   3.7123003926223516`*^9, 3.7123004125869617`*^9}, {3.712308650119464*^9, 
   3.712308704824622*^9}, {3.712308743289404*^9, 3.7123087601494226`*^9}, {
   3.7123100306068983`*^9, 3.712310074138633*^9}, {3.71231031704224*^9, 
   3.712310341841723*^9}, {3.712330687395602*^9, 3.712330743706193*^9}, {
   3.712330860401615*^9, 3.712330877146935*^9}, {3.7123318398922586`*^9, 
   3.712332002662581*^9}, {3.7123320457758417`*^9, 3.7123320601622467`*^9}, {
   3.712378396772821*^9, 3.71237840025848*^9}, {3.712378751939455*^9, 
   3.712378940749036*^9}, {3.712378995060577*^9, 3.7123790206844683`*^9}, {
   3.7123821522686462`*^9, 3.712382173798541*^9}, {3.712382205893464*^9, 
   3.712382206189845*^9}, {3.7123822519775057`*^9, 3.712382547138116*^9}, {
   3.7123828681813507`*^9, 3.712383011930462*^9}, {3.7123845510043507`*^9, 
   3.7123845816727037`*^9}, {3.71238513891396*^9, 3.712385195839135*^9}, {
   3.712385250505638*^9, 3.712385283000053*^9}, {3.712385494717189*^9, 
   3.712385497239676*^9}, {3.712385555809026*^9, 3.712385564669361*^9}, {
   3.712386295088126*^9, 3.712386348882268*^9}, {3.712386389522613*^9, 
   3.71238642214571*^9}, {3.712386468704837*^9, 3.7123865228598347`*^9}, {
   3.712386779394437*^9, 3.712386786639915*^9}, {3.712387103580235*^9, 
   3.712387151882122*^9}, {3.712387184270707*^9, 3.712387219722044*^9}, {
   3.712387932111459*^9, 3.7123880126700087`*^9}, {3.712388276672124*^9, 
   3.7123882886489563`*^9}, {3.712397540281255*^9, 3.712397540493684*^9}, {
   3.71239775091396*^9, 3.712397844909954*^9}, {3.7123978801954803`*^9, 
   3.712397912447207*^9}, {3.7123979880642633`*^9, 3.7123979963599367`*^9}, {
   3.712398163491309*^9, 3.712398234123784*^9}, {3.712398340620904*^9, 
   3.712398460373579*^9}, {3.71239852088323*^9, 3.7123985817527113`*^9}, {
   3.712398652442683*^9, 3.712398660565022*^9}, {3.71239869410109*^9, 
   3.7123987751932898`*^9}, {3.712398825861588*^9, 3.712398872572691*^9}, {
   3.712399104623087*^9, 3.71239910517691*^9}, {3.712399406399827*^9, 
   3.712399419437504*^9}, {3.71239945668172*^9, 3.712399476213359*^9}, {
   3.7123995075739326`*^9, 3.7123995834709682`*^9}, {3.712399679163911*^9, 
   3.712399702557447*^9}, {3.712399739921493*^9, 3.712399750799226*^9}, {
   3.712399885147739*^9, 3.7123999020377483`*^9}, {3.712468226667766*^9, 
   3.712468461264472*^9}, {3.712468545627756*^9, 3.7124686256761913`*^9}, {
   3.712473507311729*^9, 3.712473510708661*^9}, {3.7124736381748238`*^9, 
   3.712473678159561*^9}, {3.712473831382221*^9, 3.712473831846065*^9}, 
   3.712474139771351*^9, {3.712474172409213*^9, 3.712474178558688*^9}, {
   3.712474436151105*^9, 3.712474437345077*^9}, {3.712474471273471*^9, 
   3.71247454445786*^9}, {3.7124746125534983`*^9, 3.712474635979549*^9}, {
   3.712475111547031*^9, 3.712475111888701*^9}, {3.712991940928602*^9, 
   3.712991970483458*^9}, {3.712992004753476*^9, 3.7129920070016327`*^9}, {
   3.712992085737143*^9, 3.71299209725977*^9}, {3.713008053026774*^9, 
   3.713008065186706*^9}, {3.713159823644401*^9, 3.713159826438903*^9}, {
   3.713160035620494*^9, 3.713160063000038*^9}, {3.713160116175304*^9, 
   3.713160117445654*^9}, {3.7131603146655207`*^9, 3.713160320148995*^9}, {
   3.713160473448793*^9, 3.713160511184668*^9}, {3.7131605810592937`*^9, 
   3.713160620874181*^9}, {3.713160910921158*^9, 3.713160970902247*^9}, {
   3.7131614997014008`*^9, 3.713161504325901*^9}, {3.7131615534074697`*^9, 
   3.713161601757471*^9}, {3.713164400613202*^9, 3.7131644098252*^9}, {
   3.713164849811026*^9, 3.713164852953478*^9}, {3.7131649566794233`*^9, 
   3.713164959285563*^9}, {3.713165067468783*^9, 3.713165089420897*^9}, {
   3.7131651967456083`*^9, 3.713165206638957*^9}, {3.713165335336543*^9, 
   3.7131653875839567`*^9}, {3.713166255432336*^9, 3.7131662560448713`*^9}, {
   3.713166287027128*^9, 3.713166296333107*^9}, {3.713166525431349*^9, 
   3.713166673961823*^9}, {3.7131667366244583`*^9, 3.7131668083581867`*^9}, {
   3.713166850945574*^9, 3.7131668667315617`*^9}, {3.717740896824315*^9, 
   3.717740920348585*^9}, 3.718433082770911*^9, {3.718433116379095*^9, 
   3.718433121280457*^9}, {3.718433794592328*^9, 3.7184338005042686`*^9}, {
   3.7184342287291327`*^9, 3.718434279845648*^9}, {3.718434438607823*^9, 
   3.718434470382619*^9}, {3.718434816151368*^9, 3.718434857377289*^9}, {
   3.718435074703549*^9, 3.7184350978580637`*^9}, {3.7184352241420918`*^9, 
   3.718435370161557*^9}, {3.718435402755829*^9, 3.718435450550358*^9}, 
   3.718435491873946*^9, {3.718435542712463*^9, 3.718435554783697*^9}, {
   3.718435646103565*^9, 3.7184356464164762`*^9}, {3.7184356788517017`*^9, 
   3.718435680191382*^9}, {3.7184364126967993`*^9, 3.7184364158349113`*^9}, {
   3.718436456405889*^9, 3.718436638952447*^9}, {3.7184368214497213`*^9, 
   3.7184368457462606`*^9}, {3.718437394973195*^9, 3.71843741818786*^9}, {
   3.7184374572799063`*^9, 3.718437489483638*^9}, {3.7184375519151983`*^9, 
   3.718437673369505*^9}, {3.718437715610787*^9, 3.71843772842302*^9}, {
   3.718437759556162*^9, 3.718437760940699*^9}, {3.7184377990208073`*^9, 
   3.718437858278137*^9}, {3.718437895731235*^9, 3.718437904419031*^9}, {
   3.718437937497353*^9, 3.7184379847270193`*^9}, {3.7184380310598593`*^9, 
   3.718438161682023*^9}, {3.7184383757139397`*^9, 3.718438378437738*^9}, {
   3.718439378869073*^9, 3.718439456665374*^9}, {3.7184395520335493`*^9, 
   3.71843955239983*^9}, {3.718439632892275*^9, 3.71843967781747*^9}, {
   3.7184397804091*^9, 3.718439792258684*^9}, 3.71843994275491*^9, {
   3.718439974249208*^9, 3.71844001283427*^9}, {3.718440062177552*^9, 
   3.718440187932466*^9}, {3.718440219291905*^9, 3.718440225742943*^9}, {
   3.7184402865737257`*^9, 3.71844031385964*^9}, {3.7184403754669847`*^9, 
   3.7184404285397367`*^9}, {3.718440493831465*^9, 3.7184405084865513`*^9}, {
   3.718440539841514*^9, 3.7184405446875887`*^9}, {3.718440750516227*^9, 
   3.718440794137617*^9}, {3.718441055764512*^9, 3.718441091222275*^9}, {
   3.718441146808096*^9, 3.7184414433972588`*^9}, {3.718442165119186*^9, 
   3.7184421793278437`*^9}, {3.7184422488076553`*^9, 
   3.7184422645311728`*^9}, {3.718514143358079*^9, 3.7185141452194843`*^9}, {
   3.718514287316709*^9, 3.718514293952256*^9}, {3.7185145484286213`*^9, 
   3.71851455216544*^9}, {3.718514751276043*^9, 3.718514753871921*^9}, {
   3.718943659496356*^9, 3.718943661295362*^9}, {3.718944255408334*^9, 
   3.718944256276249*^9}, {3.718944761919257*^9, 3.718944899837243*^9}, {
   3.718944939844239*^9, 3.718944940062438*^9}, {3.71981646303267*^9, 
   3.7198165268600473`*^9}, {3.7198171709374332`*^9, 3.719817239135384*^9}, {
   3.71981733974253*^9, 3.719817432762887*^9}, {3.719817511785399*^9, 
   3.719817512031241*^9}, {3.719818339687833*^9, 3.719818387308834*^9}, {
   3.7198184341299686`*^9, 3.719818442877492*^9}, {3.719818477095112*^9, 
   3.7198185292355947`*^9}, {3.719818590232916*^9, 3.719818590513186*^9}, {
   3.719818695783081*^9, 3.7198188004333887`*^9}, {3.719818896284464*^9, 
   3.719818932076015*^9}, {3.719819007568712*^9, 3.719819017276413*^9}, {
   3.719819059404104*^9, 3.719819133140842*^9}, {3.719819226359542*^9, 
   3.7198193422956343`*^9}, {3.719819478095763*^9, 3.719819491728211*^9}, {
   3.719819528537517*^9, 3.719819531352995*^9}, {3.7198196829278393`*^9, 
   3.719819733555051*^9}, {3.719819795611095*^9, 3.719819808990177*^9}, {
   3.719819879251115*^9, 3.719819893431642*^9}, {3.719819959973699*^9, 
   3.719820207660931*^9}, {3.719820276928797*^9, 3.719820283672327*^9}, {
   3.719820472463765*^9, 3.7198204917397833`*^9}, {3.719820542837842*^9, 
   3.719820622263636*^9}, 3.719820744927588*^9, {3.71982077535964*^9, 
   3.719820789494624*^9}, 3.719820879066763*^9, {3.719821088042037*^9, 
   3.719821145494467*^9}, {3.7198213015291986`*^9, 3.71982132457307*^9}, {
   3.719821378864427*^9, 3.719821404069611*^9}, {3.719821448209812*^9, 
   3.719821481317088*^9}, {3.719821537590983*^9, 3.719821592641226*^9}, {
   3.7198366706308517`*^9, 3.719836731378975*^9}, {3.719836798440196*^9, 
   3.719836799243183*^9}, {3.719836830914555*^9, 3.7198368935582542`*^9}, {
   3.7198369311583757`*^9, 3.719837011951281*^9}, {3.719837048373719*^9, 
   3.719837210976716*^9}, {3.7198372647942944`*^9, 3.719837266514421*^9}, {
   3.7198373154044647`*^9, 3.7198374623792477`*^9}, {3.719837513477276*^9, 
   3.719837542110951*^9}, {3.719838118435501*^9, 3.719838169318275*^9}, {
   3.7198383439460506`*^9, 3.7198383555370407`*^9}, {3.719838416067502*^9, 
   3.719838416202634*^9}, {3.7198384724663563`*^9, 3.719838694349495*^9}, {
   3.719838810811722*^9, 3.719838934312458*^9}, 3.7198389827045717`*^9, {
   3.719839079875031*^9, 3.719839100417946*^9}, {3.719839218997834*^9, 
   3.719839230604124*^9}, {3.7198392825006447`*^9, 3.719839486126912*^9}, {
   3.719839541653204*^9, 3.719839607947846*^9}, {3.7198396490618877`*^9, 
   3.719839673321837*^9}, {3.719840881688265*^9, 3.719840905643732*^9}, {
   3.719840979580488*^9, 3.71984099701376*^9}, {3.7198410407977057`*^9, 
   3.719841041993085*^9}, {3.719841231996467*^9, 3.719841238871776*^9}, {
   3.719841771112615*^9, 3.7198417759454803`*^9}, {3.719841889437223*^9, 
   3.719841906648748*^9}, {3.719841960646555*^9, 3.7198419667566547`*^9}, {
   3.719842054514346*^9, 3.719842117768056*^9}, {3.719842150601295*^9, 
   3.7198421851003304`*^9}, {3.7198423281157217`*^9, 3.719842356396336*^9}, {
   3.719842401702643*^9, 3.719842504967464*^9}, {3.719842639290419*^9, 
   3.7198428136929703`*^9}, {3.719842996619223*^9, 3.7198429970896893`*^9}, {
   3.7198434015328407`*^9, 3.719843446171904*^9}, {3.719844530665492*^9, 
   3.71984455307346*^9}, {3.719847333996002*^9, 3.719847362439011*^9}, {
   3.719847395358718*^9, 3.71984739548392*^9}, {3.719847433391543*^9, 
   3.719847485324869*^9}, {3.719847554400054*^9, 3.719847580427781*^9}, {
   3.719847815047529*^9, 3.719847869217738*^9}, {3.719847909031825*^9, 
   3.7198480346728477`*^9}, {3.7198483307227573`*^9, 3.719848344596861*^9}, {
   3.719848445306061*^9, 3.719848468567746*^9}, 3.719848501811105*^9, {
   3.719848556952013*^9, 3.719848589076949*^9}, {3.719848626926611*^9, 
   3.719848644923991*^9}, {3.719848801042286*^9, 3.719848826335155*^9}, {
   3.719848957407611*^9, 3.7198490619310093`*^9}, {3.71984913460814*^9, 
   3.71984930050974*^9}, {3.7198494008688602`*^9, 3.719849401898693*^9}, {
   3.719849539150167*^9, 3.719849637543194*^9}, {3.7198496778127117`*^9, 
   3.719849719488325*^9}, {3.719849750978259*^9, 3.719849773622478*^9}, {
   3.719850222584672*^9, 3.7198502344764442`*^9}, {3.719852017570891*^9, 
   3.719852028181259*^9}, {3.719852058321063*^9, 3.719852162762538*^9}, {
   3.719852815057776*^9, 3.719852859411408*^9}, {3.7198534815298*^9, 
   3.719853821904098*^9}, {3.719853887302644*^9, 3.71985390838098*^9}, {
   3.719854263812381*^9, 3.7198542806424103`*^9}, {3.719854446016967*^9, 
   3.7198544461995487`*^9}, {3.719854491974646*^9, 3.719854509496641*^9}, {
   3.7198545785264187`*^9, 3.719854583559634*^9}, {3.719855080233634*^9, 
   3.7198550889289*^9}, {3.719855193703044*^9, 3.71985523470934*^9}, {
   3.719855298556501*^9, 3.719855312274506*^9}, {3.719857397548126*^9, 
   3.719857531108642*^9}, {3.7198576307514973`*^9, 3.719857640249876*^9}, {
   3.719857776840963*^9, 3.719857831262459*^9}, {3.719898202094595*^9, 
   3.719898212187334*^9}, {3.725907884480852*^9, 3.725907887039962*^9}, {
   3.7259416898812943`*^9, 3.725941708910166*^9}, {3.72594178544776*^9, 
   3.725941812522746*^9}, {3.725941864603599*^9, 3.7259418892554913`*^9}, {
   3.725953014375896*^9, 3.7259530487546263`*^9}, {3.725953188913986*^9, 
   3.725953191576892*^9}, {3.7259532378082113`*^9, 3.725953245887793*^9}, {
   3.725953422231166*^9, 3.7259534247489243`*^9}, {3.7259535587839327`*^9, 
   3.725953559269105*^9}, {3.725953655881415*^9, 3.7259537210510473`*^9}, {
   3.725961162211184*^9, 3.72596120546526*^9}, {3.725961247562128*^9, 
   3.725961273273486*^9}, {3.725961871364005*^9, 3.725961874178372*^9}, {
   3.725962094236124*^9, 3.725962107118916*^9}, {3.725962141251532*^9, 
   3.725962149214675*^9}, {3.725962206061194*^9, 3.7259622069315147`*^9}, {
   3.72596239165704*^9, 3.7259624299842777`*^9}, {3.7259629284924517`*^9, 
   3.725962971327662*^9}, {3.7259675425684977`*^9, 3.7259675518054447`*^9}, {
   3.7260461634011927`*^9, 3.726046212705225*^9}, {3.726083390329604*^9, 
   3.726083392054431*^9}, {3.7260836171018047`*^9, 3.7260836503721313`*^9}, 
   3.726083715950667*^9, {3.726083825263822*^9, 3.7260838408861*^9}, {
   3.726083882063841*^9, 3.726083962383801*^9}, {3.72608612713487*^9, 
   3.726086146964764*^9}, {3.726086190061212*^9, 3.726086199064212*^9}, {
   3.7260862767422743`*^9, 3.726086387149377*^9}, {3.72614509847326*^9, 
   3.726145175761685*^9}, {3.726145329340642*^9, 3.726145337770834*^9}, {
   3.726145374306085*^9, 3.72614539094242*^9}, 3.7261456090591288`*^9, {
   3.726145695973324*^9, 3.726145699903985*^9}, {3.726146976492166*^9, 
   3.726146999424899*^9}, {3.726147042812196*^9, 3.726147046020389*^9}, {
   3.7261471227773323`*^9, 3.726147147575227*^9}, {3.726147178615313*^9, 
   3.7261471933074102`*^9}, {3.726149911087194*^9, 3.7261499112956133`*^9}, {
   3.726150010221389*^9, 3.726150026108139*^9}, {3.726150804346374*^9, 
   3.726150829632481*^9}, {3.726151137065308*^9, 3.726151140118854*^9}, {
   3.7261511794432173`*^9, 3.726151190237267*^9}, {3.726151488396264*^9, 
   3.726151587829158*^9}, {3.7261516186571836`*^9, 3.726151637239543*^9}, {
   3.726151905608807*^9, 3.726151990493373*^9}, {3.726152512762659*^9, 
   3.7261525265660686`*^9}, {3.72615260865775*^9, 3.726152659597835*^9}, {
   3.726152742333988*^9, 3.726152912653029*^9}, {3.7261529971434927`*^9, 
   3.726153032478259*^9}, {3.726153086162676*^9, 3.726153146588469*^9}, {
   3.726153582152725*^9, 3.72615358235786*^9}, {3.7261536874874487`*^9, 
   3.726153715962049*^9}, {3.726153849591279*^9, 3.726153880940896*^9}, {
   3.726154136942709*^9, 3.726154146939468*^9}, 3.7261541859898853`*^9, {
   3.7261542521772137`*^9, 3.726154297218956*^9}, {3.7261544960539503`*^9, 
   3.726154513306122*^9}, {3.726154584963002*^9, 3.726154586053816*^9}, {
   3.72615462171955*^9, 3.726154648047935*^9}, {3.726154758851802*^9, 
   3.726154817864831*^9}, {3.726154859688114*^9, 3.726154860680644*^9}, {
   3.726154954513687*^9, 3.726154975183707*^9}, {3.726155052731265*^9, 
   3.7261550710096416`*^9}, {3.726155320040172*^9, 3.726155503970827*^9}, {
   3.7261559590747337`*^9, 3.72615603712803*^9}, {3.726157900807922*^9, 
   3.7261580144321632`*^9}, {3.72615950980429*^9, 3.726159632861899*^9}, {
   3.726159701453122*^9, 3.7261597022595463`*^9}, {3.7261602258104687`*^9, 
   3.726160252624837*^9}, {3.726160331673896*^9, 3.7261603342347593`*^9}, {
   3.726160365273089*^9, 3.726160412671349*^9}, {3.7261605440360107`*^9, 
   3.7261605769071293`*^9}, {3.726161035160514*^9, 3.726161136256019*^9}, {
   3.7261613661981277`*^9, 3.7261613890386667`*^9}, 3.726161428230818*^9, 
   3.726161569713749*^9, {3.726161603642*^9, 3.726161632294126*^9}, {
   3.7261616768258343`*^9, 3.726161705117921*^9}, {3.726161758008312*^9, 
   3.726161761025627*^9}, {3.7261620084501457`*^9, 3.726162084439534*^9}, {
   3.726162120806622*^9, 3.7261621739811687`*^9}, {3.726162234455676*^9, 
   3.7261622382621202`*^9}, {3.726162282463393*^9, 3.726162313845852*^9}, {
   3.726162362434656*^9, 3.7261624007078657`*^9}, {3.7261624383854523`*^9, 
   3.7261624439376173`*^9}, {3.726162543039404*^9, 3.72616256137957*^9}, {
   3.726162614041788*^9, 3.7261626529678373`*^9}, {3.726162689416954*^9, 
   3.726162776592325*^9}, {3.7261628303504343`*^9, 3.72616288036545*^9}, {
   3.726163102349287*^9, 3.726163129836529*^9}, {3.726163345213479*^9, 
   3.726163362229927*^9}, 3.726163426346727*^9, {3.726163491710826*^9, 
   3.7261635135357437`*^9}, {3.7261635478444767`*^9, 3.726163592002199*^9}, {
   3.726163651069119*^9, 3.7261637012311068`*^9}, {3.72616373338561*^9, 
   3.726163735650597*^9}, {3.726163824431641*^9, 3.726163825236947*^9}, 
   3.726163861287184*^9, {3.726163910007505*^9, 3.7261639893278723`*^9}, {
   3.7261642413406963`*^9, 3.726164242001803*^9}, {3.726164274818325*^9, 
   3.7261642750010366`*^9}, {3.726164497547058*^9, 3.726164541012733*^9}, {
   3.7261645718316603`*^9, 3.7261645744958363`*^9}, {3.7261646485747833`*^9, 
   3.726164649561838*^9}, {3.726165817753214*^9, 3.7261658432042522`*^9}, {
   3.726165897070456*^9, 3.726165914029997*^9}, {3.7261659587872257`*^9, 
   3.7261660029659967`*^9}, {3.726166480033621*^9, 3.7261665237393847`*^9}, {
   3.7261665680386353`*^9, 3.72616664646999*^9}, {3.726166788168057*^9, 
   3.7261669039231043`*^9}, {3.726167054398129*^9, 3.726167055508135*^9}, {
   3.7261671273929*^9, 3.726167131297961*^9}, {3.726167345071933*^9, 
   3.726167373482093*^9}, {3.7261678524382963`*^9, 3.726167857758009*^9}, {
   3.726167897477455*^9, 3.726167897604302*^9}, {3.726168019593164*^9, 
   3.726168050968301*^9}, 3.726168961565009*^9, {3.726169712432934*^9, 
   3.726169730959427*^9}, {3.726169774704192*^9, 3.726169803163211*^9}, {
   3.72616987328306*^9, 3.726169897923669*^9}, {3.726170068706321*^9, 
   3.72617008898816*^9}, {3.726170206926807*^9, 3.7261702133975058`*^9}, {
   3.726170284643056*^9, 3.72617030235266*^9}, {3.726170357251071*^9, 
   3.7261703967051973`*^9}, {3.726171991082966*^9, 3.726172019915915*^9}, {
   3.726191706590757*^9, 3.7261917078498297`*^9}, {3.726191856745885*^9, 
   3.726191858769064*^9}, {3.726192461126834*^9, 3.7261924634290648`*^9}, {
   3.7261925692610083`*^9, 3.72619261173857*^9}, {3.7261926488775167`*^9, 
   3.7261927239529877`*^9}, {3.727675217047295*^9, 3.7276752328677073`*^9}, 
   3.730486305178606*^9, {3.7305438091645803`*^9, 3.730543809671022*^9}, {
   3.730544628490855*^9, 3.7305446288130913`*^9}, {3.735034339224636*^9, 
   3.735034394262432*^9}, {3.735035068563897*^9, 3.7350350942591677`*^9}, {
   3.735035365433497*^9, 3.735035375702311*^9}, {3.735035695379874*^9, 
   3.7350357428040247`*^9}, {3.735035795176746*^9, 3.735035832209834*^9}, 
   3.7379684689692163`*^9, 3.73796850029288*^9, {3.7379685462939243`*^9, 
   3.737968546845901*^9}, {3.743865457091934*^9, 3.7438654573502207`*^9}, {
   3.7441703362609653`*^9, 3.74417033906672*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[254]:=",ExpressionUUID->"379502d5-c106-457f-bf54-55fc37b9d320"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}, {3.704963743924171*^9, 3.70496374747575*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[255]:=",ExpressionUUID->"96d5baa1-d63b-4337-8c39-23d634ea0015"]
}, Closed]],

Cell[CellGroupData[{

Cell["$CrystalData", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105586847556*^9, {3.682241958663896*^9, 
   3.682241959378373*^9}},ExpressionUUID->"7edb0c14-61cb-42de-9604-\
9832a854accc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[256]:=",ExpressionUUID->"01f0d7dc-69ff-4dfe-8296-76c5dc587e1e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$CrystalData", "::", "type"}], "=", 
   "\"\<The atomic displacement type \[LeftGuillemet]`1`\[RightGuillemet] is \
not recognised.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$CrystalData", "::", "missing"}], "=", 
   "\"\<Could not find \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.6827638542963467`*^9, 
  3.682763915713602*^9}, {3.684127075557765*^9, 3.684127078014738*^9}, {
  3.686643559763439*^9, 3.686643568230299*^9}, {3.687071196515999*^9, 
  3.687071197034121*^9}, {3.6870742005298843`*^9, 3.6870742032175207`*^9}, {
  3.704639240714119*^9, 3.7046392573277903`*^9}, {3.70463928912825*^9, 
  3.704639290872594*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"512d40c8-4127-484a-9a2c-19a31e34fcfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[259]:=",ExpressionUUID->"d039b04d-8074-42cb-a636-7e089792d99c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CrystalData", ":=", 
   RowBox[{"$CrystalData", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<CrystalData.m\>\""}], "}"}], "]"}], ",", "\"\<Package\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106475250269*^9, {3.6681967313149557`*^9, 
   3.668196733689879*^9}, {3.6822419646436443`*^9, 3.68224201227671*^9}, {
   3.683952010557645*^9, 3.683952016431329*^9}, {3.683961792986683*^9, 
   3.683961793311263*^9}, {3.683963496892716*^9, 3.6839635022396917`*^9}, {
   3.683964204041622*^9, 3.68396420579144*^9}, {3.685074117426893*^9, 
   3.685074118118947*^9}, {3.685087550914459*^9, 3.6850875516532784`*^9}, {
   3.685088292962201*^9, 3.6850882971592493`*^9}, {3.717735641959559*^9, 
   3.717735646517908*^9}, {3.7177401759152184`*^9, 3.717740183511532*^9}, {
   3.717740453355052*^9, 3.7177404568146343`*^9}, 3.7190621124925756`*^9, {
   3.719062147618576*^9, 3.7190621487295322`*^9}, 3.743865412920252*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[260]:=",ExpressionUUID->"afcdcef5-20c0-43a4-bb25-f286a4ca0572"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[261]:=",ExpressionUUID->"0ed89cd1-a647-47ba-8769-25c82785c977"]
}, Closed]],

Cell[CellGroupData[{

Cell["$LaueClasses", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, {3.682653951735921*^9, 
   3.682653956328863*^9}, {3.682654662784809*^9, 3.682654665448794*^9}, {
   3.682682388932765*^9, 3.682682393482984*^9}, 
   3.6827484886268806`*^9},ExpressionUUID->"1ee9796d-ca33-4f47-82bc-\
fd855441723e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[262]:=",ExpressionUUID->"308dc694-917e-49d3-a8c7-791e8fd1bd1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$LaueClasses", "::", "notLaue"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid Laue \
class.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
  3.682673965137134*^9}, {3.682748313468276*^9, 3.682748314787609*^9}, {
  3.6827550362995253`*^9, 3.6827550568881807`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"68d9ecfb-bdcc-4260-806b-3de8af194b3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[264]:=",ExpressionUUID->"60bc7d5c-22ff-47db-bb5d-a3d7ff01acfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$LaueClasses", ":=", 
   RowBox[{"$LaueClasses", "=", 
    RowBox[{"$PointGroups", "[", 
     RowBox[{"[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<-1\>\"", ",", "\"\<2/m\>\"", ",", "\"\<mmm\>\"", ",", 
        "\"\<4/m\>\"", ",", "\"\<4/mmm\>\"", ",", "\"\<-3\>\"", ",", 
        "\"\<-3m\>\"", ",", "\"\<6/m\>\"", ",", "\"\<6/mmm\>\"", ",", 
        "\"\<m-3\>\"", ",", "\"\<m-3m\>\""}], "}"}], "]"}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.682653967735579*^9, 3.682653986558272*^9}, 
   3.68267392867793*^9, {3.682674020022552*^9, 3.6826740225343513`*^9}, {
   3.6826741539192142`*^9, 3.682674156130925*^9}, {3.682748319844285*^9, 
   3.682748354898033*^9}, {3.682748401076961*^9, 3.682748460879797*^9}, {
   3.682753925716236*^9, 3.68275392829173*^9}, {3.683964155468678*^9, 
   3.6839641888501*^9}, {3.683964347600403*^9, 3.683964350017806*^9}, {
   3.71774020225284*^9, 3.71774021766649*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[265]:=",ExpressionUUID->"7fbd8156-a87a-4ffc-bf25-a7b43740946c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[266]:=",ExpressionUUID->"e432a5ba-f266-4c39-aedb-f76fedc376cc"]
}, Closed]],

Cell[CellGroupData[{

Cell["$PeriodicTable", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105586847556*^9, {3.682241958663896*^9, 3.682241959378373*^9}, {
   3.684837792510861*^9, 3.6848377965834007`*^9}, {3.716871395312171*^9, 
   3.71687139746762*^9}, {3.716875096229806*^9, 
   3.71687509881006*^9}},ExpressionUUID->"e82899cb-5142-48ca-aa63-\
a1ae32398367"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[267]:=",ExpressionUUID->"9cfe6c3b-dca6-4c02-8fa1-820e33d7db46"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$PeriodicTable", "::", "data"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.716875468133792*^9},
 CellLabel->
  "In[268]:=",ExpressionUUID->"4010deae-e59c-43c8-bb68-e8d2ef5b1682"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[269]:=",ExpressionUUID->"18075ca2-c35c-4706-aae5-a16164bf4c43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$PeriodicTable", ":=", 
   RowBox[{"$PeriodicTable", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<PeriodicTable.m\>\""}], "}"}], "]"}], ",", "\"\<Package\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678115931321983`*^9, 3.668106475250269*^9, {3.6681967313149557`*^9, 
   3.668196733689879*^9}, {3.6822419646436443`*^9, 3.68224201227671*^9}, {
   3.683952010557645*^9, 3.683952016431329*^9}, {3.683961792986683*^9, 
   3.683961793311263*^9}, {3.683963496892716*^9, 3.6839635022396917`*^9}, {
   3.683964204041622*^9, 3.68396420579144*^9}, {3.684837841202917*^9, 
   3.6848378571558647`*^9}, {3.7168715395254583`*^9, 3.716871544624135*^9}, {
   3.716875466491188*^9, 3.716875471562603*^9}, {3.7177356550597057`*^9, 
   3.717735658940343*^9}, {3.71774022412532*^9, 3.7177402275061703`*^9}, {
   3.717740292420858*^9, 3.717740296349738*^9}, 3.743865412979974*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[270]:=",ExpressionUUID->"89e11bbe-d625-4cd9-81c0-b92b2ef2db50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[271]:=",ExpressionUUID->"36b58bcf-aee4-4393-9da7-2eda9350067f"]
}, Closed]],

Cell[CellGroupData[{

Cell["$PointGroups", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, {3.682653951735921*^9, 
   3.682653956328863*^9}, {3.682654662784809*^9, 3.682654665448794*^9}, {
   3.682682396844181*^9, 3.682682399130838*^9}, 
   3.683540068227051*^9},ExpressionUUID->"14e7537d-d85f-464d-8285-\
8e7421791d94"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[272]:=",ExpressionUUID->"2eeb92ce-21c2-4b72-81f9-3339b30a20dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$PointGroups", "::", "symbol"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
   3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
   3.682673965137134*^9}, {3.6827448103688383`*^9, 3.682744814802577*^9}, 
   3.6835400730631437`*^9, 3.683962753616817*^9, 3.683962930309997*^9},
 CellLabel->
  "In[273]:=",ExpressionUUID->"a54cc151-3acd-4ac8-9750-5a865c9d6de0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[274]:=",ExpressionUUID->"f7842086-a5a9-4f31-8f35-2cf414a16585"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$PointGroups", ":=", 
   RowBox[{"$PointGroups", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<PointGroups.m\>\""}], "}"}], "]"}], ",", "\"\<Package\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.682653967735579*^9, 3.682653986558272*^9}, 
   3.68267392867793*^9, {3.682674020022552*^9, 3.6826740225343513`*^9}, {
   3.6826741539192142`*^9, 3.682674156130925*^9}, {3.68274481796653*^9, 
   3.6827448258026237`*^9}, 3.683540074217566*^9, {3.683951936766644*^9, 
   3.683951973478841*^9}, {3.683956166711895*^9, 3.683956184411542*^9}, {
   3.683956417196473*^9, 3.683956418066112*^9}, {3.683961462919252*^9, 
   3.68396154474839*^9}, {3.683961661862376*^9, 3.6839616629603977`*^9}, {
   3.683961724218606*^9, 3.683961724688292*^9}, 3.683962755396636*^9, {
   3.6839629325079536`*^9, 3.683962946272767*^9}, 3.683963808604355*^9, {
   3.6839638719964027`*^9, 3.683963874849616*^9}, {3.683964121228015*^9, 
   3.683964133461834*^9}, {3.68507416316628*^9, 3.6850741636682453`*^9}, {
   3.717735248551661*^9, 3.717735254555373*^9}, {3.717740411085682*^9, 
   3.717740418544074*^9}, 3.743865413035719*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[275]:=",ExpressionUUID->"c179305c-a4bf-4194-8043-f7e900eb0689"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[276]:=",ExpressionUUID->"4c112612-115f-4f20-8cb3-c544fd7ce9c5"]
}, Closed]],

Cell[CellGroupData[{

Cell["$SpaceGroups", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745593267642*^9, {3.6822418234494753`*^9, 3.682241827024156*^9}, {
   3.682327359060165*^9, 3.682327361940929*^9}, {3.682327435776711*^9, 
   3.6823274383615713`*^9}, 3.682327610544837*^9, {3.682653951735921*^9, 
   3.682653956328863*^9}, {3.682654662784809*^9, 
   3.682654665448794*^9}},ExpressionUUID->"7ed11d35-40ee-43d9-94e8-\
482b81aefcf5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[277]:=",ExpressionUUID->"d9b18289-34f4-4aa1-b46b-519c61097da9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$SpaceGroups", "::", "symbol"}], "=", 
   "\"\<No data found on \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
  3.682673965137134*^9}, {3.6836256108304625`*^9, 3.683625616992581*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"1e553c1a-b85b-4618-b123-3887ed26fcb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[279]:=",ExpressionUUID->"1a7547e2-9cdf-4e62-87bb-e2a246cfd48d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$SpaceGroups", ":=", 
   RowBox[{"$SpaceGroups", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<SpaceGroups.m\>\""}], "}"}], "]"}], ",", "\"\<Package\>\""}], 
     "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.682653967735579*^9, 3.682653986558272*^9}, 
   3.68267392867793*^9, {3.682674020022552*^9, 3.6826740225343513`*^9}, {
   3.6826741539192142`*^9, 3.682674156130925*^9}, {3.68362561327971*^9, 
   3.6836256181626034`*^9}, {3.683951992468999*^9, 3.683951997388053*^9}, 
   3.6839617760181627`*^9, {3.6839634791727533`*^9, 3.683963485387003*^9}, {
   3.683964172298621*^9, 3.683964173046796*^9}, {3.68507417341897*^9, 
   3.685074173905542*^9}, {3.717735270644731*^9, 3.717735275889902*^9}, 
   3.7177404443170958`*^9, 3.743865413098959*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[280]:=",ExpressionUUID->"fdd0a9e9-fcdb-4349-a199-467535dfc2ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[281]:=",ExpressionUUID->"07e5c605-8135-430b-b7b7-11a2648d2150"]
}, Closed]],

Cell[CellGroupData[{

Cell["$TransformationMatrices", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, {
   3.6678113884901648`*^9, 3.66781139169668*^9}, {3.667811515797525*^9, 
   3.667811516189644*^9}, {3.667900125753806*^9, 3.667900130001958*^9}, 
   3.668105586847556*^9, {3.682241958663896*^9, 3.682241959378373*^9}, {
   3.6823261988097973`*^9, 3.68232620251079*^9}, {3.6823262335807447`*^9, 
   3.6823262349234543`*^9}, 3.683968853065186*^9, {3.704529586053939*^9, 
   3.70452958946212*^9}},ExpressionUUID->"1afa8fde-ca4b-42aa-8d46-\
b2e2acee4420"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[282]:=",ExpressionUUID->"3b4ababb-599b-4d81-8973-f4082bedc3a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$TransformationMatrices", "::", "incompatible"}], "=", 
   "\"\<Incompatible transformation request.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6823234500551777`*^9, 3.682323473900485*^9}, {
  3.6823272571099*^9, 3.682327297562955*^9}, {3.682673953877255*^9, 
  3.682673965137134*^9}, {3.6836256108304625`*^9, 3.683625616992581*^9}, {
  3.704605089218741*^9, 3.704605090581002*^9}, {3.704605126799118*^9, 
  3.704605145762704*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"1b6edf07-1915-46fe-90ec-715622ba3248"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[284]:=",ExpressionUUID->"8d0c8b9a-5232-4995-b361-c07f758ee9a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$TransformationMatrices", ":=", 
   RowBox[{"$TransformationMatrices", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<TransformationMatrices.m\>\""}], "}"}], "]"}], ",", 
      "\"\<Package\>\""}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.682241896337058*^9, 3.6822419009563293`*^9}, {
   3.6822421030731297`*^9, 3.682242104796829*^9}, {3.682242247634622*^9, 
   3.682242293608499*^9}, {3.6822423242774973`*^9, 3.6822424939877663`*^9}, {
   3.682242524871819*^9, 3.682242610095582*^9}, {3.6822426631468697`*^9, 
   3.682242849688897*^9}, {3.682242985123843*^9, 3.682243000592795*^9}, {
   3.682243032221999*^9, 3.682243042906146*^9}, {3.682243121993319*^9, 
   3.682243187533738*^9}, {3.6822433171568623`*^9, 3.682243318068676*^9}, {
   3.6822433533711243`*^9, 3.68224345949043*^9}, {3.682243499999116*^9, 
   3.682243500570818*^9}, {3.682243559642397*^9, 3.682243568303032*^9}, {
   3.682243656585619*^9, 3.682243807041559*^9}, {3.682243892622666*^9, 
   3.682243979341007*^9}, {3.682244011749632*^9, 3.682244092729911*^9}, {
   3.6822441869470167`*^9, 3.682244221175058*^9}, {3.68224427065597*^9, 
   3.682244283409008*^9}, {3.6822443160128517`*^9, 3.682244326447394*^9}, {
   3.682244392020493*^9, 3.682244400571671*^9}, {3.682244596208706*^9, 
   3.682244803339835*^9}, {3.682244951115906*^9, 3.6822449654470167`*^9}, {
   3.682247256239483*^9, 3.682247304444981*^9}, {3.682247343926553*^9, 
   3.682247361035624*^9}, {3.682247395780785*^9, 3.6822474984407682`*^9}, {
   3.6822475305652437`*^9, 3.682247636381772*^9}, {3.6822476807262373`*^9, 
   3.682247690229601*^9}, {3.682247723533629*^9, 3.682247825538166*^9}, {
   3.682247866195016*^9, 3.6822478768890457`*^9}, {3.682247927112714*^9, 
   3.682248080675892*^9}, {3.682248357004342*^9, 3.682248375626561*^9}, {
   3.6822486441315317`*^9, 3.682248669634107*^9}, 3.68224956936229*^9, 
   3.682262332986014*^9, {3.6822623719028997`*^9, 3.68226237223594*^9}, {
   3.682312281830681*^9, 3.6823123030407467`*^9}, {3.682323578349629*^9, 
   3.682323592418137*^9}, {3.6823237158461313`*^9, 3.682323721213748*^9}, 
   3.6823275058706827`*^9, {3.682653967735579*^9, 3.682653986558272*^9}, 
   3.68267392867793*^9, {3.682674020022552*^9, 3.6826740225343513`*^9}, {
   3.6826741539192142`*^9, 3.682674156130925*^9}, {3.68362561327971*^9, 
   3.6836256181626034`*^9}, {3.683951992468999*^9, 3.683951997388053*^9}, 
   3.6839617760181627`*^9, {3.6839634791727533`*^9, 3.683963485387003*^9}, {
   3.683964172298621*^9, 3.683964173046796*^9}, {3.68507417341897*^9, 
   3.685074173905542*^9}, {3.704605096591127*^9, 3.7046051029972353`*^9}, 
   3.704962715541875*^9, {3.71774051631643*^9, 3.7177405247020407`*^9}, 
   3.743865413160309*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[285]:=",ExpressionUUID->"dcb3ea01-2d35-4494-8d26-2f28b03e4378"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[286]:=",ExpressionUUID->"3c8346e8-6fe5-48fa-8ec1-1ef223016a93"]
}, Closed]],

Cell[CellGroupData[{

Cell["$MaXrdChangelog", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9, {3.6856909140644207`*^9, 3.6856909161285*^9}, {
   3.6856955548132*^9, 3.685695556654903*^9}, {3.6858508531390133`*^9, 
   3.685850855128764*^9}, {3.6858530128919897`*^9, 
   3.6858530141106453`*^9}},ExpressionUUID->"d99b6346-74cc-4cf8-afd7-\
795dc476aa8c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[287]:=",ExpressionUUID->"b4079e1c-152a-4503-82bd-ddd31b20c62f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$MaXrdChangelog", "::", "fileMissing"}], "=", 
   "\"\<Cannot find the `1` file (`2`).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.744701964988227*^9, 3.7447019775276012`*^9}, {
  3.744705774667625*^9, 3.74470577651867*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"5b9764d2-32b5-4f2f-ba66-9bd1076f63ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[289]:=",ExpressionUUID->"7594a992-6237-4e17-99d8-a3ee22dbcb31"],

Cell[BoxData[
 RowBox[{"$MaXrdChangelog", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dir", "=", "$MaXrdPath"}], ",", "\[IndentingNewLine]", 
      "pacletFile", ",", "packletVersion", ",", "\[IndentingNewLine]", 
      "packageSymbols", ",", "\[IndentingNewLine]", "changelogFile", ",", 
      "log", ",", "current", ",", "content", ",", "new", ",", "t", ",", 
      "title", ",", "post", ",", "\[IndentingNewLine]", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Load", " ", "current", " ", "version"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Undeployed", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"dir", ",", "8"}], "]"}], "===", "\"\<./MaXrd/\>\""}], ",", 
       RowBox[{"dir", "=", 
        RowBox[{"ParentDirectory", "@", "dir"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"pacletFile", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dir", ",", "\"\<PacletInfo.m\>\""}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "pacletFile"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"$MaXrdChangelog", "::", "fileMissing"}], ",", 
          "\"\<paclet\>\"", ",", "pacletFile"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"packletVersion", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Association", "@@", 
         RowBox[{"Import", "@", "pacletFile"}]}], ")"}], "[", "Version", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Latest", " ", "entry", " ", "in", " ", "the", " ", "changelog"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"changelogFile", "=", 
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<Changelog.md\>\"", ",", 
         RowBox[{"{", "dir", "}"}], ",", "2"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "changelogFile"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"$MaXrdChangelog", "::", "fileMissing"}], ",", 
          "\"\<changelog\>\"", ",", "changelogFile"}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"log", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"changelogFile", ",", "\"\<Text\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"current", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"StringCases", "[", 
         RowBox[{"log", ",", 
          RowBox[{
           RowBox[{"Shortest", "[", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<## Version \>\"", "~~", "packletVersion", "~~", 
             "\"\<\\n\>\"", "~~", "news__", "~~", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\"\<\\n\\n\\n##\>\"", ",", "EndOfString"}], "}"}]}], 
            "]"}], "\[RuleDelayed]", "news"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", "Content", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"content", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"First", "@", "current"}], ",", "\"\<\\n\>\""}], "]"}]}], ";",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"content", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringDrop", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "content"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"content", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TextCell", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", "#", "}"}], "]"}], ",", "\"\<Item\>\""}], "]"}], 
        "&"}], "/@", "content"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Format", " ", "function", " ", "names"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"packageSymbols", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"Cases", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"First", "@", "$MaXrdFunctions"}]}], ",", "_Hyperlink"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"new", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"content", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"t", "=", 
         RowBox[{"{", 
          RowBox[{
          "StartOfString", ",", "\"\<\>\"", ",", "\"\<.\>\"", ",", 
           "\"\<,\>\"", ",", "\"\<!\>\""}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"new", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Row", "@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{"temp", ",", 
             RowBox[{"{", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{
                  RowBox[{"a", ":", "t"}], "~~", "\"\<**\>\"", "~~", "x__", 
                  "~~", "\"\<**\>\"", "~~", 
                  RowBox[{"b", ":", "t"}]}], "]"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"a", "<>", "x", "<>", "b"}], ",", "Bold"}], "]"}]}],
                ",", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{
                  RowBox[{"a", ":", "t"}], "~~", "\"\<_\>\"", "~~", "x__", 
                  "~~", "\"\<_\>\"", "~~", 
                  RowBox[{"b", ":", "t"}]}], "]"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"a", "<>", "x", "<>", "b"}], ",", "Italic"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{
                  RowBox[{"a", ":", "t"}], "~~", "\"\<*\>\"", "~~", "x__", 
                  "~~", "\"\<*\>\"", "~~", 
                  RowBox[{"b", ":", "t"}]}], "]"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"a", "<>", "x", "<>", "b"}], ",", "Italic"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"Shortest", "[", 
                 RowBox[{
                  RowBox[{"a", ":", "t"}], "~~", "\"\<`\>\"", "~~", "x__", 
                  "~~", "\"\<`\>\"", "~~", 
                  RowBox[{"b", ":", "t"}]}], "]"}], "\[RuleDelayed]", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"packageSymbols", ",", "x"}], "]"}], ",", 
                  "\[IndentingNewLine]", "\t", 
                  RowBox[{"Hyperlink", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"\"\<paclet:/MaXrd/Ref/\>\"", "<>", "x"}]}], 
                   "]"}], ",", "\[IndentingNewLine]", "\t", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"a", "<>", "x", "<>", "b"}], ",", 
                    "\"\<Program\>\""}], "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "\t", "}"}]}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "content"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"new", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"TextCell", "[", 
         RowBox[{"#", ",", "\"\<Item\>\""}], "]"}], "&"}], "/@", "new"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Title", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"title", "=", 
      RowBox[{"TextCell", "@", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Changelog for the \>\"", ",", "\"\<Text\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FontSize", "\[Rule]", "24"}], ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}], ",",
             "Italic"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<MaXrd\>\"", ",", "\"\<Program\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Italic"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{
            "\"\< package \[LongDash] version \>\"", "<>", "packletVersion"}],
             ",", "\"\<Text\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Italic", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}]}], 
           "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Log", " ", "file", " ", "link"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"MaXrd`Private`$changelogFile", "=", "changelogFile"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"post", "=", 
      RowBox[{"TextCell", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mouseover", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Click here\>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"SystemOpen", "@", "MaXrd`Private`$changelogFile"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"BaseStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<GenericButton\>\"", ",", "#"}], "}"}]}]}], 
                "]"}], "&"}], "/@", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.269993", ",", "0.308507", ",", "0.6"}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                 "0.823529411764706", ",", "0.490196078431373", ",", 
                  "0.133333333333333"}], "]"}]}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", "\"\< to see the complete changelog.\>\""}],
           "\[IndentingNewLine]", "\t", "}"}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", "\"\<Item\>\""}], "\[IndentingNewLine]", 
       "\t", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Print", " ", "all", " ", "cells"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"CreateDocument", "[", 
      RowBox[{
       RowBox[{"CellGroup", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "title", "}"}], ",", "new", ",", 
          RowBox[{"{", "post", "}"}]}], "]"}]}], ",", 
       RowBox[{"CellGrouping", "\[Rule]", "Manual"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.6858508794369802`*^9, 3.685851146037546*^9}, {
   3.68585121114992*^9, 3.685851280289015*^9}, 3.6858513574491*^9, {
   3.685851389819318*^9, 3.685851393199477*^9}, {3.685851448013804*^9, 
   3.685851468479097*^9}, {3.68585162634411*^9, 3.685851699951235*^9}, {
   3.685851732892767*^9, 3.685851756809786*^9}, {3.685851807362144*^9, 
   3.685851815772572*^9}, {3.68585196618266*^9, 3.685852138263727*^9}, {
   3.685852235750094*^9, 3.6858522365276747`*^9}, {3.6858522750473747`*^9, 
   3.685852332014473*^9}, {3.6858524195245256`*^9, 3.685852420498811*^9}, {
   3.685852504804266*^9, 3.685852554664555*^9}, {3.685852817998569*^9, 
   3.685852820146702*^9}, 3.685852952188924*^9, {3.685852994526354*^9, 
   3.685852995475964*^9}, {3.68585543783108*^9, 3.68585544060902*^9}, {
   3.685855488558816*^9, 3.6858555385610723`*^9}, {3.685855573250226*^9, 
   3.685855763700778*^9}, {3.685855851657669*^9, 3.685855852734428*^9}, {
   3.6858559139304743`*^9, 3.685855914258336*^9}, {3.685856239900159*^9, 
   3.685856262844842*^9}, {3.685856527496449*^9, 3.685856568389841*^9}, {
   3.6858568891698923`*^9, 3.685856933036331*^9}, {3.6858570617305326`*^9, 
   3.685857110952784*^9}, {3.68585731285113*^9, 3.6858573298197603`*^9}, {
   3.711090388381749*^9, 3.7110904197704077`*^9}, {3.711090477790125*^9, 
   3.711090484369767*^9}, {3.711090518594022*^9, 3.7110905852935963`*^9}, {
   3.711090653000636*^9, 3.711090655741624*^9}, {3.7110907671426897`*^9, 
   3.711090782835785*^9}, {3.711090860971977*^9, 3.71109086259262*^9}, {
   3.711090959745782*^9, 3.711090967053129*^9}, {3.711091009998396*^9, 
   3.711091039295238*^9}, {3.711091080387536*^9, 3.7110911470464497`*^9}, {
   3.711091200639996*^9, 3.7110912044568157`*^9}, {3.711091292152358*^9, 
   3.711091313206541*^9}, {3.711091353732622*^9, 3.711091403647649*^9}, {
   3.711091481462607*^9, 3.71109151894308*^9}, {3.711091632624161*^9, 
   3.711091717389189*^9}, {3.71109185872059*^9, 3.711091861967021*^9}, {
   3.711091946652444*^9, 3.711091971071022*^9}, {3.711092276474365*^9, 
   3.7110922822364807`*^9}, {3.7110923266602297`*^9, 3.711092418136904*^9}, {
   3.7110926600546913`*^9, 3.711092679060191*^9}, {3.711092967628902*^9, 
   3.711092990557047*^9}, {3.711093092232058*^9, 3.7110931032927217`*^9}, {
   3.7110941766360893`*^9, 3.711094222225339*^9}, {3.7111001051898737`*^9, 
   3.7111001231017036`*^9}, {3.7111001905784187`*^9, 
   3.7111001919174843`*^9}, {3.711100229611718*^9, 3.71110028989635*^9}, {
   3.7111003990242023`*^9, 3.711100410534198*^9}, {3.7111009526865053`*^9, 
   3.711101001463057*^9}, {3.711101154332079*^9, 3.711101224050899*^9}, {
   3.711101261074651*^9, 3.711101261490097*^9}, {3.711111309005494*^9, 
   3.7111113149567223`*^9}, {3.711111584397849*^9, 3.7111116137395678`*^9}, {
   3.711111668826914*^9, 3.711111671154889*^9}, {3.717740557990252*^9, 
   3.717740559718543*^9}, {3.717844834750647*^9, 3.717844842990161*^9}, {
   3.717844911097979*^9, 3.7178449798351316`*^9}, 3.7178450671949778`*^9, {
   3.717847515018527*^9, 3.717847531681776*^9}, {3.717847570289398*^9, 
   3.7178475709838257`*^9}, {3.717847630871354*^9, 3.717847673934496*^9}, {
   3.717847707390752*^9, 3.717847733479759*^9}, {3.7178478013992147`*^9, 
   3.7178478197700977`*^9}, {3.7178479374742823`*^9, 
   3.7178479508794403`*^9}, {3.7178479916090937`*^9, 
   3.7178479933046007`*^9}, {3.717848077188743*^9, 3.717848116387651*^9}, {
   3.717848162123921*^9, 3.717848199714807*^9}, {3.7305446425674753`*^9, 
   3.7305446426937847`*^9}, {3.74197755323807*^9, 3.741977565044792*^9}, {
   3.7419776011222754`*^9, 3.74197762060358*^9}, {3.741977704704419*^9, 
   3.7419777458066597`*^9}, {3.7419777822095003`*^9, 3.741977799016658*^9}, {
   3.7419778726158953`*^9, 3.741977882831718*^9}, {3.741977943825979*^9, 
   3.741978014505892*^9}, {3.7419780466003513`*^9, 3.741978048695863*^9}, {
   3.741978251009742*^9, 3.741978276564124*^9}, {3.7419783071577873`*^9, 
   3.741978397435583*^9}, {3.741978450625723*^9, 3.741978453351595*^9}, 
   3.741978496441799*^9, {3.741978679692935*^9, 3.7419786962586*^9}, {
   3.741978797178348*^9, 3.741978920621462*^9}, {3.741978955743288*^9, 
   3.741979013493878*^9}, {3.742013150776678*^9, 3.742013152291946*^9}, {
   3.742013347683981*^9, 3.742013352250639*^9}, {3.742014249296727*^9, 
   3.7420142824916067`*^9}, {3.7420143691466217`*^9, 3.742014515511938*^9}, {
   3.7438353898690853`*^9, 3.743835395364455*^9}, {3.743865386171597*^9, 
   3.743865413246286*^9}, {3.74417212296462*^9, 3.7441721237795973`*^9}, {
   3.744576257675291*^9, 3.744576282172411*^9}, {3.744576398538041*^9, 
   3.7445764081597443`*^9}, {3.744576446129293*^9, 3.7445764807339487`*^9}, {
   3.74457658296546*^9, 3.744576598243783*^9}, {3.74457669197841*^9, 
   3.744576694202406*^9}, {3.744576775409717*^9, 3.744576806279276*^9}, {
   3.744576859880999*^9, 3.744576872278058*^9}, {3.744576907494125*^9, 
   3.7445769468362703`*^9}, {3.74457698567721*^9, 3.744576990803774*^9}, {
   3.7445770673632307`*^9, 3.744577073644486*^9}, {3.7445771966446743`*^9, 
   3.744577218774494*^9}, {3.744577252448473*^9, 3.744577378922546*^9}, {
   3.744577429875523*^9, 3.744577444145987*^9}, {3.744577569560322*^9, 
   3.7445775698946447`*^9}, {3.744577627391795*^9, 3.7445776534131937`*^9}, {
   3.744577962863385*^9, 3.744577964670371*^9}, {3.744578028421026*^9, 
   3.744578034458921*^9}, {3.744578086419478*^9, 3.7445782015445337`*^9}, {
   3.744579363627138*^9, 3.744579366047567*^9}, {3.7445793966834707`*^9, 
   3.7445794602820272`*^9}, {3.7445798194976*^9, 3.744579819795539*^9}, {
   3.744605225995677*^9, 3.744605282984518*^9}, {3.744605813565586*^9, 
   3.744605838101604*^9}, {3.7446058755895576`*^9, 3.744605895091887*^9}, {
   3.744605947275201*^9, 3.744606002331894*^9}, {3.7446060414592*^9, 
   3.744606170816766*^9}, {3.744606251519023*^9, 3.7446062639967318`*^9}, {
   3.744606918007711*^9, 3.74460703306057*^9}, {3.7446070772604437`*^9, 
   3.7446070793948593`*^9}, {3.7446071406200447`*^9, 3.744607169161171*^9}, {
   3.7446072927074757`*^9, 3.7446073334952717`*^9}, {3.7446073849840727`*^9, 
   3.744607428380995*^9}, {3.744608522173952*^9, 3.7446085940257807`*^9}, {
   3.7446086774832983`*^9, 3.7446086791437397`*^9}, {3.744656227749956*^9, 
   3.7446562401250668`*^9}, {3.7446953726839323`*^9, 3.744695395671322*^9}, {
   3.744697365813425*^9, 3.744697378756146*^9}, {3.744698338800084*^9, 
   3.744698371143552*^9}, {3.744698432073358*^9, 3.744698448525362*^9}, {
   3.74469849476709*^9, 3.744698495528509*^9}, {3.74470073310918*^9, 
   3.744700733572353*^9}, {3.7447011996844273`*^9, 3.74470124217128*^9}, {
   3.7447014704449*^9, 3.7447014711855288`*^9}, {3.744701515798829*^9, 
   3.744701537101858*^9}, {3.744701776455665*^9, 3.744701793522031*^9}, {
   3.744701928156464*^9, 3.744701953311462*^9}, {3.744701987002932*^9, 
   3.744701998531692*^9}, {3.744702052084428*^9, 3.744702126412898*^9}, {
   3.7447022419471893`*^9, 3.744702251821184*^9}, {3.744702566437923*^9, 
   3.744702566809853*^9}, {3.744702674913261*^9, 3.744702677439649*^9}, {
   3.744702843378893*^9, 3.7447028535709352`*^9}, {3.744703434795974*^9, 
   3.7447034563581877`*^9}, {3.7447057851762037`*^9, 3.744705809609007*^9}, {
   3.744706191004787*^9, 3.74470620026297*^9}, {3.7447075276752357`*^9, 
   3.744707527939266*^9}, {3.745228305744067*^9, 3.745228305889896*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"6b99e172-d3f3-42ed-a160-085700686e7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[291]:=",ExpressionUUID->"c5fc2d7f-b251-46ea-9e75-986cad36ed5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["$MaXrdFunctions", "Subchapter",
 CellChangeTimes->{{3.668244759916127*^9, 3.668244763731201*^9}, {
  3.713626366980631*^9, 
  3.713626369530772*^9}},ExpressionUUID->"094b011c-26a1-4968-8ae3-\
c94a98a7f1a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[292]:=",ExpressionUUID->"f773d851-9257-4db3-b5f6-5440d6749ba2"],

Cell[BoxData[
 RowBox[{"$MaXrdFunctions", ":=", 
  RowBox[{"$MaXrdFunctions", "=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "subContexts", ",", "packagefunctions", ",", "packagef", ",", 
       "hyperlinks"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subContexts", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Contexts", "[", "\"\<MaXrd`*\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<Private\>\""}], "]"}]}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"packagefunctions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", 
          RowBox[{"Names", "[", 
           RowBox[{"#", "<>", "\"\<*\>\""}], "]"}]}], "&"}], "/@", 
        "subContexts"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"packagef", "=", 
       RowBox[{"Sort", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"packagefunctions", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hyperlinks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Hyperlink", "[", 
          RowBox[{"#", ",", 
           RowBox[{"\"\<paclet:/MaXrd/Ref/\>\"", "<>", "#"}]}], "]"}], "&"}], 
        "/@", "packagef"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Multicolumn", "[", 
       RowBox[{"hyperlinks", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713623088872505*^9, 3.713623106119204*^9}, {
   3.713623186734174*^9, 3.7136232132815657`*^9}, {3.713623366346613*^9, 
   3.713623368970223*^9}, {3.713626122233032*^9, 3.7136261850235577`*^9}, {
   3.713626220800157*^9, 3.713626291053178*^9}, 3.713626339101788*^9, {
   3.713626877829962*^9, 3.7136268851354218`*^9}, {3.727504132324382*^9, 
   3.727504137418166*^9}, {3.727504218377234*^9, 3.7275042185729313`*^9}, {
   3.730379717502055*^9, 3.730379732426323*^9}, {3.7303798043568077`*^9, 
   3.7303798185246687`*^9}, 3.740979502729867*^9, 3.743835409169471*^9, 
   3.743865334511272*^9, {3.7438667194945087`*^9, 3.743866739385027*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[293]:=",ExpressionUUID->"4fb164c4-033e-4cfc-97f5-0844463043fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[294]:=",ExpressionUUID->"c0e1a560-6c07-4151-976e-11b0002aca45"]
}, Closed]],

Cell[CellGroupData[{

Cell["$MaXrdPath", "Subchapter",
 CellChangeTimes->{{3.667913451914239*^9, 3.6679134538492537`*^9}, {
   3.717738980592308*^9, 3.717738983802504*^9}, 
   3.717742520174604*^9},ExpressionUUID->"c0c93f93-607e-4d78-a81f-\
df7292286160"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[295]:=",ExpressionUUID->"1bdfba51-a44e-431e-a9a4-9747dd7d7281"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$MaXrdPath", ":=", 
   RowBox[{"$MaXrdPath", "=", 
    RowBox[{"DirectoryName", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FileNames", "[", 
        RowBox[{
        "\"\<MaXrd/Core/Definitions.m\>\"", ",", "$Path", ",", "Infinity"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}]}]}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810603792123*^9, {3.6679134762424593`*^9, 3.667913479353848*^9}, {
   3.667913525824753*^9, 3.667913566815895*^9}, 3.667922449570759*^9, {
   3.685082755359603*^9, 3.685082756664475*^9}, {3.717739409772593*^9, 
   3.717739416678906*^9}, 3.74383541548083*^9, 3.7438654133513536`*^9, {
   3.744604981977673*^9, 3.744604984510038*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[296]:=",ExpressionUUID->"a0d73740-ce15-468e-a798-5451ed621dc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[297]:=",ExpressionUUID->"4d74b0d1-812a-4e21-a863-deb5daa938b6"]
}, Closed]],

Cell[CellGroupData[{

Cell["$GroupSymbolRedirect", "Subchapter",
 CellChangeTimes->{{3.667913451914239*^9, 3.6679134538492537`*^9}, {
  3.684163933759*^9, 
  3.6841639348934793`*^9}},ExpressionUUID->"e1502916-aa81-4d14-a5ab-\
18d193a73be2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[298]:=",ExpressionUUID->"850b1af7-2240-4294-af08-9a636d75e0be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$GroupSymbolRedirect", "::", "missing"}], "=", 
   "\"\<Could not find \[LeftGuillemet]`1`\[RightGuillemet].\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.743865457526416*^9},
 CellLabel->
  "In[299]:=",ExpressionUUID->"5a0f5590-c0c4-4410-9da1-f28a5152b8f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[300]:=",ExpressionUUID->"0c859d7c-b07d-40c4-bd6e-e912e1682a3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$GroupSymbolRedirect", ":=", 
   RowBox[{"$GroupSymbolRedirect", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "$MaXrdPath", ",", "\"\<Core\>\"", ",", "\"\<Data\>\"", ",", 
         "\"\<GroupSymbolRedirect.m\>\""}], "}"}], "]"}], ",", 
      "\"\<Package\>\""}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810603792123*^9, {3.6679134762424593`*^9, 3.667913479353848*^9}, {
   3.667913525824753*^9, 3.667913566815895*^9}, 3.667922449570759*^9, {
   3.6841639593346243`*^9, 3.684163962012776*^9}, {3.6842110127827377`*^9, 
   3.684211025479542*^9}, {3.717735294206521*^9, 3.717735298759973*^9}, 
   3.7177407296502457`*^9, 3.743865413427245*^9, 3.743865457564193*^9, {
   3.743866819119553*^9, 3.7438668271551237`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[301]:=",ExpressionUUID->"bf18f074-3250-49e8-be21-fa99e25632a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[302]:=",ExpressionUUID->"bc37be63-d30d-4c65-9076-d7cb614b6c9e"]
}, Closed]],

Cell[CellGroupData[{

Cell["$MaXrdVersion", "Subchapter",
 CellChangeTimes->{{3.6646242294759808`*^9, 3.664624234339078*^9}, 
   3.679745594530423*^9, {3.6856909140644207`*^9, 3.6856909161285*^9}, {
   3.6856955548132*^9, 3.685695556654903*^9}, {3.6858508531390133`*^9, 
   3.685850855128764*^9}},ExpressionUUID->"027a6d30-cb07-4d0d-8500-\
636662c8f68f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", " ", "and", " ", "options"}], " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[303]:=",ExpressionUUID->"a9a23a0a-a372-47a8-a46a-4bd067ae235f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667811042307796*^9, 3.6678110688569927`*^9}, {3.6678110991292048`*^9, 
   3.667811099480304*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[304]:=",ExpressionUUID->"d61c8724-ea84-47e5-ac45-e219c1f7e9e5"],

Cell[BoxData[
 RowBox[{"$MaXrdVersion", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dir", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Load", " ", "current", " ", "version"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"dir", "=", "$MaXrdPath"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"p", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"dir", ",", "\"\<PacletInfo.m\>\""}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"First", "@", 
      RowBox[{"StringCases", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"p", ",", "\"\<String\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{
          "Whitespace", "~~", "\"\<Version -> \\\"\>\"", "~~", "v__", "~~", 
           "\"\<\\\"\>\""}], "]"}], "\[RuleDelayed]", "v"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.685682044952615*^9, 3.6856820504144278`*^9}, {
   3.685682141325856*^9, 3.685682178024384*^9}, {3.685682225953554*^9, 
   3.6856822264375687`*^9}, {3.685686504590041*^9, 3.685686563672072*^9}, {
   3.685686761317539*^9, 3.685686935927103*^9}, {3.685687049738576*^9, 
   3.68568707333384*^9}, {3.685687114646472*^9, 3.685687127702293*^9}, {
   3.685687165179854*^9, 3.685687166128426*^9}, {3.685687209773357*^9, 
   3.685687249125226*^9}, {3.685687460267198*^9, 3.6856874715285482`*^9}, {
   3.685687503903227*^9, 3.6856876526267977`*^9}, {3.685687717427792*^9, 
   3.685687802476377*^9}, {3.685687865524221*^9, 3.685687897331867*^9}, {
   3.685687934255664*^9, 3.685687939417481*^9}, {3.6856879800139227`*^9, 
   3.685688042911214*^9}, {3.68568810006351*^9, 3.685688100318913*^9}, {
   3.685688139025612*^9, 3.6856882052098713`*^9}, {3.685688250205721*^9, 
   3.6856882678366337`*^9}, {3.685688304145129*^9, 3.6856883808922367`*^9}, {
   3.68568844499587*^9, 3.685688472248145*^9}, {3.685688514296632*^9, 
   3.685688545376317*^9}, {3.685688623890478*^9, 3.685688637817067*^9}, {
   3.68569066960983*^9, 3.685690691012197*^9}, {3.685690794783538*^9, 
   3.685690811559473*^9}, {3.68569087238955*^9, 3.685690900780208*^9}, {
   3.685690968591786*^9, 3.6856909827333717`*^9}, 3.685691129301629*^9, {
   3.685691194063245*^9, 3.685691195923958*^9}, {3.685691253520686*^9, 
   3.68569125544692*^9}, {3.685691421918008*^9, 3.68569146953458*^9}, {
   3.685691551850884*^9, 3.685691552213007*^9}, {3.6856916027158012`*^9, 
   3.685691692759995*^9}, {3.685691853134893*^9, 3.685691920007518*^9}, {
   3.6856929678967247`*^9, 3.685693015099309*^9}, 3.6856931484132357`*^9, {
   3.685693393496571*^9, 3.685693394198283*^9}, {3.685693546697781*^9, 
   3.6856935520440397`*^9}, {3.685693609535673*^9, 3.6856936897957973`*^9}, {
   3.685693750984054*^9, 3.685693759315776*^9}, {3.68569392361819*^9, 
   3.685693945319812*^9}, {3.6856939801033173`*^9, 3.685693980425994*^9}, {
   3.685694067633998*^9, 3.685694097770274*^9}, {3.6856942382554502`*^9, 
   3.685694255076212*^9}, {3.6856943006813087`*^9, 3.6856943018640337`*^9}, {
   3.6856943997277603`*^9, 3.685694411106454*^9}, {3.685695339182644*^9, 
   3.685695373223888*^9}, {3.685695408676928*^9, 3.685695478096266*^9}, {
   3.685695766537468*^9, 3.6856957943793716`*^9}, {3.6856958338041162`*^9, 
   3.6856958424484253`*^9}, {3.685696332725561*^9, 3.685696396128811*^9}, {
   3.685696608524857*^9, 3.685696657721571*^9}, {3.6856972409963093`*^9, 
   3.685697244163583*^9}, {3.6856979286350107`*^9, 3.685697955135551*^9}, {
   3.6856979888912783`*^9, 3.685698003991218*^9}, {3.6856982147010527`*^9, 
   3.685698274805579*^9}, {3.685698569424312*^9, 3.685698603461879*^9}, {
   3.68577042313544*^9, 3.685770436557921*^9}, {3.685786249680023*^9, 
   3.6857862528214617`*^9}, {3.6858508794369802`*^9, 3.685851146037546*^9}, {
   3.68585121114992*^9, 3.685851280289015*^9}, 3.6858513574491*^9, {
   3.685851389819318*^9, 3.685851393199477*^9}, {3.685851448013804*^9, 
   3.685851468479097*^9}, {3.68585162634411*^9, 3.685851699951235*^9}, {
   3.685851732892767*^9, 3.685851756809786*^9}, {3.685851807362144*^9, 
   3.685851815772572*^9}, {3.68585196618266*^9, 3.685852138263727*^9}, {
   3.685852235750094*^9, 3.6858522365276747`*^9}, {3.6858522750473747`*^9, 
   3.685852332014473*^9}, {3.6858524195245256`*^9, 3.685852420498811*^9}, {
   3.685852504804266*^9, 3.685852554664555*^9}, {3.685852817998569*^9, 
   3.6858528943497467`*^9}, {3.717740744855871*^9, 3.717740749249337*^9}, 
   3.74386541348313*^9, 3.743865651851873*^9, {3.744656582709256*^9, 
   3.7446565885912313`*^9}, {3.744656669791733*^9, 3.744656671621607*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[305]:=",ExpressionUUID->"1d38db34-5e31-4da7-aff9-1025b9de0a1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655742356838553*^9, 3.655742372060646*^9}, 
   3.6557467627944937`*^9, 3.655788801290646*^9, {3.655788875176199*^9, 
   3.6557888758261757`*^9}, {3.65578919971651*^9, 3.655789200037839*^9}, {
   3.655801038237483*^9, 3.6558010435312433`*^9}, {3.657190485055834*^9, 
   3.657190510152482*^9}, {3.657190761354436*^9, 3.657190764136423*^9}, {
   3.657190864206573*^9, 3.6571908652469587`*^9}, {3.657191249647196*^9, 
   3.657191274140421*^9}, 3.6571913792520313`*^9, {3.657191423745737*^9, 
   3.6571914240092087`*^9}, {3.6571914551444397`*^9, 3.657191456632414*^9}, 
   3.657196777421657*^9, {3.657196859389958*^9, 3.657196883978856*^9}, {
   3.657196988256592*^9, 3.657197001336329*^9}, 3.657200247719434*^9, 
   3.6572007261726093`*^9, {3.657203655191904*^9, 3.657203655319538*^9}, 
   3.657221819331767*^9, {3.658395294791712*^9, 3.658395316637723*^9}, {
   3.667810213479385*^9, 3.667810216902418*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[306]:=",ExpressionUUID->"19035960-f719-4c40-a423-507cdae71b2e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Package finalisation",
 FontSlant->"Italic"]], "Chapter",
 CellChangeTimes->{{3.667810135289062*^9, 3.667810137240119*^9}, {
  3.717738383999324*^9, 
  3.7177383921610823`*^9}},ExpressionUUID->"7bef4390-a47c-4f20-a8b9-\
8cb594541f9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650291995903159*^9, 3.650291999656385*^9}, {
  3.655794914392253*^9, 3.655794915028521*^9}, {3.6570168680070057`*^9, 
  3.657016910052175*^9}, {3.657182226988536*^9, 3.657182262339521*^9}, {
  3.6571965249075317`*^9, 3.657196529083351*^9}, {3.657222486965454*^9, 
  3.6572224883724937`*^9}, {3.6572225935629787`*^9, 3.657222623281169*^9}, {
  3.667732206857939*^9, 3.667732209689768*^9}, {3.667810145961068*^9, 
  3.66781016027987*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[307]:=",ExpressionUUID->"89d7418e-834b-4e94-bf74-b664515b9ceb"]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->{},
InitializationCellWarning->False,
WindowSize->{720, 790},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 568, 8, 98, "Title",ExpressionUUID->"a2b17ac0-0b66-4dfa-8a18-4f838e9b1548"],
Cell[CellGroupData[{
Cell[1173, 34, 348, 6, 69, "Chapter",ExpressionUUID->"05130d30-5922-4440-bc61-28d6093f6784"],
Cell[CellGroupData[{
Cell[1546, 44, 7571, 160, 887, "Input",ExpressionUUID->"4642b0d8-b794-43f2-9cbf-961df8cb40e0"],
Cell[9120, 206, 461, 9, 368, "Print",ExpressionUUID->"eae2ba74-0452-405b-873b-1273efce6198"]
}, Open  ]],
Cell[9596, 218, 746, 17, 131, "Input",ExpressionUUID->"ecc58a3f-999d-484d-995b-bd5a9a076acf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[10379, 240, 252, 4, 58, "Chapter",ExpressionUUID->"98bb91af-3017-44d0-bd38-3fb1dc5b7446"],
Cell[CellGroupData[{
Cell[10656, 248, 473, 7, 65, "Subchapter",ExpressionUUID->"8a04012e-1857-4974-9c60-50e1690c7e5d"],
Cell[11132, 257, 440, 8, 46, "Input",ExpressionUUID->"a84c80f5-4eaa-406d-a3b0-0590482d106d",
 InitializationCell->True],
Cell[11575, 267, 3858, 71, 362, "Input",ExpressionUUID->"a0d806b2-fbfa-4444-8360-46244684d06b",
 InitializationCell->True],
Cell[15436, 340, 1214, 19, 46, "Input",ExpressionUUID->"2d6fba52-f8ed-4fb9-a942-88b90c5ed568",
 InitializationCell->True],
Cell[16653, 361, 31061, 567, 2294, "Input",ExpressionUUID->"b0a2a8cc-c36f-49d9-8a11-86ed858d9f6c",
 InitializationCell->True],
Cell[47717, 930, 1138, 18, 46, "Input",ExpressionUUID->"d4e32fdb-6588-45e7-a1c1-4bdd400a5566",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[48892, 953, 409, 6, 49, "Subchapter",ExpressionUUID->"0ee2c50e-7674-48eb-8c98-b6af3ffdf4dc"],
Cell[49304, 961, 441, 8, 70, "Input",ExpressionUUID->"29b92492-8d32-4b08-8101-c199daec3ab4",
 InitializationCell->True],
Cell[49748, 971, 675, 16, 70, "Input",ExpressionUUID->"cb38fd25-8e9c-4ba7-8884-4a2db0a04021",
 InitializationCell->True],
Cell[50426, 989, 1215, 19, 70, "Input",ExpressionUUID->"49cbf4c3-8aa1-4f57-b411-bd0623a85246",
 InitializationCell->True],
Cell[51644, 1010, 10404, 207, 70, "Input",ExpressionUUID->"aefbd779-58d1-479c-b676-e2fbebcb8648",
 InitializationCell->True],
Cell[62051, 1219, 1138, 18, 70, "Input",ExpressionUUID->"d4cd2fe1-70b6-4dbf-b03e-7940c9130a92",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[63226, 1242, 441, 7, 49, "Subchapter",ExpressionUUID->"e0f41726-5334-435d-82da-422b46d89104"],
Cell[63670, 1251, 441, 8, 70, "Input",ExpressionUUID->"8bc62f37-199d-4660-a1b2-19bec291d425",
 InitializationCell->True],
Cell[64114, 1261, 604, 12, 70, "Input",ExpressionUUID->"c0c3ec31-e8fd-4948-a4eb-105f83b6821c",
 InitializationCell->True],
Cell[64721, 1275, 1215, 19, 70, "Input",ExpressionUUID->"692524e7-dc2a-4755-a8b7-b224777f0b5c",
 InitializationCell->True],
Cell[65939, 1296, 18491, 368, 70, "Input",ExpressionUUID->"fb9d67e4-079c-476d-a668-56855ae001a1",
 InitializationCell->True],
Cell[84433, 1666, 1138, 18, 70, "Input",ExpressionUUID->"6b9eb01a-7fdb-4eff-b637-a2b94405be8c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[85608, 1689, 494, 7, 49, "Subchapter",ExpressionUUID->"e0265c6d-f29c-498a-88b0-ebfd910bd62e"],
Cell[86105, 1698, 441, 8, 70, "Input",ExpressionUUID->"b4e7a0c7-42f8-4b82-8265-37a9d8b18008",
 InitializationCell->True],
Cell[86549, 1708, 665, 16, 70, "Input",ExpressionUUID->"0c79069b-687a-4889-980e-daa4e9ff40c8",
 InitializationCell->True],
Cell[87217, 1726, 1215, 19, 70, "Input",ExpressionUUID->"35ab7d49-1e1f-43d0-86a8-f6df8b2357a1",
 InitializationCell->True],
Cell[88435, 1747, 23367, 461, 70, "Input",ExpressionUUID->"4287df34-0941-4a79-ab8f-35309f3c1671",
 InitializationCell->True],
Cell[111805, 2210, 1138, 18, 70, "Input",ExpressionUUID->"9359d8ce-1ebe-4dab-85d0-1e57860858dc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[112980, 2233, 531, 8, 49, "Subchapter",ExpressionUUID->"01123944-a651-4f62-8364-b32f86728dfb"],
Cell[113514, 2243, 441, 8, 70, "Input",ExpressionUUID->"b3ea2c7a-9cf8-4174-beb3-39e61847591f",
 InitializationCell->True],
Cell[113958, 2253, 760, 16, 70, "Input",ExpressionUUID->"5b795a32-8265-4059-921e-2f5f092ed18f",
 InitializationCell->True],
Cell[114721, 2271, 1215, 19, 70, "Input",ExpressionUUID->"95cff54f-a56a-4a20-b8db-afa2d863b171",
 InitializationCell->True],
Cell[115939, 2292, 9352, 174, 70, "Input",ExpressionUUID->"30b4dacd-4df2-42f5-bc88-e910a7afa72f",
 InitializationCell->True],
Cell[125294, 2468, 1138, 18, 70, "Input",ExpressionUUID->"07b41cf6-96a4-4ebb-93b8-170ecc7e45c5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[126469, 2491, 460, 7, 49, "Subchapter",ExpressionUUID->"535ee6ae-9e32-42fd-a8be-bff9d29502a7"],
Cell[126932, 2500, 441, 8, 70, "Input",ExpressionUUID->"62f5e9a5-4ff9-417b-b2b2-df88de8ae8e2",
 InitializationCell->True],
Cell[127376, 2510, 1183, 20, 70, "Input",ExpressionUUID->"79878c94-f590-47e2-94be-d5a8533ea601",
 InitializationCell->True],
Cell[128562, 2532, 1215, 19, 70, "Input",ExpressionUUID->"b97ff313-206b-4087-951d-6c9983b0d06e",
 InitializationCell->True],
Cell[129780, 2553, 7733, 139, 70, "Input",ExpressionUUID->"2e6e5f9f-b015-4447-b0cc-11624db7324d",
 InitializationCell->True],
Cell[137516, 2694, 1138, 18, 70, "Input",ExpressionUUID->"179b5a81-4b15-4730-83e5-4c4a24bd57f2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[138691, 2717, 532, 8, 49, "Subchapter",ExpressionUUID->"795b55de-8d76-4646-955a-8cf25fc4994e"],
Cell[139226, 2727, 441, 8, 70, "Input",ExpressionUUID->"49bd8dd6-7e28-4159-ab3e-05c45e2fd615",
 InitializationCell->True],
Cell[139670, 2737, 966, 19, 70, "Input",ExpressionUUID->"9ad62447-5617-4e29-be46-e4f54d2fc4dd",
 InitializationCell->True],
Cell[140639, 2758, 1215, 19, 70, "Input",ExpressionUUID->"a2a2c8fb-1917-4979-aef9-964f093ddc3f",
 InitializationCell->True],
Cell[141857, 2779, 16272, 312, 70, "Input",ExpressionUUID->"f9920ab3-4b93-4b6a-9d78-19921f9b5430",
 InitializationCell->True],
Cell[158132, 3093, 1138, 18, 70, "Input",ExpressionUUID->"02070aa5-ce13-4df1-bda3-a5b0f6597b98",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[159307, 3116, 452, 7, 49, "Subchapter",ExpressionUUID->"24919f78-ba9d-4485-8017-d361873c0764"],
Cell[159762, 3125, 441, 8, 70, "Input",ExpressionUUID->"beece8e6-0b82-4b32-95b3-a146b40278fd",
 InitializationCell->True],
Cell[160206, 3135, 3239, 60, 70, "Input",ExpressionUUID->"39e11137-e623-4e80-90e1-91a535aa0570",
 InitializationCell->True],
Cell[163448, 3197, 1215, 19, 70, "Input",ExpressionUUID->"58741668-ae31-4b68-8c96-a28c47036b75",
 InitializationCell->True],
Cell[164666, 3218, 5940, 126, 70, "Input",ExpressionUUID->"746859a9-dce8-4dec-8e2f-6c51a30e76d1",
 InitializationCell->True],
Cell[170609, 3346, 45706, 906, 70, "Input",ExpressionUUID->"0d23a345-98fa-4437-be4e-5f73556fc832",
 InitializationCell->True],
Cell[216318, 4254, 1138, 18, 70, "Input",ExpressionUUID->"734fba65-e4f7-40ce-9781-45bf41a9bf17",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[217493, 4277, 367, 6, 49, "Subchapter",ExpressionUUID->"5102ffa4-909c-4b6c-b671-c469e803a525"],
Cell[217863, 4285, 441, 8, 70, "Input",ExpressionUUID->"1da26f4b-d93c-451e-abb1-71b5fd30066a",
 InitializationCell->True],
Cell[218307, 4295, 284, 7, 70, "Input",ExpressionUUID->"6377ed0e-4ead-442a-8b47-7cd302c131aa",
 InitializationCell->True],
Cell[218594, 4304, 1215, 19, 70, "Input",ExpressionUUID->"7f84ccba-b3fa-4f68-9d54-9558d4ac43a2",
 InitializationCell->True],
Cell[219812, 4325, 7514, 161, 70, "Input",ExpressionUUID->"3fda4c77-57a9-4bfb-9bd7-1a1c5bb91dd4",
 InitializationCell->True],
Cell[227329, 4488, 3694, 61, 70, "Input",ExpressionUUID->"c85c15d8-67dc-4f48-8cfa-69313f144ced",
 InitializationCell->True],
Cell[231026, 4551, 1138, 18, 70, "Input",ExpressionUUID->"7199359a-d5d5-45a5-9448-4740413ccbf5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[232201, 4574, 382, 6, 49, "Subchapter",ExpressionUUID->"10d7dc86-bb0d-4ff7-97bc-09d46e0c3900"],
Cell[232586, 4582, 441, 8, 70, "Input",ExpressionUUID->"45c26c74-0a62-4901-80d7-ed48eb93c5e6",
 InitializationCell->True],
Cell[233030, 4592, 979, 24, 70, "Input",ExpressionUUID->"4c7714ac-5c79-43ef-b154-444c18ade0f3",
 InitializationCell->True],
Cell[234012, 4618, 399, 8, 70, "Input",ExpressionUUID->"588d7476-19e3-4be4-b875-678843f212af",
 InitializationCell->True],
Cell[234414, 4628, 1215, 19, 70, "Input",ExpressionUUID->"20e54942-edc7-4d8b-b52e-5260280dc9bd",
 InitializationCell->True],
Cell[235632, 4649, 21674, 462, 70, "Input",ExpressionUUID->"28b70032-b1e9-43de-94be-f55bb0c806d3",
 InitializationCell->True],
Cell[257309, 5113, 1138, 18, 70, "Input",ExpressionUUID->"12821adb-dced-40b1-bb4d-a4072ddc8ae7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[258484, 5136, 369, 6, 49, "Subchapter",ExpressionUUID->"f78c9db7-e155-46bf-8ec2-22a1f9879d92"],
Cell[258856, 5144, 441, 8, 70, "Input",ExpressionUUID->"b6d23b38-b752-41f9-b03a-784324ca588b",
 InitializationCell->True],
Cell[259300, 5154, 1109, 23, 70, "Input",ExpressionUUID->"cbda1014-4302-493c-9867-3d3b5d7f8e6a",
 InitializationCell->True],
Cell[260412, 5179, 1215, 19, 70, "Input",ExpressionUUID->"f7d6f7e1-17c3-430c-80af-8f6422c1b7a3",
 InitializationCell->True],
Cell[261630, 5200, 10221, 214, 70, "Input",ExpressionUUID->"bc2e2d62-702c-4e2f-a45f-238851ebc9d9",
 InitializationCell->True],
Cell[271854, 5416, 1138, 18, 70, "Input",ExpressionUUID->"5496b488-1f6f-498d-9f42-312726fde4cc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[273029, 5439, 653, 10, 49, "Subchapter",ExpressionUUID->"77e6bc4b-1ed1-48b5-bf9d-0c47588d6ca0"],
Cell[273685, 5451, 441, 8, 70, "Input",ExpressionUUID->"17c25943-c463-4d61-9044-bf2897b6b034",
 InitializationCell->True],
Cell[274129, 5461, 325, 8, 70, "Input",ExpressionUUID->"8535efb6-2c8f-460b-ada9-bf4f08f3159d",
 InitializationCell->True],
Cell[274457, 5471, 1215, 19, 70, "Input",ExpressionUUID->"3a19538f-bbf9-4135-9db7-05899e0649d8",
 InitializationCell->True],
Cell[275675, 5492, 12854, 219, 70, "Input",ExpressionUUID->"be3f562a-7b1a-41b9-a1e7-359d2ead6a0e",
 InitializationCell->True],
Cell[288532, 5713, 1138, 18, 70, "Input",ExpressionUUID->"7fd77fd3-1c05-430c-9432-ff3e25a7d2e2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[289707, 5736, 447, 7, 49, "Subchapter",ExpressionUUID->"c871ff2b-1f77-404b-826e-db627ebc15cd"],
Cell[290157, 5745, 441, 8, 46, "Input",ExpressionUUID->"f931cdc0-19a7-4d01-908e-9a5a838c2a88",
 InitializationCell->True],
Cell[290601, 5755, 2265, 45, 299, "Input",ExpressionUUID->"cab70876-da94-465f-9283-4b527865ee65",
 InitializationCell->True],
Cell[292869, 5802, 1215, 19, 46, "Input",ExpressionUUID->"f3ee08b9-ccc1-41eb-adb7-585522c84430",
 InitializationCell->True],
Cell[294087, 5823, 15039, 290, 1286, "Input",ExpressionUUID->"8bf26ab2-f7a7-4d6b-9be8-2b9a5554b370",
 InitializationCell->True],
Cell[309129, 6115, 1138, 18, 70, "Input",ExpressionUUID->"bc38bf82-922a-451d-8701-d0a59018d4f0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[310304, 6138, 260, 4, 49, "Subchapter",ExpressionUUID->"c127255c-ce86-4714-8f8d-97a5b08a7874"],
Cell[310567, 6144, 441, 8, 70, "Input",ExpressionUUID->"390a33df-ad51-4741-abdc-e3a25892f15c",
 InitializationCell->True],
Cell[311011, 6154, 1321, 29, 70, "Input",ExpressionUUID->"31871dd5-2faa-4c55-aee5-fdc95b5d5f02",
 InitializationCell->True],
Cell[312335, 6185, 1215, 19, 70, "Input",ExpressionUUID->"7d66c936-8730-487c-9230-af4faed95128",
 InitializationCell->True],
Cell[313553, 6206, 18917, 380, 70, "Input",ExpressionUUID->"92ee4800-7c87-4826-b953-bb3f09427e7d",
 InitializationCell->True],
Cell[332473, 6588, 1138, 18, 70, "Input",ExpressionUUID->"77b18f17-5b94-4805-83ae-f1ff1a9c8daf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[333648, 6611, 756, 11, 49, "Subchapter",ExpressionUUID->"5ddc0dc1-c4b6-4dbc-ade0-e663f1ba025c"],
Cell[334407, 6624, 441, 8, 70, "Input",ExpressionUUID->"83363ce0-6d39-46f5-b865-b48d814ddb15",
 InitializationCell->True],
Cell[334851, 6634, 661, 15, 70, "Input",ExpressionUUID->"481d459e-424a-421e-8555-cf5186cb0220",
 InitializationCell->True],
Cell[335515, 6651, 1215, 19, 70, "Input",ExpressionUUID->"74ea4ddb-f9a8-4315-9418-7271beb51841",
 InitializationCell->True],
Cell[336733, 6672, 14018, 237, 70, "Input",ExpressionUUID->"f0e3dddf-2275-4826-9be1-95f1e3e9ed9e",
 InitializationCell->True],
Cell[350754, 6911, 1142, 19, 70, "Input",ExpressionUUID->"6da9c7a4-9942-4a95-9184-a84e6bb7e4f2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[351933, 6935, 463, 7, 49, "Subchapter",ExpressionUUID->"6ec27fa3-3c2d-44a9-a1d9-d30f5165b2e7"],
Cell[352399, 6944, 445, 9, 70, "Input",ExpressionUUID->"35de6eea-b75e-4d58-86f9-c75a9c9e0fa8",
 InitializationCell->True],
Cell[352847, 6955, 5234, 103, 70, "Input",ExpressionUUID->"07375a0c-d51d-4322-a9af-3a2dec13c0fe",
 InitializationCell->True],
Cell[358084, 7060, 1219, 20, 70, "Input",ExpressionUUID->"9a99be2f-d096-45cf-a811-39c89592b367",
 InitializationCell->True],
Cell[359306, 7082, 33836, 677, 70, "Input",ExpressionUUID->"ff9dd400-1e91-4323-934f-5c14e1c2929f",
 InitializationCell->True],
Cell[393145, 7761, 97742, 1914, 70, "Input",ExpressionUUID->"ef46536c-57c5-49bf-90a0-4472cd53b5ba",
 InitializationCell->True],
Cell[490890, 9677, 87575, 1719, 70, "Input",ExpressionUUID->"685793d0-4e6b-41c6-affa-d9ec5cf93819",
 InitializationCell->True,
 CellID->737696194],
Cell[578468, 11398, 3784, 82, 70, "Input",ExpressionUUID->"9b87cce1-9c4a-4837-a103-4fad26c1d25d",
 InitializationCell->True],
Cell[582255, 11482, 1142, 19, 70, "Input",ExpressionUUID->"31ba05d1-9b20-4540-ad8e-465850b6579e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[583434, 11506, 281, 5, 49, "Subchapter",ExpressionUUID->"b5fce791-c483-4bbb-a620-43b6add0c57b"],
Cell[583718, 11513, 445, 9, 70, "Input",ExpressionUUID->"08127a61-0a46-4737-bdd2-eb44b81e2d02",
 InitializationCell->True],
Cell[584166, 11524, 7310, 162, 70, "Input",ExpressionUUID->"f6062f54-1222-4d57-ae33-6e13722a2bcd",
 InitializationCell->True],
Cell[591479, 11688, 1219, 20, 70, "Input",ExpressionUUID->"fcf44abb-fe7e-43b2-b3b8-089963ee157a",
 InitializationCell->True],
Cell[592701, 11710, 15125, 320, 70, "Input",ExpressionUUID->"582dd116-7bbf-4577-b0db-a95e7cf4dbe4",
 InitializationCell->True],
Cell[607829, 12032, 1577, 33, 70, "Input",ExpressionUUID->"2573f9e8-2af9-42ca-94dd-d3fbf8c90797",
 InitializationCell->True],
Cell[609409, 12067, 5002, 120, 70, "Input",ExpressionUUID->"dbcf2741-11e4-4698-a8af-daf49f068290",
 InitializationCell->True],
Cell[614414, 12189, 3616, 74, 70, "Input",ExpressionUUID->"9ccfd331-de3b-4fca-9f9d-02e8c569c92d",
 InitializationCell->True],
Cell[618033, 12265, 2747, 57, 70, "Input",ExpressionUUID->"bf221871-bd0a-4a76-8548-8cb2f84c0102",
 InitializationCell->True],
Cell[620783, 12324, 2775, 59, 70, "Input",ExpressionUUID->"4076f94c-029e-4e4f-be5f-3bb8a6a0ae57",
 InitializationCell->True],
Cell[623561, 12385, 8745, 173, 70, "Input",ExpressionUUID->"46300c07-37a8-4c26-9c3c-bfd429ab81d4",
 InitializationCell->True],
Cell[632309, 12560, 4318, 96, 70, "Input",ExpressionUUID->"40d1c1ed-62fb-4df8-907d-7b157fdb296f",
 InitializationCell->True],
Cell[636630, 12658, 19822, 409, 70, "Input",ExpressionUUID->"980d813f-5ce6-44d1-8dac-360bec13d687",
 InitializationCell->True],
Cell[656455, 13069, 17264, 376, 70, "Input",ExpressionUUID->"87669779-bf6f-49c2-a46e-d094bc03bec5",
 InitializationCell->True],
Cell[673722, 13447, 1447, 33, 70, "Input",ExpressionUUID->"254eed9a-9445-40db-b24d-472d2350b88b",
 InitializationCell->True],
Cell[675172, 13482, 1171, 29, 70, "Input",ExpressionUUID->"ca8d9a53-8b24-4939-b8f1-e2ca3a470796",
 InitializationCell->True],
Cell[676346, 13513, 1974, 39, 70, "Input",ExpressionUUID->"21c993c3-a67a-4d03-a7b5-7cd460cbf33b",
 InitializationCell->True],
Cell[678323, 13554, 1395, 33, 70, "Input",ExpressionUUID->"a5b11313-8f8e-4d89-bf43-7d46a4865e93",
 InitializationCell->True],
Cell[679721, 13589, 1142, 19, 70, "Input",ExpressionUUID->"be2c3ed8-fcd6-453a-9672-ca4fc3985baf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[680900, 13613, 537, 8, 49, "Subchapter",ExpressionUUID->"ab055846-8658-4583-8218-17bbdb5d8fa7"],
Cell[681440, 13623, 445, 9, 70, "Input",ExpressionUUID->"090636ee-5713-425e-967b-d93461927769",
 InitializationCell->True],
Cell[681888, 13634, 483, 11, 70, "Input",ExpressionUUID->"b69513f4-4d5f-4622-afba-be073c445005",
 InitializationCell->True],
Cell[682374, 13647, 1219, 20, 70, "Input",ExpressionUUID->"27ccbf94-5abc-4efd-aaa3-17632cfb8a27",
 InitializationCell->True],
Cell[683596, 13669, 6798, 128, 70, "Input",ExpressionUUID->"9f7d0cbd-7fef-4bf1-a1db-2f7fd6f091cf",
 InitializationCell->True],
Cell[690397, 13799, 1142, 19, 70, "Input",ExpressionUUID->"ec1d0533-84e1-4ffa-9a50-fc621814f680",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[691576, 13823, 528, 8, 49, "Subchapter",ExpressionUUID->"f7f5c0eb-0cfc-4bed-bb51-c73909baf384"],
Cell[692107, 13833, 445, 9, 70, "Input",ExpressionUUID->"b3b192c7-a919-4679-a2b4-3b7d437992fb",
 InitializationCell->True],
Cell[692555, 13844, 417, 10, 70, "Input",ExpressionUUID->"651cb324-4578-4f1b-b7a1-0ebdcd7c573e",
 InitializationCell->True],
Cell[692975, 13856, 1219, 20, 70, "Input",ExpressionUUID->"92e2bd91-05cf-4d86-b279-fa48d563662c",
 InitializationCell->True],
Cell[694197, 13878, 7646, 128, 70, "Input",ExpressionUUID->"b82e1e4f-deb8-4c23-a3eb-1d636c7ff42c",
 InitializationCell->True],
Cell[701846, 14008, 1142, 19, 70, "Input",ExpressionUUID->"eebf94d3-0195-4fa1-917d-0c80a8834da3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[703025, 14032, 193, 3, 49, "Subchapter",ExpressionUUID->"e77d37a6-9a20-4138-9bbc-c0cac6a9ff9b"],
Cell[703221, 14037, 445, 9, 70, "Input",ExpressionUUID->"1a10b825-773d-428c-a40e-8d9852abf1e7",
 InitializationCell->True],
Cell[703669, 14048, 1219, 20, 70, "Input",ExpressionUUID->"24e9e6cd-56b6-482d-b2b2-0af33929aa9f",
 InitializationCell->True],
Cell[704891, 14070, 10141, 209, 70, "Input",ExpressionUUID->"0a286452-fd34-44db-a06e-c9ed3d11f2d3",
 InitializationCell->True],
Cell[715035, 14281, 1142, 19, 70, "Input",ExpressionUUID->"bc552144-0c64-4288-91ed-b82e34ecd62f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[716214, 14305, 195, 3, 49, "Subchapter",ExpressionUUID->"8ff72b30-e54c-47ed-88fe-570b7a4abb31"],
Cell[716412, 14310, 445, 9, 46, "Input",ExpressionUUID->"b577cecc-3bcf-4495-bf21-9282788bc2ea",
 InitializationCell->True],
Cell[716860, 14321, 413, 10, 46, "Input",ExpressionUUID->"0291c17b-0fdc-4fbb-a50b-4b58926fd362",
 InitializationCell->True],
Cell[717276, 14333, 1219, 20, 46, "Input",ExpressionUUID->"fd27474a-7c85-4525-8bf8-733c90f512ee",
 InitializationCell->True],
Cell[718498, 14355, 8514, 183, 1013, "Input",ExpressionUUID->"ce9c7baf-282f-4246-8132-eb3ef658f934",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[727037, 14542, 495, 9, 30, "Input",ExpressionUUID->"15b2ca8c-ad04-4262-94dc-345e6c2973e7"],
Cell[727535, 14553, 485, 7, 34, "Output",ExpressionUUID->"fdf29155-e79e-431c-92b8-332b7884f01d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[728057, 14565, 232, 4, 30, "Input",ExpressionUUID->"73670396-0c13-403e-9cac-d179aacd1def"],
Cell[728292, 14571, 153, 3, 34, "Output",ExpressionUUID->"0c3c6711-7bd6-4799-9204-70a83e222920"]
}, Open  ]],
Cell[728460, 14577, 1142, 19, 46, "Input",ExpressionUUID->"36f1e117-1302-4157-a322-71c0a7341a7c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[729639, 14601, 373, 6, 49, "Subchapter",ExpressionUUID->"421cda21-11db-4c8c-8e0f-126a17ec7163"],
Cell[730015, 14609, 445, 9, 70, "Input",ExpressionUUID->"88a788b5-38b3-44c5-b02d-f882237ffa7e",
 InitializationCell->True],
Cell[730463, 14620, 732, 19, 70, "Input",ExpressionUUID->"3b28efe8-b41a-4a19-8df1-def5e9d40c9c",
 InitializationCell->True],
Cell[731198, 14641, 1219, 20, 70, "Input",ExpressionUUID->"034dc9aa-8a40-4b49-a35b-6340c2fb45b1",
 InitializationCell->True],
Cell[732420, 14663, 21012, 488, 70, "Input",ExpressionUUID->"7d860420-44c2-4999-bbcc-08d1df4f64c6",
 InitializationCell->True],
Cell[753435, 15153, 1142, 19, 70, "Input",ExpressionUUID->"d8ec7c26-2004-4faf-946c-e75676e28778",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[754614, 15177, 404, 6, 49, "Subchapter",ExpressionUUID->"3c0bd9f8-dc90-42c8-b080-6f73152589fd"],
Cell[755021, 15185, 445, 9, 70, "Input",ExpressionUUID->"2dea52a8-0bb7-4725-b28e-ed330d9b1ddc",
 InitializationCell->True],
Cell[755469, 15196, 2261, 57, 70, "Input",ExpressionUUID->"aeda2119-96e7-47ad-9852-e406c29541f5",
 InitializationCell->True],
Cell[757733, 15255, 1219, 20, 70, "Input",ExpressionUUID->"abd56de5-8541-4cfc-b00e-cf2976046ad5",
 InitializationCell->True],
Cell[758955, 15277, 8571, 196, 70, "Input",ExpressionUUID->"b25b7597-1501-4073-a875-d379d9a8992d",
 InitializationCell->True],
Cell[767529, 15475, 24156, 492, 70, "Input",ExpressionUUID->"33cbd15a-a70e-4f2b-bb1c-1fffa1ddd8ea",
 InitializationCell->True],
Cell[791688, 15969, 1142, 19, 70, "Input",ExpressionUUID->"119d5847-7a97-49d5-ae0d-69132759d164",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[792867, 15993, 420, 6, 49, "Subchapter",ExpressionUUID->"c89479ba-70ef-423f-9e19-f49bdf34deee"],
Cell[793290, 16001, 445, 9, 70, "Input",ExpressionUUID->"5aa551c9-82df-448d-9ae9-25ab8cb89960",
 InitializationCell->True],
Cell[793738, 16012, 810, 17, 70, "Input",ExpressionUUID->"db25a19e-3ceb-41d6-bac0-2a577dfc51cf",
 InitializationCell->True],
Cell[794551, 16031, 367, 9, 70, "Input",ExpressionUUID->"31d61b69-17ca-42e1-a9e1-f4ce24a7db2a",
 InitializationCell->True],
Cell[794921, 16042, 1219, 20, 70, "Input",ExpressionUUID->"edafc056-9644-41cf-bcd3-042725e00852",
 InitializationCell->True],
Cell[796143, 16064, 17924, 379, 70, "Input",ExpressionUUID->"50a12956-af47-4f3c-8db4-990281e7fd74",
 InitializationCell->True],
Cell[814070, 16445, 1142, 19, 70, "Input",ExpressionUUID->"72529848-bcdd-4cbb-98a7-70632c549cc6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[815249, 16469, 460, 7, 49, "Subchapter",ExpressionUUID->"5f66d2ce-62aa-4d7c-9868-ac7f9e7a4ca4"],
Cell[815712, 16478, 445, 9, 70, "Input",ExpressionUUID->"dbf6caec-edc9-4e5e-ac04-d3d0941e5688",
 InitializationCell->True],
Cell[816160, 16489, 3099, 65, 70, "Input",ExpressionUUID->"ef560771-6f30-4ec6-8439-0b49797d9c71",
 InitializationCell->True],
Cell[819262, 16556, 1219, 20, 70, "Input",ExpressionUUID->"eeb47795-2852-4abd-9391-1197590b7f03",
 InitializationCell->True],
Cell[820484, 16578, 65201, 1215, 70, "Input",ExpressionUUID->"3a24910f-7410-4996-b0aa-6fcc2a917cee",
 InitializationCell->True],
Cell[885688, 17795, 1142, 19, 70, "Input",ExpressionUUID->"267d530b-fa63-4715-bac0-20bd8fc18927",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[886867, 17819, 437, 7, 49, "Subchapter",ExpressionUUID->"ea62a536-4bde-4c29-9d2e-dcb6e7949a4c"],
Cell[887307, 17828, 445, 9, 70, "Input",ExpressionUUID->"e1b7b95b-619a-4c38-a408-f937413b5154",
 InitializationCell->True],
Cell[887755, 17839, 4787, 102, 70, "Input",ExpressionUUID->"bd7a5cb1-6f2f-4050-bb92-ccf140ec9653",
 InitializationCell->True],
Cell[892545, 17943, 1219, 20, 70, "Input",ExpressionUUID->"f42d2041-a5a2-47f6-a1ed-36f8a96cd18b",
 InitializationCell->True],
Cell[893767, 17965, 24241, 513, 70, "Input",ExpressionUUID->"63da2822-8b11-43e6-9295-5a294a4f7a0e",
 InitializationCell->True],
Cell[918011, 18480, 1142, 19, 70, "Input",ExpressionUUID->"34c51dac-8753-41d0-b735-5357f53cd7e2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[919190, 18504, 819, 12, 49, "Subchapter",ExpressionUUID->"a8b3473f-7956-4cdf-bedc-4daf3905b910"],
Cell[920012, 18518, 445, 9, 70, "Input",ExpressionUUID->"ef238868-85bb-45e7-bdf3-16d50502ebbd",
 InitializationCell->True],
Cell[920460, 18529, 1441, 28, 70, "Input",ExpressionUUID->"75c95abf-d66f-4b84-afcb-899dfacfb16f",
 InitializationCell->True],
Cell[921904, 18559, 1219, 20, 70, "Input",ExpressionUUID->"8c819c7f-8146-44fa-80ec-28d1151a012f",
 InitializationCell->True],
Cell[923126, 18581, 35648, 645, 70, "Input",ExpressionUUID->"e95c523f-e25b-4f2b-8b3b-c87bc52cba1d",
 InitializationCell->True],
Cell[958777, 19228, 1142, 19, 70, "Input",ExpressionUUID->"8fd09bbc-90d0-478c-b034-bf21ef2762de",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[959956, 19252, 797, 11, 49, "Subchapter",ExpressionUUID->"260cf381-8e26-4b2a-a9c2-945d9d8ca66d"],
Cell[960756, 19265, 445, 9, 70, "Input",ExpressionUUID->"2ccfbe0b-a8f1-43c3-b27e-a926ff2823cf",
 InitializationCell->True],
Cell[961204, 19276, 1219, 20, 70, "Input",ExpressionUUID->"83e22536-bff4-44d7-b9c5-1be29c6e0dc0",
 InitializationCell->True],
Cell[962426, 19298, 15284, 239, 70, "Input",ExpressionUUID->"884e7a36-7904-452c-a0ed-2b278e861532",
 InitializationCell->True],
Cell[977713, 19539, 1142, 19, 70, "Input",ExpressionUUID->"df0319cd-1e8f-4fdd-a693-864763088e2d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[978892, 19563, 450, 7, 49, "Subchapter",ExpressionUUID->"b934d72a-6ed8-4db3-b8b8-13d3ffcf65bd"],
Cell[979345, 19572, 445, 9, 70, "Input",ExpressionUUID->"2f5ed8c8-e8c4-428e-a162-32c3c1e6b196",
 InitializationCell->True],
Cell[979793, 19583, 1219, 20, 70, "Input",ExpressionUUID->"bcabff55-690a-4a90-8edc-3680705d2947",
 InitializationCell->True],
Cell[981015, 19605, 5033, 90, 70, "Input",ExpressionUUID->"8b8efc98-fb44-405c-9999-e95ad45a984b",
 InitializationCell->True],
Cell[986051, 19697, 1142, 19, 70, "Input",ExpressionUUID->"62c6a1e8-b7cc-4499-bec2-0b72ed3cc94d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[987230, 19721, 390, 6, 49, "Subchapter",ExpressionUUID->"1f92a3f4-158a-426e-9e4c-8235584137d5"],
Cell[987623, 19729, 445, 9, 70, "Input",ExpressionUUID->"a30969de-3ec1-4a89-b675-e74e65e6c030",
 InitializationCell->True],
Cell[988071, 19740, 887, 19, 70, "Input",ExpressionUUID->"756406cb-15d1-42c5-8bbb-f7da7c18360e",
 InitializationCell->True],
Cell[988961, 19761, 1219, 20, 70, "Input",ExpressionUUID->"10654a33-b1b0-47dc-947b-6fe59e0bccab",
 InitializationCell->True],
Cell[990183, 19783, 16366, 316, 70, "Input",ExpressionUUID->"94f30ddb-232e-48db-bb64-dbcefb71e62e",
 InitializationCell->True],
Cell[1006552, 20101, 1142, 19, 70, "Input",ExpressionUUID->"21745d01-5e4b-4055-8655-98661a94bedc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1007731, 20125, 391, 6, 49, "Subchapter",ExpressionUUID->"ded90728-21fa-437a-8696-d0dd3ec677a2"],
Cell[1008125, 20133, 445, 9, 70, "Input",ExpressionUUID->"0c42b29b-8605-4be1-b2cb-60db6ce45526",
 InitializationCell->True],
Cell[1008573, 20144, 1223, 21, 70, "Input",ExpressionUUID->"a5f08b51-82ff-4737-a3e1-369cd472067c",
 InitializationCell->True],
Cell[1009799, 20167, 1219, 20, 70, "Input",ExpressionUUID->"62bf923b-e934-4220-a7e9-59194ea62628",
 InitializationCell->True],
Cell[1011021, 20189, 5014, 105, 70, "Input",ExpressionUUID->"854059f1-7a28-4376-8109-e0ea2628a7a9",
 InitializationCell->True],
Cell[1016038, 20296, 12266, 234, 70, "Input",ExpressionUUID->"e84457cb-6a86-4c41-968e-f5335ea663b4",
 InitializationCell->True],
Cell[1028307, 20532, 1142, 19, 70, "Input",ExpressionUUID->"680d1989-ce15-4dea-afc0-d619281fd301",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1029486, 20556, 563, 8, 49, "Subchapter",ExpressionUUID->"dcbfee7f-15a0-4d52-b21d-03e41b1f4ad2"],
Cell[1030052, 20566, 445, 9, 46, "Input",ExpressionUUID->"f35d0055-6f60-4e7b-9582-3703a2e836cd",
 InitializationCell->True],
Cell[1030500, 20577, 2744, 68, 551, "Input",ExpressionUUID->"19292abe-2104-4d0f-99a8-cba5b75fc1ef",
 InitializationCell->True],
Cell[1033247, 20647, 1219, 20, 46, "Input",ExpressionUUID->"bbd9b0e1-524f-40bb-882a-72e1cc5a55a0",
 InitializationCell->True],
Cell[1034469, 20669, 214754, 4056, 18602, "Input",ExpressionUUID->"379502d5-c106-457f-bf54-55fc37b9d320",
 InitializationCell->True],
Cell[1249226, 24727, 1241, 20, 46, "Input",ExpressionUUID->"96d5baa1-d63b-4337-8c39-23d634ea0015",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1250504, 24752, 382, 6, 49, "Subchapter",ExpressionUUID->"7edb0c14-61cb-42de-9604-9832a854accc"],
Cell[1250889, 24760, 445, 9, 70, "Input",ExpressionUUID->"01f0d7dc-69ff-4dfe-8296-76c5dc587e1e",
 InitializationCell->True],
Cell[1251337, 24771, 950, 20, 70, "Input",ExpressionUUID->"512d40c8-4127-484a-9a2c-19a31e34fcfe",
 InitializationCell->True],
Cell[1252290, 24793, 1219, 20, 70, "Input",ExpressionUUID->"d039b04d-8074-42cb-a636-7e089792d99c",
 InitializationCell->True],
Cell[1253512, 24815, 1299, 26, 70, "Input",ExpressionUUID->"afcdcef5-20c0-43a4-bb25-f286a4ca0572",
 InitializationCell->True],
Cell[1254814, 24843, 1142, 19, 70, "Input",ExpressionUUID->"0ed89cd1-a647-47ba-8769-25c82785c977",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1255993, 24867, 531, 8, 49, "Subchapter",ExpressionUUID->"1ee9796d-ca33-4f47-82bc-fd855441723e"],
Cell[1256527, 24877, 445, 9, 70, "Input",ExpressionUUID->"308dc694-917e-49d3-a8c7-791e8fd1bd1e",
 InitializationCell->True],
Cell[1256975, 24888, 558, 12, 70, "Input",ExpressionUUID->"68d9ecfb-bdcc-4260-806b-3de8af194b3d",
 InitializationCell->True],
Cell[1257536, 24902, 1219, 20, 70, "Input",ExpressionUUID->"60bc7d5c-22ff-47db-bb5d-a3d7ff01acfe",
 InitializationCell->True],
Cell[1258758, 24924, 2962, 48, 70, "Input",ExpressionUUID->"7fbd8156-a87a-4ffc-bf25-a7b43740946c",
 InitializationCell->True],
Cell[1261723, 24974, 1142, 19, 70, "Input",ExpressionUUID->"e432a5ba-f266-4c39-aedb-f76fedc376cc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1262902, 24998, 530, 8, 49, "Subchapter",ExpressionUUID->"e82899cb-5142-48ca-aa63-a1ae32398367"],
Cell[1263435, 25008, 445, 9, 70, "Input",ExpressionUUID->"9cfe6c3b-dca6-4c02-8fa1-820e33d7db46",
 InitializationCell->True],
Cell[1263883, 25019, 328, 9, 70, "Input",ExpressionUUID->"4010deae-e59c-43c8-bb68-e8d2ef5b1682",
 InitializationCell->True],
Cell[1264214, 25030, 1219, 20, 70, "Input",ExpressionUUID->"18075ca2-c35c-4706-aae5-a16164bf4c43",
 InitializationCell->True],
Cell[1265436, 25052, 1228, 25, 70, "Input",ExpressionUUID->"89e11bbe-d625-4cd9-81c0-b92b2ef2db50",
 InitializationCell->True],
Cell[1266667, 25079, 1142, 19, 70, "Input",ExpressionUUID->"36b58bcf-aee4-4393-9da7-2eda9350067f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1267846, 25103, 529, 8, 49, "Subchapter",ExpressionUUID->"14e7537d-d85f-464d-8285-8e7421791d94"],
Cell[1268378, 25113, 445, 9, 70, "Input",ExpressionUUID->"2eeb92ce-21c2-4b72-81f9-3339b30a20dc",
 InitializationCell->True],
Cell[1268826, 25124, 572, 12, 70, "Input",ExpressionUUID->"a54cc151-3acd-4ac8-9750-5a865c9d6de0",
 InitializationCell->True],
Cell[1269401, 25138, 1219, 20, 70, "Input",ExpressionUUID->"f7842086-a5a9-4f31-8f35-2cf414a16585",
 InitializationCell->True],
Cell[1270623, 25160, 3316, 53, 70, "Input",ExpressionUUID->"c179305c-a4bf-4194-8043-f7e900eb0689",
 InitializationCell->True],
Cell[1273942, 25215, 1142, 19, 70, "Input",ExpressionUUID->"4c112612-115f-4f20-8cb3-c544fd7ce9c5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1275121, 25239, 457, 7, 49, "Subchapter",ExpressionUUID->"7ed11d35-40ee-43d9-94e8-482b81aefcf5"],
Cell[1275581, 25248, 445, 9, 70, "Input",ExpressionUUID->"d9b18289-34f4-4aa1-b46b-519c61097da9",
 InitializationCell->True],
Cell[1276029, 25259, 498, 11, 70, "Input",ExpressionUUID->"1e553c1a-b85b-4618-b123-3887ed26fcb8",
 InitializationCell->True],
Cell[1276530, 25272, 1219, 20, 70, "Input",ExpressionUUID->"1a7547e2-9cdf-4e62-87bb-e2a246cfd48d",
 InitializationCell->True],
Cell[1277752, 25294, 2951, 48, 70, "Input",ExpressionUUID->"fdd0a9e9-fcdb-4349-a199-467535dfc2ca",
 InitializationCell->True],
Cell[1280706, 25344, 1142, 19, 70, "Input",ExpressionUUID->"07e5c605-8135-430b-b7b7-11a2648d2150",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1281885, 25368, 565, 8, 49, "Subchapter",ExpressionUUID->"1afa8fde-ca4b-42aa-8d46-b2e2acee4420"],
Cell[1282453, 25378, 445, 9, 70, "Input",ExpressionUUID->"3b4ababb-599b-4d81-8973-f4082bedc3a0",
 InitializationCell->True],
Cell[1282901, 25389, 592, 12, 70, "Input",ExpressionUUID->"1b6edf07-1915-46fe-90ec-715622ba3248",
 InitializationCell->True],
Cell[1283496, 25403, 1219, 20, 70, "Input",ExpressionUUID->"8d0c8b9a-5232-4995-b361-c07f758ee9a5",
 InitializationCell->True],
Cell[1284718, 25425, 3036, 49, 70, "Input",ExpressionUUID->"dcb3ea01-2d35-4494-8d26-2f28b03e4378",
 InitializationCell->True],
Cell[1287757, 25476, 1142, 19, 70, "Input",ExpressionUUID->"3c8346e8-6fe5-48fa-8ec1-1ef223016a93",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1288936, 25500, 388, 6, 49, "Subchapter",ExpressionUUID->"d99b6346-74cc-4cf8-afd7-795dc476aa8c"],
Cell[1289327, 25508, 445, 9, 46, "Input",ExpressionUUID->"b4079e1c-152a-4503-82bd-ddd31b20c62f",
 InitializationCell->True],
Cell[1289775, 25519, 384, 9, 46, "Input",ExpressionUUID->"5b9764d2-32b5-4f2f-ba66-9bd1076f63ba",
 InitializationCell->True],
Cell[1290162, 25530, 1219, 20, 46, "Input",ExpressionUUID->"7594a992-6237-4e17-99d8-a3ee22dbcb31",
 InitializationCell->True],
Cell[1291384, 25552, 23062, 434, 1832, "Input",ExpressionUUID->"6b99e172-d3f3-42ed-a160-085700686e7c",
 InitializationCell->True],
Cell[1314449, 25988, 1142, 19, 46, "Input",ExpressionUUID->"c5fc2d7f-b251-46ea-9e75-986cad36ed5b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1315628, 26012, 212, 4, 49, "Subchapter",ExpressionUUID->"094b011c-26a1-4968-8ae3-c94a98a7f1a3"],
Cell[1315843, 26018, 1115, 18, 70, "Input",ExpressionUUID->"f773d851-9257-4db3-b5f6-5440d6749ba2",
 InitializationCell->True],
Cell[1316961, 26038, 2407, 55, 70, "Input",ExpressionUUID->"4fb164c4-033e-4cfc-97f5-0844463043fe",
 InitializationCell->True],
Cell[1319371, 26095, 1142, 19, 70, "Input",ExpressionUUID->"c0e1a560-6c07-4151-976e-11b0002aca45",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1320550, 26119, 233, 4, 49, "Subchapter",ExpressionUUID->"c0c93f93-607e-4d78-a81f-df7292286160"],
Cell[1320786, 26125, 1115, 18, 46, "Input",ExpressionUUID->"1bdfba51-a44e-431e-a9a4-9747dd7d7281",
 InitializationCell->True],
Cell[1321904, 26145, 961, 22, 68, "Input",ExpressionUUID->"a0d73740-ce15-468e-a798-5451ed621dc9",
 InitializationCell->True],
Cell[1322868, 26169, 1142, 19, 46, "Input",ExpressionUUID->"4d74b0d1-812a-4e21-a863-deb5daa938b6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1324047, 26193, 218, 4, 49, "Subchapter",ExpressionUUID->"e1502916-aa81-4d14-a5ab-18d193a73be2"],
Cell[1324268, 26199, 445, 9, 70, "Input",ExpressionUUID->"850b1af7-2240-4294-af08-9a636d75e0be",
 InitializationCell->True],
Cell[1324716, 26210, 335, 9, 70, "Input",ExpressionUUID->"5a0f5590-c0c4-4410-9da1-f28a5152b8f8",
 InitializationCell->True],
Cell[1325054, 26221, 1115, 18, 70, "Input",ExpressionUUID->"0c859d7c-b07d-40c4-bd6e-e912e1682a3e",
 InitializationCell->True],
Cell[1326172, 26241, 1047, 22, 70, "Input",ExpressionUUID->"bf18f074-3250-49e8-be21-fa99e25632a9",
 InitializationCell->True],
Cell[1327222, 26265, 1142, 19, 70, "Input",ExpressionUUID->"bc37be63-d30d-4c65-9076-d7cb614b6c9e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1328401, 26289, 332, 5, 49, "Subchapter",ExpressionUUID->"027a6d30-cb07-4d0d-8500-636662c8f68f"],
Cell[1328736, 26296, 445, 9, 46, "Input",ExpressionUUID->"a9a23a0a-a372-47a8-a46a-4bd067ae235f",
 InitializationCell->True],
Cell[1329184, 26307, 1219, 20, 49, "Input",ExpressionUUID->"d61c8724-ea84-47e5-ac45-e219c1f7e9e5",
 InitializationCell->True],
Cell[1330406, 26329, 4897, 81, 173, "Input",ExpressionUUID->"1d38db34-5e31-4da7-aff9-1025b9de0a1e",
 InitializationCell->True],
Cell[1335306, 26412, 1142, 19, 46, "Input",ExpressionUUID->"19035960-f719-4c40-a423-507cdae71b2e",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1336497, 26437, 258, 5, 69, "Chapter",ExpressionUUID->"7bef4390-a47c-4f20-a8b9-8cb594541f9f"],
Cell[1336758, 26444, 680, 13, 70, "Input",ExpressionUUID->"89d7418e-834b-4e94-bf74-b664515b9ceb",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}
]
*)

