(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70794,       1494]
NotebookOptionsPosition[     69088,       1454]
NotebookOutlinePosition[     69484,       1470]
CellTagsIndexPosition[     69441,       1467]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Extract usage messages", "Title",
 CellChangeTimes->{{3.861679279278838*^9, 
  3.861679282558979*^9}},ExpressionUUID->"b3075cdb-58c2-4a7a-9500-\
fa8b494584d5"],

Cell[CellGroupData[{

Cell["Required definitions", "Chapter",
 CellChangeTimes->{{3.861679559486532*^9, 
  3.861679566639193*^9}},ExpressionUUID->"39dc4f88-36f0-465b-b493-\
119bcd034ac8"],

Cell[CellGroupData[{

Cell["CreateUsage", "Subchapter",
 CellChangeTimes->{{3.7617376378913727`*^9, 
  3.761737640177575*^9}},ExpressionUUID->"c50282dc-e3e7-4865-928c-\
144c262a4df6"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Messages", ",", " ", "options", ",", " ", 
   RowBox[{"attributes", " ", "and", " ", "syntax", " ", "information"}]}], 
  " ", "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650292046940385*^9, 3.650292055837142*^9}, 
   3.6502927586977587`*^9, {3.6678074330734873`*^9, 3.6678074367696*^9}, {
   3.6678100547077*^9, 3.667810058922462*^9}, {3.756703628204927*^9, 
   3.7567036345557528`*^9}, {3.761729271259387*^9, 3.761729293240218*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[32]:=",ExpressionUUID->"337f215a-0179-4862-b754-ab39a6aef148"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CreateUsage", "::", "InvalidInput"}], "=", 
   "\"\<The usage is neither a string nor a list of strings.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateUsage", "::", "InvalidDir"}], "=", 
   "\"\<\[LeftGuillemet]`1`\[RightGuillemet] is not a valid directory.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateUsage", "::", "link"}], "=", 
   "\"\<The function name \[LeftGuillemet]`1`\[RightGuillemet] needs to be a \
hyperlink.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateUsage", "::", "PackageName"}], "=", 
   "\"\<Failed to obtain the application/package name.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateUsage", "::", "NoUsage"}], "=", 
   "\"\<No usage content found in \
\[LeftGuillemet]`1`\[RightGuillemet].\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateUsage", "::", "NoDocPages"}], "=", 
    "\"\<Unable to find any accompanying documentation pages.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "CreateUsage"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<AppendHyperlink\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<DefinitionsNotebook\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<FormattedInput\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<OverwriteAutomatically\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<WriteTo\>\"", "\[Rule]", "\"\<\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6678104346724377`*^9, {3.667810873424903*^9, 3.667810875341351*^9}, {
   3.667908690584041*^9, 3.6679087037986794`*^9}, {3.66816649847222*^9, 
   3.668166502894822*^9}, {3.668168391112651*^9, 3.668168392544508*^9}, {
   3.6681686970571632`*^9, 3.668168720912581*^9}, {3.668171328149095*^9, 
   3.668171328331027*^9}, {3.668174651092638*^9, 3.668174651628518*^9}, {
   3.6681747682269382`*^9, 3.668174770113784*^9}, {3.761653378966709*^9, 
   3.761653395256031*^9}, {3.7617301843750668`*^9, 3.761730184949564*^9}, {
   3.761738034753793*^9, 3.761738036229587*^9}, {3.761738338645947*^9, 
   3.76173835119728*^9}, {3.761738457907413*^9, 3.761738472273652*^9}, {
   3.761738506296303*^9, 3.7617385072401123`*^9}, {3.761738570176149*^9, 
   3.761738582366355*^9}, 3.761739492276843*^9, 3.761740245942645*^9, {
   3.7617405669682817`*^9, 3.7617405947172537`*^9}, {3.761741792645215*^9, 
   3.761741792780016*^9}, {3.7617426538989763`*^9, 3.7617426594642887`*^9}, {
   3.761742724889574*^9, 3.7617427370731573`*^9}, {3.761742905476491*^9, 
   3.7617429057231407`*^9}, {3.761747841767312*^9, 3.761747843456684*^9}, {
   3.761747905315789*^9, 3.761747935858485*^9}, {3.761748030057239*^9, 
   3.761748042799911*^9}, {3.761748081008893*^9, 3.7617480938551273`*^9}, {
   3.761749042093767*^9, 3.761749054146908*^9}, {3.761749161520526*^9, 
   3.7617491646728487`*^9}, {3.7617496251433287`*^9, 
   3.7617496307192507`*^9}, {3.761749686901018*^9, 3.761749702524666*^9}, {
   3.761752267038497*^9, 3.7617522700733852`*^9}, 3.7617528373078213`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"6c054b12-30d5-40fa-a071-e7c9c11a14af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateUsage", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"application_String", ",", "symbol_"}], "}"}], ",", "usage_", 
    ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"definitionsQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<DefinitionsNotebook\>\"", "]"}]}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"formattedQ", "=", 
       RowBox[{"OptionValue", "[", "\"\<FormattedInput\>\"", "]"}]}], ",", 
      "L", ",", "usagelist", ",", "messagelist", ",", "\[IndentingNewLine]", 
      "cleared1", ",", "cleared2", ",", "cleared3", ",", "cleared4", ",", 
      "\[IndentingNewLine]", "arguments", ",", "rules", ",", "message", ",", 
      "nogap", ",", "complete", ",", "f", ",", "\[IndentingNewLine]", 
      "outputfile", ",", "old", ",", "windowtext", ",", "decision", ",", 
      "case"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"--", "-"}], "*", " ", "Analysing", " ", "input", " ", "*", 
      RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Message", " ", "may", " ", "already", " ", "be", " ", "formatted"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"usage", ",", "StandardForm"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<StyleBox\>\"", "|", "\"\<SubscriptBox\>\""}]}], "]"}], 
       ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"formattedQ", "=", "True"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"formattedQ", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "@", "usage"}], ",", "\[IndentingNewLine]", 
          RowBox[{"messagelist", "=", "usage"}], ",", "\[IndentingNewLine]", 
          RowBox[{"messagelist", "=", 
           RowBox[{"{", "usage", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Goto", "[", "\"\<FormattingDone\>\"", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", "-"}], "*", " ", "Input", " ", "form", " ", "*", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"Head", "@", "usage"}], "]"}], "\[Equal]", 
        "\"\<String\>\""}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"L", "=", "1"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"usagelist", "=", 
         RowBox[{"{", "usage", "}"}]}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"Head", "@", "usage"}], "]"}], "\[Equal]", "\"\<List\>\""}], 
       ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{"usage", ",", "StringQ"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"CreateUsage", "::", "InvalidInput"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{"L", "=", 
         RowBox[{"Length", "@", "usage"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"usagelist", "=", "usage"}]}], ",", "\[IndentingNewLine]", 
       "\t", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"CreateUsage", "::", "InvalidInput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Formatting", " ", "one", " ", "or", " ", "several", " ", 
       "messages"}], " ", "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"messagelist", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Formatting", " ", "usage", " ", "message"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"In", " ", "case", " ", "function", " ", "name", " ", 
        RowBox[{"contains", " ", "'"}], 
        RowBox[{"$", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"cleared1", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{
           RowBox[{
           "usagelist", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"\"\<$\>\"", "~~", 
            RowBox[{"LetterCharacter", ".."}], "~~", "_"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"cleared2", "=", 
         RowBox[{"StringTrim", "@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"cleared1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"x", ",", 
                RowBox[{"-", "1"}]}], "]"}], "\[Equal]", "\"\<$\>\""}]}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"cleared3", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"cleared2", ",", 
           RowBox[{"\"\<$\>\"", "\[Rule]", "\"\<\[Section]\>\""}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"cleared4", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{
           "usagelist", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{"cleared2", "\[Rule]", "cleared3"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
        RowBox[{"arguments", "=", 
         RowBox[{"StringCases", "[", 
          RowBox[{"cleared4", ",", 
           RowBox[{"Shortest", "[", 
            RowBox[{"\"\<$\>\"", "~~", "__", "~~", "\"\<$\>\""}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"rules", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{
            "arguments", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[Rule]", 
            RowBox[{"\"\<\\!\\(\\*\\nStyleBox[\\\"\>\"", "<>", 
             RowBox[{"arguments", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<>", 
             "\"\<\\\", \\\"TI\\\"]\\)\>\""}]}], ",", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "arguments"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"cleared4", ",", "rules"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringDelete", "[", 
          RowBox[{"message", ",", "\"\<$\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"message", ",", 
           RowBox[{"\"\<\[Section]\>\"", "\[Rule]", "\"\<$\>\""}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Processing", " ", "subscripts"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"nogap", "=", 
         RowBox[{
          RowBox[{"WordCharacter", ".."}], "|", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"\"\< \>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Except", "[", "\"\< \>\"", "]"}], ".."}], "~~", 
              "\"\<, \>\"", "~~", 
              RowBox[{
               RowBox[{"Except", "[", "\"\< \>\"", "]"}], ".."}]}]}], "]"}], 
           ".."}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"message", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"pre", ":", "nogap"}], "~~", "\"\<_\>\"", "~~", 
             RowBox[{"sub", ":", "nogap"}]}], "\[RuleDelayed]", 
            RowBox[{
            "\"\<\\!\\(\\*SubscriptBox[\\(\>\"", "<>", "pre", "<>", 
             "\"\<\\), \\(\>\"", "<>", "sub", "<>", "\"\<\\)]\\)\>\""}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Correcting", " ", "ellipses"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"message", ",", 
           RowBox[{"\"\<...\>\"", "\[Rule]", "\"\<\[Ellipsis]\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Correcting", " ", "spaces", " ", "between", " ", "arguments"}], " ",
          "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"message", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"message", ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\"\<\\\"TI\\\"]\\),\\!\\(\\*\\nStyleBox[\>\"", "\[Rule]", 
              "\"\<\\\"TI\\\"], \\*\\nStyleBox[\>\""}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<\\\"TI\\\"]\\),{\\!\\(\\*\\nStyleBox[\>\"", "\[Rule]", 
              "\"\<\\\"TI\\\"]\\), {\\!\\(\\*\\nStyleBox[\>\""}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
             "\"\<\\\"TI\\\"]\\)},\\!\\(\\*\\nStyleBox[\>\"", "\[Rule]", 
              "\"\<\\\"TI\\\"]\\)}, \\!\\(\\*\\nStyleBox[\>\""}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"messagelist", ",", "message"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "L"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "Preparing", " ", "the", " ", "usage", " ", "layout"}], " ", 
      "**)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Label", "[", "\"\<FormattingDone\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"complete", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{"messagelist", ",", "\"\<\\n\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Appending", " ", "hyperlink", " ", "to", " ", "the", " ", 
       "documentation"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"ToString", "@", "symbol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<AppendHyperlink\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"complete", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"complete", "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
             "\"\<   \>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"Hyperlink", "[", 
              RowBox[{"\"\<\[RightSkeleton]\>\"", ",", 
               RowBox[{
               "\"\<paclet:\>\"", "<>", "application", "<>", "\"\</ref/\>\"", 
                "<>", "f"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ActiveStyle", "\[Rule]", "None"}]}], "]"}]}], "}"}], 
           "]"}], ",", "StandardForm"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Setting", " ", "the", " ", "usage"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"outputfile", "=", 
      RowBox[{"ToString", "@", 
       RowBox[{"OptionValue", "[", "\"\<WriteTo\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"message", "=", 
      RowBox[{"StringJoin", "@", "complete"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DirectoryName", "[", "outputfile", "]"}], "===", 
         "\"\<\>\""}], "||", 
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "@", 
          RowBox[{"DirectoryName", "@", "outputfile"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"symbol", "::", "usage"}], "=", "message"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Return", "@", 
         RowBox[{"Information", "[", 
          RowBox[{"symbol", ",", 
           RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"*", " ", 
       RowBox[{"Option", ":", " ", 
        RowBox[{"Store", " ", "usage", " ", "messages"}]}]}], " ", "**)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "output", " ", "file", " ", "already", " ", 
       "exists"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "@", "outputfile"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{"outputfile", ",", "\"\<\>\""}], "]"}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"old", "=", "\"\<\>\""}]}], ",", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"old", "=", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"ReadString", "@", "outputfile"}], ",", 
          RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Check", " ", "if", " ", "file", " ", "already", " ", "contains", " ", 
       "the", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"old", ",", 
         RowBox[{"StartOfLine", "~~", 
          RowBox[{"f", "<>", "\"\<::usage=\>\""}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{
           "OptionValue", "[", "\"\<OverwriteAutomatically\>\"", "]"}]}], ",",
           "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"windowtext", "=", 
            RowBox[{"StringJoin", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"{", 
              RowBox[{
              "\"\<A usage message for \[LeftGuillemet]\>\"", ",", "f", ",", 
               "\"\<\[RightGuillemet] already exists in \[LeftGuillemet]\>\"",
                ",", "\[IndentingNewLine]", "\t", 
               RowBox[{"FileNameTake", "@", "outputfile"}], ",", 
               "\[IndentingNewLine]", "\t", 
               "\"\<\[RightGuillemet].\\nWould you like to overwrite the old \
message?\>\""}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"decision", "=", 
            RowBox[{"ChoiceDialog", "[", 
             RowBox[{"windowtext", ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<No\>\"", "\[Rule]", "False"}], ",", 
                RowBox[{"\"\<Yes\>\"", "\[Rule]", "True"}]}], "}"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
              "WindowTitle", "\[Rule]", "\"\<Overwrite usage message\>\""}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"WindowFloating", "\[Rule]", "True"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "decision"}], ",", 
             RowBox[{"Abort", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "\t", "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Replacing", " ", "old", " ", "message"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"case", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"old", ",", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"Shortest", "[", 
             RowBox[{
              RowBox[{"f", "<>", "\"\<::usage=\>\""}], "~~", "__", "~~", 
              "\"\<;\>\""}], "]"}], "\[Rule]", "\[IndentingNewLine]", "\t\t", 
            
            RowBox[{"f", "<>", "\"\<::usage=\>\"", "<>", 
             RowBox[{"ToString", "@", 
              RowBox[{"FullForm", "@", 
               RowBox[{"StringJoin", "@", "message"}]}]}], "<>", 
             "\"\<;\>\""}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "@", 
         RowBox[{"Export", "[", 
          RowBox[{"outputfile", ",", "case"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Append", " ", "new", " ", "usage"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"WriteString", "[", 
      RowBox[{
      "outputfile", ",", "\[IndentingNewLine]", "\t", "old", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"f", "<>", "\"\<::usage=\>\"", "<>", 
        RowBox[{"ToString", "@", 
         RowBox[{"FullForm", "@", 
          RowBox[{"StringJoin", "@", "message"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\t", "\"\<;\\n\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"Close", "@", "outputfile"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, {3.667908932612733*^9, 
   3.667909140003276*^9}, {3.6679092891288967`*^9, 3.6679093072406178`*^9}, {
   3.667909378728078*^9, 3.667909385806776*^9}, 3.6679094645439787`*^9, {
   3.667909551805661*^9, 3.6679095772688637`*^9}, {3.667909873528627*^9, 
   3.667909885693358*^9}, {3.667909967926968*^9, 3.667910004853548*^9}, {
   3.667910046133897*^9, 3.667910050012671*^9}, {3.6679100833093767`*^9, 
   3.667910107176985*^9}, {3.667910226610819*^9, 3.667910251483017*^9}, {
   3.6679102972356453`*^9, 3.667910313883361*^9}, {3.667910354015862*^9, 
   3.667910355430586*^9}, {3.667910405695218*^9, 3.6679104080780973`*^9}, {
   3.667910449599267*^9, 3.667910452645286*^9}, {3.667910592254632*^9, 
   3.667910624761389*^9}, 3.667910683810557*^9, {3.667910720618655*^9, 
   3.6679108007765837`*^9}, {3.66816631739188*^9, 3.668166320959875*^9}, {
   3.6681663636956263`*^9, 3.668166444524235*^9}, 3.668167020727107*^9, {
   3.6681674635000753`*^9, 3.668167474657826*^9}, {3.668167560922271*^9, 
   3.668167602135705*^9}, {3.6681676393577623`*^9, 3.668167689140959*^9}, {
   3.668168102730618*^9, 3.668168128330806*^9}, {3.668168193267274*^9, 
   3.66816821744075*^9}, {3.668168266503697*^9, 3.66816831469429*^9}, {
   3.668168531225005*^9, 3.6681685421679087`*^9}, {3.6681689599427433`*^9, 
   3.6681689683253508`*^9}, {3.668169016156123*^9, 3.668169046211808*^9}, {
   3.668170043519361*^9, 3.668170047053616*^9}, {3.668170412696371*^9, 
   3.668170419100215*^9}, {3.668170560185047*^9, 3.668170641158381*^9}, {
   3.668171026147955*^9, 3.668171028550968*^9}, {3.668171330935315*^9, 
   3.668171415835734*^9}, {3.66817200462433*^9, 3.6681720337178497`*^9}, {
   3.668172471948838*^9, 3.668172621079666*^9}, {3.668172750597891*^9, 
   3.6681727815562363`*^9}, {3.668174823556732*^9, 3.6681748569470263`*^9}, {
   3.6695562733937073`*^9, 3.669556273567175*^9}, {3.730115678852222*^9, 
   3.730115699585402*^9}, {3.7301157323482027`*^9, 3.7301157333531857`*^9}, {
   3.730115767075754*^9, 3.7301157710654697`*^9}, {3.737970116749701*^9, 
   3.737970163733947*^9}, {3.76165340561904*^9, 3.761653416000424*^9}, {
   3.761653929290098*^9, 3.761653931545969*^9}, {3.761654237245414*^9, 
   3.761654239906726*^9}, {3.761654329517303*^9, 3.761654329694879*^9}, {
   3.76173804460476*^9, 3.761738084257183*^9}, {3.76173816483845*^9, 
   3.761738203014783*^9}, {3.761739750266831*^9, 3.7617397694072657`*^9}, {
   3.76174023883987*^9, 3.7617402393177032`*^9}, {3.761741721663971*^9, 
   3.7617417225744543`*^9}, {3.7617420315028048`*^9, 3.761742033895816*^9}, {
   3.761742066847624*^9, 3.7617420675321198`*^9}, {3.761742947692584*^9, 
   3.761742972792941*^9}, {3.761747820813118*^9, 3.761747852047037*^9}, {
   3.761747942733135*^9, 3.7617479912021027`*^9}, {3.761748050945744*^9, 
   3.761748069099825*^9}, {3.761748107967968*^9, 3.761748140344556*^9}, 
   3.7617482019970493`*^9, {3.761748258524949*^9, 3.761748258779244*^9}, {
   3.761748318753726*^9, 3.761748349362537*^9}, {3.761748405697798*^9, 
   3.761748464230748*^9}, 3.761751655565477*^9, 3.761752206641355*^9, {
   3.7617522874555073`*^9, 3.761752289301742*^9}, {3.761752390819339*^9, 
   3.761752438616386*^9}, 3.761752491098631*^9, {3.7617527357176123`*^9, 
   3.761752780446928*^9}, 3.761752842138254*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[40]:=",ExpressionUUID->"e1bba1d0-5d62-46dd-abe3-be87e4f50e94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateUsage", "[", 
   RowBox[{
    RowBox[{"notebook_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"FileExtension", "[", "#", "]"}], "===", "\"\<nb\>\""}], 
       "&"}], ")"}]}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"formattedQ", "=", 
       RowBox[{"OptionValue", "[", "\"\<FormattedInput\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"definitionsQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<DefinitionsNotebook\>\"", "]"}]}]}], 
      ",", "\[IndentingNewLine]", "nb", ",", "packageName", ",", 
      RowBox[{"functionName", "=", 
       RowBox[{"FileBaseName", "@", "notebook"}]}], ",", "check", ",", "data",
       ",", "\[IndentingNewLine]", "L", ",", "starts", ",", "intervals", ",", 
      "usages", ",", "span", ",", "\[IndentingNewLine]", "specialStart", ",", 
      "specialEnd", ",", "wrap", ",", "escapeQuotes", ",", "messages", ",", 
      "s", ",", "arg", ",", "info", ",", "startSpace", ",", "line", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"outputFile", "=", 
       RowBox[{"OptionValue", "[", "\"\<WriteTo\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "temp"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Special", " ", 
      RowBox[{"case", ":", " ", 
       RowBox[{"Definitions", " ", "notebook"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"definitionsQ", ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "@", 
        RowBox[{"CreateUsage", "[", 
         RowBox[{
         "notebook", ",", "\"\<Mode:DefinitionsNotebook\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Sequence", "@@", "#"}], "\[Rule]", 
             RowBox[{"OptionValue", "[", "#", "]"}]}], "&"}], "/@", 
           RowBox[{"Keys", "@", 
            RowBox[{"Options", "@", "CreateUsage"}]}]}]}], "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Get", " ", "main", " ", "usage", " ", "cell", " ", "from", " ", 
       RowBox[{"(", "undeployed", ")"}], " ", "documentation", " ", 
       "notebook"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nb", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"NotebookOpen", "[", 
         RowBox[{"notebook", ",", 
          RowBox[{"Visible", "\[Rule]", "False"}]}], "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetSelectedNotebook", "@", "nb"}], ";", "\[IndentingNewLine]", 
     RowBox[{"check", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"check", "===", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SelectionMove", "[", 
         RowBox[{"nb", ",", "Next", ",", "Cell"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"NotebookRead", "[", "nb", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"data", "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"CreateUsage", "::", "NoUsage"}], ",", 
             RowBox[{"FileNameTake", "@", "notebook"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"check", "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "data", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "===", "\"\<Usage\>\""}], ")"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookClose", "[", "nb", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "intervals", " ", "with", " ", "usage", " ", 
       "information"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"data", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"Length", "@", "temp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"starts", "=", 
      RowBox[{"starts", "=", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"temp", ",", "\"\<ModInfo\>\"", ",", "Infinity"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"starts", ",", 
         RowBox[{"{", "_Integer", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"intervals", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "starts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "L"}], "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"intervals", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "starts", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              ",", 
             RowBox[{
              RowBox[{"starts", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"Length", "@", "starts"}], "-", "1"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"intervals", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"intervals", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"intervals", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}], 
               "+", "2"}], ",", "L"}], "}"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"span", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Span", "[", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", "intervals"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"usages", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"temp", ",", "#"}], "]"}], "&"}], "/@", "span"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Extraction", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"specialStart", "=", "\"\<\\!\\(\\*\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"specialEnd", "=", "\"\<\\)\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wrap", "[", "input_", "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", "=", 
          RowBox[{"ToString", "@", "input"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"x", ",", "\"\<Box\>\""}], "]"}], ",", "x", ",", 
          RowBox[{"\"\<\\\"\>\"", "<>", "x", "<>", "\"\<\\\"\>\""}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"escapeQuotes", "[", "input_", "]"}], ":=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"input", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<,\>\"", "~~", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Except", "[", "\"\<,\>\"", "]"}], "..."}], "~~", 
           "\"\<\\\"\>\"", "~~", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Except", "[", "\"\<,\>\"", "]"}], "..."}], "~~", 
           "\[IndentingNewLine]", "\"\<\\\"\>\"", "~~", 
           RowBox[{"x", ":", 
            RowBox[{"LetterCharacter", ".."}]}], "~~", "\"\<\\\"\>\"", "~~", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Except", "[", "\"\<,\>\"", "]"}], "..."}], "~~", 
           "\"\<,\>\""}], "\[IndentingNewLine]", "]"}], "\[RuleDelayed]", 
         RowBox[{
         "\"\<, \\\"\\\\\\\"\\\", \\\"\[NegativeVeryThinSpace]\\\",\\\"\>\"", 
          "<>", "x", "<>", 
          "\"\<\\\", \\\"\[NegativeVeryThinSpace]\\\", \\\"\\\\\\\"\\\", \
\>\""}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"messages", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{
          RowBox[{
          "usages", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"x_ButtonBox", "\[RuleDelayed]", 
           RowBox[{"First", "@", "x"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"s", "=", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"StringDelete", "[", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"FullForm", "@", "s"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\\\\[LineSeparator]\>\"", ",", "\"\<\\\\n\>\""}], 
             "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"s", ",", "\"\<[\>\"", ",", "Infinity"}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Function", " ", "name", " ", "only"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"arg", "=", "functionName"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"s", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"functionName", ",", "\"\<[\>\"", ",", "\"\<]\>\""}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Void", " ", "function"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"arg", "=", 
           RowBox[{"ToString", "@", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "\"\<\\\"\>\"", "<>", "functionName", "<>", "\"\<\\\"\>\""}], 
               ",", 
               RowBox[{
               "\"\<\\\"\>\"", "<>", "\"\<[]\>\"", "<>", "\"\<\\\"\>\""}]}], 
              "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"arg", "=", 
            RowBox[{"s", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", 
              RowBox[{"3", ";;", 
               RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Depth", "@", "arg"}], "<", "5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"arg", "=", 
              RowBox[{"RowBox", "[", 
               RowBox[{"{", 
                RowBox[{"functionName", ",", "\"\<[\>\"", ",", 
                 RowBox[{"First", "@", "arg"}], ",", "\"\<]\>\""}], "}"}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"arg", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"arg", ",", 
                 RowBox[{"{", 
                  RowBox[{"functionName", ",", "\"\<[\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"arg", "=", 
               RowBox[{"Insert", "[", 
                RowBox[{"arg", ",", "\"\<]\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"arg", "=", 
               RowBox[{"FlattenAt", "[", 
                RowBox[{
                 RowBox[{"First", "@", "arg"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"arg", "=", 
            RowBox[{"wrap", "//@", "arg"}]}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"arg", "=", 
         RowBox[{"escapeQuotes", "[", "arg", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"info", "=", 
         RowBox[{
          RowBox[{"s", "\[LeftDoubleBracket]", 
           RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"s_String", "\[RuleDelayed]", 
           RowBox[{"\"\<\\\"\>\"", "<>", "s", "<>", "\"\<\\\"\>\""}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"info", "=", 
         RowBox[{"info", "/.", 
          RowBox[{"s_String", "\[RuleDelayed]", 
           RowBox[{"StringDelete", "[", 
            RowBox[{"s", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\[LineSeparator]\>\"", ",", "\"\<\\n\>\""}], 
              "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"startSpace", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{
              "info", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "===", "\"\< \>\""}], ",", 
           "\"\<\>\"", ",", "\"\< \>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"info", "=", 
         RowBox[{"escapeQuotes", "@", 
          RowBox[{"ToString", "@", 
           RowBox[{"RowBox", "@", "info"}]}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"line", "=", 
         RowBox[{
         "specialStart", "<>", "arg", "<>", "specialEnd", "<>", "startSpace", 
          "<>", "specialStart", "<>", "info", "<>", "specialEnd"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"messages", ",", "line"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"Length", "@", "intervals"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Acquiring", " ", 
       RowBox[{"application", "/", "pacakge"}], " ", "name"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"data", ",", "InputForm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"packageName", "=", 
      RowBox[{"StringCases", "[", 
       RowBox[{"data", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<paclet:\>\"", "~~", 
           RowBox[{"name", ":", 
            RowBox[{"LetterCharacter", ".."}]}], "~~", "\"\</ref/\>\""}], 
          "]"}], "\[RuleDelayed]", "name"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"data", ",", "\"\<ButtonData\>\""}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CreateUsage", "::", "link"}], ",", "functionName"}], "]"}],
         ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"packageName", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"CreateUsage", "::", "PackageName"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"packageName", "=", 
      RowBox[{
      "packageName", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"outputFile", "=!=", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"(*", " ", 
        RowBox[{"A", ".", " ", 
         RowBox[{"Optional", ":", " ", 
          RowBox[{
          "Write", " ", "usage", " ", "data", " ", "to", " ", "a", " ", 
           "file"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "output", " ", "directory"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"DirectoryQ", "@", 
            RowBox[{"DirectoryName", "@", "outputFile"}]}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"CreateUsage", "::", "InvalidDir"}], ",", 
             RowBox[{"DirectoryName", "@", "outputFile"}]}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Write", " ", "information", " ", "to", " ", "output", " ", "file"}],
          " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"CreateUsage", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"packageName", ",", "functionName"}], "}"}], ",", 
          "messages", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"\"\<FormattedInput\>\"", "\[Rule]", "True"}], ",", 
          RowBox[{"\"\<WriteTo\>\"", "\[Rule]", "outputFile"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"B", ".", " ", "Just"}], " ", "output", " ", "messages"}], 
        " ", "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Optional", ":", " ", 
         RowBox[{
          RowBox[{"Include", " ", "package"}], "-", " ", 
          RowBox[{
          "and", " ", "function", " ", "name", " ", "if", " ", "just", " ", 
           "outputting", " ", "messages"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"packageName", "=", 
         RowBox[{"StringCases", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{"notebook", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"name", ":", 
              RowBox[{
               RowBox[{"Except", "[", "\"\</\>\"", "]"}], ".."}]}], "~~", 
             "\"\</Documentation\>\""}], "\[RuleDelayed]", "name"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"packageName", "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "messages", ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "packageName", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "functionName", ",", 
            "messages"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.667810424970599*^9, 3.667810432313558*^9}, 
   3.667810883538918*^9, {3.6678119799664907`*^9, 3.667812004062636*^9}, {
   3.667812039037266*^9, 3.667812072607596*^9}, 3.667812406683673*^9, {
   3.667813882624302*^9, 3.6678138933821697`*^9}, 3.667814924729149*^9, {
   3.66781496632804*^9, 3.6678149928687553`*^9}, {3.6678150319879923`*^9, 
   3.667815059729232*^9}, {3.6678370650379553`*^9, 3.667837080571652*^9}, {
   3.667837156210669*^9, 3.667837159120823*^9}, 3.6678423893311787`*^9, 
   3.6678424458027067`*^9, {3.667842486408422*^9, 3.6678424870521097`*^9}, {
   3.6678491837908373`*^9, 3.667849196316847*^9}, {3.6678492310627127`*^9, 
   3.667849347867344*^9}, {3.667849386562244*^9, 3.6678493956660547`*^9}, {
   3.6678502690321627`*^9, 3.667850270718402*^9}, {3.667885432315948*^9, 
   3.667885443584289*^9}, {3.6678886091768827`*^9, 3.667888618284264*^9}, {
   3.667888726013617*^9, 3.667888727965447*^9}, {3.667888851663785*^9, 
   3.667888852473021*^9}, {3.667889152447135*^9, 3.667889163822752*^9}, {
   3.667889360643476*^9, 3.667889390482397*^9}, {3.667889485585231*^9, 
   3.667889487263101*^9}, {3.667889595757792*^9, 3.667889620724247*^9}, {
   3.667890108962254*^9, 3.667890109608528*^9}, {3.667890744858707*^9, 
   3.667890745731081*^9}, {3.667890790906273*^9, 3.6678907919220057`*^9}, {
   3.667891889841053*^9, 3.667891891247429*^9}, {3.6678922519045677`*^9, 
   3.667892262455718*^9}, {3.667892311486883*^9, 3.667892316670149*^9}, {
   3.667892371374642*^9, 3.667892376260646*^9}, {3.6678924271076107`*^9, 
   3.667892427763419*^9}, {3.667892720984558*^9, 3.667892730684279*^9}, {
   3.66789278719515*^9, 3.6678928066426153`*^9}, {3.667893342922476*^9, 
   3.667893368893684*^9}, 3.667893456485235*^9, {3.6678935550008574`*^9, 
   3.6678935567286158`*^9}, {3.667893598705802*^9, 3.667893607287561*^9}, {
   3.667893653960865*^9, 3.667893674718265*^9}, 3.667893707506178*^9, {
   3.667894873347105*^9, 3.667894873506961*^9}, {3.667895011329136*^9, 
   3.667895024376791*^9}, {3.6678953032984324`*^9, 3.667895345849135*^9}, {
   3.667895452725642*^9, 3.667895462941853*^9}, {3.667895500317997*^9, 
   3.6678955012370453`*^9}, 3.6678956557417593`*^9, {3.667895779383746*^9, 
   3.6678958100700207`*^9}, {3.667895851933743*^9, 3.6678958935560913`*^9}, {
   3.667896171574704*^9, 3.667896263763373*^9}, {3.667896312122861*^9, 
   3.667896324754409*^9}, {3.6678963903543158`*^9, 3.6678964114961843`*^9}, {
   3.667896455809155*^9, 3.667896456675251*^9}, {3.667896493914776*^9, 
   3.667896525742229*^9}, {3.6678965891093082`*^9, 3.667896621691443*^9}, {
   3.667896713242935*^9, 3.667896755072253*^9}, {3.667896817256106*^9, 
   3.667896889397126*^9}, {3.6678969470525312`*^9, 3.667896962588962*^9}, {
   3.66789716539051*^9, 3.6678972171833*^9}, {3.6678972538709784`*^9, 
   3.667897288603929*^9}, {3.6678973528756742`*^9, 3.667897617020197*^9}, {
   3.66789770379532*^9, 3.6678977049618177`*^9}, {3.667897785432526*^9, 
   3.667897791191832*^9}, {3.66789796008405*^9, 3.667897963067811*^9}, {
   3.667898841113009*^9, 3.667898860551585*^9}, {3.6678989176231813`*^9, 
   3.6678990213639717`*^9}, {3.66789905851523*^9, 3.667899062507167*^9}, {
   3.667899103315624*^9, 3.6678991104182777`*^9}, 3.667899192265994*^9, {
   3.667911024706799*^9, 3.6679110624585648`*^9}, {3.668160963954216*^9, 
   3.6681609672208776`*^9}, {3.714831885412652*^9, 3.714831888130403*^9}, {
   3.7352279099898443`*^9, 3.7352279119894543`*^9}, {3.735227947335452*^9, 
   3.735227952021865*^9}, {3.735228057476899*^9, 3.735228177338558*^9}, {
   3.735277231320202*^9, 3.73527723635671*^9}, {3.7352773407782297`*^9, 
   3.735277407971662*^9}, {3.7352774541767883`*^9, 3.735277649510229*^9}, {
   3.735277703312562*^9, 3.7352777560457993`*^9}, {3.735278512054905*^9, 
   3.735278595820527*^9}, {3.735279507096591*^9, 3.7352795099284983`*^9}, {
   3.735279584492257*^9, 3.735279613390669*^9}, {3.735279688701007*^9, 
   3.7352797605695*^9}, {3.735279800130986*^9, 3.735279828575943*^9}, {
   3.7352799393046503`*^9, 3.735279979789836*^9}, {3.7352800171745853`*^9, 
   3.735280017644599*^9}, {3.735280116787613*^9, 3.735280121329863*^9}, 
   3.735280153874682*^9, {3.7352802988160686`*^9, 3.73528036627181*^9}, {
   3.735280397158695*^9, 3.735280436363415*^9}, {3.737970189743887*^9, 
   3.737970195967576*^9}, {3.737970242696484*^9, 3.737970254395742*^9}, {
   3.737970472386147*^9, 3.737970495127303*^9}, {3.7379708325373163`*^9, 
   3.7379708689034348`*^9}, {3.7379710554231977`*^9, 3.737971105241316*^9}, {
   3.7379711965691442`*^9, 3.737971224089724*^9}, {3.737971277422216*^9, 
   3.737971278806017*^9}, {3.73797147720399*^9, 3.7379714890194197`*^9}, {
   3.737971556370063*^9, 3.7379716421431427`*^9}, {3.761467840081215*^9, 
   3.761467847166497*^9}, {3.761467950307549*^9, 3.761467997069125*^9}, {
   3.761468089061266*^9, 3.761468093066968*^9}, {3.7614685229233932`*^9, 
   3.761468692021304*^9}, {3.761468880276452*^9, 3.7614688814416723`*^9}, {
   3.761468924436459*^9, 3.761468927217424*^9}, {3.7614690782651863`*^9, 
   3.761469083567354*^9}, {3.761469125038463*^9, 3.7614691297696247`*^9}, {
   3.761469184509779*^9, 3.7614691937943583`*^9}, {3.7614692263864927`*^9, 
   3.761469287265432*^9}, {3.761469317898486*^9, 3.761469379609047*^9}, {
   3.761469440352092*^9, 3.761469566788692*^9}, {3.761469615179755*^9, 
   3.761469824616735*^9}, {3.761469875905054*^9, 3.7614698793580627`*^9}, {
   3.761469926606781*^9, 3.761470134386421*^9}, 3.761470168834037*^9, {
   3.761470307454604*^9, 3.761470341387541*^9}, {3.761738520583211*^9, 
   3.761738521238221*^9}, {3.7617389428280783`*^9, 3.7617390119443197`*^9}, {
   3.761739059250704*^9, 3.761739062468306*^9}, {3.761739156471512*^9, 
   3.761739184355824*^9}, {3.761739217437358*^9, 3.7617392397403603`*^9}, {
   3.761739369970311*^9, 3.761739392449441*^9}, {3.761739432553824*^9, 
   3.761739594304599*^9}, {3.7617396634565887`*^9, 3.761739667911873*^9}, {
   3.761739705734511*^9, 3.761739706229846*^9}, {3.761739892211649*^9, 
   3.76173996632085*^9}, {3.761740018893314*^9, 3.761740055600648*^9}, {
   3.761740097617803*^9, 3.761740098663492*^9}, {3.761740138440566*^9, 
   3.761740139075246*^9}, {3.7617402198054867`*^9, 3.7617402344591513`*^9}, {
   3.7617403710321302`*^9, 3.7617403816566763`*^9}, {3.761740478719596*^9, 
   3.7617405508147984`*^9}, {3.7617406058510313`*^9, 3.761740610291614*^9}, {
   3.761740666099369*^9, 3.761740668691311*^9}, {3.761740760418543*^9, 
   3.7617407605601063`*^9}, {3.761740812646299*^9, 3.7617410961215143`*^9}, {
   3.7617411807741632`*^9, 3.761741184140841*^9}, {3.761741249469604*^9, 
   3.761741482558055*^9}, {3.761741559233467*^9, 3.761741629349457*^9}, {
   3.76174166546975*^9, 3.761741666811619*^9}, {3.761741704733757*^9, 
   3.7617417062985497`*^9}, {3.761741752883931*^9, 3.761741754314054*^9}, {
   3.761741892775381*^9, 3.76174189691905*^9}, {3.761741945943198*^9, 
   3.761741965597033*^9}, {3.7617421081232862`*^9, 3.761742154770554*^9}, {
   3.7617429859046993`*^9, 3.761743059414176*^9}, {3.7617431003820257`*^9, 
   3.7617431042356787`*^9}, {3.761743383028606*^9, 3.761743387313386*^9}, {
   3.761743436282058*^9, 3.7617434553712807`*^9}, {3.761745904880567*^9, 
   3.761745931925056*^9}, {3.761746102801385*^9, 3.76174617013623*^9}, {
   3.761746219110921*^9, 3.7617462273983088`*^9}, {3.761748487918829*^9, 
   3.7617485580970383`*^9}, {3.761748643450283*^9, 3.761748664558958*^9}, {
   3.761748708704926*^9, 3.761748722277939*^9}, {3.761748917814929*^9, 
   3.76174892680133*^9}, {3.7617490100831623`*^9, 3.7617490188974648`*^9}, {
   3.7617490653139143`*^9, 3.76174909646708*^9}, {3.761749231552435*^9, 
   3.761749242326417*^9}, {3.761752464326742*^9, 3.7617524678119297`*^9}, {
   3.761752716192477*^9, 3.761752727162221*^9}, {3.761753109563594*^9, 
   3.761753202623489*^9}, {3.761754933537197*^9, 3.761754935466028*^9}, {
   3.7617552144596767`*^9, 3.761755219593565*^9}, {3.769493442428174*^9, 
   3.769493468768544*^9}, {3.769493524472045*^9, 3.769493535340535*^9}, {
   3.7694937296498547`*^9, 3.769493767177598*^9}, 3.769493839055397*^9, {
   3.769494086769191*^9, 3.769494119320771*^9}, {3.769494364588728*^9, 
   3.769494381203643*^9}, {3.7694944297055597`*^9, 3.769494449978178*^9}, {
   3.769494581223248*^9, 3.769494647179706*^9}, {3.769494683881651*^9, 
   3.769494687352993*^9}, {3.769494875829777*^9, 3.7694949215906553`*^9}, {
   3.7850721325439863`*^9, 3.78507214532434*^9}, {3.7850721814923277`*^9, 
   3.785072182109561*^9}, {3.785072237157195*^9, 3.7850722438828163`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[41]:=",ExpressionUUID->"f8da019a-2b19-4fc6-ae8c-c8d2c6575467"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateUsage", "[", 
   RowBox[{
   "definitionFile_String", ",", "\"\<Mode:DefinitionsNotebook\>\"", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dir", "=", 
       RowBox[{"DirectoryName", "@", "definitionFile"}]}], ",", 
      RowBox[{"outputFile", "=", 
       RowBox[{"OptionValue", "[", "\"\<WriteTo\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "definedFunctions", ",", 
      "documentationNotebooks", ",", "discrepancy", ",", 
      "\[IndentingNewLine]", "list", ",", "nb"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"outputFile", "===", "\"\<\>\""}], ",", 
       RowBox[{"outputFile", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"dir", ",", "\"\<UsageMessages.txt\>\""}], "}"}], "]"}]}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"definedFunctions", "=", 
      RowBox[{"NotebookImport", "[", 
       RowBox[{"definitionFile", ",", "\"\<Subchapter\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Clear", "@@", "definedFunctions"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"documentationNotebooks", "=", 
      RowBox[{"FileNames", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<MaXrd\>\"", ",", "\"\<Documentation\>\"", ",", 
           "\"\<English\>\"", ",", "\"\<ReferencePages\>\"", ",", 
           "\"\<Symbols\>\"", ",", "\"\<*.nb\>\""}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "@", "dir"}], ",", "dir"}], "}"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"documentationNotebooks", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"CreateUsage", "::", "NoDocPages"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"discrepancy", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"definedFunctions", ",", 
        RowBox[{"FileBaseName", "/@", "documentationNotebooks"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"discrepancy", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Missing documentation pages:\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "@", 
         RowBox[{"Column", "@", "discrepancy"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<----------\>\"", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "@", 
      RowBox[{"Dynamic", "@", 
       RowBox[{"Multicolumn", "[", 
        RowBox[{"list", ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{
         "documentationNotebooks", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"list", ",", 
          RowBox[{"FileBaseName", "@", "nb"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"CreateUsage", "[", 
           RowBox[{"nb", ",", 
            RowBox[{"\"\<WriteTo\>\"", "\[Rule]", "outputFile"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"list", ",", "\"\<(error in previous)\>\""}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "documentationNotebooks"}]}], "}"}]}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.761742403565077*^9, 3.761742445324665*^9}, 
   3.7617424931958303`*^9, {3.761742881084549*^9, 3.7617428932028522`*^9}, {
   3.761743356693429*^9, 3.761743372747541*^9}, {3.7617459401350193`*^9, 
   3.7617459483802*^9}, {3.7617461761933117`*^9, 3.761746203312099*^9}, {
   3.7617470946566963`*^9, 3.7617471380293207`*^9}, {3.761747205045042*^9, 
   3.7617472797806807`*^9}, {3.761747524198599*^9, 3.761747526453486*^9}, {
   3.7617476628828382`*^9, 3.761747673320994*^9}, {3.761747734985824*^9, 
   3.761747739663088*^9}, {3.7617477844964647`*^9, 3.761747786798081*^9}, {
   3.761749317417666*^9, 3.761749320870908*^9}, {3.761749416197526*^9, 
   3.761749430116621*^9}, {3.761749537874487*^9, 3.7617496131992207`*^9}, {
   3.761749716510077*^9, 3.761749724164529*^9}, {3.761749776204854*^9, 
   3.761749803602571*^9}, {3.761749842435093*^9, 3.7617498686584187`*^9}, {
   3.7617499388501463`*^9, 3.7617500147989893`*^9}, {3.761750050135915*^9, 
   3.761750074589971*^9}, {3.761750113694027*^9, 3.761750142547372*^9}, {
   3.761750184483336*^9, 3.7617502265954638`*^9}, {3.761750257625969*^9, 
   3.761750406581653*^9}, {3.761750524877969*^9, 3.761750709703336*^9}, {
   3.761750888014144*^9, 3.761750891236714*^9}, {3.7617510170430803`*^9, 
   3.76175101831343*^9}, {3.761751707219782*^9, 3.761751708177617*^9}, 
   3.761751862384985*^9, {3.761751918238742*^9, 3.761751921846691*^9}, {
   3.7617519982697973`*^9, 3.761752013869145*^9}, {3.761752368628981*^9, 
   3.7617523702676363`*^9}, 3.76175254395362*^9, {3.761752632222827*^9, 
   3.7617526343340797`*^9}, {3.761752693990046*^9, 3.761752699933757*^9}, {
   3.761753305058338*^9, 3.761753307609383*^9}, 3.761753411528614*^9, {
   3.861799166655983*^9, 3.8617991673609753`*^9}, {3.8617991985639772`*^9, 
   3.861799200970048*^9}, {3.861799250135729*^9, 3.861799262780314*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[42]:=",ExpressionUUID->"1e9a0eb6-00ea-41ff-9694-85f58ad2e94a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Execution", "Chapter",
 CellChangeTimes->{{3.861679551550063*^9, 
  3.861679572623868*^9}},ExpressionUUID->"903331fe-ecc2-4e6b-a448-\
ccd1c8eb45e6"],

Cell["\<\
After executing the required definitions above, copy the cell below into the \
definitions notebook and run.\
\>", "Text",
 CellChangeTimes->{{3.836360187976001*^9, 3.83636019651961*^9}, {
  3.861679761638151*^9, 
  3.861679805058837*^9}},ExpressionUUID->"bb76e1ac-7f20-4d26-91fc-\
196ef725b679"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "file", " ", "with", " ", "usage", " ", "messages"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Clearing", " ", "symbols", " ", "causing", " ", "issues"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "$CrystalData", ",", "$LaueClasses", ",", "$PeriodicTable", ",", 
      "$PointGroups", ",", "$SpaceGroups", ",", "$TransformationMatrices", 
      ",", "$MaXrdPath", ",", "$GroupSymbolRedirect", ",", "$MaXrdVersion"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"CreateUsage", "[", 
    RowBox[{
     RowBox[{"NotebookFileName", "[", "]"}], ",", 
     RowBox[{"\"\<DefinitionsNotebook\>\"", "\[Rule]", "True"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"End", "[", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.660662612972769*^9, 3.660662615331635*^9}, {
   3.6678996421176853`*^9, 3.66789969462072*^9}, {3.667899845913467*^9, 
   3.667899850423938*^9}, {3.667899984372815*^9, 3.6678999940522842`*^9}, {
   3.667900034828264*^9, 3.667900089209947*^9}, {3.667900334078722*^9, 
   3.6679003638145247`*^9}, {3.667903245172576*^9, 3.6679032454925957`*^9}, {
   3.667903509806757*^9, 3.6679035140052967`*^9}, {3.675758442867031*^9, 
   3.675758481993051*^9}, {3.6757585443694277`*^9, 3.6757585456885557`*^9}, {
   3.6757585983182087`*^9, 3.675758704140443*^9}, {3.675758754211491*^9, 
   3.675758772678719*^9}, {3.675759204709443*^9, 3.6757592307473087`*^9}, {
   3.675759379117465*^9, 3.6757594378723717`*^9}, {3.675759500854343*^9, 
   3.675759530220367*^9}, {3.675759709648603*^9, 3.675759710360009*^9}, {
   3.675759767239332*^9, 3.675759808110104*^9}, {3.675760218477907*^9, 
   3.6757602205561533`*^9}, {3.675762009516317*^9, 3.675762010034891*^9}, {
   3.675762172552596*^9, 3.675762176643489*^9}, {3.6757694543401737`*^9, 
   3.675769455794608*^9}, {3.67576953993613*^9, 3.6757695580553617`*^9}, {
   3.6757710214550257`*^9, 3.6757710272949677`*^9}, 3.675771150291032*^9, {
   3.675856100530809*^9, 3.675856100753621*^9}, {3.675856527195032*^9, 
   3.675856540089183*^9}, 3.679727001698728*^9, 3.679727049088442*^9, 
   3.679727711425622*^9, {3.6839690810772543`*^9, 3.683969113087332*^9}, {
   3.7177379328989363`*^9, 3.717737933586039*^9}, {3.717738014422647*^9, 
   3.717738015614521*^9}, {3.7177409978788757`*^9, 3.7177410384803667`*^9}, {
   3.7177413378554688`*^9, 3.717741379077037*^9}, {3.7177414825292664`*^9, 
   3.7177415538374147`*^9}, {3.7177420992113*^9, 3.717742100443009*^9}, 
   3.717742370382308*^9, {3.717743709288949*^9, 3.717743727768016*^9}, {
   3.717743977639468*^9, 3.7177440116306677`*^9}, 3.717744050452475*^9, {
   3.7177440818214197`*^9, 3.717744184730303*^9}, {3.717744236083075*^9, 
   3.717744256948084*^9}, {3.717744312128818*^9, 3.717744331826899*^9}, {
   3.717744425895924*^9, 3.717744448975348*^9}, {3.717744506311816*^9, 
   3.717744540670703*^9}, {3.7177446038680487`*^9, 3.7177446062959003`*^9}, 
   3.71774468810388*^9, {3.717744763574163*^9, 3.717744827259562*^9}, {
   3.717744978946293*^9, 3.717744983144945*^9}, {3.7179286885787992`*^9, 
   3.717928693591135*^9}, 3.7190622887730703`*^9, {3.719070068458487*^9, 
   3.719070068912201*^9}, {3.719087441980075*^9, 3.719087442132564*^9}, {
   3.730012522682797*^9, 3.730012523250532*^9}, {3.730108424097702*^9, 
   3.730108427107399*^9}, {3.730116731369512*^9, 3.730116753664315*^9}, {
   3.7301168078184347`*^9, 3.730116814398196*^9}, {3.730120663483899*^9, 
   3.7301206868656397`*^9}, {3.7307227278396273`*^9, 3.730722728041614*^9}, 
   3.735309531237376*^9, 3.73917234479235*^9, 3.743835305126947*^9, 
   3.743865332915565*^9, {3.743865384964581*^9, 3.743865411582386*^9}, 
   3.743865455251375*^9, 3.7438656510644197`*^9, {3.758528935865739*^9, 
   3.758528937654502*^9}, {3.7627520018639727`*^9, 3.7627520050845127`*^9}, {
   3.762752069364541*^9, 3.762752070252963*^9}, {3.7627521516978607`*^9, 
   3.7627521745728493`*^9}, {3.7627523842838*^9, 3.762752391691227*^9}, {
   3.762752446234836*^9, 3.762752457655525*^9}, {3.7627525460106*^9, 
   3.762752546237638*^9}, {3.762752595286416*^9, 3.762752647377551*^9}, {
   3.762752697787332*^9, 3.762752711529207*^9}, 3.78006331583945*^9, 
   3.7850723494601917`*^9, {3.800088548740131*^9, 3.800088551039072*^9}, {
   3.861679595549821*^9, 3.86167960964559*^9}, {3.861679720155517*^9, 
   3.861679736427987*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->"In[43]:=",ExpressionUUID->"19f648e6-3db9-4a0b-a8e4-df365c8a9759"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.861799269496376*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"c04f3988-31d9-424a-9f61-f804b4262dbc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 829},
WindowMargins->{{Automatic, 302}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bbd68505-66db-4011-9974-80a5e5d6744a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 98, "Title",ExpressionUUID->"b3075cdb-58c2-4a7a-9500-fa8b494584d5"],
Cell[CellGroupData[{
Cell[770, 29, 165, 3, 69, "Chapter",ExpressionUUID->"39dc4f88-36f0-465b-b493-119bcd034ac8"],
Cell[CellGroupData[{
Cell[960, 36, 161, 3, 64, "Subchapter",ExpressionUUID->"c50282dc-e3e7-4865-928c-144c262a4df6"],
Cell[1124, 41, 620, 11, 45, "Input",ExpressionUUID->"337f215a-0179-4862-b754-ab39a6aef148",
 InitializationCell->True],
Cell[1747, 54, 3455, 70, 311, "Input",ExpressionUUID->"6c054b12-30d5-40fa-a071-e7c9c11a14af",
 InitializationCell->True],
Cell[5205, 126, 22996, 483, 3012, "Input",ExpressionUUID->"e1bba1d0-5d62-46dd-abe3-be87e4f50e94",
 InitializationCell->True],
Cell[28204, 611, 28931, 598, 2581, "Input",ExpressionUUID->"f8da019a-2b19-4fc6-ae8c-c8d2c6575467",
 InitializationCell->True],
Cell[57138, 1211, 6457, 135, 791, "Input",ExpressionUUID->"1e9a0eb6-00ea-41ff-9694-85f58ad2e94a",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63644, 1352, 154, 3, 69, "Chapter",ExpressionUUID->"903331fe-ecc2-4e6b-a448-ccd1c8eb45e6"],
Cell[63801, 1357, 306, 7, 35, "Text",ExpressionUUID->"bb76e1ac-7f20-4d26-91fc-196ef725b679"],
Cell[CellGroupData[{
Cell[64132, 1368, 4757, 77, 235, "Input",ExpressionUUID->"19f648e6-3db9-4a0b-a8e4-df365c8a9759"],
Cell[68892, 1447, 156, 2, 33, "Output",ExpressionUUID->"c04f3988-31d9-424a-9f61-f804b4262dbc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

