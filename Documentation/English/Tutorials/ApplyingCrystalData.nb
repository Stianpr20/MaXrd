(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    269892,       6498]
NotebookOptionsPosition[    250371,       6073]
NotebookOutlinePosition[    251453,       6100]
CellTagsIndexPosition[    251410,       6097]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "New in: ",
 Cell["0.7", "HistoryData",
  CellTags->"New",ExpressionUUID->"0af9abc9-b72b-4f6b-afcb-0a8a99040cdb"],
 " | Modified in: ",
 Cell[" 4.0.0", "HistoryData",
  CellTags->"Modified",ExpressionUUID->"4f717aa7-a2c0-49c6-848a-73dd8d3daea9"],
 " | Obsolete in: ",
 Cell[" ", "HistoryData",
  CellTags->"Obsolete",ExpressionUUID->"b45e0613-3f5c-421a-86c3-048d0ba6d1cb"],
 " | Excised in: ",
 Cell[" ", "HistoryData",
  CellTags->"Excised",ExpressionUUID->"8dc18a26-fdf5-4759-95b0-9e2dfb293c1d"]
}], "History",
 CellChangeTimes->{{3.861605331848495*^9, 3.861605332852512*^9}, {
  3.891607684533331*^9, 3.891607685281403*^9}},
 CellID->1118682885,ExpressionUUID->"8b73912d-c4c3-44c1-bbde-bd576ea8f82a"],

Cell[CellGroupData[{

Cell["Categorization", "CategorizationSection",
 CellID->483918710],

Cell["Tech Note", "Categorization",
 CellLabel->"Entity Type",
 CellID->701187781],

Cell["StianRamsnes/MaXrd", "Categorization",
 CellLabel->"Paclet Name",
 CellID->1620264178],

Cell["StianRamsnes`MaXrd`", "Categorization",
 CellLabel->"Context",
 CellID->1687395686],

Cell["StianRamsnes/MaXrd/tutorial/ApplyingCrystalData", "Categorization",
 CellLabel->"URI",
 CellID->390252320]
}, Open  ]],

Cell[CellGroupData[{

Cell["Keywords", "KeywordsSection",
 CellID->555684302],

Cell["XXXX", "Keywords",
 CellID->2127166558]
}, Closed]],

Cell[CellGroupData[{

Cell["Applying crystal data", "Title",
 CellChangeTimes->{{3.717250533726925*^9, 3.717250538235927*^9}, {
  3.741686926052162*^9, 3.741686926835835*^9}, {3.7419269143159*^9, 
  3.741926914423265*^9}},
 CellID->509267359],

Cell["\<\
Another tutorial covers the import of crystal data to the format used in this \
package. In this tutorial we will see a few examples on how to make use of \
that information.\
\>", "Text",
 CellChangeTimes->{{3.741682951558329*^9, 3.741683018896802*^9}, {
  3.7419493922639093`*^9, 3.741949398795787*^9}},
 CellID->1534169418],

Cell[CellGroupData[{

Cell["The package must be loaded:", "MathCaption",
 CellChangeTimes->{{3.717256679019158*^9, 3.717256686377759*^9}},
 CellID->1517691727],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<StianRamsnes`MaXrd`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7172566881659927`*^9, 3.7172566912817793`*^9}, 
   3.7438362923305798`*^9, {3.8916074845553017`*^9, 3.8916074913051643`*^9}},
 CellLabel->"In[1]:=",
 CellID->318520214,ExpressionUUID->"8715a4dc-1530-459a-ba2f-6ae06f0af957"]
}, Open  ]],

Cell[TextData[{
 "This package comes with many convenient functions that utilises the stored \
crystal data. They can mainly be divided into two categories: those used to \
",
 StyleBox["extract data",
  FontSlant->"Italic"],
 " and those used for ",
 StyleBox["calculations",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.7416830258798*^9, 3.741683077748829*^9}, {
  3.741683129413954*^9, 3.7416831944718018`*^9}},
 CellID->1633598486],

Cell[BoxData[GridBox[{
   {
    RowBox[{
     ButtonBox["GetAtomicScatteringFactors",
      BaseStyle->"Link",
      ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetAtomicScatteringFactors"],
      "\[Dagger]"}], Cell[TextData[{
     "returns ",
     Cell[BoxData[
      FormBox[
       RowBox[{"f", "+", 
        SuperscriptBox["f", "\[Prime]"], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["f", "\[DoublePrime]"]}]}], TraditionalForm]], 
      "InlineMath"],
     " for each elements of the crystal"
    }], "TableText"]},
   {
    ButtonBox["GetCrystalMetric",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetCrystalMetric"], Cell[
    TextData[{
     "return the metric ",
     Cell[BoxData[
      FormBox[
       StyleBox["G",
        FontWeight->"Bold",
        FontSlant->"Plain"], TraditionalForm]], "InlineMath"],
     " associated with the crystal lattice"
    }], "TableText"]},
   {
    ButtonBox["GetLatticeParameters",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetLatticeParameters"], Cell[
    "return the lattice parameters associated with the crystal", "TableText"]},
   {
    ButtonBox["GetLaueClass",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetLaueClass"], Cell[
    "returns the corresponding Laue class of the group/crystal", "TableText"]},
   {
    RowBox[{
     ButtonBox["GetScatteringCrossSection",
      BaseStyle->"Link",
      ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetScatteringCrossSection"], 
     "\[Dagger]"}], Cell[
    "returns \[Sigma] for given elements and wavelength", "TableText"]},
   {
    ButtonBox["GetSymmetryData",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetSymmetryData"], Cell[
    "extract space group information easily", "TableText"]},
   {
    ButtonBox["GetSymmetryOperations",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetSymmetryOperations"], 
    Cell["\<\
returns alle the symmetry operations for a point- or space group\
\>", "TableText"]},
   {
    ButtonBox["ImportCrystalData",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/ImportCrystalData"], Cell[
    TextData[{
     "import crystallographic information from ",
     StyleBox["cif", "InlineCode"],
     " files"
    }], "TableText"]}
  }]], "DefinitionBox",
 CellChangeTimes->{{3.741683498081563*^9, 3.7416836292442636`*^9}, {
  3.7416839767268867`*^9, 3.741683999338195*^9}, {3.741684396093956*^9, 
  3.741684397406231*^9}, {3.741684458804386*^9, 3.741684511966689*^9}, {
  3.741684674783176*^9, 3.741684679891959*^9}, {3.741684865824459*^9, 
  3.7416848951268883`*^9}, {3.741684991286228*^9, 3.741685101137896*^9}, {
  3.741685664057983*^9, 3.741685711421968*^9}, {3.744172596092811*^9, 
  3.744172610769163*^9}, {3.753068145989634*^9, 3.75306814603948*^9}},
 CellID->876862730],

Cell[TextData[{
 "Functions that are mainly used for easy extraction of data.\[LineSeparator]\
\[Dagger] denotes functions that use data files located ",
 StyleBox["$MaXrdPath", "MenuName"],
 StyleBox[" \[FilledRightTriangle] ", "MenuNameDelimiter"],
 StyleBox["Core", "MenuName"],
 StyleBox[" \[FilledRightTriangle] ", "MenuNameDelimiter"],
 StyleBox["Data", "MenuName"],
 "."
}], "Caption",
 CellChangeTimes->{{3.741684731615623*^9, 3.741684809508841*^9}, {
  3.7416858470962057`*^9, 3.741685867416664*^9}, {3.743836320488542*^9, 
  3.743836321942642*^9}},
 CellID->1399117396],

Cell[BoxData[GridBox[{
   {
    ButtonBox["AttenuationCoefficient",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/AttenuationCoefficient"], 
    Cell["calulate the \[Mu] abosrption factor", "TableText"]},
   {
    ButtonBox["BraggAngle",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/BraggAngle"], Cell[TextData[{
     "calculate the Bragg angle, given ",
     Cell[BoxData[
      StyleBox["\[Lambda]", "TR"]], "InlineFormula"],
     " and ",
     Cell[BoxData[
      StyleBox["hkl", "TI"]], "InlineFormula"]
    }], "TableText"]},
   {
    ButtonBox["CrystalDensity",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/CrystalDensity"], Cell[
    "calculate theoretical value for the density", "TableText"]},
   {
    RowBox[{
     ButtonBox["DarwinWidth",
      BaseStyle->"Link",
      ButtonData->"paclet:StianRamsnes/MaXrd/ref/DarwinWidth"], 
     "\[DoubleDagger]"}], Cell[TextData[{
     "calculate the Darwin width of a given ",
     Cell[BoxData[
      StyleBox["hkl", "TI"]], "InlineFormula"]
    }], "TableText"]},
   {
    RowBox[{
     ButtonBox["ExtinctionLength",
      BaseStyle->"Link",
      ButtonData->"paclet:StianRamsnes/MaXrd/ref/ExtinctionLength"], 
     "\[DoubleDagger]"}], Cell[TextData[{
     "calculate the extinction (Pendell\[ODoubleDot]sung) distance of a given \
",
     Cell[BoxData[
      StyleBox["hkl", "TI"]], "InlineFormula"]
    }], "TableText"]},
   {
    ButtonBox["ReciprocalSpaceSimulation",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation"], 
    Cell["\<\
simulate the reflections (nodes) of a plane in reciprocal space\
\>", "TableText"]},
   {
    ButtonBox["StructureFactor",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/StructureFactor"], Cell[
    TextData[{
     "calculate the structure factor ",
     Cell[BoxData[
      FormBox[
       RowBox[{"F", "(", 
        StyleBox["hkl", "TI"], ")"}], TraditionalForm]], "InlineMath"]
    }], "TableText"]},
   {
    ButtonBox["UnitCellTransformation",
     BaseStyle->"Link",
     ButtonData->"paclet:StianRamsnes/MaXrd/ref/UnitCellTransformation"], 
    Cell["transform among alternative unit cell representations", "TableText"]}
  }]], "DefinitionBox",
 TaggingRules->{"Alphabetized" -> True},
 CellChangeTimes->{{3.7172594324428453`*^9, 3.71725962303757*^9}, {
  3.717259773276157*^9, 3.717259874847485*^9}, {3.717265173174582*^9, 
  3.717265251931423*^9}, {3.717265294030575*^9, 3.71726536072274*^9}, {
  3.717265615632807*^9, 3.7172656785891743`*^9}, {3.717265763912489*^9, 
  3.717265771395105*^9}, {3.717265863268549*^9, 3.717265991656619*^9}, {
  3.74168231492481*^9, 3.7416823900659113`*^9}, {3.741686003295663*^9, 
  3.7416860033461447`*^9}, {3.74168607058036*^9, 3.741686141349132*^9}, {
  3.741687386898687*^9, 3.741687427857946*^9}},
 CellID->2096742444],

Cell[TextData[{
 "Functions in the package which can operate on data in ",
 Cell[BoxData[
  ButtonBox["$CrystalData",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/$CrystalData"]], 
  "InlineFormula"],
 ", ",
 Cell[BoxData[
  ButtonBox["$PointGroups",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/$PointGroups"]], 
  "InlineFormula"],
 " or ",
 Cell[BoxData[
  ButtonBox["$SpaceGroups",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/$SpaceGroups"]], 
  "InlineFormula"],
 " directly to perform calculations.\[LineSeparator]\[DoubleDagger] denotes \
functions related to dynamical diffraction theory."
}], "Caption",
 CellChangeTimes->{{3.717266002398198*^9, 3.7172660351577787`*^9}, {
  3.7416834723788347`*^9, 3.7416834877074633`*^9}, {3.7416844106397953`*^9, 
  3.741684410775202*^9}, {3.741685880751412*^9, 3.741685888527068*^9}, {
  3.7416860468365917`*^9, 3.741686065516513*^9}},
 CellID->1891092685],

Cell[CellGroupData[{

Cell["2D simulation of reciprocal space", "Section",
 CellChangeTimes->{{3.71725929413299*^9, 3.7172592980915813`*^9}, {
  3.741688052662314*^9, 3.741688061948189*^9}},
 CellID->1321285995],

Cell[CellGroupData[{

Cell[TextData[{
 "With the metric information of a crystal contained in ",
 Cell[BoxData[
  ButtonBox["$CrystalData",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/$CrystalData"]], 
  "InlineFormula"],
 " and the function for generating appropriate reflections, ",
 Cell[BoxData[
  ButtonBox["ReflectionList",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/ReflectionList"]], 
  "InlineFormula"],
 ", one can relatively easily create a function that simulates a section of \
reciprocal space. ",
 Cell[BoxData[
  ButtonBox["ReciprocalSpaceSimulation",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation"]], 
  "InlineFormula"],
 " is a simple function that does this. We can use ",
 Cell[BoxData[
  ButtonBox["RelatedFunctionsGraph",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/RelatedFunctionsGraph"]], 
  "InlineFormula"],
 " to check which other package components it is made of:"
}], "Text",
 CellChangeTimes->{{3.741949312447055*^9, 3.741949371894429*^9}, {
  3.7419500037368507`*^9, 3.7419501579021397`*^9}, {3.743137359726203*^9, 
  3.74313736724327*^9}},
 CellID->297183504],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RelatedFunctionsGraph", "[", "ReciprocalSpaceSimulation", 
  "]"}]], "Input",
 CellChangeTimes->{{3.741931383959687*^9, 3.741931398742392*^9}, {
  3.741948903714299*^9, 3.741948909936994*^9}, {3.7428307210896587`*^9, 
  3.742830722109847*^9}},
 CellLabel->"In[2]:=",
 CellID->1956406672],

Cell[BoxData[
 GraphicsBox[{
   {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{1.2850220292346635`, 1.318068765062711}, {1.9275330438519953`,
       1.464717711372911}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.6425110146173317, 1.1714198187525109`}, {
      1.2850220292346635`, 1.318068765062711}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.6425110146173317, 1.1714198187525109`}, {
      1.9275330438519953`, 1.464717711372911}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{2.315529685818448, 0.4962663318975755}, {1.9275330438519953`, 
      1.464717711372911}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{2.570044058469327, 1.611366657683111}, {1.9275330438519953`, 
      1.464717711372911}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{1.856910633434135, 2.5056076881388014`}, {1.9275330438519953`,
       1.464717711372911}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.7131334250351923, 2.5056076881388014`}, {0.6425110146173317,
       1.1714198187525109`}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0., 1.6113666576831114`}, {0.6425110146173317, 
      1.1714198187525109`}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.25451437265087873`, 0.49626633189757596`}, {
      0.6425110146173317, 1.1714198187525109`}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{1.2850220292346632`, 0.}, {0.6425110146173317, 
      1.1714198187525109`}}]}}, 
   {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{0.9650220292346634, 1.268068765062711}, \
{1.6050220292346635, 1.368068765062711}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"GetCrystalMetric\"", 
          "paclet:StianRamsnes/MaXrd/ref/GetCrystalMetric"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {1.2850220292346635, 1.318068765062711}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{1.4275330438519953, 1.414717711372911}, \
{2.4275330438519953, 1.5147177113729111}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"ReciprocalSpaceSimulation\"", 
          "paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {1.9275330438519953, 1.464717711372911}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{0.4425110146173317, 1.1214198187525108}, \
{0.8425110146173318, 1.221419818752511}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"InputCheck\"", "paclet:StianRamsnes/MaXrd/ref/InputCheck"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0.6425110146173317, 1.1714198187525109}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{1.875529685818448, 0.44626633189757553}, \
{2.755529685818448, 0.5462663318975756}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"MillerNotationToString\"", 
          "paclet:StianRamsnes/MaXrd/ref/MillerNotationToString"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {2.315529685818448, 0.4962663318975755}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{2.290044058469327, 1.561366657683111}, \
{2.8500440584693267, 1.661366657683111}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"ReflectionList\"", "paclet:StianRamsnes/MaXrd/ref/ReflectionList"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {2.570044058469327, 1.611366657683111}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{1.556910633434135, 2.4556076881388016}, \
{2.156910633434135, 2.5556076881388012}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"StructureFactor\"", 
          "paclet:StianRamsnes/MaXrd/ref/StructureFactor"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {1.856910633434135, 2.5056076881388014}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{0.3331334250351923, 2.4556076881388016}, \
{1.0931334250351923, 2.5556076881388012}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"CrystalFormulaUnits\"", 
          "paclet:StianRamsnes/MaXrd/ref/CrystalFormulaUnits"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0.7131334250351923, 2.5056076881388014}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{-0.4, 1.5613666576831113}, {0.4, 1.6613666576831114}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"MillerNotationToList\"", 
          "paclet:StianRamsnes/MaXrd/ref/MillerNotationToList"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0., 1.6113666576831114}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{-0.12548562734912128, 0.446266331897576}, \
{0.6345143726508787, 0.546266331897576}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"SynthesiseStructure\"", 
          "paclet:StianRamsnes/MaXrd/ref/SynthesiseStructure"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0.25451437265087873, 0.49626633189757596}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{0.9450220292346632, -0.05}, {1.6250220292346633, 0.05}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"ToStandardSetting\"", 
          "paclet:StianRamsnes/MaXrd/ref/ToStandardSetting"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {1.2850220292346632, 0.}]}}}},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->Large]], "Output",
 CellChangeTimes->{{3.742830719416337*^9, 3.742830727178566*^9}, 
   3.861605417844241*^9},
 CellLabel->"Out[2]=",
 CellID->970581802]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The essential inputs are the crystal label \[Dash] which contains the lattice \
specification \[Dash] and the orientation details of the plane in reciprocal \
space. Information on the function syntax:\
\>", "Text",
 CellChangeTimes->{{3.741950205696612*^9, 3.741950253776775*^9}, {
  3.741950350658119*^9, 3.741950374662506*^9}, {3.7419516514108686`*^9, 
  3.741951721114897*^9}},
 CellID->680229519],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "ReciprocalSpaceSimulation"}]], "Input",
 CellChangeTimes->{{3.741951722344103*^9, 3.741951725711521*^9}},
 CellLabel->"In[3]:=",
 CellID->1878533656],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              
              ButtonData->
               "paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation",
              
              ButtonNote->
               "paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation"],
             "\"paclet:MaXrd/ref/ReciprocalSpaceSimulation\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"ReciprocalSpaceSimulation\\\", \
\\\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"L\\\", \
\\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\"]]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"origin\\\", \\\"TI\\\"], \\\",\\\", \
SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"min\\\", \
\\\"TI\\\"]], \\\"]\\\"}]\\)\\!\\(\\*RowBox[{\\\" plots a simulation of the \
reciprocal space of \\\", Cell[BoxData[StyleBox[\\\"crystal\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\", with \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]]], \\\"InlineFormula\\\"], \\\" and \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]], \\\"InlineFormula\\\"], \\\" defining the \
layer plane centred at \\\", Cell[BoxData[StyleBox[\\\"origin\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\" and \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"min\\\
\", \\\"TI\\\"]]], \\\"InlineFormula\\\"], \\\" the \
resolution.\\\"}]\\)\\n\\!\\(\\*RowBox[{\\\"ReciprocalSpaceSimulation\\\", \\\
\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"\
\[Lambda]\\\", \\\"TR\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"origin\\\", \\\"TI\\\"], \\\",\\\", \
SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"min\\\", \
\\\"TI\\\"]], \\\"]\\\"}]\\) \\!\\(\\*RowBox[{\\\"plots a simulation of the \
reciprocal space of \\\", Cell[BoxData[StyleBox[\\\"crystal\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\" at wavelength \\\", \
Cell[BoxData[StyleBox[\\\"\[Lambda]\\\", \\\"TR\\\"]], \
\\\"InlineFormula\\\"], \\\", with \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]]], \\\"InlineFormula\\\"], \\\" and \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]], \\\"InlineFormula\\\"], \\\" defining the \
layer plane centred at \\\", Cell[BoxData[StyleBox[\\\"origin\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\" and \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"min\\\
\", \\\"TI\\\"]]], \\\"InlineFormula\\\"], \\\" the resolution.\\\"}]\\)\"\>",
              "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"ReciprocalSpaceSimulation", "[", 
                    RowBox[{"MaXrd`Private`crystal_", ",", 
                    RowBox[{"MaXrd`Private`lambda", ":", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#1", "]"}], "||", 
                    RowBox[{"QuantityQ", "[", "#1", "]"}]}], "&"}], ")"}]}], 
                    ":", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`L1_List", ",", 
                    "MaXrd`Private`L2_List"}], "}"}], ",", 
                    "MaXrd`Private`origin_List", ",", 
                    RowBox[{"MaXrd`Private`res_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#1", "]"}], "&&", 
                    RowBox[{"Positive", "[", "#1", "]"}]}], "&"}], ")"}]}], 
                    ",", 
                    RowBox[{"MaXrd`Private`options", ":", 
                    RowBox[{"OptionsPattern", "[", 
                    RowBox[{"{", 
                    RowBox[{"ReciprocalSpaceSimulation", ",", "Graphics"}], 
                    "}"}], "]"}]}]}], "]"}], ":=", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`\[Lambda]", ",", 
                    "MaXrd`Private`check", ",", "MaXrd`Private`G", ",", 
                    "MaXrd`Private`Ginv", ",", "MaXrd`Private`B", ",", 
                    "MaXrd`Private`CrystalDot", ",", 
                    "MaXrd`Private`CrystalCross", ",", "MaXrd`Private`Hx", 
                    ",", "MaXrd`Private`Hy", ",", "MaXrd`Private`Hz", ",", 
                    "MaXrd`Private`HCx", ",", "MaXrd`Private`HCy", ",", 
                    "MaXrd`Private`HCz", ",", "MaXrd`Private`U", ",", 
                    "MaXrd`Private`UB", ",", "MaXrd`Private`o", ",", 
                    "MaXrd`Private`ref", ",", "MaXrd`Private`refz", ",", 
                    "MaXrd`Private`flip", ",", "MaXrd`Private`condition", ",",
                     "MaXrd`Private`pindex", ",", 
                    "MaXrd`Private`structureFactors", ",", 
                    "MaXrd`Private`hkl2sf", ",", 
                    RowBox[{"MaXrd`Private`\[Delta]", "=", 
                    
                    RowBox[{"OptionValue", "[", 
                    "\"StructureFactorThreshold\"", "]"}]}], ",", 
                    "MaXrd`Private`hkl", ",", "MaXrd`Private`xy", ",", 
                    "MaXrd`Private`pair", ",", "MaXrd`Private`data", ",", 
                    "MaXrd`Private`\[Chi]"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`\[Lambda]", "=", 
                    RowBox[{"InputCheck", "[", 
                    
                    RowBox[{"\"ProcessWavelength\"", ",", 
                    "MaXrd`Private`crystal", ",", "MaXrd`Private`lambda"}], 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`check", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`L1", ",", "MaXrd`Private`L2", ",", 
                    "MaXrd`Private`origin"}], "}"}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "MaXrd`Private`check", "]"}], 
                    "\[NotEqual]", "9"}], "||", 
                    RowBox[{"!", 
                    RowBox[{"AllTrue", "[", 
                    RowBox[{"MaXrd`Private`check", ",", "NumericQ"}], 
                    "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"ReciprocalSpaceSimulation", "::", "invalid"}], 
                    "MessageName"], "]"}], ";", 
                    RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Det", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`L1", ".", "MaXrd`Private`L1"}], 
                    ",", 
                    RowBox[{"MaXrd`Private`L1", ".", "MaXrd`Private`L2"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`L2", ".", "MaXrd`Private`L1"}], 
                    ",", 
                    RowBox[{"MaXrd`Private`L2", ".", "MaXrd`Private`L2"}]}], 
                    "}"}]}], "}"}], "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"ReciprocalSpaceSimulation", "::", "dep"}], 
                    "MessageName"], "]"}], ";", 
                    RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"MaXrd`Private`G", "=", 
                    
                    RowBox[{"GetCrystalMetric", "[", "MaXrd`Private`crystal", 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`Ginv", "=", 
                    RowBox[{"Inverse", "[", "MaXrd`Private`G", "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`B", "=", 
                    RowBox[{"CholeskyDecomposition", "[", 
                    RowBox[{"Inverse", "[", "MaXrd`Private`G", "]"}], "]"}]}],
                     ";", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`CrystalDot", "[", 
                    RowBox[{"MaXrd`Private`u_", ",", "MaXrd`Private`v_"}], 
                    "]"}], ":=", 
                    RowBox[{"Return", "[", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", "MaXrd`Private`i", "3"], 
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", "MaXrd`Private`j", "3"], 
                    RowBox[{
                    RowBox[{"MaXrd`Private`Ginv", "\[LeftDoubleBracket]", 
                    RowBox[{"MaXrd`Private`i", ",", "MaXrd`Private`j"}], 
                    "\[RightDoubleBracket]"}], " ", 
                    
                    RowBox[{"MaXrd`Private`u", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`i", "\[RightDoubleBracket]"}], " ", 
                    
                    RowBox[{"MaXrd`Private`v", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}]}]}], ")"}]}],
                     "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`CrystalCross", "[", 
                    RowBox[{"MaXrd`Private`u_", ",", "MaXrd`Private`v_"}], 
                    "]"}], ":=", 
                    RowBox[{"Return", "[", 
                    RowBox[{
                    SqrtBox[
                    RowBox[{"Det", "[", "MaXrd`Private`Ginv", "]"}]], " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", "MaXrd`Private`i", "3"], 
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", "MaXrd`Private`j", "3"], 
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", "MaXrd`Private`k", "3"], 
                    RowBox[{
                    RowBox[{"Signature", "[", 
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`i", ",", "MaXrd`Private`j", ",", 
                    "MaXrd`Private`k"}], "}"}], "]"}], " ", 
                    RowBox[{"MaXrd`Private`G", "\[LeftDoubleBracket]", 
                    RowBox[{"MaXrd`Private`i", ",", "MaXrd`Private`t"}], 
                    "\[RightDoubleBracket]"}], " ", 
                    
                    RowBox[{"MaXrd`Private`u", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], " ", 
                    
                    RowBox[{"MaXrd`Private`v", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`k", "\[RightDoubleBracket]"}]}]}], ")"}]}],
                     ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"MaXrd`Private`t", ",", "3"}], "}"}]}], "]"}]}], 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`Hx", "=", "MaXrd`Private`L1"}], 
                    ";", 
                    RowBox[{"MaXrd`Private`Hy", "=", 
                    RowBox[{"MaXrd`Private`L2", "-", 
                    FractionBox[
                    RowBox[{"MaXrd`Private`Hx", " ", 
                    RowBox[{"MaXrd`Private`CrystalDot", "[", 
                    RowBox[{"MaXrd`Private`Hx", ",", "MaXrd`Private`L2"}], 
                    "]"}]}], 
                    RowBox[{"MaXrd`Private`CrystalDot", "[", 
                    RowBox[{"MaXrd`Private`Hx", ",", "MaXrd`Private`Hx"}], 
                    "]"}]]}]}], ";", 
                    RowBox[{"MaXrd`Private`Hz", "=", 
                    RowBox[{"MaXrd`Private`CrystalCross", "[", 
                    RowBox[{"MaXrd`Private`Hx", ",", "MaXrd`Private`Hy"}], 
                    "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`HCx", ",", "MaXrd`Private`HCy", 
                    ",", "MaXrd`Private`HCz"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Normalize", "[", 
                    RowBox[{"MaXrd`Private`B", ".", "#1"}], "]"}], "&"}], 
                    ")"}], "/@", 
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`Hx", ",", "MaXrd`Private`Hy", ",", 
                    "MaXrd`Private`Hz"}], "}"}]}]}], ";", 
                    RowBox[{"MaXrd`Private`U", "=", 
                    RowBox[{
                    RowBox[{"IdentityMatrix", "[", "3", "]"}], ".", 
                    RowBox[{"Inverse", "[", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`HCx", ",", "MaXrd`Private`HCy", 
                    ",", "MaXrd`Private`HCz"}], "}"}], "]"}], "]"}]}]}], ";", 
                    
                    RowBox[{"MaXrd`Private`UB", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"MaXrd`Private`U", ".", "MaXrd`Private`B"}], 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`o", "=", "MaXrd`Private`origin"}], 
                    ";", 
                    RowBox[{"MaXrd`Private`ref", "=", 
                    RowBox[{"MaXrd`Private`UB", ".", "MaXrd`Private`o"}]}], 
                    ";", 
                    RowBox[{"MaXrd`Private`refz", "=", 
                    
                    RowBox[{"MaXrd`Private`ref", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", "MaXrd`Private`origin", "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`o", "=", 
                    RowBox[{"MaXrd`Private`L1", "+", "MaXrd`Private`L2"}]}], 
                    ";", 
                    RowBox[{"MaXrd`Private`flip", "=", "True"}]}], ",", 
                    RowBox[{"MaXrd`Private`flip", "=", "False"}]}], "]"}], 
                    ";", 
                    RowBox[{"MaXrd`Private`condition", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`h_", ",", "MaXrd`Private`k_", ",", 
                    "MaXrd`Private`l_"}], "}"}], "/;", 
                    RowBox[{"MaXrd`Private`h", "\[Equal]", "#1"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`h_", ",", "MaXrd`Private`k_", ",", 
                    "MaXrd`Private`l_"}], "}"}], "/;", 
                    RowBox[{"MaXrd`Private`k", "\[Equal]", "#2"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`h_", ",", "MaXrd`Private`k_", ",", 
                    "MaXrd`Private`l_"}], "}"}], "/;", 
                    RowBox[{"MaXrd`Private`l", "\[Equal]", "#3"}]}]}], "}"}], 
                    "&"}], ")"}], "@@", "MaXrd`Private`o"}]}], ";", 
                    RowBox[{"MaXrd`Private`condition", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"MaXrd`Private`condition", ",", 
                    RowBox[{"MaXrd`Private`c_", "/;", 
                    RowBox[{"If", "[", 
                    RowBox[{"MaXrd`Private`flip", ",", 
                    RowBox[{"!", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`c", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`c", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", "0"}]}], "]"}]}]}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`pindex", "=", 
                    RowBox[{"MaXrd`Private`condition", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"MaXrd`Private`pindex", "=", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    
                    RowBox[{"MaXrd`Private`pindex", "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], "]"}], "\[Rule]", 
                    
                    RowBox[{"MaXrd`Private`pindex", "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}]}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "MaXrd`Private`condition", "]"}], 
                    ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`condition", "=", 
                    RowBox[{"MaXrd`Private`condition", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"MaXrd`Private`condition", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`h_", ",", "MaXrd`Private`k_", ",", 
                    "MaXrd`Private`l_"}], "}"}], "/;", "#1"}], "&"}], ")"}], 
                    "[", 
                    RowBox[{"And", "@@", "MaXrd`Private`condition"}], 
                    "]"}]}]}], ",", 
                    RowBox[{"MaXrd`Private`condition", "=", 
                    
                    RowBox[{"First", "[", "MaXrd`Private`condition", 
                    "]"}]}]}], "]"}], ";", 
                    RowBox[{"Label", "[", "\"Building\"", "]"}], ";", 
                    RowBox[{"MaXrd`Private`hkl", "=", 
                    RowBox[{"ReflectionList", "[", 
                    
                    RowBox[{"MaXrd`Private`crystal", ",", 
                    "MaXrd`Private`\[Lambda]", ",", "MaXrd`Private`condition",
                     ",", 
                    
                    RowBox[{"\"HoldIndex\"", "\[Rule]", 
                    "MaXrd`Private`pindex"}], ",", 
                    RowBox[{"\"SplitEquivalent\"", "\[Rule]", "True"}], ",", 
                    RowBox[{"\"ShowProgress\"", "\[Rule]", "False"}]}], 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`hkl", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"MaXrd`Private`hkl", ",", 
                    RowBox[{
                    RowBox[{
                    SqrtBox[
                    RowBox[{"MaXrd`Private`CrystalDot", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]], "<", 
                    FractionBox["1", 
                    RowBox[{"1.01`", " ", "MaXrd`Private`res"}]]}], "&"}]}], 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`structureFactors", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"TrueQ", "[", 
                    
                    RowBox[{"OptionValue", "[", "\"IgnoreStructureFactors\"", 
                    "]"}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"100.`", ",", 
                    RowBox[{"Length", "[", "MaXrd`Private`hkl", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StructureFactor", "[", 
                    
                    RowBox[{"MaXrd`Private`crystal", ",", "MaXrd`Private`hkl",
                     ",", "MaXrd`Private`\[Lambda]"}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    StyleBox[
                    RowBox[{"StructureFactor", "::", "ElementMismatch"}], 
                    "MessageName"], "}"}]}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`hkl2sf", "=", 
                    RowBox[{"AssociationThread", "[", 
                    
                    RowBox[{"MaXrd`Private`hkl", "\[Rule]", 
                    "MaXrd`Private`structureFactors"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`hkl2sf", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"MaXrd`Private`hkl2sf", ",", 
                    RowBox[{
                    RowBox[{"#1", ">", "MaXrd`Private`\[Delta]"}], "&"}]}], 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`hkl", "=", 
                    RowBox[{"Keys", "[", "MaXrd`Private`hkl2sf", "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`xy", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MaXrd`Private`UB", ".", "#1"}], "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "MaXrd`Private`refz"}], 
                    "}"}]}], "&"}], ")"}], "/@", "MaXrd`Private`hkl"}], ")"}],
                     "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"MaXrd`Private`pair", "=", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"Chop", "[", "MaXrd`Private`xy", "]"}], "]"}], 
                    ",", "MaXrd`Private`hkl"}], "}"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`data", "=", 
                    RowBox[{"Association", "[", 
                    RowBox[{
                    RowBox[{"\"Coordinates\"", "\[Rule]", 
                    RowBox[{"N", "[", 
                    RowBox[{"Chop", "[", "MaXrd`Private`xy", "]"}], "]"}]}], 
                    ",", 
                    
                    RowBox[{"\"MillerIndices\"", "\[Rule]", 
                    "MaXrd`Private`hkl"}], ",", 
                    RowBox[{"\"StructureFactor\"", "\[Rule]", 
                    RowBox[{"Lookup", "[", 
                    
                    RowBox[{"MaXrd`Private`hkl2sf", ",", 
                    "MaXrd`Private`hkl"}], "]"}]}]}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"TrueQ", "[", 
                    RowBox[{"OptionValue", "[", "\"ReturnData\"", "]"}], 
                    "]"}], ",", 
                    RowBox[{"Return", "[", "MaXrd`Private`data", "]"}]}], 
                    "]"}], ";", 
                    
                    RowBox[{"MaXrd`Private`RenderReciprocalSpaceSimulation", 
                    "[", 
                    
                    RowBox[{"MaXrd`Private`data", ",", 
                    "MaXrd`Private`options"}], "]"}]}]}], "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", 
                    "paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation",
                     "paclet:StianRamsnes/MaXrd/ref/\
ReciprocalSpaceSimulation", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    
                    StyleBox["\<\" Default Definitions\"\>", 
                    "InformationRowLabel",
                    StripOnInput->False],
                    "\"DefaultValues\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "DefaultValues", "Tooltip"]& ], 
                   InterpretationBox[GridBox[{
                    {
                    RowBox[{
                    RowBox[{
                    "SyntaxInformation", "[", "ReciprocalSpaceSimulation", 
                    "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"\<\"ArgumentsPattern\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_.", ",", "_", ",", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "_", ",", 
                    RowBox[{"OptionsPattern", "[", 
                    RowBox[{"{", 
                    RowBox[{"ReciprocalSpaceSimulation", ",", "Graphics"}], 
                    "}"}], "]"}]}], "}"}]}], "}"}]}]},
                    {" "}
                    },
                    BaselinePosition->{Baseline, {1, 1}},
                    
                    GridBoxAlignment->{
                    "Columns" -> {{Left}}, "Rows" -> {{Baseline}}}],
                    
                    ColumnForm[{
                    SyntaxInformation[MaXrd`ReciprocalSpaceSimulation] = {
                    "ArgumentsPattern" -> {
                    Blank[], 
                    Optional[
                    Blank[]], 
                    Blank[], {
                    Blank[], 
                    Blank[], 
                    Blank[]}, 
                    Blank[], 
                    
                    OptionsPattern[{
                    MaXrd`ReciprocalSpaceSimulation, Graphics}]}}, 
                    SpaceForm[1]}],
                    Editable->False]},
                  {
                   PaneSelectorBox[{True->
                    ButtonBox[
                    PaneSelectorBox[{False->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "DownPointerOpener"]]},
                    "RowWithSeparators"], True->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "DownPointerOpenerHot"]]},
                    "RowWithSeparators"]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    FrameMargins->0,
                    ImageSize->Automatic],
                    Appearance->None,
                    BaseStyle->None,
                    
                    ButtonFunction:>(Part[System`InformationDump`open$$, 3] = 
                    False),
                    Evaluator->Automatic,
                    FrameMargins->0,
                    ImageMargins->0,
                    Method->"Preemptive"], False->
                    ButtonBox[
                    PaneSelectorBox[{False->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "RightPointerOpener"]]},
                    "RowWithSeparators"], True->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "RightPointerOpenerHot"]]},
                    "RowWithSeparators"]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    FrameMargins->0,
                    ImageSize->Automatic],
                    Appearance->None,
                    BaseStyle->None,
                    
                    ButtonFunction:>(Part[System`InformationDump`open$$, 3] = 
                    True),
                    Evaluator->Automatic,
                    FrameMargins->0,
                    ImageMargins->0,
                    Method->"Preemptive"]}, Dynamic[
                    FEPrivate`Part[System`InformationDump`open$$, 3]]], 
                   PaneSelectorBox[{True->GridBox[{
                    {
                    RowBox[{"AlignmentPoint", "\[Rule]", "Center"}]},
                    {
                    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"Axes", "\[Rule]", "False"}]},
                    {
                    RowBox[{"AxesLabel", "\[Rule]", "None"}]},
                    {
                    RowBox[{"AxesOrigin", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"AxesStyle", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"Background", "\[Rule]", "None"}]},
                    {
                    RowBox[{"BaselinePosition", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"BaseStyle", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"ColorOutput", "\[Rule]", "\<\"SolarColors\"\>"}]},
                    {
                    RowBox[{"ContentSelectable", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{
                    "CoordinatesToolOptions", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{
                    "DisplayFunction", "\[RuleDelayed]", "$DisplayFunction"}]},
                    {
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{
                    "FormatType", "\[RuleDelayed]", "TraditionalForm"}]},
                    {
                    RowBox[{"Frame", "\[Rule]", "False"}]},
                    {
                    RowBox[{"FrameLabel", "\[Rule]", "None"}]},
                    {
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"FrameTicks", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"FrameTicksStyle", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"GridLines", "\[Rule]", "None"}]},
                    {
                    RowBox[{"GridLinesStyle", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    
                    RowBox[{"\<\"IgnoreStructureFactors\"\>", "\[Rule]", 
                    "False"}]},
                    {
                    RowBox[{"ImageMargins", "\[Rule]", "0.`"}]},
                    {
                    RowBox[{"ImagePadding", "\[Rule]", "All"}]},
                    {
                    RowBox[{"ImageSize", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"ImageSizeRaw", "\[Rule]", "Automatic"}]},
                    {
                    
                    RowBox[{"\<\"IntensityScaling\"\>", "\[Rule]", 
                    "0.0025`"}]},
                    {
                    RowBox[{"LabelStyle", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"Method", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"PlotLabel", "\[Rule]", "None"}]},
                    {
                    RowBox[{"PlotRange", "\[Rule]", "All"}]},
                    {
                    RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]},
                    {
                    RowBox[{"PlotRangePadding", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"PlotRegion", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{
                    "PreserveImageOptions", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"Prolog", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"\<\"ReturnData\"\>", "\[Rule]", "False"}]},
                    {
                    RowBox[{"RotateLabel", "\[Rule]", "True"}]},
                    {
                    
                    RowBox[{"\<\"StructureFactorThreshold\"\>", "\[Rule]", 
                    "1"}]},
                    {
                    RowBox[{"Ticks", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"TicksStyle", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[InvisibleSpace]\"", "42", "\" total)\""},
                    "RowDefault"], "InformationRowOpener",
                    StripOnInput->False]}
                    },
                    BaselinePosition->{Baseline, {1, 1}},
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{1.}}}], False->
                    RowBox[{
                    RowBox[{"AlignmentPoint", "\[Rule]", "Center"}], 
                    "\[ThinSpace]", 
                    StyleBox["\<\"\[Ellipsis]\"\>", "InformationRowOpener",
                    StripOnInput->False], "\[ThinSpace]", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[InvisibleSpace]\"", "42", "\" total)\""},
                    "RowDefault"], "InformationRowOpener",
                    StripOnInput->False]}]}, Dynamic[
                    FEPrivate`Part[System`InformationDump`open$$, 3]],
                    BaselinePosition->Baseline,
                    ImageSize->Automatic]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"MaXrd`ReciprocalSpaceSimulation\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{13., {4., 9.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{13., {4., 9.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              
              ButtonData->
               "paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation",
              
              ButtonNote->
               "paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation"],
             "\"paclet:MaXrd/ref/ReciprocalSpaceSimulation\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"ReciprocalSpaceSimulation\\\", \
\\\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"L\\\", \
\\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\"]]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"origin\\\", \\\"TI\\\"], \\\",\\\", \
SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"min\\\", \
\\\"TI\\\"]], \\\"]\\\"}]\\)\\!\\(\\*RowBox[{\\\" plots a simulation of the \
reciprocal space of \\\", Cell[BoxData[StyleBox[\\\"crystal\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\", with \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]]], \\\"InlineFormula\\\"], \\\" and \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]], \\\"InlineFormula\\\"], \\\" defining the \
layer plane centred at \\\", Cell[BoxData[StyleBox[\\\"origin\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\" and \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"min\\\
\", \\\"TI\\\"]]], \\\"InlineFormula\\\"], \\\" the \
resolution.\\\"}]\\)\\n\\!\\(\\*RowBox[{\\\"ReciprocalSpaceSimulation\\\", \\\
\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"\
\[Lambda]\\\", \\\"TR\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]}], \\\"}\\\"}], \\\",\\\", \
StyleBox[\\\"origin\\\", \\\"TI\\\"], \\\",\\\", \
SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"min\\\", \
\\\"TI\\\"]], \\\"]\\\"}]\\) \\!\\(\\*RowBox[{\\\"plots a simulation of the \
reciprocal space of \\\", Cell[BoxData[StyleBox[\\\"crystal\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\" at wavelength \\\", \
Cell[BoxData[StyleBox[\\\"\[Lambda]\\\", \\\"TR\\\"]], \
\\\"InlineFormula\\\"], \\\", with \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]]], \\\"InlineFormula\\\"], \\\" and \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"L\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]], \\\"InlineFormula\\\"], \\\" defining the \
layer plane centred at \\\", Cell[BoxData[StyleBox[\\\"origin\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\" and \\\", \
Cell[BoxData[SubscriptBox[StyleBox[\\\"d\\\", \\\"TI\\\"], StyleBox[\\\"min\\\
\", \\\"TI\\\"]]], \\\"InlineFormula\\\"], \\\" the resolution.\\\"}]\\)\"\>",
              "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {2., 8.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {2., 8.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"ReciprocalSpaceSimulation\", \"[\", \
StyleBox[\"crystal\", \"TI\"], \",\", RowBox[{\"{\", \
RowBox[{SubscriptBox[StyleBox[\"L\", \"TI\"], StyleBox[\"1\", \"TR\"]], \
\",\", SubscriptBox[StyleBox[\"L\", \"TI\"], StyleBox[\"2\", \"TR\"]]}], \
\"}\"}], \",\", StyleBox[\"origin\", \"TI\"], \",\", \
SubscriptBox[StyleBox[\"d\", \"TI\"], StyleBox[\"min\", \"TI\"]], \"]\"}]\)\!\
\(\*RowBox[{\" plots a simulation of the reciprocal space of \", \
Cell[BoxData[StyleBox[\"crystal\", \"TI\"]], \"InlineFormula\"], \", with \", \
Cell[BoxData[SubscriptBox[StyleBox[\"L\", \"TI\"], StyleBox[\"1\", \"TR\"]]], \
\"InlineFormula\"], \" and \", Cell[BoxData[SubscriptBox[StyleBox[\"L\", \"TI\
\"], StyleBox[\"2\", \"TR\"]]], \"InlineFormula\"], \" defining the layer \
plane centred at \", Cell[BoxData[StyleBox[\"origin\", \"TI\"]], \
\"InlineFormula\"], \" and \", Cell[BoxData[SubscriptBox[StyleBox[\"d\", \"TI\
\"], StyleBox[\"min\", \"TI\"]]], \"InlineFormula\"], \" the \
resolution.\"}]\)\n\!\(\*RowBox[{\"ReciprocalSpaceSimulation\", \"[\", \
StyleBox[\"crystal\", \"TI\"], \",\", StyleBox[\"\[Lambda]\", \"TR\"], \",\", \
RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"L\", \"TI\"], StyleBox[\"1\", \
\"TR\"]], \",\", SubscriptBox[StyleBox[\"L\", \"TI\"], StyleBox[\"2\", \
\"TR\"]]}], \"}\"}], \",\", StyleBox[\"origin\", \"TI\"], \",\", \
SubscriptBox[StyleBox[\"d\", \"TI\"], StyleBox[\"min\", \"TI\"]], \"]\"}]\) \
\!\(\*RowBox[{\"plots a simulation of the reciprocal space of \", \
Cell[BoxData[StyleBox[\"crystal\", \"TI\"]], \"InlineFormula\"], \" at \
wavelength \", Cell[BoxData[StyleBox[\"\[Lambda]\", \"TR\"]], \"InlineFormula\
\"], \", with \", Cell[BoxData[SubscriptBox[StyleBox[\"L\", \"TI\"], \
StyleBox[\"1\", \"TR\"]]], \"InlineFormula\"], \" and \", \
Cell[BoxData[SubscriptBox[StyleBox[\"L\", \"TI\"], StyleBox[\"2\", \"TR\"]]], \
\"InlineFormula\"], \" defining the layer plane centred at \", \
Cell[BoxData[StyleBox[\"origin\", \"TI\"]], \"InlineFormula\"], \" and \", \
Cell[BoxData[SubscriptBox[StyleBox[\"d\", \"TI\"], StyleBox[\"min\", \
\"TI\"]]], \"InlineFormula\"], \" the resolution.\"}]\)", 
    "Documentation" -> <|
     "Local" -> "paclet:StianRamsnes/MaXrd/ref/ReciprocalSpaceSimulation"|>, 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> 
    Information`InformationValueForm[
     DownValues, MaXrd`ReciprocalSpaceSimulation, {
      MaXrd`ReciprocalSpaceSimulation[
         Pattern[MaXrd`Private`crystal, 
          Blank[]], 
         Optional[
          Pattern[MaXrd`Private`lambda, 
           PatternTest[
            Blank[], Or[
             NumericQ[#], 
             QuantityQ[#]]& ]], -1], {
          Pattern[MaXrd`Private`L1, 
           Blank[List]], 
          Pattern[MaXrd`Private`L2, 
           Blank[List]]}, 
         Pattern[MaXrd`Private`origin, 
          Blank[List]], 
         PatternTest[
          Pattern[MaXrd`Private`res, 
           Blank[]], And[
           NumericQ[#], 
           Positive[#]]& ], 
         Pattern[MaXrd`Private`options, 
          OptionsPattern[{MaXrd`ReciprocalSpaceSimulation, Graphics}]]] :> 
       Block[{MaXrd`Private`\[Lambda], MaXrd`Private`check, MaXrd`Private`G, 
          MaXrd`Private`Ginv, MaXrd`Private`B, MaXrd`Private`CrystalDot, 
          MaXrd`Private`CrystalCross, MaXrd`Private`Hx, MaXrd`Private`Hy, 
          MaXrd`Private`Hz, MaXrd`Private`HCx, MaXrd`Private`HCy, 
          MaXrd`Private`HCz, MaXrd`Private`U, MaXrd`Private`UB, 
          MaXrd`Private`o, MaXrd`Private`ref, MaXrd`Private`refz, 
          MaXrd`Private`flip, MaXrd`Private`condition, MaXrd`Private`pindex, 
          MaXrd`Private`structureFactors, MaXrd`Private`hkl2sf, 
          MaXrd`Private`\[Delta] = OptionValue["StructureFactorThreshold"], 
          MaXrd`Private`hkl, MaXrd`Private`xy, MaXrd`Private`pair, 
          MaXrd`Private`data, MaXrd`Private`\[Chi]}, 
         MaXrd`Private`\[Lambda] = 
          MaXrd`InputCheck[
           "ProcessWavelength", MaXrd`Private`crystal, MaXrd`Private`lambda]; 
         MaXrd`Private`check = 
          Flatten[{MaXrd`Private`L1, MaXrd`Private`L2, MaXrd`Private`origin}]; 
         If[
           Or[Length[MaXrd`Private`check] != 9, 
            Not[
             AllTrue[MaXrd`Private`check, NumericQ]]], Message[
             MessageName[MaXrd`ReciprocalSpaceSimulation, "invalid"]]; 
           Abort[]]; If[Det[{{
               Dot[MaXrd`Private`L1, MaXrd`Private`L1], 
               Dot[MaXrd`Private`L1, MaXrd`Private`L2]}, {
               Dot[MaXrd`Private`L2, MaXrd`Private`L1], 
               Dot[MaXrd`Private`L2, MaXrd`Private`L2]}}] == 0, Message[
             MessageName[MaXrd`ReciprocalSpaceSimulation, "dep"]]; Abort[]]; 
         MaXrd`Private`G = MaXrd`GetCrystalMetric[MaXrd`Private`crystal]; 
         MaXrd`Private`Ginv = Inverse[MaXrd`Private`G]; 
         MaXrd`Private`B = CholeskyDecomposition[
            Inverse[MaXrd`Private`G]]; MaXrd`Private`CrystalDot[
            Pattern[MaXrd`Private`u, 
             Blank[]], 
            Pattern[MaXrd`Private`v, 
             Blank[]]] := Return[
            Sum[
             Sum[
             Part[MaXrd`Private`Ginv, MaXrd`Private`i, MaXrd`Private`j] 
              Part[MaXrd`Private`u, MaXrd`Private`i] 
              Part[MaXrd`Private`v, MaXrd`Private`j], {MaXrd`Private`j, 3}], {
             MaXrd`Private`i, 3}]]; MaXrd`Private`CrystalCross[
            Pattern[MaXrd`Private`u, 
             Blank[]], 
            Pattern[MaXrd`Private`v, 
             Blank[]]] := Return[Sqrt[
              Det[MaXrd`Private`Ginv]] Table[
              Sum[
               Sum[
                Sum[
                Signature[{MaXrd`Private`i, MaXrd`Private`j, MaXrd`Private`k}]
                   Part[MaXrd`Private`G, MaXrd`Private`i, MaXrd`Private`t] 
                 Part[MaXrd`Private`u, MaXrd`Private`j] 
                 Part[MaXrd`Private`v, MaXrd`Private`k], {
                 MaXrd`Private`k, 3}], {MaXrd`Private`j, 3}], {
               MaXrd`Private`i, 3}], {MaXrd`Private`t, 3}]]; 
         MaXrd`Private`Hx = MaXrd`Private`L1; 
         MaXrd`Private`Hy = 
          MaXrd`Private`L2 - 
           MaXrd`Private`Hx (
            MaXrd`Private`CrystalDot[MaXrd`Private`Hx, MaXrd`Private`L2]/
            MaXrd`Private`CrystalDot[MaXrd`Private`Hx, MaXrd`Private`Hx]); 
         MaXrd`Private`Hz = 
          MaXrd`Private`CrystalCross[MaXrd`Private`Hx, MaXrd`Private`Hy]; {
           MaXrd`Private`HCx, MaXrd`Private`HCy, MaXrd`Private`HCz} = 
          Map[Normalize[
             Dot[MaXrd`Private`B, #]]& , {
            MaXrd`Private`Hx, MaXrd`Private`Hy, MaXrd`Private`Hz}]; 
         MaXrd`Private`U = Dot[
            IdentityMatrix[3], 
            Inverse[
             
             Transpose[{
              MaXrd`Private`HCx, MaXrd`Private`HCy, MaXrd`Private`HCz}]]]; 
         MaXrd`Private`UB = Chop[
            Dot[MaXrd`Private`U, MaXrd`Private`B]]; 
         MaXrd`Private`o = MaXrd`Private`origin; 
         MaXrd`Private`ref = Dot[MaXrd`Private`UB, MaXrd`Private`o]; 
         MaXrd`Private`refz = Part[MaXrd`Private`ref, 3]; 
         If[Chop[MaXrd`Private`origin] == {0, 0, 0}, 
           MaXrd`Private`o = MaXrd`Private`L1 + MaXrd`Private`L2; 
           MaXrd`Private`flip = True, MaXrd`Private`flip = False]; 
         MaXrd`Private`condition = Apply[{
             Condition[{
               Pattern[MaXrd`Private`h, 
                Blank[]], 
               Pattern[MaXrd`Private`k, 
                Blank[]], 
               Pattern[MaXrd`Private`l, 
                Blank[]]}, MaXrd`Private`h == #], 
             Condition[{
               Pattern[MaXrd`Private`h, 
                Blank[]], 
               Pattern[MaXrd`Private`k, 
                Blank[]], 
               Pattern[MaXrd`Private`l, 
                Blank[]]}, MaXrd`Private`k == #2], 
             Condition[{
               Pattern[MaXrd`Private`h, 
                Blank[]], 
               Pattern[MaXrd`Private`k, 
                Blank[]], 
               Pattern[MaXrd`Private`l, 
                Blank[]]}, MaXrd`Private`l == #3]}& , MaXrd`Private`o]; 
         MaXrd`Private`condition = DeleteCases[MaXrd`Private`condition, 
            Condition[
             Pattern[MaXrd`Private`c, 
              Blank[]], 
             If[MaXrd`Private`flip, 
              Not[Part[MaXrd`Private`c, 2, 2] == 0], 
              Part[MaXrd`Private`c, 2, 2] == 0]]]; 
         MaXrd`Private`pindex = Part[MaXrd`Private`condition, 1, 2]; 
         MaXrd`Private`pindex = ToString[
             Part[MaXrd`Private`pindex, 1]] -> Part[MaXrd`Private`pindex, 2]; 
         If[Length[MaXrd`Private`condition] > 1, 
           MaXrd`Private`condition = Part[MaXrd`Private`condition, All, 2]; 
           MaXrd`Private`condition = (Condition[{
               Pattern[MaXrd`Private`h, 
                Blank[]], 
               Pattern[MaXrd`Private`k, 
                Blank[]], 
               Pattern[MaXrd`Private`l, 
                Blank[]]}, #]& )[
              Apply[And, MaXrd`Private`condition]], MaXrd`Private`condition = 
           First[MaXrd`Private`condition]]; Label["Building"]; 
         MaXrd`Private`hkl = 
          MaXrd`ReflectionList[
           MaXrd`Private`crystal, MaXrd`Private`\[Lambda], 
            MaXrd`Private`condition, "HoldIndex" -> MaXrd`Private`pindex, 
            "SplitEquivalent" -> True, "ShowProgress" -> False]; 
         MaXrd`Private`hkl = Select[MaXrd`Private`hkl, Sqrt[
              MaXrd`Private`CrystalDot[#, #]] < 1/(1.01 MaXrd`Private`res)& ]; 
         MaXrd`Private`structureFactors = If[
            TrueQ[
             OptionValue["IgnoreStructureFactors"]], 
            ConstantArray[100., 
             Length[MaXrd`Private`hkl]], 
            Quiet[
             Part[
              MaXrd`StructureFactor[
              MaXrd`Private`crystal, MaXrd`Private`hkl, 
               MaXrd`Private`\[Lambda]], All, 1], {
              MessageName[MaXrd`StructureFactor, "ElementMismatch"]}]]; 
         MaXrd`Private`hkl2sf = 
          AssociationThread[
           MaXrd`Private`hkl -> MaXrd`Private`structureFactors]; 
         MaXrd`Private`hkl2sf = 
          Select[MaXrd`Private`hkl2sf, # > MaXrd`Private`\[Delta]& ]; 
         MaXrd`Private`hkl = Keys[MaXrd`Private`hkl2sf]; 
         MaXrd`Private`xy = Part[
            Map[
            Dot[MaXrd`Private`UB, #] - {0, 0, MaXrd`Private`refz}& , 
             MaXrd`Private`hkl], All, {1, 2}]; MaXrd`Private`pair = Transpose[{
             N[
              Chop[MaXrd`Private`xy]], MaXrd`Private`hkl}]; 
         MaXrd`Private`data = <|"Coordinates" -> N[
              Chop[MaXrd`Private`xy]], "MillerIndices" -> MaXrd`Private`hkl, 
            "StructureFactor" -> 
            Lookup[MaXrd`Private`hkl2sf, MaXrd`Private`hkl]|>; If[
           TrueQ[
            OptionValue["ReturnData"]], 
           Return[MaXrd`Private`data]]; 
         MaXrd`Private`RenderReciprocalSpaceSimulation[
          MaXrd`Private`data, MaXrd`Private`options]]}], "SubValues" -> None, 
    "DefaultValues" -> 
    Information`InformationValueForm[
     DefaultValues, MaXrd`ReciprocalSpaceSimulation, {
      SyntaxInformation[MaXrd`ReciprocalSpaceSimulation] -> {
        "ArgumentsPattern" -> {
           Blank[], 
           Optional[
            Blank[]], 
           Blank[], {
            Blank[], 
            Blank[], 
            Blank[]}, 
           Blank[], 
           OptionsPattern[{MaXrd`ReciprocalSpaceSimulation, Graphics}]}}}], 
    "NValues" -> None, "FormatValues" -> None, 
    "Options" -> {
     AlignmentPoint -> Center, AspectRatio -> Automatic, Axes -> False, 
      AxesLabel -> None, AxesOrigin -> Automatic, AxesStyle -> {}, Background -> 
      None, BaselinePosition -> Automatic, BaseStyle -> {}, ColorOutput -> 
      "SolarColors", ContentSelectable -> Automatic, CoordinatesToolOptions -> 
      Automatic, DisplayFunction :> $DisplayFunction, Epilog -> {}, 
      FormatType :> TraditionalForm, Frame -> False, FrameLabel -> None, 
      FrameStyle -> {}, FrameTicks -> Automatic, FrameTicksStyle -> {}, 
      GridLines -> None, GridLinesStyle -> {}, "IgnoreStructureFactors" -> 
      False, ImageMargins -> 0., ImagePadding -> All, ImageSize -> Automatic, 
      ImageSizeRaw -> Automatic, "IntensityScaling" -> 0.0025, 
      LabelStyle -> {}, Method -> Automatic, PlotLabel -> None, PlotRange -> 
      All, PlotRangeClipping -> False, PlotRangePadding -> Automatic, 
      PlotRegion -> Automatic, PreserveImageOptions -> Automatic, 
      Prolog -> {}, "ReturnData" -> False, RotateLabel -> True, 
      "StructureFactorThreshold" -> 1, Ticks -> Automatic, TicksStyle -> {}}, 
    "Attributes" -> {}, "FullName" -> "MaXrd`ReciprocalSpaceSimulation"|>, 
   False]]], "Output",
 CellChangeTimes->{3.861605421009465*^9},
 CellLabel->"Out[3]=",
 CellID->1354571897]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
From this we see that the function also requires an origin for the plane, a \
resolution and wavelength (if not contained along with crystal data). Let us \
look at some examples:\
\>", "Text",
 CellChangeTimes->{{3.741951767496464*^9, 3.7419518615437107`*^9}},
 CellID->1526046967],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ReciprocalSpaceSimulation", "[", "\[IndentingNewLine]", 
  RowBox[{
  "\"\<LithiumManganesePhosphate\>\"", ",", "1.54059", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", "1.12"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", 
    RowBox[{"(", "h2l", ")"}], " ", "plane"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.741951862685005*^9, 3.7419519827335978`*^9}, {
  3.741952036583241*^9, 3.7419521036193867`*^9}, {3.741952181718774*^9, 
  3.7419522201143713`*^9}},
 CellLabel->"In[4]:=",
 CellID->418026381],

Cell[BoxData[
 GraphicsBox[{
   TagBox[
    TooltipBox[
     {RGBColor[0.9332658303912068, 0.3130657485138073, 0.025255133640500485`],
       DiskBox[{0., 0.}, 0.026886862734317073]},
     "\"(020)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(020)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.6325879730424329, 0.056668960813814194`, 0.010321205021475944`], 
      DiskBox[{0., 0.33123550844650546}, 0.017298261482205236]},
     "\"(022)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(022)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.7182524605631508, 0.0862975039894821, 0.0074443577165393595`], 
      DiskBox[{0.21226915729144555, 0.16561775422325273}, 
       0.02033206191066058]},
     "\"(121)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(121)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9913448916044129, 0.5688846281010759, 0.06637355591489766], 
      DiskBox[{0.4245383145828911, 0.}, 0.030039196862583648]},
     "\"(220)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(220)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.6325879730424329, 0.05666896081381417, 0.010321205021475946`], 
      DiskBox[{0., -0.33123550844650546}, 0.017298261482205236]},
     "\"(02\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(02\!\(\*OverscriptBox[\(2\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.7182524605631512, 0.08629750398948223, 0.007444357716539347],
       DiskBox[{0.21226915729144555, -0.16561775422325273}, 
       0.020332061910660594]},
     "\"(12\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(12\!\(\*OverscriptBox[\(1\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.991344891604413, 0.5688846281010765, 0.06637355591489776], 
      DiskBox[{-0.4245383145828911, 0.}, 0.03003919686258365]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)20)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(2\), \(_\)]\)20)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.7182524605631511, 0.0862975039894822, 0.007444357716539351], 
      DiskBox[{-0.21226915729144555, 0.16561775422325273}, 
       0.020332061910660587]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)21)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(1\), \(_\)]\)21)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.7182524605631508, 0.08629750398948212, 0.007444357716539358],
       DiskBox[{-0.21226915729144555, -0.16561775422325273}, 
       0.020332061910660584]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \
\\(_\\)]\\)2\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(1\), \(_\)]\)2\!\(\*OverscriptBox[\(1\), \
\(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8381064585631965, 0.1496610006562687, 0.007017959820502712], 
      DiskBox[{0., 0.6624710168930109}, 0.023583096083745893]},
     "\"(024)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(024)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8279678516001937, 0.13225129646643374`, 0.005074908558971599], 
      DiskBox[{0.21226915729144555, 0.49685326266975816}, 
       0.023122226279909803]},
     "\"(123)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(123)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.8201269999999996, 0.1269549999999999], 
      DiskBox[{0.4245383145828911, 0.33123550844650546}, 
       0.032842805249457235]},
     "\"(222)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(222)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9207664467024269, 0.2916021911068582, 0.022859642491324723`],
       DiskBox[{0.6368074718743366, 0.16561775422325273}, 
       0.026530017313333966]},
     "\"(321)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(321)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.7749435891259931, 0.10590511034906354`, 0.005540514885746932], 
      DiskBox[{0.8490766291657822, 0.}, 0.021808969257072645]},
     "\"(420)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(420)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8381064585631965, 0.1496610006562687, 0.007017959820502712], 
      DiskBox[{0., -0.6624710168930109}, 0.023583096083745893]},
     "\"(02\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(02\!\(\*OverscriptBox[\(4\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8279678516001936, 0.1322512964664337, 0.0050749085589715925`], 
      DiskBox[{0.21226915729144555, -0.49685326266975816}, 
       0.023122226279909803]},
     "\"(12\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(12\!\(\*OverscriptBox[\(3\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.8201269999999997, 0.12695499999999993`], 
      DiskBox[{0.4245383145828911, -0.33123550844650546}, 
       0.032842805249457235]},
     "\"(22\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(22\!\(\*OverscriptBox[\(2\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9207664467024269, 0.2916021911068582, 0.022859642491324723`],
       DiskBox[{0.6368074718743366, -0.16561775422325273}, 
       0.026530017313333966]},
     "\"(32\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(32\!\(\*OverscriptBox[\(1\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.7749435891259929, 0.10590511034906346`, 0.005540514885746939], 
      DiskBox[{-0.8490766291657822, 0.}, 0.02180896925707264]},
     "\"(\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\)20)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(4\), \(_\)]\)20)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9207664467024269, 0.2916021911068582, 0.022859642491324723`],
       DiskBox[{-0.6368074718743366, 0.16561775422325273}, 
       0.026530017313333966]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)21)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(3\), \(_\)]\)21)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.820127, 0.126955], 
      DiskBox[{-0.4245383145828911, 0.33123550844650546}, 
       0.032842805249457235]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)22)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(2\), \(_\)]\)22)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8279678516001935, 0.13225129646643335`, 0.005074908558971555], 
      DiskBox[{-0.21226915729144555, 0.49685326266975816}, 
       0.02312222627990979]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)23)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(1\), \(_\)]\)23)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.9207664467024268, 0.29160219110685814`, 0.022859642491324716`], 
      DiskBox[{-0.6368074718743366, -0.16561775422325273}, 
       0.026530017313333966]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \
\\(_\\)]\\)2\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(3\), \(_\)]\)2\!\(\*OverscriptBox[\(1\), \
\(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.820127, 0.126955], 
      DiskBox[{-0.4245383145828911, -0.33123550844650546}, 
       0.032842805249457235]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \
\\(_\\)]\\)2\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(2\), \(_\)]\)2\!\(\*OverscriptBox[\(2\), \
\(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8279678516001935, 0.13225129646643335`, 0.005074908558971555], 
      DiskBox[{-0.21226915729144555, -0.49685326266975816}, 
       0.023122226279909796]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \
\\(_\\)]\\)2\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(1\), \(_\)]\)2\!\(\*OverscriptBox[\(3\), \
\(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.5457934544855058, 0.026649576878863507`, 0.013236001852932801`], 
      DiskBox[{0.21226915729144555, 0.8280887711162637}, 
       0.011856030884204683]},
     "\"(125)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(125)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.9594167766303417, 0.35797134944784037`, 0.030266929567259016`], 
      DiskBox[{0.4245383145828911, 0.6624710168930109}, 0.027580805858831645]},
     "\"(224)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(224)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8673664643639813, 0.1999053830890244, 0.012625603098429257`],
       DiskBox[{0.6368074718743366, 0.49685326266975816}, 
       0.02476858946152253]},
     "\"(323)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(323)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.5457934544855056, 0.026649576878863483`, 0.013236001852932803`], 
      DiskBox[{0.21226915729144555, -0.8280887711162637}, 
       0.011856030884204677]},
     "\"(12\\!\\(\\*OverscriptBox[\\(5\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(12\!\(\*OverscriptBox[\(5\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9594167766303416, 0.35797134944784026`, 0.030266929567259], 
      DiskBox[{0.4245383145828911, -0.6624710168930109}, 
       0.027580805858831645]},
     "\"(22\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(22\!\(\*OverscriptBox[\(4\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8673664643639817, 0.19990538308902503`, 0.012625603098429326`], 
      DiskBox[{0.6368074718743366, -0.49685326266975816}, 
       0.024768589461522543]},
     "\"(32\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(32\!\(\*OverscriptBox[\(3\), \(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8673664643639818, 0.1999053830890252, 0.012625603098429345`],
       DiskBox[{-0.6368074718743366, 0.49685326266975816}, 
       0.02476858946152255]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)23)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(3\), \(_\)]\)23)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.9594167766303417, 0.35797134944784037`, 0.030266929567259016`], 
      DiskBox[{-0.4245383145828911, 0.6624710168930109}, 
       0.027580805858831645]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)24)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(2\), \(_\)]\)24)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.5457934544855059, 0.026649576878863566`, 0.013236001852932795`], 
      DiskBox[{-0.21226915729144555, 0.8280887711162637}, 0.0118560308842047]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)25)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(1\), \(_\)]\)25)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8673664643639817, 0.19990538308902503`, 0.012625603098429326`], 
      DiskBox[{-0.6368074718743366, -0.49685326266975816}, 
       0.024768589461522543]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \
\\(_\\)]\\)2\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(3\), \(_\)]\)2\!\(\*OverscriptBox[\(3\), \
\(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.9594167766303417, 0.35797134944784037`, 0.030266929567259016`], 
      DiskBox[{-0.4245383145828911, -0.6624710168930109}, 
       0.027580805858831645]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \
\\(_\\)]\\)2\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(2\), \(_\)]\)2\!\(\*OverscriptBox[\(4\), \
\(_\)]\))", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.5457934544855052, 0.026649576878863306`, 0.01323600185293282], 
      DiskBox[{-0.21226915729144555, -0.8280887711162637}, 
       0.01185603088420463]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \
\\(_\\)]\\)2\\!\\(\\*OverscriptBox[\\(5\\), \\(_\\)]\\))\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(1\), \(_\)]\)2\!\(\*OverscriptBox[\(5\), \
\(_\)]\))", "Tooltip"]& ]},
  ImageSize->Large]], "Output",
 CellChangeTimes->{{3.7419520485298023`*^9, 3.741952086307652*^9}, {
   3.741952182769775*^9, 3.741952206778768*^9}, 3.7419530414243317`*^9, 
   3.861605427747356*^9},
 CellLabel->"Out[4]=",
 CellID->946721241]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The image above shows the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"h", " ", "2", " ", "l"}], ")"}], TraditionalForm]], "InlineMath"],
 " plane of an orthorhombic structure.\[LineSeparator]Below is an example of \
a hexagonal structure:"
}], "Text",
 CellChangeTimes->{{3.7419521198472013`*^9, 3.741952163745243*^9}, {
  3.741952213194107*^9, 3.741952214448514*^9}, {3.741952273018118*^9, 
  3.741952289158908*^9}},
 CellID->568725332],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ReciprocalSpaceSimulation", "[", "\[IndentingNewLine]", 
  RowBox[{"\"\<Zinc\>\"", ",", "0.709317", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "0.60"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", 
    RowBox[{"(", "hk0", ")"}], " ", "plane"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.741951862685005*^9, 3.7419519827335978`*^9}, {
  3.741952036583241*^9, 3.7419521036193867`*^9}, {3.741952181718774*^9, 
  3.7419522201143713`*^9}, {3.7419522964894667`*^9, 3.741952314606563*^9}, {
  3.741952347584786*^9, 3.7419523876530533`*^9}},
 CellLabel->"In[5]:=",
 CellID->250507665],

Cell[BoxData[
 GraphicsBox[{
   TagBox[
    TooltipBox[
     {RGBColor[0.9876786360779324, 0.5358254685033732, 0.06052907810009052], 
      DiskBox[{0.21665801155419775, 0.3752626838787151}, 
       0.022927052969624384]},
     "\"(010)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(010)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9876786360779324, 0.5358254685033732, 0.06052907810009052], 
      DiskBox[{0.43331602310839534, 0.}, 0.022927052969624384]},
     "\"(100)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(100)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9876786360779324, 0.5358254685033732, 0.06052907810009052], 
      DiskBox[{-0.21665801155419775, -0.3752626838787151}, 
       0.022927052969624384]},
     "\"(0\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(0\!\(\*OverscriptBox[\(1\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9876786360779324, 0.5358254685033732, 0.06052907810009052], 
      DiskBox[{-0.43331602310839534, 0.}, 0.022927052969624384]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)00)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(1\), \(_\)]\)00)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9414530468068959, 0.3271245848465938, 0.026824203360135926`],
       DiskBox[{0.4333160231083955, 0.7505253677574302}, 0.02033144363336555]},
     "\"(020)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(020)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.820127, 0.126955], 
      DiskBox[{0.6499740346625931, 0.3752626838787151}, 0.026062866822957324]},
     "\"(110)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(110)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9414530468068959, 0.3271245848465938, 0.026824203360135926`],
       DiskBox[{0.8666320462167907, 0.}, 0.02033144363336555]},
     "\"(200)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(200)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9414530468068959, 0.3271245848465938, 0.026824203360135926`],
       DiskBox[{-0.4333160231083955, -0.7505253677574302}, 
       0.02033144363336555]},
     "\"(0\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(0\!\(\*OverscriptBox[\(2\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9876786360779324, 0.5358254685033734, 0.06052907810009056], 
      DiskBox[{0.2166580115541976, -0.3752626838787151}, 
       0.022927052969624384]},
     "\"(1\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(1\!\(\*OverscriptBox[\(1\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9414530468068959, 0.3271245848465938, 0.026824203360135926`],
       DiskBox[{-0.8666320462167907, 0.}, 0.02033144363336555]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)00)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(2\), \(_\)]\)00)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9876786360779324, 0.5358254685033734, 0.06052907810009056], 
      DiskBox[{-0.2166580115541976, 0.3752626838787151}, 
       0.022927052969624384]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)10)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(1\), \(_\)]\)10)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.820127, 0.126955], 
      DiskBox[{-0.6499740346625931, -0.3752626838787151}, 
       0.026062866822957324]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \
\\(_\\)]\\)\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(1\), \(_\)]\)\!\(\*OverscriptBox[\(1\), \
\(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9854714584546745, 0.5159230266848117, 0.05701055612056763], 
      DiskBox[{0.6499740346625933, 1.1257880516361451}, 0.022719420409665552]},
     "\"(030)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(030)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{0.8666320462167909, 0.7505253677574302}, 0.018601479410086833]},
     "\"(120)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(120)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{1.0832900577709885, 0.3752626838787151}, 0.018601479410086833]},
     "\"(210)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(210)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9854714584546745, 0.5159230266848117, 0.05701055612056763], 
      DiskBox[{1.2999480693251861, 0.}, 0.022719420409665552]},
     "\"(300)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(300)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9854714584546745, 0.5159230266848117, 0.05701055612056763], 
      DiskBox[{-0.6499740346625933, -1.1257880516361451}, 
       0.022719420409665552]},
     "\"(0\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(0\!\(\*OverscriptBox[\(3\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.8201269999999998, 0.12695499999999998`], 
      DiskBox[{0., -0.7505253677574302}, 0.026062866822957324]},
     "\"(1\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(1\!\(\*OverscriptBox[\(2\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.8201269999999998, 0.12695499999999998`], 
      DiskBox[{0.649974034662593, -0.3752626838787151}, 0.026062866822957324]},
     "\"(2\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(2\!\(\*OverscriptBox[\(1\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9854714584546745, 0.5159230266848117, 0.05701055612056763], 
      DiskBox[{-1.2999480693251861, 0.}, 0.022719420409665552]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)00)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(3\), \(_\)]\)00)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.8201269999999998, 0.12695499999999998`], 
      DiskBox[{-0.649974034662593, 0.3752626838787151}, 0.026062866822957324]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)10)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(2\), \(_\)]\)10)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[1., 0.8201269999999998, 0.12695499999999998`], 
      DiskBox[{0., 0.7505253677574302}, 0.026062866822957324]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)20)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(1\), \(_\)]\)20)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{-1.0832900577709885, -0.3752626838787151}, 
       0.018601479410086833]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \
\\(_\\)]\\)\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(2\), \(_\)]\)\!\(\*OverscriptBox[\(1\), \
\(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{-0.8666320462167909, -0.7505253677574302}, 
       0.018601479410086833]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \
\\(_\\)]\\)\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(1\), \(_\)]\)\!\(\*OverscriptBox[\(2\), \
\(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113579, 0.1343975701990508, 0.005314448521183453], 
      DiskBox[{1.0832900577709887, 1.1257880516361451}, 0.01640072098994626]},
     
     "\"(130)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(130)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9753636506980121, 0.4247794532494983, 0.04089742440798927], 
      DiskBox[{1.2999480693251861, 0.7505253677574302}, 0.021683845471347416]},
     "\"(220)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(220)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8292177422113579, 0.13439757019905074`, 0.005314448521183447], 
      DiskBox[{1.516606080879384, 0.3752626838787151}, 0.016400720989946257]},
     
     "\"(310)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(310)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{-0.21665801155419795, -1.1257880516361451}, 
       0.018601479410086833]},
     "\"(1\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(1\!\(\*OverscriptBox[\(3\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9414530468068959, 0.3271245848465938, 0.026824203360135926`],
       DiskBox[{0.4333160231083952, -0.7505253677574302}, 
       0.02033144363336555]},
     "\"(2\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(2\!\(\*OverscriptBox[\(2\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{1.0832900577709883, -0.3752626838787151}, 
       0.018601479410086833]},
     "\"(3\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(3\!\(\*OverscriptBox[\(1\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{-1.0832900577709883, 0.3752626838787151}, 
       0.018601479410086833]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)10)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(3\), \(_\)]\)10)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9414530468068959, 0.3271245848465938, 0.026824203360135926`],
       DiskBox[{-0.4333160231083952, 0.7505253677574302}, 
       0.02033144363336555]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)20)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(2\), \(_\)]\)20)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{0.21665801155419795, 1.1257880516361451}, 
       0.018601479410086833]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)30)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(1\), \(_\)]\)30)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8292177422113579, 0.13439757019905074`, 0.005314448521183447], 
      DiskBox[{-1.516606080879384, -0.3752626838787151}, 
       0.016400720989946257]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \
\\(_\\)]\\)\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(3\), \(_\)]\)\!\(\*OverscriptBox[\(1\), \
\(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9753636506980121, 0.4247794532494983, 0.04089742440798927], 
      DiskBox[{-1.2999480693251861, -0.7505253677574302}, 
       0.021683845471347416]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \
\\(_\\)]\\)\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(2\), \(_\)]\)\!\(\*OverscriptBox[\(2\), \
\(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113579, 0.1343975701990508, 0.005314448521183453], 
      DiskBox[{-1.0832900577709887, -1.1257880516361451}, 
       0.01640072098994626]},
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \
\\(_\\)]\\)\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, 
     "(\!\(\*OverscriptBox[\(1\), \(_\)]\)\!\(\*OverscriptBox[\(3\), \
\(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113579, 0.1343975701990508, 0.005314448521183453], 
      DiskBox[{-0.4333160231083957, -1.5010507355148603}, 
       0.01640072098994626]},
     "\"(1\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(1\!\(\*OverscriptBox[\(4\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{0.2166580115541974, -1.1257880516361451}, 
       0.018601479410086833]},
     "\"(2\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(2\!\(\*OverscriptBox[\(3\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{0.8666320462167907, -0.7505253677574302}, 
       0.018601479410086833]},
     "\"(3\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(3\!\(\*OverscriptBox[\(2\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113578, 0.1343975701990507, 0.005314448521183441], 
      DiskBox[{1.5166060808793835, -0.3752626838787151}, 
       0.016400720989946257]},
     "\"(4\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(4\!\(\*OverscriptBox[\(1\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113578, 0.1343975701990507, 0.005314448521183441], 
      DiskBox[{-1.5166060808793835, 0.3752626838787151}, 
       0.016400720989946257]},
     "\"(\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\)10)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(4\), \(_\)]\)10)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{-0.8666320462167907, 0.7505253677574302}, 
       0.018601479410086833]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)20)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(3\), \(_\)]\)20)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[
      0.8844859606846062, 0.22930245587315076`, 0.015906533017495283`], 
      DiskBox[{-0.2166580115541974, 1.1257880516361451}, 
       0.018601479410086833]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)30)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(2\), \(_\)]\)30)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113579, 0.1343975701990508, 0.005314448521183453], 
      DiskBox[{0.4333160231083957, 1.5010507355148603}, 0.01640072098994626]},
     
     "\"(\\!\\(\\*OverscriptBox[\\(1\\), \\(_\\)]\\)40)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(1\), \(_\)]\)40)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9753636506980121, 0.4247794532494982, 0.04089742440798924], 
      DiskBox[{0., -1.5010507355148603}, 0.021683845471347416]},
     "\"(2\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(2\!\(\*OverscriptBox[\(4\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9854714584546745, 0.5159230266848117, 0.05701055612056763], 
      DiskBox[{0.6499740346625928, -1.1257880516361451}, 
       0.022719420409665552]},
     "\"(3\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(3\!\(\*OverscriptBox[\(3\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9753636506980121, 0.4247794532494982, 0.04089742440798924], 
      DiskBox[{1.299948069325186, -0.7505253677574302}, 0.021683845471347416]},
     "\"(4\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(4\!\(\*OverscriptBox[\(2\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9753636506980121, 0.4247794532494982, 0.04089742440798924], 
      DiskBox[{-1.299948069325186, 0.7505253677574302}, 0.021683845471347416]},
     "\"(\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\)20)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(4\), \(_\)]\)20)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9854714584546745, 0.5159230266848117, 0.05701055612056763], 
      DiskBox[{-0.6499740346625928, 1.1257880516361451}, 
       0.022719420409665552]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)30)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(3\), \(_\)]\)30)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.9753636506980121, 0.4247794532494982, 0.04089742440798924], 
      DiskBox[{0., 1.5010507355148603}, 0.021683845471347416]},
     "\"(\\!\\(\\*OverscriptBox[\\(2\\), \\(_\\)]\\)40)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(2\), \(_\)]\)40)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113578, 0.1343975701990507, 0.005314448521183441], 
      DiskBox[{0.4333160231083951, -1.5010507355148603}, 
       0.016400720989946257]},
     "\"(3\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(3\!\(\*OverscriptBox[\(4\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113579, 0.1343975701990508, 0.005314448521183453], 
      DiskBox[{1.083290057770988, -1.1257880516361451}, 0.01640072098994626]},
     
     "\"(4\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)0)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(4\!\(\*OverscriptBox[\(3\), \(_\)]\)0)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113579, 0.1343975701990508, 0.005314448521183453], 
      DiskBox[{-1.083290057770988, 1.1257880516361451}, 0.01640072098994626]},
     
     "\"(\\!\\(\\*OverscriptBox[\\(4\\), \\(_\\)]\\)30)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(4\), \(_\)]\)30)", "Tooltip"]& ], 
   TagBox[
    TooltipBox[
     {RGBColor[0.8292177422113578, 0.1343975701990507, 0.005314448521183441], 
      DiskBox[{-0.4333160231083951, 1.5010507355148603}, 
       0.016400720989946257]},
     "\"(\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)40)\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "(\!\(\*OverscriptBox[\(3\), \(_\)]\)40)", "Tooltip"]& ]},
  ImageSize->Large]], "Output",
 CellChangeTimes->{{3.741952298216897*^9, 3.741952314847835*^9}, {
   3.741952369604259*^9, 3.741952387911395*^9}, 3.7419530415885887`*^9, 
   3.861605431015656*^9},
 CellLabel->"Out[5]=",
 CellID->718734217]
}, Open  ]]
}, Open  ]],

Cell["\<\
Adjusting the resolution will have the effect of \
\[OpenCurlyDoubleQuote]zooming\[CloseCurlyDoubleQuote] in and out. The \
resolution governs which reflections we are able to see. Note that the \
indices of the reflections can be read from the tooltips (hover the mouse \
over any node).\
\>", "Text",
 CellChangeTimes->{{3.741952898712389*^9, 3.7419530110249863`*^9}, {
  3.743137379553608*^9, 3.743137380863956*^9}},
 CellID->2109938560],

Cell["Please see the documentation page for more example of usage.", "Text",
 CellChangeTimes->{{3.74193688489545*^9, 3.741936903560773*^9}, {
   3.741937098464757*^9, 3.741937098844736*^9}, {3.741937155051461*^9, 
   3.741937163187463*^9}, 3.7419530354117193`*^9},
 CellID->2087636597]
}, Open  ]],

Cell[CellGroupData[{

Cell["Atomic scattering factors", "Section",
 CellChangeTimes->{{3.71725929413299*^9, 3.7172592980915813`*^9}, {
  3.741688052662314*^9, 3.741688061948189*^9}, {3.7427391600244923`*^9, 
  3.7427391643348303`*^9}},
 CellID->1803163375],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  ButtonBox["GetAtomicScatteringFactors",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetAtomicScatteringFactors"]], 
  "InlineFormula"],
 " function return ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "0"], "+", 
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["f", "\[Prime]\[Prime]",
      MultilineFunction->None]}]}], TraditionalForm]], "InlineMath"],
 " from either crystal and reflection input or element and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"sin", "(", "\[Theta]", ")"}], "/", "\[Lambda]"}], 
   TraditionalForm]], "InlineMath"],
 " input. This function requires sources of coefficients or interpolation \
functions in order to produce the results, and since the documentation page \
contains example on use, this tutorial will elaborate on the origin of the \
source tables included in this package."
}], "Text",
 CellChangeTimes->{{3.742739286514757*^9, 3.742739340854783*^9}, {
   3.742745992883998*^9, 3.742746005719201*^9}, {3.742746038831024*^9, 
   3.742746110233376*^9}, {3.742746175495781*^9, 3.7427461963644857`*^9}, {
   3.7427463585764112`*^9, 3.7427464280298443`*^9}, {3.742746614387231*^9, 
   3.742746621824874*^9}, {3.742747451671525*^9, 3.7427475278352957`*^9}, 
   3.7428035850905657`*^9, {3.743137601446885*^9, 3.743137605548581*^9}, {
   3.753068164063655*^9, 3.753068164063841*^9}},
 CellID->1299640056],

Cell[TextData[{
 "Sixteen ",
 StyleBox[".dat", "InlineCode"],
 " files are available at ",
 ButtonBox["ESRF's FTP server",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://ftp://ftp.esrf.eu/pub/scisoft//xop2.3/DabaxFiles"], None}],
 ", with prefix ",
 StyleBox["f0", "InlineCode"],
 " for files regarding the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "0"], TraditionalForm]], "InlineMath"],
 " factor and prefix ",
 StyleBox["f1f2", "InlineCode"],
 " for the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "+", 
    SuperscriptBox["f", "\[Prime]\[Prime]",
     MultilineFunction->None]}], TraditionalForm]], "InlineMath"],
 " factors. After retrieving these (late 2017) they were prepared in a format \
to be imported by ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " when needed."
}], "Text",
 CellChangeTimes->{{3.7427475781206617`*^9, 3.7427475907225647`*^9}, {
  3.742747621017294*^9, 3.742747851653685*^9}, {3.742747929046657*^9, 
  3.7427479388675222`*^9}},
 CellID->2007483230],

Cell[TextData[{
 "The data is stored in two different ways: either as coefficients (so-called \
",
 StyleBox["Cromer\[Dash]Mann coefficients",
  FontSlant->"Italic"],
 ") to approximate the scattering factor with the function"
}], "Text",
 CellChangeTimes->{{3.742747941557846*^9, 3.7427480823191357`*^9}, {
  3.742748239535427*^9, 3.742748242339684*^9}, {3.742749049499946*^9, 
  3.7427490509688883`*^9}, {3.742831135718546*^9, 3.742831177867929*^9}},
 CellID->321014419],

Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox[
    StyleBox["f",
     FontWeight->"Plain"], 
    RowBox[{"(", "0", ")"}]], 
   StyleBox["=",
    FontWeight->"Plain"], 
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox[
       UnderscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}]],
       FontWeight->"Plain"], 
      RowBox[{
       StyleBox[
        SubscriptBox[
         StyleBox["a",
          FontWeight->"Plain"], "i"],
        FontWeight->"Plain"], 
       StyleBox["exp",
        FontWeight->"Plain"], 
       RowBox[{
        StyleBox["(",
         FontWeight->"Plain"], 
        RowBox[{
         StyleBox[
          RowBox[{"-", 
           SubscriptBox["b", "i"]}],
          FontWeight->"Plain"], 
         SuperscriptBox[
          StyleBox["s",
           FontWeight->"Plain"], "2"]}], ")"}]}]}], "+", 
     RowBox[{"c", "\t", 
      StyleBox["where", "TR"], "     ", "s"}]}], "\[Congruent]", 
    RowBox[{
     RowBox[{"sin", "(", "\[Theta]", ")"}], "/", "\[Lambda]"}]}]}], 
  TraditionalForm]], "DisplayMath",
 CellChangeTimes->{{3.7427480846730843`*^9, 3.742748214020547*^9}, {
  3.7427482471959457`*^9, 3.742748261675362*^9}, {3.742748326524805*^9, 
  3.7427484185601187`*^9}, {3.7427485366368713`*^9, 3.742748570084949*^9}, {
  3.742748662125345*^9, 3.7427486824738197`*^9}, {3.743137628843746*^9, 
  3.743137638694209*^9}},
 CellID->1553302283],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]], "InlineMath"],
 " runs from ",
 Cell[BoxData[
  FormBox["1", TraditionalForm]], "InlineMath"],
 " to ",
 Cell[BoxData[
  FormBox["4", TraditionalForm]], "InlineMath"],
 " or ",
 Cell[BoxData[
  FormBox["5", TraditionalForm]], "InlineMath"],
 ", or as data points: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["f",
        FontWeight->"Plain"], 
       RowBox[{"(", "0", ")"}]], "(", "s", ")"}]}], "}"}], TraditionalForm]], 
  "InlineMath"],
 " in the ",
 StyleBox["f0", "InlineCode"],
 " cases and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"E", ",", 
     RowBox[{
      SuperscriptBox["f", "\[Prime]",
       MultilineFunction->None], "(", "E", ")"}], ",", 
     RowBox[{
      SuperscriptBox["f", "\[Prime]\[Prime]",
       MultilineFunction->None], "(", "E", ")"}]}], "}"}], TraditionalForm]], 
  "InlineMath"],
 " in the ",
 StyleBox["f1f2", "InlineCode"],
 " cases, where ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]], "InlineMath"],
 " is defined above and ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]], "InlineMath"],
 " denotes energy. Actually, some files contain more columns, but these are \
ignored. Energy units are converted to \[ARing]ngstr\[ODoubleDot]ms."
}], "Text",
 CellChangeTimes->{{3.742747941557846*^9, 3.7427480823191357`*^9}, {
  3.742748239535427*^9, 3.742748242339684*^9}, {3.742748434545035*^9, 
  3.742748527253275*^9}, {3.742748699162293*^9, 3.7427488609412193`*^9}, {
  3.7427489746864557`*^9, 3.7427490270178947`*^9}, {3.742803604358982*^9, 
  3.742803611769826*^9}, {3.743137656603302*^9, 3.743137668906598*^9}},
 CellID->1971629454],

Cell[TextData[{
 "The coefficients method is only available for the ",
 StyleBox["f0", "InlineCode"],
 " case, but some files use the data point method. An overview is given here \
(third column show valid range; missing means  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "<", 
    RowBox[{"2.5", 
     SuperscriptBox["\[CapitalARing]", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]], "InlineMath"],
 " [truncated]):"
}], "Text",
 CellChangeTimes->{{3.742749111034952*^9, 3.7427491132037582`*^9}, {
  3.742830744045002*^9, 3.742830752580881*^9}, {3.7428331654250813`*^9, 
  3.742833178295549*^9}, {3.7431376937290983`*^9, 3.743137693729231*^9}},
 CellID->502109707],

Cell[TextData[{
 StyleBox["f0_CromerMann.dat", "InlineCode"],
 "\t\tcoefficients (9 constants)\t\t ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "<", 
    RowBox[{"1.5", 
     SuperscriptBox["\[CapitalARing]", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]], "InlineMath"]
}], "BulletedText",
 CellChangeTimes->{{3.742749121520516*^9, 3.742749159342448*^9}, 
   3.742749343058276*^9, 3.742792804743657*^9, {3.742830972833637*^9, 
   3.7428309735458307`*^9}, {3.742833013067452*^9, 3.7428330152352657`*^9}, {
   3.743137692215152*^9, 3.743137692215233*^9}},
 CellID->617004870],

Cell[TextData[{
 StyleBox["f0_EPDL97.dat", "InlineCode"],
 "\t\tdata points ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["f",
        FontWeight->"Plain"], 
       RowBox[{"(", "0", ")"}]], "(", "s", ")"}]}], "}"}], TraditionalForm]], 
  "InlineMath"]
}], "BulletedText",
 CellChangeTimes->{{3.742749121520516*^9, 3.742749176350566*^9}, {
   3.7427492064044952`*^9, 3.742749227400299*^9}, 3.742749345261221*^9, 
   3.742792792100581*^9, {3.74279283589852*^9, 3.742792850792556*^9}, {
   3.7428331199882183`*^9, 3.742833127468027*^9}, {3.74313767568332*^9, 
   3.743137677942583*^9}},
 CellID->1197623678],

Cell[TextData[{
 StyleBox["f0_InterTables.dat\t", "InlineCode"],
 "\tcoefficients (9 constants)\t\t ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "<", 
    RowBox[{"2.0", 
     SuperscriptBox["\[CapitalARing]", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]], "InlineMath"]
}], "BulletedText",
 CellChangeTimes->{{3.742749121520516*^9, 3.742749181253738*^9}, 
   3.7427493460127583`*^9, 3.742792803555401*^9, {3.742792833601679*^9, 
   3.742792853637237*^9}, {3.74283075750156*^9, 3.742830789052226*^9}, {
   3.743137695265711*^9, 3.7431376952658*^9}},
 CellID->96932815],

Cell[TextData[{
 StyleBox["f0_mf_Kissel.dat\t", "InlineCode"],
 "\tdata points ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["f",
        FontWeight->"Plain"], 
       RowBox[{"(", "0", ")"}]], "(", "s", ")"}]}], "}"}], TraditionalForm]], 
  "InlineMath"]
}], "BulletedText",
 CellChangeTimes->{{3.742749121520516*^9, 3.742749185797872*^9}, 
   3.742749236887908*^9, 3.74274934673989*^9, {3.7427928016432343`*^9, 
   3.742792858217477*^9}, {3.7428331330895443`*^9, 3.742833134162098*^9}, {
   3.743137679622808*^9, 3.743137682010585*^9}},
 CellID->1357217279],

Cell[TextData[{
 StyleBox["f0_rf_Kissel.dat", "InlineCode"],
 "\t\tdata points ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["f",
        FontWeight->"Plain"], 
       RowBox[{"(", "0", ")"}]], "(", "s", ")"}]}], "}"}], TraditionalForm]], 
  "InlineMath"]
}], "BulletedText",
 CellChangeTimes->{{3.742749121520516*^9, 3.742749189853901*^9}, 
   3.742749238366454*^9, 3.742749347483725*^9, {3.742792798474299*^9, 
   3.742792828240036*^9}, 3.742792863295273*^9, {3.7428331349617777`*^9, 
   3.7428331359366093`*^9}, {3.7431376840376463`*^9, 3.743137687800856*^9}},
 CellID->179509719],

Cell[TextData[{
 StyleBox["f0_WaasKirf.dat", "InlineCode"],
 "\t\tcoefficients (11 constants)\t\t ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "<", 
    RowBox[{"6.0", 
     SuperscriptBox["\[CapitalARing]", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]], "InlineMath"]
}], "BulletedText",
 CellChangeTimes->{{3.742749121520516*^9, 3.742749159342448*^9}, {
   3.7427491923498383`*^9, 3.742749193637434*^9}, {3.7427492433182583`*^9, 
   3.742749243468261*^9}, 3.7427493481877403`*^9, {3.7427928063056726`*^9, 
   3.7427928218733263`*^9}, 3.742792866859993*^9, {3.7428331368818893`*^9, 
   3.742833137624565*^9}, {3.7428338636019287`*^9, 3.742833868163409*^9}, {
   3.742833942826179*^9, 3.7428339472547827`*^9}, {3.743137697066835*^9, 
   3.743137697066925*^9}},
 CellID->1952806845],

Cell[TextData[{
 StyleBox["f0_xop.dat", "InlineCode"],
 "\t\t\tcoefficients (11 constants)\t\t?"
}], "BulletedText",
 CellChangeTimes->{{3.742749121520516*^9, 3.742749159342448*^9}, {
   3.742749195806085*^9, 3.742749197653483*^9}, {3.742749245156657*^9, 
   3.742749245292515*^9}, 3.742749349051828*^9, 3.742792807915484*^9, {
   3.7428331385457973`*^9, 3.742833139088229*^9}, {3.742833923240736*^9, 
   3.742833924335204*^9}},
 CellID->832066814],

Cell[TextData[{
 "For completeness, the ",
 StyleBox["f1f2", "InlineCode"],
 " files are:"
}], "Text",
 CellChangeTimes->{{3.742749281393702*^9, 3.742749293891149*^9}, {
  3.742749329852045*^9, 3.742749331010376*^9}},
 CellID->1912567340],

Cell[TextData[StyleBox["f1f2_asf_Kissel.dat", "InlineCode"]], "BulletedText",
 CellChangeTimes->{{3.742749341275586*^9, 3.742749373617567*^9}, 
   3.742749443951819*^9},
 CellID->664333692],

Cell[TextData[StyleBox["f1f2_BrennanCowan.dat", "InlineCode"]], "BulletedText",
 CellChangeTimes->{{3.742749341275586*^9, 3.7427493883537703`*^9}, 
   3.742749443040097*^9},
 CellID->901341942],

Cell[TextData[StyleBox["f1f2_Chantler.dat", "InlineCode"]], "BulletedText",
 CellChangeTimes->{{3.742749341275586*^9, 3.742749393984931*^9}, 
   3.742749442112319*^9},
 CellID->504373256],

Cell[TextData[StyleBox["f1f2_CromerLiberman.dat", "InlineCode"]], \
"BulletedText",
 CellChangeTimes->{{3.742749341275586*^9, 3.742749373617567*^9}, {
  3.742749428544346*^9, 3.742749433895769*^9}},
 CellID->480393818],

Cell[TextData[StyleBox["f1f2_EPDL97.dat", "InlineCode"]], "BulletedText",
 CellChangeTimes->{{3.742749341275586*^9, 3.74274940210476*^9}, 
   3.742749446119792*^9},
 CellID->883358883],

Cell[TextData[StyleBox["f1f2_Henke.dat", "InlineCode"]], "BulletedText",
 CellChangeTimes->{{3.742749341275586*^9, 3.742749373617567*^9}, {
   3.742749406680911*^9, 3.742749407056677*^9}, 3.7427494471677303`*^9},
 CellID->1058294870],

Cell[TextData[StyleBox["f1f2_Sasaki.dat", "InlineCode"]], "BulletedText",
 CellChangeTimes->{{3.742749341275586*^9, 3.742749373617567*^9}, {
   3.7427494101766148`*^9, 3.7427494110804453`*^9}, 3.742749448127688*^9},
 CellID->1302315636],

Cell[TextData[StyleBox["f1f2_Windt.dat", "InlineCode"]], "BulletedText",
 CellChangeTimes->{{3.742749341275586*^9, 3.742749373617567*^9}, {
  3.742749417344388*^9, 3.7427494489839077`*^9}},
 CellID->865564028],

Cell[TextData[{
 "In all cases where data points are used, the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " function ",
 Cell[BoxData[
  ButtonBox["Interpolation",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Interpolation"]], "InlineFormula"],
 " was used to generate interpolation functions; one for every data pair \
within each chemical element. Finally, all the interpolation functions were \
stored as an association with element symbols as keys. This was saved to an \
",
 StyleBox["m", "InlineCode"],
 " file with the same name as the ",
 StyleBox["dat", "InlineCode"],
 " file."
}], "Text",
 CellChangeTimes->{{3.742749465548587*^9, 3.742749641387397*^9}},
 CellID->1651759066],

Cell[CellGroupData[{

Cell[TextData[{
 "Organisation scheme for ",
 StyleBox["f0", "InlineCode"],
 " functions (those with data point format):"
}], "BulletedText",
 CellChangeTimes->{{3.742749651688958*^9, 3.742749725091856*^9}, {
  3.742749803299789*^9, 3.742749803802244*^9}},
 CellID->1504228733],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<H\>\"", "\[Rule]", 
     RowBox[{"f0H", "[", "\[Lambda]", "]"}]}], ",", 
    RowBox[{"\"\<He\>\"", "\[Rule]", 
     RowBox[{"f0He", "[", "\[Lambda]", "]"}]}], ",", 
    RowBox[{"\"\<Li\>\"", "\[Rule]", 
     RowBox[{"f0Li", "[", "\[Lambda]", "]"}]}], ",", "\[Ellipsis]"}], 
   "|>"}]}]], "Input",
 Evaluatable->False,
 ShowCellLabel->False,
 CellChangeTimes->{{3.7427351389357643`*^9, 3.7427352246809473`*^9}, {
  3.742735263560008*^9, 3.7427352641203527`*^9}, {3.742735503644788*^9, 
  3.7427355060905046`*^9}, {3.742735842667068*^9, 3.742735848738627*^9}},
 TextAlignment->AlignmentMarker,
 CellLabel->"In[4]:=",
 CellID->1330622774]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Organisation scheme for ",
 StyleBox["f1f2", "InlineCode"],
 " functions:"
}], "BulletedText",
 CellChangeTimes->{{3.742749741615793*^9, 3.742749748331277*^9}},
 CellID->1794106722],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{"<|", "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\"\<H\>\"", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f1H", "[", "#", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", "*", 
          RowBox[{"f2H", "[", "#", "]"}]}]}], ")"}]}], "&"}], "[", 
     "\[Lambda]", "]"}], ",", "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<He\>\"", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f1He", "[", "#", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", "*", 
          RowBox[{"f2He", "[", "#", "]"}]}]}], ")"}]}], "&"}], "[", 
     "\[Lambda]", "]"}], ",", "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<Li\>\"", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f1Li", "[", "#", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", "*", 
          RowBox[{"f2Li", "[", "#", "]"}]}]}], ")"}]}], "&"}], "[", 
     "\[Lambda]", "]"}], ",", "\[IndentingNewLine]", "\t\t", "\[Ellipsis]"}], 
   "|>"}]}]], "Input",
 Evaluatable->False,
 ShowCellLabel->False,
 CellChangeTimes->{{3.7427351389357643`*^9, 3.74273527139986*^9}, {
  3.742735975321958*^9, 3.742735999015979*^9}, {3.7427371481957493`*^9, 
  3.742737211952787*^9}},
 TextAlignment->AlignmentMarker,
 CellLabel->"In[2]:=",
 CellID->2051685854]
}, Open  ]],

Cell[TextData[{
 "where the ",
 StyleBox["f*", "InlineCode"],
 " functions are the corresponding interpolation functions generated, which \
require a wavelength input and return the value of ",
 StyleBox["f0", "InlineCode"],
 ", ",
 StyleBox["f1", "InlineCode"],
 " or ",
 StyleBox["f2", "InlineCode"],
 "."
}], "Text",
 CellChangeTimes->{{3.742749809757092*^9, 3.742749840577511*^9}},
 CellID->812704820],

Cell[TextData[{
 "The ",
 StyleBox["f0", "InlineCode"],
 " interpolation functions use interpolation order 3, while the ",
 StyleBox["f1f2", "InlineCode"],
 " functions use order 1 (linear). All use the Hermite interpolation method."
}], "Text",
 CellChangeTimes->{{3.742749857413686*^9, 3.742749888448181*^9}},
 CellID->1456191198],

Cell[CellGroupData[{

Cell[TextData[{
 "Note that for all ",
 StyleBox["f0", "InlineCode"],
 ", ",
 StyleBox["f1", "InlineCode"],
 " and ",
 StyleBox["f2", "InlineCode"],
 " interpolation functions the desired scattering factor is obtained with:"
}], "Text",
 CellChangeTimes->{{3.74274990898208*^9, 3.742749979446484*^9}},
 CellID->1709962922],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{"sourceName", "[", "\"\<element\>\"", "]"}], "[", "wavelength", 
   "]"}]}]], "Input",
 Evaluatable->False,
 ShowCellLabel->False,
 CellChangeTimes->{{3.7427351389357643`*^9, 3.7427352246809473`*^9}, {
  3.742735263560008*^9, 3.7427352641203527`*^9}, {3.742735503644788*^9, 
  3.7427355060905046`*^9}, {3.742735842667068*^9, 3.742735848738627*^9}, {
  3.742737368630664*^9, 3.7427373869329643`*^9}, {3.742737491802567*^9, 
  3.7427374965463047`*^9}},
 TextAlignment->AlignmentMarker,
 CellLabel->"In[3]:=",
 CellID->1719575401]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "where ",
 StyleBox["sourceName", "InlineCode"],
 " denotes one of the associations constructed from any of the ",
 StyleBox["dat", "InlineCode"],
 " files storing the information as data points, ",
 StyleBox["\"element\"", "InlineCode"],
 " should be the symbol of a chemical element and the ",
 StyleBox["wavelength", "InlineCode"],
 " is in \[ARing]ngstr\[ODoubleDot]ms. A demonstration of this is in order: \
After using ",
 Cell[BoxData[
  ButtonBox["GetAtomicScatteringFactors",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/GetAtomicScatteringFactors"]], 
  "InlineFormula"],
 " the first time in a session, the following \[OpenCurlyDoubleQuote]hidden\
\[CloseCurlyDoubleQuote] symbols are created:\[LineSeparator]\t",
 Cell[BoxData["MaXrd`Private`$f0"], "Input",
  CellChangeTimes->{{3.742738418679068*^9, 3.742738461420611*^9}, {
   3.742738751473587*^9, 3.742738784782846*^9}},
  TextAlignment->-0.5],
 "\[LineSeparator]\t",
 Cell[BoxData["MaXrd`Private`$f1f2"], "Input",
  CellChangeTimes->{{3.742738477222114*^9, 3.7427384820523987`*^9}, {
   3.742738523149619*^9, 3.742738544914596*^9}},
  TextAlignment->-0.5],
 "\[LineSeparator]These associate the file names with the corresponding \
imported associations."
}], "Text",
 CellChangeTimes->{{3.7427499869224033`*^9, 3.74275007540431*^9}, {
   3.742750205339614*^9, 3.742750386949505*^9}, {3.742751633961542*^9, 
   3.7427516614714003`*^9}, {3.7427517193982887`*^9, 3.7427517197339363`*^9}, 
   3.74280361882579*^9, {3.743137739572921*^9, 3.74313774107311*^9}, {
   3.743836295717022*^9, 3.743836296485241*^9}, {3.753068181886747*^9, 
   3.753068181886935*^9}},
 CellID->1702821681],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GetAtomicScatteringFactors", "[", 
  RowBox[{"\"\<Silicon\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "1.541"}], "]"}]], "Input",\

 CellChangeTimes->{{3.742750401902288*^9, 3.742750412524884*^9}, {
   3.742750813021311*^9, 3.742750813619759*^9}, 3.753068242024047*^9},
 CellLabel->"In[6]:=",
 CellID->329146285],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"\<\"Si\"\>", "\[Rule]", 
   RowBox[{"10.792061356388924`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.3303403705910288`", " ", "\[ImaginaryI]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.7427508152422657`*^9, 3.7427508277655497`*^9}, 
   3.7427517268600283`*^9, 3.8616054457727423`*^9},
 CellLabel->"Out[6]=",
 CellID->1307559688]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
After running the code above, the symbols are created. Let us check this:\
\>", "Text",
 CellChangeTimes->{{3.7427517309408493`*^9, 3.742751761276613*^9}},
 CellID->1002270249],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Keys", "/@", 
  RowBox[{"{", 
   RowBox[{"MaXrd`Private`$f0", ",", "MaXrd`Private`$f1f2"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.742750401902288*^9, 3.742750412524884*^9}, {
  3.742750813021311*^9, 3.7427508520999928`*^9}, {3.743836297962535*^9, 
  3.74383629895406*^9}},
 CellLabel->"In[7]:=",
 CellID->1098049228],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "\<\"WaasmaierKirfel\"\>", "}"}], ",", 
   RowBox[{"{", "\<\"CromerLiberman\"\>", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.742750852381175*^9, 3.742751726982836*^9, 
  3.861605447944789*^9},
 CellLabel->"Out[7]=",
 CellID->731169051]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "We recognise the default ",
 StyleBox["f0", "InlineCode"],
 " and ",
 StyleBox["f1f2", "InlineCode"],
 " sources. The ",
 Cell[BoxData["\"\<WaasmaierKirfel\>\""], "InlineFormula"],
 " source contain coefficients:"
}], "Text",
 CellChangeTimes->{{3.74275176332206*^9, 3.742751778828356*^9}, {
  3.742751831326129*^9, 3.742751852554243*^9}, {3.742751892339306*^9, 
  3.742751902593316*^9}},
 CellID->1286395119],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaXrd`Private`$f0", "[", "\"\<WaasmaierKirfel\>\"", "]"}], "[", 
    "\"\<He\>\"", "]"}], "//", "Normal"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.742738418679068*^9, 3.742738461420611*^9}, {
   3.742738751473587*^9, 3.742738784782846*^9}, 3.743836299578311*^9},
 CellLabel->"In[8]:=",
 CellID->1371633564],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"\<\"Method\"\>", "\[Rule]", "\<\"RHF\"\>"}]},
     {
      RowBox[{"\<\"a1\"\>", "\[Rule]", "0.732354`"}]},
     {
      RowBox[{"\<\"b1\"\>", "\[Rule]", "11.553918`"}]},
     {
      RowBox[{"\<\"a2\"\>", "\[Rule]", "0.753896`"}]},
     {
      RowBox[{"\<\"b2\"\>", "\[Rule]", "4.595831`"}]},
     {
      RowBox[{"\<\"a3\"\>", "\[Rule]", "0.283819`"}]},
     {
      RowBox[{"\<\"b3\"\>", "\[Rule]", "1.546299`"}]},
     {
      RowBox[{"\<\"a4\"\>", "\[Rule]", "0.190003`"}]},
     {
      RowBox[{"\<\"b4\"\>", "\[Rule]", "26.463964`"}]},
     {
      RowBox[{"\<\"a5\"\>", "\[Rule]", "0.039139`"}]},
     {
      RowBox[{"\<\"b5\"\>", "\[Rule]", "0.377523`"}]},
     {
      RowBox[{"\<\"c\"\>", "\[Rule]", "0.000487`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7427516074645853`*^9, 3.7427517270841627`*^9, 
  3.861605449251699*^9},
 CellLabel->"Out[8]//TableForm=",
 CellID->772861501]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "while the ",
 Cell[BoxData["\"\<CromerLiberman\>\""], "InlineFormula"],
 " source uses data points (as all ",
 StyleBox["f1f2", "InlineCode"],
 " data files):"
}], "Text",
 CellChangeTimes->{{3.7427519067192*^9, 3.742751935660028*^9}},
 CellID->155143503],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MaXrd`Private`$f1f2", "[", "\"\<CromerLiberman\>\"", "]"}], "[", 
   "\"\<Fe\>\"", "]"}], "[", "1.234", "]"}]], "Input",
 CellChangeTimes->{{3.742738477222114*^9, 3.7427384820523987`*^9}, {
   3.742738523149619*^9, 3.742738544914596*^9}, 3.743836300474238*^9},
 CellLabel->"In[9]:=",
 CellID->244251865],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "0.014974391286641844`"}], "+", 
  RowBox[{"2.2235650672731784`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.742751611586392*^9, 3.742751727184125*^9, 
  3.861605451717659*^9},
 CellLabel->"Out[9]=",
 CellID->1020574412]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Structure factors", "Section",
 CellChangeTimes->{{3.71725929413299*^9, 3.7172592980915813`*^9}, 
   3.74168804554366*^9},
 CellID->188407737],

Cell[CellGroupData[{

Cell[TextData[{
 "The ",
 Cell[BoxData[
  ButtonBox["StructureFactor",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/StructureFactor"]], 
  "InlineFormula"],
 " function is written in a way that requires minimal input from the user. \
Syntax information:"
}], "Text",
 CellChangeTimes->{{3.741688912144462*^9, 3.741689018742798*^9}, {
   3.741689049511003*^9, 3.741689050927994*^9}, {3.741689101049612*^9, 
   3.7416891701826267`*^9}, {3.741928399133253*^9, 3.741928407617899*^9}, 
   3.741928438722479*^9, {3.741931112793333*^9, 3.74193111698912*^9}, {
   3.741931314297763*^9, 3.741931326111218*^9}, {3.741931453325445*^9, 
   3.7419314568679533`*^9}, {3.741931775830162*^9, 3.7419317984201202`*^9}},
 CellID->203540802],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "StructureFactor"}]], "Input",
 CellChangeTimes->{{3.7419318012371492`*^9, 3.741931805161089*^9}},
 CellLabel->"In[10]:=",
 CellID->1621360621],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:StianRamsnes/MaXrd/ref/StructureFactor",
              ButtonNote->"paclet:StianRamsnes/MaXrd/ref/StructureFactor"],
             "\"paclet:MaXrd/ref/StructureFactor\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"StructureFactor\\\", \
\\\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"h\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"k\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"l\\\", \
\\\"TI\\\"]}], \\\"}\\\"}], \\\"]\\\"}]\\)\\!\\(\\*RowBox[{\\\" calculates \
the structure factor of the \\\", Cell[BoxData[StyleBox[\\\"hkl\\\", \\\"TI\\\
\"]], \\\"InlineFormula\\\"], \\\" reflection for \\\", \
Cell[BoxData[StyleBox[\\\"crystal\\\", \\\"TI\\\"]], \\\"InlineFormula\\\"], \
\\\" at wavelength stored in \\\", Cell[BoxData[\\\"$CrystalData\\\"], \
\\\"InlineFormula\\\"], \\\".\\\"}]\\)\\n\\!\\(\\*RowBox[{\\\"StructureFactor\
\\\", \\\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{StyleBox[\\\"h\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"k\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"l\\\", \\\"TI\\\"]}], \\\"}\\\"}], \
\\\",\\\", StyleBox[\\\"\[Lambda]\\\", \\\"TR\\\"], \
\\\"]\\\"}]\\)\\!\\(\\*RowBox[{\\\" calculates the structure factor of the \\\
\", Cell[BoxData[StyleBox[\\\"hkl\\\", \\\"TI\\\"]], \\\"InlineFormula\\\"], \
\\\" reflection for \\\", Cell[BoxData[StyleBox[\\\"crystal\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\" at wavelength \\\", \
Cell[BoxData[StyleBox[\\\"\[Lambda]\\\", \\\"TR\\\"]], \
\\\"InlineFormula\\\"], \\\".\\\"}]\\)\\n\\!\\(\\*RowBox[{\\\"StructureFactor\
\\\", \\\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"h\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"l\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"h\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \
\\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"l\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]]}], \\\"}\\\"}], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \
\\\"TR\\\"]}], \\\"}\\\"}], \\\",\\\", StyleBox[\\\"\[Lambda]\\\", \
\\\"TR\\\"], \\\"]\\\"}]\\)\\!\\(\\*RowBox[{\\\" calculates the structure \
factor of the \\\", Cell[BoxData[SubscriptBox[StyleBox[\\\"hkl\\\", \
\\\"TI\\\"], StyleBox[\\\"i\\\", \\\"TI\\\"]]], \\\"InlineFormula\\\"], \\\" \
reflections for \\\", Cell[BoxData[StyleBox[\\\"crystal\\\", \\\"TI\\\"]], \\\
\"InlineFormula\\\"], \\\" at wavelength \\\", Cell[BoxData[StyleBox[\\\"\
\[Lambda]\\\", \\\"TR\\\"]], \\\"InlineFormula\\\"], \\\".\\\"}]\\)\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"StructureFactor", "[", 
                    
                    RowBox[{
                    "MaXrd`Private`crystal_String", ",", 
                    "MaXrd`Private`hklInput_List", ",", 
                    RowBox[{"MaXrd`Private`lambda", ":", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#1", "]"}], "||", 
                    RowBox[{"QuantityQ", "[", "#1", "]"}]}], "&"}], ")"}]}], 
                    ":", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"MaXrd`Private`options", ":", 
                    RowBox[{"OptionsPattern", "[", 
                    RowBox[{"{", 
                    
                    RowBox[{"StructureFactor", ",", 
                    "GetAtomicScatteringFactors", ",", "GetElements"}], "}"}],
                     "]"}]}]}], "]"}], ":=", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"MaXrd`Private`data", ",", 
                    "MaXrd`Private`\[Lambda]", ",", 
                    RowBox[{"MaXrd`Private`abs", "=", 
                    RowBox[{"TrueQ", "[", 
                    RowBox[{"OptionValue", "[", "\"AbsoluteValue\"", "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"MaXrd`Private`ignoreExtinct", "=", 
                    RowBox[{"TrueQ", "[", 
                    
                    RowBox[{"OptionValue", "[", "\"IgnoreSystematicAbsence\"",
                     "]"}], "]"}]}], ",", 
                    RowBox[{"MaXrd`Private`unitsQ", "=", 
                    RowBox[{"TrueQ", "[", 
                    RowBox[{"OptionValue", "[", "\"Units\"", "]"}], "]"}]}], 
                    ",", 
                    RowBox[{"MaXrd`Private`\[Delta]", "=", 
                    RowBox[{"OptionValue", "[", "\"Threshold\"", "]"}]}], ",",
                     "MaXrd`Private`hkl", ",", "MaXrd`Private`L0", ",", 
                    "MaXrd`Private`L", ",", "MaXrd`Private`zerotype", ",", 
                    "MaXrd`Private`absence", ",", "MaXrd`Private`l", ",", 
                    "MaXrd`Private`hklPos", ",", "MaXrd`Private`j", ",", 
                    "MaXrd`Private`H", ",", "MaXrd`Private`d", ",", 
                    "MaXrd`Private`sl", ",", "MaXrd`Private`f", ",", 
                    "MaXrd`Private`atomdata", ",", "MaXrd`Private`r", ",", 
                    "MaXrd`Private`type", ",", "MaXrd`Private`disp", ",", 
                    "MaXrd`Private`U", ",", "MaXrd`Private`R", ",", 
                    "MaXrd`Private`T", ",", "MaXrd`Private`cvecs", ",", 
                    "MaXrd`Private`occ", ",", "MaXrd`Private`elements", ",", 
                    "MaXrd`Private`siteSymMxyz", ",", 
                    "MaXrd`Private`siteSymO", ",", "MaXrd`Private`sf", ",", 
                    "MaXrd`Private`SF", ",", "MaXrd`Private`F", ",", 
                    "MaXrd`Private`\[Phi]"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"InputCheck", "[", 
                    
                    RowBox[{"\"CrystalQ\"", ",", "MaXrd`Private`crystal", ",",
                     "False"}], "]"}], ";", 
                    RowBox[{"MaXrd`Private`\[Lambda]", "=", 
                    RowBox[{"InputCheck", "[", 
                    
                    RowBox[{"\"ProcessWavelength\"", ",", 
                    "MaXrd`Private`crystal", ",", "MaXrd`Private`lambda"}], 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`data", "=", 
                    
                    RowBox[{"$CrystalData", "[", "MaXrd`Private`crystal", 
                    "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    
                    RowBox[{"NumericQ", "[", "MaXrd`Private`\[Delta]", 
                    "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    RowBox[{
                    StyleBox[
                    RowBox[{"StructureFactor", "::", "InvalidThreshold"}], 
                    "MessageName"], ",", "MaXrd`Private`\[Delta]"}], "]"}], 
                    ";", 
                    RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"MaXrd`Private`hkl", "=", 
                    RowBox[{"InputCheck", "[", 
                    
                    RowBox[{"MaXrd`Private`hklInput", ",", "\"Integer\"", ",",
                     "\"WrapSingle\""}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`L0", "=", 
                    RowBox[{"Length", "[", "MaXrd`Private`hkl", "]"}]}], ";", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "MaXrd`Private`ignoreExtinct"}], ",", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`zerotype", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{"MaXrd`Private`abs", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"MaXrd`Private`unitsQ", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Quantity", "[", 
                    RowBox[{"0", ",", "\"Degrees\""}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "0"}], 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`absence", "=", 
                    RowBox[{"SystematicAbsentQ", "[", 
                    
                    RowBox[{"MaXrd`Private`crystal", ",", 
                    "MaXrd`Private`hkl"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`l", "=", 
                    RowBox[{"Length", "[", "MaXrd`Private`absence", "]"}]}], 
                    ";", 
                    RowBox[{"MaXrd`Private`hkl", "=", 
                    RowBox[{"Pick", "[", 
                    
                    RowBox[{"MaXrd`Private`hkl", ",", "MaXrd`Private`absence",
                     ",", "False"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`hklPos", "=", 
                    RowBox[{"Position", "[", 
                    RowBox[{"MaXrd`Private`absence", ",", "False"}], "]"}]}], 
                    ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"AllTrue", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "MaXrd`Private`absence", "]"}], 
                    ",", "TrueQ"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`l", "===", "1"}], ",", 
                    RowBox[{"Return", "[", "MaXrd`Private`zerotype", "]"}], 
                    ",", 
                    RowBox[{"Return", "[", 
                    RowBox[{"ConstantArray", "[", 
                    
                    RowBox[{"MaXrd`Private`zerotype", ",", 
                    "MaXrd`Private`l"}], "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
                    "]"}], ";", 
                    RowBox[{"MaXrd`Private`L", "=", 
                    RowBox[{"Length", "[", "MaXrd`Private`hkl", "]"}]}], ";", 
                    
                    RowBox[{"MaXrd`Private`H", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"GetCrystalMetric", "[", 
                    RowBox[{"MaXrd`Private`crystal", ",", 
                    RowBox[{"\"Space\"", "\[Rule]", "\"Reciprocal\""}]}], 
                    "]"}], "]"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`sl", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    SqrtBox[
                    RowBox[{"#1", ".", "MaXrd`Private`H", ".", "#1"}]]}], 
                    "]"}], "&"}], ")"}], "/@", "MaXrd`Private`hkl"}]}], ";", 
                    RowBox[{"MaXrd`Private`atomdata", "=", 
                    
                    RowBox[{"MaXrd`Private`data", "[", "\"AtomData\"", 
                    "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`r", "=", 
                    
                    RowBox[{"MaXrd`Private`atomdata", "\[LeftDoubleBracket]", 
                    
                    RowBox[{"All", ",", "\"FractionalCoordinates\""}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"MaXrd`Private`R", ",", "MaXrd`Private`T"}], 
                    "}"}], "=", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"GetSymmetryOperations", "[", 
                    RowBox[{"MaXrd`Private`crystal", ",", 
                    RowBox[{"\"AugmentedMatrix\"", "\[Rule]", "False"}]}], 
                    "]"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`occ", "=", 
                    RowBox[{"Lookup", "[", 
                    
                    RowBox[{"MaXrd`Private`atomdata", ",", 
                    "\"OccupationFactor\"", ",", "1.`"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`type", "=", 
                    RowBox[{"Lookup", "[", 
                    
                    RowBox[{"MaXrd`Private`atomdata", ",", "\"Type\"", ",", 
                    "\"Uiso\""}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`cvecs", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Quiet", "[", 
                    RowBox[{"InputCheck", "[", 
                    
                    RowBox[{"\"GetCentringVectors\"", ",", 
                    "MaXrd`Private`crystal"}], "]"}], "]"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`siteSymMxyz", "=", 
                    RowBox[{"MaXrd`Private`cvecs", " ", 
                    RowBox[{"Length", "[", "MaXrd`Private`R", "]"}]}]}], ";", 
                    
                    RowBox[{"MaXrd`Private`elements", "=", 
                    
                    RowBox[{"MaXrd`Private`atomdata", "\[LeftDoubleBracket]", 
                    
                    RowBox[{"All", ",", "\"Element\""}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"TrueQ", "[", 
                    RowBox[{"OptionValue", "[", "\"IgnoreIonCharge\"", "]"}], 
                    "]"}], ",", 
                    RowBox[{"MaXrd`Private`elements", "=", 
                    RowBox[{"StringDelete", "[", 
                    RowBox[{"MaXrd`Private`elements", ",", 
                    RowBox[{"{", 
                    RowBox[{"DigitCharacter", ",", "\"+\"", ",", "\"-\""}], 
                    "}"}]}], "]"}]}]}], "]"}], ";", 
                    RowBox[{"MaXrd`Private`f", "=", 
                    RowBox[{"GetAtomicScatteringFactors", "[", 
                    
                    RowBox[{"MaXrd`Private`crystal", ",", "MaXrd`Private`hkl",
                     ",", "MaXrd`Private`\[Lambda]", ",", 
                    RowBox[{"\"SeparateCorrections\"", "\[Rule]", "False"}], 
                    ",", 
                    RowBox[{"FilterRules", "[", 
                    RowBox[{
                    RowBox[{"{", "MaXrd`Private`options", "}"}], ",", 
                    
                    RowBox[{"Options", "[", "GetAtomicScatteringFactors", 
                    "]"}]}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"AssociationQ", "[", "MaXrd`Private`f", "]"}], 
                    ",", 
                    RowBox[{"MaXrd`Private`f", "=", 
                    RowBox[{"{", "MaXrd`Private`f", "}"}]}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"First", "[", "MaXrd`Private`f", "]"}], "]"}], 
                    "]"}], "=!=", 
                    RowBox[{"Sort", "[", 
                    
                    RowBox[{"DeleteDuplicates", "[", "MaXrd`Private`elements",
                     "]"}], "]"}]}], ",", 
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"StructureFactor", "::", "ElementMismatch"}], 
                    "MessageName"], "]"}]}], "]"}], ";", 
                    RowBox[{"MaXrd`Private`d", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"N", "[", 
                    SqrtBox[
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"Diagonal", "[", "MaXrd`Private`H", "]"}], "]"}]],
                     "]"}], "]"}]}], ";", 
                    RowBox[{"MaXrd`Private`disp", "=", 
                    RowBox[{"Lookup", "[", 
                    
                    RowBox[{"MaXrd`Private`atomdata", ",", 
                    "\"DisplacementParameters\"", ",", "0.`"}], "]"}]}], ";", 
                    
                    RowBox[{"MaXrd`Private`U", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    
                    RowBox[{"MaXrd`Private`disp", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`i", "\[RightDoubleBracket]"}], "]"}], 
                    "\[Equal]", "6"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"MaXrd`Private`U", ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`disp", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`i", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    
                    RowBox[{"1", ",", "4", ",", "5", ",", "4", ",", "2", ",", 
                    "6", ",", "5", ",", "6", ",", "3"}], "}"}], 
                    "\[RightDoubleBracket]"}], ",", "3"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"MaXrd`Private`U", ",", 
                    
                    RowBox[{"MaXrd`Private`disp", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`i", "\[RightDoubleBracket]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"MaXrd`Private`i", ",", 
                    RowBox[{"Length", "[", "MaXrd`Private`disp", "]"}]}], 
                    "}"}]}], "]"}], ";", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "MaXrd`Private`atomdata", "]"}], 
                    ",", "\"SiteSymmetryOrder\""}], "]"}], ",", 
                    RowBox[{"MaXrd`Private`siteSymO", "=", 
                    
                    RowBox[{"MaXrd`Private`atomdata", "\[LeftDoubleBracket]", 
                    
                    RowBox[{"All", ",", "\"SiteSymmetryOrder\""}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "MaXrd`Private`atomdata", "]"}], 
                    ",", "\"SiteSymmetryMultiplicity\""}], "]"}], ",", 
                    RowBox[{"MaXrd`Private`siteSymO", "=", 
                    FractionBox["MaXrd`Private`siteSymMxyz", 
                    
                    RowBox[{"MaXrd`Private`atomdata", "\[LeftDoubleBracket]", 
                    
                    RowBox[{"All", ",", "\"SiteSymmetryMultiplicity\""}], 
                    "\[RightDoubleBracket]"}]]}], ",", "True", ",", 
                    RowBox[{"MaXrd`Private`siteSymO", "=", 
                    FractionBox["MaXrd`Private`siteSymMxyz", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"SymmetryEquivalentPositions", "[", 
                    RowBox[{"MaXrd`Private`crystal", ",", 
                    RowBox[{"MaXrd`Private`r", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`a", "\[RightDoubleBracket]"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"MaXrd`Private`a", ",", 
                    RowBox[{"Length", "[", "MaXrd`Private`r", "]"}]}], 
                    "}"}]}], "]"}]]}]}], "]"}], ";", 
                    RowBox[{"MaXrd`Private`sf", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", "MaXrd`Private`j", 
                    RowBox[{"Length", "[", "MaXrd`Private`atomdata", "]"}]], 
                    FractionBox[
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`occ", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], " ", 
                    "MaXrd`Private`cvecs", " ", "1.`", " ", 
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`f", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", 
                    
                    RowBox[{"MaXrd`Private`elements", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", "MaXrd`Private`s", 
                    RowBox[{"Length", "[", "MaXrd`Private`R", "]"}]], 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`type", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], "\[Equal]", 
                    "\"Uani\""}], ",", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SuperscriptBox["\[Pi]", "2"], " ", 
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`hkl", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}], ".", 
                    "MaXrd`Private`d", ".", 
                    
                    RowBox[{"MaXrd`Private`R", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`s", "\[RightDoubleBracket]"}], ".", 
                    
                    RowBox[{"MaXrd`Private`U", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], ".", 
                    RowBox[{"Transpose", "[", 
                    
                    RowBox[{"MaXrd`Private`R", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`s", "\[RightDoubleBracket]"}], "]"}], ".", 
                    "MaXrd`Private`d", ".", 
                    
                    RowBox[{"MaXrd`Private`hkl", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`type", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], "\[Equal]", 
                    "\"Uiso\""}], ",", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "8"}], " ", 
                    SuperscriptBox["\[Pi]", "2"], " ", 
                    
                    RowBox[{"MaXrd`Private`disp", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], " ", 
                    SuperscriptBox[
                    
                    RowBox[{"MaXrd`Private`sl", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}], "2"]}], 
                    "]"}], ",", 
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`type", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], "\[Equal]", 
                    "\"Bani\""}], ",", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", "4"]}], " ", 
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`hkl", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}], ".", 
                    "MaXrd`Private`d", ".", 
                    
                    RowBox[{"MaXrd`Private`R", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`s", "\[RightDoubleBracket]"}], ".", 
                    RowBox[{"MaXrd`Private`U", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], ".", 
                    RowBox[{"Transpose", "[", 
                    
                    RowBox[{"MaXrd`Private`R", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`s", "\[RightDoubleBracket]"}], "]"}], ".", 
                    "MaXrd`Private`d", ".", 
                    
                    RowBox[{"MaXrd`Private`hkl", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`type", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}], "\[Equal]", 
                    "\"Biso\""}], ",", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    
                    RowBox[{"MaXrd`Private`disp", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}]}], " ", 
                    SuperscriptBox[
                    
                    RowBox[{"MaXrd`Private`sl", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}], "2"]}], 
                    "]"}], ",", "True", ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    RowBox[{
                    StyleBox[
                    RowBox[{"$CrystalData", "::", "type"}], "MessageName"], 
                    ",", "MaXrd`Private`type"}], "]"}], ";", 
                    RowBox[{"Abort", "[", "]"}]}]}], "]"}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`hkl", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}], ".", 
                    
                    RowBox[{"MaXrd`Private`R", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`s", "\[RightDoubleBracket]"}], ".", 
                    
                    RowBox[{"MaXrd`Private`r", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`hkl", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`h", "\[RightDoubleBracket]"}], ".", 
                    
                    RowBox[{"MaXrd`Private`T", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`s", "\[RightDoubleBracket]"}]}]}], ")"}]}],
                     "]"}]}]}]}], 
                    
                    RowBox[{"MaXrd`Private`siteSymO", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`j", "\[RightDoubleBracket]"}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"MaXrd`Private`h", ",", "MaXrd`Private`L"}], 
                    "}"}]}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", "MaXrd`Private`abs"}], ",", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`SF", "=", "MaXrd`Private`sf"}], 
                    ";", 
                    RowBox[{"Goto", "[", "\"ComplexNumber\"", "]"}]}]}], 
                    "]"}], ";", 
                    RowBox[{"MaXrd`Private`SF", "=", 
                    RowBox[{
                    RowBox[{"Reap", "[", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MaXrd`Private`F", "=", 
                    
                    RowBox[{"MaXrd`Private`sf", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`i", "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], "]"}], "<", 
                    "MaXrd`Private`\[Delta]"}], ",", 
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], "\[Equal]", 
                    "0.`"}], "&&", 
                    RowBox[{
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], 
                    "\[GreaterEqual]", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`F", "=", "0"}], ";", 
                    RowBox[{"MaXrd`Private`\[Phi]", "=", "90"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], "\[Equal]", 
                    "0.`"}], "&&", 
                    RowBox[{
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], "<", "0"}]}],
                     ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"MaXrd`Private`sf", "\[LeftDoubleBracket]", 
                    "MaXrd`Private`i", "\[RightDoubleBracket]"}], "=", "0"}], 
                    ";", 
                    RowBox[{"MaXrd`Private`\[Phi]", "=", 
                    RowBox[{"-", "90"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], 
                    "\[GreaterEqual]", "0.`"}], "&&", 
                    RowBox[{
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], "\[Equal]", 
                    "0"}]}], ",", 
                    RowBox[{"MaXrd`Private`\[Phi]", "=", "90"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], "<", "0.`"}],
                     "&&", 
                    RowBox[{
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], "\[Equal]", 
                    "0"}]}], ",", 
                    RowBox[{"MaXrd`Private`\[Phi]", "=", "180"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], ">", "0.`"}],
                     "&&", 
                    RowBox[{
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], ">", "0"}]}],
                     ",", 
                    RowBox[{"MaXrd`Private`\[Phi]", "=", 
                    RowBox[{"N", "[", 
                    FractionBox[
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    FractionBox[
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], 
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}]], "]"}], 
                    "]"}], "\[Degree]"], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], ">", "0.`"}],
                     "&&", 
                    RowBox[{
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], "<", "0"}]}],
                     ",", 
                    RowBox[{"MaXrd`Private`\[Phi]", "=", 
                    RowBox[{"-", 
                    RowBox[{"N", "[", 
                    FractionBox[
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    FractionBox[
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], 
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}]], "]"}], 
                    "]"}], "\[Degree]"], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], "<", "0.`"}],
                     "&&", 
                    RowBox[{
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], ">", "0"}]}],
                     ",", 
                    RowBox[{"MaXrd`Private`\[Phi]", "=", 
                    RowBox[{"N", "[", 
                    FractionBox[
                    RowBox[{"\[Pi]", "-", 
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    FractionBox[
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], 
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}]], "]"}], 
                    "]"}]}], "\[Degree]"], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}], "<", "0.`"}],
                     "&&", 
                    RowBox[{
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], "<", "0"}]}],
                     ",", 
                    RowBox[{"MaXrd`Private`\[Phi]", "=", 
                    RowBox[{"N", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"ArcTan", "[", 
                    RowBox[{"Abs", "[", 
                    FractionBox[
                    RowBox[{"Im", "[", "MaXrd`Private`F", "]"}], 
                    RowBox[{"Re", "[", "MaXrd`Private`F", "]"}]], "]"}], 
                    "]"}], "-", "\[Pi]"}], "\[Degree]"], "]"}]}]}], "]"}], 
                    ";", 
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", 
                    RowBox[{"MaXrd`Private`F", ",", "MaXrd`Private`\[Phi]"}], 
                    "}"}], "]"}]}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"MaXrd`Private`i", ",", "MaXrd`Private`L"}], 
                    "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{"MaXrd`Private`unitsQ", ",", 
                    RowBox[{"MaXrd`Private`SF", "=", 
                    RowBox[{"MapAt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Quantity", "[", 
                    RowBox[{"#1", ",", "\"Degrees\""}], "]"}], "&"}], ",", 
                    "MaXrd`Private`SF", ",", 
                    RowBox[{"{", 
                    RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}]}], "]"}], ";", 
                    RowBox[{"MaXrd`Private`SF", "=", 
                    RowBox[{"MapAt", "[", 
                    RowBox[{"Abs", ",", "MaXrd`Private`SF", ",", 
                    RowBox[{"{", 
                    RowBox[{"All", ",", "1"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"Label", "[", "\"ComplexNumber\"", "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MaXrd`Private`L0", ">", "1"}], "&&", 
                    RowBox[{"!", "MaXrd`Private`ignoreExtinct"}]}], ",", 
                    RowBox[{"MaXrd`Private`SF", "=", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    
                    RowBox[{"MaXrd`Private`zerotype", ",", 
                    "MaXrd`Private`l"}], "]"}], ",", 
                    RowBox[{"Thread", "[", 
                    
                    RowBox[{"MaXrd`Private`hklPos", "\[Rule]", 
                    "MaXrd`Private`SF"}], "]"}]}], "]"}]}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MaXrd`Private`L0", "===", "1"}], ",", 
                    RowBox[{"First", "[", "MaXrd`Private`SF", "]"}], ",", 
                    "MaXrd`Private`SF"}], "]"}]}]}], "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", 
                    "paclet:StianRamsnes/MaXrd/ref/StructureFactor", 
                    "paclet:StianRamsnes/MaXrd/ref/StructureFactor", "Link", {
                    
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    
                    StyleBox["\<\" Default Definitions\"\>", 
                    "InformationRowLabel",
                    StripOnInput->False],
                    "\"DefaultValues\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "DefaultValues", "Tooltip"]& ], 
                   InterpretationBox[GridBox[{
                    {
                    RowBox[{
                    RowBox[{
                    "SyntaxInformation", "[", "StructureFactor", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"\<\"ArgumentsPattern\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_", ",", "_.", ",", 
                    RowBox[{"OptionsPattern", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "StructureFactor", ",", "GetAtomicScatteringFactors", ",",
                     "GetElements"}], "}"}], "]"}]}], "}"}]}], "}"}]}]},
                    {" "}
                    },
                    BaselinePosition->{Baseline, {1, 1}},
                    
                    GridBoxAlignment->{
                    "Columns" -> {{Left}}, "Rows" -> {{Baseline}}}],
                    
                    ColumnForm[{
                    SyntaxInformation[MaXrd`StructureFactor] = {
                    "ArgumentsPattern" -> {
                    Blank[], 
                    Blank[], 
                    Optional[
                    Blank[]], 
                    
                    OptionsPattern[{
                    MaXrd`StructureFactor, MaXrd`GetAtomicScatteringFactors, 
                    MaXrd`GetElements}]}}, 
                    SpaceForm[1]}],
                    Editable->False]},
                  {
                   PaneSelectorBox[{True->
                    ButtonBox[
                    PaneSelectorBox[{False->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "DownPointerOpener"]]},
                    "RowWithSeparators"], True->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "DownPointerOpenerHot"]]},
                    "RowWithSeparators"]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    FrameMargins->0,
                    ImageSize->Automatic],
                    Appearance->None,
                    BaseStyle->None,
                    
                    ButtonFunction:>(Part[System`InformationDump`open$$, 3] = 
                    False),
                    Evaluator->Automatic,
                    FrameMargins->0,
                    ImageMargins->0,
                    Method->"Preemptive"], False->
                    ButtonBox[
                    PaneSelectorBox[{False->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "RightPointerOpener"]]},
                    "RowWithSeparators"], True->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "RightPointerOpenerHot"]]},
                    "RowWithSeparators"]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    FrameMargins->0,
                    ImageSize->Automatic],
                    Appearance->None,
                    BaseStyle->None,
                    
                    ButtonFunction:>(Part[System`InformationDump`open$$, 3] = 
                    True),
                    Evaluator->Automatic,
                    FrameMargins->0,
                    ImageMargins->0,
                    Method->"Preemptive"]}, Dynamic[
                    FEPrivate`Part[System`InformationDump`open$$, 3]]], 
                   PaneSelectorBox[{True->GridBox[{
                    {
                    RowBox[{"\<\"AbsoluteValue\"\>", "\[Rule]", "True"}]},
                    {
                    
                    RowBox[{"\<\"DispersionCorrections\"\>", "\[Rule]", 
                    "True"}]},
                    {
                    
                    RowBox[{"\<\"f0Source\"\>", 
                    "\[Rule]", "\<\"WaasmaierKirfel\"\>"}]},
                    {
                    
                    RowBox[{"\<\"f1f2Source\"\>", 
                    "\[Rule]", "\<\"CromerLiberman\"\>"}]},
                    {
                    RowBox[{"\<\"IgnoreIonCharge\"\>", "\[Rule]", "True"}]},
                    {
                    
                    RowBox[{"\<\"IgnoreSystematicAbsence\"\>", "\[Rule]", 
                    "False"}]},
                    {
                    
                    RowBox[{"\<\"SeparateCorrections\"\>", "\[Rule]", 
                    "False"}]},
                    {
                    RowBox[{"\<\"Tally\"\>", "\[Rule]", "False"}]},
                    {
                    RowBox[{"\<\"Threshold\"\>", "\[Rule]", "1.`*^-6"}]},
                    {
                    RowBox[{"\<\"Units\"\>", "\[Rule]", "True"}]},
                    {
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[InvisibleSpace]\"", "10", "\" total)\""},
                    "RowDefault"], "InformationRowOpener",
                    StripOnInput->False]}
                    },
                    BaselinePosition->{Baseline, {1, 1}},
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{1.}}}], False->
                    RowBox[{
                    RowBox[{"\<\"AbsoluteValue\"\>", "\[Rule]", "True"}], 
                    "\[ThinSpace]", 
                    StyleBox["\<\"\[Ellipsis]\"\>", "InformationRowOpener",
                    StripOnInput->False], "\[ThinSpace]", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[InvisibleSpace]\"", "10", "\" total)\""},
                    "RowDefault"], "InformationRowOpener",
                    StripOnInput->False]}]}, Dynamic[
                    FEPrivate`Part[System`InformationDump`open$$, 3]],
                    BaselinePosition->Baseline,
                    ImageSize->Automatic]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"MaXrd`StructureFactor\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{13., {4., 9.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{13., {4., 9.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:StianRamsnes/MaXrd/ref/StructureFactor",
              ButtonNote->"paclet:StianRamsnes/MaXrd/ref/StructureFactor"],
             "\"paclet:MaXrd/ref/StructureFactor\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"StructureFactor\\\", \
\\\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"h\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"k\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"l\\\", \
\\\"TI\\\"]}], \\\"}\\\"}], \\\"]\\\"}]\\)\\!\\(\\*RowBox[{\\\" calculates \
the structure factor of the \\\", Cell[BoxData[StyleBox[\\\"hkl\\\", \\\"TI\\\
\"]], \\\"InlineFormula\\\"], \\\" reflection for \\\", \
Cell[BoxData[StyleBox[\\\"crystal\\\", \\\"TI\\\"]], \\\"InlineFormula\\\"], \
\\\" at wavelength stored in \\\", Cell[BoxData[\\\"$CrystalData\\\"], \
\\\"InlineFormula\\\"], \\\".\\\"}]\\)\\n\\!\\(\\*RowBox[{\\\"StructureFactor\
\\\", \\\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{StyleBox[\\\"h\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"k\\\
\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"l\\\", \\\"TI\\\"]}], \\\"}\\\"}], \
\\\",\\\", StyleBox[\\\"\[Lambda]\\\", \\\"TR\\\"], \
\\\"]\\\"}]\\)\\!\\(\\*RowBox[{\\\" calculates the structure factor of the \\\
\", Cell[BoxData[StyleBox[\\\"hkl\\\", \\\"TI\\\"]], \\\"InlineFormula\\\"], \
\\\" reflection for \\\", Cell[BoxData[StyleBox[\\\"crystal\\\", \
\\\"TI\\\"]], \\\"InlineFormula\\\"], \\\" at wavelength \\\", \
Cell[BoxData[StyleBox[\\\"\[Lambda]\\\", \\\"TR\\\"]], \
\\\"InlineFormula\\\"], \\\".\\\"}]\\)\\n\\!\\(\\*RowBox[{\\\"StructureFactor\
\\\", \\\"[\\\", StyleBox[\\\"crystal\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"h\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"k\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"l\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"h\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"k\\\", \
\\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"l\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]]}], \\\"}\\\"}], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \
\\\"TR\\\"]}], \\\"}\\\"}], \\\",\\\", StyleBox[\\\"\[Lambda]\\\", \
\\\"TR\\\"], \\\"]\\\"}]\\)\\!\\(\\*RowBox[{\\\" calculates the structure \
factor of the \\\", Cell[BoxData[SubscriptBox[StyleBox[\\\"hkl\\\", \
\\\"TI\\\"], StyleBox[\\\"i\\\", \\\"TI\\\"]]], \\\"InlineFormula\\\"], \\\" \
reflections for \\\", Cell[BoxData[StyleBox[\\\"crystal\\\", \\\"TI\\\"]], \\\
\"InlineFormula\\\"], \\\" at wavelength \\\", Cell[BoxData[StyleBox[\\\"\
\[Lambda]\\\", \\\"TR\\\"]], \\\"InlineFormula\\\"], \\\".\\\"}]\\)\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {2., 8.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {2., 8.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"StructureFactor\", \"[\", StyleBox[\"crystal\", \"TI\"], \
\",\", RowBox[{\"{\", RowBox[{StyleBox[\"h\", \"TI\"], \",\", StyleBox[\"k\", \
\"TI\"], \",\", StyleBox[\"l\", \"TI\"]}], \"}\"}], \"]\"}]\)\!\(\*RowBox[{\" \
calculates the structure factor of the \", Cell[BoxData[StyleBox[\"hkl\", \
\"TI\"]], \"InlineFormula\"], \" reflection for \", \
Cell[BoxData[StyleBox[\"crystal\", \"TI\"]], \"InlineFormula\"], \" at \
wavelength stored in \", Cell[BoxData[\"$CrystalData\"], \"InlineFormula\"], \
\".\"}]\)\n\!\(\*RowBox[{\"StructureFactor\", \"[\", StyleBox[\"crystal\", \
\"TI\"], \",\", RowBox[{\"{\", RowBox[{StyleBox[\"h\", \"TI\"], \",\", \
StyleBox[\"k\", \"TI\"], \",\", StyleBox[\"l\", \"TI\"]}], \"}\"}], \",\", \
StyleBox[\"\[Lambda]\", \"TR\"], \"]\"}]\)\!\(\*RowBox[{\" calculates the \
structure factor of the \", Cell[BoxData[StyleBox[\"hkl\", \"TI\"]], \
\"InlineFormula\"], \" reflection for \", Cell[BoxData[StyleBox[\"crystal\", \
\"TI\"]], \"InlineFormula\"], \" at wavelength \", Cell[BoxData[StyleBox[\"\
\[Lambda]\", \"TR\"]], \"InlineFormula\"], \".\"}]\)\n\
\!\(\*RowBox[{\"StructureFactor\", \"[\", StyleBox[\"crystal\", \"TI\"], \
\",\", RowBox[{\"{\", RowBox[{RowBox[{\"{\", \
RowBox[{SubscriptBox[StyleBox[\"h\", \"TI\"], StyleBox[\"1\", \"TR\"]], \
\",\", SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"1\", \"TR\"]], \",\", \
SubscriptBox[StyleBox[\"l\", \"TI\"], StyleBox[\"1\", \"TR\"]]}], \"}\"}], \
\",\", RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"h\", \"TI\"], StyleBox[\
\"2\", \"TR\"]], \",\", SubscriptBox[StyleBox[\"k\", \"TI\"], StyleBox[\"2\", \
\"TR\"]], \",\", SubscriptBox[StyleBox[\"l\", \"TI\"], StyleBox[\"2\", \
\"TR\"]]}], \"}\"}], \",\", StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"}\"}], \",\
\", StyleBox[\"\[Lambda]\", \"TR\"], \"]\"}]\)\!\(\*RowBox[{\" calculates the \
structure factor of the \", Cell[BoxData[SubscriptBox[StyleBox[\"hkl\", \
\"TI\"], StyleBox[\"i\", \"TI\"]]], \"InlineFormula\"], \" reflections for \
\", Cell[BoxData[StyleBox[\"crystal\", \"TI\"]], \"InlineFormula\"], \" at \
wavelength \", Cell[BoxData[StyleBox[\"\[Lambda]\", \"TR\"]], \"InlineFormula\
\"], \".\"}]\)", 
    "Documentation" -> <|
     "Local" -> "paclet:StianRamsnes/MaXrd/ref/StructureFactor"|>, 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> 
    Information`InformationValueForm[
     DownValues, MaXrd`StructureFactor, {MaXrd`StructureFactor[
         Pattern[MaXrd`Private`crystal, 
          Blank[String]], 
         Pattern[MaXrd`Private`hklInput, 
          Blank[List]], 
         Optional[
          Pattern[MaXrd`Private`lambda, 
           PatternTest[
            Blank[], Or[
             NumericQ[#], 
             QuantityQ[#]]& ]], -1], 
         Pattern[MaXrd`Private`options, 
          
          OptionsPattern[{
           MaXrd`StructureFactor, MaXrd`GetAtomicScatteringFactors, 
            MaXrd`GetElements}]]] :> 
       Block[{MaXrd`Private`data, MaXrd`Private`\[Lambda], MaXrd`Private`abs = 
          TrueQ[
            OptionValue["AbsoluteValue"]], MaXrd`Private`ignoreExtinct = TrueQ[
            OptionValue["IgnoreSystematicAbsence"]], MaXrd`Private`unitsQ = 
          TrueQ[
            OptionValue["Units"]], MaXrd`Private`\[Delta] = 
          OptionValue["Threshold"], MaXrd`Private`hkl, MaXrd`Private`L0, 
          MaXrd`Private`L, MaXrd`Private`zerotype, MaXrd`Private`absence, 
          MaXrd`Private`l, MaXrd`Private`hklPos, MaXrd`Private`j, 
          MaXrd`Private`H, MaXrd`Private`d, MaXrd`Private`sl, MaXrd`Private`f,
           MaXrd`Private`atomdata, MaXrd`Private`r, MaXrd`Private`type, 
          MaXrd`Private`disp, MaXrd`Private`U, MaXrd`Private`R, 
          MaXrd`Private`T, MaXrd`Private`cvecs, MaXrd`Private`occ, 
          MaXrd`Private`elements, MaXrd`Private`siteSymMxyz, 
          MaXrd`Private`siteSymO, MaXrd`Private`sf, MaXrd`Private`SF, 
          MaXrd`Private`F, MaXrd`Private`\[Phi]}, 
         MaXrd`InputCheck["CrystalQ", MaXrd`Private`crystal, False]; 
         MaXrd`Private`\[Lambda] = 
          MaXrd`InputCheck[
           "ProcessWavelength", MaXrd`Private`crystal, MaXrd`Private`lambda]; 
         MaXrd`Private`data = MaXrd`$CrystalData[MaXrd`Private`crystal]; If[
           Not[
            NumericQ[MaXrd`Private`\[Delta]]], Message[
             MessageName[MaXrd`StructureFactor, "InvalidThreshold"], 
             MaXrd`Private`\[Delta]]; Abort[]]; 
         MaXrd`Private`hkl = 
          MaXrd`InputCheck[MaXrd`Private`hklInput, "Integer", "WrapSingle"]; 
         MaXrd`Private`L0 = Length[MaXrd`Private`hkl]; If[
           Not[MaXrd`Private`ignoreExtinct], 
           MaXrd`Private`zerotype = If[MaXrd`Private`abs, 
              If[MaXrd`Private`unitsQ, {0, 
                Quantity[0, "Degrees"]}, {0, 0}], 0]; 
           MaXrd`Private`absence = 
            MaXrd`SystematicAbsentQ[MaXrd`Private`crystal, MaXrd`Private`hkl]; 
           MaXrd`Private`l = Length[MaXrd`Private`absence]; 
           MaXrd`Private`hkl = 
            Pick[MaXrd`Private`hkl, MaXrd`Private`absence, False]; 
           MaXrd`Private`hklPos = Position[MaXrd`Private`absence, False]; If[
             AllTrue[
              Flatten[MaXrd`Private`absence], TrueQ], 
             If[MaXrd`Private`l === 1, 
              Return[MaXrd`Private`zerotype], 
              Return[
               ConstantArray[MaXrd`Private`zerotype, MaXrd`Private`l]]]]]; 
         MaXrd`Private`L = Length[MaXrd`Private`hkl]; MaXrd`Private`H = Chop[
            N[
             MaXrd`GetCrystalMetric[
             MaXrd`Private`crystal, "Space" -> "Reciprocal"]]]; 
         MaXrd`Private`sl = Map[N[Sqrt[
               Dot[#, MaXrd`Private`H, #]]/2]& , MaXrd`Private`hkl]; 
         MaXrd`Private`atomdata = MaXrd`Private`data["AtomData"]; 
         MaXrd`Private`r = 
          Part[MaXrd`Private`atomdata, All, "FractionalCoordinates"]; {
           MaXrd`Private`R, MaXrd`Private`T} = Transpose[
            MaXrd`GetSymmetryOperations[
            MaXrd`Private`crystal, "AugmentedMatrix" -> False]]; 
         MaXrd`Private`occ = 
          Lookup[MaXrd`Private`atomdata, "OccupationFactor", 1.]; 
         MaXrd`Private`type = Lookup[MaXrd`Private`atomdata, "Type", "Uiso"]; 
         MaXrd`Private`cvecs = Length[
            Quiet[
             MaXrd`InputCheck["GetCentringVectors", MaXrd`Private`crystal]]]; 
         MaXrd`Private`siteSymMxyz = 
          MaXrd`Private`cvecs Length[MaXrd`Private`R]; 
         MaXrd`Private`elements = 
          Part[MaXrd`Private`atomdata, All, "Element"]; If[
           TrueQ[
            OptionValue["IgnoreIonCharge"]], MaXrd`Private`elements = 
           StringDelete[MaXrd`Private`elements, {DigitCharacter, "+", "-"}]]; 
         MaXrd`Private`f = 
          MaXrd`GetAtomicScatteringFactors[
           MaXrd`Private`crystal, MaXrd`Private`hkl, MaXrd`Private`\[Lambda], 
            "SeparateCorrections" -> False, 
            FilterRules[{MaXrd`Private`options}, 
             Options[MaXrd`GetAtomicScatteringFactors]]]; If[
           AssociationQ[MaXrd`Private`f], 
           MaXrd`Private`f = {MaXrd`Private`f}]; If[Sort[
             Keys[
              First[MaXrd`Private`f]]] =!= Sort[
             DeleteDuplicates[MaXrd`Private`elements]], 
           Message[
            MessageName[MaXrd`StructureFactor, "ElementMismatch"]]]; 
         MaXrd`Private`d = Chop[
            N[
             Sqrt[
              DiagonalMatrix[
               Diagonal[MaXrd`Private`H]]]]]; 
         MaXrd`Private`disp = 
          Lookup[MaXrd`Private`atomdata, "DisplacementParameters", 0.]; 
         MaXrd`Private`U = {}; Do[
           If[Length[
              Part[MaXrd`Private`disp, MaXrd`Private`i]] == 6, 
            AppendTo[MaXrd`Private`U, 
             Partition[
              Part[
               Part[MaXrd`Private`disp, MaXrd`Private`i], {1, 4, 5, 4, 2, 6, 
               5, 6, 3}], 3]], 
            AppendTo[MaXrd`Private`U, 
             Part[MaXrd`Private`disp, MaXrd`Private`i]]], {MaXrd`Private`i, 
            Length[MaXrd`Private`disp]}]; Which[
           KeyExistsQ[
            First[MaXrd`Private`atomdata], "SiteSymmetryOrder"], 
           MaXrd`Private`siteSymO = 
           Part[MaXrd`Private`atomdata, All, "SiteSymmetryOrder"], 
           KeyExistsQ[
            First[MaXrd`Private`atomdata], "SiteSymmetryMultiplicity"], 
           MaXrd`Private`siteSymO = 
           MaXrd`Private`siteSymMxyz/Part[
            MaXrd`Private`atomdata, All, "SiteSymmetryMultiplicity"], True, 
           MaXrd`Private`siteSymO = MaXrd`Private`siteSymMxyz/Table[
             Length[
              MaXrd`SymmetryEquivalentPositions[MaXrd`Private`crystal, 
               Part[MaXrd`Private`r, MaXrd`Private`a]]], {MaXrd`Private`a, 
              Length[MaXrd`Private`r]}]]; MaXrd`Private`sf = Table[
            Sum[
            1 Part[MaXrd`Private`occ, MaXrd`Private`j] 
             MaXrd`Private`cvecs (1./Part[
              MaXrd`Private`siteSymO, MaXrd`Private`j]) Part[
               Part[MaXrd`Private`f, MaXrd`Private`h], 
               Part[MaXrd`Private`elements, MaXrd`Private`j]] 
             Sum[Which[Part[MaXrd`Private`type, MaXrd`Private`j] == "Uani", 
                 Exp[(-2) Pi^2 Dot[
                    Part[MaXrd`Private`hkl, MaXrd`Private`h], MaXrd`Private`d, 
                    Part[MaXrd`Private`R, MaXrd`Private`s], 
                    Part[MaXrd`Private`U, MaXrd`Private`j], 
                    Transpose[
                    Part[MaXrd`Private`R, MaXrd`Private`s]], MaXrd`Private`d, 
                    
                    Part[MaXrd`Private`hkl, MaXrd`Private`h]]], 
                 Part[MaXrd`Private`type, MaXrd`Private`j] == "Uiso", 
                 
                 Exp[(-8) Pi^2 Part[MaXrd`Private`disp, MaXrd`Private`j] 
                  Part[MaXrd`Private`sl, MaXrd`Private`h]^2], 
                 Part[MaXrd`Private`type, MaXrd`Private`j] == "Bani", 
                 Exp[((-1)/4) Dot[
                    Part[MaXrd`Private`hkl, MaXrd`Private`h], MaXrd`Private`d, 
                    Part[MaXrd`Private`R, MaXrd`Private`s], 
                    Part[MaXrd`Private`U, MaXrd`Private`j], 
                    Transpose[
                    Part[MaXrd`Private`R, MaXrd`Private`s]], MaXrd`Private`d, 
                    
                    Part[MaXrd`Private`hkl, MaXrd`Private`h]]], 
                 Part[MaXrd`Private`type, MaXrd`Private`j] == "Biso", 
                 
                 Exp[(-Part[MaXrd`Private`disp, MaXrd`Private`j]) 
                  Part[MaXrd`Private`sl, MaXrd`Private`h]^2], True, Message[
                   MessageName[MaXrd`$CrystalData, "type"], 
                   MaXrd`Private`type]; Abort[]] Exp[2 Pi I (Dot[
                    Part[MaXrd`Private`hkl, MaXrd`Private`h], 
                    Part[MaXrd`Private`R, MaXrd`Private`s], 
                    Part[MaXrd`Private`r, MaXrd`Private`j]] + Dot[
                    Part[MaXrd`Private`hkl, MaXrd`Private`h], 
                    Part[MaXrd`Private`T, MaXrd`Private`s]])], {
               MaXrd`Private`s, 
                Length[MaXrd`Private`R]}], {MaXrd`Private`j, 
              Length[MaXrd`Private`atomdata]}], {
            MaXrd`Private`h, MaXrd`Private`L}]; If[
           Not[MaXrd`Private`abs], MaXrd`Private`SF = MaXrd`Private`sf; 
           Goto["ComplexNumber"]]; MaXrd`Private`SF = Part[
            Reap[
             Do[
             MaXrd`Private`F = Part[MaXrd`Private`sf, MaXrd`Private`i]; If[Abs[
                  Re[MaXrd`Private`F]] < MaXrd`Private`\[Delta], 
                Sow[{0, 0}], Which[
                  And[Re[MaXrd`Private`F] == 0., Im[MaXrd`Private`F] >= 0], 
                  MaXrd`Private`F = 0; MaXrd`Private`\[Phi] = 90, 
                  And[Re[MaXrd`Private`F] == 0., Im[MaXrd`Private`F] < 0], 
                  Part[MaXrd`Private`sf, MaXrd`Private`i] = 0; 
                  MaXrd`Private`\[Phi] = -90, 
                  And[Re[MaXrd`Private`F] >= 0., Im[MaXrd`Private`F] == 0], 
                  MaXrd`Private`\[Phi] = 90, 
                  And[Re[MaXrd`Private`F] < 0., Im[MaXrd`Private`F] == 0], 
                  MaXrd`Private`\[Phi] = 180, 
                  And[Re[MaXrd`Private`F] > 0., Im[MaXrd`Private`F] > 0], 
                  MaXrd`Private`\[Phi] = N[ArcTan[
                    Abs[Im[MaXrd`Private`F]/Re[MaXrd`Private`F]]]/Degree], 
                  And[Re[MaXrd`Private`F] > 0., Im[MaXrd`Private`F] < 0], 
                  MaXrd`Private`\[Phi] = -N[ArcTan[
                    Abs[Im[MaXrd`Private`F]/Re[MaXrd`Private`F]]]/Degree], 
                  And[Re[MaXrd`Private`F] < 0., Im[MaXrd`Private`F] > 0], 
                  MaXrd`Private`\[Phi] = N[(Pi - ArcTan[
                    Abs[Im[MaXrd`Private`F]/Re[MaXrd`Private`F]]])/Degree], 
                  And[Re[MaXrd`Private`F] < 0., Im[MaXrd`Private`F] < 0], 
                  MaXrd`Private`\[Phi] = N[(ArcTan[
                    Abs[Im[MaXrd`Private`F]/Re[MaXrd`Private`F]]] - Pi)/
                    Degree]]; Sow[{MaXrd`Private`F, MaXrd`Private`\[Phi]}]], {
              MaXrd`Private`i, MaXrd`Private`L}]], 2, 1]; 
         If[MaXrd`Private`unitsQ, MaXrd`Private`SF = 
           MapAt[Quantity[#, "Degrees"]& , MaXrd`Private`SF, {All, 2}]]; 
         MaXrd`Private`SF = MapAt[Abs, MaXrd`Private`SF, {All, 1}]; 
         Label["ComplexNumber"]; If[
           And[MaXrd`Private`L0 > 1, 
            Not[MaXrd`Private`ignoreExtinct]], MaXrd`Private`SF = 
           ReplacePart[
             ConstantArray[MaXrd`Private`zerotype, MaXrd`Private`l], 
             Thread[MaXrd`Private`hklPos -> MaXrd`Private`SF]]]; 
         If[MaXrd`Private`L0 === 1, 
           First[MaXrd`Private`SF], MaXrd`Private`SF]]}], "SubValues" -> None,
     "DefaultValues" -> 
    Information`InformationValueForm[
     DefaultValues, MaXrd`StructureFactor, {
      SyntaxInformation[MaXrd`StructureFactor] -> {"ArgumentsPattern" -> {
           Blank[], 
           Blank[], 
           Optional[
            Blank[]], 
           
           OptionsPattern[{
            MaXrd`StructureFactor, MaXrd`GetAtomicScatteringFactors, 
             MaXrd`GetElements}]}}}], "NValues" -> None, "FormatValues" -> 
    None, "Options" -> {
     "AbsoluteValue" -> True, "DispersionCorrections" -> True, "f0Source" -> 
      "WaasmaierKirfel", "f1f2Source" -> "CromerLiberman", "IgnoreIonCharge" -> 
      True, "IgnoreSystematicAbsence" -> False, "SeparateCorrections" -> 
      False, "Tally" -> False, "Threshold" -> 1.*^-6, "Units" -> True}, 
    "Attributes" -> {}, "FullName" -> "MaXrd`StructureFactor"|>, 
   False]]], "Output",
 CellChangeTimes->{3.8616054537383213`*^9},
 CellLabel->"Out[10]=",
 CellID->866008397]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Note that the crystal name/label is required and a list of one or more \
reflections. The wavelength is necessary if not already contained in along \
with the crystal in ",
 Cell[BoxData[
  ButtonBox["$CrystalData",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/$CrystalData"]], 
  "InlineFormula"],
 ".\[LineSeparator]",
 Cell[BoxData[
  ButtonBox["StructureFactor",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/StructureFactor"]], 
  "InlineFormula"],
 " incorporates several other functions in the package, see the graph below."
}], "Text",
 CellChangeTimes->{{3.741931823089464*^9, 3.7419318244193974`*^9}, {
   3.7419318600431547`*^9, 3.74193193003041*^9}, 3.741932475559132*^9, {
   3.741933623878502*^9, 3.741933647434639*^9}, {3.741935856726613*^9, 
   3.741935874652667*^9}},
 CellID->1528333037],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RelatedFunctionsGraph", "[", "StructureFactor", "]"}]], "Input",
 CellChangeTimes->{3.753068224352919*^9},
 CellLabel->"In[11]:=",
 CellID->1692304135],

Cell[BoxData[
 GraphicsBox[{
   {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.9279265779063545, 1.1868626407536595`}, {
      1.3918898668595316`, 0.8168642643951433}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.6704463777117861, 1.7215257856514097`}, {0.9279265779063545,
       1.1868626407536595`}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.6704463777117861, 1.7215257856514097`}, {
      1.3918898668595316`, 0.8168642643951433}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.3493738197080689, 1.3189135324028407`}, {0.9279265779063545,
       1.1868626407536595`}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.3493738197080689, 1.3189135324028407`}, {
      1.3918898668595316`, 0.8168642643951433}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0., 0.4468658880366273}, {1.3918898668595316`, 
      0.8168642643951433}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{0.9279265779063542, 0.}, {1.3918898668595316`, 
      0.8168642643951433}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{1.8558531558127087`, 0.44686588803662697`}, {
      1.3918898668595316`, 0.8168642643951433}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{2.0850320943029255`, 1.4509644240520212`}, {
      1.3918898668595316`, 0.8168642643951433}}]}, 
    {Arrowheads[{{Automatic, 0.5}}], 
     ArrowBox[{{1.4428869782954918`, 2.2561889305491594`}, {
      1.3918898668595316`, 0.8168642643951433}}]}}, 
   {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{0.40792657790635445, 1.1368626407536595}, \
{1.4479265779063546, 1.2368626407536596}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"GetAtomicScatteringFactors\"", 
          "paclet:StianRamsnes/MaXrd/ref/GetAtomicScatteringFactors"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0.9279265779063545, 1.1868626407536595}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{1.0918898668595316, 0.7668642643951432}, \
{1.6918898668595317, 0.8668642643951433}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"StructureFactor\"", 
          "paclet:StianRamsnes/MaXrd/ref/StructureFactor"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {1.3918898668595316, 0.8168642643951433}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{0.35044637771178605, 1.6715257856514096}, \
{0.990446377711786, 1.7715257856514097}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"GetCrystalMetric\"", 
          "paclet:StianRamsnes/MaXrd/ref/GetCrystalMetric"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0.6704463777117861, 1.7215257856514097}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{0.1293738197080689, 1.2689135324028407}, \
{0.5693738197080689, 1.3689135324028407}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"GetElements\"", "paclet:StianRamsnes/MaXrd/ref/GetElements"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0.3493738197080689, 1.3189135324028407}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{-0.42, 0.3968658880366273}, {0.42, 0.4968658880366273}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"GetSymmetryOperations\"", 
          "paclet:StianRamsnes/MaXrd/ref/GetSymmetryOperations"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0., 0.4468658880366273}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{0.7279265779063542, -0.05}, {1.1279265779063543, 0.05}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"InputCheck\"", "paclet:StianRamsnes/MaXrd/ref/InputCheck"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {0.9279265779063542, 0.}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{1.3158531558127087, 0.396865888036627}, \
{2.3958531558127087, 0.49686588803662696}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"SymmetryEquivalentPositions\"", 
          "paclet:StianRamsnes/MaXrd/ref/SymmetryEquivalentPositions"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {1.8558531558127087, 0.44686588803662697}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{1.7450320943029254, 1.4009644240520212}, \
{2.4250320943029253, 1.5009644240520212}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"SystematicAbsentQ\"", 
          "paclet:StianRamsnes/MaXrd/ref/SystematicAbsentQ"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {2.0850320943029255, 1.4509644240520212}]}}, 
    {GrayLevel[1], EdgeForm[None], 
     RectangleBox[{1.2028869782954918, 2.2061889305491595}, \
{1.6828869782954918, 2.306188930549159}], 
     {GrayLevel[0], InsetBox[
       StyleBox[
        TemplateBox[{
         "\"$CrystalData\"", "paclet:StianRamsnes/MaXrd/ref/$CrystalData"},
         "HyperlinkPaclet"], "Program",
        StripOnInput->False,
        FontSize->11], {1.4428869782954918, 2.2561889305491594}]}}}},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->Large]], "Output",
 CellChangeTimes->{3.753068225374144*^9, 3.861605456080708*^9},
 CellLabel->"Out[11]=",
 CellID->1801286190]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["There are also some options available:", "Text",
 CellChangeTimes->{{3.741935887601994*^9, 3.741935894948152*^9}},
 CellID->877098777],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Options", "@", "StructureFactor"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.741935898509453*^9, 3.7419359086727324`*^9}},
 CellLabel->"In[12]:=",
 CellID->1746312217],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"\<\"AbsoluteValue\"\>", "\[Rule]", "True"}]},
     {
      RowBox[{"\<\"DispersionCorrections\"\>", "\[Rule]", "True"}]},
     {
      RowBox[{"\<\"f0Source\"\>", "\[Rule]", "\<\"WaasmaierKirfel\"\>"}]},
     {
      RowBox[{"\<\"f1f2Source\"\>", "\[Rule]", "\<\"CromerLiberman\"\>"}]},
     {
      RowBox[{"\<\"IgnoreIonCharge\"\>", "\[Rule]", "True"}]},
     {
      RowBox[{"\<\"IgnoreSystematicAbsence\"\>", "\[Rule]", "False"}]},
     {
      RowBox[{"\<\"SeparateCorrections\"\>", "\[Rule]", "False"}]},
     {
      RowBox[{"\<\"Tally\"\>", "\[Rule]", "False"}]},
     {
      RowBox[{"\<\"Threshold\"\>", "\[Rule]", "1.`*^-6"}]},
     {
      RowBox[{"\<\"Units\"\>", "\[Rule]", "True"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.741935903113173*^9, 3.741935908884864*^9}, 
   3.7419369101997423`*^9, 3.741948878254447*^9, 3.861605458824937*^9},
 CellLabel->"Out[12]//TableForm=",
 CellID->2062473013]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Details are found on the documentation page. Note the options for \
specifying which sources to use for obtaining the atomic scattering factor \
(",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", 
    RowBox[{
     SubscriptBox["f", "0"], "+", 
     SuperscriptBox["f", "\[Prime]"], "+", 
     SuperscriptBox["f", "\[DoublePrime]"]}]}], TraditionalForm]], 
  "InlineMath"],
 "). The available sources are located in:"
}], "Text",
 CellChangeTimes->{{3.741935922242051*^9, 3.7419359594826097`*^9}, {
  3.741936213839713*^9, 3.741936309288415*^9}},
 CellID->1850798272],

Cell[TextData[{
 StyleBox[" MaXrd \[FilledRightTriangle] ", "MenuNameDelimiter",
  FontWeight->"Plain"],
 StyleBox["Kernel", "MenuName",
  FontWeight->"Plain"],
 StyleBox[" \[FilledRightTriangle] Data \[FilledRightTriangle] \
AtomicScatteringFactor", "MenuNameDelimiter",
  FontWeight->"Plain"]
}], "Program",
 CellChangeTimes->{{3.717241210917871*^9, 3.717241235377129*^9}, {
   3.717241268011621*^9, 3.7172413198730288`*^9}, {3.741670277888546*^9, 
   3.741670278318912*^9}, {3.741936383958095*^9, 3.741936387171894*^9}, 
   3.743836301642315*^9, {3.8616053867241287`*^9, 3.861605388979622*^9}},
 CellID->312766054,ExpressionUUID->"378f3216-de60-451c-9ab3-bf951a1cd75f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Which in the current version include:", "Text",
 CellChangeTimes->{{3.741936409732799*^9, 3.741936427219261*^9}},
 CellID->1990630188],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FileBaseName", "/@", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.m\>\"", ",", 
     RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "$MaXrdPath", ",", "\"\<Kernel\>\"", ",", "\"\<Data\>\"", ",", 
        "\"\<AtomicScatteringFactor\>\""}], "}"}], "]"}]}], "]"}]}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.7419364312281923`*^9, 3.7419365222184353`*^9}, {
  3.861605467645233*^9, 3.861605468124558*^9}},
 CellLabel->"In[13]:=",
 CellID->976856059],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"CromerMann\"\>"},
     {"\<\"EPDL97\"\>"},
     {"\<\"InternationalTablesC(3rd)\"\>"},
     {"\<\"Kissel\"\>"},
     {"\<\"Kissel(modified)\"\>"},
     {"\<\"WaasmaierKirfel\"\>"},
     {"\<\"XOP(2.1)\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.741936481866343*^9, 3.741936523788534*^9}, 
   3.741936910274598*^9, 3.741948878352498*^9, {3.8616054685517187`*^9, 
   3.8616054845947733`*^9}},
 CellLabel->"Out[13]//TableForm=",
 CellID->539078196]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The sources for the anomalous corrections are contained in a subfolder:\
\>", "Text",
 CellChangeTimes->{{3.7419368010601788`*^9, 3.7419368265307007`*^9}},
 CellID->1636600781],

Cell[TextData[{
 StyleBox[" MaXrd \[FilledRightTriangle] ", "MenuNameDelimiter",
  FontWeight->"Plain"],
 StyleBox["Kernel", "MenuName",
  FontWeight->"Plain"],
 StyleBox[" \[FilledRightTriangle] Data \[FilledRightTriangle] \
AtomicScatteringFactor \[FilledRightTriangle] AnomalousCorrections", 
  "MenuNameDelimiter",
  FontWeight->"Plain"]
}], "Program",
 CellChangeTimes->{{3.717241210917871*^9, 3.717241235377129*^9}, {
   3.717241268011621*^9, 3.7172413198730288`*^9}, {3.741670277888546*^9, 
   3.741670278318912*^9}, {3.741936383958095*^9, 3.741936387171894*^9}, {
   3.7419368342480383`*^9, 3.741936844154361*^9}, 3.743836304362494*^9, {
   3.861605380931967*^9, 3.861605383619224*^9}},
 CellID->543910859],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FileBaseName", "/@", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.m\>\"", ",", 
     RowBox[{"FileNameJoin", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "$MaXrdPath", ",", "\"\<Kernel\>\"", ",", "\"\<Data\>\"", ",", 
        "\"\<AtomicScatteringFactor\>\"", ",", 
        "\"\<AnomalousCorrections\>\""}], "}"}], "]"}]}], "]"}]}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.7419364312281923`*^9, 3.7419365222184353`*^9}, {
  3.741936850931213*^9, 3.741936855074937*^9}, {3.861605489447565*^9, 
  3.861605489999217*^9}},
 CellLabel->"In[14]:=",
 CellID->198338952],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"BrennanCowan\"\>"},
     {"\<\"Chantler\"\>"},
     {"\<\"CromerLiberman\"\>"},
     {"\<\"EPDL97\"\>"},
     {"\<\"Henke\"\>"},
     {"\<\"Kissel\"\>"},
     {"\<\"Sasaki\"\>"},
     {"\<\"Windt\"\>"},
     {"\<\"xraylib\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.741936855544787*^9, 3.741936910353717*^9, 
  3.741948878422983*^9, 3.861605490995929*^9},
 CellLabel->"Out[14]//TableForm=",
 CellID->205053864]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Here are some quick demonstrations for the crystals gallium arsenide and \
germanium (the wavelength corresponds to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Cu", " ", 
    SubscriptBox["K\[Alpha]", "1"]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"1a23a9ea-5fb3-49d1-8f96-e66d1dc5a329"],
 " radiation):"
}], "Text",
 CellChangeTimes->{{3.741937104731235*^9, 3.741937110260497*^9}, {
   3.7419371724685793`*^9, 3.741937173266995*^9}, {3.741945688024642*^9, 
   3.7419457529988537`*^9}, 3.8916075731052513`*^9},
 CellID->1406177176,ExpressionUUID->"fb37fb62-2be3-4994-b232-cf79b29a4667"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureFactor", "[", 
  RowBox[{"\"\<GalliumArsenide\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2", ",", "2"}], "}"}], ",", "1.54059"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7419371185016823`*^9, 3.7419371418279963`*^9}, {
  3.741942793058494*^9, 3.741942800406742*^9}, {3.7419434294845533`*^9, 
  3.741943436113765*^9}, {3.741943474052101*^9, 3.7419435073920527`*^9}, {
  3.741945458050025*^9, 3.741945487948794*^9}, {3.741945734228076*^9, 
  3.741945734863656*^9}},
 CellLabel->"In[15]:=",
 CellID->611077196],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"119.82536818628529`", ",", 
   TemplateBox[{"3.012538249891987`", 
     RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
     "\"AngularDegrees\""},
    "QuantityPostfix"]}], "}"}]], "Output",
 CellChangeTimes->{{3.741937136777712*^9, 3.741937143320747*^9}, {
   3.741942795797414*^9, 3.741942800794832*^9}, 3.74194343670046*^9, {
   3.741943481415989*^9, 3.741943508205777*^9}, {3.7419454592615023`*^9, 
   3.741945488198825*^9}, 3.741948878742141*^9, 3.861605492849903*^9},
 CellLabel->"Out[15]=",
 CellID->2093917942]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureFactor", "[", 
  RowBox[{"\"\<Germanium\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", "1.54059"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7419371185016823`*^9, 3.7419371418279963`*^9}, {
   3.741942793058494*^9, 3.741942800406742*^9}, {3.7419434294845533`*^9, 
   3.741943436113765*^9}, {3.741943474052101*^9, 3.741943531368359*^9}, {
   3.741945651746931*^9, 3.741945670473023*^9}, 3.741945736088484*^9},
 CellLabel->"In[16]:=",
 CellID->282682384],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"114.92353919728603`", ",", 
   TemplateBox[{
     RowBox[{"-", "177.61843742945706`"}], 
     RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
     "\"AngularDegrees\""},
    "QuantityPostfix"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.741943531679908*^9, {3.741945652383597*^9, 3.7419456708569527`*^9}, 
   3.7419488790072727`*^9, 3.8616054936560383`*^9},
 CellLabel->"Out[16]=",
 CellID->461431739]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "By default, the modulus and phase are outputted in pairs: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[LeftBracketingBar]", 
      SubscriptBox["F", 
       StyleBox["hkl",
        FontSlant->"Italic"]], "\[RightBracketingBar]"}], ",", 
     SubscriptBox["\[Phi]", 
      StyleBox["hkl",
       FontSlant->"Italic"]]}], "}"}], TraditionalForm]], "InlineMath"],
 ". Complex numbers can be used instead:"
}], "Text",
 CellChangeTimes->{{3.741946160939883*^9, 3.7419461771899652`*^9}, {
  3.741946259372266*^9, 3.741946286558793*^9}, {3.741946317540674*^9, 
  3.74194645933569*^9}},
 CellID->1381000051],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StructureFactor", "[", 
  RowBox[{"\"\<Germanium\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", "1.54059", ",", 
   RowBox[{"\"\<AbsoluteValue\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7419464707375593`*^9, 3.7419464770801086`*^9}},
 CellLabel->"In[17]:=",
 CellID->929086703],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "114.82427441508716`"}], "-", 
  RowBox[{"4.775548835359466`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.74194647744506*^9, 3.74194887927322*^9, 
  3.861605494959403*^9},
 CellLabel->"Out[17]=",
 CellID->1756876728]
}, Open  ]]
}, Open  ]],

Cell["\<\
Please see the documentation page for more example of usage and elaboration \
on the options.\
\>", "Text",
 CellChangeTimes->{{3.74193688489545*^9, 3.741936903560773*^9}, {
  3.741937098464757*^9, 3.741937098844736*^9}, {3.741937155051461*^9, 
  3.741937163187463*^9}},
 CellID->1530327227]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unit cell transformation", "Section",
 CellID->624426137],

Cell[TextData[{
 "This package includes the function ",
 Cell[BoxData[
  ButtonBox["UnitCellTransformation",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/UnitCellTransformation"]], 
  "InlineFormula"],
 " that transforms entries in ",
 Cell[BoxData[
  ButtonBox["$CrystalData",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/$CrystalData"]], 
  "InlineFormula"],
 " among alternative settings of the same space group. In this example we \
will look at how the metric is transformed, and will be demonstrating this on \
the crystal ",
 StyleBox["ferrocene",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.716894877516829*^9, 3.716894938827297*^9}},
 CellID->472713516],

Cell[CellGroupData[{

Cell[TextData[{
 "First import the crystal data from a ",
 StyleBox[".cif", "InlineCode"],
 " file (in the package)"
}], "MathCaption",
 CellChangeTimes->{{3.741608543687393*^9, 3.741608567013418*^9}, {
  3.7416085993745337`*^9, 3.741608600540637*^9}},
 CellID->1154133361],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$MaXrdPath", ",", "\"\<Resources\>\"", ",", "\"\<ExampleFiles\>\"", 
      ",", "\"\<CIF\>\"", ",", "\"\<Ferrocene.cif\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ImportCrystalData", "[", "file", "]"}]}], "Input",
 CellChangeTimes->{{3.741608618973359*^9, 3.7416086812108097`*^9}, {
   3.861605508827552*^9, 3.861605514322545*^9}, 3.891607585515091*^9},
 CellLabel->"In[18]:=",
 CellID->971842639,ExpressionUUID->"20775527-5152-4ae0-80d4-a50a1254b08b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"ChemicalFormula\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SubscriptBox[\\(C\\), \
\\(10\\)]\\)\\!\\(\\*SubscriptBox[\\(H\\), \\(10\\)]\\)Fe\"\>"}], ",", 
   RowBox[{"\<\"FormulaUnits\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"SpaceGroup\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SubscriptBox[\\(P2\\), \\(1\\)]\\)/n\"\>"}], ",", 
   RowBox[{"\<\"LatticeParameters\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"a\"\>", "\[Rule]", 
       TemplateBox[{
        "5.9285`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"b\"\>", "\[Rule]", 
       TemplateBox[{
        "7.612`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"c\"\>", "\[Rule]", 
       TemplateBox[{
        "9.041`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"\[Alpha]\"\>", "\[Rule]", 
       TemplateBox[{"90", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}], ",", 
      RowBox[{"\<\"\[Beta]\"\>", "\[Rule]", 
       TemplateBox[{"93.156`", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}], ",", 
      RowBox[{"\<\"\[Gamma]\"\>", "\[Rule]", 
       TemplateBox[{"90", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"Wavelength\"\>", "\[Rule]", 
    TemplateBox[{
     "0.69804`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
      "\"Angstroms\""},
     "Quantity"]}], ",", 
   RowBox[{"\<\"AtomData\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[LeftSkeleton]", "11", "\[RightSkeleton]"}], "}"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.741608684236486*^9, 3.741608700512994*^9}, 
   3.741608825794424*^9, 3.861605516758531*^9},
 CellLabel->"Out[19]=",
 CellID->783870600]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Ferrocene has the monoclinic space group ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", " ", 
    RowBox[{
     SubscriptBox["2", "1"], "/", "n"}]}], TraditionalForm]], "InlineMath"],
 ":"
}], "MathCaption",
 CellID->1975173209],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$CrystalData", "[", 
  RowBox[{"\"\<Ferrocene\>\"", ",", "\"\<SpaceGroup\>\""}], "]"}]], "Input",
 CellLabel->"In[20]:=",
 CellID->933908337],

Cell[BoxData["\<\"\\!\\(\\*SubscriptBox[\\(P2\\), \\(1\\)]\\)/n\"\>"], \
"Output",
 CellChangeTimes->{3.716894944631514*^9, 3.716895075222859*^9, 
  3.741608704933556*^9, 3.74160882592164*^9, 3.8616055189893093`*^9},
 ImageSize->{38, 16},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[20]=",
 CellID->584575141]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "It is currently ",
 StyleBox["not",
  FontSlant->"Italic"],
 " in the standard setting (which is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", " ", 
    RowBox[{
     SubscriptBox["2", "1"], "/", "c"}]}], TraditionalForm]], "InlineMath"],
 "). Let us now look up the setting(s) specifying this particular space group."
}], "MathCaption",
 CellChangeTimes->{3.8616055220140247`*^9},
 CellID->2099042221],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "$GroupSymbolRedirect", "[", 
   "\"\<\!\(\*SubscriptBox[\(P2\), \(1\)]\)/n\>\"", "]"}], "[", 
  "\"\<Setting\>\"", "]"}]], "Input",
 CellLabel->"In[21]:=",
 CellID->1888739078],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"UniqueAxis\"\>", "\[Rule]", "\<\"b\"\>"}], ",", 
   RowBox[{"\<\"CellChoice\"\>", "\[Rule]", "2"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.7168950755072193`*^9, 3.741608713961096*^9, 
  3.74160882600797*^9, 3.8616055242750893`*^9},
 ImageSize->{235, 18},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[21]=",
 CellID->1637482004]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "There may be several attributes, such as cell origin, cell choice, axis \
permutation, centring and so forth. In this case, there are only two setting \
parameters to fiddle with. We see that the ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]], "InlineMath"],
 "-axis is the unique axis, which is the standard choice, but the cell choice \
is set to ",
 Cell[BoxData[
  FormBox["2", TraditionalForm]], "InlineMath"],
 " instead of ",
 Cell[BoxData[
  FormBox["1", TraditionalForm]], "InlineMath"],
 "."
}], "Text",
 CellID->1502558102],

Cell[TextData[{
 "Let us transform the cell so that the ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]], "InlineMath"],
 "-axis becomes the unique axis (the axis with a corresponding angle \
different from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"90", " ", "\[Degree]"}], TraditionalForm]], "InlineMath"],
 "). We can either use the ",
 StyleBox["International Tables for Crystallography, volume A",
  FontSlant->"Italic"],
 " or ",
 Cell[BoxData[
  ButtonBox["$TransformationMatrices",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/$TransformationMatrices"]], 
  "InlineFormula"],
 ":"
}], "Text",
 CellChangeTimes->{{3.716894952994507*^9, 3.716894961116996*^9}, {
   3.7171286513542547`*^9, 3.717128651945425*^9}, 3.86160552850921*^9},
 CellID->1233815241],

Cell[CellGroupData[{

Cell[TextData[{
 "The transformation matrix that changes unique axis ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]], "InlineMath"],
 " to ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]], "InlineMath"],
 ":"
}], "MathCaption",
 CellID->630660055],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{
   "$TransformationMatrices", "[", "\"\<UniqueAxisB_to_A\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[22]:=",
 CellID->1671746440],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1"},
     {"1", "0", "0"},
     {"0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.716895075633154*^9, 3.7416087204708023`*^9, 
  3.741608826119761*^9, 3.861605530683907*^9},
 ImageSize->{61, 48},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[23]//MatrixForm=",
 CellID->474569593]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "We need the current metric of the crystal, ",
 Cell[BoxData[
  FormBox["G", TraditionalForm]], "InlineMath"],
 ":"
}], "MathCaption",
 CellID->115561197],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"G", "=", 
  RowBox[{"GetCrystalMetric", "[", "\"\<Ferrocene\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.74160872477181*^9, 3.7416087287321377`*^9}},
 CellLabel->"In[24]:=",
 CellID->911821091],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"35.14711225`", ",", "0.`", ",", 
     RowBox[{"-", "2.950910369236803`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "57.942544`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.950910369236803`"}], ",", "0.`", ",", "81.739681`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.741608729381421*^9, 3.741608826199367*^9, 
  3.861605532187223*^9},
 CellLabel->"Out[24]=",
 CellID->478310719]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Transforming to the new metric, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["G", "2"], TraditionalForm]], "InlineMath"],
 ":"
}], "MathCaption",
 CellID->533771445],

Cell[BoxData[
 RowBox[{
  RowBox[{"G2", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "P", "]"}], ".", "G", ".", "P"}]}], 
  ";"}]], "Input",
 CellLabel->"In[25]:=",
 CellID->1057482596]
}, Open  ]],

Cell[CellGroupData[{

Cell["Notice how the lattice parameters have been permuted:", "MathCaption",
 CellChangeTimes->{3.717239948399618*^9},
 CellID->535328400],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"GetLatticeParameters", "[", "G", "]"}], "\[IndentingNewLine]", 
 RowBox[{"GetLatticeParameters", "[", "G2", "]"}]}], "Input",
 CellChangeTimes->{{3.741608818137925*^9, 3.7416088207859983`*^9}},
 CellLabel->"In[26]:=",
 CellID->1455421517],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5.9285`", ",", "7.612`", ",", "9.041`", ",", "90", ",", 
   "93.15600000000002`", ",", "90"}], "}"}]], "Output",
 CellChangeTimes->{3.7168950759395447`*^9, 3.74160882630509*^9, 
  3.861605534985765*^9},
 ImageSize->{357, 24},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[26]=",
 CellID->829483510],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "7.612`", ",", "9.041`", ",", "5.9285`", ",", "93.15600000000002`", ",", 
   "90", ",", "90"}], "}"}]], "Output",
 CellChangeTimes->{3.7168950759395447`*^9, 3.74160882630509*^9, 
  3.861605534986998*^9},
 ImageSize->{357, 24},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[27]=",
 CellID->1812999893]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "If we wanted to change the cell choice at the same time, we would simply \
multiply the two transformation matrices together to a form another matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "=", 
    RowBox[{
     SubscriptBox["P", "1"], 
     SubscriptBox["P", "2"]}]}], TraditionalForm]], "InlineMath"],
 " to be used in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "2"], "=", 
    RowBox[{
     SuperscriptBox["P", 
      StyleBox["T",
       FontSlant->"Plain"]], " ", "G", " ", "P"}]}], TraditionalForm]], 
  "InlineMath"],
 "."
}], "Text",
 CellID->606382873],

Cell[CellGroupData[{

Cell[TextData[{
 "We conclude this example with a demonstration of ",
 Cell[BoxData[
  ButtonBox["UnitCellTransformation",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/UnitCellTransformation"]], 
  "InlineFormula"],
 " that performs the same transformation of ferrocene as we did \
\[LeftGuillemet]manually\[RightGuillemet]:"
}], "Text",
 CellChangeTimes->{{3.716895012443166*^9, 3.7168950213846283`*^9}},
 CellID->1667041496],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UnitCellTransformation", "[", 
  RowBox[{"\"\<Ferrocene\>\"", ",", 
   RowBox[{"\"\<UniqueAxis\>\"", "\[Rule]", "\"\<a\>\""}]}], "]"}]], "Input",
 CellLabel->"In[28]:=",
 CellID->1894764510],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"ChemicalFormula\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SubscriptBox[\\(C\\), \
\\(10\\)]\\)\\!\\(\\*SubscriptBox[\\(H\\), \\(10\\)]\\)Fe\"\>"}], ",", 
   RowBox[{"\<\"FormulaUnits\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"SpaceGroup\"\>", "\[Rule]", "\<\"P 21/n 1 1\"\>"}], ",", 
   RowBox[{"\<\"LatticeParameters\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"a\"\>", "\[Rule]", 
       TemplateBox[{
        "7.612`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"b\"\>", "\[Rule]", 
       TemplateBox[{
        "9.041`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"c\"\>", "\[Rule]", 
       TemplateBox[{
        "5.9285`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"\[Alpha]\"\>", "\[Rule]", 
       TemplateBox[{"93.15600000000002`", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}], ",", 
      RowBox[{"\<\"\[Beta]\"\>", "\[Rule]", 
       TemplateBox[{"90", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}], ",", 
      RowBox[{"\<\"\[Gamma]\"\>", "\[Rule]", 
       TemplateBox[{"90", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"Wavelength\"\>", "\[Rule]", 
    TemplateBox[{
     "0.69804`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
      "\"Angstroms\""},
     "Quantity"]}], ",", 
   RowBox[{"\<\"AtomData\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[LeftSkeleton]", "11", "\[RightSkeleton]"}], "}"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7168950762658873`*^9, 3.741608826591785*^9, 
  3.861605541053296*^9},
 ImageSize->{545, 68},
 ImageMargins->{{0, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 CellLabel->"Out[28]=",
 CellID->622396093]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "You may notice how the new space group symbol is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", " ", 
    RowBox[{
     SubscriptBox["2", "1"], "\[NegativeThinSpace]", "/", "n"}], " ", "1", 
    " ", "1"}], TraditionalForm]], "InlineMath"],
 ". If the symbol is ambiguous, full Hermann\[Dash]Mauguin symbols are used \
for non-standard settings."
}], "Text",
 CellChangeTimes->{{3.741608839722631*^9, 3.7416088498255863`*^9}},
 CellID->1498020586],

Cell[TextData[{
 "The function ",
 Cell[BoxData[
  ButtonBox["UnitCellTransformation",
   BaseStyle->"Link",
   ButtonData->"paclet:StianRamsnes/MaXrd/ref/UnitCellTransformation"]], 
  "InlineFormula",ExpressionUUID->"2177423d-6c59-4bea-9a66-56de55b767bc"],
 " also transforms the fractional coordinates and the ADPs (atomic \
displacement parameters)."
}], "Text",
 CellChangeTimes->{{3.7168950257922173`*^9, 3.716895034751522*^9}},
 CellID->133711474,ExpressionUUID->"0d592cf0-b825-443e-a5f5-66a25d093827"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Guides", "TutorialMoreAboutSection",
 CellChangeTimes->{{3.843042384656711*^9, 3.843042386024461*^9}},
 CellID->275793943],

Cell["XXXX", "TutorialMoreAbout",
 CellID->999089775]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Tech Notes", "RelatedTutorialsSection",
 CellID->527212532],

Cell["XXXX", "RelatedTutorials",
 CellID->343497802]
}, Open  ]]
}, Open  ]]
},
WindowSize->{700, 771},
WindowMargins->{{930, Automatic}, {Automatic, 268}},
TaggingRules->{
 "DocuToolsSettings" -> {
   "$ShowPacletVariablesPrompt" -> "False", "$ApplicationName" -> "MaXrd", 
    "$LinkBase" -> "MaXrd", "$DocumentationDirectory" -> 
    "/Users/stian/Library/Mobile Documents/com~apple~CloudDocs/Stians \
iCloud/Utdanning/(2016-2020) Universitetet i Stavanger (PhD)/Mathematica \
project (MaXrd)/GitHub/MaXrd/Documentation/English/", "$ApplicationDirectory" -> 
    "/Users/stian/Library/Mobile Documents/com~apple~CloudDocs/Stians \
iCloud/Utdanning/(2016-2020) Universitetet i Stavanger (PhD)/Mathematica \
project (MaXrd)/GitHub/MaXrd"}, "Paclet" -> "None"},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "TechNotePageStylesExt.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"d50e9c01-7f17-458b-ab35-f8abb40663ee"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 720, 16, 26, "History",ExpressionUUID->"8b73912d-c4c3-44c1-bbde-bd576ea8f82a",
 CellID->1118682885],
Cell[CellGroupData[{
Cell[1303, 40, 67, 1, 21, "CategorizationSection",ExpressionUUID->"5369d6f1-4696-493d-8e05-2d1b918cf12f",
 CellID->483918710],
Cell[1373, 43, 82, 2, 34, "Categorization",ExpressionUUID->"b7de9b99-016d-4fb8-be0a-69a84c7ac8b1",
 CellID->701187781],
Cell[1458, 47, 92, 2, 34, "Categorization",ExpressionUUID->"c826b079-ca86-459a-8075-78d312f99517",
 CellID->1620264178],
Cell[1553, 51, 89, 2, 34, "Categorization",ExpressionUUID->"57a8373b-90e7-48d5-9e22-4f9f1ac51696",
 CellID->1687395686],
Cell[1645, 55, 112, 2, 34, "Categorization",ExpressionUUID->"682de660-7878-44a1-8075-bceb3dd7274a",
 CellID->390252320]
}, Open  ]],
Cell[CellGroupData[{
Cell[1794, 62, 55, 1, 31, "KeywordsSection",ExpressionUUID->"3f5ff141-bf53-41fd-bae7-ce2f3c05db8d",
 CellID->555684302],
Cell[1852, 65, 45, 1, 70, "Keywords",ExpressionUUID->"e085b60e-5da0-4d7e-b39b-092285660a75",
 CellID->2127166558]
}, Closed]],
Cell[CellGroupData[{
Cell[1934, 71, 220, 4, 114, "Title",ExpressionUUID->"0669b83c-c92d-4004-9d7f-e1857b8d168f",
 CellID->509267359],
Cell[2157, 77, 336, 7, 44, "Text",ExpressionUUID->"8f67f2a9-b035-453d-bebc-00584f981d37",
 CellID->1534169418],
Cell[CellGroupData[{
Cell[2518, 88, 137, 2, 41, "MathCaption",ExpressionUUID->"9c378dcf-15fc-47da-844a-089060c00e50",
 CellID->1517691727],
Cell[2658, 92, 330, 5, 29, "Input",ExpressionUUID->"8715a4dc-1530-459a-ba2f-6ae06f0af957",
 CellID->318520214]
}, Open  ]],
Cell[3003, 100, 453, 13, 44, "Text",ExpressionUUID->"8444e053-d350-4a02-aebe-166ffba3cb2f",
 CellID->1633598486],
Cell[3459, 115, 2898, 76, 260, "DefinitionBox",ExpressionUUID->"dd755b9c-967f-43fd-aef2-bc34996fcde4",
 CellID->876862730],
Cell[6360, 193, 579, 13, 49, "Caption",ExpressionUUID->"968f07fd-dac0-4f39-82dc-72d68f0a1669",
 CellID->1399117396],
Cell[6942, 208, 2914, 76, 240, "DefinitionBox",ExpressionUUID->"d756eeed-246a-4b00-b039-01aabd171de0",
 CellID->2096742444],
Cell[9859, 286, 972, 26, 64, "Caption",ExpressionUUID->"00a3255b-03f7-4c7d-985f-2d9b5338199e",
 CellID->1891092685],
Cell[CellGroupData[{
Cell[10856, 316, 189, 3, 45, "Section",ExpressionUUID->"852c2d86-8fb0-4b19-ba87-e6bbf25cf523",
 CellID->1321285995],
Cell[CellGroupData[{
Cell[11070, 323, 1192, 31, 94, "Text",ExpressionUUID->"54b665df-dd78-4c83-8e26-b58f9510e7b5",
 CellID->297183504],
Cell[CellGroupData[{
Cell[12287, 358, 311, 7, 29, "Input",ExpressionUUID->"d46b99ad-bd16-4c14-a5db-959075f7d59d",
 CellID->1956406672],
Cell[12601, 367, 6156, 146, 476, "Output",ExpressionUUID->"d9af8a96-8d0c-4fbb-9955-4105f09f4fa1",
 CellID->970581802]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18806, 519, 411, 8, 44, "Text",ExpressionUUID->"1440adc8-b854-4da6-8f36-9968860d5066",
 CellID->680229519],
Cell[CellGroupData[{
Cell[19242, 531, 178, 4, 27, "Input",ExpressionUUID->"0a4d6a01-969b-41ed-9dab-873c64ade7e7",
 CellID->1878533656],
Cell[19423, 537, 61627, 1304, 221, "Output",ExpressionUUID->"8a17cc3f-d2a5-4b24-9818-d1dbf1c5dd4c",
 CellID->1354571897]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81099, 1847, 292, 6, 44, "Text",ExpressionUUID->"1800710d-1ca4-45f5-94c3-78accacc90eb",
 CellID->1526046967],
Cell[CellGroupData[{
Cell[81416, 1857, 846, 23, 107, "Input",ExpressionUUID->"1a24b868-4d40-4094-92bc-91108412559a",
 CellID->418026381],
Cell[82265, 1882, 13391, 332, 565, "Output",ExpressionUUID->"585cdca9-f6e4-4c79-b7a8-9f923b4f66df",
 CellID->946721241]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95705, 2220, 470, 12, 44, "Text",ExpressionUUID->"92a73256-9842-4b42-b35c-dae15faeffca",
 CellID->568725332],
Cell[CellGroupData[{
Cell[96200, 2236, 918, 22, 106, "Input",ExpressionUUID->"e9347da5-34bd-4f81-b31f-1ea1aaf87f66",
 CellID->250507665],
Cell[97121, 2260, 19328, 451, 581, "Output",ExpressionUUID->"b169d95f-b883-4e6c-a528-1671c9f4dfe6",
 CellID->718734217]
}, Open  ]]
}, Open  ]],
Cell[116476, 2715, 450, 9, 63, "Text",ExpressionUUID->"df565a52-e5cc-4994-ab6c-939a29e8a229",
 CellID->2109938560],
Cell[116929, 2726, 286, 4, 25, "Text",ExpressionUUID->"29a0074b-27c1-4f4c-bdfb-33f0353e6134",
 CellID->2087636597]
}, Open  ]],
Cell[CellGroupData[{
Cell[117252, 2735, 234, 4, 45, "Section",ExpressionUUID->"081d525f-f06a-4307-833f-f14589fd5a1c",
 CellID->1803163375],
Cell[117489, 2741, 1514, 35, 85, "Text",ExpressionUUID->"66615aa8-ffc3-4311-91af-b4c3eb9dfe45",
 CellID->1299640056],
Cell[119006, 2778, 1070, 33, 66, "Text",ExpressionUUID->"1caa7389-d36e-43aa-a0a9-82ef450295d4",
 CellID->2007483230],
Cell[120079, 2813, 472, 10, 44, "Text",ExpressionUUID->"4c45c5b9-c5d4-4944-b6f7-381bfe41d3af",
 CellID->321014419],
Cell[120554, 2825, 1381, 45, 46, "DisplayMath",ExpressionUUID->"eb3f84c4-54d8-4ef7-b48f-62de566e3752",
 CellID->1553302283],
Cell[121938, 2872, 1745, 54, 67, "Text",ExpressionUUID->"4d989e53-09b4-4064-90ad-030c553dc943",
 CellID->1971629454],
Cell[123686, 2928, 669, 16, 45, "Text",ExpressionUUID->"b878bd59-e7ea-4f43-aa3d-0dfe5a073df1",
 CellID->502109707],
Cell[124358, 2946, 577, 14, 24, "BulletedText",ExpressionUUID->"6ff23a3f-79a7-47c0-ba00-571f36671e93",
 CellID->617004870],
Cell[124938, 2962, 680, 19, 26, "BulletedText",ExpressionUUID->"6d971610-cbbc-4773-8b30-d5f4cf33ee9c",
 CellID->1197623678],
Cell[125621, 2983, 572, 14, 24, "BulletedText",ExpressionUUID->"aca323c2-df0a-4349-9009-776482ea0bc1",
 CellID->96932815],
Cell[126196, 2999, 634, 18, 26, "BulletedText",ExpressionUUID->"5655b045-5e91-4bc3-ab0a-2aea8ecb186a",
 CellID->1357217279],
Cell[126833, 3019, 658, 18, 26, "BulletedText",ExpressionUUID->"9b55f1a6-a67d-4058-98be-0ac0548d9c61",
 CellID->179509719],
Cell[127494, 3039, 785, 17, 24, "BulletedText",ExpressionUUID->"79e88c9f-ec6e-4efc-9779-02a0c5721634",
 CellID->1952806845],
Cell[128282, 3058, 448, 9, 23, "BulletedText",ExpressionUUID->"4ba781cb-730b-493e-8e5a-ab11bfc27b25",
 CellID->832066814],
Cell[128733, 3069, 238, 7, 25, "Text",ExpressionUUID->"d2f6296b-0d5d-417b-8fdf-247fd74bf36a",
 CellID->1912567340],
Cell[128974, 3078, 189, 3, 23, "BulletedText",ExpressionUUID->"a0fdb322-a0b3-4d65-9845-fa19e3563525",
 CellID->664333692],
Cell[129166, 3083, 193, 3, 23, "BulletedText",ExpressionUUID->"e0faf05a-2c1f-4df5-8db8-5836d3db5a9f",
 CellID->901341942],
Cell[129362, 3088, 187, 3, 23, "BulletedText",ExpressionUUID->"110e0e7a-fe77-4702-a2eb-68753f41df5a",
 CellID->504373256],
Cell[129552, 3093, 218, 4, 23, "BulletedText",ExpressionUUID->"6fad462c-b674-425c-a64c-347381f4f139",
 CellID->480393818],
Cell[129773, 3099, 184, 3, 23, "BulletedText",ExpressionUUID->"5f0f0323-de7e-4a6e-873d-6f1103bd4e7b",
 CellID->883358883],
Cell[129960, 3104, 233, 3, 23, "BulletedText",ExpressionUUID->"53de59f8-ae3f-4949-9a65-b685ec447005",
 CellID->1058294870],
Cell[130196, 3109, 236, 3, 23, "BulletedText",ExpressionUUID->"5192d368-969a-4e72-b342-578d88847e8e",
 CellID->1302315636],
Cell[130435, 3114, 209, 3, 23, "BulletedText",ExpressionUUID->"8484ec0e-1d27-4594-9cb1-707800422126",
 CellID->865564028],
Cell[130647, 3119, 700, 19, 90, "Text",ExpressionUUID->"89bc5198-d434-4ae6-bc32-a5478d35e6d7",
 CellID->1651759066],
Cell[CellGroupData[{
Cell[131372, 3142, 277, 7, 23, "BulletedText",ExpressionUUID->"487d9e1f-cbdb-4b08-a327-c0c21743d3d8",
 CellID->1504228733],
Cell[131652, 3151, 713, 18, 27, "Input",ExpressionUUID->"60da3470-1793-4d66-9372-5de81e94af45",
 Evaluatable->False,
 CellID->1330622774]
}, Open  ]],
Cell[CellGroupData[{
Cell[132402, 3174, 199, 6, 23, "BulletedText",ExpressionUUID->"e08a5087-9585-49da-a095-bc41cefdfda0",
 CellID->1794106722],
Cell[132604, 3182, 1388, 39, 104, "Input",ExpressionUUID->"c73f166e-0a1b-497f-b998-f2dbf04a1e26",
 Evaluatable->False,
 CellID->2051685854]
}, Open  ]],
Cell[134007, 3224, 405, 13, 47, "Text",ExpressionUUID->"e60ea024-7d6a-46b6-8eb3-6ea9ee346ade",
 CellID->812704820],
Cell[134415, 3239, 332, 8, 44, "Text",ExpressionUUID->"f1cfee93-88de-4bd1-a523-a04623bb79e4",
 CellID->1456191198],
Cell[CellGroupData[{
Cell[134772, 3251, 322, 10, 25, "Text",ExpressionUUID->"da39cebb-0317-40a4-9934-9bf8a54cd23c",
 CellID->1709962922],
Cell[135097, 3263, 581, 14, 27, "Input",ExpressionUUID->"be40809d-00c6-44e7-b608-a32038af385d",
 Evaluatable->False,
 CellID->1719575401]
}, Open  ]],
Cell[CellGroupData[{
Cell[135715, 3282, 1683, 36, 166, "Text",ExpressionUUID->"d37dc016-2ce3-4535-bd4e-3b0d0663c48e",
 CellID->1702821681],
Cell[CellGroupData[{
Cell[137423, 3322, 372, 9, 29, "Input",ExpressionUUID->"0c315d83-fdad-4037-9c99-7c785706ad50",
 CellID->329146285],
Cell[137798, 3333, 409, 9, 28, "Output",ExpressionUUID->"9cd35cf0-ee80-479a-a29e-1ef7b042f5fe",
 CellID->1307559688]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138256, 3348, 186, 4, 25, "Text",ExpressionUUID->"339d6d9c-de5e-46c7-889e-12f95ac7499a",
 CellID->1002270249],
Cell[CellGroupData[{
Cell[138467, 3356, 347, 9, 29, "Input",ExpressionUUID->"b6a5979e-fce5-48d7-ada2-671363110ee5",
 CellID->1098049228],
Cell[138817, 3367, 296, 8, 28, "Output",ExpressionUUID->"0e19fa9e-a299-4255-bdba-8c3dda03c1e5",
 CellID->731169051]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[139162, 3381, 427, 12, 26, "Text",ExpressionUUID->"4df9f185-b785-4fda-a0ab-5c63d757adca",
 CellID->1286395119],
Cell[CellGroupData[{
Cell[139614, 3397, 380, 9, 29, "Input",ExpressionUUID->"94e7c88c-bd4b-454f-bab3-412fbcd50aba",
 CellID->1371633564],
Cell[139997, 3408, 1329, 42, 212, "Output",ExpressionUUID->"3b8de352-115c-4c09-ad04-ce546c44c896",
 CellID->772861501]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[141375, 3456, 273, 8, 26, "Text",ExpressionUUID->"e4e5ff46-7561-42f8-a752-960a033e98de",
 CellID->155143503],
Cell[CellGroupData[{
Cell[141673, 3468, 350, 8, 29, "Input",ExpressionUUID->"eb84d8df-0621-4696-b882-f9895a46ee84",
 CellID->244251865],
Cell[142026, 3478, 274, 7, 25, "Output",ExpressionUUID->"c8579faf-82d0-45b8-95a5-a45bd460485a",
 CellID->1020574412]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[142361, 3492, 148, 3, 45, "Section",ExpressionUUID->"8f2bfb8c-9c0a-41ce-b6e9-bb685e00549e",
 CellID->188407737],
Cell[CellGroupData[{
Cell[142534, 3499, 744, 16, 47, "Text",ExpressionUUID->"23a90e3d-4cb1-4b53-b3b0-f1fa421bbd2b",
 CellID->203540802],
Cell[CellGroupData[{
Cell[143303, 3519, 171, 4, 26, "Input",ExpressionUUID->"6b75e793-0ce7-4a35-b30d-f03c9c63a8d4",
 CellID->1621360621],
Cell[143477, 3525, 72095, 1476, 216, "Output",ExpressionUUID->"b3e51446-3ab5-483f-88ce-7fef26c4f83c",
 CellID->866008397]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[215621, 5007, 868, 21, 69, "Text",ExpressionUUID->"43b4c53e-a4ba-443d-8775-337cb4cb5aae",
 CellID->1528333037],
Cell[CellGroupData[{
Cell[216514, 5032, 175, 4, 27, "Input",ExpressionUUID->"9c52e65a-2cef-44e8-b70a-5c7bc1dd41ed",
 CellID->1692304135],
Cell[216692, 5038, 5692, 133, 490, "Output",ExpressionUUID->"f31bd5e5-29bc-4233-898c-53cc2f9270cb",
 CellID->1801286190]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[222433, 5177, 140, 2, 25, "Text",ExpressionUUID->"1c99e97e-4c54-4345-b7fe-b7d79c269923",
 CellID->877098777],
Cell[CellGroupData[{
Cell[222598, 5183, 214, 5, 27, "Input",ExpressionUUID->"4b3e9e6e-db8b-46d1-83b6-c74d62b7aaab",
 CellID->1746312217],
Cell[222815, 5190, 1346, 38, 188, "Output",ExpressionUUID->"db73bdb9-86ac-45b0-bc97-a8c9549ff660",
 CellID->2062473013]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[224210, 5234, 585, 16, 44, "Text",ExpressionUUID->"9a04c981-6e84-4a6c-bcc6-b84365d27ad2",
 CellID->1850798272],
Cell[224798, 5252, 672, 13, 46, "Program",ExpressionUUID->"378f3216-de60-451c-9ab3-bf951a1cd75f",
 CellID->312766054]
}, Open  ]],
Cell[CellGroupData[{
Cell[225507, 5270, 140, 2, 25, "Text",ExpressionUUID->"cb3adea5-7eed-48f0-96ba-72f20fa54464",
 CellID->1990630188],
Cell[CellGroupData[{
Cell[225672, 5276, 550, 14, 69, "Input",ExpressionUUID->"84e2872c-3359-4f6a-ac2a-117dd1ae01b0",
 CellID->976856059],
Cell[226225, 5292, 873, 26, 130, "Output",ExpressionUUID->"8c300b5c-3e69-4777-a706-e3d920799615",
 CellID->539078196]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[227147, 5324, 186, 4, 25, "Text",ExpressionUUID->"e855fb62-3f6d-4cae-8067-cc9d3c0232de",
 CellID->1636600781],
Cell[227336, 5330, 714, 15, 46, "Program",ExpressionUUID->"e14b70d2-1259-4c03-b34f-2e4428df3721",
 CellID->543910859],
Cell[CellGroupData[{
Cell[228075, 5349, 645, 16, 71, "Input",ExpressionUUID->"b33c8962-9609-4ad6-89d4-d08a91c948f4",
 CellID->198338952],
Cell[228723, 5367, 837, 27, 166, "Output",ExpressionUUID->"42f96cdd-34a4-4062-b863-3b57d8e5cbec",
 CellID->205053864]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[229609, 5400, 613, 13, 44, "Text",ExpressionUUID->"fb37fb62-2be3-4994-b232-cf79b29a4667",
 CellID->1406177176],
Cell[CellGroupData[{
Cell[230247, 5417, 551, 12, 29, "Input",ExpressionUUID->"e30965d8-e5ab-44d6-9d10-b44e544090a9",
 CellID->611077196],
Cell[230801, 5431, 571, 12, 29, "Output",ExpressionUUID->"595fee35-8597-4d16-b338-954821d21339",
 CellID->2093917942]
}, Open  ]],
Cell[CellGroupData[{
Cell[231409, 5448, 519, 11, 29, "Input",ExpressionUUID->"e3de9a2b-849c-49cb-8cbc-8f6186ae0743",
 CellID->282682384],
Cell[231931, 5461, 454, 12, 29, "Output",ExpressionUUID->"6cc879e5-65c8-4ac5-8b8a-faff453bff99",
 CellID->461431739]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[232434, 5479, 648, 18, 44, "Text",ExpressionUUID->"63de647d-0aff-4a42-b066-d7ea3796a83c",
 CellID->1381000051],
Cell[CellGroupData[{
Cell[233107, 5501, 360, 8, 29, "Input",ExpressionUUID->"dc6e6825-97f0-484e-a99a-5811fb6c510d",
 CellID->929086703],
Cell[233470, 5511, 270, 7, 25, "Output",ExpressionUUID->"55e1a68d-a643-45ba-ad95-835e134a9b1b",
 CellID->1756876728]
}, Open  ]]
}, Open  ]],
Cell[233767, 5522, 301, 7, 25, "Text",ExpressionUUID->"105aacf1-255f-4766-ab92-a6977268d23e",
 CellID->1530327227]
}, Open  ]],
Cell[CellGroupData[{
Cell[234105, 5534, 63, 1, 45, "Section",ExpressionUUID->"31361945-2e63-4f94-9a17-0cd759b290c7",
 CellID->624426137],
Cell[234171, 5537, 727, 21, 69, "Text",ExpressionUUID->"172d5d7c-2302-4180-ab9c-2b7f6d170c9b",
 CellID->472713516],
Cell[CellGroupData[{
Cell[234923, 5562, 273, 7, 41, "MathCaption",ExpressionUUID->"c30a1458-7d16-4a40-b56e-ec1653cc479c",
 CellID->1154133361],
Cell[CellGroupData[{
Cell[235221, 5573, 596, 13, 71, "Input",ExpressionUUID->"20775527-5152-4ae0-80d4-a50a1254b08b",
 CellID->971842639],
Cell[235820, 5588, 2208, 54, 110, "Output",ExpressionUUID->"f8f50793-9b05-490a-b20f-4f5b01850b7c",
 CellID->783870600]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[238077, 5648, 244, 9, 41, "MathCaption",ExpressionUUID->"1f4b9ba5-8e3b-441b-97eb-4107c0d24d98",
 CellID->1975173209],
Cell[CellGroupData[{
Cell[238346, 5661, 165, 4, 27, "Input",ExpressionUUID->"affaf96c-d677-44e5-9890-c29db6dbbbe6",
 CellID->933908337],
Cell[238514, 5667, 347, 8, 26, "Output",ExpressionUUID->"82a6ba26-3aea-46a1-b611-ff8c835a8631",
 CellID->584575141]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[238910, 5681, 419, 13, 58, "MathCaption",ExpressionUUID->"375e7f74-6937-4a11-b24a-9a979480d223",
 CellID->2099042221],
Cell[CellGroupData[{
Cell[239354, 5698, 214, 7, 29, "Input",ExpressionUUID->"ffb9b256-b5c7-430a-976d-60aa2f386a1d",
 CellID->1888739078],
Cell[239571, 5707, 460, 12, 28, "Output",ExpressionUUID->"87946acd-3a5b-4ce6-9a5f-4d59b9b73346",
 CellID->1637482004]
}, Open  ]]
}, Open  ]],
Cell[240058, 5723, 556, 15, 63, "Text",ExpressionUUID->"c9990423-d468-495a-8437-742639deeb99",
 CellID->1502558102],
Cell[240617, 5740, 783, 22, 66, "Text",ExpressionUUID->"d68887f3-39fb-4914-8756-2cc77cd5f708",
 CellID->1233815241],
Cell[CellGroupData[{
Cell[241425, 5766, 252, 9, 41, "MathCaption",ExpressionUUID->"62da89c7-cabc-45d8-8bcb-2a68bb15b84a",
 CellID->630660055],
Cell[CellGroupData[{
Cell[241702, 5779, 255, 8, 48, "Input",ExpressionUUID->"a8f79ba5-1150-4018-9548-77abcc15f233",
 CellID->1671746440],
Cell[241960, 5789, 770, 23, 58, "Output",ExpressionUUID->"f2fcb9fb-ae41-452e-9821-b708c58cff74",
 CellID->474569593]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[242779, 5818, 171, 6, 41, "MathCaption",ExpressionUUID->"c540292a-706f-43f8-af9e-2e7635411f2b",
 CellID->115561197],
Cell[CellGroupData[{
Cell[242975, 5828, 219, 5, 27, "Input",ExpressionUUID->"d9a70269-7067-4659-bd8f-4e3b74c02446",
 CellID->911821091],
Cell[243197, 5835, 511, 15, 25, "Output",ExpressionUUID->"78ba54f8-7b07-4e6b-9ebd-a151dd211551",
 CellID->478310719]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[243757, 5856, 183, 7, 41, "MathCaption",ExpressionUUID->"3e05209e-3ffc-4d1c-aa96-a51c7d48f1da",
 CellID->533771445],
Cell[243943, 5865, 188, 7, 27, "Input",ExpressionUUID->"b044875c-c267-43ca-97cb-f18738266aa9",
 CellID->1057482596]
}, Open  ]],
Cell[CellGroupData[{
Cell[244168, 5877, 138, 2, 41, "MathCaption",ExpressionUUID->"98591a05-a5aa-4574-bd4e-22ccae522e2d",
 CellID->535328400],
Cell[CellGroupData[{
Cell[244331, 5883, 263, 5, 45, "Input",ExpressionUUID->"fdc899f3-54f0-4eeb-ac9d-339c0f1a7075",
 CellID->1455421517],
Cell[244597, 5890, 377, 11, 25, "Output",ExpressionUUID->"ee21f6e5-6b37-4b12-8960-275011b64aa0",
 CellID->829483510],
Cell[244977, 5903, 378, 11, 25, "Output",ExpressionUUID->"792d1498-22bf-4f50-999e-da28f3e2008f",
 CellID->1812999893]
}, Open  ]]
}, Open  ]],
Cell[245382, 5918, 606, 21, 45, "Text",ExpressionUUID->"1842ca0e-2b08-4058-a8c2-17785f3655c3",
 CellID->606382873],
Cell[CellGroupData[{
Cell[246013, 5943, 449, 11, 47, "Text",ExpressionUUID->"59e8a800-022d-4211-ac28-34a833c2ed43",
 CellID->1667041496],
Cell[CellGroupData[{
Cell[246487, 5958, 214, 5, 29, "Input",ExpressionUUID->"30a7c115-2a59-4c8d-b7de-46cf80fd10ec",
 CellID->1894764510],
Cell[246704, 5965, 2244, 56, 110, "Output",ExpressionUUID->"c4aa4b09-8e9d-4b43-a669-3db93c35cde9",
 CellID->622396093]
}, Open  ]]
}, Open  ]],
Cell[248975, 6025, 463, 12, 44, "Text",ExpressionUUID->"79adfa57-4251-4ff8-86e2-e8b67701b84e",
 CellID->1498020586],
Cell[249441, 6039, 508, 11, 47, "Text",ExpressionUUID->"0d592cf0-b825-443e-a5f5-66a25d093827",
 CellID->133711474]
}, Open  ]],
Cell[CellGroupData[{
Cell[249986, 6055, 136, 2, 74, "TutorialMoreAboutSection",ExpressionUUID->"316e3de3-6b5e-482c-a92b-ba8dd4f3e214",
 CellID->275793943],
Cell[250125, 6059, 53, 1, 24, "TutorialMoreAbout",ExpressionUUID->"e2b23e1b-0b0c-48a8-b8a7-62ff65e28382",
 CellID->999089775]
}, Open  ]],
Cell[CellGroupData[{
Cell[250215, 6065, 73, 1, 74, "RelatedTutorialsSection",ExpressionUUID->"9a0b9fde-90cc-4857-a566-692cb1bead70",
 CellID->527212532],
Cell[250291, 6068, 52, 1, 24, "RelatedTutorials",ExpressionUUID->"0f0a99d1-308b-46f6-b9cf-dd4fbef71d43",
 CellID->343497802]
}, Open  ]]
}, Open  ]]
}
]
*)

